---
componentType: default
optionType: environment
headingText: Configure the Kafka integration
---

1. Change directory to the integrations configuration. Run this command:

   ```shell
   cd /etc/newrelic-infra/integrations.d
   ```

2. Copy the sample configuration. Run this command:

   ```shell
   sudo cp nri-kafka-config.yml.sample kafka-config.yml
   ```

3. Edit the `kafka-config.yml` file to configure the integration. The following example collects metrics and inventory discovered by the bootstrap broker.

   ```yml
   integrations:
     - name: nri-kafka
       env:
         CLUSTER_NAME: testcluster1
         AUTODISCOVER_STRATEGY: bootstrap
         BOOTSTRAP_BROKER_HOST: localhost
         BOOTSTRAP_BROKER_KAFKA_PORT: 9092
         BOOTSTRAP_BROKER_KAFKA_PROTOCOL: PLAINTEXT
         BOOTSTRAP_BROKER_JMX_PORT: 9999  # This same port will be used to connect to all discover broker JMX
         BOOTSTRAP_BROKER_JMX_USER: admin
         BOOTSTRAP_BROKER_JMX_PASSWORD: password

         LOCAL_ONLY_COLLECTION: false

         COLLECT_BROKER_TOPIC_DATA: true
         TOPIC_MODE: "all"
         COLLECT_TOPIC_SIZE: false
       interval: 15s
       labels:
         env: production
         role: kafka
       inventory_source: config/kafka
   ```

You can set the values for these settings in several ways:

* Adding the value directly in the config file. This is the most common way.

* Replacing the values from environment variables using the `{{ }}` notation. Read more about [using environment variable passthroughs with on-host integrations](/docs/infrastructure/install-infrastructure-agent/configuration/configure-infrastructure-agent/#passthrough) or see the example for [environment variables replacement](/docs/infrastructure/host-integrations/host-integrations-list/elasticsearch/elasticsearch-integration#envvar-replacement).

* Using secrets management. Use this to protect sensitive information, such as passwords that would be exposed in plain text on the configuration file. For more information, see [secrets management](/docs/integrations/host-integrations/installation/secrets-management).

The config file will likely require fine-tuning based on your specific Kafka instance. For example, you may want to use SSL or TLS to authenticate. You can find all the config options at the bottom of this doc alongside more complex config examples.
