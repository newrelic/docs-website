---
componentType: default
headingText: What's next?
---




<ButtonLink
    role="button"
    to="/install/microsoft-sql"
    variant="primary"
>
  Reset the form
</ButtonLink>


### Configure the Microsoft SQL Server integration [#configure]

You can edit the `mssql-config.yml` file to include the necessary login credentials and configure data collection according to your setup and preferences. This configuration file contains common settings applicable to all integrations, such as `interval`, `timeout`, and `inventory_source`.


For more information on these common settings, refer to [configuration format standards](/docs/create-integrations/infrastructure-integrations-sdk/specifications/host-integrations-newer-configuration-format/#configuration-basics).

If you are using our legacy configuration and definition files, refer to [this document](/docs/create-integrations/infrastructure-integrations-sdk/specifications/host-integrations-standard-configuration-format/).


### mssql-config.yml sample files[#sample-config]

<CollapserGroup>

    <Collapser
    id="basic-config"
    title="Basic configuration"
    >
    This is the basic configuration used to collect metrics and inventory from your `localhost`. It uses default connection on port `1433`:

    ```yaml
integrations:
    - name: nri-mssql
      env:
        HOSTNAME: localhost
        PORT: 1433
        USERNAME: USERNAME
        PASSWORD: PASSWORD
        ENABLE_SSL: true
        TRUST_SERVER_CERTIFICATE: true
        # Enable collection of detailed query-level metrics.
        ENABLE_QUERY_MONITORING: false
        # Threshold in milliseconds for query response time. If response time exceeds this threshold, the query will be considered slow.
        QUERY_MONITORING_RESPONSE_TIME_THRESHOLD: 500
        # Maximum number of queries returned in query analysis results.
        QUERY_MONITORING_COUNT_THRESHOLD: 20
        # Interval in seconds for fetching grouped slow queries; Should always be same as mysql-config interval.
        QUERY_MONITORING_FETCH_INTERVAL: 15
      interval: 15s
      labels:
        environment: production
      inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="config-query-level-enabled"
    title="Configuration with database performance monitoring"
    >
    This configuration collects metrics and inventory from your `localhost` using the default connection on port `1433`, with database performance monitoring enabled::

    ```yaml
integrations:
    - name: nri-mssql
      env:
        HOSTNAME: localhost
        PORT: 1433
        USERNAME: USERNAME
        PASSWORD: PASSWORD
        ENABLE_SSL: true
        TRUST_SERVER_CERTIFICATE: true
        # Enable collection of detailed query-level metrics.
        ENABLE_QUERY_MONITORING: true
        # Threshold in milliseconds for query response time. If response time exceeds this threshold, the query will be considered slow.
        QUERY_MONITORING_RESPONSE_TIME_THRESHOLD: 500
        # Maximum number of queries returned in query analysis results.
        QUERY_MONITORING_COUNT_THRESHOLD: 20
        # Interval in seconds for fetching grouped slow queries; Should always be same as mysql-config interval.
        QUERY_MONITORING_FETCH_INTERVAL: 15
      interval: 15s
      labels:
        environment: production
      inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="basic-config-domain"
    title="Configuration with Windows domain authentication"
    >
    This is the basic configuration used to collect metrics and inventory from your localhost. In this case we use a domain user for authentication:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: domain_name\domain_user
            PASSWORD: domain_user_password
          interval: 15s
          labels:
            environment: production
            inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="basic-config-gmsa"
    title="Configuration with gMSA user"
    >
    This is the basic configuration used to collect metrics and inventory from your localhost. In this case we use a gMSA for authentication, which requires a blank username and password:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: 
            PASSWORD: 
          interval: 15s
          labels:
            environment: production
          inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="basic-config-domain"
    title="Configuration with Microsoft EntraId Service Principal"
    >
    This is the basic configuration used to collect metrics and inventory from your localhost. In this case we use a user from Microsoft Entra ID service principal for authentication:

    ```yaml
    integrations:
      - name: nri-mssql
        env:
          HOSTNAME: localhost
          PORT: 1433
          CLIENT_ID: client_id
          TENANT_ID: tenant_id
          CLIENT_SECRET: client_secret
          # Enable collection of detailed query-level metrics.
          # ENABLE_QUERY_MONITORING: false
        interval: 15s
        labels:
          environment: production
          inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="basic-intervals"
    title="Configuration with different metric/inventory intervals"
    >
    This configuration collects metrics every 15 seconds and inventory every 60 seconds:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            METRICS: true
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: mssql_user   
            PASSWORD: mssql_password
          interval: 15s
          labels:
            environment: production

        - name: nri-mssql
          env:
            INVENTORY: true
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: mssql_user
            PASSWORD: mssql_password
          interval: 60s
          labels:
            environment: production
          inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="multi-instance"
    title="Multi instance connection"
    >
    This configuration monitors the `mssql_instance1` and `mssql_instance2` instances on the same SQL Server. When connecting directly to an instance you'll need to remove the `PORT` setting. The SQL Browser service also needs to be running on the server:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            HOSTNAME: localhost
            USERNAME: mssql_user
            PASSWORD: mssql_password
            INSTANCE: mssql_instance1
          interval: 15s
          labels:
            environment: production
          inventory_source: config/mssql

        - name: nri-mssql
          env:
            HOSTNAME: localhost
            USERNAME: mssql_user
            PASSWORD: mssql_password
            INSTANCE: mssql_instance2
          interval: 15s
          labels:
            environment: production
        inventory_source: config/mssql
    ```
    </Collapser>

    <Collapser
    id="metrics-connect-ssl"
    title="Metrics-only connecting over SSL"
    >
    Use to connect to Microsoft SQL Server using SSL without validation of the certificate:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            METRICS: true
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: mssql_user
            PASSWORD: mssql_password
            ENABLE_SSL: true
            TRUST_SERVER_CERTIFICATE: true
          interval: 15s
          labels:
            environment: production
    ```
    </Collapser>

    <Collapser
    id="disable-buffer_reserve"
    title="Buffer Pool and Partition Reserve metrics optimization"
    >
    If the integration causes some overhead on your SQL Server, disabling the Buffer Pool and Database Partition Reserve metrics can help to optimize the integration's performance. In this example, we also increased the sampling interval to 30 seconds to reduce the sampling frequency:

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            HOSTNAME: localhost
            PORT: 1433
            USERNAME: mssql_user
            PASSWORD: mssql_password
            ENABLE_BUFFER_METRICS: false
            ENABLE_DATABASE_RESERVE_METRICS: false
            ENABLE_DISK_METRICS_IN_BYTES: false
          interval: 30s
          labels:
            environment: production
          inventory_source: config/mssql
    ```

    Keep in mind the following:

    * If you enable `ENABLE_BUFFER_METRICS`, a query starts running involving the `sys.sysdatabases` and `sys.dm_os_buffer_descriptors` internal tables to obtain the buffer's pool size for each database. This query could cause overhead on some SQL Servers. If you disable `ENABLE_BUFFER_METRICS`, the metric `bufferpool.sizePerDatabaseInBytes` won't be reported in MssqlDatabaseSample and `bufferpool.sizeInBytes` won't be reported in `MssqlInstanceSample`.
    * If you enable `ENABLE_DATABASE_RESERVE_METRICS`, the reserved size is queried for each database and may cause some load on your server, depending on its size and usage. When it's disabled, both `pageFileTotal` and `pageFileAvailable` metrics stop being reported in MssqlDatabaseSample.
    * If you enable `ENABLE_DISK_METRICS_IN_BYTES`, a query that fetches the volume stats for each database will run, and this query can be slow. If you disable `ENABLE_DISK_METRICS_IN_BYTES`, the metric `instance.diskInBytes` won't be reported in `MssqlDatabaseSample`.

    </Collapser>

    <Collapser
    id="custom-query"
    title="Custom Query"
    >
    You can use a custom query to collect additional metrics. Custom metrics will be added to the `MssqlCustomQuerySample` event sample.

    <Callout variant="tip">
        If you need to use multiple custom queries, use the [`CUSTOM_METRICS_CONFIG`](#multi-custom-query) example.
    </Callout>

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            METRICS: true
            HOSTNAME: mssql_host1
            PORT: 1433
            USERNAME: mssql1_user
            PASSWORD: mssql1_password
            CUSTOM_METRICS_QUERY: >-
            SELECT
                'instance_buffer_pool_size' AS metric_name,
                Count_big(*) * (8*1024) AS metric_value,
                'gauge' as metric_type,
                database_id
            FROM sys.dm_os_buffer_descriptors WITH (nolock)
            GROUP BY database_id
          interval: 15s
          labels:
            environment: production
    ```
    </Collapser>

    <Collapser
    id="multi-custom-query"
    title="Multiple Custom Queries"
    >
    If you need multiple custom SQL queries, add them to `mssql-custom-query.yml`, and reference that file on your configuration. For more examples of custom queries, check our [sample file on github](https://github.com/newrelic/nri-mssql/blob/master/mssql-custom-query.yml.sample).

    <Callout variant="tip">
        `CUSTOM_METRICS_CONFIG` is only enabled if `CUSTOM_METRICS_QUERY` is not present.
    </Callout>

    ```yaml
    integrations:
        - name: nri-mssql
          env:
            METRICS: true
            HOSTNAME: mssql_host1
            PORT: 1433
            USERNAME: mssql1_user
            PASSWORD: mssql1_password
            CUSTOM_METRICS_CONFIG: 'C:\path\to\mssql-custom-query.yml'
          interval: 15s
          labels:
            environment: production
    ```

    * Here's an example `mssql-custom-query.yml`.

    ```yaml
    queries:
        # Example for metric_name / metric_type specified in this config
        - query: SELECT count(*) AS 'metric_value' FROM sys.databases
        metric_name: dbCount
        metric_type: gauge

        # Example for metric_name from query, metric_type auto-detected, additional attribute 'category_type'
        - query: SELECT CONCAT('category_', category_id) AS metric_name, name AS metric_value, category_type FROM syscategories
        database: msdb

        # Example for stored procedure 'exec dbo.sp_server_info @attribute_id = 2'
        - query: dbo.sp_server_info @attribute_id = 2
    ```
    </Collapser>
</CollapserGroup>


<Callout variant="tip">
  **Enhance your SQL Server tags:** The `labels` section shown in these examples is key to enriching your Microsoft SQL Server entities with custom tags. For a comprehensive understanding of how to leverage these tags, including how `label.` prefixed custom attributes from the infrastructure agent can also become tags, and how these tags behave in the UI, refer to our detailed guide on [Enhanced tags for New Relic database entities](/docs/infrastructure/host-integrations/db-entity-tags).
</Callout>


### Metrics collected by the integration [#metrics]

The Microsoft SQL Server integration collects the following metric data attributes. Some metric name are prefixed with a category indicator and a period, such as `asserts.` or `flush.`.

    <CollapserGroup>
    
    <Collapser
    id="database-metric"
    title="Database metrics"
    >
    These attributes can be found by querying the `MssqlDatabaseSample` event.

    <table>
        <thead>
        <tr>
            <th style={{ width: "350px" }}>
            Metric
            </th>

            <th>
            Description
            </th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>
            `bufferpool.sizePerDatabaseInBytes`
            </td>

            <td>
            The size of the buffer pool per database. It is reported when `ENABLE_BUFFER_METRICS` is set to true.
            </td>
        </tr>

        <tr>
            <td>
            `maxDiskSizeInBytes`
            </td>

            <td>
            Maximum database size in bytes. It is reported when `ENABLE_DISK_METRICS_IN_BYTES` is set to true. Applies to: Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `io.stallInMilliseconds`
            </td>

            <td>
            Wait time of stall since last restart, in milliseconds.
            </td>
        </tr>

        <tr>
            <td>
            `log.transactionGrowth`
            </td>

            <td>
            Total number of times the transaction log for the database has been expanded since the last restart.
            </td>
        </tr>

        <tr>
            <td>
            `pageFileAvailable`
            </td>

            <td>
            Available page file size, in bytes. It is reported when `ENABLE_DATABASE_RESERVE_METRICS` is set to true.
            </td>
        </tr>

        <tr>
            <td>
            `pageFileTotal`
            </td>

            <td>
            Total page file size, in bytes. It is reported when `ENABLE_DATABASE_RESERVE_METRICS` is set to true.
            </td>
        </tr>

        <tr>
            <td>
            `memoryAvailable`
            </td>

            <td>
            The available physical memory, in bytes. <b>Applies to:</b> Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `memoryTotal`
            </td>

            <td>
            The total physical memory, in bytes. Applies to: Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `memoryUtilization`
            </td>

            <td>
            The percentage of memory utilization. Applies to: Azure SQL Database.
            </td>
        </tr>
        </tbody>
    </table>
    </Collapser>

    <Collapser
    id="instance-metric"
    title="Instance metrics"
    >
    The Microsoft SQL Server integration collects the following instance metrics. These attributes can be found by querying the `MssqlInstanceSample` event.

    <table>
        <thead>
        <tr>
            <th style={{ width: "350px" }}>
            Metric
            </th>

            <th>
            Description
            </th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>
            `access.pageSplitsPerSecond`
            </td>

            <td>
            The number of page splits per second.
            </td>
        </tr>

        <tr>
            <td>
            `activeConnections`
            </td>

            <td>
            The number of active connections.
            </td>
        </tr>

        <tr>
            <td>
            `buffer.checkpointPagesPerSecond`
            </td>

            <td>
            The number of pages flushed to disk per second by a checkpoint or other operation that require all dirty pages to be flushed.
            </td>
        </tr>

        <tr>
            <td>
            `bufferpool.batchRequestsPerSecond`
            </td>

            <td>
            The number of batch requests per second on the buffer pool.
            </td>
        </tr>

        <tr>
            <td>
            `bufferpool.pageLifeExpectancyInMilliseconds`
            </td>

            <td>
            The life expectancy of a page in the buffer pool, in milliseconds.
            </td>
        </tr>

        <tr>
            <td>
            `bufferpool.sizeInBytes`
            </td>

            <td>
            The size of the buffer pool, in bytes. It is reported when `ENABLE_BUFFER_METRICS` is set to true.
            </td>
        </tr>

        <tr>
            <td>
            `instance.backgroundProcessesCount`
            </td>

            <td>
            The number of background processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.blockedProcessesCount`
            </td>

            <td>
            The number of blocked processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.diskInBytes`
            </td>

            <td>
            The amount of disk space on the instance, in bytes. It is reported
            when `ENABLE_DISK_METRICS_IN_BYTES` is set to true. This metric is not reported in case of Azure SQL Database.
        </td>
        </tr>

        <tr>
            <td>
            `instance.dormantProcessesCount`
            </td>

            <td>
            The number of dormant processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.forcedParameterizationsPerSecond`
            </td>

            <td>
            The number of forced parameterizations per second on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.preconnectProcessesCount`
            </td>

            <td>
            The number of preconnect processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.runnableProcessesCount`
            </td>

            <td>
            The number of runnable processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.runnableTasks`
            </td>

            <td>
            The number of runnable tasks on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.runningProcessesCount`
            </td>

            <td>
            The number of running processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.sleepingProcessesCount`
            </td>

            <td>
            The number of sleeping processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.suspendedProcessesCount`
            </td>

            <td>
            The number of suspended processes on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `instance.transactionsPerSecond`
            </td>

            <td>
            The number of transactions per second on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `memoryAvailable`
            </td>

            <td>
            The available physical memory, in bytes. This metric is not reported in case of Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `memoryTotal`
            </td>

            <td>
            The total physical memory, in bytes. This metric is not reported in case of Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `memoryUtilization`
            </td>

            <td>
            The percentage of memory utilization. This metric is not reported in case of Azure SQL Database.
            </td>
        </tr>

        <tr>
            <td>
            `stats.connections`
            </td>

            <td>
            The number of user connections.
            </td>
        </tr>

        <tr>
            <td>
            `stats.deadlocksPerSecond`
            </td>

            <td>
            The number of lock requests per second that resulted in a deadlock since the last restart.
            </td>
        </tr>

        <tr>
            <td>
            `stats.killConnectionErrorsPerSecond`
            </td>

            <td>
            The number of kill connection errors per second since the last restart.
            </td>
        </tr>

        <tr>
            <td>
            `stats.lockWaitsPerSecond`
            </td>

            <td>
            The number of times per second that Microsoft SQL Server is unable to retain a lock right away for a resource.
            </td>
        </tr>

        <tr>
            <td>
            `stats.sqlCompilations`
            </td>

            <td>
            The number of Microsoft SQL Server compilations per second.
            </td>
        </tr>

        <tr>
            <td>
            `stats.sqlRecompilationsPerSecond`
            </td>

            <td>
            The number of Microsoft SQL Server re-compilations per second.
            </td>
        </tr>

        <tr>
            <td>
            `stats.userErrorsPerSecond`
            </td>

            <td>
            The number of user errors per second since the last restart.
            </td>
        </tr>

        <tr>
            <td>
            `system.bufferPoolHitPercent`
            </td>

            <td>
            The percentage of buffer pools hits on the instance.
            </td>
        </tr>

        <tr>
            <td>
            `system.waitTimeInMillisecondsPerSecond`
            </td>

            <td>
            The number of milliseconds per second spent waiting across the instance.
            </td>
        </tr>
        </tbody>
    </table>
    </Collapser>

    <Collapser
    id="wait-metric"
    title="Wait metrics"
    >
    These attributes can be found by querying the `MssqlWaitSample` event.

    <table>
        <thead>
        <tr>
            <th style={{ width: "350px" }}>
            Metric
            </th>

            <th>
            Description
            </th>
        </tr>
        </thead>

        <tbody>
        <tr>
            <td>
            `system.waitTimeCount`
            </td>

            <td>
            Total wait time for this wait type, in milliseconds. This time is inclusive of `signal_wait_time_ms`.
            </td>
        </tr>

        <tr>
            <td>
            `system.waitTimeInMillisecondsPerSecond`
            </td>

            <td>
            The number of waits on this wait type, in milliseconds. This counter is incremented at the start of each wait.
            </td>
        </tr>
        </tbody>
    </table>
    </Collapser>
    </CollapserGroup>

### Microsoft SQL Server instance settings [#instance-settings]

The Microsoft SQL Server integration collects both metrics and inventory information. In the table, use the <DNT>**Applies to**</DNT> column for the settings available to each collection:


<CollapserGroup>
    <Collapser
    id="settings"
    title="Microsoft SQL Server instance settings"
    >
    <table>
    <thead>
    <tr>
        <th style={{ width: '150px' }}>
        Setting
        </th>

        <th>
        Description
        </th>

        <th>
        Default
        </th>

        <th>
        Applies to
        </th>
    </tr>
    </thead>

    <tbody>
    <tr>
        <td>
        `HOSTNAME`
        </td>

        <td>
        Hostname or IP where Microsoft SQL Server is running.
        </td>

        <td>
        `127.0.0.1`
        </td>

        <td style={{ "text-align": "center" }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `PORT`
        </td>

        <td>
        Port on which Microsoft SQL Server is listening.
        <br/>
        <DNT>**Note**</DNT>: Port is only required when `INSTANCE` is not specified.
        </td>

        <td>
        `1433`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `INSTANCE`
        </td>

        <td>
        The Microsoft SQL Server instance to connect to.
        <br/>
        <DNT>**Note**</DNT>: Only required when `PORT` is not specified. Do not use both.
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `USERNAME`
        </td>

        <td>
        Username for accessing the Microsoft SQL Server.
        <br/>
        If using a domain user use the syntax `domain\user`
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `PASSWORD`
        </td>

        <td>
        Password for the given SQL or Domain user.
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `EXTRA_CONNECTION_URL_ARGS`
        </td>

        <td>
        Specify extra connection parameters as attr1=val1&attr2=val2.
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `ENABLE_SSL`
        </td>

        <td>
        Use SSL to connect to the Microsoft SQL Server.
        </td>

        <td>
        `false`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `TRUST_SERVER_CERTIFICATE`
        </td>

        <td>
        if set to `true`, server certificate is NOT verified for SSL.
        </td>

        <td>
        `false`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `CERTIFICATE_LOCATION`
        </td>

        <td>
        Location of the SSL Certificate.
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `TIMEOUT`
        </td>

        <td>
        Timeout for queries, in seconds. Set `0` for no timeout.
        </td>

        <td>
        `30`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M/I
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `ENABLE_BUFFER_METRICS`
        </td>

        <td>
        Enable collection of buffer pool metrics. These can be resource intensive
        for large systems.
        </td>

        <td>
        `true`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `ENABLE_DATABASE_RESERVE_METRICS`
        </td>

        <td>
        Enable collection of database partition reserve space. These can be resource
        intensive for large systems.
        </td>

        <td>
        `true`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M
        </td>
    </tr>

    {
        ' '
    }
    <tr>
        <td>
        `ENABLE_DISK_METRICS_IN_BYTES`
        </td>

        <td>
        Enable collection of the volume stats for each MSSQL instance.
        </td>

        <td>
        `true`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M
        </td>
    </tr>

  {
      ' '
  }

    <tr>
        <td>
        `CUSTOM_METRICS_QUERY`
        </td>

        <td>
        A SQL query to collect custom metrics. See the [custom query example](#custom-query).
        </td>

        <td>
        N/A
        </td>

        <td style={{ 'text-align': 'center' }}>
        M
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `CUSTOM_METRICS_CONFIG`
        </td>

        <td>
        YAML configuration with one or more SQL queries to collect custom metrics.
        See the [multiple custom queries example](#multi-custom-query).
        </td>

        <td>
        `false`
        </td>

        <td style={{ 'text-align': 'center' }}>
        M
        </td>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `METRICS`
        </td>

        <td>
        Set to `true` to enable metrics-only collection.
        </td>

        <td>
        `false`
        </td>

        <td style={{ 'text-align': 'center' }}/>
    </tr>

    {
        ' '
    }

    <tr>
        <td>
        `INVENTORY`
        </td>

        <td>
        Set to `true` to enable inventory-only collection.
        </td>

        <td>
        `false`
        </td>

        <td style={{ 'text-align': 'center' }}/>
    </tr>
    </tbody>
    </table>

    The values for these settings can be defined in several ways:

    * Adding the value directly in the config file. This is the most common way.

    * Replacing the values from environment variables using the `{{ }}` notation. Read more about [using environment variable passthroughs with on-host integrations](/docs/infrastructure/install-infrastructure-agent/configuration/configure-infrastructure-agent/#passthrough) or see the example for [environment variables replacement](/docs/infrastructure/host-integrations/host-integrations-list/elasticsearch/elasticsearch-integration#envvar-replacement).
    <Callout variant="important">This requires infrastructure agent v1.14.0+.</Callout>

    * Using secrets management. Use this to protect sensitive information, such as passwords that would be exposed in plain text on the configuration file. For more information, see [secrets management](/docs/integrations/host-integrations/installation/secrets-management).

    </Collapser>
</CollapserGroup>


### Metrics collected by query performance monitoring [#query-monitor]

<CollapserGroup>
    <Collapser
    id="blockingSession"
    title="Blocking session metrics"
    >
    These attributes can be found by querying the `MSSQLBlockingSessionQueries` event.
    <table>
        <thead>
        <tr>
            <th>Metric</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>`blocking_spid`</td>
            <td>The ID of the blocking session.</td>
        </tr>
        <tr>
            <td>`blocking_status`</td>
        <td>The status of the blocking session.</td>
        </tr>
        <tr>
            <td>`blocked_spid`</td>
            <td>The ID of the blocked session.</td>
        </tr>
        <tr>
            <td>`blocked_status`</td>
            <td>The status of the blocked session.</td>
        </tr>
        <tr>
            <td>`wait_type`</td>
            <td>The type of wait experienced by the blocked session.</td>
        </tr>
        <tr>
            <td>`wait_time_in_seconds`</td>
            <td>The time the session has been waiting in seconds.</td>
        </tr>
        <tr>
            <td>`command_type`</td>
            <td>The type of command being performed.</td>
        </tr>
        <tr>
            <td>`database_name`</td>
            <td>The name of the database where the blocking is occurring.</td>
        </tr>
        <tr>
            <td>`blocking_query_text`</td>
            <td>The text of the query causing the block.</td>
        </tr>
        <tr>
            <td>`blocked_query_text`</td>
            <td>The text of the query being blocked.</td>
        </tr>
        <tr>
            <td>`blocked_query_start_time`</td>
            <td>The start time of the blocked query.</td>
        </tr>
        </tbody>
    </table>
    </Collapser>

    <Collapser
    id="executionPlan"
    title="Query execution plan metrics">

    These attributes can be found by querying the `MSSQLQueryExecutionPlans` event.
    
    <table>
        <thead>
            <tr>
                <th>Metric</th>
                <th>Description</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>`sql_text`</td>
                <td>The SQL statement text.</td>
            </tr>
            <tr>
                <td>`query_id`</td>
                <td>The unique identifier for the query.</td>
            </tr>
            <tr>
                <td>`query_plan_id`</td>
                <td>The unique identifier for the query plan.</td>
            </tr>
            <tr>
                <td>`NodeId`</td>
                <td>The ID of the node in the execution plan.</td>
            </tr>
            <tr>
                <td>`PhysicalOp`</td>
                <td>The physical operation performed by this node.</td>
            </tr>
            <tr>
                <td>`LogicalOp`</td>
                <td>The logical operation represented by this node.</td>
            </tr>
            <tr>
                <td>`EstimateRows`</td>
                <td>The estimated number of rows this operation will produce.</td>
            </tr>
            <tr>
                <td>`EstimateIO`</td>
                <td>The estimated I/O cost of this operation.</td>
            </tr>
            <tr>
                <td>`EstimateCPU`</td>
                <td>The estimated CPU cost of this operation.</td>
            </tr>
            <tr>
                <td>`AvgRowSize`</td>
                <td>The average size of the rows processed by this node.</td>
            </tr>
            <tr>
                <td>`TotalSubtreeCost`</td>
                <td>The estimated total cost for running this subtree.</td>
            </tr>
            <tr>
                <td>`EstimatedOperatorCost`</td>
                <td>The cost estimate of the node's operation.</td>
            </tr>
            <tr>
                <td>`EstimatedExecutionMode`</td>
                <td>The estimated execution mode of this operation.</td>
            </tr>
            <tr>
                <td>`GrantedMemoryKb`</td>
                <td>The amount of memory granted for this query in kilobytes.</td>
            </tr>
            <tr>
                <td>`SpillOccurred`</td>
                <td>A boolean indicator of whether a spill occurred.</td>
            </tr>
            <tr>
                <td>`NoJoinPredicate`</td>
                <td>A boolean indicator of whether there is a join predicate.</td>
            </tr>
            <tr>
                <td>`total_worker_time`</td>
                <td>The total worker time in milliseconds.</td>
            </tr>
            <tr>
                <td>`total_elapsed_time`</td>
                <td>The total elapsed time in milliseconds.</td>
            </tr>
            <tr>
                <td>`total_logical_reads`</td>
                <td>The total number of logical reads performed.</td>
            </tr>
            <tr>
                <td>`total_logical_writes`</td>
                <td>The total number of logical writes performed.</td>
            </tr>
            <tr>
                <td>`execution_count`</td>
                <td>The number of times the query was executed.</td>
            </tr>
            <tr>
                <td>`plan_handle`</td>
                <td>The plan handle used for retrieving the plan.</td>
            </tr>
            <tr>
                <td>`avg_elapsed_time_ms`</td>
                <td>The average elapsed time in milliseconds.</td>
            </tr>
        </tbody>
    </table>
    </Collapser>

    <Collapser 
        id="waitTime"
        title="Wait event metrics">

    These attributes can be found by querying the `MSSQLWaitTimeAnalysis` event.
    
        <table>
            <thead>
            <tr>
                <th>Metric</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>`query_id`</td>
                <td>The unique identifier for the query.</td>
            </tr>
            <tr>
                <td>`database_name`</td>
                <td>The name of the database.</td>
            </tr>
            <tr>
                <td>`query_text`</td>
                <td>Contains the normalized and anonymized version of the SQL query where literal values are replaced with placeholders.</td>
            </tr>
            <tr>
                <td>`wait_category`</td>
                <td>The category of wait experienced by the query.</td>
            </tr>
            <tr>
                <td>`total_wait_time_ms`</td>
                <td>The total amount of wait time in milliseconds.</td>
            </tr>
            <tr>
                <td>`avg_wait_time_ms`</td>
                <td>The average amount of wait time in milliseconds.</td>
            </tr>
            <tr>
                <td>`wait_event_count`</td>
                <td>The count of wait events that occurred.</td>
            </tr>
            <tr>
                <td>`last_execution_time`</td>
                <td>The time of the last execution of the query.</td>
            </tr>
            <tr>
                <td>`collection_timestamp`</td>
                <td>The timestamp of when the data was collected.</td>
            </tr>
            </tbody>
        </table>
    </Collapser>

    <Collapser 
        id="slowQueries"
        title="Slow query metrics">

    These attributes can be found by querying the `MSSQLTopSlowQueries` event.

    <table>
        <thead>
        <tr>
            <th >Metrics</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>`query_id`</td>
            <td>The unique identifier for the query.</td>
        </tr>
        <tr>
            <td>`query_text`</td>
            <td>Contains the normalized and anonymized version of the SQL query where literal values are replaced with placeholders.</td>
        </tr>
        <tr>
            <td>`database_name`</td>
            <td>The name of the database.</td>
        </tr>
        <tr>
            <td>`schema_name`</td>
            <td>The name of the schema.</td>
        </tr>
        <tr>
            <td>`last_execution_timestamp`</td>
            <td>The timestamp of the last execution of the query.</td>
        </tr>
        <tr>
            <td>`execution_count`</td>
            <td>The number of times the query was executed.</td>
        </tr>
        <tr>
            <td>`avg_cpu_time_ms`</td>
            <td>The average CPU time in milliseconds.</td>
        </tr>
        <tr>
            <td>`avg_elapsed_time_ms`</td>
            <td>The average elapsed time in milliseconds.</td>
        </tr>
        <tr>
            <td>`avg_disk_reads`</td>
            <td>The average number of disk reads.</td>
        </tr>
        <tr>
            <td>`avg_disk_writes`</td>
            <td>The average number of disk writes.</td>
        </tr>
        <tr>
            <td>`statement_type`</td>
            <td>The type of SQL statement.</td>
        </tr>
        <tr>
            <td>`collection_timestamp`</td>
            <td>The timestamp of when the data was collected.</td>
        </tr>
        </tbody>
    </table>
    </Collapser>
</CollapserGroup>



## Inventory data [#inventory]

The Microsoft SQL Server integration captures the configuration parameters and current settings from your SQL Server environment. It collects the results of the `sp_configure` stored procedure, as well as current running configuration settings from the `sys.configurations` table. The data is available on the [Inventory page](/docs/infrastructure/new-relic-infrastructure/infrastructure-ui-pages/infrastructure-inventory-page-search-your-entire-infrastructure), under the `config/mssql` source.

For more about inventory data, see [Understand integration data](/docs/infrastructure/integrations-getting-started/getting-started/understand-integration-data-data-types#inventory-data).
