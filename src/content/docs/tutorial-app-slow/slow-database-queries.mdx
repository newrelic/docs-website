---
title: Diagnose slow database queries
metaDescription: Improve query performance by troubleshooting your slow database with the New Relic database UI.
redirects:
  - /docs/journey-app-slow/slow-database-queries/
---

import apmDefaultDatabaseUI from 'images/apm_screenshot-full_default-database-UI.webp'

import apmATimesliceChartofTop5DatabaseOperations from 'images/apm_screenshot-crop_A-timeslice-chart-of-top-5-database-operations.webp'

import apmTopDatabasesbyQueryTime from 'images/apm_screenshot-crop_Top-databases-by-query-time.webp'

import apmDatabaseThroughput from 'images/apm_screenshot-crop_Database-throughput.webp'

import apmDiggingDeeperIntoYourDatabase from 'images/apm_screenshot-full_Digging-deeper-into-your-database.gif'

## Objectives [#objectives]

By the end of this tutorial, you will:

* Identify slow database queries
* Understand how to resolve slow database queries
* Understand how to use the database UI 

## Why optimize on database queries

When your app is disrupted, your customers are left waiting while you troubleshoot a problem that's as complex as your system. Your data's reporting and you have a rough idea of what could be the problem, but where do you start? 

If your site relies on a database (and it probably does), you'll want to check that query response time is performing as expected. Often, the performance of your site depends on how well your database handles queries sent by your customers. With New Relic, you can use our database UI to track database performance over time, letting you pinpoint when a problem occurred so you can figure out what kind of solution you need. 

This tutorial explains how to troubleshoot slow queries in your database operations.  

## Scope out the problem with your app data  [#diagnose]

Our database UI displays charts built with NRQL queries. These charts use data from the `apm.service.datastore.operation.duration` metric reported by the agent you installed. These charts show the response time of your top database processes by the top operations, their query time, and your app's throughput. 

When you're scoping out a problem, we recommend using each of these different entry points as they tell different parts of the same story. Let's walk through how you might use the UI to begin diagnosing performance issues. 

<img
  title="Default database homepage"
  alt="Default database homepage"
  src={apmDefaultDatabaseUI}
/>

<figcaption>
  To begin troubleshooting your slowest queries, you'll start on APM's default database UI. 
</figcaption>

<Steps>
<Step>
  Navigate to the databases UI: Go to **[one.newrelic.com](https://one.newrelic.com/nr1-core?filters=(domain%3D'APM'ANDtype%3D'APPLICATION')) > (select an app) > monitor > databases**
</Step>  
<Step>

  ### Time consumed by database operations

  The **Most time consuming** chart shows the total processing time on queries by a database operation. 

<SideBySide>
  <Side>
 This chart that displays five database operations, then tracks their time to execute a query. This chart shows your busiest, most frequently called queries at the top. If an infrequently called query trends with your busiest queries it may indicate a problem with a query that needs further scoping to understand why it consumes so much processing time. 
  </Side>

  <Side>
<img
  title="Top 5 Database operations over time"
  alt=""
  src={apmATimesliceChartofTop5DatabaseOperations}
/>

<figcaption>
  The database UI shows graphs of your database operations over time.
</figcaption> 

</Side>
</SideBySide>

 
    
</Step>

<Step>

### Top databases by query time

The **Top databases by query time** chart shows how your databases are performing based on how long it takes to execute a query. 

<SideBySide>
  <Side>
  This NRQL query creates a chart that displays top databases, then averages how long queries take. For example, if, on average, your Redis EVAL database averages about a half-second to process a query, but query time increased by two seconds, then you know to dig deeper into individual queries. 
  </Side>

  <Side>
    <img
  title="Top databases by query time"
  alt=""
  src={apmTopDatabasesbyQueryTime}
/>

<figcaption>
  The database UI shows you graphs of your top databases by query time.
</figcaption>
  </Side>

</SideBySide>


</Step>

<Step>

### Top databases by throughput

The **Top databases by throughput** chart shows your database throughput over time. 

<SideBySide>
  <Side>
The throughput graphs tracks the number of processes an operation executes in a given time range. If your throughput tanks, you know to dig deeper into a particular operation. 
</Side>
  <Side>
    <img
  title="Top 5 Database operations over time"
  alt=""
  src={apmDatabaseThroughput}
/>

<figcaption>
  The database UI shows you graphs of your top databases by throughput.
</figcaption>
  </Side>
</SideBySide>



</Step>
</Steps>

## Digging deeper into your database queries [#fix]

Digging deeper means following the data. Identifying the approximate area where a problem exists is only part of finding a solution. 

After looking at how your database performs on average, your next step is to follow the data with query time, transactions, and stack traces.


<DocTiles numbered>
  <DocTile title='Prepare to triage your application' path="/docs/journey-app-slow/root-causes" ></DocTile>
  <DocTile title='Identify problematic transactions' path="/docs/journey-app-slow/problematic-transactions" ></DocTile>
</DocTiles>

<DocTiles>
  <DocTile title='Identify slow database queries' number='3' label={{text: 'Current doc', color: '#FCD672'}} path="/docs/journey-app-slow/slow-database-queries" ></DocTile>
  <DocTile title='Identify slow external services' number='4' path="/docs/journey-app-slow/external-services" ></DocTile>
  <DocTile title='Create performance benchmarks' number='5' path="/docs/journey-app-slow/create-benchmarks/" ></DocTile>
</DocTiles>
