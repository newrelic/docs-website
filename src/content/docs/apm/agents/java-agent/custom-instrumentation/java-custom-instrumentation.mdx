---
title: Java custom instrumentation
tags:
  - Agents
  - Java agent
  - Custom instrumentation
translate:
  - jp
metaDescription: An overview of the ways you can implement custom instrumentation for your New Relic-monitored Java application.
redirects:
  - /docs/agents/java-agent/custom-instrumentation/java-custom-instrumentation
  - /docs/java/java-custom-metric-collection
  - /docs/java/custom-instrumentation-with-the-java-agent
  - /docs/java/custom-instrumentation-for-java
  - /docs/java/java-custom-instrumentation
  - /docs/agents/java-agent/instrumentation
  - /docs/agents/java-agent/custom-instrumentation/
---

[APM for Java](/docs/agents/java-agent/getting-started/introduction-new-relic-java) will typically produce useful performance data automatically. However, if New Relic does not [support your framework](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent), or if you want to set up additional monitoring, you will want to implement custom instrumentation.

[Custom instrumentation](/docs/apm/agents/manage-apm-agents/agent-data/custom-instrumentation/) allows you to track interactions that aren't captured by New Relic's automatic instrumentation, and lets you add detail to your [transaction traces](/docs/traces/transaction-traces), to help you identify key issues.

New Relic collects [metrics and events](/docs/data-analysis/metrics/analyze-your-metrics/data-collection-metric-timeslice-event-data) from many frameworks automatically. If you are using a [supported framework or component](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent), you may see some transaction information out of the box, and custom instrumentation can be used to supplement the information the agent reports by default.

<Callout variant="important">
  If you are using a supported framework, but are not seeing [transactions](/docs/apm/applications-menu/monitoring/transactions-page), get support at [support.newrelic.com](https://support.newrelic.com) to ensure the framework instrumentation is working.
</Callout>

## When to choose custom instrumentation [#choosing]

Choose custom instrumentation in these situations:

* New Relic does not support your framework and transactions do not appear in the UI
* You would like to add detail to your transaction traces
* Transaction traces include large blocks of `application code` time without sufficient detail

## Implement custom instrumentation [#implementing]

You can implement custom instrumentation with one of these methods:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **Method**
      </th>

      <th>
        **Description**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        The New Relic UI
      </td>

      <td>
        New Relic for Java includes an option in the UI for custom instrumentation called the [Custom Instrumentation Editor](/docs/agents/java-agent/custom-instrumentation/custom-instrumentation-editor-quickly-customize-your-java-instrumentation). This option doesn't require any direct modification of your application code, so is a good choice if you don't want to or can't modify your code. The editor is, however, fairly limited in functionality compared to the Java agent API.
      </td>
    </tr>

    <tr>
      <td>
        API annotation
      </td>

      <td>
        Using the New Relic Java agent API, you can [annotate the methods in your application code](/docs/agents/java-agent/custom-instrumentation/java-instrumentation-annotation) that you want to monitor. The annotation method is robust and easy to troubleshoot. If you are willing to modify your source code, annotation is the recommended method. If you have many methods you want to instrument, you might prefer [XML instrumentation](#xml).

        For more about the API and its other functions, see [Intro to the Java agent API](/docs/agents/java-agent/custom-instrumentation/java-agent-api).
      </td>
    </tr>

    <tr>
      <td>
        XML
      </td>

      <td>
        If you can't modify your code, or if you need to instrument many methods, XML instrumentation is the best custom instrumentation method. With this method, you specify the classes you want to instrument in an external XML file.

        While XML instrumentation is powerful, it is also more difficult to use than the other instrumentation methods. For simpler instrumentation needs, New Relic recommends [annotation](#annotation) or [instrumentation via the UI](#instrument-ui). For more information, see [Java instrumentation by XML](/docs/java/custom-instrumentation-by-xml).
      </td>
    </tr>
  </tbody>
</table>

You can also monitor Java Management Extensions (JMX) via custom instrumentation. JMX is a way to monitor and manage applications, devices, and services. You can implement JMX monitoring via an [external **YAML** file](/docs/java/custom-jmx-instrumentation-by-yml).
