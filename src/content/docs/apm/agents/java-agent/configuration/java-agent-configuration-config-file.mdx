---
title: 'Java agent configuration: Config file'
tags:
  - Agents
  - Java agent
  - Configuration
translate:
  - jp
  - kr
metaDescription: "New Relic's Java agent config settings for APM, including transaction tracer, errors, custom instrumentation, distributed tracing, system properties, etc."
redirects:
  - /docs/agents/java-agent/configuration/java-agent-configuration-config-file
  - /docs/docs/java-agent-configuration
  - /docs/java/java-agent-configuration
  - /docs/java/java-agent-server-side-configuration
  - /docs/agents/java-agent/configuration/java-agent-configuration-server-side-config
  - /docs/agents/java-agent/custom-instrumentation/file-location
  - /docs/java-agent/configuration
  - /docs/agents/java-agent/configuration
signupBanner:
  text: Monitor and improve your entire stack. 100GB free. Forever.
---

import apmJavaConfigPrecedence from 'images/apm_diagram_Java-config-precedence.png'

The New Relic Java agent reads its configuration from the `newrelic.yml` file. By default the agent looks for this file in the [directory](/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent) that contains `newrelic.jar`. You can override the config file's location by setting the [`newrelic.config.file`](#newrelic-config-file) system property to a fully qualified file name.

You'll be able to configure our Java agent to suit your environnment after you [create a New Relic account](https://newrelic.com/signup) (it's free, forever) and [install the Java agent](/docs/apm/agents/java-agent/installation/install-java-agent/).

## Configuration file structure [#Structure]

The `newrelic.yml` file is split into stanzas corresponding to different environments:

* Test
* Development
* Staging
* Production (default)

New Relic applies settings in the common stanza to each of these environments. You can select other environments as the default by setting the [`newrelic.environment`](#newrelic-environment) system property to the environment name.

<Callout variant="tip">
  A [`newrelic.yml` template](/docs/java/java-agent-config-file-template) is available.
</Callout>

If you edit `newrelic.yml`, be careful to conform to the [YAML format](https://en.wikipedia.org/wiki/YAML). Use a YAML validator to ensure the syntax is accurate before using the file with New Relic's Java agent, and follow these rules:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **Java agent newrelic.yml**
      </th>

      <th>
        **Requirements**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Format
      </td>

      <td>
        YML files are case sensitive.
      </td>
    </tr>

    <tr>
      <td>
        Indentations
      </td>

      <td>
        All indentations must be in increments of two characters. Other indentations will result in an `Unable to parse configuration file` error upon agent startup.

        * Use the same level of indentation for data in the same stanza of the file.
        * Indent any sub-stanzas by an additional two spaces.
      </td>
    </tr>

    <tr>
      <td>
        Changes to file
      </td>

      <td>
        You must restart your JVM host process for changes to take effect.

        **Exception:** Property changes to `log_level` and `audit_mode` do not require a restart. Property changes under circuit breaker don't require a restart.
      </td>
    </tr>
  </tbody>
</table>

## Configuration settings precedence [#config-options-precedence]

To override any setting in the config file, use a [system property override](#System_Properties). In certain environments, [environment variables](#Environment_Variables) can also be used to override both the config file and the system properties. The environment variables primarily exist to support Heroku. When used, [server-side configuration](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration) overrides all other configuration settings.

<img
  title="java-config-order.png"
  alt="java-config-order.png"
  src={apmJavaConfigPrecedence}
/>

<figcaption>
  With the Java agent, server-side configuration overrides all other settings. Environment variables override Java system properties. Java properties override user configuration settings in your `newrelic.yml` file. User settings override the `newrelic.yml` default settings.
</figcaption>

## Configuring the Java extensions directory [#extensions-directory]

The Java agent reads the configuration files on process startup. To identify the directory where the files are located, either create a new or specify an existing extensions directory:

<CollapserGroup>
  <Collapser
    id="create-extensions-directory"
    title="Create an extensions directory"
  >
    To create the extensions directory:

    1. Navigate to the directory where `newrelic.jar` and `newrelic.yml` are located. Create a directory named `extensions`.
    2. In `newrelic.yml`, check that the property [`extensions.dir`](#cfg-extensions-dir) is not set.
  </Collapser>

  <Collapser
    id="specify-extensions-directory"
    title="Specify an existing extensions directory"
  >
    To use an existing Java extensions directory:

    1. In your `newrelic.yml` file, locate the `common` section.
    2. Use the property [`extensions.dir`](#cfg-extensions-dir) to specify the location of the file.
  </Collapser>
</CollapserGroup>

## General configuration settings [#General]

Set these options in the `common` stanza. To [override](#System_Properties) any of these options, use a `newrelic.config` prefixed system property.

<CollapserGroup>
  <Collapser
    id="cfg-license_key"
    title="license_key (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    This setting is **required**. You must specify the [license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key) associated with your New Relic account. This key binds your agent's data to your account in the New Relic service.
  </Collapser>

  <Collapser
    id="cfg-app_name"
    title="app_name (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    This setting is **required**. Defines the [application name](/docs/site/naming-your-application) used to report data to New Relic.

    If [`enable_auto_app_naming`](#cfg-enable_auto_app_naming) is false, the agent reports all data to this application. Otherwise, the agent reports only background tasks (transactions for non-web applications) to this application.

    To report data to [more than one application](/docs/java/multiple-application-names), separate the application names with a semicolon. For example, to report data to **My Application** and **My Application 2** use this:

    ```yml
    app_name: My Application;My Application 2
    ```

    For more methods of naming your application, see [Name your Java application](/docs/agents/java-agent/configuration/name-your-java-application).
  </Collapser>

  <Collapser
    id="cfg-agent_enabled"
    title="agent_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Flag to enable the agent. Use this setting to force the agent to run or not run.
  </Collapser>

  <Collapser
    id="cfg-apdex_t"
    title="apdex_t (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Float
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `1.0`
          </td>
        </tr>
      </tbody>
    </table>

    The `apdex_t` threshold in seconds for the application's [Apdex](/docs/site/apdex-measuring-user-satisfaction) score. For Java agent versions 1.2.008 or higher, the `apdex_t` value is set in the UI and the value in `newrelic.yml` is ignored.
  </Collapser>

  <Collapser
    id="cfg-appserver_port"
    title="appserver_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Number to differentiate JVMs for the same app on the same machine. New Relic [uses host/port for uniqueness](/docs/agents/java-agent/configuration/hostname-logic-java#unique-identifier), so you can distinguish the JVMs by putting a switch like this into the startup arguments for each JVM:

    ```ini
    -Dnewrelic.config.appserver_port=<var>8081</var>
    ```

    Once you have used `appserver_port` to name the JVMs and restart them, you should be able to see them individually in the dropdown and in the profiling interface.

    <Callout variant="important">
      This is only a change for New Relic; it doesn't actually affect the port on which the host communicates in any way.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-audit_mode"
    title="audit_mode"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enables plain text logging of all data sent to New Relic to the agent logfile. This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.
  </Collapser>

  <Collapser
    id="ca_config_bundle"
    title="ca_bundle_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Value Format
          </th>

          <td>
            `/path/to/ca/cert/bundle.pem`
          </td>
        </tr>
      </tbody>
    </table>

    Specifies a path to a custom SSL certificate bundle that will be used by the agent to establish a secure connection to New Relic. If your custom SSL certificate bundle doesn't include certificates that are sufficient to connect to New Relic then you'll need to [merge the required certs into your custom certificate bundle](/docs/agents/java-agent/troubleshooting/ssl-or-connection-errors-java).
  </Collapser>

  <Collapser
    id="use_private_ssl"
    title="use_private_ssl"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    The following SSL certificates are bundled into the agent jar:

    ```
    META-INF/certs/eu-newrelic-com.pem
    META-INF/certs/eu01-nr-data-net.pem
    META-INF/certs/newrelic-com.pem
    ```

    By default (`use_private_ssl: false`) the agent will use the SSL certificates bundled into the JDK to establish a secure connection to New Relic or the custom SSL certificates bundle specified by `ca_bundle_path`. If you want to use the SSL certificates bundled with the agent, set `use_private_ssl: true`.

    Note: `use_private_ssl` will be ignored if `ca_bundle_path` is set.
  </Collapser>

  <Collapser
    id="cfg-enable_auto_app_naming"
    title="enable_auto_app_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enables the reporting of data separately for each web app. Set to `true` to enable support for auto app naming. The name of each web app is detected automatically and the agent reports data separately for each one. This provides a finer-grained performance breakdown for web apps in New Relic.

    For more information, see [Automatic application naming](/docs/agents/java-agent/configuration/automatic-application-naming).

    For more methods of naming your application, see [Name your Java application](/docs/agents/java-agent/configuration/name-your-java-application).
  </Collapser>

  <Collapser
    id="cfg-enable_auto_transaction_naming"
    title="enable_auto_transaction_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enables component-based transaction naming. Set to `true` to enable component-based transaction naming. Set to `false` to use the URI of a web request as the name of the transaction. For more information, see [Naming web transactions](/docs/agents/java-agent/instrumentation/naming-web-transactions).

    <Callout variant="caution">
      Unless you implement API calls to name your transactions, disabling auto-transaction naming is very likely to cause [Metric grouping issues](/docs/features/metric-grouping-issues).
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-enable_custom_tracing"
    title="enable_custom_tracing"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enables all instrumentation [using an `@Trace` annotation](/docs/agents/java-agent/custom-instrumentation/java-instrumentation-annotation). Disabling this causes `@Trace` annotations to be ignored.
  </Collapser>

  <Collapser
    id="event_ingest_uri"
    title="event_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            [`https://insights-collector.newrelic.com/v1/accounts/events`](https://insights-collector.newrelic.com/v1/accounts/events)
          </td>
        </tr>
      </tbody>
    </table>

    Event ingest URI used by some agent features. Defaults to the US production ingest endpoint. Can be manually configured to send events to other ingest endpoints (for example, EU production: [`https://insights-collector.eu01.nr-data.net/v1/accounts/events`](https://insights-collector.eu01.nr-data.net/v1/accounts/events)).
  </Collapser>

  <Collapser
    id="cfg-extensions-dir"
    title="extensions.dir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Defines the location of the optional [extensions directory](#extensions-directory). If this property is not set, the agent will look for a subdirectory named `extensions` in the same directory as `newrelic.jar` and `newrelic.yml`.
  </Collapser>

  <Collapser
    id="cfg-enable_high_security"
    title="high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    In order for [high security](/docs/subscriptions/high-security) to be enabled, this property must be set to `true` and the high security property in the New Relic user interface must be enabled. Enabling high security means SSL is turned on, request and message queue parameters are not collected, and queries cannot be sent to New Relic in their raw form.

    <Callout variant="important">
      As of [Java agent 3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480), SSL is enabled by default and the config option to disable it has been deprecated. As of [Java agent 4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400), the ability to disable SSL has been removed.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-host"
    title="host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Provides the ability to configure a [FedRAMP compliant endpoint](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/) for the agent to use, with the value `gov-collector.newrelic.com`.
  </Collapser>
  
  <Collapser
    id="cfg-insert_api_key"
    title="insert_api_key"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    A valid [Insert API Key](/docs/apis/get-started/intro-apis/types-new-relic-api-keys#event-insert-key) for your account. This is not currently used by the agent.
  </Collapser>

  <Collapser
    id="labels"
    title="labels"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    Attach [tags](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers) to this app.

    Note that this option now enables tags, which replaced the label feature. You can still query your historical [labels](/docs/new-relic-one/use-new-relic-one/core-concepts/tagging-use-tags-organize-group-what-you-monitor#labels). Multiple tags can be attached by using a semicolon as a separator as follows:
    ```ini
    -Dnewrelic.config.labels="tagName1:tagValue1;tagName2:tagValue2;tagName3:tagValue3"
    ```
  </Collapser>

  <Collapser
    id="max-stack-trace-lines"
    title="max_stack_trace_lines"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `30`
          </td>
        </tr>
      </tbody>
    </table>

    Limits the number of lines the agent collects from each stack trace. Increasing this value may impact performance, because it increases the amount of memory the agent uses and the amount of data sent to New Relic.
  </Collapser>

  <Collapser
    id="metric_ingest_uri"
    title="metric_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            [`https://metric-api.newrelic.com/metric/v1`](https://metric-api.newrelic.com/metric/v1)
          </td>
        </tr>
      </tbody>
    </table>

    Metric ingest URI used by some agent features. Defaults to the US production ingest endpoint. Can be manually configured to send metrics to other ingest endpoints (example EU production URI: [`https://metric-api.eu.newrelic.com/metric/v1`](https://metric-api.eu.newrelic.com/metric/v1)).
  </Collapser>

  <Collapser
    id="cfg-proxy_host"
    title="proxy_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    The proxy host through which to connect to the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). If a proxy is used, the host setting is required. Other proxy settings are optional.
  </Collapser>

  <Collapser
    id="cfg-proxy_password"
    title="proxy_password"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    The password for proxy authentication. If a proxy is used, the host setting is required. Other proxy settings are optional. The username and password settings will be used to authenticate to Basic Auth challenges from a proxy server.

    <Callout variant="important">
      The Java agent supports Basic (clear text) authentication.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-proxy_port"
    title="proxy_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `8080`
          </td>
        </tr>
      </tbody>
    </table>

    The proxy host port number. If a proxy is used, the host setting is required. Other proxy settings are optional.
  </Collapser>

  <Collapser
    id="cfg-proxy_user"
    title="proxy_user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    The username for proxy authentication, such as Basic (clear text) authentication. If a proxy is used, the host setting is required. Other proxy settings are optional. The username and password settings will be used to authenticate to Basic Auth challenges from a proxy server.
  </Collapser>

  <Collapser
    id="cfg-proxy_scheme"
    title="proxy_scheme"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    The proxy scheme used. Setting `proxy_scheme: "https"` will allow the agent to connect through proxies using the HTTPS scheme.
  </Collapser>

  <Collapser
    id="cfg-reactor-netty-errors-enabled"
    title="reactor-netty.errors.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Whether errors are reported for Reactor Netty. Default is false. If set to true, Reactor Netty errors will be reported.

    <Callout variant="important">
      Only available in [Java agent 6.3.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-630) and above.

      Notice, default was changed to false as of Java agent 6.5.0.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-send_data_on_exit"
    title="send_data_on_exit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable delayed JVM shutdown to give the agent a chance to send latest metric data to New Relic before JVM shutdown.
  </Collapser>

  <Collapser
    id="send_data_on_exit_threshold"
    title="send_data_on_exit_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `60`
          </td>
        </tr>
      </tbody>
    </table>

    The number of seconds after which the agent will use the [`send_data_on_exit`](#cfg-send_data_on_exit) setting.
  </Collapser>

  <Collapser
    id="cfg-send_environment_info"
    title="send_environment_info"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable reporting of JVM settings to New Relic.
  </Collapser>

  <Collapser
    id="cfg-send_jvm_props"
    title="send_jvm_props"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, JVM properties will be sent to New Relic.
  </Collapser>

  <Collapser
    id="cfg-ssl"
    title="ssl (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Requires connections to the New Relic collector to go over SSL.

    The agent communicates with New Relic via HTTPS by default, and New Relic [requires HTTPS](/docs/apis/rest-api-v2/troubleshooting/301-response-rest-api-calls) for all traffic to APM and the New Relic REST API.

    This work is done asynchronously to the threads that process your application code, so response times will not be directly affected by this change.
  </Collapser>

  <dd>
    <Callout variant="important">
      As of [Java agent 3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480), SSL is enabled by default and the config option to disable it has been deprecated. As of [Java agent 4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400), the ability to disable SSL has been removed.
    </Callout>
  </dd>

  <Collapser
    id="cfg-sync_startup"
    title="sync_startup"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable the agent to connect the New Relic collector immediately upon app startup.
  </Collapser>

  <Collapser
    id="scala-futures-segment"
    title="scala_futures_as_segments"
  >
    <Callout variant="important">
      This applies to Java agent [version 3.44.0 or higher](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    For more concise transaction trace details, the agent does not report Scala Futures as transaction segments, and those Futures do not contribute to the [transaction’s total time](/docs/data-analysis/user-interface-functions/view-your-data/response-time#response-time-total-time).

    Enabling `scala_futures_as_segments` increases your overhead. If you want Scala Futures to report as transaction segments so you can view them in a transaction trace, you can enable it:

    ```yml
    scala_futures_as_segments:
      enabled: true
    ```
  </Collapser>
</CollapserGroup>

## Environment variables [#Environment_Variables]

Environment variables take the highest precedence and override the system properties and yml config settings.

* To set environment variables, use the `export VARNAME=value` command.
* To permanently set environment variables, add the export line to a file such as `~/.bashrc` or `~/.bash_profile`.

You can override any setting from a system property or in the `newrelic.yml` by setting an environment variable. The environment variable corresponding to a given setting in the config file is the setting name prefixed by `NEW_RELIC` with all dots (`.`) and dashes (`-`) replaced by underscores (`_`). For example, the environment variable for the `log_level` setting is `NEW_RELIC_LOG_LEVEL`.

For settings nested in stanzas, prepend the stanza name to the setting name. For example, the environment variable for the `enabled` setting in the `transaction_tracer` stanza is `NEW_RELIC_TRANSACTION_TRACER_ENABLED`.

<Callout variant="important">
  Agent configuration via environment variables requires [Java agent version 4.10.0 or higher](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

For agent versions 4.10.0 or higher the following environment variables are available:

<CollapserGroup>
  <Collapser
    id="ev-NEW_RELIC_APP_NAME"
    title="NEW_RELIC_APP_NAME (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    This setting is **required**. Contains the application name under which to report data to New Relic. Set the name of your application as you want it to appear in New Relic.

    If `enable_auto_app_naming` is `false`, the agent reports all data to this application. Otherwise, the agent reports only background tasks (transactions for non-web applications) to this application.

    To report data to more than one application, separate the application names with a semicolon `;`. For example, to report data to **My Application** and **My Application 2**:

    ```yml
    app_name: My Application;My Application 2
    ```

    For more methods of naming your application, see [Name your Java application](/docs/agents/java-agent/configuration/name-your-java-application).
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_DISTRIBUTED_TRACING_ENABLED"
    title="NEW_RELIC_DISTRIBUTED_TRACING_ENABLED"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enables distributed tracing. Case sensitive: use `true` or `false`. For more information, see the [distributed tracing section](#dt-main).
  </Collapser>

  <Collapser
    id="NEW_RELIC_PROCESS_HOST_DISPLAY_NAME"
    title="NEW_RELIC_PROCESS_HOST_DISPLAY_NAME"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Set a [display name](/docs/agents/java-agent/configuration/hostname-logic-java#display-name) to decorate the "host:port" label in the New Relic UI.
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_LICENSE_KEY"
    title="NEW_RELIC_LICENSE_KEY (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    This setting is **required**. Contains your New Relic account license.

    You must specify the [license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key) associated with your New Relic account. This key binds your agent's data to your account in the New Relic service.
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_LOG"
    title="NEW_RELIC_LOG"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    The unqualified log file name or the string `STDOUT` which will log to standard out.
  </Collapser>
</CollapserGroup>

If you're using New Relic CodeStream to monitor performance from your IDE you may also want to [associate repositories with your services](/docs/codestream/how-use-codestream/performance-monitoring#repo-association) and [associate build SHAs or release tags with errors](/docs/codestream/how-use-codestream/performance-monitoring#buildsha).

## System properties [#System_Properties]

You can override any setting in the `newrelic.yml` file by setting a system property. The system property corresponding to a given setting in the config file is the setting name prefixed by `newrelic.config`. For example, the system property for the `log_level` setting is `newrelic.config.log_level`.

For settings nested in stanzas, prepend the stanza name to the setting name. For example, the system property for the `enabled` setting in the transaction_tracer stanza is `newrelic.config.transaction_tracer.enabled`.

In addition to overriding configuration settings, the following system properties are recognized by the agent:

<CollapserGroup>
  <Collapser
    id="newrelic-bootstrap_classpath"
    title="newrelic.config.process_host.display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Set a [display name](/docs/agents/java-agent/configuration/hostname-logic-java#display-name) to decorate the "host:port" label in the New Relic UI. Requires Java agent 3.17 or higher.
  </Collapser>

  <Collapser
    id="newrelic-config-file"
    title="newrelic.config.file"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    String containing a fully qualified path to the newrelic configuration file. If empty, the agent assumes `newrelic.yml` is in the same directory as `newrelic.jar`.
  </Collapser>

  <Collapser
    id="newrelic-debug"
    title="newrelic.debug"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Enable debug logging.
  </Collapser>

  <Collapser
    id="newrelic-environment"
    title="newrelic.environment"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    String containing the environment configuration for the agent to use.
  </Collapser>

  <Collapser
    id="newrelic-home"
    title="newrelic.home"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    String containing the home directory of agent. This defaults to the same directory as the agent jarfile.
  </Collapser>

  <Collapser
    id="newrelic-logfile"
    title="newrelic.logfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    String containing the name of the agent log file.
  </Collapser>
</CollapserGroup>

## Attributes [#attributes]

To set these options, use the `attributes` stanza. To [override](#System_Properties) them, use a `newrelic.config.attributes` prefixed system property.

Attributes are key-value pairs that provide information for transaction traces, traced errors, browser monitoring, and transaction events. There is also an attribute stanza under each destination. For more information, see [Java agent attributes](/docs/java/java-agent-attributes), [Enabling and disabling attributes](/docs/java/enabling-and-disabling-attributes) and [Attribute examples](/docs/java/attribute-examples).

<CollapserGroup>
  <Collapser
    id="cfg-attributes-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes.

    <Callout variant="important">
      For security reasons, capturing custom attributes using the [Custom Instrumentation Editor](/docs/agents/java-agent/custom-instrumentation/custom-instrumentation-editor-instrument-ui#options) is set to `false` by default.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-attributes-include"
    title="include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled, attribute keys found in this list will be sent to New Relic. Separate the keys in the list with a comma; for example:

    ```
    key1, key2, key3
    ```

    Also refer to the [agent attribute rules](/docs/subscriptions/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-attributes-exclude"
    title="exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic. Separate the keys in the list with a comma; for example:

    ```
    key1, key2, key3
    ```

    Also refer to the [agent attribute rules](/docs/subscriptions/agent-attributes).
  </Collapser>
</CollapserGroup>

## Async instrumentation [#async_config]

These options are set directly in the `common` stanza and can be [overridden](#System_Properties) by using a prefixed system property.

<CollapserGroup>
  <Collapser
    id="cfg-token_timeout"
    title="token_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default (seconds)
          </th>

          <td>
            `180`
          </td>
        </tr>
      </tbody>
    </table>

    The number of seconds after which the agent will automatically expire an async token that has not been explicitly expired with `token.expire()`. For usage instructions, see [Tokens: Connect async threads](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#tokens).

    <Callout variant="important">
      Increasing this value may impact performance, because it increases the amount of memory the agent uses and prevents transactions from being reported due to unexpired tokens.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-segment_timeout"
    title="segment_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default (seconds)
          </th>

          <td>
            `600`
          </td>
        </tr>
      </tbody>
    </table>

    The number of seconds after which the agent will automatically end a segment that has not been explicitly ended with `segment.end()` or `segment.ignore()`. For usage instructions, see [Segments: Time arbitrary async activity](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#segments).

    <Callout variant="important">
      Increasing this value may impact performance, because it increases the amount of memory the agent uses and prevents transactions from being reported due to un-ended segments.
    </Callout>
  </Collapser>
</CollapserGroup>

## Browser monitoring [#Browser_Monitoring]

These options are set in the `browser_monitoring` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.browser_monitoring` prefixed system property.

Browser monitoring gives you insight into the performance real users are experiencing with your website. This is accomplished by measuring the time it takes for your users' browsers to download and render your web pages by injecting a small amount of JavaScript code into the header and footer of each page.

<CollapserGroup>
  <Collapser
    id="bm-auto_instrument"
    title="auto_instrument"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    By default the agent automatically inserts API calls in compiled JSPs to inject the monitoring JavaScript into web pages. Set this attribute to `false` to turn off this behavior.
  </Collapser>

  <Collapser
    id="bm-disabled_auto_pages"
    title="disabled_auto_pages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Comma-separated list of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    When [`auto_instrument`](#bm-auto_instrument) is `true`, by default all pages are instrumented. List all pages that you want the auto instrumentation to skip here. You can still use manual instrumentation on these pages.

    For example:

    ```yml
    browser_monitoring:
      disabled_auto_pages: /WEB-INF/jsp/testpage_1.jsp, /WEB-INF/jsp/testpage_2.jsp
    ```
  </Collapser>

  <Collapser
    id="cfg-browser-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for browser monitoring. This is the [data you can query](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data). If `attributes.enabled` is false at the root level, no attributes will be sent up in browser monitoring regardless on how this property under `browser_monitoring` is set.
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for `browser_monitoring`, all attribute keys found in this list will be sent to New Relic in page views. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic in page views. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Circuit breaker

These settings customize the behavior of the [Java circuit breaker](/docs/agents/java-agent/custom-instrumentation/circuit-breaker-java-custom-instrumentation). These settings are not included in `newrelic.yml` by default. You do not need to restart your JVM after changing them.

If you want to customize the circuit breaker, add the stanza under the `common` stanza:

```yml
common: &default_settings​
  <var>OTHER_CONFIG_SETTINGS</var>
  circuitbreaker:
    enabled: <var>true</var>
    memory_threshold: <var>20</var>
    gc_cpu_threshold: <var>10</var>
```

<CollapserGroup>
  <Collapser
    id="cfg-circuitbreaker_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    If your application is behaving as expected, you may want to disable the circuit breaker.
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_memory_threshold"
    title="memory_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer (0 to 100)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    Customize the precentage of free heap memory below which the circuit breaker should trip. When the percentage of free heap memory is less than `memory_threshold`, and the CPU time spent doing garbage collection is greater than `gc_cpu_threshold`, the circuit breaker trips. In order to make the circuit breaker less likely to trip, decrease `memory_threshold` and/or increase `gc_cpu_threshold`. Adjust these values as needed, based on your application's operating performance and behavior.
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_gc_cpu_threshold"
    title="gc_cpu_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer (0 to 100)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10`
          </td>
        </tr>
      </tbody>
    </table>

    Customize the precentage of garbage collection CPU time above which the circuit breaker should trip. When the percentage of free heap memory is less than `memory_threshold`, and the CPU time spent doing garbage collection is greater than `gc_cpu_threshold`, the circuit breaker trips. In order to make the circuit breaker less likely to trip, decrease `memory_threshold` and/or increase `gc_cpu_threshold`. Adjust these values as needed, based on your application's operating performance and behavior.
  </Collapser>
</CollapserGroup>

## Cloud platform utilization [#utilization]

These options are set in the `utilization` stanza and can be overridden by using a `newrelic.config.utilization` prefixed system property.

The agent collects utilization information and sends it to the New Relic service. The agent can collect information from Amazon Web Services (AWS), Azure, Google Cloud Platform, and Pivotal Cloud Foundry instances. It will also collect information related to the Docker containers and Kubernetes services.

<CollapserGroup>
  <Collapser
    id="aws-enabled"
    title="detect_aws"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls AWS metadata API.
  </Collapser>

  <Collapser
    id="azure-enabled"
    title="detect_azure"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls Azure metadata API.
  </Collapser>
  
  <Collapser
    id="gcp-enabled"
    title="detect_gcp"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls Google Cloud Platform metadata API.
  </Collapser>
  
  <Collapser
    id="kubernetes-enabled"
    title="detect_kubernetes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent reports the `KUBERNETES_SERVICE_HOST` environment variable.
  </Collapser>
  
  <Collapser
    id="pcf-enabled"
    title="detect_pcf"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent reads Pivotal Cloud Foundry environment variables.
  </Collapser>
  
  <Collapser
    id="docker-enabled"
    title="detect_docker"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent reads Docker information from the file system.
  </Collapser>
</CollapserGroup>

## Code-level metrics

Code-level metrics give you detailed insight into how your code is performing at the method level. You'll see metrics for each method that's been automatically instrumented, or that's been instrumented by the @Trace annotation. For more information on code-level metrics, see [Performance monitoring with CodeStream](/docs/codestream/how-use-codestream/performance-monitoring).

The code-level metrics options are set in the `code_level_metrics` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.code_level_metrics` prefixed system property.

<CollapserGroup>
  <Collapser
    id="clm-enabled"
    title="enabled"
  >
    <table>
      <tbody>
      <tr>
        <th>
          Type
        </th>

        <td>
          Boolean
        </td>
      </tr>

      <tr>
        <th>
          Default
        </th>

        <td>
          `true`
        </td>
      </tr>
      </tbody>
    </table>

    [Code-level metrics](/docs/codestream/how-use-codestream/performance-monitoring/#code-level) is disabled by default in agent version 7.10.0. Set this to true to turn it on. Beginning in agent version 7.11.0 the default is, as noted above, `true`.
  </Collapser>
</CollapserGroup>

## Cross application tracer [#Cross_Application_Tracer]

<Callout variant="important">
  Cross application tracing has been deprecated as of agent version 7.4.0 and will be removed in a future agent version.

  Instead of using cross application tracing, we recommend our [distributed tracing](#distributed-tracing) features. Distributed tracing is an improvement on the cross application tracing feature and is recommended for large, distributed systems.
</Callout>

The cross application tracing options are set in the `cross_application_tracer` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.cross_application_tracer` prefixed system property.

[Cross application tracing](/docs/apm/transactions/cross-application-traces/cross-application-tracing) adds request and response headers to external calls using the Apache HttpClient libraries. This provides better performance data when calling applications monitored by other New Relic agents.

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="enabled (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [Cross application tracing](/docs/apm/transactions/cross-application-traces/cross-application-tracing) is enabled by default. Set this to false to turn it off.
  </Collapser>
</CollapserGroup>

## Custom events [#Custom_Events]

Custom events are set in the `custom_insights_events` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.custom_insights_events` prefixed system property.

APM lets you [record custom event data](/docs/insights/insights-data-sources/custom-data/insert-custom-events-new-relic-apm-agents) via the New Relic language agent APIs, which [you can then query](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data).

<Callout variant="important">
  For Java agent versions prior to 4.1.0, the following YAML configuration is recognized:

  ```yml
  custom_insights_events.enabled: true
    custom_insights_events.max_samples_stored: 5000
  ```

  For agent versions 4.1.0 and above, the YAML configuration uses the nested stanza formatting:

  ```yml
  custom_insights_events:
    enabled: false
    max_samples_stored: 5000
  ```
</Callout>

<CollapserGroup>
  <Collapser
    id="cie-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This enables the custom event service.
  </Collapser>

  <Collapser
    id="cie-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `30000`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of sampled custom events reported every 60 seconds.
  </Collapser>
</CollapserGroup>

## Custom instrumentation [#Custom_Instrumentation]

These options set in the `class_transformer` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.class_transformer` prefixed system property.

<CollapserGroup>
  <Collapser
    id="ci-trace_annotation_class_name"
    title="trace_annotation_class_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    String containing the full class name of the annotation class the agent uses to determine which user-specified methods to instrument. For more information about custom annotations, see [Java custom metric collection](/docs/java/java-custom-metric-collection).
  </Collapser>

  <Collapser
    id="servlet-user"
    title="com.newrelic.instrumentation.servlet-user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable this option to capture the `userPrincipal` name. This name is included as a transaction trace attribute, and [can be queried](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data).
  </Collapser>
</CollapserGroup>

## Distributed tracing [#dt-main]

<Callout variant="important">
  Enabling distributed tracing disables [cross application tracing](#Cross_Application_Tracer), and has other effects on APM features. Before enabling, read the [transition guide](/docs/transition-guide-distributed-tracing).

  Requires [Java agent version 4.3.0 or higher](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

[Distributed tracing](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) lets you see the path that a request takes as it travels through a distributed system. It is on by default for Java agent version 7.4.0 or higher.

In the config file, you can override this manually in the `distributed_tracing` stanza. You can also override this using a prefixed system property (`newrelic.config.distributed_tracing`) or an environment variable (`NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`). See the examples below.

For more information about setting up distributed tracing, see [Enable distributed tracing for your Java applications](/docs/apm/agents/go-agent/instrumentation/distributed-tracing-go-agent).

<CollapserGroup>
  <Collapser
    id="dt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Set this to `false` to disable distributed tracing. For example, in the config file, you would use:

    ```yml
    distributed_tracing:
      enabled: false
    ```

    Here are other options to disable distributed tracing:

    [System property](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties):

    ```ini
    -Dnewrelic.config.distributed_tracing.enabled=false
    ```
    Evironment variable:

    ```ini
    NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=false
    ```
  </Collapser>

  <Collapser
    id="dt-exclude_newrelic_header"
    title="exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    By default, supported versions of the agent utilize both the `newrelic` header and W3C Trace Context headers for distributed tracing. The `newrelic` distributed tracing header allows interoperability with older agents that don't support W3C Trace Context headers. Agent versions that support W3C Trace Context headers will prioritize them over `newrelic` headers for distributed tracing.

    If you do not want to utilize the `newrelic` header, setting this to `true` will result in the agent excluding the `newrelic` header and only using W3C Trace Context headers for distributed tracing.

    For example, to exclude `newrelic` headers in the config file, you would use:

    ```yml
    distributed_tracing:
      exclude_newrelic_header: true
    ```

    To exclude `newrelic` headers using a [system property](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties), you would use:

    ```ini
    -Dnewrelic.config.distributed_tracing.exclude_newrelic_header=true
    ```
  </Collapser>
</CollapserGroup>

## Error collector [#Error_Collector]

These options are set in the `error_collector` stanza and unless noted otherwise can be [overridden](#System_Properties) by using a `newrelic.config.error_collector` prefixed system property. The error collector captures information about uncaught exceptions and sends them to New Relic for viewing.

<Callout variant="tip">
  For how to configure errors for the Java agent, including how to configure errors via the UI, see [Java agent error configuration](/docs/agents/java-agent/configuration/java-agent-error-configuration).
</Callout>

<CollapserGroup>
  <Collapser
    id="ec-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable error collection.
  </Collapser>

  <Collapser
    id="ec-ignore_classes"
    title="ignore_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Stanza containing a list of fully qualified `class_name` strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Specified exception class names will be ignored and will not affect error rate or Apdex score, or be reported to APM. **Cannot be specified by system property.**

    This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

    For example:

    ```yml
    error_collector:
      ignore_classes:
        - "com.example.MyException"
        - "com.example.DifferentException"
    ```

    An environment variable can be used to list exception class names you want to be ignored:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_messages"
    title="ignore_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Stanza containing a fully qualified `class_name` and a list of `messages` per error class
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Specify exception class names the agent should ignore. Ignored messages will not affect error rate or Apdex score, or be reported to APM. Contains `yaml` pairs consisting of:

    * A fully qualified exception class name that should not be reported to APM

      AND
    * A list of exception `message`s to match against (at least one is required)

      If the exception class name matches an error but the message does not, then that error **will not** be ignored. Message strings use `contains` for matching. A message cannot be provided on its own and must always be paired with a fully qualified class name. **Cannot be specified by system property.**

      This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

      For example:

      ```yml
      error_collector:
        ignore_messages:
          com.example.MyException:
            - "Some error message to ignore"
            - "Some other error message to ignore"
          com.example.DifferentException:
            - "Some different error message to ignore"
      ```

      An environment variable can be used to list exception class names and messages you want to be ignored:

      ```ini
      NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
      ```
  </Collapser>

  <Collapser
    id="ec-ignore_status_codes"
    title="ignore_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Comma-separated list of strings and ranges
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `404`
          </td>
        </tr>
      </tbody>
    </table>

    A comma-separated list comprised of individual and dashed ranges of HTTP status codes that should not be treated as errors.

    If this property is commented out in the `newrelic.yml` configuration file, then the 404 status code will automatically be ignored. When using [server-side configuration](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration), the status code 404 must be specified in order for it to be ignored.

    This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

    For example:

    ```yml
    error_collector:
      ignore_status_codes: 404,507-511
    ```
  </Collapser>

  <Collapser
    id="ec-expected_classes"
    title="expected_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Stanza containing a List of fully qualified `class_name` strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Prevents specified exception classes from affecting error rate or Apdex score while still reporting the errors to APM. **Cannot be specified by system property.**

    This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

    For example:

    ```yml
    error_collector:
      expected_classes:
        - "com.example.MyException"
        - "com.example.DifferentException"
    ```

    An environment variable can be used to list expected exception class names:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_messages"
    title="expected_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Stanza containing a fully qualified `class_name` and a List of `messages` per error class
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Contains yaml pairs consisting of a fully qualified exception class name that should be marked as expected and thus prevented from affecting error rate or Apdex score and a List of exception `message`s to match against, the latter of which at least one is required. If the exception class name matches an error but the message does not, then that error **will not** be marked as expected and therefore will affect error rate and Apdex score.

    Message strings use `contains` for matching. A message cannot be provided on its own and must always be paired with a fully qualified class name. **Cannot be specified by system property.**

    This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

    For example:

    ```yml
    error_collector:
      expected_messages:
        com.example.MyException:
          - "Some expected error message"
          - "Some other expected error message"
        com.example.DifferentException:
          - "Some different expected error message"
    ```

    An environment variable can be used to list expected exception class names and messages:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_status_codes"
    title="expected_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Comma-separated list of strings and ranges
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    A comma-separated list comprised of individual and dashed ranges of HTTP status codes to be marked as expected and thus prevented from affecting error rate or Apdex score.

    This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.

    For example:

    ```yml
    error_collector:
      expected_status_codes: 415,500-506
    ```

    Expected status codes can also be with the `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_STATUS_CODES` environment variable.
  </Collapser>

  <Collapser
    id="cfg-error-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for traced errors. If `attributes.enabled` is `false` at the root level, then no attributes will be sent to traced errors regardless of how this property is set under `error_collector`.
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for traced errors, all attribute keys found in this list will be sent to New Relic in traced errors. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Attribute keys found in this list will not be sent to New Relic in traced errors. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="ec-ignoreErrorPriority"
    title="ignoreErrorPriority"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When multiple errors are noticed in a transaction, only the last error will be reported by default. Setting this property to `false` will instead report only the first error that is noticed. For more information, see the [noticeError API](/docs/agents/java-agent/configuration/java-agent-error-configuration/).
    For example:

    ```yml
    error_collector:
      ignoreErrorPriority: false
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_errors"
    title="ignore_errors (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Comma-separated list of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All specified exception class names specified will not be treated as errors. Deprecated as of Java agent 3.40.0 and replaced by [`ignore_classes`](#ec-ignore_classes).

    For example:

    ```yml
    error_collector:
      ignore_errors: some.other.MyException
    ```
  </Collapser>
</CollapserGroup>

## External tracer [#External_Tracer]

The external tracing options are set in the `external_tracer` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.external_tracer` prefixed system property.

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="exclude_request_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to control the collection of outgoing request URIs for errors and transaction traces. Set this to true to disable collecting this information.
  </Collapser>
</CollapserGroup>

## Hostname configuration [#hostname_configuration]

These options are set in the `process_host` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.process_host` prefixed system property.

These properties are used for configuring the hostname displayed in the UI:

<CollapserGroup>
  <Collapser
    id="display_name"
    title="display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Set a [display name](/docs/agents/java-agent/configuration/hostname-logic-java#display-name) to decorate the "host:port" label in the New Relic UI.
  </Collapser>

  <Collapser
    id="ipv_preference"
    title="ipv_preference"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `4`
          </td>
        </tr>
      </tbody>
    </table>

    If the hostname cannot be determined, then the IP address of the host will be used. This property determines whether the IPv4 or IPv6 address should be used. The default is IPv4.
  </Collapser>
</CollapserGroup>

## Infinite Tracing

<Callout variant="important">
  Requirements:

  * [Java agent 5.12.1 or higher](/docs/agents/java-agent/installation/update-java-agent).
  * Infinite Tracing does not work if `enable_auto_app_naming` is enabled.
</Callout>

To turn on Infinite Tracing, enable distributed tracing and add the additional setting below. For an example, see [Language agents: Configure distributed tracing](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#java-config).

<CollapserGroup>
  <Collapser
    id="infinite-tracing-trace-observer-host"
    title="trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    For help getting a valid Infinite Tracing trace observer host entry, see [find or create a Trace Observer](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).

    You can configure this via YAML:

    ```yml
    infinite_tracing:
      trace_observer:
        host: <var>YOUR_TRACE_OBSERVER_HOST</var>
    ```

    You can also use the system property `newrelic.config.infinite_tracing.trace_observer.host` or the environment variable `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`.
  </Collapser>
</CollapserGroup>

## Jar collector

The Java agent collects information about jars and their versions on the application classpath.

Jar collection configuration is set in the `jar_collector` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.jar_collector` prefixed system property. Options include:

<CollapserGroup>
  <Collapser
    id="cfg-jar-collector-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Used to enable/disable jar collection and reporting.
  </Collapser>

  <Collapser
    id="cfg-jar-collector-skip-temp-jars"
    title="skip_temp_jars"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Used to enable/disable collection of temporary jars. Temporary jars are those residing in the directory specified by the system property `java.io.tmpdir`.
  </Collapser>

  <Collapser
    id="cfg-jar-collector-jars-per-second"
    title="jars_per_second"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of jars to process per second. Must be positive.
  </Collapser>
</CollapserGroup>

## JFR (Real-time profiling)

The Java agent uses Java Flight Recorder (JFR) to collect high fidelity JVM data for [Real-time profiling](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/).

Real-time profiling can be configured in the `jfr` stanza in the agent yaml, with [system properties](#System_Properties) prefixed by `newrelic.config.jfr.`, or with [environment variables](#Environment_Variables) prefixed with `NEW_RELIC_JFR_`.

<CollapserGroup>
  <Collapser
    id="jfr-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `true` to enable [Real-time profiling with JFR](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/).

    <Callout variant="important">
      Real-time profiling with JFR is on by default in Java agent [version 7.1.0](/docs/release-notes/agent-release-notes/java-release-notes). If you are on any other agent version 7.0.0 or higher, you can turn on JFR by changing the value to `true`.
    </Callout>
  </Collapser>

  <Collapser
    id="jfr-audit_logging"
    title="audit_logging"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `true` to enable audit logging which will display all JFR metrics and events in each harvest batch. Audit logging is extremely verbose and should only be used for troubleshooting purposes.

    <Callout variant="important">
      This applies to Java agent [version 7.0.0 or higher](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>
  </Collapser>
</CollapserGroup>

## JMX

To set these options, use the `jmx` stanza. To [override](#System_Properties) them, use a `newrelic.config.jmx` prefixed system property.

The Java agent uses JMX to collect JVM data. Additionally the agent can expose linking metadata over JMX that can be used by other tracing systems.

<CollapserGroup>
  <Collapser
    id="jmx-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all JMX functionality.
  </Collapser>

  <Collapser
    id="jmx-linkingMetadataMBean"
    title="linkingMetadataMBean"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be enabled to allow the Java agent to expose linking metadata over remote JMX.

    <Callout variant="important">
      This applies to Java agent [version 6.1.0 or higher](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>
  </Collapser>
</CollapserGroup>

## Logs in context [#logs-in-context]

Starting with Java agent version `7.6.0`, support for [logs in context](/docs/logs/logs-context/java-configure-logs-context-all) has been added to the agent, making it easy to use for supported logging frameworks. For tips on using the Java agent for logs in context, see [Java logs in context](/docs/logs/logs-context/java-configure-logs-context-all).

Changing these settings in your local agent configuration file happens dynamically and doesn't require a restart of the agent for those changes to take effect. An example configuration:

```yml
application_logging:
  enabled: true
  forwarding:
    enabled: true
    max_samples_stored: 10000
    context_data:
      enabled: false
      include:
      exclude:
  metrics:
    enabled: true
  local_decorating:
      enabled: false
```

Logs in context configuration is set in the `application_logging` stanza and can be [overridden](/docs/apm/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties) by using a `newrelic.config.application_logging` prefixed system property. The only option available is:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `true` to enable the core logs in context feature. When enabled, additional logging framework instrumentation is enabled, whether or not logs are decorated or sent to New Relic.

    <Callout variant="important">
      Agent releases 7.7.0 and higher has this feature enabled in the agent configuration file by default.
    </Callout>

    Set to `false` to completely disable this feature, including the collection of log metrics.
  </Collapser>
</CollapserGroup>

### Log forwarding [#log-forwarding]

If you're using a supported logging framework and want to use the agent to send your application logs to New Relic, you can control that through settings under the `forwarding` stanza which can be overridden by the `newrelic.config.application_logging.forwarding` prefixed system property. Options available are:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_forwarding-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enables the sending of application logs to New Relic.

    <Callout variant="important">
      Agent releases 7.7.0 and higher have this feature enabled in the agent configuration file by default.

      Using the log forwarding feature will increase your data ingest, which may affect your billing. For more information, see our documentation about [tracking your data ingest](/docs/apm/new-relic-apm/getting-started/get-started-logs-context#ingest).

      If you have an existing log forwarding solution and are updating your agent to use automatic logs in context, be sure to **disable your old log forwarder**. Otherwise, your app will be sending double log lines. Depending on your account, this could result in double billing. For more information, follow the procedures to disable your [specific log forwarder](/docs/logs/forward-logs/enable-log-management-new-relic#log-forwarding).
    </Callout>

    Set this to `true` to have your decorated logs sent to New Relic.

    Set this to `false` if you do not want your decorated logs sent to New Relic.
  </Collapser>

  <Collapser
    id="cfg-application_logging_forwarding-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    A positive integer specifying the maximum number of logs lines per minute to send.

    Set this to `0` to effectively disable the sending of logs.

    <Callout variant="important">
      This controls the number of logs sent *per minute*. Setting `max_samples_stored` to `0` - or any value less than `12` - does _not_ disable the feature itself, though it does result in no log lines being sent to New Relic.
    </Callout>

    Set this to a lower value to reduce the amount of log lines sent (may cause log sampling). Set this to a higher value to send more log lines.

    Each log receives the same priority as its associated transaction. Logs that occur outside of a transaction will receive a random priority. Some logs may not be included because they are limited by `max_samples_stored`. For example, if logging `max_samples_stored` is set to 10,000 and transaction 1 has 10,000 log entries, only log entries for transaction 1 will be recorded. If transaction 1 has less than 10,000 logs you receive all logs for transaction 1. If there is still space, you receive all the logs for transaction 2, and so on.

    If after all the logs for sampled transactions are recorded, and they haven't reached the limit in `max_samples_stored`, then log messages for transactions that were not in our sampling are sent. If there are any left, log messages outside of transactions are recorded.

  </Collapser>
</CollapserGroup>

#### Log context data [#log-context-data]

The Java agent can capture context data (Mapped Diagnostic Context in logback/slf4j, ThreadContext in log4j2) and add its contents as attributes in the logs forwarded to New Relic. You can control that through settings under the `context_data` stanza, which is nested under the `forwarding` stanza. These settings can be overridden by the `newrelic.config.application_logging.forwarding.context_data` prefixed system property. Options available are:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_forwarding_context_data-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

              <td>
                Boolean
              </td>
            </tr>

            <tr>
              <th>
                Default
              </th>

              <td>
                `false`
              </td>
            </tr>
          </tbody>
        </table>

        Set this to `true` sending of context data as log attributes to New Relic.

        Set this to `false` if you do not want context data in the logs sent to New Relic.
  </Collapser>

      <Collapser
        id="cfg-application_logging_forwarding_context_data-include"
        title="include"
      >
        <table>
          <tbody>
            <tr>
              <th>
                Type
              </th>

              <td>
                List of strings
              </td>
            </tr>

            <tr>
              <th>
                Default
              </th>

              <td>
                (none)
              </td>
            </tr>
          </tbody>
        </table>
        If `context_data` is enabled for log forwarding, all attribute keys found in this list will be sent to New Relic in log records. If this list is empty, then all attributes will be sent.

      </Collapser>

      <Collapser
        id="cfg-application_logging_forwarding_context_data-exclude"
        title="exclude"
      >
        <table>
          <tbody>
            <tr>
              <th>
                Type
              </th>

              <td>
                List of strings
              </td>
            </tr>

            <tr>
              <th>
                Default
              </th>

              <td>
                (none)
              </td>
            </tr>
          </tbody>
        </table>
          If `context_data` is enabled for log forwarding, all attribute keys found in this list will NOT be sent to New Relic in log records.

          The include and exclude list follow the rules `Exclude overrides include`, `More specific rules take priority`, `Keys are case-sensitive` and `Use an asterisk for wildcards` defined in [Attribute rules](/docs/apm/agents/java-agent/configuration/java-agent-configuration-config-file).
      </Collapser>
    </CollapserGroup>

### Log metrics [#log-metrics]

In addition to allowing you to decorate and send individual log lines, the Java agent can also capture logging metric data, which is displayed in the logs chart in the New Relic UI. This is controlled by settings under the `metrics` stanza and can be overridden by the `newrelic.config.application_logging.metrics` prefixed system property. The only available option is:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_metrics-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enables the capture of metrics information about your logs and log levels, which is displayed in a chart on the APM **Summary** page.

    Leave this set to `true` to allow the agent to capture metric information about your logs.

    Set this to `false` to disable this feature.

    <Callout variant="important">
      If you disable the collection of log metrics, the log chart on the summary page will appear blank.
    </Callout>
  </Collapser>
</CollapserGroup>


### Log decorating [#log-decorating]

The `local_decorating` stanza allows for controlling the decorating of local log lines and can be overridden by a `newrelic.config.application_logging.local_decorating` prefixed system property. The only option available is:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging-local_decorating"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    This controls whether locally stored log lines are decorated or not. This is independent of whether log forwarding is enabled or not and is used to support customers that want to use a separate log forwarding solution.

    Set this to `true` to cause the agent to add logs in context linking metadata to log lines stored locally by supported frameworks.

    <Callout variant="important">
      Enabling local log decorating will add linking metadata to your application log files, resulting in an increase in disk storage. Disable this feature if this is unacceptable.

      It is not necessary to use local log decorating when log forwarding is enabled. Doing so will cause linking metadata to be added to your log messages unnecessarily, which may be visually distracting.
    </Callout>

    Set this to `false` to turn off the local decorating feature. This will _not_ impact the decorating of log lines being sent to New Relic.
  </Collapser>
</CollapserGroup>

## Logging configuration [#Logging-Configuration]

These are part of the general configuration variables. They are broken out here because they are frequently tweaked for debugging.

Some of the logging configuration variables are dynamic and do not need a host restart for them to take effect. For instance, if log files are growing too quickly, [`log_level`](#cfg-log_level) can be set to a less verbose setting to reduce the reporting rate.

Here is the order of precedence for configuration variables affecting log rotation.

* If `log_daily` is `true`, other log rotation settings are ignored.
* If `log_file_count` is `1` or `0`, the size limit is ignored.
* Finally, the agent applies `log_limit_in_kbytes`.

Depending on the growth rate, it is possible for the log file size to exceed the configured value by a small amount.

<CollapserGroup>
  <Collapser
    id="cfg-log_file_count"
    title="log_daily"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `true` to roll the logs daily. Overrides the other configuration variables that affect log rotation.
  </Collapser>

  <Collapser
    id="cfg-log_file_count"
    title="log_file_count"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `1`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of log files to keep when using log rotation.
  </Collapser>

  <Collapser
    id="cfg-log_file_name"
    title="log_file_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    The unqualified log file name or the string `STDOUT` which will log to standard out.
  </Collapser>

  <Collapser
    id="cfg-log_file_path"
    title="log_file_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `logs` subdirectory where `newrelic.jar` is located
          </td>
        </tr>
      </tbody>
    </table>

    The log file path.

    <Callout variant="tip">
      If `log_file_path` is specified, the directory must already exist. If the default value is used, the agent will attempt to create the directory.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-log_level"
    title="log_level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `info`
          </td>
        </tr>
      </tbody>
    </table>

    The log verbosity level.

    The agent uses its own log file to keep its logging separate from that of your application. Valid options, in order of verboseness, are:

    * `off`
    * `severe`
    * `warning`
    * `info`
    * `fine`
    * `finer`
    * `finest`

      This setting is dynamic, so running agents will notice changes to `newrelic.yml` without a JVM restart.
  </Collapser>

  <Collapser
    id="cfg-log_limit_in_kbytes"
    title="log_limit_in_kbytes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    The log file size in kilobytes at which log files are rotated. Set to `0` for no limit.
  </Collapser>
</CollapserGroup>

## Message tracer [#Transaction_Tracer]

These options are set in the `message_tracer` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.message_tracer` prefixed system property.

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="segment_parameters.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Adds message properties to tracer attributes. Set this to `false` to turn it off.
  </Collapser>
</CollapserGroup>

## Span events

[Span events](/docs/apm/distributed-tracing/ui-data/span-event) are reported for [distributed tracing](#distributed-tracing). Distributed tracing must be enabled to report span events.

Span configuration is set in the `span_events` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.span_events` prefixed system property. Options include:

<CollapserGroup>
  <Collapser
    id="cfg-span-events-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Used to enable/disable span event reporting.
  </Collapser>

  <Collapser
    id="cfg-span-events-max-samples-stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `2000`
          </td>
        </tr>
      </tbody>
    </table>

    Determines the number of Span events that can be captured during an agent harvest cycle. Available in Java agent 7.4.0 and above.

    <Callout variant="important">
      Increasing the number of Span events can lead to additional agent overhead. A maximum value may be imposed server side by New Relic.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for span events. If `attributes.enabled` at the root level is `false`, no attributes will be sent to span events regardless on how this property (`span_events.attributes.enabled`) is set.
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for span events, all attribute keys found in this list will be sent to New Relic in `span_events`. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic in span events. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Span event attribute filtering requires [Java agent version 4.10.0 or higher](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

## Strip exceptions [#strip_exceptions]

These options are set in the `strip_exception_messages` stanza and unless noted otherwise can be [overridden](#System_Properties) by using a `newrelic.config.strip_exception_messages` prefixed system property. This configuration can be enabled to control whether Java exception messages are reported to New Relic.

<CollapserGroup>
  <Collapser
    id="strip_exception_messages"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    By default, this is set to `false`, which means that the agent sends messages from all exceptions to the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector).

    * If you set this to `true`, the agent strips the messages from exceptions in order to prevent it from inadvertently capturing sensitive information.
    * If you enable [high security mode](/docs/agents/manage-apm-agents/configuration/high-security-mode), this is automatically set to `true`.
    * If you set `enabled` to `true` but you want the agent to capture messages from specific exceptions, add the exceptions to your [allow list](#strip_exception_messages_whitelist).
  </Collapser>

  <Collapser
    id="strip_exception_messages_whitelist"
    title="whitelist (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      This config has been deprecated as of agent version 5.10.0 and will be removed in a future agent version. Instead use `allowed_classes`.
    </Callout>

    If you set `enabled` to `true` but you want the agent to capture messages for specific exceptions, add each exception to the `whitelist`, separated by a comma.
  </Collapser>

  <Collapser
    id="strip_exception_messages_allowed_classes"
    title="allowed_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If you set `enabled` to `true` but you want the agent to capture messages for specific exceptions, add each exception to `allowed_classes`, separated by a comma.
  </Collapser>
</CollapserGroup>

## Thread profiler [#Thread_Profiler]

These options are set in the `thread_profiler` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.thread_profiler` prefixed system property.

Thread profiler measures wall clock time, CPU time, and method call counts in your application's threads as they run.

<CollapserGroup>
  <Collapser
    id="tp-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable the thread profiler.
  </Collapser>
</CollapserGroup>

## Transaction events [#Transaction_Events]

These options are set in the `transaction_events` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.transaction_events` prefixed system property.

Transaction events provide the data for displaying histograms and percentiles in the UI.

<Callout variant="important">
  Previously this stanza was called `analytics_events`. If your configuration file still uses `analytics_events`, update your agent to use `transaction_events`.
</Callout>

<CollapserGroup>
  <Collapser
    id="ae-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable the transaction events service.
  </Collapser>

  <Collapser
    id="ae-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `2000`
          </td>
        </tr>

        <tr>
          <th>
            Max
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of sampled transaction events reported every 60 seconds.
  </Collapser>

  <Collapser
    id="tt-custom-request-headers"
    title="custom_request_headers"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of maps
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Unlike other settings, `custom_request_headers` have to be paired together and must be set in the `newrelic.yml` file. They can't be overwritten by Java virtual machine arguments (system property) or environment variables.
    </Callout>

    A list of maps with the paired keys `header_name` and the optional `header_alias`. Choose one or more custom HTTP request headers to add as transaction attributes.

    You can list multiple header configurations:

    ```yml
    transaction_events:
      custom_request_headers:
        -
          header_name: "X-Custom-Header-1"
        -
          header_name: "X-Custom-Header-2"
          header_alias: "CustomHeader2alias"
    ```

    In the first map set, `X-Custom-Header-1` is captured and reported by the agent as the header name for a corresponding value from the request object. The `header_name` will also be the name of the attribute sent to New Relic.

    In the second map set, the request header is `X-Custom-Header-2`, but the `CustomHeader2alias` is the name sent to New Relic.
  </Collapser>

  <Collapser
    id="cfg-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for transaction events. If `attributes.enabled` is `false` at the root level, then no attributes will be sent to transaction events regardless of how this property is set under `transaction_events`.
  </Collapser>

  <Collapser
    id="cfg-te-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for transaction events, all attribute keys found in this list will be sent to New Relic in transaction events. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-te-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic in transaction events. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Transaction segments

These options are set in the `transaction_segments` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.transaction_segments` prefixed system property.

Transaction segments represent discrete pieces of work (generally method calls) and are displayed within [transaction traces](/docs/traces/transaction-traces).

<Callout variant="important">
  Transaction segment attribute filtering requires [Java agent version 4.10.0 or higher](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

<CollapserGroup>
  <Collapser
    id="cfg-ts-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for transaction segments. If `attributes.enabled` at the root level is `false`, no attributes will be sent to transaction segments regardless on how this property (`transaction_segments.attributes.enabled`) is set.
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for transaction segments, all attribute keys found in this list will be sent to New Relic in transaction segments. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic in transaction segments. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Transaction tracer

These options are set in the `transaction_tracer` stanza and can be [overridden](#System_Properties) by using a `newrelic.config.transaction_tracer` prefixed system property.

[Transaction tracing](/docs/traces/transaction-traces) captures deep information about slow transactions and sends this to the New Relic service. The transaction includes the exact call sequence of the transactions, including any query statements issued.

<Callout variant="important">
  Do not use brackets `[suffix]` at the end of your transaction name. New Relic automatically strips brackets from the name. Instead, use parentheses `(suffix)` or other symbols if needed.
</Callout>

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    The transaction tracer is enabled by default. Set this to `false` to turn it off.
  </Collapser>

  <Collapser
    id="tt-explain_enabled"
    title="explain_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent will capture the `EXPLAIN` plan for slow queries. [Only supported for MySQL and PostgreSQL.](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)
  </Collapser>

  <Collapser
    id="tt-explain_threshold"
    title="explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Float
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    Threshold in seconds for query execution time below which the slow query and the `EXPLAIN` plan ([if supported](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)) will not be captured. Relevant to slow queries only when `record_sql` is set to `raw` or `obfuscated`. Relevant to `EXPLAIN` plans only when `explain_enabled` is set to `true`.
  </Collapser>

  <Collapser
    id="insert_sql_max_length"
    title="insert_sql_max_length"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `2000`
          </td>
        </tr>
      </tbody>
    </table>

    The character limit for the SQL query string. If you have many slow SQL queries with large chunks of information, this could negatively affect performance or how quickly you see your data in New Relic. Increase the value gradually until you find the right balance of information and performance.
  </Collapser>

  <Collapser
    id="tt-log_sql"
    title="log_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `true` to enable logging of queries to the agent log file instead of uploading to New Relic. Queries are logged using the `record_sql` mode.
  </Collapser>

  <Collapser
    id="tt-record_sql"
    title="record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>
      </tbody>
    </table>

    When the transaction tracer is on, query statements can optionally be recorded. The recorder has three modes:

    * `off`: Send no queries.
    * `raw`: Send the query statement in its original form.
    * `obfuscated`: Strips out numeric and string literals.
  </Collapser>

  <Collapser
    id="tt-stack_based_naming"
    title="stack_based_naming (Play 2.x+ only)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`

            Defaulted to `true` until Java agent version 3.12.1, when it was changed to `false`.
          </td>
        </tr>
      </tbody>
    </table>

    This option is for Play 2.x+ only. Play/Scala instrumentation can use `Thread.getStackTrace()` to improve tracer naming, but at the cost of increased overhead.
  </Collapser>

  <Collapser
    id="tt-stack_trace_threshold"
    title="stack_trace_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    Defines a threshold (in seconds) for collecting stack traces from an SQL call. When SQL statements exceed this threshold, the agent will capture the current stack trace. This is useful for pinpointing where long SQL calls originate from.
  </Collapser>

  <Collapser
    id="tt-top_n"
    title="top_n"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    Use this setting to control the variety of your transaction traces. `top_n` is an integer that represents the number of unique, slow transactions that traces will be created for.

    * If you want transaction traces to more accurately reflect the actual slowest transactions in your app, make this value **lower**.
    * If you want to sample a more diverse array of transactions, make the value **higher**.

      A value of `0` would mean that **only** the slowest transaction is always traced. This is considered not to be optimal, though, because you may have one or two transactions that are always the slowest, and repeatedly seeing those same transaction traces will probably not give you much value.

      If the same transaction is often the slowest, the `top_n` setting allows the Java agent (over time) to sample the slowest `n` transactions. This gives you greater variety and more insight into your application.
  </Collapser>

  <Collapser
    id="tt-transaction_threshold"
    title="transaction_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String (float)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>
      </tbody>
    </table>

    The time threshold used to determine when a transaction is eligible to be traced. When the transaction's response time exceeds this threshold, a [transaction trace](/docs/apm/transactions/transaction-traces/transaction-traces) will be recorded and sent to New Relic.

    The default is `apdex_f` (default), which sets the threshold to be the ["Frustrated"](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_f) [Apdex](/docs/site/apdex-measuring-user-satisfaction) level (four times the `apdex_t` value). You can also set a specific time threshold by entering a float value that represents a number of seconds.
  </Collapser>

  <Collapser
    id="tt-slow_query_whitelist"
    title="slow_query_whitelist (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      This config has been deprecated as of agent version 5.10.0 and will be removed in a future agent version. Instead use `collect_slow_queries_from`.
    </Callout>

    By default, [high security mode](/docs/accounts-partnerships/accounts/security/high-security) does not allow the agent to collect [slow queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details). Enable this option to collect Cassandra queries from the DataStax driver, even with high security enabled. If you don't use high security, the agent collects slow queries automatically.

    For DataStax driver 2.1.2, add this rule to your allow list:

    ```yml
    transaction_tracer:
      slow_query_whitelist:
        'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    For DataStax driver 3.0.0, add this rule to your allow list:

    ```yml
    transaction_tracer:
      slow_query_whitelist:
        'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="tt-collect_slow_queries_from"
    title="collect_slow_queries_from"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    By default, [high security mode](/docs/accounts-partnerships/accounts/security/high-security) does not allow the agent to collect [slow queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details). Enable this option to collect Cassandra queries from the DataStax driver, even with high security enabled. If you don't use high security, the agent collects slow queries automatically.

    For DataStax driver 2.1.2, add this rule to your allow list:

    ```yml
    transaction_tracer:
      collect_slow_queries_from:
        'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    For DataStax driver 3.0.0, add this rule to your allow list:

    ```yml
    transaction_tracer:
      collect_slow_queries_from:
        'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn on or off all attributes for transaction traces. If `attributes.enabled` at the root level is `false`, no attributes will be sent to transaction traces regardless on how this property (`transaction_tracer.attributes.enabled`) is set.
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for transaction traces, all attribute keys found in this list will be sent to New Relic in transaction traces. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            List of Strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent to New Relic in transaction traces. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-tt-token_limit"
    title="token_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    Limits the number of Tokens that can be created per Transaction. Increasing this value may impact performance, because it increases the amount of memory the agent uses and the amount of data sent to New Relic.
  </Collapser>

  <Collapser
    id="cfg-tt-segment_limit"
    title="segment_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    Limits the number of segments that can be created per transaction. Increasing this value may impact performance, because it increases the amount of memory the agent uses and the amount of data sent to New Relic.
  </Collapser>
</CollapserGroup>
