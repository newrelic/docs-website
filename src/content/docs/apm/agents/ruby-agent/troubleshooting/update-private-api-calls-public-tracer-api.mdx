---
title: Update private API calls to public Tracer API
type: troubleshooting
tags:
  - Agents
  - Ruby agent
  - Troubleshooting
metaDescription: Update deprecated API calls for the New Relic Ruby agent.
redirects:
  - /docs/agents/ruby-agent/troubleshooting/update-private-api-calls-public-tracer-api
---

## Problem

In New Relic Ruby agent version [6.0.0](/docs/releases/ruby), a number of APIs that were not publicly supported were deprecated or deleted. If you use any of the deleted methods, you must update your API with the recommended replacement before upgrading to Ruby agent version 6.0.0 or higher. If you use any of the deprecated methods, we recommend updating your API as soon as possible to ensure compatibility with versions of the agent higher than 6.0.0.

## Solution

Update your API with the following recommended replacements:

<CollapserGroup>
  <Collapser
    id="external-start-segment"
    title={<InlineCode>External.start_segment</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.start_external_request_segment`
  </Collapser>

  <Collapser
    id="transaction-create-segment"
    title={<InlineCode>Transaction.create_segment</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.start_segment`
  </Collapser>

  <Collapser
    id="transaction-start"
    title={<InlineCode>Transaction.start</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.start_transaction_or_segment`
  </Collapser>

  <Collapser
    id="transaction-start-datastore-segment"
    title={<InlineCode>Transaction.start_datastore_segment</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.start_datastore_segment`
  </Collapser>

  <Collapser
    id="transaction-start-segment"
    title={<InlineCode>Transaction.start_segment</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.start_segment`
  </Collapser>

  <Collapser
    id="transaction-wrap"
    title={<InlineCode>Transaction.wrap</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.in_transaction`
  </Collapser>

  <Collapser
    id="transaction-state-current-transaction"
    title={<InlineCode>TransactionState.current_transaction</InlineCode>}
  >
    Replace with `NewRelic::Agent::Tracer.current_transaction`
  </Collapser>
</CollapserGroup>
