---
title: Enable and disable attributes (Ruby)
tags:
  - Agents
  - Ruby agent
  - Attributes
metaDescription: 'How to include and exclude specific attributes for your New Relic Ruby agent, including properties and rules.'
redirects:
  - /docs/agents/ruby-agent/attributes/enable-disable-attributes-ruby
  - /docs/agents/ruby-agent/enabling-disabling-attributes
  - /docs/agents/ruby-agent/attributes/enabling-disabling-attributes-ruby
---

This describes the properties to enable or disable attributes, and the rules that New Relic uses when determining which attributes to include or exclude for a [destination](/docs/agents/manage-apm-agents/agent-data/agent-attributes#destinations). This also includes a summary of the Ruby agent properties that have been deprecated with the release of New Relic agent attributes.

## Properties

Use the following properties to enable or disable attributes:

<CollapserGroup>
  <Collapser
    id="attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, enables capture of attributes for all destinations.
  </Collapser>

  <Collapser
    id="transaction_tracer-attributes-enabled"
    title="transaction_tracer.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction traces.
  </Collapser>

  <Collapser
    id="transaction_events-attributes-enabled"
    title="transaction_events.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction events.
  </Collapser>

  <Collapser
    id="error_collector-attributes-enabled"
    title="error_collector.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from error collection.
  </Collapser>

  <Collapser
    id="browser_monitoring-attributes-enabled"
    title="browser_monitoring.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from browser monitoring.
  </Collapser>

  <Collapser
    id="span-events-attributes-enabled"
    title="span_events.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes on span events.
  </Collapser>

  <Collapser
    id="transaction-segments-attributes-enabled"
    title="transaction_segments.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (Dynamic)
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes on transaction segments.
  </Collapser>

  <Collapser
    id="attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction_tracer-attributes-exclude"
    title="transaction_tracer.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction traces. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction_events-attributes-exclude"
    title="transaction_events.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="error_collector-attributes-exclude"
    title="error_collector.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from error collection. Allows `*` as wildcard at end.

    To prevent [error.message](/attribute-dictionary?attribute_name=error.message) collection, instead use the [strip_exception_messages](/docs/agents/ruby-agent/configuration/ruby-agent-configuration#strip_exception_messages-enabled) configuration.
  </Collapser>

  <Collapser
    id="browser_monitoring-attributes-exclude"
    title="browser_monitoring.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="span-events-attributes-exclude"
    title="span_events.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from span events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction-segments-attributes-exclude"
    title="transaction_segments.attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction segments. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction_tracer-attributes-include"
    title="transaction_tracer.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction traces. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction_events-attributes-include"
    title="transaction_events.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="error_collector-attributes-include"
    title="error_collector.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in error collection. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="browser_monitoring-attributes-include"
    title="browser_monitoring.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="span-events-attributes-include"
    title="span_events.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in span events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="transaction-segments-attributes-include"
    title="transaction_segments.attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Environ variable
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction segments. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Attribute rules [#attruls]

New Relic follows these rules when determining which attributes to include or exclude for a destination.

<CollapserGroup>
  <Collapser
    id="rule-root-precedence"
    title="Root level takes precedence for enabled."
  >
    The `attributes.enabled` field trumps all other settings. When `false`, no attributes will be reported to New Relic.

    Example configuration:

    ```
    attributes.enabled: false
        attributes.include: foo, bar
        transaction_tracer.attributes.enabled: true
    ```

    Example output:

    ```
    Keys passed in: foo, bar, baz
        Keys included for all destinations:
        Keys excluded for all destinations: foo, bar, baz
    ```
  </Collapser>

  <Collapser
    id="rule-destination-precedence"
    title="Destination enabled takes precedence over include and exclude."
  >
    The `YOUR_DESTINATION.attributes.enabled` flags take precedence over include and exclude keys.

    Example configuration:

    ```
    transaction_tracer.attributes.enabled: false
        attributes.include: one, two
        transaction_tracer.attributes.include: three, four
    ```

    Example output:

    ```
    Keys passed in: one, two, three, four
        Keys included for transaction traces:
        Keys excluded for transaction traces: one, two, three, four
    ```
  </Collapser>

  <Collapser
    id="rule-included-destination"
    title="Attribute is included if the destination is enabled."
  >
    If a destination is enabled, all user attributes are sent to that destination by default.

    **Note:** All user attributes default to `true`. However, by default, request parameters are disabled for all destinations.

    Example configuration:

    ```
    attributes.enabled: true
        attributes.exclude: baz
    ```

    Example output:

    ```
    Keys passed in: foo, bar, baz
        Keys included: foo, bar
        Keys excluded: baz
    ```
  </Collapser>

  <Collapser
    id="rule-exclude-wins"
    title="Exclude always supersedes include."
  >
    If the same key is listed in the include and exclude lists, then attributes with the specified key will be excluded.

    Example configuration:

    ```
    attributes.enabled: true
        attributes.include: foo, bar
        attributes.exclude: nerd, bar
    ```

    Example output:

    ```
    Keys passed in: foo, bar, nerd
        Keys included: foo
        Keys excluded: nerd, bar
    ```
  </Collapser>

  <Collapser
    id="rule-keys-case-sensitive"
    title="Keys are case sensitive."
  >
    Keys are case-sensitive.

    Example configuration:

    ```
    attributes.enabled: true
        attributes.exclude: username, UsErNaMe
    ```

    Example output:

    ```
    Keys passed in: username, Username, USERNAME, UsErNaMe, userNAME
        Keys included: Username, USERNAME, userNAME
        Keys excluded: username, UsErNaMe
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>Use <InlineCode>\*</InlineCode> for wildcards.</>}
  >
    You can use an asterisk `*` at the end of a key as a wildcard. This will match a set of attributes with the same prefix.

    Example configuration:

    ```
    attributes.enabled: true
        attributes.include: custom*
        attributes.exclude: request.parameters.*
    ```

    Example output:

    ```
    Keys passed in: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
        Keys included: custom, custom.key1, custom.key2
        Keys excluded: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser
    id="rule-specific-wins"
    title="Most specific setting for a key takes priority."
  >
    If multiple include or exclude attributes affect the same key, the most specific setting will have priority.

    Example configuration:

    ```
    attributes.enabled: true
        attributes.include: request.parameters.foo
        attributes.exclude: request.parameters.*
    ```

    Example output:

    ```
    Keys passed in: request.parameters., request.parameters.foo, request.parameters.bar
        Keys included: request.parameters.foo
        Keys excluded: request.parameters., request.parameters.bar
    ```
  </Collapser>

  <Collapser
    id="rule-destination-include-exclude"
    title="Include or exclude affects the specific destination."
  >
    If the attribute include or exclude is specified on a destination, then it only impacts that destination.

    Example configuration:

    ```
    attributes.include: foo
        transaction_events.attributes.exclude: foo
    ```

    Example output:

    ```
    Keys passed in: foo
        Keys included for transaction events: 
        Keys included for other destinations: foo
        Keys excluded for transaction events: foo
    ```
  </Collapser>
</CollapserGroup>

## URI-related properties [#uri]

By default, the Ruby agent reports Uniform Resource Identifiers (URIs) to New Relic in several different places, including the following destinations:

* The `request.uri` attribute of [error events](/docs/apm/applications-menu/error-analytics/error-analytics-manage-error-traces)
* The `http.url` attribute of [span events](/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing)
* The `url` attribute of [slow SQL traces](/docs/apm/applications-menu/monitoring/view-slow-query-details)
* The `uri` attribute of [external request segments](/docs/agents/ruby-agent/features/http-client-tracing-ruby)

New Relic recommends having these URIs reported, as they can contain useful debugging information. If your URIs contain sensitive data that you don't want reported, URI reporting can be disabled. For example, sensitive data could include email addresses or account IDs. To disable URI reporting, add any of the above attribute names to the `attributes.exclude` list.

For example, if you adding the following key to your configuration file will stop the agent from reporting any of the URI-related properties:

```
attributes.exclude: uri
```

## Deprecated properties [#deprecated]

The following properties have been deprecated. Switch to the new attributes configuration for these properties when upgrading your Ruby agent.

<table>
  <thead>
    <tr>
      <th width={200}>
        **Deprecated property**
      </th>

      <th>
        **New property**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `capture_params`
      </td>

      <td>
        `attributes.include: request.parameters.*`
      </td>
    </tr>

    <tr>
      <td>
        `resque.capture_params`
      </td>

      <td>
        `attributes.include: job.resque.args.*`
      </td>
    </tr>

    <tr>
      <td>
        `sidekiq.capture_params`
      </td>

      <td>
        `attributes.include: job.sidekiq.args.*`
      </td>
    </tr>

    <tr>
      <td>
        `transaction_tracer.capture_attributes`
      </td>

      <td>
        `transaction_tracer.attributes.enabled`
      </td>
    </tr>

    <tr>
      <td>
        `error_collector.capture_attributes`
      </td>

      <td>
        `error_collector.attributes.enabled`
      </td>
    </tr>

    <tr>
      <td>
        `browser_monitoring.capture_attributes`
      </td>

      <td>
        `browser_monitoring.attributes.enabled`
      </td>
    </tr>

    <tr>
      <td>
        `analytics_events.capture_attributes`
      </td>

      <td>
        `transaction_events.attributes.enabled`
      </td>
    </tr>
  </tbody>
</table>
