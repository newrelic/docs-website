---
title: Node.js agent configuration
tags:
  - Agents
  - Nodejs agent
  - Installation and configuration
translate:
  - jp
  - kr
metaDescription: 'For New Relic''s Node.js agent: how to set configuration using your config file, environment variables, or server-side config.'
redirects:
  - /docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration
  - /docs/nodejs/configuring-nodejs-with-environment-variables
  - /docs/nodejs/customizing-your-nodejs-config-file
  - /docs/nodejs/nodejs-configuration-options
  - /docs/agents/nodejs-agent/installation-and-configuration/nodejs-configuration-options
  - /docs/agents/nodejs-agent/installation-and-configuration/customizing-your-nodejs-config-file
  - /docs/agents/nodejs-agent/installation-and-configuration/configuring-nodejs
  - /docs/agents/nodejs-agent/installation-and-configuration/nodejs-agent-configuration
  - /docs/agents/nodejs-agent/installation-and-configuration/configuring-nodejs-environment-variables
  - /docs/agents/nodejs-agent/installation-configuration/configuring-nodejs
  - /docs/agents/nodejs-agent/installation-configuration/configuring-nodejs-environment-variables
  - /docs/agents/nodejs-agent/configuration
freshnessValidatedDate: never
---

You can tailor the Node.js agent to your app's requirements by editing your `newrelic.js` config file or by setting an environment variable. The config file resides in the root directory of your app. You can also configure a few options from New Relic, or use the [Node.js agent API](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api).

## Get started [#requirements]

You'll be able to configure our Node.js agent to suit your environment after you [create a New Relic account](https://newrelic.com/signup) (it's free, forever) and [install the Node.js agent](/docs/apm/agents/nodejs-agent/installation-configuration/install-nodejs-agent/).

The [`license_key`](#license) setting is required. Also, we highly recommend setting the [`app_name`](#app_name) so that your app has a [meaningful name](/docs/apm/new-relic-apm/installation-configuration/name-your-application) instead of the default `My Application`.

## Configuration methods and precedence [#methods-and-precedence]

The primary method to configure the Node.js agent is the agent configuration file (`newrelic.js`). You can also configure most settings with [environment variables](#environment). You can also adjust some settings with [server-side configuration](#server-side).

The Node.js agent uses this order of precedence for configuration methods:

<img
  title="Node.js agent configuration precedence"
  alt="Node.js agent configuration precedence"
  src="/images/apm_diagram_nodejs-agent-configuration-hierarchy.webp"
/>

<figcaption>
  <DNT>**Node.js configuration hierarchy:**</DNT> Server-side configuration settings override environment variables. Environment variables override the agent config file. The config file overrides the agent defaults.
</figcaption>

Here are detailed descriptions of each configuration method:

<CollapserGroup>
  <Collapser
    className="freq-link"
    id="config_file"
    title="Agent configuration file"
  >
    The config file (`newrelic.js`) contains every Node.js agent setting. When you [install the Node.js agent](/docs/agents/nodejs-agent/installation-configuration/installing-maintaining-nodejs#installing), you must copy `newrelic.js` into your app's root directory. Most settings are empty by default; they inherit their values from `config/default.js`.

    If your application is running on CommonJS, simply change the configuration file type to (`newrelic.cjs`). This filetype is supported as of [v7.5.0](/docs/release-notes/agent-release-notes/nodejs-release-notes/node-agent-7-5-0/) of the Node.js agent.
  </Collapser>

  <Collapser
    className="freq-link"
    id="environment"
    title="Environment variables"
  >
    All configuration settings in `newrelic.js` have equivalent environment variables. These are useful, for example, if your agent runs in a PaaS environment such as Heroku or Microsoft Azure. Node.js agent environment variables always start with `NEW_RELIC_`.

    These environment variables are documented below under individual config options as the <DNT>**Environ variable**</DNT>. There are also two rarely used settings that can [only be configured via environment variables](#environment-variable-overrides). If you are unsure how to specify more complex types as environment variables, [use the reference guide](#environment-variable-type-reference-guide).

    If you're using New Relic CodeStream to monitor performance from your IDE, you may also want to [associate repositories with your services](/docs/codestream/observability/repo-association) and [associate build SHAs or release tags with errors](/docs/codestream/observability/error-investigation/#buildsha).
  </Collapser>

  <Collapser
    className="freq-link"
    id="server-side"
    title="Server-side configuration"
  >
    Owners and Admins can view and configure a few settings [directly in New Relic](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration). Where available, the UI labels for server-side config are listed in this document under individual config options as the <DNT>**Server-side label**</DNT>.
  </Collapser>
</CollapserGroup>

## Exports variables [#exports_config]

This section defines the Node.js agent variables in the order they typically appear in the `exports.config = {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="app_name"
    title="app_name (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `"My Application"`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APP_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    The [name New Relic uses to identify your app](/docs/apm/new-relic-apm/installation-configuration/name-your-application). For example, `app_name: ['MyNodeApp']`. To [use multiple names for your app](/docs/apm/new-relic-apm/installation-configuration/use-multiple-names-app), specify a comma-delimited list of names.

    Data for all applications with the same name will be merged in the New Relic UI, so set this carefully. We <DNT>**highly recommend**</DNT> that you replace the default name with a descriptive name to avoid confusion and unintended aggregation of data.

    <Callout variant="tip">
      For [Azure users](/docs/agents/nodejs-agent/hosting-services/nodejs-agent-microsoft-azure), the Node.js agent will use `APP_POOL_ID` if it is set, so you can use the name you chose for your Azure Web Server without setting it twice.
    </Callout>
  </Collapser>

  <Collapser
    id="license"
    title="license_key (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_LICENSE_KEY`
          </td>
        </tr>
      </tbody>
    </table>

    This setting is required. Your New Relic <InlinePopover type="licenseKey"/>. For example, `license_key: '40HexadecimalCharacters'`.
  </Collapser>

  <Collapser
    id="agent-enabled"
    title="agent_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `false` to stop the agent from starting up. This is useful when debugging your code requires temporarily disabling the agent. It prevents the agent from bootstrapping its instrumentation or setting up all its pieces, which prevents the agent from starting up and connecting to New Relic's servers.
  </Collapser>

  <Collapser
    id="allow_all_headers"
    title="allow_all_headers"
  >
    If `true`, enables capture of all HTTP headers, except for those filtered by `exclude` rules. If `false`, collected headers are limited to those defined in [Node.js agent attributes](/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-attributes).

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ALLOW_ALL_HEADERS`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="compressed_content_encoding"
    title="compressed_content_encoding"
  >
    If the data compression threshold is reached in the payload, the agent compresses data, using gzip compression by default. The config option `compressed_content_encoding` can be set to `deflate` to use deflate compression.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `gzip`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_COMPRESSED_CONTENT_ENCODING`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="apdex"
    title="apdex_t (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Number
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0.100`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Apdex T`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APDEX_T`
          </td>
        </tr>
      </tbody>
    </table>

    Set your Apdex T [via the New Relic UI](/docs/apm/new-relic-apm/apdex/apdex-measure-user-satisfaction/#apm-apdex).
  </Collapser>

  <Collapser
    id="certificates"
    title="certificates"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CERTIFICATES`
          </td>
        </tr>
      </tbody>
    </table>

    Additional certificates to trust for SSL connections, specified as an array of strings in PEM format. This affects both connections to an HTTPS proxy and connections to New Relic.

    <Callout variant="tip">
      You can also configure the agent to read its certificates from a file:

      ```js
      certificates: [ fs.readFileSync('myca.crt', {encoding: 'utf8'}) ]
      ```
    </Callout>
  </Collapser>

  <Collapser
    id="high_security"
    title="high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_HIGH_SECURITY`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, enables [high security v2](/docs/accounts-partnerships/accounts/security/high-security#version2description). You must also enable the [`ssl`](#ssl) setting and [enable high security in the UI](/docs/accounts-partnerships/accounts/security/high-security#version2enabled).
  </Collapser>

  <Collapser
    id="host"
    title="host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `collector.newrelic.com`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Do not edit this value unless New Relic Support asks you to change it.
    </Callout>

    Hostname for the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector) to connect to the Internet; for example, `host: 'collector.newrelic.com'`.
  </Collapser>

  <Collapser
    id="labels"
    title="labels"
  >
    Adds [tags](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers). Specify your tags as objects or a semicolon-delimited string of colon-separated pairs (for example, `Server:One;Data Center:Primary`).

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object or string
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_LABELS`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="port"
    title="port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `443`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Do not edit this value unless New Relic Support asks you to change it.
    </Callout>

    Port number to connect to the New Relic collector; for example, `port: 443`.
  </Collapser>

  <Collapser
    id="proxy"
    title="proxy"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_URL`
          </td>
        </tr>
      </tbody>
    </table>

    A URL specifying the proxy server to connect to the Internet. For example, `proxy: 'http://user:pass@10.0.0.1:8000/'`. Important considerations:

    * The `proxy` config file setting overrides the other config file proxy settings (`proxy_host`, `proxy_port`, `proxy_user`, `proxy_pass`) if used. Similarly, the `NEW_RELIC_PROXY_URL` environment variable overrides the other environment variable proxy settings (`NEW_RELIC_PROXY_HOST`, `NEW_RELIC_PROXY_PORT`, `NEW_RELIC_PROXY_USER`, and `NEW_RELIC_PROXY_PASS`) if used.
    * If you're using [Infinite Tracing](/docs/distributed-tracing/infinite-tracing/introduction-infinite-tracing): [see how to configure a proxy for Infinite Tracing](/docs/distributed-tracing/infinite-tracing/infinite-tracing-configure-proxy-support/#node-php-python-ruby).
  </Collapser>

  <Collapser
    id="proxy_host"
    title="proxy_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Hostname or IP address of the proxy server to connect to the Internet.
  </Collapser>

  <Collapser
    id="proxy_pass"
    title="proxy_pass"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PASS`
          </td>
        </tr>
      </tbody>
    </table>

    Password for authenticating to the proxy server. The agent supports only basic HTTP authentication.
  </Collapser>

  <Collapser
    id="proxy_port"
    title="proxy_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    Port number of the proxy server to connect to the Internet.
  </Collapser>

  <Collapser
    id="proxy_user"
    title="proxy_user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_USER`
          </td>
        </tr>
      </tbody>
    </table>

    User name for authenticating to the proxy server. The agent supports only basic HTTP authentication.
  </Collapser>
</CollapserGroup>

## Logging variables [#logging_config]

This section defines the Node.js agent variables in the order they typically appear in the `logging: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="log-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true` (`false` in `serverless_mode`)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enables or disables agent specific logging.
  </Collapser>

  <Collapser
    id="log_level"
    title="level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `info`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_LEVEL`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the level of detail recorded in the agent logs. From least detail to most detail, possible values are `fatal`, `error`, `warn`, `info`, `debug`, or `trace`.

    <Callout variant="caution">
      Do not use `debug` or `trace` logging unless New Relic Support asks you to use them. These levels of logging can generate excessive overhead. For most situations, use `info`.
    </Callout>
  </Collapser>

  <Collapser
    id="log"
    title="filepath"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `process.cwd()` plus `newrelic_agent.log`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG`
          </td>
        </tr>
      </tbody>
    </table>

    Complete path to the New Relic agent log, including the filename. Defaults to `filepath: require('path').join(process.cwd(), 'newrelic_agent.log')`. If the agent can’t create the log file, then it:

    * Logs the `New Relic failed to open log file` error using `console.error`.
    * Buffers all subsequent log messages in memory.
    * When the memory buffer reaches its 128 MiB limit, the agent discards any new log messages and emits the following warning via `process.emitWarning`: `[NRWARN001] NewRelicWarning: Dropping log message, buffer would overflow.`
    
    When creating the log file, the agent sets the file permissions to 0o600 (readable/writable to the owner).

    * To write all logging to <DNT>**stdout**</DNT>, set this to `stdout`.
    * To write all logging to <DNT>**stderr**</DNT>, set this to `stderr`.

    <Callout variant="important">
      In agent versions prior to 7.0.0, the agent would shut down the process if it was unable to create this file.
    </Callout>
  </Collapser>
</CollapserGroup>

## AI monitoring [#ai-monitoring]

This section includes Node.js agent configurations for setting up AI monitoring.

<Callout variant="important">
  You must enable [distributed tracing](/docs/apm/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration/#dt-main) to capture AI data. It's turned on by default in Node.js agents 8.3.0 and higher. If you've enabled high security mode, AI monitoring will not work.
</Callout>

<Callout variant="important">
  When enabled, AI Monitoring will record a streaming copy of inputs and outputs sent to and from the models you choose to monitor, including any personal information contained therein. When using AI Monitoring, you are responsible for obtaining consent from your model users that their interactions may be recorded by a third party (New Relic) for the purpose of providing the AI Monitoring feature.
</Callout>

<CollapserGroup>
  <Collapser
    id="ai-monitoring-enabled"
    title="ai_monitoring.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, enables AI monitoring. Allows the agent to capture LLM event data.
  </Collapser>

  <Collapser
    id="ai-monitoring-streaming"
    title="ai_monitoring.streaming.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_STREAMING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `false`, disables instrumentation for streamed LLM data. Set to `true`, captures streamed data for LLM events.
  </Collapser>

  <Collapser
    id="ai-monitoring-record-content"
    title="ai_monitoring.record_content.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_RECORD_CONTENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If set to `false`, agent omits input and output content (like text strings from prompts and responses) captured in LLM events. This is an optional security setting if you don’t want to record sensitive data sent to and received from your LLMs.
  </Collapser>
</CollapserGroup>

## Cloud variables [#cloud_config]

This section defines the Node.js agent variables to create a relationship between cloud providers and APM applications.

<CollapserGroup>
  <Collapser
    id="cloud-variables"
    title="cloud.aws.account_id"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `null`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CLOUD_AWS_ACCOUNT_ID`
          </td>
        </tr>
      </tbody>
    </table>

    The AWS account ID for the AWS account associated with this app.
  </Collapser>
</CollapserGroup>

## Audit logging [#audit_log]

This section defines the Node.js agent variables in the order they typically appear in the `audit_log: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="audit_log-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent logs the payloads it sends to the collector. This data is included in the main log file even when logging level is set to the lowest level.
  </Collapser>

  <Collapser
    id="endpoints"
    title="endpoints"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]` (include all types)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENDPOINTS`
          </td>
        </tr>
      </tbody>
    </table>

    The agent sends several different types of data to the collector in separate payloads. By default, all of them are included in the log file. This option makes it possible to limit logging only to specific types of data.

    Valid values include:

    * `agent_settings`
    * `analytic_event_data`
    * `connect`
    * `custom_event_data`
    * `error_data`
    * `error_event_data`
    * `metric_data`
    * `preconnect`
    * `shutdown`
    * `span_event_data`
    * `sql_trace_data`
    * `transaction_sample_data`
  </Collapser>
</CollapserGroup>

## API configuration [#api_config]

This section allows you to choose which API methods are enabled. Each configuration option allows you to modularly enable API methods that are responsible for sending custom information to New Relic.

<Callout variant="important">
  All of these are set to `false` when the agent is in high-security mode.
</Callout>

<CollapserGroup>
  <Collapser
    id="custom-attributes"
    title="custom_attributes_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_ATTRIBUTES`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`newrelic.addCustomAttribute`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-param) and [`newrelic.addCustomAttributes`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-params).
  </Collapser>

  <Collapser
    id="custom-events"
    title="custom_events_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_EVENTS`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`recordCustomEvent`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#record_custom_event).
  </Collapser>

  <Collapser
    id="notice-error"
    title="notice_error_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_API_NOTICE_ERROR`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`newrelic.noticeError`](https://newrelic.github.io/node-newrelic/API.html#noticeError).
  </Collapser>
</CollapserGroup>

## Attributes [#node-js-attributes]

This section defines the variables for [Node.js agent attributes](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes) in the order they typically appear in the `attributes: {` section of your app's `newrelic.js` configuration file.

<Callout variant="caution">
  Any header-related include/exclude rules must be in camelCase form to be filtered.
</Callout>

<CollapserGroup>
  <Collapser
    id="attributes_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, enables capture of attributes for all destinations.
  </Collapser>

  <Collapser
    id="attributes_exclude"
    title="exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from all destinations. Allows `*` as wildcard at end. For example, in the config file, this would include all parameters except `somethingSecret`:

    ```js
    attributes: {
      include: [ 'request.parameters.*' ],
      exclude: [ 'request.parameters.somethingSecret' ]
    }
    ```
  </Collapser>

  <Collapser
    id="attributes_include"
    title="include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include from all destinations. Allows `*` as wildcard at end.

    For example, in the `config` file, this would include all parameters:

    ```js
    attributes: {
      include: [ 'request.parameters.*' ]
    }
    ```

    Using this example Express route definition and request URL:

    ```js
    app.get('/api/users/:id', myMiddleware, myController)
    ```

    ```sh
    curl http://localhost:3000/api/users/abc123?id=true
    ```

    The _route parameter_ is `id`, and has a value of `abc123`. This becomes the attribute `request.parameters.route.id: abc123` on the Transaction, root Segment, and Span. This example also has a _query parameter_ of `id`, which has a value of `true`. This would become the attribute `request.parameters.id: true` on the Transaction, root Segment, and Span.

  </Collapser>

  <Collapser
    id="attributes_include_enabled"
    title="include_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When `true`, patterns may be added to the [`attributes.include`](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes#cfg-attributes-include) list.
  </Collapser>
</CollapserGroup>

## Error collector variables [#error_config]

You can [manage how error are handled](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected) in New Relic. This section defines the Node.js agent variables in the order they typically appear in the `error_collector: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="error_collector"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable error collection?`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects [error traces](/docs/apm/applications-menu/events/viewing-apm-errors-error-traces) from your app.
  </Collapser>

  <Collapser
    id="error_ignore"
    title="ignore_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array of Integers
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[404]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Ignore these status codes`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of HTTP status codes for the error collector to ignore.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore_classes"
    title="ignore_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array|Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of javascript error types/classes for the error collector to ignore.

    The following configuration

    ```js
    error_collector: {
        /* ... */
        ignore_classes: ["ReferenceError"]
    }
    ```

    Would ignore all reference errors.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore_messages"
    title="ignore_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    A JavaScript object describing a list of classes tied to error messages for the collector to ignore. The following configuration would ignore all errors of the type `Error` with the exact (case-sensitive) message strings of `Undefined` and `Out of time`:

    ```js
    error_collector: {
        /* ... */
        ignore_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Would ignore all errors of type `Error`, with the exact (case-sensitive) message strings of `Undefined` and `Out of time`.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="expected_status_codes"
    title="expected_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array of integers
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of HTTP status codes for the error collector to mark as expected.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="expected_classes"
    title="expected_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    The following configuration

    ```js
    error_collector: {
        /* ... */
        expected_classes: ["ReferenceError"]
    }
    ```

    Would mark all reference errors as expected.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="expected_messages"
    title="expected_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    A javascript object describing a list of javascript classes tied to javascript error messages for the collector to ignore. The following configuration.

    ```js
    error_collector: {
        /* ... */
        expected_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Would mark all errors of type `Error`, with the exact (case-sensitive) message strings of `Undefined` and `Out of time`.

    <Callout variant="caution">
      Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_attributes_enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from error collection.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="error_attributes_exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from error collection. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="error_attributes_include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in error collection. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser
    id="error_max_event_samples_stored"
    title="max_event_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `100`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.
  </Collapser>
</CollapserGroup>

## Transaction tracer variables [#tx_tracer_config]

The agent groups your requests into [transactions](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction), which are used to:

* Visualize where your app spends its time (in transaction breakdowns).
* Identify slow requests.
* Group metrics.
* Isolate other issues, such as slow [database performance](/docs/apm/applications-menu/monitoring/databases-slow-queries-dashboard).

This section defines the Node.js agent variables in the order they typically appear in the `transaction_tracer: {` section of your app's `newrelic.js` configuration file.

<Callout variant="important">
  Do not use brackets `[suffix]` at the end of your transaction name. New Relic automatically strips brackets from the name. Instead, use parentheses `(suffix)` or other symbols if needed.
</Callout>

<CollapserGroup>
  <Collapser
    id="tracer_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable transaction tracing?`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects slow [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser
    id="explain_threshold"
    title="explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_EXPLAIN_THRESHOLD`
          </td>
        </tr>
      </tbody>
    </table>

    Minimum query duration (in milliseconds) for a transaction to be eligible for [slow queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) in [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser
    id="record-sql"
    title="record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String (`obfuscated`, `off`, or `raw`)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_RECORD_SQL`
          </td>
        </tr>
      </tbody>
    </table>

    This option affects both [slow queries](#slow-queries) and `record_sql` for transaction traces. It can have these values: `off`, `obfuscated`, or `raw`.

    When set to `off` no slow queries will be captured, and backtraces and SQL will not be included in transaction traces. If set to `raw` or `obfuscated`, the agent sends raw or obfuscated SQL and a slow query sample to the [collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). The agent may also send SQL when other criteria are met, such as when `slow_sql.enabled` is set.
  </Collapser>

  <Collapser
    id="tracer_top"
    title="top_n"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_TOP_N`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of requests eligible for [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).

    Transactions are named based on the request, and `top_n` refers to the "top n slowest transactions" grouped by these names. The module replaces a recorded trace with a new trace only if the new trace is slower than the previous slowest trace of that name. The default value for this setting is `top_n: 20`, because the [<DNT>**Transactions**</DNT> page](/docs/apm/transactions/transaction-traces/transaction-traces) also defaults to the 20 slowest transactions.

    The Node.js agent captures at least five different slow transactions in the first harvest cycle after start up. It will also reset and capture different transactions if no slow transactions have been captured for the last five [harvest cycles](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle). This allows you to see more information about more of your app's request paths, at the possible cost of not focusing on the absolutely slowest request for that harvest cycle.

    <Callout variant="tip">
      To record the absolute slowest transaction over the last minute, you can set `top_n: 0` or `top_n: 1`. However, this causes one very slow route to dominate your transaction traces.
    </Callout>
  </Collapser>

  <Collapser
    id="tracer_threshold"
    title="transaction_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer or `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_THRESHOLD`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Threshold`
          </td>
        </tr>
      </tbody>
    </table>

    Sets the time, in seconds, for a [transaction trace](/docs/apm/transactions/transaction-traces/transaction-traces) to be considered slow. The default value is `apdex_f`; this sets the trace threshold to four times your application's [Apdex T](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_t). If a number is provided, it is set in seconds.

    The default `apdex_t` is 500 milliseconds. If your transaction threshold is set to `apdex_f`, a "slow" transaction is 2 seconds.
  </Collapser>

  <Collapser
    id="hide-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction traces.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="hide-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction traces. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="hide-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction traces. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Rules variables [#rules_config]

This section defines the Node.js agent variables in the order they typically appear in the `rules: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="rules_names"
    title="name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Strings or regular expressions
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_NAMING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    A comma-delimited list of rules to match incoming request URLs and name the associated New Relic transaction. Uses the format:

    ```js
    name: [
        { pattern: 'STRING_OR_REGEX', name: 'NAME' },
        { pattern: 'STRING_OR_REGEX', name: 'NAME' }
    ]
    ```

    Both parameters are required. For strings, you must escape control characters. You do not need to escape control characters in regular expressions. Additional attributes are ignored.

    Regular expressions support JavaScript-style capture groups, and names use `$1`-style replacement strings. Regular expressions only find the first matching result; subsequent matches are ignored. For more information, see [Node.js transaction naming API](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#ignoring).

    For the `NEW_RELIC_NAMING_RULES` environment variable, pass the rules as comma-delimited JSON object literals:

    ```ini
    NEW_RELIC_NAMING_RULES='{"pattern":"^t","name":"u"},{"pattern":"^u","name":"t"}'
    ```
  </Collapser>

  <Collapser
    id="rules_ignore"
    title="ignore"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Strings or regular expressions
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `['^/socket.io/.*/xhr-polling/']`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_IGNORING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Define a list of request URLs you want the agent to ignore. Specify the list as patterns, which can be strings or regular expressions. The default value is a regular expression to match socket.io long-polling requests
  </Collapser>

  <Collapser
    id="enforce_backstop"
    title="enforce_backstop"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_ENFORCE_BACKSTOP`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Do not change this setting unless you understand [metric grouping issues](/docs/features/metric-grouping-issues).
    </Callout>

    When enabled, the agent renames transactions that are not affected by other naming logic (such as the API, rules, or metric normalization rules) to `NormalizedUri/*`. If you set this to `false`, the agent sets transaction names to `Uri/path/to/resource`.
  </Collapser>
</CollapserGroup>

## Transaction events variables [#tx_events]

This section defines the Node.js agent variables in the order they typically appear in the `transaction_events: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="tx_events_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent sends transaction events to New Relic. This event data includes transaction timing, transaction name, and any custom attributes. If this is disabled, the agent does not collect this data or send it to New Relic.
  </Collapser>

  <Collapser
    id="tx_events_max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.

    We don't recommend configuring past 10,000. The server will cap data at 10,000 per-minute.

    <Callout variant="important">
      This configuration had different behavior in agent versions lower than 6.0.0. See [`max_samples_stored` (DEPRECATED)](#tx_events_max_samples_stored_legacy) for agent versions 5.x or lower.
    </Callout>
  </Collapser>

  <Collapser
    id="tx_events_max_samples_stored_legacy"
    title="max_samples_stored (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20000`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent stores if it is unable to communicate with the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). The values from the previous [harvest cycle](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#harvest-cycle) will be merged into the next one, with this option limiting the maximum number. Make sure this number is greater than `max_samples_per_minute`; for example, set it to twice as much. Consider your memory overhead before increasing this value.

    <Callout variant="caution">
      This configuration has different behavior starting with agent version 6.0.0 and a new recommended maximum. See [`max_samples_stored`](#tx_events_max_samples_stored) for agent versions 6.x or higher.
    </Callout>
  </Collapser>

  <Collapser
    id="tx_events_max_samples_per_minute"
    title="max_samples_per_minute (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.

    <Callout variant="caution">
      This configuration has been replaced with `max_samples_stored` starting with version 6.0.0 of the agent. See [`max_samples_stored`](#tx_events_max_samples_stored) for 6.x or later agents.
    </Callout>
  </Collapser>

  <Collapser
    id="tx-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction events.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="tx-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="tx-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction events. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Browser monitoring variables [#browser-variables]

This section defines the Node.js agent variables in the order they typically appear in the `browser_monitoring: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="browser"
    title="enable"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_ENABLE`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable browser monitoring?`
          </td>
        </tr>
      </tbody>
    </table>

    Generate JavaScript headers for browser instrumentation. If set to `true` the agent does not automatically inject the browser JS code unless you have [manually enabled <InlinePopover type="browser"/>](/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser). Even if you have enabled it and [added the browser timing header](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#procedures), you can [disable browser monitoring for your app](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#disabling) by setting this to `false`.
  </Collapser>

  <Collapser
    id="browser-debug"
    title="debug"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_DEBUG`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, request un-minified sources from the server.
  </Collapser>

  <Collapser
    id="browser-debug-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent sends custom attributes to browser monitoring.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="browser-debug-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="browser-debug-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in browser monitoring. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Custom events variables [#custom_events]

This section defines the Node.js agent variables in the order they typically appear in the `custom_insights_events: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="custom_events_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent sends custom events recorded with [`recordCustomEvent()`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#custom-events-api) to [New Relic](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-insights-api). If this is disabled, the agent does not collect this data or send it to New Relic.
  </Collapser>

  <Collapser
    id="custom_events_max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `3000`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    * Defines the maximum number of custom events the agent collects per minute. If the number of custom events exceeds this limit, the agent collects a statistical sampling.
    * When configuring the agent for [AI monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), set to max value `100000`. Ensures that the maximum amount of LLM events are captured.

      <Callout variant="important">
        Increasing this limit may increase memory usage.
      </Callout>
  </Collapser>
</CollapserGroup>

## Slow queries variables [#slow-queries]

This section defines the Node.js agent variables in the order they typically appear in the `slow_sql: {` section of your app's `newrelic.js` configuration file. These options control behavior for slow queries, but do not affect SQL nodes in transaction traces.

<CollapserGroup>
  <Collapser
    id="slow-sql-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SLOW_SQL_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects [slow query details](/docs/apm/applications-menu/monitoring/viewing-slow-query-details).
  </Collapser>

  <Collapser
    id="slow-sql-max-samples"
    title="max_samples"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_MAX_SQL_SAMPLES`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of slow queries the agent collects per minute. The agent discards additional queries after the limit is reached.

    <Callout variant="important">
      Increasing this limit increases memory usage.
    </Callout>
  </Collapser>
</CollapserGroup>

## Custom hostname variables [#custom-hostnames]

This section defines the Node.js agent variables in the order they typically appear in the `process_host: {` section of your app's `newrelic.js` configuration file. These options control behavior regarding the host display name in the APM UI.

<CollapserGroup>
  <Collapser
    id="custom-hostnames-display"
    title="display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String of 255 bytes or less
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    Specify a custom hostname for [display in New Relic](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name). If you do not set this field, New Relic will continue to use the default hostname found by calling `os.hostname()`.

    * If you use the default hostname settings, New Relic finds the hostname through `os.hostname()`.
    * If this call fails, New Relic uses the host's IP as the name.
    * If you set `ipv_preference: 4` or `ipv_preference: 6`, you can select the type of IP address (IPv4 or IPv6) that appears in the New Relic UI.
  </Collapser>

  <Collapser
    id="custom-hostnames-ipv"
    title="ipv_preference"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer (`4` or `6`)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `4`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_IPV_PREFERENCE`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Datastore tracer variables [#datastore-tracer]

This section defines the Node.js agent variables in the order they typically appear in the `datastore_tracer` section of your app's `newrelic.js` configuration file. These options control behavior for collecting datastore instance metrics.

<CollapserGroup>
  <Collapser
    id="datastore-instance-enabled"
    title="instance_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_INSTANCE_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects datastore instance metrics (such as host and port) for [some database drivers](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information). These are reported on slow query traces and transaction traces.
  </Collapser>

  <Collapser
    id="datastore-name-enabled"
    title="database_name_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_DATABASE_NAME_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects database name on slow query traces and transaction traces for [some database drivers](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information).
  </Collapser>
</CollapserGroup>

## Cross application tracing (DEPRECATED) [#cross-app-tracing]

The Node.js agent variables that control [cross application tracing](/docs/apm/transactions/cross-application-traces/introduction-cross-application-traces) typically appear in the `cross_application_tracer` section of your app's `newrelic.js` configuration file:

<Callout variant="important">
  Cross application tracing has been deprecated in favor of [Distributed tracing](/docs/enable-distributed-tracing) and will be removed in a future agent version.
</Callout>

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CROSS_APPLICATION_TRACER_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, allows tracing of transactions across more than one New Relic-monitored applications.
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Cross application tracing (CAT) has been deprecated and will be removed in a future major release. For cross-service visibility, we recommend using [distributed tracing](#distributed-tracing), which is enabled by default as of agent version 8.3.0. Before enabling, read the [transition guide](/docs/transition-guide-distributed-tracing).
</Callout>

## Error message redaction variables [#err-message-redact]

The Node.js agent variables that control error message redaction appear in the `strip_exception_messages` section of your app's `newrelic.js` configuration file:

<CollapserGroup>
  <Collapser
    id="allow-raw-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_STRIP_EXCEPTION_MESSAGES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When `true`, the agent will redact the messages of captured errors.
  </Collapser>
</CollapserGroup>

## Distributed tracing [#dt-main]

[Distributed tracing](/docs/intro-distributed-tracing) lets you see the path that a request takes as it travels through a distributed system. When configuring via the config file, place the following option in the `distributed_tracing` section. It is turned on by default in Node.js agents 8.3.0 and higher.

<Callout variant="important">
  Enabling distributed tracing disables [cross application tracing](#cross-app-tracing), and has effects on other APM features. Before enabling, read the [transition guide](/docs/transition-guide-distributed-tracing). Requires [Node.js agent version 4.7.0 or higher](/docs/agents/nodejs-agent/installation-configuration/upgrade-nodejs-agent).
</Callout>

For more information about setting up distributed tracing, see [Enable distributed tracing for your Node.js  applications](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent).

<CollapserGroup>
  <Collapser
    id="dt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Set this to `false` to disable distributed tracing. For example, in the config file, you would use:

    ```js
    distributed_tracing: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser
    id="dt-exclude-newrelic-header"
    title="exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_EXCLUDE_NEWRELIC_HEADER`
          </td>
        </tr>
      </tbody>
    </table>

    Set this to `true` to exclude the New Relic header that is attached to outbound requests, and instead only rely on W3C Trace Context Headers for distributed tracing. If this is `false` then both types of headers are used.

    For example, to enable this in the config file, you would use:

    ```js
    distributed_tracing: {
        enabled: true,
        exclude_newrelic_header: true
    }
    ```
  </Collapser>
  <Collapser
    id="dt-sampler-remote-parent-sampled"
    title="sampler.remote_parent_sampled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    When the traceparent header has a sampled flag of `01`, this controls how to handle sampling of spans. The allowable values are:

      * `always_on`: the agent will sample spans
      * `always_off`: the agent will NOT sample spans
      * `default`: the agent will use the existing NR sampling (default)

    For example, to enable this in the config file, you would use:

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_sampled: 'always_on'
        }
    }
    ```
  </Collapser>
  <Collapser
    id="dt-sampler-remote-parent-not-sampled"
    title="sampler.remote_parent_not_sampled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_NOT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    When the traceparent header is has a sampled flag of `00`, this controls how to handle sampling of spans. The allowable values are:

      * `always_on`: the agent will sample spans
      * `always_off`: the agent will NOT sample spans
      * `default`: the agent will use the existing NR sampling (default)

    For example, to enable this in the config file, you would use:

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_not_sampled: 'always_on'
        }
    }
    ```
  </Collapser>
</CollapserGroup>

## gRPC server instrumentation [#grpc_server]

The `grpc` section controls the behavior of how the gRPC server is instrumented.

<CollapserGroup>
  <Collapser
    id="record_errors"
    title="record_errors"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_GRPC_RECORD_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent will send all error gRPC status codes to New Relic, that is, nonzero status codes. If disabled, the server instrumentation will not send any nonzero status codes to New Relic.
  </Collapser>
</CollapserGroup>

<Collapser
  id="grpc_error_ignore"
  title="ignore_status_codes"
>
  <table>
    <tbody>
      <tr>
        <th>
          Type
        </th>

        <td>
          Array of Integers
        </td>
      </tr>

      <tr>
        <th>
          Default
        </th>

        <td>
          `[]`
        </td>
      </tr>

      <tr>
        <th>
          [Environ variable](#environment)
        </th>

        <td>
          `NEW_RELIC_GRPC_IGNORE_STATUS_CODES`
        </td>
      </tr>
    </tbody>
  </table>

  Comma-delimited list of gRPC status codes for the error collector to ignore, both on client-side and server-side instrumentation.

  <Callout variant="caution">
    Errors recorded using [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) do not obey this configuration value.
  </Callout>
</Collapser>

## Span events

[Span data](/docs/apm/distributed-tracing/ui-data/span-event) is reported for [distributed tracing](#distributed-tracing). Distributed tracing must be enabled to report spans. Set span configuration in the `span_events` section. Options include:

<CollapserGroup>
  <Collapser
    id="span-events-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Turns reporting of span events on or off.
  </Collapser>

  <Collapser
    id="span-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn reporting of attributes on or off for spans. If `attributes.enabled` at the root level is `false`, no attributes will be sent with spans regardless on how this is set.
  </Collapser>

  <Collapser
    id="span-events-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for spans, all attribute keys found in this list will be attached to spans. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="span-events-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent with spans. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

<Collapser
  id="span-events-max-samples-stored"
  title="max_samples_stored"
>
  <table>
    <tbody>
      <tr>
        <th>
          Type
        </th>

        <td>
          Integer
        </td>
      </tr>

      <tr>
        <th>
          Default
        </th>

        <td>
          `2000`
        </td>
      </tr>

      <tr>
        <th>
          [Environ variable](#environment)
        </th>

        <td>
          `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`
        </td>
      </tr>
    </tbody>
  </table>

  * Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.
  * We do not recommend configuring past 10k. The server will cap data at 10k per-minute.
  * When configuring the agent for [AI monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), set to max value `10000`. Ensures that the maximum amount of traces are captured.

    <Callout variant="important">
      `max_samples_stored` configuration settings require [Node.JS agent version 8.3.0 or higher](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).
    </Callout>
</Collapser>

## Infinite Tracing

To turn on Infinite Tracing, add the settings below. Set Infinite Tracing configuration in the `infinite_tracing` section.
Additionally, distributed tracing must be [enabled](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent). Note that distributed tracing is enabled by default for Node.js APM agent versions 8.3.0 and greater.

<CollapserGroup>
  <Collapser
    id="infinite-tracing-host"
    title="trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    For help getting a valid Infinite Tracing trace observer host entry, see [Find or create a trace observer endpoint](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).
  </Collapser>

  <Collapser
    id="infinite-tracing-queue-size"
    title="span_events.queue_size"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Number
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_SPAN_EVENTS_QUEUE_SIZE`
          </td>
        </tr>
      </tbody>
    </table>

    The amount of Infinite Tracing spans the agent will hold in memory before dropping them.

    This setting should rarely need to changed from the default as the queue is not in use the majority of the time. The queue is in use only during reconnections to the Infinite Tracing endpoint while the agent is unable to stream data. It's possible the agent will drop Infinite Tracing spans during these periods, in that case increasing this number can help.
  </Collapser>
  <Collapser
    id="infinite-tracing-batching"
    title="batching"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_BATCHING`
          </td>
        </tr>
      </tbody>
    </table>

    This setting sends spans in batches of 250 or every 5 seconds.

    This setting should not be changed as the amount of egress will increase significantly.
  </Collapser>
  <Collapser
    id="infinite-tracing-compression"
    title="compression"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_COMPRESSION`
          </td>
        </tr>
      </tbody>
    </table>

    This setting gzip compresses span(s).

    This setting should not be changed as the amount of egress will increase significantly.
  </Collapser>
</CollapserGroup>

## Application logging [#app-logging]

The application logging configuration settings require [Node.JS agent version 8.11.0 or higher](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

For tips on configuring logs for the Node.js agent, see [Configure Node.js logs in context](/docs/logs/logs-context/configure-logs-context-nodejs).

<CollapserGroup>
  <Collapser
    id="application-logging-enabled"
    title="application_logging.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enables automatically generating [logs in context](/docs/logs/logs-context/configure-logs-context-nodejs/).

    For example, to disable this feature in the config file, you would use:

    ```js
    application_logging: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser
    id="application-logging-metrics-enabled"
    title="application_logging.metrics.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the agent gathers Logging Metrics used in the Logs chart on the APM Summary page.
  </Collapser>

  <Collapser
    id="application-logging-forwarding-enabled"
    title="application_logging.forwarding.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the agent gathers log records for sending to New Relic.
  </Collapser>

  <Collapser
    id="application-logging-forwarding-max_samples_stored"
    title="application_logging.forwarding.max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Number
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Number of log records to send per minute to New Relic. Controls the overall memory consumption when using log forwarding.

    Set this to a lower value to reduce the amount of log lines sent (may cause log sampling). Set this to a higher value to send more log lines.

    Each log receives the same priority as its associated transaction. Logs that occur outside of a transaction will receive a random priority. Some logs may not be included because they are limited by `max_samples_stored`. For example, if logging `max_samples_stored` is set to 10,000 and transaction 1 has 10,000 log entries, only log entries for transaction 1 will be recorded. If transaction 1 has less than 10,000 logs you receive all logs for transaction 1. If there is still space, you receive all the logs for transaction 2, and so on.

    If after all the logs for sampled transactions are recorded, and they haven't reached the limit in `max_samples_stored`, then log messages for transactions that were not in our sampling are sent. If there are any left, log messages outside of transactions are recorded.
  </Collapser>

  <Collapser
    id="application-logging-forwarding-labels"
    title="application_logging.forwarding.labels.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            false
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the agent will add labels to log records for sending to New Relic.
  </Collapser>

<Collapser
    id="application-logging-forwarding-labels-exclude"
    title="application_logging.forwarding.labels.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            []
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    A case-insensitive list of label names to exclude when you enable including labels in logs. This attribute does not support wildcards or regex.
  </Collapser>

  <Collapser
    id="application-logging-local_decorating-enabled"
    title="application_logging.local_decorating.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the agent performs Local Log Decoration on standard log output.
  </Collapser>
</CollapserGroup>

## Code level metrics [#code-level-metrics]

The code-level metrics configuration settings require [Node.JS agent version 9.7.5 or higher](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

For more details, see [our code-level metrics docs](/docs/apm/agents/nodejs-agent/installation-configuration/codestream-integration).

<CollapserGroup>
  <Collapser
    id="code-level-metrics-enabled"
    title="code_level_metrics.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_CODE_LEVEL_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether to capture additional attributes on middleware spans for all Node.js web frameworks that help drive [Code level metrics](/docs/codestream/observability/code-level-metrics). The additional attributes are: `code.filepath`, `code.function`, `code.lineno`, and `code.column`.
  </Collapser>
</CollapserGroup>

## Errors inbox configuration [#errors-inbox-configuration]

Setting one of the following tags will help you identify which versions of your software are producing the errors.

* `NEW_RELIC_METADATA_SERVICE_VERSION` will create tags.service.version on event data containing the version of your code that is deployed, in many cases a semantic version such as 1.2.3, but not always.
* `NEW_RELIC_METADATA_RELEASE_TAG ` will create tags.releaseTag on event data containing the release tag (such as v0.1.209 or release-209).
* `NEW_RELIC_METADATA_COMMIT` will create tags.commit on event data containing the commit sha. The entire sha can be used or just the first seven characters (e.g., 734713b).

An upcoming release of errors inbox will automatically track which versions of your software are producing errors. Any version data will also be displayed in [CodeStream](/docs/codestream/how-use-codestream/performance-monitoring/#buildsha).

## Url obfuscation [#url-obfuscation]

The url obfuscation configuration settings require [Node.js agent version 9.9.0 or higher](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

For a configuration example, see our documentation for the [node agent url obfuscation](/docs/url-obfuscation/configure-url-obfuscation-nodejs).

<CollapserGroup>
  <Collapser
    id="url-obfuscation-enabled"
    title="url_obfuscation.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enables regex based [node agent url obfuscation](/docs/url-obfuscation/configure-url-obfuscation-nodejs/).
  </Collapser>

  <Collapser
    id="url-obfuscation-regex-pattern"
    title="url_obfuscation.regex.pattern"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String or RegExp
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_PATTERN`
          </td>
        </tr>
      </tbody>
    </table>

    Specifies the regex pattern to use for url obfuscation. If this is not set, no url obfuscation will be performed.
  </Collapser>

  <Collapser
    id="url-obfuscation-regex-flags"
    title="url_obfuscation.regex.flags"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_FLAGS`
          </td>
        </tr>
      </tbody>
    </table>

    Specifies the regex flags to use for url obfuscation pattern matching e.g. `g` for global matching, `i` for case insensitive matching, etc. Multiple flags can be specified as a string e.g. `gi`. If this is not set, no flags will be used.
  </Collapser>

  <Collapser
    id="url-obfuscation-regex-replacement"
    title="url_obfuscation.regex.replacement"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_REPLACEMENT`
          </td>
        </tr>
      </tbody>
    </table>

    Specifies the replacement string to use for url obfuscation. Can contain refferences to capture groups in the pattern e.g. `$1`. If this is not set, everything will be replaced with a single empty string.
  </Collapser>
</CollapserGroup>

## Security Agent [#security-agent]

[New Relic Security agent interactive applications security testing](/docs/iast/introduction/)(IAST) tests your applications for any exploitable vulnerability by replaying the generated HTTP request with vulnerable payloads.

<Callout variant="caution">
  Run IAST with non-production deployments only to avoid exposing vulnerabilities on your production software.
</Callout>

<Callout variant="important">
  The security agent configuration settings require [Node.js agent version 10.3.0 or higher](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).
</Callout>

<CollapserGroup>
  <Collapser
    id="security-enabled"
    title="security.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the New Relic Security agent data is sent to New Relic or not. When this is disabled and security.agent.enabled is true, the security agent be registered but data will not be sent.
  </Collapser>

  <Collapser
    id="security-agent-enabled"
    title="security.agent.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_AGENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Toggles whether the New Relic Security agent is loaded. This property is read only once at application start.
  </Collapser>

  <Collapser
    id="security-mode"
    title="security.mode"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `IAST`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_MODE`
          </td>
        </tr>
      </tbody>
    </table>

    New Relic Security provided mode: IAST. Default is IAST. Due to the invasive nature of IAST scanning, DO NOT enable this mode in either a production environment or an environment where production data is processed.
  </Collapser>

  <Collapser
    id="security-validator-url"
    title="security.validator_service_url"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `wss://csec.nr-data.net`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_VALIDATOR_SERVICE_URL`
          </td>
        </tr>
      </tbody>
    </table>

    New Relic Security connection URL. This is the endpoint that the security agent sends data to, it should match that environment that you have set for the Node.js agent.
  </Collapser>

  <Collapser
    id="security-rci-detection"
    title="security.detection.rci.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RCI_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enable RCI security event detection.
  </Collapser>

  <Collapser
    id="security-xss-detection"
    title="security.detection.rxss.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RXSS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enable RXSS security event detection.
  </Collapser>

  <Collapser
    id="security-deserialization-detection"
    title="security.detection.deserialization.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_DESERIALIZATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enable deserialization security event detection.
  </Collapser>
</CollapserGroup>

## Heroku [#heroku]

<CollapserGroup>
  <Collapser
    id="heroku-dyno"
    title="heroku.use_dyno_names"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_HEROKU_USE_DYNO_NAMES`
          </td>
        </tr>
      </tbody>
    </table>

    If true, the agent uses Heroku dyno names as the hostname.
  </Collapser>
</CollapserGroup>

## Worker Threads [#worker-threads]

In agent versions prior to 11.0.0, the agent ran in both main and worker threads.  In version 11.0.0 the agent stopped running in worker threads due to its incompatibility with our async context propagation. The ability to run in worker threads was restored in version 11.3.0 but you must set `worker_threads.enabled` to `true`.  The behavior of running in the worker threads varies and we do not officially support it. Some things like metrics generation, and self contained transaction traces may work but this is a use at your own risk capability.

<CollapserGroup>
  <Collapser
    id="worker-threads"
    title="worker_threads.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment)
          </th>

          <td>
            `NEW_RELIC_WORKER_THREADS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If true, the agent will load when in a worker thread if specified.
  </Collapser>
</CollapserGroup>

## Environment variable overrides

This section defines two configuration options only available with environment variables. These overrides are not used in most configurations.

<CollapserGroup>
  <Collapser
    id="home"
    title="NEW_RELIC_HOME"
  >
    Path to the directory containing `newrelic.js`. This is available only as an environment variable. You cannot set it in your config file.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

 <Collapser
    id="filename"
    title="NEW_RELIC_CONFIG_FILENAME"
  >
    Used to set a different config file name than the default `newrelic.js`. This is available only as an environment variable. You cannot set it in your config file.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="no_file"
    title="NEW_RELIC_NO_CONFIG_FILE"
  >
    If used, this prevents the agent from reading configuration settings from `newrelic.js`. Default values and values from environment variables will still be set.

    This is available only as an environment variable. You cannot set it in your config file.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Environment variable type reference guide

This section describes how to properly format the complex data types.

<CollapserGroup>
  <Collapser
    id="array"
    title="Array"
  >
    Array types are defined as comma-delimited strings.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES=404,500,429
    ```
  </Collapser>

  <Collapser
    id="object"
    title="Object"
  >
    Object types are defined as a json string.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES='{"Error":["Undefined", "No soup for you!"]}'
    ```
  </Collapser>
</CollapserGroup>
