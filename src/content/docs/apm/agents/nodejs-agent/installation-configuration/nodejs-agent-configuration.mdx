---
title: Node.js agent configuration
tags:
  - Agents
  - Nodejs agent
  - Installation and configuration
translate:
  - jp
metaDescription: 'For New Relic''s Node.js agent: how to set configuration using your config file, environment variables, or server-side config.'
redirects:
  - /docs/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration
  - /docs/nodejs/configuring-nodejs-with-environment-variables
  - /docs/nodejs/customizing-your-nodejs-config-file
  - /docs/nodejs/nodejs-configuration-options
  - /docs/agents/nodejs-agent/installation-and-configuration/nodejs-configuration-options
  - /docs/agents/nodejs-agent/installation-and-configuration/customizing-your-nodejs-config-file
  - /docs/agents/nodejs-agent/installation-and-configuration/configuring-nodejs
  - /docs/agents/nodejs-agent/installation-and-configuration/nodejs-agent-configuration
  - /docs/agents/nodejs-agent/installation-and-configuration/configuring-nodejs-environment-variables
  - /docs/agents/nodejs-agent/installation-configuration/configuring-nodejs
  - /docs/agents/nodejs-agent/installation-configuration/configuring-nodejs-environment-variables
---

You can tailor the Node.js agent to your app's requirements by editing your `newrelic.js` config file or by setting an environment variable. The config file resides in the root directory of your app. You can also configure a few options from New Relic, or use the [Node.js agent API](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api).

<Callout variant="important">
  The [`license_key`](#license) setting is required. We **highly recommend** setting the [`app_name`](#app_name) so that your app has a [meaningful name](/docs/apm/new-relic-apm/installation-configuration/name-your-application) instead of the default `My Application`.
</Callout>

## Configuration methods and precedence [#methods-and-precedence]

The primary method to configure the Node.js agent is the agent configuration file (`newrelic.js`). You can also configure most settings with [environment variables](#environment). You can also adjust some settings with [server-side configuration](#server-side).

The Node.js agent uses this order of precedence for configuration methods:

![Node.js agent configuration precedence](./images/nodejs-configuration-precedence.png "Node.js agent configuration precedence")

<figcaption>
  **Node.js configuration hierarchy:** Server-side configuration settings override environment variables. Environment variables override the agent config file. The config file overrides the agent defaults.
</figcaption>

Here are detailed descriptions of each configuration method:

<CollapserGroup>
  <Collapser
    className="freq-link"
    id="config_file"
    title="Agent configuration file"
  >
    The config file (`newrelic.js`) contains every Node.js agent setting. When you [install the Node.js agent](/docs/agents/nodejs-agent/installation-configuration/installing-maintaining-nodejs#installing), you must copy `newrelic.js` into your app's root directory. Most settings are empty by default; they inherit their values from `config/default.js`.
  </Collapser>

  <Collapser
    className="freq-link"
    id="environment"
    title="Environment variables"
  >
    Most configuration settings in `newrelic.js` have equivalent environment variables. These are useful, for example, if your agent runs in a PaaS environment such as Heroku or Microsoft Azure. Node.js agent environment variables always start with `NEW_RELIC_`.

    Where available, these environment variables are documented below under individual config options as the **Environ variable**. There are also two rarely used settings that can [only be configured via environment variables](#environment-variable-overrides).
  </Collapser>

  <Collapser
    className="freq-link"
    id="server-side"
    title="Server-side configuration"
  >
    Owners and Admins can view and configure a few settings [directly in New Relic](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration). Where available, the UI labels for server-side config are listed in this document under individual config options as the **Server-side label**.
  </Collapser>
</CollapserGroup>

## Exports variables [#exports_config]

This section defines the Node.js agent variables in the order they typically appear in the `exports.config = {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="app_name"
    title="app_name (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            "My Application"
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_APP_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    The [name New Relic uses to identify your app](/docs/apm/new-relic-apm/installation-configuration/name-your-application). For example, `app_name: ['MyNodeApp']`. To [use multiple names for your app](/docs/apm/new-relic-apm/installation-configuration/use-multiple-names-app), specify a comma-delimited list of names.

    Data for all applications with the same name will be merged in the New Relic UI, so set this carefully. We **highly recommend** that you replace the default name with a descriptive name to avoid confusion and unintended aggregation of data.

    <Callout variant="tip">
      For [Azure users](/docs/agents/nodejs-agent/hosting-services/nodejs-agent-microsoft-azure), the Node.js agent will use `APP_POOL_ID` if it is set, so you can use the name you chose for your Azure Web Server without setting it twice.
    </Callout>
  </Collapser>

  <Collapser
    id="license"
    title="license_key (REQUIRED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_LICENSE_KEY`
          </td>
        </tr>
      </tbody>
    </table>

    This setting is required. Your New Relic [license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key). For example, `license_key: '40HexadecimalCharacters'`.
  </Collapser>

  <Collapser
    id="agent-enabled"
    title="agent_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Set to `false` to stop the agent from starting up. This is useful when debugging your code requires temporarily disabling the agent. It prevents the agent from bootstrapping its instrumentation or setting up all its pieces, which prevents the agent from starting up and connecting to New Relic's servers.
  </Collapser>

  <Collapser
    id="allow_all_headers"
    title="allow_all_headers"
  >
    If `true`, enables capture of all HTTP headers, except for those filtered by `exclude` rules. If `false`, collected headers are limited to those defined in [Node.js agent attributes](/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-attributes).

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="apdex"
    title="apdex_t (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Number
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0.100`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Apdex T`
          </td>
        </tr>
      </tbody>
    </table>

    Set your Apdex T [via the New Relic UI](/docs/apm/new-relic-apm/apdex/changing-your-apdex-settings).
  </Collapser>

  <Collapser
    id="certificates"
    title="certificates"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array of strings
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Additional certificates to trust for SSL connections, specified as an array of strings in PEM format. This affects both connections to an HTTPS proxy and connections to New Relic.

    <Callout variant="tip">
      You can also configure the agent to read its certificates from a file:

      ```
      certificates: [ fs.readFileSync('<var>myca</var>.crt', {encoding: '<var>utf8</var>'}) ]
      ```
    </Callout>
  </Collapser>

  <Collapser
    id="high_security"
    title="high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_HIGH_SECURITY`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, enables [high security v2](/docs/accounts-partnerships/accounts/security/high-security#version2description). You must also enable the [`ssl`](#ssl) setting and [enable high security in the UI](/docs/accounts-partnerships/accounts/security/high-security#version2enabled).
  </Collapser>

  <Collapser
    id="host"
    title="host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `collector.newrelic.com`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Do not edit this value unless New Relic Support asks you to change it.
    </Callout>

    Hostname for the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector) to connect to the Internet; for example, `host: 'collector.newrelic.com'`.
  </Collapser>

  <Collapser
    id="labels"
    title="labels"
  >
    Adds [tags](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers). Specify your tags as objects or a semicolon-delimited string of colon-separated pairs (for example, `Server:One;Data Center:Primary`).

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object or string
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_LABELS`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="port"
    title="port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `443`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Do not edit this value unless New Relic Support asks you to change it.
    </Callout>

    Port number to connect to the New Relic collector; for example, `port: 443`.
  </Collapser>

  <Collapser
    id="proxy"
    title="proxy"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROXY_URL`
          </td>
        </tr>
      </tbody>
    </table>

    A URL specifying the proxy server to connect to the Internet. For example, `proxy: 'http://user:pass@10.0.0.1:8000/'`.

    <Callout variant="important">
      The `proxy` config file setting overrides the other config file proxy settings (`proxy_host`, `proxy_port`, `proxy_user`, `proxy_pass`) if used. Similarly, the `NEW_RELIC_PROXY_URL` environment variable overrides the other environment variable proxy settings (`NEW_RELIC_PROXY_HOST`, `NEW_RELIC_PROXY_PORT`, `NEW_RELIC_PROXY_USER`, and `NEW_RELIC_PROXY_PASS`) if used.
    </Callout>
  </Collapser>

  <Collapser
    id="proxy_host"
    title="proxy_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROXY_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Hostname or IP address of the proxy server to connect to the Internet.
  </Collapser>

  <Collapser
    id="proxy_pass"
    title="proxy_pass"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROXY_PASS`
          </td>
        </tr>
      </tbody>
    </table>

    Password for authenticating to the proxy server. The agent supports only basic HTTP authentication.
  </Collapser>

  <Collapser
    id="proxy_port"
    title="proxy_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROXY_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    Port number of the proxy server to connect to the Internet.
  </Collapser>

  <Collapser
    id="proxy_user"
    title="proxy_user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROXY_USER`
          </td>
        </tr>
      </tbody>
    </table>

    User name for authenticating to the proxy server. The agent supports only basic HTTP authentication.
  </Collapser>
</CollapserGroup>

## Logging variables [#logging_config]

This section defines the Node.js agent variables in the order they typically appear in the `logging: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="log-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true` (`false` in `serverless_mode`)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Enables or disables agent specific logging.
  </Collapser>

  <Collapser
    id="log_level"
    title="level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `info`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_LOG_LEVEL`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the level of detail recorded in the agent logs. From least detail to most detail, possible values are `fatal`, `error`, `warn`, `info`, `debug`, or `trace`.

    <Callout variant="caution">
      Do not use `debug` or `trace` logging unless New Relic Support asks you to use them. These levels of logging can generate excessive overhead. For most situations, use `info`.
    </Callout>
  </Collapser>

  <Collapser
    id="log"
    title="filepath"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `process.cwd()` plus `newrelic_agent.log`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_LOG`
          </td>
        </tr>
      </tbody>
    </table>

    Complete path to the New Relic agent log, including the filename. Defaults to `filepath: require('path').join(process.cwd(), 'newrelic_agent.log')`. The agent will shut down the process if it cannot create this file. The agent creates a log file with the same permissions as the parent Node.js agent process.

    * To write all logging to **stdout**, set this to `stdout`.
    * To write all logging to **stderr**, set this to `stderr`.
  </Collapser>
</CollapserGroup>

## Audit logging [#audit_log]

This section defines the Node.js agent variables in the order they typically appear in the `audit_log: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="audit_log-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent logs the payloads it sends to the collector. This data is included in the main log file even when logging level is set to the lowest level.
  </Collapser>

  <Collapser
    id="endpoints"
    title="endpoints"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            Empty array (include all types)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENDPOINTS`
          </td>
        </tr>
      </tbody>
    </table>

    The agent sends several different types of data to the collector in separate payloads. By default, all of them are included in the log file. This option makes it possible to limit logging only to specific types of data.

    Valid values include:

    * `agent_settings`
    * `analytic_event_data`
    * `connect`
    * `custom_event_data`
    * `error_data`
    * `error_event_data`
    * `metric_data`
    * `preconnect`
    * `shutdown`
    * `span_event_data`
    * `sql_trace_data`
    * `transaction_sample_data`
  </Collapser>
</CollapserGroup>

## API configuration [#api_config]

This section allows you to choose which API methods are enabled. Each configuration option allows you to modularly enable API methods that are responsible for sending custom information to New Relic.

<Callout variant="important">
  All of these are set to `false` when the agent is in high security mode.
</Callout>

<CollapserGroup>
  <Collapser
    id="custom-attributes"
    title="custom_attributes_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_ATTRIBUTES`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`newrelic.addCustomAttribute`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-param) and [`newrelic.addCustomAttributes`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-params).
  </Collapser>

  <Collapser
    id="custom-events"
    title="custom_events_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_EVENTS`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`recordCustomEvent`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#record_custom_event).
  </Collapser>

  <Collapser
    id="notice-error"
    title="notice_error_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_API_NOTICE_ERROR`
          </td>
        </tr>
      </tbody>
    </table>

    This option enables [`newrelic.noticeError`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#noticeError).
  </Collapser>
</CollapserGroup>

## Attributes [#node-js-attributes]

This section defines the variables for [Node.js agent attributes](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes) in the order they typically appear in the `attributes: {` section of your app's `newrelic.js` configuration file.

<Callout variant="caution">
  Any header-related include/exclude rules must be in camelCase form to be filtered.
</Callout>

<CollapserGroup>
  <Collapser
    id="attributes_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, enables capture of attributes for all destinations.
  </Collapser>

  <Collapser
    id="attributes_exclude"
    title="exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="attributes_include"
    title="include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include from all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="attributes_include_enabled"
    title="include_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When `true`, patterns may be added to the [`attributes.include`](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes#cfg-attributes-include) list.
  </Collapser>
</CollapserGroup>

## Error collector variables [#error_config]

You can [manage how error are handled](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected) in New Relic. This section defines the Node.js agent variables in the order they typically appear in the `error_collector: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="error_collector"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable error collection?`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects [error traces](/docs/apm/applications-menu/events/viewing-apm-errors-error-traces) from your app.
  </Collapser>

  <Collapser
    id="error_ignore"
    title="ignore_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `404`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Ignore these status codes`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of HTTP status codes for the error collector to ignore.

    <Callout variant="caution">
      Errors recorded using [newrelic.noticeError](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore"
    title="ignore_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array|Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of javascript error types/classes for the error collector to ignore.

    The following configuration

    ```
    /* ... */
        error_collector: {
            ignore_classes: ["ReferenceError"]
        }
        /* ... */
    ```

    Would ignore all reference errors.

    <Callout variant="caution">
      Errors recorded using [newrelic.noticeError](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#noticeError) do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore"
    title="ignore_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `{}`
          </td>
        </tr>
      </tbody>
    </table>

    A javascript object describing a list of javascript classes tied to javascript error messages for the collector to ignore. The following configuration.

    ```
    /* ... */
        error_collector: {
            /* ... */
            ignore_messages: {"Error":["Undefined", "Out of time"]}
            /* ... */
        }
        /* ... */
    ```

    Would ignore all errors of type `Error`, with the exact (case-sensitive) message strings of `Undefined` and `Out of time`.

    <Callout variant="caution">
      Errors recorded using `newrelic.noticeError` do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore"
    title="expected_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES`
          </td>
        </tr>
      </tbody>
    </table>

    Comma-delimited list of HTTP status codes for the error collector to mark as expected.

    <Callout variant="caution">
      Errors recorded using `newrelic.noticeError` do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore"
    title="expected_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    The following configuration

    ```
    /* ... */
        error_collector: {
            expected_classes: ["ReferenceError"]
        }
        /* ... */
    ```

    Would mark all reference errors as expected.

    <Callout variant="caution">
      Errors recorded using `newrelic.noticeError` do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_ignore"
    title="expected_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Object
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `{}`
          </td>
        </tr>
      </tbody>
    </table>

    A javascript object describing a list of javascript classes tied to javascript error messages for the collector to ignore. The following configuration.

    ```
    /* ... */
        error_collector: {
            /* ... */
            expected_messages: {"Error":["Undefined", "Out of time"]}
            /* ... */
        }
        /* ... */
    ```

    Would mark all errors of type `Error`, with the exact (case-sensitive) message strings of `Undefined` and `Out of time`.

    <Callout variant="caution">
      Errors recorded using `newrelic.noticeError` do not obey this configuration value.
    </Callout>
  </Collapser>

  <Collapser
    id="error_attributes_enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from error collection.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="error_attributes_exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from error collection. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="error_attributes_include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in error collection. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser
    id="error_max_event_samples_stored"
    title="max_event_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            100
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.
  </Collapser>
</CollapserGroup>

## Transaction tracer variables [#tx_tracer_config]

The agent groups your requests into [transactions](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction), which are used to:

* Visualize where your app spends its time (in transaction breakdowns).
* Identify slow requests.
* Group metrics.
* Isolate other issues, such as slow [database performance](/docs/apm/applications-menu/monitoring/databases-slow-queries-dashboard).

This section defines the Node.js agent variables in the order they typically appear in the `transaction_tracer: {` section of your app's `newrelic.js` configuration file.

<Callout variant="important">
  Do not use brackets `[suffix]` at the end of your transaction name. New Relic automatically strips brackets from the name. Instead, use parentheses `(suffix)` or other symbols if needed.
</Callout>

<CollapserGroup>
  <Collapser
    id="tracer_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRACER_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable transaction tracing?`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects slow [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser
    id="explain_threshold"
    title="explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_EXPLAIN_THRESHOLD`
          </td>
        </tr>
      </tbody>
    </table>

    Minimum query duration (in milliseconds) for a transaction to be eligible for [slow queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) in [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser
    id="record-sql"
    title="record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String (`off`, `obfuscated`, or `raw`)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `off`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_RECORD_SQL`
          </td>
        </tr>
      </tbody>
    </table>

    This option affects both [slow queries](#slow-queries) and `record_sql` for transaction traces. It can have one of three values: `off`, `obfuscated`, or `raw`.

    When set to `off` no slow queries will be captured, and backtraces and SQL will not be included in transaction traces. If set to `raw` or `obfuscated`, the agent sends raw or obfuscated SQL and a slow query sample to the [collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). The agent may also send SQL when other criteria are met, such as when `slow_sql.enabled` is set.
  </Collapser>

  <Collapser
    id="tracer_top"
    title="top_n"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRACER_TOP_N`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of requests eligible for [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).

    Transactions are named based on the request, and `top_n` refers to the "top <var>n</var> slowest transactions" grouped by these names. The module replaces a recorded trace with a new trace only if the new trace is slower than the previous slowest trace of that name. The default value for this setting is `top_n: 20`, because the [**Transactions** page](/docs/apm/transactions/transaction-traces/transaction-traces) also defaults to the 20 slowest transactions.

    The Node.js agent captures at least five different slow transactions in the first harvest cycle after start up. It will also reset and capture different transactions if no slow transactions have been captured for the last five [harvest cycles](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle). This allows you to see more information about more of your app's request paths, at the possible cost of not focusing on the absolutely slowest request for that harvest cycle.

    <Callout variant="tip">
      To record the absolute slowest transaction over the last minute, you can set `top_n: 0` or `top_n: 1`. However, this causes one very slow route to dominate your transaction traces.
    </Callout>
  </Collapser>

  <Collapser
    id="tracer_threshold"
    title="transaction_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer or `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRACER_THRESHOLD`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Threshold`
          </td>
        </tr>
      </tbody>
    </table>

    Threshold of web transaction response time in seconds beyond which a [transaction](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction) is eligible for [transaction tracing](/docs/apm/transactions/transaction-traces/transaction-traces). The default value is `apdex_f`; this sets the trace threshold to four times your application's [Apdex T](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_t). You can also enter a specific time value in milliseconds.

    **Example: Threshold set to `apdex_f`**

    The default `apdex_t` is 100 milliseconds. If your transaction threshold is set to `apdex_f`, a "slow" transaction is 400 milliseconds.
  </Collapser>

  <Collapser
    id="hide-internals"
    title="hide_internals"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_HIDE_INTERNALS`
          </td>
        </tr>
      </tbody>
    </table>

    The agent uses a small amount of CPU in order to hide internal properties that are attached to the web application. If you change this configuration to `false`, it may slightly decrease your agent overhead, but it could also have an impact on the performance of the agent.
  </Collapser>

  <Collapser
    id="hide-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction traces.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="hide-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction traces. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="hide-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction traces. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Rules variables [#rules_config]

This section defines the Node.js agent variables in the order they typically appear in the `rules: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="rules_names"
    title="name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Strings or regular expressions
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_NAMING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    A comma-delimited list of rules to match incoming request URLs and name the associated New Relic transaction. Uses the format:

    ```
    name: [
    	{pattern: '<var>STRING_OR_REGEX</var>', name: '<var>NAME</var>'},

    	{pattern: '<var>STRING_OR_REGEX</var>', name: '<var>NAME</var>'}

    	],
    ```

    Both parameters are required. For strings, you must escape control characters. You do not need to escape control characters in regular expressions. Additional attributes are ignored.

    Regular expressions support JavaScript-style capture groups, and names use `$1`-style replacement strings. Regular expressions only find the first matching result; subsequent matches are ignored. For more information, see [Node.js transaction naming API](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#ignoring).

    For the `NEW_RELIC_NAMING_RULES` environment variable, pass the rules as comma-delimited JSON object literals:

    ```
    NEW_RELIC_NAMING_RULES='{"pattern":"<var>^t</var>","name":"<var>u</var>"},{"pattern":"<var>^u</var>","name":"<var>t</var>"}'
    ```
  </Collapser>

  <Collapser
    id="rules_ignore"
    title="ignore"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Strings or regular expressions
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            Regular expression to match socket.io long-polling requests ("^\\/socket\\.io\\/.\*\\/xhr-polling/").
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_IGNORING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Define a list of request URLs you want the agent to ignore. Specify the list as patterns, which can be strings or regular expressions.
  </Collapser>

  <Collapser
    id="enforce_backstop"
    title="enforce_backstop"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ENFORCE_BACKSTOP`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Do not change this setting unless you understand [metric grouping issues](/docs/features/metric-grouping-issues).
    </Callout>

    When enabled, the agent renames transactions that are not affected by other naming logic (such as the API, rules, or metric normalization rules) to `NormalizedUri/*`. If you set this to `false`, the agent sets transaction names to `Uri/path/to/resource`.
  </Collapser>
</CollapserGroup>

## Transaction events variables [#tx_events]

This section defines the Node.js agent variables in the order they typically appear in the `transaction_events: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="tx_events_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent sends transaction events to New Relic. This event data includes transaction timing, transaction name, and any custom parameters. If this is disabled, the agent does not collect this data or send it to New Relic.
  </Collapser>

  <Collapser
    id="tx_events_max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            10000
          </td>
        </tr>
        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>

      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.

    We do not recommend configuring past 10,000. The server will cap data at 10,000 per-minute.

    <Callout variant="important">
      This configuration had different behavior in agent versions lower than 6.0.0. See [max_samples_stored (DEPRECATED)](#tx_events_max_samples_stored_legacy) for agent versions 5.x or lower.
    </Callout>
  </Collapser>

  <Collapser
    id="tx_events_max_samples_stored_legacy"
    title="max_samples_stored (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            20000
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent stores if it is unable to communicate with the [New Relic collector](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). The values from the previous [harvest cycle](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#harvest-cycle) will be merged into the next one, with this option limiting the maximum number. Make sure this number is greater than `max_samples_per_minute`; for example, set it to twice as much. Consider your memory overhead before increasing this value.

    <Callout variant="caution">
      This configuration has different behavior starting with agent version 6.0.0 and a new recommended maximum. See [max_samples_stored](#tx_events_max_samples_stored) for agent versions 6.x or higher.
    </Callout>
  </Collapser>

  <Collapser
    id="tx_events_max_samples_per_minute"
    title="max_samples_per_minute (DEPRECATED)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.

    <Callout variant="caution">
      This configuration has been replaced with max_samples_stored starting with version 6.0.0 of the agent. See [max_samples_stored](#tx_events_max_samples_stored) for 6.x or later agents.
    </Callout>
  </Collapser>

  <Collapser
    id="tx-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent captures attributes from transaction events.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="tx-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="tx-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in transaction events. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Browser monitoring variables [#browser-variables]

This section defines the Node.js agent variables in the order they typically appear in the `browser_monitoring: {` section of your app's `newrelic.js` configuration file.

<CollapserGroup>
  <Collapser
    id="browser"
    title="enable"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_ENABLE`
          </td>
        </tr>

        <tr>
          <th>
            [Server-side label](#server-side)
          </th>

          <td>
            `Enable browser monitoring?`
          </td>
        </tr>
      </tbody>
    </table>

    Generate JavaScript headers for browser instrumentation. Although this defaults to `true`, the agent doesn't inject the browser JS code unless you have [enabled browser monitoring](/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser). Even if you have enabled it and [added the browser timing header](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#procedures), you can [disable browser monitoring for your app](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#disabling) by setting this to `false`.
  </Collapser>

  <Collapser
    id="browser-debug"
    title="debug"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_DEBUG`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, request un-minified sources from the server.
  </Collapser>

  <Collapser
    id="browser-debug-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    If `true`, the agent sends custom attributes to browser monitoring.

    <Callout variant="caution">
      Any header-related include/exclude rules must be in camelCase form to be filtered.
    </Callout>
  </Collapser>

  <Collapser
    id="browser-debug-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to exclude from browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser
    id="browser-debug-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefix of attributes to include in browser monitoring. Allows `*` as wildcard at end.
  </Collapser>
</CollapserGroup>

## Custom events variables [#custom_events]

This section defines the Node.js agent variables in the order they typically appear in the `custom_insights_events: {` section of your app's `newrelic.js` configuration file. Currently there are no environment variables for custom events.

<CollapserGroup>
  <Collapser
    id="custom_events_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent sends custom events recorded with [`recordCustomEvent()`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#custom-events-api) to [New Relic](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-insights-api). If this is disabled, the agent does not collect this data or send it to New Relic.
  </Collapser>

  <Collapser
    id="custom_events_max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `1000`
          </td>
        </tr>
        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of custom events the agent collects per minute. If the number of custom events exceeds this limit, the agent collects a statistical sampling.

    <Callout variant="important">
      Increasing this limit increases memory usage.
    </Callout>
  </Collapser>
</CollapserGroup>

## Slow queries variables [#slow-queries]

This section defines the Node.js agent variables in the order they typically appear in the `slow_sql: {` section of your app's `newrelic.js` configuration file. These options control behavior for slow queries, but do not affect SQL nodes in transaction traces.

<CollapserGroup>
  <Collapser
    id="slow-sql-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SLOW_SQL_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects [slow query details](/docs/apm/applications-menu/monitoring/viewing-slow-query-details).
  </Collapser>

  <Collapser
    id="slow-sql-max-samples"
    title="max_samples"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            10
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_MAX_SQL_SAMPLES`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of slow queries the agent collects per minute. The agent discards additional queries after the limit is reached.

    <Callout variant="important">
      Increasing this limit increases memory usage.
    </Callout>
  </Collapser>
</CollapserGroup>

## Custom hostname variables [#custom-hostnames]

This section defines the Node.js agent variables in the order they typically appear in the `process_host: {` section of your app's `newrelic.js` configuration file. These options control behavior regarding the host display name in the APM UI.

<CollapserGroup>
  <Collapser
    id="custom-hostnames-display"
    title="display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String of 255 bytes or less
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    Specify a custom hostname for [display in New Relic](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name). If you do not set this field, New Relic will continue to use the default hostname found by calling `os.hostname()`.

    * If you use the default hostname settings, New Relic finds the hostname through `os.hostname()`.
    * If this call fails, New Relic uses the host's IP as the name.
    * If you set `ipv_preference: 4` or `ipv_preference: 6`, you can select the type of IP address (IPv4 or IPv6) that appears in the New Relic UI.
  </Collapser>

  <Collapser
    id="custom-hostnames-ipv"
    title="ipv_preference"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer (`4` or `6`)
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `4`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_IPV_PREFERENCE`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Environment variable overrides

This section defines two configuration options only available with environment variables. These overrides are not used in most configurations.

<CollapserGroup>
  <Collapser
    id="home"
    title="NEW_RELIC_HOME"
  >
    Path to the directory containing `newrelic.js`. This is available only as an environment variable. You cannot set it in your config file.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="no_file"
    title="NEW_RELIC_NO_CONFIG_FILE"
  >
    If used, this prevents the agent from reading configuration settings from `newrelic.js`. Default values and values from environment variables will still be set.

    This is available only as an environment variable. You cannot set it in your config file.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `False`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Datastore tracer variables [#datastore-tracer]

This section defines the Node.js agent variables in the order they typically appear in the `datastore_tracer` section of your app's `newrelic.js` configuration file. These options control behavior for collecting datastore instance metrics.

<CollapserGroup>
  <Collapser
    id="datastore-instance-enabled"
    title="instance_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects datastore instance metrics (such as host and port) for [some database drivers](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information). These are reported on slow query traces and transaction traces.
  </Collapser>

  <Collapser
    id="datastore-name-enabled"
    title="database_name_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    When enabled, the agent collects database name on slow query traces and transaction traces for [some database drivers](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information).
  </Collapser>
</CollapserGroup>

## Cross application tracing (DEPRECATED) [#cross-app-tracing] 

The Node.js agent variables that control [cross application tracing](/docs/apm/transactions/cross-application-traces/introduction-cross-application-traces) typically appear in the `cross_application_tracer` section of your app's `newrelic.js` configuration file:

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    When set to `true`, allows tracing of transactions across more than one New Relic-monitored applications.
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Cross application tracing (CAT) has been deprecated and will be removed in a future major release. For cross-service visibility, we recommend using [distributed tracing](#distributed-tracing), which is enabled by default as of agent version 8.3.0. Before enabling, read the [transition guide](/docs/transition-guide-distributed-tracing).
</Callout>

## Error message redaction variables [#err-message-redact]

The Node.js agent variables that control error message redaction appear in the `allow_raw_exception_messages` section of your app's `newrelic.js` configuration file:

<CollapserGroup>
  <Collapser
    id="allow-raw-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_ALLOW_RAW_EXCEPTION_MESSAGES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    When `false`, the agent will redact the messages of captured errors.
  </Collapser>
</CollapserGroup>

## Distributed tracing

<Callout variant="important">
  Enabling distributed tracing disables [cross application tracing](#cross-app-tracing), and has effects on other APM features. Before enabling, read the [transition guide](/docs/transition-guide-distributed-tracing). Requires [Node.js agent version 4.7.0 or higher](/docs/agents/nodejs-agent/installation-configuration/upgrade-nodejs-agent).
</Callout>

[Distributed tracing](/docs/intro-distributed-tracing) lets you see the path that a request takes as it travels through a distributed system. When configuring via the config file, place the following option in the `distributed_tracing` section.

<CollapserGroup>
  <Collapser
    id="dt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Set this to `true` to enable distributed tracing.

    For example, to enable this in the config file, you would use:

    ```
    distributed_tracing: {
       enabled: true
    }
    ```
  </Collapser>

  <Collapser
    id="dt-exclude-newrelic-header"
    title="exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Set this to `true` to exclude the New Relic header that is attached to outbound requests, and instead only rely on W3C Trace Context Headers for distributed tracing. If this is `false` then both types of headers are used.

    For example, to enable this in the config file, you would use:

    ```
    distributed_tracing:{
       enabled: true,
       exclude_newrelic_header: true
    }
    ```
  </Collapser>
</CollapserGroup>

## Span events

[Span data](/docs/apm/distributed-tracing/ui-data/span-event) is reported for [distributed tracing](#distributed-tracing). Distributed tracing must be enabled to report spans. Span configuration is set in the `span_events` stanza. Options include:

<CollapserGroup>
  <Collapser
    id="span-events-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Turns reporting of span events on or off.
  </Collapser>

  <Collapser
    id="span-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    This setting can be used to turn reporting of attributes on or off for spans. If `attributes.enabled` at the root level is `false`, no attributes will be sent with spans regardless on how this is set.
  </Collapser>

  <Collapser
    id="span-events-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled for spans, all attribute keys found in this list will be attached to spans. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="span-events-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    All attribute keys found in this list will not be sent with spans. For more information, see the [agent attribute rules](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

  <Collapser
    id="span-events-max-samples-stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            2000
          </td>
        </tr>
        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the maximum number of events the agent collects per minute. If there are more than this number, the agent collects a statistical sampling.

    We do not recommend configuring past 10k. The server will cap data at 10k per-minute.



  </Collapser>

## Infinite Tracing

To turn on Infinite Tracing, enable distributed tracing (set `distributed_tracing` to `enabled: true`) and add the additional settings below. For an example, see [Language agents: configure distributed tracing](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#node-config).

<CollapserGroup>
  <Collapser
    id="infinite-tracing-host"
    title="trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `(none)`
          </td>
        </tr>

        <tr>
          <th>
            [Environ variable](#environment-variables)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    For help getting a valid Infinite Tracing trace observer host entry, see [Find or create a trace observer endpoint](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).
  </Collapser>
</CollapserGroup>
