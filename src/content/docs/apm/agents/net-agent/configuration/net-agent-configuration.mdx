---
title: .NET agent configuration
tags:
  - Agents
  - NET agent
  - Configuration
metaDescription: 'How to configure the New Relic .NET agent using newrelic.config, including startup and instrumentation options, and disabling unwanted features.'
redirects:
  - /docs/agents/net-agent/configuration/net-agent-configuration 
  - /docs/general/dotnet-agent-configuration
  - /docs/dotnet/dotnet-agent-configuration
  - /docs/agents/net-agent/installation-and-configuration/net-agent-configuration
  - /docs/agents/net-agent/installation-configuration/net-agent-configuration
  - /docs/agents/net-agent/configuration/environment-variables
---

import apmNetAgentConfigurationHierarchy from 'images/apm_diagram_net-agent-configuration-hierarchy.png'

You'll be able to configure our .NET agent to suit your environment after you [create a New Relic account](https://newrelic.com/signup) (it's free, forever) and [install the .NET agent](/install/dotnet).

## Configuration overview [#config-overview]

APM agent configuration options allow you to control some aspects of how the agent behaves. Some of these config options are part of the basic install process (like setting your license key and app name), but most are more advanced settings, such as setting a log level, setting up proxy host access, excluding certain attributes, and enabling distributed tracing.

The .NET agent gets its configuration from the `newrelic.config` file, which is generated as part of the [install process](/docs/agents/net-agent/installation//install/dotnet-agent). By default, only a global `newrelic.config` file is created, but you can also create app-local `newrelic.config` files for finer control over a multi-app system. Other ways to set config options include: using environment variables, or setting server-side configuration from the UI. For more on the various config options and what overrides what, see [Config settings precedence](/docs/agents/net-agent/configuration/net-agent-configuration#config-options-precedence).

Support for both .NET Framework and .NET Core use the same configuration options and have the same APM features, unless otherwise stated.

If you make changes to the config file and want to validate that it's in the right format, you can check it against the XSD file (for example, at `C:\ProgramData\New Relic\.NET Agent\newrelic.xsd` for Windows) with any XSD validator.

<Callout variant="important">
  **For IIS**: after you change your `newrelic.config` or `app.config` file, perform an `IISRESET` from an administrative command prompt. Log level adjustments do not require a reset.
</Callout>

## Configuration methods and precedence levels [#config-options-precedence]

Upon installation, the .NET agent's configuration file (`newrelic.config`) applies to all monitored applications, but you can configure the agent in other ways. Here's a diagram showing how different configuration options take precedence over one another:

<img
  title="net-config-precedence-core.png"
  alt="New Relic .NET agent configuration settings precedence"
  src={apmNetAgentConfigurationHierarchy}
/>

<figcaption>
  This diagram explains the order of precedence for different ways you might configure the .NET agent.
</figcaption>

Here are details about the configuration methods shown in the diagram, and their precedence levels:

<table>
  <thead>
    <tr>
      <th style={{ width: "230px" }}>
        **.NET configuration**
      </th>

      <th>
        **Details and precedence**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `web.config` or `app.config` or `appsettings.json`
      </td>

      <td>
        Configuration settings set in these files take highest precedence.

        However, if the agent is disabled in the local or global `newrelic.config`, the `NewRelic.AgentEnabled` settings in these files will be ignored.
      </td>
    </tr>

    <tr>
      <td>
        Environment variables
      </td>

      <td>
        Second-highest precedence. For more about these, see [.NET environment variables](#environment-variables).
      </td>
    </tr>

    <tr>
      <td>
        Server-side configuration
      </td>

      <td>
        Third-highest precedence. A limited number of [server-side configuration](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration) settings are available; the other settings will come from other configuration sources.
      </td>
    </tr>

    <tr id="local">
      <td>
        App-local `newrelic.config`
      </td>

      <td>
        Fourth-highest precedence. You can create app-local `newrelic.config` files to configure individual apps on a multi-app system. These local configuration files override settings in the global `newrelic.config` file.

        The agent looks for app-local config files in the following directories, in this order:

        * A directory specified in your `web.config` or `app.config` file with the `NewRelic.ConfigFile` property
        * The web app's root directory (with the `app.config` or `web.config`)
        * The directory containing your app's executable file

          Note that the app-local config file must be complete and validate against the XSD file (for example, at `C:\ProgramData\New Relic\.NET Agent\newrelic.xsd` for Windows).
      </td>
    </tr>

    <tr>
      <td>
        Default (global) `newrelic.config`
      </td>

      <td>
        Default source and the lowest precedence. Will configure all applications on a host in the absence of other config files. The global config file is located in the New Relic agent home directory: `%PROGRAMDATA%\New Relic\.NET Agent`
      </td>
    </tr>
  </tbody>
</table>

## Required environment variables [#environment-variables]

Our .NET agent relies on environment variables to tell the .NET Common Language Runtime (CLR) to attach New Relic to your processes. Some [.NET agent install procedures](/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction) (like the MSI installer) will automatically set these variables for you; some procedures will require you to manually set them.

<Callout variant="caution">
  Security recommendation: You should consider what users can set system environment variables. You should also secure the accounts under which your applications execute to prevent user environment variables overriding system environment variables
</Callout>

<CollapserGroup>
  <Collapser
    id="net-framework-env-variables"
    title=".NET Framework environment variables"
  >
    For .NET Framework, the following variables are required:

    ```ini
    COR_ENABLE_PROFILING=1
    COR_PROFILER={71DA0A04-7777-4EC6-9643-7D28B46A8A41}
    NEWRELIC_INSTALL_PATH="INSERT_THE_PATH_TO_THE_AGENT_DIRECTORY"
    ```

    The Windows .NET agent installer will add these to IIS by default, or as system-wide environment variables when enabling `Instrument All`.

    When using the Windows .NET agent installer, ensure that `NEWRELIC_INSTALL_PATH` is set to `C:\Program Files\New Relic\.NET Agent\`. This is where the agent DLLs are placed on the system.
    
    When installing the agent via the Nuget package, the agent requires [a different set of environment variables](/docs/apm/agents/net-agent/install-guides/install-net-agent-using-nuget/#nuget-framework).
  </Collapser>

  <Collapser
    id="net-core-env-variables"
    title=".NET Core environment variables"
  >
    For .NET Core, the following variables are required:

    **Linux:**

    ```ini
    CORECLR_ENABLE_PROFILING=1
    CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A}
    CORECLR_NEWRELIC_HOME=<var>path/to/agent/directory</var>
    CORECLR_PROFILER_PATH="${CORECLR_NEWRELIC_HOME}/libNewRelicProfiler.so"
    ```

    **Windows (MSI Installer):**

    ```ini
    CORECLR_ENABLE_PROFILING=1
    CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A}
    NEWRELIC_INSTALL_PATH=<var>C:\Program Files\New Relic\.NET Agent\</var>
    CORECLR_NEWRELIC_HOME=<var>C:\ProgramData\New Relic\.NET Agent\</var>
    ```
    
    The Windows .NET agent installer will add these to IIS by default, or as system-wide environment variables when enabling `Instrument All`. Exception: `CORECLR_ENABLE_PROFILING` needs to be set manually in order to instrument non-IIS hosted .NET Core applications. For more information, see our [installation documentation](/install/dotnet#enable-net-core).

    When installing the agent via the Nuget package in Windows, the agent requires a [different set of environment variables](/docs/apm/agents/net-agent/install-guides/install-net-agent-using-nuget/#nuget-windows).

  </Collapser>
</CollapserGroup>

If your system has previously used monitoring services (non-New Relic), you may have a "profiler conflict" when trying to install and use the New Relic agent. More details:

<CollapserGroup>
  <Collapser
    id="profiler-conflicts"
    title="Profiler conflict explanation"
  >
    New Relic's .NET agents rely on environment variables to tell the .NET Common Language Runtime (CLR) to load New Relic into your processes. The install-related environment variables are Microsoft variables, not New Relic variables. They can be used by other .NET profilers, and only one profiler can be attached to a process at a time. For this reason, if you have used previous application monitoring products, you may have [profiler conflicts](/docs/agents/net-agent/troubleshooting/profiler-conflicts).
  </Collapser>
</CollapserGroup>

For specific install instructions, see the [.NET agent install documentation](/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction).

## Optional environment variables [#optional-environment-variables]

Some configuration options in New Relic's .NET agent can be set via environment variables as an alternative to setting them in a config file. Below is a list of environment variables recognized by the .NET agent with example values.

```
NEW_RELIC_LICENSE_KEY=XXXXXXXX
NEW_RELIC_LOG=MyApp.log
NEW_RELIC_APP_NAME=Descriptive Name
MAX_TRANSACTION_SAMPLES_STORED=500
MAX_EVENT_SAMPLES_STORED=500
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_SPAN_EVENTS_ENABLED=false
NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED=2000
NEW_RELIC_LABELS=foo:bar;zip:zap
NEW_RELIC_PROXY_HOST=hostname
NEW_RELIC_PROXY_URI_PATH=path.to/something.aspx
NEW_RELIC_PROXY_PORT=5000
NEW_RELIC_PROXY_USER=myusername
NEW_RELIC_PROXY_PASS=XXXXXXXX
NEW_RELIC_PROXY_DOMAIN=mydomain.com
NEW_RELIC_PROXY_PASS_OBFUSCATED=XXXXXXXX
NEW_RELIC_CONFIG_OBSCURING_KEY=XXXXXXXX
NEW_RELIC_DISABLE_SAMPLERS=true
NEWRELIC_PROFILER_LOG_DIRECTORY=<var>path\to\a\directory</var> (not configurable via config file)
NEWRELIC_LOG_DIRECTORY=<var>path\to\a\directory</var> (Insert a directory where you want to put the agent and profiler logs. You can't set this directory for both agent and profiler logs in the configuration file.)
NEWRELIC_LOG_LEVEL=<var>off|error|warn|info|debug|finest|all</var>
NEW_RELIC_APPLICATION_LOGGING_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED=false
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED=10000
NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED=false
NEW_RELIC_ALLOW_ALL_HEADERS=true
NEW_RELIC_ATTRIBUTES_ENABLED=true
NEW_RELIC_ATTRIBUTES_INCLUDE=request.headers.*,foo.bar
NEW_RELIC_ATTRIBUTES_EXCLUDE=request.headers.cookie,request.headers.authorization
NEW_RELIC_UTILIZATION_DETECT_AWS=<var>true|false</var>
NEW_RELIC_UTILIZATION_DETECT_AZURE=<var>true|false</var>
NEW_RELIC_UTILIZATION_DETECT_GCP=<var>true|false</var>
NEW_RELIC_UTILIZATION_DETECT_PCF=<var>true|false</var>
NEW_RELIC_UTILIZATION_DETECT_DOCKER=<var>true|false</var>
NEW_RELIC_UTILIZATION_DETECT_KUBERNETES=<var>true|false</var>
NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD=<var>true|false</var>
NEW_RELIC_CODE_LEVEL_METRICS_ENABLED=<var>true|false</var>
NEW_RELIC_SEND_DATA_ON_EXIT=<var>true|false</var>
NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS=<var>2000</var>
```

If you're using New Relic CodeStream to monitor performance from your IDE you may also want to [associate repositories with your services](/docs/codestream/how-use-codestream/performance-monitoring#repo-association) and [associate build SHAs or release tags with errors](/docs/codestream/how-use-codestream/performance-monitoring#buildsha).

## Setup options, newrelic.config [#setup]

Use these options to setup and configure your agent via the newrelic.config file. The .NET agent supports the following categories of setup options:

* [Configuration element](#configuration)
* [Service element](#service)
* [Obscuring key element](#obscuring-key)
* [Proxy element](#proxy)
* [Log element](#log)
* [Application element (configuration)](#application-configuration)
* [Data transmission element](#data-transmission)
* [Host name](#host-name)

### Configuration element [#configuration]

The root element of the configuration document is a `configuration` element.

```xml
<configuration xmlns="urn:newrelic-config"
  agentEnabled="true"
  maxStackTraceLines="50">
```

The `configuration` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="config-agentEnabled"
    title="agentEnabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the New Relic agent.
  </Collapser>

  <Collapser
    id="config-maxStackTraceLines"
    title="maxStackTraceLines"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `80`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of stack frames to trace in any stack dump.
  </Collapser>
</CollapserGroup>

### Service element [#service]

The first child of the `configuration` element is a `service` element. The service element configures the agent's connection to the New Relic service.

```xml
<service licenseKey="<var>YOUR_LICENSE_KEY</var>"
  sendEnvironmentInfo="true"
  syncStartup="false"
  sendDataOnExit="false"
  sendDataOnExitThreshold="60000"
  autoStart="true"/>
```

The `service` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="service-licenseKey"
    title={<>licenseKey <strong>(required)</strong></>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Your New Relic [license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key). New Relic uses the license key to match your app's data to the correct account in the UI. Set the license key via environment variable.

    Alternatively, set the `NEW_RELIC_LICENSE_KEY` environment variable in the application's environment.

    ```ini
    NEW_RELIC_LICENSE_KEY=<var>XXXXXXXX</var>
    ```
  </Collapser>

  <Collapser
    id="service-sendEnvironmentInfo"
    title="sendEnvironmentInfo"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Instructs the agent to record execution environment information. Environment information includes operating system, agent version, and which assemblies are available.
  </Collapser>

  <Collapser
    id="service-syncStartup"
    title="syncStartup"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Block application startup until the agent connects to New Relic. If set to `true`, the first transaction may take substantially longer to complete, because it is blocked until the connection to New Relic is finished.
  </Collapser>

  <Collapser
    id="service-sendDataOnExit"
    title="sendDataOnExit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Block application shutdown while the agent initiates a final harvest cycle and sends all data to New Relic.
  
    Alternatively, set the `NEW_RELIC_SEND_DATA_ON_EXIT` environment variable in the application's environment.

    ```ini
    NEW_RELIC_SEND_DATA_ON_EXIT=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="service-sendDataOnExitThreshold"
    title="sendDataOnExitThreshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `60000`
          </td>
        </tr>

        <tr>
          <th>
            Unit
          </th>

          <td>
            Milliseconds
          </td>
        </tr>
      </tbody>
    </table>

    The minimum amount of time the process must run before the agent blocks it from shutting down. This setting only applies when [`sendDataOnExit`](#service-sendDataOnExit) is `true`.
  
    Alternatively, set the `NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS` environment variable in the application's environment.

    ```ini
    NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS=<var>2000</var>
    ```
  </Collapser>

  <Collapser
    id="service-completeTransactionsOnThread"
    title="completeTransactionsOnThread"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    If false, the agent uses a pool thread to complete the transaction processing.

    If true, the agent will complete transaction processing on the request thread.
  </Collapser>

  <Collapser
    id="service-forceNewTransactionOnNewThread"
    title="forceNewTransactionOnNewThread"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    If false, the agent attempts to re-use existing transactions when custom instrumented methods are encountered in async/threaded scenarios.

    If true, the agent attempts to create new transactions when custom instrumented methods are encountered in async/threaded scenarios.

    Alternatively, the `NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD` environment variable may be used to control this behavior.

    ```ini
    NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="service-requestTimeout"
    title="requestTimeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `2000` ([`sendDataOnExit`](#service-sendDataOnExit) enabled)

            `120000` ([`sendDataOnExit`](#service-sendDataOnExit) disabled)
          </td>
        </tr>

        <tr>
          <th>
            Unit
          </th>

          <td>
            Milliseconds
          </td>
        </tr>
      </tbody>
    </table>

    The agent's request timeout when communicating with New Relic.
  </Collapser>

  <Collapser
    id="service-autoStart"
    title="autoStart"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Automatically start the .NET agent when the first instrumented method is hit.
  </Collapser>
  
  <Collapser
    id="service-host"
    title="host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Provides the ability to configure a [FedRAMP compliant endpoint](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/) for the agent to use, with the value `gov-collector.newrelic.com`. 
  
    ```xml
    <service licenseKey="YOUR_LICENSE_KEY"
      host="gov-collector.newrelic.com" />
    ```
    
    You can also use the environment variable `NEW_RELIC_HOST`.
  
    ```ini
    NEW_RELIC_HOST=gov-collector.newrelic.com
    ```
  </Collapser>
</CollapserGroup>

### Obscuring key element [#obscuring-key]

The `obscuringKey` element is an optional child of the `service` element. The .NET Agent uses this value to deobfuscate supported configuration values. For example, when an [obfuscated proxy password](#proxy-password) is supplied, it will be deobfuscated using this key.

```xml
<service licenseKey="<var>YOUR_LICENSE_KEY</var>">
  <obscuringKey><var>OBSCURING_KEY</var></obscuringKey>
</service>
```

The obscuring key may also be configured by setting the `NEW_RELIC_CONFIG_OBSCURING_KEY` environment variable.

<Callout variant="caution">
  Security recommendation: The placement of the obscuring Key in the same configuration file as an obfuscated value may pose a security risk. Consider placing the obscuring key and [obfuscated proxy password](#proxy-password) in environment variables and limiting access to environment variables within your environment.
</Callout>

### Proxy element [#proxy]

The `proxy` element is an optional child of the `service` element. The `proxy` element is used when the agent communicates to the New Relic back-end service via a proxy.

```xml
<service licenseKey="<var>YOUR_LICENSE_KEY</var>">
  <proxy
    host="<var>hostname</var>"
    port="<var>PROXY_PORT</var>"
    uriPath="<var>path/to/something.aspx</var>"
    domain="<var>mydomain.com</var>"
    user="<var>PROXY_USERNAME</var>"
    password="<var>PROXY_PASSWORD</var>"
    passwordObfuscated="<var>OBFUSCATED_PROXY_PASSWORD</var>"/>
</service>
```

The `proxy` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="proxy-host"
    title="host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Defines the proxy host.

    Alternatively, set the `NEW_RELIC_PROXY_HOST` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-port"
    title="port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `8080`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the proxy port.

    Alternatively, set the `NEW_RELIC_PROXY_PORT` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-uripath"
    title="uriPath"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Optionally define a proxy URI path.

    Alternatively, set the `NEW_RELIC_PROXY_URI_PATH` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-domain"
    title="domain"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Optionally define a domain to use when authenticating with the proxy server.

    Alternatively, set the `NEW_RELIC_PROXY_DOMAIN` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-user"
    title="user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Optionally define a user name for authentication.

    Alternatively, set the `NEW_RELIC_PROXY_USER` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-password"
    title="password"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Optionally define a password for authentication.

    Alternatively, set the `NEW_RELIC_PROXY_PASS` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="proxy-password"
    title="passwordObfuscated"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    For additional security, the .NET Agent supports the use of an obfuscated proxy password with the passwordObfuscated attribute. The obfuscated proxy password is generated using the following [New Relic CLI](https://github.com/newrelic/newrelic-cli) command:

    ```bash
    newrelic agent config obfuscate --key OBSCURING_KEY --value "PLAIN_TEXT_PROXY_PASSWORD"
    ```

    Alternatively, set the `NEW_RELIC_PROXY_PASS_OBFUSCATED` environment variable in the application's environment.

    <Callout variant="important">
      When using an obfuscated proxy password, the [obscuring key](#obscuring-key) must also be configured.
    </Callout>
  </Collapser>
</CollapserGroup>

### Log element [#log]

The `log` element is a child of the `configuration` element. The `log` element configures New Relic's logging . The agent generates its own log file to keep its logging information separate from your application's logs.

```xml
<log level="info"
  auditLog="false"
  console="false"
  directory="<var>PATH\TO\LOG\DIRECTORY</var>"
  fileName="<var>FILENAME.log</var>" />
```

The `log` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="log-level"
    title="level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `info`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the level of detail recorded in the log file. Possible values, in increasing order of detail, are:

    * `off`
    * `error`
    * `warn`
    * `info`
    * `debug`
    * `finest`
    * `all`

      Alternatively, set the `NEWRELIC_LOG_LEVEL` environment variable in the application's environment.

      <Callout variant="important">
        Increasing the log level will increase New Relic's performance impact.
      </Callout>
  </Collapser>

  <Collapser
    id="log-auditLog"
    title="auditLog"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Records all data sent to and received from New Relic in both an auditlog log file and the standard log file.
  </Collapser>

  <Collapser
    id="log-console"
    title="console"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Send log messages to the console, in addition to the log file.
  </Collapser>

  <Collapser
    id="log-directory"
    title="directory"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `C:\ProgramData\New Relic\.NET Agent\Logs`
          </td>
        </tr>
      </tbody>
    </table>

    The directory to hold log files generated by the agent. If this is omitted, then a directory named **logs** in the New Relic agent install area will be used by default.
    
    Alternatively, set the `NEWRELIC_LOG_DIRECTORY` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="log-fileName"
    title="fileName"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Defines a name for the log file. If you do not define a `fileName`, the name is derived from the name of the monitored process.

    Alternatively, set the `NEW_RELIC_LOG` environment variable in the application's environment.

    ```ini
    NEW_RELIC_LOG=MyApp.log
    ```
  </Collapser>
</CollapserGroup>

### Application element (required) [#application-configuration]

The `application` element is a child of the `configuration` element. This required element defines your application name, and disables or enables sampling.

<CollapserGroup>
  <Collapser
    id="app-name"
    title="name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `My Application`
          </td>
        </tr>
      </tbody>
    </table>

    The [name of your .NET application](/docs/agents/net-agent/installation-and-configuration/naming-your-net-application) is a child of the `application` element. New Relic will aggregate your data according to this name. For example, if you have two running applications named `AppA` and `AppB`, you will see two applications in the New Relic interface: `AppA` and `AppB`.

    You can also assign [up to three names](/docs/agents/manage-apm-agents/app-naming/use-multiple-names-app) to your app. The first name is the primary name. For example:

    ```xml
    <application>
      <name><var>MY APPLICATION PRIMARY</var></name>
      <name><var>SECOND APP NAME</var></name>
      <name><var>THIRD APP NAME</var></name>
    </application>
    ```

    Alternatively, set the `NEW_RELIC_APP_NAME` environment variable in the application's environment.

    ```ini
    NEW_RELIC_APP_NAME=Descriptive Name
    ```
  </Collapser>

  <Collapser
    id="app-disableSamplers"
    title="disableSamplers"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Samplers collect information about memory and CPU consumption. Set this to `true` to disable sampling.

    Alternatively, set the `NEW_RELIC_DISABLE_SAMPLERS` environment variable in the application's environment.

    ```ini
    NEW_RELIC_DISABLE_SAMPLERS=true
    ```
  </Collapser>
</CollapserGroup>

### Data transmission element [#data-transmission]

The `dataTransmission` element is a child of the `configuration` element. This element affects how data is sent to New Relic and can be used if you have specific data transmission requirements.

```xml
<dataTransmission
  putForDataSend="false"
  compressedContentEncoding="deflate"/>
```

The `dataTransmission` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="data-transmission-putfordatasend"
    title="putForDataSend"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the HTTP method used when sending data to New Relic. Set this to `true` to enable using the `PUT` method when sending data. The `POST` method is used by default.
  </Collapser>
</CollapserGroup>

### Host name

If the default host name label in the APM UI is not useful, you can decorate that name in the New Relic UI with a display name. After the application process is restarted and the .NET agent is reporting again, the display name will appear in the **Servers** drop-down list. This host name setting does not affect the list of hosts on [your application's **Summary** page](/docs/apm/applications-menu/monitoring/apm-overview-page-view-transaction-apdex-usage-data).

To set a display name, choose one of the following options. The environment variable takes precedence over the config file value. Then restart your application to see your changes in the New Relic UI.

<CollapserGroup>
  <Collapser
    id="host-name-config"
    title="Set using config file"
  >
    Set the `displayName` attribute in the `processHost` element in `newrelic.config`. The `processHost` element is a child of the `configuration` element.

    ```xml
    <configuration . . . >
      <processHost displayName="<var>CUSTOM_NAME</var>" />
    </configuration>
    ```
  </Collapser>

  <Collapser
    id="host-name-env_variable"
    title="Set using environment variable"
  >
    Set the `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME` environment variable:

    ```ini
    NEW_RELIC_PROCESS_HOST_DISPLAY_NAME="<var>CUSTOM_NAME</var>"
    ```
  </Collapser>
</CollapserGroup>

## Cloud platform utilization [#cloud-platform-util]

The `utilization` configuration element controls how the agent collects utilization information and sends it to the New Relic service to determine pricing. The agent can collect information from Amazon Web Services (AWS) EC2 instances, Docker containers, Microsoft Azure, Google Cloud Platform, Pivotal Cloud Foundry, and Kubernetes.

```xml
<configuration . . . >
  <utilization detectAws="true" detectAzure="true" detectGcp="true" detectPcf="true" detectDocker="true" detectKubernetes="true" />
</configuration>
```

The `utilization` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="detectAws"
    title="detectAws"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls AWS metadata API.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_AWS` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_AWS=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="detectAzure"
    title="detectAzure"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls Microsoft Azure metadata API.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_AZURE` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_AZURE=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="detectGcp"
    title="detectGcp"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls GCP metadata API.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_GCP` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_GCP=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="detectPcf"
    title="detectPcf"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls PCF information from environment variables.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_PCF` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_PCF=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="detectDocker"
    title="detectDocker"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent reads Docker information from the file system.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_DOCKER` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_DOCKER=<var>true|false</var>
    ```
  </Collapser>

  <Collapser
    id="detectKubernetes"
    title="detectKubernetes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determines whether the agent polls Kubernetes information from environment variables.

    Alternatively, this behavior can be controlled via the `NEW_RELIC_UTILIZATION_DETECT_KUBERNETES` environment variable:

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_KUBERNETES=<var>true|false</var>
    ```
  </Collapser>
</CollapserGroup>

## Instrumentation options [#instrumentation]

Use these options to configure which elements of your application and environment to instrument. New Relic for .NET supports the following categories of instrumentation options:

* [Instrumentation element](#instrumentation-element)
* [Applications element (instrumentation)](#application-instrumentation)
* [Attributes element](#agent-attributes)

### Instrumentation element

The `instrumentation` element is a child of the `configuration` element. By default, the .NET agent instruments IIS asp worker processes and Microsoft Azure web and worker roles. To instrument other processes, see [Instrumenting custom applications](/docs/agents/net-agent/features/instrumenting-custom-applications).

### Applications element (instrumentation) [#application-instrumentation]

The `applications` element is a child of the `instrumentation` element. The `applications` element supports `application` child elements which specify which non-web apps to instrument. The `application` element contains a `name` attribute.

<Callout variant="important">
  This is not the same as the [`application` (configuration)](#application-configuration) element, which is a [child of the `configuration`](#application) element.
</Callout>

```xml
<instrumentation>
  <applications>
    <application name="<var>MyService1.exe</var>" />
    <application name="<var>MyService2.exe</var>" />
    <application name="<var>MyService3.exe</var>" />
  </applications>
</instrumentation>
```

### Attributes element [#agent-attributes]

An attribute is a key/value pair that determines the properties of an event or transaction. Each attribute is sent to APM transaction traces, APM error traces, Transaction events, TransactionError events, or PageView events. The primary `attributes` element enables or disables attribute collection for the .NET agent, and defines specific attributes to collect or exclude. You can also configure attribute settings based on their destination: [Error collection](#error-attributes), [transaction traces](#tracer-attributes), [browser instrumentation](#browser-attributes), and [transaction events](#transaction-attributes).

In this example, the agent excludes all attributes whose key begins with **myApiKey** (**myApiKey.bar**, **myApiKey.value**), but collects the custom attribute **myApiKey.foo**.

```xml
<attributes enabled="true">
  <exclude><var>myApiKey.*</var></exclude>
  <include><var>myApiKey.foo</var></include>
</attributes>
```

You can view the .NET APM attributes on the [.NET agent attributes](/docs/agents/net-agent/attributes/net-agent-attributes) page. You can also define custom attributes with the agent API call [`AddCustomAttribute`](/docs/agents/net-agent/net-agent-api/itransaction/#addcustomattribute).

<CollapserGroup>
  <Collapser
    id="agent-attributes-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable attribute collection. When set to `false` in the primary attribute element, this setting overrides all attribute settings for individual destinations.

    Alternatively, set the `NEW_RELIC_ATTRIBUTES_ENABLED` environment variable in the application's environment.
  </Collapser>

  <Collapser
    id="agent-attributes-include"
    title="include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled, the agent will collect all attribute keys specified in this list. To specify multiple attribute keys, specify each individually. You can also use a `*` wildcard character at the end of a key to match multiple attributes (for example, `myApiKey.*`). For more information, see [Attribute rules](/docs/agents/net-agent/attributes/enabling-disabling-attributes#attruls).

    Alternatively, set the `NEW_RELIC_ATTRIBUTES_INCLUDE` environment variable in the application's environment.  This environment variable accepts a comma delimited list of attribute names.

    <Callout variant="caution">
      When using the `NEW_RELIC_ATTRIBUTES_INCLUDE` environment variable the default set of includes in the newrelic.config is overwritten.  See [here](#allow-all-headers-enabled) for a detailed list of default includes and excludes.
    </Callout>
  </Collapser>

  <Collapser
    id="agent-attributes-exclude"
    title="exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    If attributes are enabled, the agent will not collect attribute keys specified in this list. To specify multiple attribute keys, specify each individually. You can also use a `*` wildcard character at the end of a key to match multiple attributes (for example, `myApiKey.*`). For more information, see [Attribute rules](/docs/agents/net-agent/attributes/enabling-disabling-attributes#attruls).

    Alternatively, set the `NEW_RELIC_ATTRIBUTES_EXCLUDE` environment variable in the application's environment.  This environment variable accepts a comma delimited list of attribute names.

    <Callout variant="caution">
      When using the `NEW_RELIC_ATTRIBUTES_EXCLUDE` environment variable the default set of excludes in the newrelic.config is overwritten.  See [here](#allow-all-headers-enabled) for a detailed list of default includes and excludes.
    </Callout>
  </Collapser>
</CollapserGroup>

## Feature options [#features]

Use these options to enable, disable, and configure New Relic features. New Relic for .NET allows you to configure the following features:

* [App pools](#include_exclude_apps)
* [Error collection](#error_collector)
* [High security mode](#high_security_mode)
* [Strip exception messages](#strip_exception_messages)
* [Transaction events](#transaction_events)
* [Custom events](#custom_events)
* [Custom parameters](#custom_parameters)
* [Tags/labels](#labels-tags)
* [Browser instrumentation](#browser_monitoring)
* [Slow Queries](#slow_sql)
* [Transaction traces](#transaction_tracer)
* [Datastore tracer](#datastore_tracer)
* [Distributed tracing](#distributed_tracing)
* [Infinite Tracing](#infinite_tracing)
* [Cross application traces](#cross_application_tracer)
* [Span events](#span-events)
* [Capture HTTP Request Headers](#capture_http_request_headers)
* [Application logging](#application_logging)
* [Code level metrics](#code_level_metrics)

### App pools [#include_exclude_apps]

<Callout variant="important">
  This is only applicable to a system's [global config file](#config-options-precedence).
</Callout>

<Callout variant="important">
  This setting only applies when the IIS hosting model is set to in-process.
</Callout>

The `applicationPools` element is a child of the `configuration` element. The `applicationPools` element specifies for the profiler exactly which application pools to instrument and uses the same name as the IIS application pool name. This configuration element is useful when you may need to instrument only a small subset of your app pools. For example, a given server might have several hundred application pools, but only a few of those pools need to be instrumented by the .NET agent.

Here is an example of disabling instrumentation for specific application pools:

```xml
<applicationPools>
  <applicationPool name="<var>Foo</var>" instrument="false"/>
  <applicationPool name="<var>Bar</var>" instrument="false"/>
</applicationPools>
```

Here is an example of disabling instrumentation for all application pools currently executing on the server and enabling instrumentation for specific application pools:

```xml
<applicationPools>
  <defaultBehavior instrument="false"/>
  <applicationPool name="<var>Foo</var>" instrument="true"/>
  <applicationPool name="<var>Bar</var>" instrument="true"/>
</applicationPools>
```

The `applicationPools` element supports the following elements:

<CollapserGroup>
  <Collapser
    id="appPool-defaultBehavior"
    title="defaultBehavior"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defines how the .NET agent will behave on a "global" level for application pools served via IIS. The .NET agent instruments all application pools by default. When `true`, application pools listed under [applicationPool](#appPool-applicationPool) with an `instrument` attribute set to false will not be instrumented.

    Essentially, when set to `false`, the application pool list acts as an allow list. When set to `true`, the application pool list acts as a deny list.
  </Collapser>

  <Collapser
    id="appPool-applicationPool"
    title="applicationPool"
  >
    Defines instrumentation behavior for a specific application pool. The `name` attribute is the name of an application pool. Enable or disable profiling in the `instrument` attribute. Define this application in the `name` attribute.
  </Collapser>
</CollapserGroup>

### Error collection [#error_collector]

The `errorCollector` element is a child of the `configuration` element. `errorCollector` configures error collection, which captures information about uncaught exceptions and sends them to New Relic.

```xml
<errorCollector enabled="true" captureEvents="true" maxEventSamplesStored="100">
  <ignoreClasses>
    <errorClass><var>System.IO.FileNotFoundException</var></errorClass>
    <errorClass><var>System.Threading.ThreadAbortException</var></errorClass>
  </ignoreClasses>
  <ignoreMessages>
    <errorClass name="<var>System.Exception</var>">
       <message><var>Ignore message</var></message>
       <message><var>Ignore too</var></message>
    </errorClass>
  </ignoreMessages>
  <ignoreStatusCodes>
    <code><var>401</var></code>
    <code><var>404</var></code>
  </ignoreStatusCodes>
  <expectedClasses>
    <errorClass><var>System.ArgumentNullException</var></errorClass>
    <errorClass><var>System.ArgumentOutOfRangeException</var></errorClass>
  </expectedClasses>
  <expectedMessages>
    <errorClass name="<var>System.Exception</var>">
       <message><var>Expected message</var></message>
       <message><var>Expected too</var></message>
    </errorClass>
  </expectedMessages>
  <expectedStatusCodes>403,500-505</expectedStatusCodes>
  <attributes enabled="true">
    <exclude><var>myApiKey.*</var></exclude>
    <include><var>myApiKey.foo</var></include>
  </attributes>
</errorCollector>
```

<Callout variant="tip">
  For an overview of error configuration in APM, see [Manage errors in APM](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected).
</Callout>

<Callout variant="important">
  `expectedClasses`, `expectedMessages`, and `expectedStatusCodes` configuration settings require [.NET agent version 8.31.0.0 or higher](/docs/agents/net-agent/installation/update-net-agent).
</Callout>

The `errorCollector` element supports the following elements and attributes:

<CollapserGroup>
  <Collapser
    id="error-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the error collector.
  </Collapser>

  <Collapser
    id="error-captureEvents"
    title="captureEvents"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the capturing of error events.
  </Collapser>

  <Collapser
    id="error-maxEventSamplesStored"
    title="maxEventSamplesStored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `100`
          </td>
        </tr>
      </tbody>
    </table>

    Reservoir limit for error events.
  </Collapser>

  <Collapser
    id="error-ignoreClasses"
    title="ignoreClasses"
  >
    A list of fully qualified class names to be ignored. The maximum number of error class and message combinations that **SHOULD** be reported is 50. If more than 50 are listed, then only the first 50 **SHOULD** be used
  </Collapser>

  <Collapser
    id="error-ignoreMessages"
    title="ignoreMessages"
  >
    An optional map of fully qualified class names to list of strings matching a substring of the message of an error. The maximum number of error class and message combinations that **SHOULD** be reported is 50. If more than 50 are listed, then only the first 50 **SHOULD** be used
  </Collapser>

  <Collapser
    id="error-ignoreErrors"
    title="ignoreErrors (obsolete)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Lists specific exceptions to not report to New Relic. The full name of the exception should be used, such as `System.IO.FileNotFoundException`.
  </Collapser>

  <Collapser
    id="error-ignoreStatusCodes"
    title="ignoreStatusCodes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            (none)
          </td>
        </tr>
      </tbody>
    </table>

    Lists specific HTTP error codes to not report to New Relic. You can use standard integral HTTP error codes, such as just 401, or you may use Microsoft full status codes with decimal points, such as 401.4 or 403.18. The status codes should be equal to or greater than 400.

    <Callout variant="tip">
      Custom errors reported with the agent's [`NoticeError()` API](/docs/agents/net-agent/net-agent-api/noticeerror-net-agent) are still reported to New Relic even if the associated transaction has an HTTP status code configured here.
    </Callout>
  </Collapser>

  <Collapser
    id="error-expectedClasses"
    title="expectedClasses"
  >
    A list of fully qualified class names to be marked as expected. The maximum number of error class and message combinations that **SHOULD** be reported is 50. If more than 50 are listed, then only the first 50 **SHOULD** be used
  </Collapser>

  <Collapser
    id="error-expectedMessages"
    title="expectedMessages"
  >
    An optional map of fully qualified class names to list of strings matching a substring of the message of an error. The maximum number of error class and message combinations that **SHOULD** be reported is 50. If more than 50 are listed, then only the first 50 **SHOULD** be used
  </Collapser>

  <Collapser
    id="error-expectedStatusCodes"
    title="expectedStatusCodes"
  >
    A comma separated list of status codes. The list may include integer ranges, using a single dash (-) and will be inclusive of both the starting and ending integer in the range.
  </Collapser>

  <Collapser
    id="error-attributes"
    title="attributes"
  >
    Use this sub-element to customize your agent attribute settings for error traces. This sub-element uses the same settings as the primary `attributes` element: [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include), and [`exclude`](#agent-attributes-exclude).
  </Collapser>
</CollapserGroup>

### High security mode [#high_security_mode]

The `highSecurity` element is a child of the `configuration` element. To enable [high security mode](/docs/subscriptions/high-security), set this property to `true` and enable the high security property in the New Relic user interface. Enabling high security turns SSL on; request parameters, custom parameters and HTTP request headers are not collected; strip exception messages is enabled; and queries can't be sent to New Relic in their raw form.

<CollapserGroup>
  <Collapser
    id="highsecurity-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable high security mode. Example:

    ```xml
    <highSecurity enabled="true"/>
    ```
  </Collapser>
</CollapserGroup>

### Strip exception messages [#strip_exception_messages]

The `stripExceptionMessages` element is a child of the `configuration` element. To enable strip exception messages, set this property to `true`. By default, this is set to false, which means that the agent sends messages from all exceptions to the New Relic collector. If you enable high security mode, this is automatically changed to true, and the agent strips the messages from exceptions.

<CollapserGroup>
  <Collapser
    id="stripExceptionMessages-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable strip exception messages. Example:

    ```xml
    <stripExceptionMessages enabled="true"/>
    ```
  </Collapser>
</CollapserGroup>

### Transaction events [#transaction_events]

The `transactionEvents` element is a child of the `configuration` element. Use `transactionEvents` to configure transaction events.

```xml
<transactionEvents enabled="true" maximumSamplesStored="10000">
  <attributes enabled="true">
    <exclude><var>myApiKey.*</var></exclude>
    <include><var>myApiKey.foo</var></include>
  </attributes>
</transactionEvents>
```

The `transactionEvents` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="transaction-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the event recorder.
  </Collapser>

  <Collapser
    id="transaction-maximumSamplesStored"
    title="maximumSamplesStored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of sampled transaction events the agent can store in memory at once. This will be the maximum number of transaction events the agent can send per minute.

    Alternatively, set the `MAX_TRANSACTION_SAMPLES_STORED` environment variable in the application's environment.

    ```ini
    MAX_TRANSACTION_SAMPLES_STORED=500
    ```
  </Collapser>

  <Collapser
    id="transaction-attributes"
    title="attributes"
  >
    Use this sub-element to customize your agent attribute settings for transaction events. This sub-element uses the same settings as the primary `attributes` element: [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include), and [`exclude`](#agent-attributes-exclude).

    <Callout variant="tip">
      These attribute settings are specific to `transaction` events. Attribute settings can be applied globally to all event types to [with this configuration setting](/docs/agents/net-agent/configuration/net-agent-configuration#agent-attributes).
    </Callout>

    <Callout variant="caution">
      When distributed tracing and/or Infinite Tracing are enabled, information from transaction events is applied to the root Span Event of the transaction. Consider applying any attribute settings for transaction events to span events and/or apply them as Global Attribute settings.
    </Callout>
  </Collapser>
</CollapserGroup>

### Custom events [#custom_events]

The `customEvents` element is a child of the `configuration` element. Use `customEvents` to configure [custom events](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-new-relic-apm-agents#net-att).

```xml
<customEvents enabled="true" maximumSamplesStored="10000"/>
```

The `customEvents` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="customevents-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the event recorder.
  </Collapser>

  <Collapser
    id="customevents-maximumSamplesStored"
    title="maximumSamplesStored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of sampled custom events the agent can store in memory at once. This will be the maximum number of custom events the agent can send per minute.

    Alternatively, set the `MAX_EVENT_SAMPLES_STORED` environment variable in the application's environment.

    ```ini
    MAX_EVENT_SAMPLES_STORED=500
    ```
  </Collapser>
</CollapserGroup>

### Custom parameters [#custom_parameters]

The `customParameters` element is a child of the `configuration` element. Use `customParameters` to configure [custom parameters](/docs/insights/insights-data-sources/custom-data/add-custom-attributes-apm-data).

```xml
<customParameters enabled="true" />
```

The `customParameters` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="customparameters-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the capture of custom parameters.
  </Collapser>
</CollapserGroup>

### Labels (tags)

The `labels` element is a child of the `configuration` element.

This sets [tag](/docs/new-relic-one/use-new-relic-one/core-concepts/tagging-use-tags-organize-group-what-you-monitor) names and values. The list is a semicolon delimited list of colon-separated name and value pairs. You can also use with the `NEW_RELIC_LABELS` environment variable. Example:

```xml
<labels><var>foo</var>:<var>bar</var>;<var>zip</var>:<var>zap</var></labels>
```

### Browser instrumentation [#browser_monitoring]

The `browserMonitoring` element is a child of the `configuration` element. `browserMonitoring` configures browser monitoring in your .NET application. Browser gives you insight your end users' performance experience. This is accomplished by measuring the time it takes for your users' browsers to download and render your webpages by injecting a small amount of JavaScript code into the header and footer of each page.

```xml
// If you use both the Exclude and Attribute elements
// the Exclude element must be listed first.
<browserMonitoring autoInstrument="true">
  <requestPathsExcluded>
    <path regex="url-regex-1"/>
    <path regex="url-regex-2"/>
    ...
    <path regex="url-regex-n"/>
  </requestPathsExcluded>
  <attributes enabled="true">
    <exclude><var>myApiKey.*</var></exclude>
    <include><var>myApiKey.foo</var></include>
  </attributes>
</browserMonitoring>
```

The `browserMonitoring` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="browsermon-autoInstrument"
    title="autoInstrument"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    By default the agent automatically injects the browser agent JavaScript. To turn off automatic injection, set this attribute to `false`.
  </Collapser>

  <Collapser
    id="browser-attributes"
    title="attributes"
  >
    Use this sub-element to customize your agent attribute settings for [browser monitoring](/docs/browser/new-relic-browser/page-load-timing/instrumentation-page-load-timing). This sub-element uses the same settings as the primary `attributes` element: [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include), and [`exclude`](#agent-attributes-exclude).
  </Collapser>

  <Collapser
    id="browser-path-exclusion"
    title="requestPathsExcluded"
  >
    Use this sub-element to prevent the browser agent from being injected in specific pages. The element is used as follows:

    ```xml
    <requestPathsExcluded>
      <path regex="url-regex-1"/>
      <path regex="url-regex-2"/>
      ...
      <path regex="url-regex-n"/>
    </requestPathsExcluded>
    ```

    The agent will not inject the browser agent into pages whose URL matches one of the specified regular expressions. The regular expression should follow [Microsoft guidelines for the Regex class](https://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex(v=vs.110).aspx).

    It is a reference to the virtual directory of the path in your application and not the full URL of the path you wish to exclude. For example, to exclude the pages in `https://www.mywebsite.com/mywebpages/` you would simply insert `/mywebpages/` as the path regex value.

    The `requestPathsExcluded` element should be used in cases where it is impossible or undesirable to use the [`DisableBrowserMonitoring()`](/docs/agents/net-agent/net-agent-api/disablebrowsermonitoring-net-agent) call. To minimize a possible performance impact try to use as few regular expressions as possible and keep them as simple as possible.
  </Collapser>
</CollapserGroup>

### Slow queries [#slow_sql]

The `slowSql` element is a child of the `configuration` element. `slowSql` configures capturing information about slow query executions, and captures and obfuscates explain plans for these queries.

```xml
<slowSql enabled="true"/>
```

The `slowSql` element supports the following attribute:

<CollapserGroup>
  <Collapser
    id="catracer-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable slow query tracing.
  </Collapser>
</CollapserGroup>

### Transaction traces [#transaction_tracer]

The `transactionTracer` element is a child of the `configuration` element. `transactionTracer` configures [transaction traces](/docs/traces/transaction-traces). Included in the trace is the exact call sequence of the transactions, including any query statements issued.

```xml
<transactionTracer enabled="true"
    transactionThreshold="apdex_f"
    recordSql="obfuscated"
    explainEnabled="true"
    explainThreshold="500"
    maxSegments="3000"
    maxExplainPlans="20">
  <attributes enabled="true">
    <exclude><var>myApiKey.*</var></exclude>
    <include><var>myApiKey.foo</var></include>
  </attributes>
 </transactionTracer>
```

The `transactionTracer` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="tracer-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable [transaction traces](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser
    id="tracer-transactionThreshold"
    title="transactionThreshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>
      </tbody>
    </table>

    Defines the threshold for transaction traces. If a transaction takes longer than the threshold, it is eligible for being traced. See [transaction trace basics](/docs/apm/transactions/transaction-traces/transaction-traces#basics) for more about the rules governing traces.

    The default value is `apdex_f`, which sets the threshold to four times the application's **apdex_t** value. For more information about **apdex_t**, see [Apdex](/docs/site/apdex-measuring-user-satisfaction).

    You can also set the threshold to be a specific time value in milliseconds.
  </Collapser>

  <Collapser
    id="tracer-recordSql"
    title="recordSql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            String
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>
      </tbody>
    </table>

    Select a query tracing policy. Options are `off`, which records nothing; `obfuscated`, which records an obfuscated version of the query; or `raw`, which records the query exactly as it is issued to the database.

    <Callout variant="caution">
      Recording raw queries may capture sensitive information.
    </Callout>
  </Collapser>

  <Collapser
    id="tracer-explainEnabled"
    title="explainEnabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>
    
    When `true`, the agent captures `EXPLAIN` statements for slow queries with durations exceeding `explainThreshold`. Note that enabling this feature can have performance implications because plans are captured for every transaction up to the `maxExplainPlans` value.
  </Collapser>

  <Collapser
    id="tracer-explainThreshold"
    title="explainThreshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            Unit
          </th>

          <td>
            Milliseconds
          </td>
        </tr>
      </tbody>
    </table>

    The agent collects [slow query data](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) for queries that exceed this threshold, along with any available explain plans, as part of transaction traces.
  </Collapser>

  <Collapser
    id="tracer-maxSegments"
    title="maxSegments"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of segments to collect in a transaction trace.
  </Collapser>

  <Collapser
    id="tracer-maxExplainPlans"
    title="maxExplainPlans"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of explain plans to collect per transaction.
  </Collapser>

  <Collapser
    id="tracer-maxStackTrace"
    title="maxStackTrace"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Integer
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    By default `maxStackTrace` is set to 0, which disables stack traces as part of a transaction trace. If this value is set greater than 0, then stack traces will be captured for transaction traces.
  </Collapser>

  <Collapser
    id="tracer-attributes"
    title="attributes"
  >
    Use this sub-element to customize your agent attribute settings for transaction traces. This sub-element uses the same settings as the primary `attributes` element: [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include), and [`exclude`](#agent-attributes-exclude).
  </Collapser>
</CollapserGroup>

### Datastore tracer [#datastore_tracer]

The `datastoreTracer` element is a child of the `configuration` element.

```xml
<datastoreTracer>
  <instanceReporting enabled="true"  />
  <databaseNameReporting enabled="true" />
  <queryParameters enabled="false" />
</datastoreTracer>
```

The `datastoreTracer` element supports the following sub-elements:

<CollapserGroup>
  <Collapser
    id="instance-reporting"
    title="instanceReporting"
  >
    Use this sub-element to enable collection of datastore instance metrics (such as the host and port) for [some database drivers](/docs/agents/net-agent/features/net-agent-instance-level-database-information). These are reported on slow query traces and transaction traces. The default value of attribute `enabled` is `true`.
  </Collapser>

  <Collapser
    id="database-name-reporting"
    title="databaseNameReporting"
  >
    Use this sub-element to enable collection of the database name on slow query traces and transaction traces for [some database drivers](/docs/agents/net-agent/features/net-agent-instance-level-database-information). The default value of attribute `enabled` is `true`.
  </Collapser>

  <Collapser
    id="datastore-tracer-query-parameters"
    title="queryParameters"
  >
    Use this sub-element to enable collection of the SQL query parameters on slow query traces. The default value of attribute `enabled` is `false`.

    <Callout variant="caution">
      * Recording query parameters may capture sensitive information.
      * The `transactionTracer.recordSql` configuration option must be set to `raw` or this option is ignored.
    </Callout>
  </Collapser>
</CollapserGroup>

### Distributed tracing [#distributed_tracing]

The `distributedTracing` element is a child of the `configuration` element.

```xml
<distributedTracing enabled="false"
   excludeNewrelicHeader="false"/>
```

Distributed tracing lets you see the path that a request takes as it travels through a distributed system. It requires [.NET agent version 8.6.45.0 or higher](/docs/agents/net-agent/installation/update-net-agent) and is on by default in .NET agents 9.0.0.0 and higher.

<Callout variant="important">
  Enabling [distributed tracing](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) disables [cross application tracing](#cross_application_tracer), and has other effects on APM features. Before enabling, read the [planning guide](/docs/transition-guide-distributed-tracing).
</Callout>

For more information about setting up distributed tracing, see [Enable distributed tracing for your .NET applications](/docs/apm/agents/net-agent/configuration/distributed-tracing-net-agent).

The `distributedTracing` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="tracer-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Alternatively, enable distributed tracing via the `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED` environment variable in the application's environment.

    ```ini
    NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
    ```
  </Collapser>

  <Collapser
    id="excludeNewrelicHeader"
    title="excludeNewrelicHeader"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    By default, supported versions of the agent utilize both the `newrelic` header and [W3C Trace Context](/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#headers) headers for distributed tracing. The `newrelic` distributed tracing header allows interoperability with older agents that don't support W3C Trace Context headers. Agent versions that support W3C Trace Context headers will prioritize them over `newrelic` headers for distributed tracing.

    If you do not want to utilize the `newrelic` header, setting this to `true` will result in the agent excluding the `newrelic` header and only using W3C Trace Context headers for distributed tracing.
  </Collapser>
</CollapserGroup>

Distributed tracing reports span events. Span event reporting is enabled by default, but [distributed tracing](/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing) must be enabled for spans to be reported. To disable span events, choose one of the following options:

<CollapserGroup>
  <Collapser
    id="span-events-disable-config"
    title="Disable span events via config file"
  >
    Set the `<spanEvents>` element to `false` to disable via the newrelic.config file. This element is a child of the `<configuration>` element.

    ```xml
    <configuration . . . >
      <spanEvents enabled="false" />
    </configuration>
    ```
  </Collapser>

  <Collapser
    id="span-events-disable-env_variable"
    title="Disable span events via environment variable"
  >
    Set the `NEW_RELIC_SPAN_EVENTS_ENABLED` environment variable in the application's environment.

    ```ini
    NEW_RELIC_SPAN_EVENTS_ENABLED=false
    ```
  </Collapser>
</CollapserGroup>

### Infinite Tracing [#infinite_tracing]

[Infinite Tracing](https://newrelic.com/products/edge-infinite-tracing) extends the distributed tracing service by employing a trace observer that is external to the agent. It observes 100% of your application traces across various services and provides actionable data so you can solve issues faster.

To turn on [Infinite Tracing](https://newrelic.com/products/edge-infinite-tracing), make sure you have [.NET agent version 8.30 or higher](/docs/release-notes/agent-release-notes/net-release-notes), and enable distributed tracing. Then add the following additional settings:

```xml
<configuration . . . >
  <distributedTracing enabled="true" />
  <infiniteTracing>
    <trace_observer host="<var>YOUR_TRACE_OBSERVER_HOST</var>" />
  </infiniteTracing>
</configuration>
```

<Callout variant="important">
  Infinite Tracing spans can be limited by the [`transactionTracer.maxSegments`](/docs/apm/agents/net-agent/configuration/net-agent-configuration/#tracer-maxSegments) setting.
</Callout>

The `infiniteTracing` element supports the following elements:

<CollapserGroup>
  <Collapser
    id="trace_observer"
    title="trace_observer"
  >
    The `trace_observer` element identifies an observer host that is independent from the agent. For help getting a valid Infinite Tracing trace observer host entry, see [Find or create a trace observer endpoint](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer "https&#x3A;//docs.newrelic.com/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer").

    The trace observer may be configured using the `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST` environment variable as well.

    <Callout variant="important">
      When configuring the trace observer, you should not supply the protocol as part of the host. For example, use `myhost.infinitetracing.com` instead of `https://myhost.infinitetracing.com`.
    </Callout>
  </Collapser>
</CollapserGroup>
    
### Cross application traces [#cross_application_tracer]

The `crossApplicationTracer` element is a child of the `configuration` element. `crossApplicationTracer` links transaction traces across applications. When linked in a service-oriented architecture, all instrumented applications that communicate with each other via HTTP will now "link" transaction traces with the applications that they call and the applications they are called by. [Cross application tracing](/docs/traces/cross-application-traces) makes it easier to understand the performance relationship between services and applications.
    
<Callout variant="important">
  Cross application tracing has been deprecated as of [v9.0.0 of the agent](docs/release-notes/agent-release-notes/net-release-notes/net-agent-9000/) and disabled by default. To use CAT with v9+ of the agent you must set both `crossApplicationTracer.enabled = true` and `distributedTracing.enabled = false`. Enabling [distributed tracing](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) will disable [cross application tracing](#cross_application_tracer).
</Callout>

```xml
<crossApplicationTracer enabled="true"/>
```

The `crossApplicationTracer` element supports the following attribute:

<CollapserGroup>
  <Collapser
    id="catracer-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable cross application tracing
  </Collapser>
</CollapserGroup>

### Span events

The `spanEvents` element is a child of the `configuration` element. Use `spanEvents` to configure span events.

```xml
<spanEvents enabled="true">
  <attributes enabled="true">
    <exclude><var>myApiKey.*</var></exclude>
    <include><var>myApiKey.foo</var></include>
  </attributes>
</spanEvents>
```

The `spanEvents` element supports the following attributes:

<CollapserGroup>
  <Collapser
    id="span-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable the event recorder.
  </Collapser>

  <Collapser
    id="span-max-samples-stored"
    title="maximumSamplesStored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Int
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            2000
          </td>
        </tr>
      </tbody>
    </table>

    The maximum number of sampled span events the agent can store in memory at a time. This will be the maximum number of span events the agent can send per minute.
    
    This may be configured using the `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED` environment variable as well.

    We do not recommend configuring past 10k. The server will cap data at 10k per-minute.

    <Callout variant="important">
      This configuration option is only available in the .NET Agent v9.0 or higher.
    </Callout>
  </Collapser>

  <Collapser
    id="span-attributes"
    title="attributes"
  >
    Use this sub-element to customize your agent attribute settings for span events. This sub-element uses the same settings as the primary `attributes` element: [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include), and [`exclude`](#agent-attributes-exclude).

    <Callout variant="tip">
      These attribute settings are specific to span events. Attribute settings may be applied globally to all event types to [with this configuration setting](/docs/agents/net-agent/configuration/net-agent-configuration#agent-attributes).
    </Callout>
  </Collapser>
</CollapserGroup>

### Capture HTTP Request Headers [#capture_http_request_headers]

The `allowAllHeaders` element is a child of the `configuration` element. Set this to `true` to allow the .NET Agent to capture all HTTP request headers and apply them to `Span` and `Transaction` events as `request.headers.{http-header-name}` attributes. Set this to `false` to only allow the .NET agent to collect the following HTTP request headers:

```
request.headers.referer
request.headers.accept
request.headers.content-length
request.headers.host
request.headers.user-agent
```

<CollapserGroup>
  <Collapser
    id="allow-all-headers-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable HTTP request headers capture. Example:

    Alternatively, set the `NEW_RELIC_ALLOW_ALL_HEADERS` environment variable in the application's environment.

    ```xml
    <allowAllHeaders enabled="true" />
    <attributes enabled="true">
       <include>request.headers.*</include>
    </attributes>
    ```
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  The `allowAllHeaders` setting is only available in the .NET Agent version 8.40.0+. When using `allowAllHeaders` to capture attributes, the captured request header attributes are still being controlled by the root level and destination level [attributes](/docs/agents/net-agent/configuration/net-agent-configuration/#agent-attributes) settings. Without setting the `request.header.*` in the `include` list under the `attributes` element (see the following), the .NET Agent still filters out all header attributes. The default `newrelic.config` is set to include the `request.header.*`.

  ```xml
  <allowAllHeaders enabled="true" />
  <attributes enabled="true">
    <include>request.headers.*</include>
    ...
  </attributes>
  ```

  The default `newrelic.config` is also set to explicitly exclude the following HTTP request headers to prevent the .NET Agent collecting unwanted data.

  ```xml
  <attributes enabled="true">
    <exclude>request.headers.cookie</exclude>
    <exclude>request.headers.authorization</exclude>
    <exclude>request.headers.proxy-authorization</exclude>
    <exclude>request.headers.x-*</exclude>
  </attributes>
  ```
</Callout>

### Application logging [#application_logging]

<Callout variant="important">
  These configuration options are available only with .NET agent versions 9.7.1 and higher.  The options related to context data (custom attributes) are only available in .NET agent versions 10.4.0 and higher.
</Callout>

The `applicationLogging` element is a child of the `configuration` element. Use `applicationLogging` to configure instrumentation of your application's logging activity.

There are three main sub-features:

1. Metrics: Collect metrics on the total number of log lines written per harvest cycle (`Logging/lines`), as well as the number of log lines written at particular logging levels (for example, `Logging/lines/ERROR`).
2. Log forwarding: When enabled, the agent will capture log data and send it to New Relic.
    * Context data (custom attributes): When enabled, the agent will capture and forward any custom log attributes.  The `include` and `exclude` elements are comma-separated lists of attribute names to include or exclude, following the [same rules](docs/apm/agents/net-agent/attributes/enable-disable-attributes-net/#attruls) as other agent attribute configuration. They're both empty by default, which results in all log context data being captured and forwarded.
3. Local log decoration: When enabled, your existing logs will be decorated with metadata which links logs with other New Relic data, such as errors.

For more details, see [our docs on using .NET agent logs in context](/docs/logs/logs-context/net-configure-logs-context-all).  

```xml
<applicationLogging enabled="true">
  <metrics enabled="true" />
  <forwarding enabled="true" maxSamplesStored="10000">
    <contextData enabled="false" include="" exclude="" />
  </forwarding>
  <localDecorating enabled="false" />
</applicationLogging>
```

These features can also be configured via environment variables:

```ini
NEW_RELIC_APPLICATION_LOGGING_ENABLED=<var>true|false</var>
NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED=<var>true|false</var>
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED=<var>true|false</var>
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_ENABLED=<var>true|false</var>
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_INCLUDE=<var>"myCustomAttribute1, myOtherCustomAttribute*"</var>
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_EXCLUDE=<var>"myCustomAttribute2, myOtherCustomAttributeMoreSpecificName"</var>
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED=<var>10000</var>
NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED=<var>true|false</var>
```

The `applicationLogging` element supports the following attributes and sub-elements:

<CollapserGroup>
  <Collapser
    id="applog-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Boolean
          </td>
        </tr>

        <tr>
          <th>
            Default
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Enable or disable all logging instrumentation features. If `true`, the individual sub-feature configurations take effect.  If `false`, no logging instrumentation features are enabled.
  </Collapser>

  <Collapser
    id="applog-metrics"
    title="metrics"
  >
    Use this sub-element to enable collection of logging metrics (such as `Logging/lines`) for common .NET logging frameworks. The default value of attribute `enabled` is `true`.
  </Collapser>

  <Collapser
    id="applog-forwarding"
    title="Log forwarding"
  >
    Use this sub-element to enable forwarding of your application's logs to New Relic. The default value of attribute `enabled` is `true`.  The default value of attribute `maxSamplesStored` is `10000`.

    Set this to a lower value to reduce the amount of log lines sent (may cause log sampling). Set this to a higher value to send more log lines.

    Each log receives the same priority as its associated transaction. Logs that occur outside of a transaction will receive a random priority. Some logs may not be included because they are limited by `maxSamplesStored`. For example, if logging `maxSamplesStored` is set to 10,000 and transaction 1 has 10,000 log entries, only log entries for transaction 1 will be recorded. If transaction 1 has less than 10,000 logs you receive all logs for transaction 1. If there is still space, you receive all the logs for transaction 2, and so on.

    If after all the logs for sampled transactions are recorded, and they haven't reached the limit in `maxSamplesStored`, then log messages for transaction that were not in our sampling are sent. If there are any left, log messages outside of transactions are recorded.

    <Callout variant="caution">
      If you are already sending your application's logs to New Relic using an existing log forwarding solution, be sure to disable that before enabling log forwarding in the agent, in order to prevent being billed for duplicate log data.
    </Callout>
  </Collapser>

  <Collapser
    id="contextData"
    title="Context data (custom attributes)"
  >
    Use this sub-element, which is a child of the `forwarding` element, to configure the capture and fowarding of logging context data (custom attributes), in agent versions 10.4.0 and higher.

    Set the `enabled` attribute to `true` to enable capture and forwarding of logging context data to New Relic. The default value is `false`.

    The `include` attribute is a comma-separated list of names of attributes to include when context data capture is enabled. The default value is an empty string, which means "include everything."

    The `exclude` attribute is a comma-separated list of names of attributes to exclude when context data capture is enabled. The default value is an empty string, which means "exclude nothing."

    The include and exclude lists follow the [same precedence rules as other agent attributes configuration](docs/apm/agents/net-agent/attributes/enable-disable-attributes-net/#attruls).
  </Collapser>

  <Collapser
    id="localDecorating"
    title="Local log decoration"
  >
    Use this sub-element to enable decoration of your application's logs with New Relic linking metadata. The default value of attribute `enabled` is `false`.  Some additional configuration changes are required for local log decoration, please see [.NET: Configure logs in context](/docs/logs/logs-context/net-configure-logs-context-all#2-decorate) for more information.
  </Collapser>
</CollapserGroup>

### Code level metrics [#code_level_metrics]

The `codeLevelMetrics` element is a child of the `configuration` element. Use `codeLevelMetrics` to enable code level metrics support in CodeStream via additional instrumented method metadata captured as attributes on span events.

For more details, see our documentation for [New Relic CodeStream integration](/docs/apm/agents/net-agent/other-features/net-codestream-integration).

```xml
<codeLevelMetrics enabled="true" />
```

This can also be configured via environment variable:

```ini
NEW_RELIC_CODE_LEVEL_METRICS_ENABLED=<var>true|false</var>
```

## Settings in app.config or web.config [#app-config-settings]

For ASP.NET and .NET Framework console apps you can also configure the following settings in your app's `app.config` or `web.config`, within the outermost element, `<configuration>`:

<CollapserGroup>
  <Collapser
    id="app-cfg-agent-enabled"
    title="Enable and disable the agent"
  >
    ```xml
    <appSettings>
       <add key="NewRelic.AgentEnabled" value="false" />
    </appSettings>
    ```

    <Callout variant="important">
      If the agent is disabled in the local or global `newrelic.config`, the `NewRelic.AgentEnabled` settings in these files will be ignored.
    </Callout>
  </Collapser>

  <Collapser
    id="app-cfg-application-name"
    title="Application name"
  >
    For more information, see [Name your .NET application](/docs/agents/net-agent/installation-configuration/name-your-net-application).

    ```xml
    <appSettings>
      <add key="NewRelic.AppName" value="Descriptive Name" />
    </appSettings>
    ```
  </Collapser>

  <Collapser
    id="app-cfg-license-key"
    title="License key"
  >
    ```xml
    <appSettings>
      <add key="NewRelic.LicenseKey" value="XXXXXXXX" />
    </appSettings>
    ```
  </Collapser>

  <Collapser
    id="app-cfg-location"
    title="Change newrelic.config location"
  >
    Designates an alternative location for the config file outside of the local root of the app or global config location. The location entered must be an absolute path.

    ```xml
    <appSettings>
      <add key="NewRelic.ConfigFile" value="C:\Path-to-alternate-config-dir\newrelic.config" />
    </appSettings>
    ```
  </Collapser>
</CollapserGroup>

## Settings in appsettings.json [#appsettings-json]

For .NET Core apps, you can configure the following settings in `appsettings.json` if the following is true:

* The `appsettings.json` file must be located in the current working directory of the application.
* The application must have the following dependencies:
  * [`Microsoft.Extensions.Configuration`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration)
  * [`Microsoft.Extensions.Configuration.Json`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.Json)
  * [`Microsoft.Extensions.Configuration.EnvironmentVariables`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.EnvironmentVariables)

<CollapserGroup>
  <Collapser
    id="appsettings-json-agent-enabled"
    title="Enable and disable the agent"
  >
    ```json
    {
       "NewRelic.AgentEnabled":"false"
    }
    ```

    <Callout variant="important">
      If the agent is disabled in the local or global `newrelic.config`, the `NewRelic.AgentEnabled` setting in this file will be ignored.
    </Callout>
  </Collapser>

  <Collapser
    id="appsettings-json-application-name"
    title="Application name"
  >
    For more information, see [Name your .NET application](/docs/agents/net-agent/installation-configuration/name-your-net-application).

    ```json
    {
        "NewRelic.AppName": "Descriptive Name"
    }
    ```
  </Collapser>

  <Collapser
    id="appsettings-json-application-license-key"
    title="License key"
  >
    ```json
    {
        "NewRelic.LicenseKey": "XXXXXXXX"
    }
    ```
  </Collapser>

  <Collapser
    id="appsettings-json-location"
    title="Change newrelic.config location"
  >
    Designates an alternative location for the config file outside of the local root of the app or global config location. The location entered must be an absolute path.

    ```json
    {
        "NewRelic.ConfigFile": "C:\Path-to-alternate-config-dir\newrelic.config"
    }
    ```
  </Collapser>
</CollapserGroup>
