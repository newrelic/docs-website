---
title: eBPF agent best practices guide
tags:
    - New Relic solutions
    - Best practices guides
    - eBPF
metaDescription: Best practices to help you find problems faster and deliver a better experience to your customers with New Relic's eBPF solution.
freshnessValidatedDate: never
---

New Relic eBPF agent uses eBPF technology to provide APM functionality in a single agent with zero code instrumentation. This approach empowers platform engineering teams by eliminating the need for coordination with application teams for monitoring deployment.

## When to use eBPF-powered APM [#when-to-use-eapm]

* **Large-scale deployments:** When you have many applications that need monitoring deployed at scale and require "good enough" metrics without the overhead of individual language agents.
* **Unknown or unmodifiable workloads:** When the workload you want to monitor is written in an unknown programming language and/or cannot be modified.
* **Platform engineering efficiency:** When you want to deploy monitoring at scale without coordinating with individual application teams.
* **Linux-focused environments:** When you don't need to monitor Windows platforms, as eBPF works excellently on Linux in both Kubernetes and host environments.
* **No distributed tracing requirement:** When your monitoring needs don't require distributed tracing capabilities.

### eBPF vs traditional APM comparison [#comparison]

Understanding the differences between eBPF-powered APM and traditional APM agents helps you choose the right approach:

<table>
  <thead>
    <tr>
      <th>Functionality</th>
      <th>eBPF agent (eAPM)</th>
      <th>APM agent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Summary</td>
      <td>✅</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Transaction</td>
      <td>✅ (segment linking for Java, Go, Node.js)</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Database operations</td>
      <td>✅</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Service map</td>
      <td>✅</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Distributed tracing</td>
      <td>❌</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Programming language agnostic</td>
      <td>✅</td>
      <td>❌</td>
    </tr>
    <tr>
      <td>Custom instrumentation</td>
      <td>❌</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Auto-discover apps and services continuously</td>
      <td>✅</td>
      <td>❌</td>
    </tr>
    <tr>
      <td>Linux support</td>
      <td>✅</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>Windows support</td>
      <td>❌</td>
      <td>✅</td>
    </tr>
    <tr>
      <td>TCP and DNS telemetry</td>
      <td>✅</td>
      <td>❌</td>
    </tr>
  </tbody>
</table>

### Data source perspective

eBPF-powered APM shifts the monitoring perspective from the application layer to the kernel layer:

<table>
  <thead>
    <tr>
      <th>Feature</th>
      <th>APM language agent</th>
      <th>eBPF-powered APM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Data source</td>
      <td>Application's memory / runtime hooks</td>
      <td>Linux kernel (via eBPF)</td>
    </tr>
    <tr>
      <td>Language dependency</td>
      <td>High (requires specific agent for each language)</td>
      <td>None (operates on kernel's view of process)</td>
    </tr>
    <tr>
      <td>Code modification</td>
      <td>Required</td>
      <td>Not required (observes process from outside)</td>
    </tr>
    <tr>
      <td>Outcome</td>
      <td>Deep insight for known languages</td>
      <td>Great insight for any workload on Linux (C++, Rust, etc.)</td>
    </tr>
  </tbody>
</table>

## Best practices for deployment [#deployment-best-practices]

### 1. Supplement the traditional APM

Use eBPF agent to supplement APM language agents for comprehensive coverage. This gives you full APM coverage with coexistence between eAPM and APM agents, without double data ingestion.

**Recommended approach:**
* **APM language agents:** Use for your most critical applications that require deep-level insights, distributed tracing, or custom instrumentation.
* **eBPF-powered APM:** Use to cover everything else, including uninstrumented services, third-party apps, and for continuously discovering/reporting new services.


### 2. Add network metrics for deeper context

<Callout title="Preview">
We're still working on eBPF network metrics capability, but we'd love for you to try it out!

This feature is currently provided as part of a preview pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/). It is not available to customers subject to HIPAA or FedRAMP regulations.
</Callout>


The eBPF agent can also provide granular network metrics (TCP, DNS, etc.) to give you visibility outside your application's boundary. This capability is complementary and can be used with or without eAPM. For more information, refer to [network-metrics](/docs/ebpf/network-metrics/).

The following deployment options are available:

<table>
  <thead>
    <tr>
      <th>Application metric source</th>
      <th>Network metric source</th>
      <th>Configuration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>APM language agent</td>
      <td>eBPF agent (network metrics only mode)</td>
      <td>Two agents</td>
    </tr>
    <tr>
      <td>eBPF agent (eAPM)</td>
      <td>eBPF agent (same agent)</td>
      <td>Single agent</td>
    </tr>
  </tbody>
</table>

### 3. Create a unified monitoring approach

By following the practices above, you can use the single eBPF agent to handle both infrastructure and application monitoring needs. This unifies your observability, allowing the agent to automatically gather critical application performance data (eAPM) and network metrics (eBPF network metrics) to populate existing dashboards, providing deep context without code changes or restarts.

**Benefits:**
* APM insights that populate New Relic APM UI automatically.
* Network insights from the same agent.


## Implementation recommendations [#implementation-recommendations]

* **Start with eAPM for scale:** If you need to deploy monitoring at scale across many applications and want "good enough" metrics without complex coordination, start with eBPF-powered APM.

* **Add network metrics for complete visibility:** Once eAPM is deployed, consider adding eBPF network metrics to gain visibility beyond application boundaries for comprehensive troubleshooting capabilities.


## Related articles [#related-articles]

<DocTiles>
    <DocTile title="eBPF Kubernetes installation" path="/docs/ebpf/k8s-installation/">Learn how to set up the New Relic eBPF agent for your Kubernetes cluster.</DocTile>
    <DocTile title="eBPF Linux installation" path="/docs/ebpf/linux-installation/">Learn how to set up the New Relic eBPF agent for your Linux host.</DocTile>
    <DocTile title="Troubleshooting eBPF" path="/docs/ebpf/troubleshooting/no-ui-data/">Learn how to troubleshoot issues with the New Relic eBPF agent.</DocTile>
</DocTiles>
