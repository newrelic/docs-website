---
title: New Relic interactive application security testing (IAST)
tags:
  - IAST
  - Exploitable vulnerabilities
metaDescription: Use Vulnerability Management to find exploitable vulnerabilities in your application.
---

import iastSummary from 'images/iast_screenshot-crop_summary.webp'

import iastInstall from 'images/IAST_screenshot-crop_install.webp'

import iastAppVuln from 'images/IAST_screenshot-crop_app-vuln.webp'

import iastAppCoverage from 'images/IAST_screenshot-crop_app-coverage.webp'

import iastVulnDetails from 'images/iast_screenshot-crop_vuln-details.webp'

import iastExploitablesAll from 'images/iast_screenshot-crop_exploitables-all.webp'

import iastCoverageOverview from 'images/iast_screenshot-crop_coverage-overview.webp'

import iastUntestedApps from 'images/iast_screenshot-crop_untested-apps.webp'

import iastEnableIast from 'images/iast_screenshot-crop_enable-iast.webp' 

<Callout title="PREVIEW"> 
    This feature is currently in preview. To celebrate it, we're offering you a 3-month free trial! The IAST free trial starts the moment you accept the pre-release software terms. 

    IAST must only be used in a pre-production environment, ideally in a dedicated security environment.
    
    Use of the IAST agent may generate additional billable APM data ingest.
</Callout>

When your application has exploitable vulnerabilities, it means that someone could take advantage of a misconfiguration to access sensitive information. To help prevent that, install our interactive application security testing (IAST). 

<img
    title="IAST Summary page"
    alt="IAST Summary page"
    src={iastSummary}
/>

<figcaption>
   **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST**.
</figcaption>

IAST helps you:

- Ship code faster with unmatched detection accuracy of security risks
- See and secure every application you build and run
- Find, fix, and verify vulnerabilities for any application
- Reduce the time and cost to eliminate vulnerabilities earlier in the software development lifecycle

You can use IAST to test applications written in the following languages:

- [Java](https://github.com/newrelic/csec-java-agent#support-matrix)
- [Node.js](https://github.com/newrelic/csec-node-agent/#supported--modules)
- [Go](https://github.com/newrelic/csec-go-agent/tree/v0.1.0#support-matrix)

## Test your application [#install]

<Callout variant="important">
  Run IAST with non-production deployments only to avoid exposing vulnerabilities on your production software.

  IAST tests your applications for any exploitable vulnerability by replaying the generated HTTP request with vulnerable payloads.
</Callout>

1. Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST**, and click **Setup IAST with applications**.
2. In the installation window, select the language of your application and complete the steps.
    <img
        title="Install IAST"
        alt="Install IAST"
        src={iastInstall}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Install**.
    </figcaption>

3. After you've installed your application, use the APIs from your application so that New Relic can start looking for exploitable vulnerabilities. You can do so by running your own tests against your APIs.
4. Once you've completed all the steps, click **See your data** to see an overview of your tested applications.

## Manage exploitable vulnerabilities for an application [#app-vuln]

To manage exploitable vulnerabilities for a specific application, do the following:

1. Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**.
2. Under **Tested applications**, search for your application or select it.
3. In the **Application vulnerabilities** tab, see all the exploitable vulnerabilities found in your application. 
    <img
        title="Overview of the exploitable vulnerabilities found in your application."
        alt="Overview of the exploitable vulnerabilities found in your application."
        src={iastAppVuln}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**, and select your application.
    </figcaption>

4. In the **Exploitable vulnerabilities** table, select an exploitable vulnerability to explore details about the vulnerability and understand the specifics of how to address it.
    <img
        title="Exploitable vulnerability details and how to fix it."
        alt="Exploitable vulnerability details and how to fix it."
        src={iastVulnDetails}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**, select your application, and select a vulnerability.
    </figcaption>

5. Additionally, in the **Application coverage** tab in your application window, see how vulnerable each part of your application is. 
    <img
        title="Vulnerability coverage of your application."
        alt="Vulnerability coverage of your application."
        src={iastAppCoverage}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**, select your application and see the **Application coverage** tab.
    </figcaption>

## Manage exploitable vulnerabilities for all your applications [#all-apps-vuln]

To manage all the exploitable vulnerabilities across your application portfolio, do the following:

1. Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Exploitable Vulnerabilities**.
    <img
        title="Overview of the exploitable vulnerabilities found in all your applications."
        alt="Overview of the exploitable vulnerabilities found in all your applications."
        src={iastExploitablesAll}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Exploitable Vulnerabilities**.
    </figcaption>


2. Under **Detected exploitable vulnerabilities**, select an exploitable vulnerability, regardless of the application it belongs to, and explore details about the vulnerability and understand the specifics of how to address it.
    <img
        title="Exploitable vulnerability details and how to fix it."
        alt="Exploitable vulnerability details and how to fix it."
        src={iastVulnDetails}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Exploitable Vulnerabilities**, and select a vulnerability.
    </figcaption>

## Fix untested applications [#untested-apps]

If you have an application in New Relic that hasn't been tested for exploitable vulnerabilities, do the following:

1. Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST**.
2. Under **Protect untested applications**, select the application you want to test or click **See all** to search for it.
3. From the **Untested applications** table, select the application you want to test.
    <img
        title="Untested applications table"
        alt="Untested applications table"
        src={iastUntestedApps}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Protect untested applications > See all**.
    </figcaption>

4. In the **Enable IAST** window, follow the steps to update your application configuration so it can be tested for exploitable vulnerabilities.
    <img
        title="Enable IAST for your untested application"
        alt="Enable IAST for your untested application"
        src={iastEnableIast}
    />

    <figcaption>
        **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Protect untested applications**, and select an application.
    </figcaption>

## See the exploitable vulnerabilities coverage for all your applications [#coverage]

In **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Coverage**, you can see how many of your applications have or haven't been tested for exploitable vulnerabilities, as well as an overview of the health of all your applications.

If you see an application under **Untested applications** that you want to test for exploitable vulnerabilities, click **Set up IAST** to [fix the untested application](#untested-apps).

<img
    title="Coverage for all your applications."
    alt="Coverage for all your applications."
    src={iastCoverageOverview}
/>

<figcaption>
    **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Coverage**.
</figcaption>

## Query all vulnerabilities in an application [#query-vuln]

Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > Query Your Data**, and run the following NRQL query:

```sql
SELECT * FROM Vulnerability WHERE issueType = 'Application Vulnerability' AND appId = {MY_APP_ID} 
```

## Troubleshooting 

<CollapserGroup>
    <Collapser
    id="app-not-in-NR"
    title="I don't see my application in IAST"
    >
    If you don't see your application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications > Tested applications**, it could be due to:
    
    - an incorrect version of the APM agent. Check the version of your APM agent and upgrade it if needed.
    - IAST flags being disabled. Check the security configuration, and make sure that IAST flags are enabled for your security agent.
    - an unexpected error. To see what went wrong, go to the `nr-security-home/logs` directory and find the `[SETP-8]` line in the `LANGUAGE-security-collector-init.log` file.
    - lack of traffic on the application. Generate some traffic to allow IAST to test your application. 
    
    </Collapser>

    <Collapser
    id="agent-working"
    title="I'm not sure the security agent is working"
    >

    <Callout variant="important">
    If you're using [APM's high security mode](/docs/apm/agents/manage-apm-agents/configuration/high-security-mode/), the agent won't work.

    To disable it, you need to contact [New Relic Support](https://support.newrelic.com/s/).
    </Callout>

    When the security agent is working correctly:

    - You see your application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications > Tested applications**.
    - You see coverage for the application in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications**. Select your application and then, the coverage tab.
    - You see the message `Security Agent is now ACTIVE` in the security agent log file `nr-security-home/logs/LANGUAGE-security-collector.log`. Replace `LANGUAGE` in the filename with the one you used.
    - You get the `OK` value for `Service stats -> agentActiveStat` in the latest log file in `nr-security-home/logs/snapshots/`.
    - In the `nr-security-home/logs` directory, search for the `LANGUAGE-security-collector-init.log` file. Replace `LANGUAGE` in the filename with the one you used, and make sure you see these steps:
        - [STEP-1]: The security agent is starting.
        - [STEP-2]: The security agent generates a unique identifier. For web socket connection, you'll see Node auth headers.
        - [STEP-3]: The security agent gathers information about your application.
        - [STEP-4]: The web socket connection to SaaS validator is established successfully.
        - [STEP-5]: The security agent threads are started.
        - [STEP-6]: The application instrumentation is successful.
        - [STEP-7]: The application receives and applies your policies and configuration.
        - [STEP-8]: You see a first event sent for validation, which means the security agent started successfully.

    Here's an excerpt of a security agent log file `LANGUAGE-security-collector-init.log`:

    ```
    Init Log File initiated.
    Init Logger configured successfully with level: INFO and rollover on max size 52428800.
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.api.agent.security.Agent - [STEP-1] => Security agent is starting
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.agent.security.AgentInfo - [STEP-2] => Generating unique identifier: 8a6d79c3-ad67-35d6-b811-17f7515b7f29
    2023-05-26 10:45:02 :  [8] [New Relic RPM Connection Service] INFO : com.newrelic.api.agent.security.Agent - [STEP-3] => Gathering information about the application
    ```
  
    </Collapser>

    <Collapser
    id="IAST-not-working"
    title="I'm not sure IAST is looking for vulnerabilities"
    >
    Currently, IAST shows findings only, so you need to go see if your applications has any vulnerabilities.

    Go to **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Applications > Tested applications**, click on the application and then, click on the **Application coverage** tab to view the application testing efficiency, APIs covered, and methods calls, amongst other data.
    
    </Collapser>

    <Collapser
    id="no-vuln"
    title="I don't see vulnerabilities in IAST"
    >
    If you see your application in New Relic and the security agent successfully started IAST, but you don't see vulnerabilities in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST**, then this could be due to:

    - Your **Application testing efficiency** being low. You can check the level of efficiency in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Coverage**. Add additional test cases to your application to get a higher level of testing efficiency.
    - Your application being secure. In this case, your **Application testing efficiency** in **[one.newrelic.com](https://one.newrelic.com) > All capabilities > IAST > Coverage** is high, but no vulnerabilities are detected.
    - Your web socket connection being broken. Please check the latest log file in your `nr-security-home/logs/snapshots/` folder, and look for the `Service stats -> websocket` line. The expected value is `OK`.
    - Your application's framework or vulnerability category not being supported. See the supported frameworkd for the security agents:
        - [Java](https://github.com/newrelic/csec-java-agent#support-matrix)
        - [Node.js](https://github.com/newrelic/csec-node-agent/#supported--modules)
        - [Go](https://github.com/newrelic/csec-go-agent/tree/v0.1.0#support-matrix)

    If you're still not sure why you don't see vulnerabilities in IAST, share your application's configuration and logs with our [support team](https://support.newrelic.com).

    </Collapser>

    <Collapser
    id="stability-issues"
    title="I'm facing application stability issues"
    >
    It's possible that your application shows high traffic and latency for some time as part of IAST. This should resolve in a few minutes when the IAST test is completed.

    You can also check the snapshot log file in the `nr-security-home/logs/snapshots` folder. The log file shows you the status of the security agent, resource usage, and the last five errors.   

    </Collapser>

    <Collapser
    id="unknown-files"
    title="I see unknown files and directories in my application directory"
    >
    If your application has the functionality to create files and directories as part of serving an HTTP request, IAST will try to test the code path and hence, create such files and directories. The files, that are created by the application code under the influence of incoming HTTP requests, can't be deleted by the agent.

    If you're sure that none of your APIs can create files and directories, share your application's configuration and logs with our [support team](https://support.newrelic.com).

    </Collapser>

    <Collapser
    id="not-responding"
    title="My application isn't responding or crashed"
    >
    As a part of IAST, the security agent sends new requests to the application that increases the load, resulting in an increase of resource utilization. This IAST analysis can also expose uncaught errors or exceptions in your application.

    If the application has crashed due to lack of resources, increase the resources, restart the application, and perform IAST again.

    </Collapser>

    <Collapser
    id="golang-vuln"
    title="No vulnerabilities detected for my Golang application"
    >
    For Golang, make sure that you imported the required instrumentation packages for the libraries and frameworks that your application uses.

    For instance, let's suppose that your application is using this library: [https://github.com/robertkrimen/otto](https://github.com/robertkrimen/otto).

    For this specific library, you need to import the following instrumentation package: [https://github.com/newrelic/csec-go-agent/instrumentation/csec_robertkrimen_otto](https://github.com/newrelic/csec-go-agent/instrumentation/csec_robertkrimen_otto).

    </Collapser>
    
    <Collapser
    id="windows-vuln"
    title="I don't see all the expected vulnerabilities for my Windows application"
    >
    Currently, we don't fully support Windows, so some vulnerabilities won't be detected.

    </Collapser>
</CollapserGroup>
