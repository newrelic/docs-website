---
title: "Configure New Relic ABAP add-on package"
metaDescription: "Configure New Relic ABAP add-on package."
freshnessValidatedDate: never
---

## Menu /NEWR/INSTALL [#menu-newr-install]

1. Log in to the production client of the central monitoring system.
2. Start the data provider setup by accessing the area `menu /NEWR/INSTALL`.
3. Navigate to the **SAP Easy Access root menu** before starting the area menu by typing `/n/NEWR/INSTALL` in the command field.

  <Callout variant="tip">
     If you're unsure whether you are at the **SAP Easy Access root menu**, type in `/n` and press **Enter**.
  </Callout>

After successfully installing the add-on on the central monitoring system:

  - Ensure the installer has proper authorization to perform the configuration.
  - Note the new transaction code introduced by the add-on package, listed in **Transaction Code for NRM4SAP Installation and Configuration**.
  - Add the parameter `/NEWR/*` to the code authorization object(s) in the installer's `profile/role`.

  <Callout variant="tip">
    If this is your first time installing the New Relic ABAP Add-on, complete all the steps described below. If upgrading from a previous version, refer [Upgrade from Previous Version]() to determine which steps are necessary.
  </Callout>

## Install new release and patch [#new-release-and-patch]

  <Callout variant="important">
  Complete the configuration steps before installation if they have not yet been completed.
  </Callout>

<Steps>

  <Step>
    ### Setup HTTP and RFC destinations

    - Use SAP transaction SM59 to set up RFC destinations for each monitored system. This verifies that RFC connections to monitored systems and HTTP connections to New Relic endpoints are configured correctly.
    - See [Create RFC destinations for monitored systems](/docs/sap-solutions/configuration/configure-new-relic-abap-add-on-package/#create-rfc-destinations-for-monitored-systems) and [Set HTTP Destination to New Relic Cloud](/docs/sap-solutions/configuration/configure-new-relic-abap-add-on-package/#http-destination-to-new-relic-cloud)

<CollapserGroup>
  <Collapser
    id="create-rfc-destinations-for-monitored-systems"
    title="Create RFC destinations for each monitored systems"
  > 
    1. Select the **ABAP Connections** and click the **Create** icon to set up a new RFC destination.
    2. Enter the following RFC destination information:
        - **RFC Destination**: Enter the destination name. We recommend to name the RFC destination as `NR_<SYSID>CLNT<CLNT#>`. For example, `NR_SAPSYSCLNT100`.
        - **Connection Type**: Select **3** (ABAP Connection).
        - **Description**: Provide a brief description of the RFC destination.
    3. Click the **Technical Settings** tab and enter the below options:
        - **Target Host**: Enter the fully qualified domain name (FQDN) or IP address of the monitored system.
        - **Instance No.**: Enter the instance number of the monitored system.
        - **Save as**: Choose either Host or IP based on your entry for the **Target Host**.
        - **Gateway Host and Service**: Specify the **Gateway Host** and **Service** if necessary.
      <img
          title="Create RFC destinations for monitored systems"
          alt="A screenshot displaying the how to create RFC destinations for monitored systems"
          src="/images/rfc-destination-1-1.webp"
          width=""
          />
    4. Click on the **Logon & Security** tab.
        - **User**: Enter the user created for this ABAP connection, which is NR4SAPDP.
        - **Password**: Enter the password for the NR4SAPDP user.
    5. Once enterng all the required information, click the **Save** icon.
    6. Test the connection and authorization to ensure that the RFC destination is functioning correctly:
        - **Connection Test**: Select **Utility > Test > Connection Test** or click **Connection Test**.
        - **Authorization Test**: Select **Utility > Test > Authorization Test**.
      <Callout variant="important">
        Ensure that the test results are successful.
      </Callout>
    
  </Collapser>

  <Collapser
    id="http-destination-to-new-relic-cloud"
    title="Set HTTP destination to New Relic cloud"
  >
    Step-by-step guide on how to set up HTTP destinations to New Relic cloud using the SAP transaction `SM59`:

    1. In the SAP GUI, enter the transaction code `SM59` and press **Enter**.
    2. Select **HTTP Connections to External Server** option and click the **Create** option to set up a new HTTP connection.
      <Callout variant="important">
        Ensure to create individual RFC destination for Events, Logs, Metrics, and Traces separately.
      </Callout> 
    3. Enter the following connection details:
        - **RFC Destination:** Enter a name for the endpoint, e.g., `NR_API_EVENT`,`NR_API_LOGS`,`NR_API_METRICS`,`NR_API_TRACES`.   
        - **Connection Type:** Select `G` (HTTP Connections to External Server).
        - **Target Host:** Enter the endpoint host, e.g., `insights-collector.newrelic.com`.
        - **Service No.:** Enter `443` (see [standard port](#standard-ports) for HTTPS).
        - **Path Prefix:** Enter the URL path after the domain, e.g., `/v1/accounts/events`.
    4. If a proxy server is required to connect to the external URL, navigate to the **Technical Settings** tab and enter the following:
          - **Proxy Host:** Enter the proxy server's hostname or IP address.
          - **Service:** Enter the proxy service port.
          - **User:** Enter the proxy user if authentication is needed.
          - **Password:** Enter the proxy password if required.
    5. Check the **Active** radio button for **Security Options** to enable **SSL** for secure communication.
      <img
          title="HTTP destination to New Relic"
          alt="A screenshot displaying the connection setup for HTTP destination to New Relic"
          src="/images/http-destination-to-new-relic.webp"
          width=""
          />
    6. **SSL Certificate Setup (if needed)**
        - If the SSL certificate is not set up yet, download the root certificate from [New Relic](https://one.newrelic.com).
        - Add the certificate to the SAP system using transaction `STRUST`.
    7. Use the **Connection Test** feature to test the connection. If a connection is made, you should see a prompt to **Enter Logon Data**.
    8. Click **Cancel**, an HTTP response code **4xx** is displayed. This indicates that the connection is successful, even though the response code is an error (expected due to lack of authentication).
    9. If the connection test times out, it is likely that the connection is blocked by a firewall. Check with your network team to ensure that access to New Relic domains is open.
  </Collapser>

  <Collapser
    id="standard-ports"
    title="Standard ports"
  >
    ### US Region

    <table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **RFC Destination**
            </th>
            <th>
            **Conn. Type**
            </th>
            <th>
            **Target Host**
            </th>
            <th>
            **Service No.**
            </th>
            <th>
            **Path Prefix**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            NR_API_EVENT
            </td>
            <td>
            G
            </td>
            <td>
            insights-collector.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /v1/accounts/events
            </td>
            <td>
            Event API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_LOG
            </td>
            <td>
            G
            </td>
            <td>
            log-api.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /log/v1
            </td>
            <td>
            Log API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_METRIC
            </td>
            <td>
            G
            </td>
            <td>
            metric-api.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /metric/v1
            </td>
            <td>
            Metric API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_TRACE
            </td>
            <td>
            G
            </td>
            <td>
            trace-api.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /trace/v1
            </td>
            <td>
            Trace API Endpoint
            </td>
        </tr>
    </tbody>
</table>

### EU Region

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **RFC Destination**
            </th>
            <th>
            **Conn. Type**
            </th>
            <th>
            **Target Host**
            </th>
            <th>
            **Service No.**
            </th>
            <th>
            **Path Prefix**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            NR_API_EVENT_EU
            </td>
            <td>
            G
            </td>
            <td>
            insights-collector.eu01.nr-data.net
            </td>
            <td>
            443
            </td>
            <td>
            /v1/accounts/events
            </td>
            <td>
            Event API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_LOG_EU
            </td>
            <td>
            G
            </td>
            <td>
            log-api.eu.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /log/v1
            </td>
            <td>
            Log API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_METRIC
            </td>
            <td>
            G
            </td>
            <td>
            metric-api.eu.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /metric/v1
            </td>
            <td>
            Metric API Endpoint
            </td>
        </tr>
        <tr>
            <td>
            NR_API_TRACE
            </td>
            <td>
            G
            </td>
            <td>
            trace-api.eu.newrelic.com
            </td>
            <td>
            443
            </td>
            <td>
            /trace/v1
            </td>
            <td>
            Trace API Endpoint
            </td>
        </tr>
    </tbody>
</table>
  </Collapser>

  </CollapserGroup>

  <img
      title="Configure New Relic"
      alt="A screenshot displaying the SAP install new release and patch"
      src="/images/configure-newrelic.webp"
      width="500"
  />

  </Step>

  <Step>
    ### Setup Connection to Remote Database
      - This option invokes SAP Transaction **DBACOCKPIT**.
      - It verifies that connections to remote HANA DBs are set up correctly.
      - Create one DB Connection for each remote **HANA** database you want to monitor.
      - See [**Create Database Connection**](/docs/sap-solutions/configuration/configure-new-relic-abap-add-on-package/#create-database-connection) for detailed instructions.

<CollapserGroup>
  <Collapser
    id="create-database-connection"
    title="Create database connection"
  >
    Step-by-step guide on how to define remote HANA DB connections using the SAP transaction `DBACOCKPIT`:

    1. In the left pane, double-click on **Database Connections** to open the section where you can manage database connections.
    2. Click **Add** to create a new database connection.
    3. Enter the database details:
        - **Connection Name:** Enter a name for the connection, preferably the same as the SAP system id for easy identification.
        - **Database System:** Select **HANA Database** from the dropdown menu.
        - **Database User ID:** Enter the user id of your HANA database. It is recommended to use `NRAGENT`.
        - **Password:** Enter the password for the database user id.
        - **Confirm Password:** Re-enter the password to confirm it.
        - **Database Host:** Enter the hostname or IP address of the HANA database server.
        - **SQL Port:** Enter the SQL port number for the HANA database.
      <img
          title="SAP HANA database"
          alt="A screenshot displaying the SAP HANA database installation"
          src="/images/sap-hana-database.webp"
          width="800"
          />
    4. Click **Save**.
    5. To verify the connection, click **Test**. Ensure that the connection test is successful to confirm that the database connection is correctly configured.
  </Collapser>
</CollapserGroup>
  </Step>

  <Step>
    ### Configure connections to New Relic API endpoints [#configure-connections]
    
      Select this option to complete the connection to New Relic API endpoints.

      1. Click **New Entries** to add the following details:
          - **New Relic Account ID**: Specify the <DNT>**New Relic Account ID**</DNT> (optional to prefix it with SAP-)
          - **API Ingest Key**: Enter the API key for the New Relic account.
          - **Metric Endpoint**: Enter the Metric Endpoint for the New Relic account.
          - **Event Endpoint**: Enter the Event Endpoint for the New Relic account.
          - **Log Endpoint**: Enter the Log Endpoint for the New Relic account.
          - **Trace Endpoint**: Enter the Trace Endpoint for the New Relic account.

      <img
          title="New Entry"
          alt="A screenshot displaying the SAP HANA database new entry"
          src="/images/new-entry-1.webp"
          width="1000"
          />
      2. Click **Save**.
      <Callout variant="tip">
        Enter them separately along with the API Ingest Key, also multiple accounts can be configured here.
      </Callout>

  </Step>

  <Step>
    ### Copy Template Tables from Client 000 [#copy-template-tables]
    Execute this option to copy the table from client 000. 

      1. Click the <img src="/images/new-relic-sap-clock.webp" class="inline" style={{height: "20px", width: "20px"}} alt="clock indicator in New Relic" title="Multiple apps name indicator in New Relic" /> icon.
      2. Confirm the successful copy with the success message.
  </Step>

  <Step>
    ### Define the Monitored Systems [#define-monitored-systems]
    Use this option to define the monitored systems.

      1. Click **New Entries** and enter the following details:
          - **SAP System ID**: Enter the SAP system ID.
          - **Client**: Enter the client number.
      2. In the **Data Provider installating information** section, enter the following details:
          - **Destination**: Enter the RFC destination for the SAP system.
          - **Software Component**: Select the SAP software version from the drop-down.
          - **Database Vendor**: Enter the database vendor.
          - **Db Connection Name**: Enter the database connection name. (Currently only supports HANA database)
      3. Click **Monitoring Group**.
      
      <img
          title="New Entry"
          alt="A screenshot displaying the SAP HANA database new entry"
          src="/images/details-of-added-entry.webp"
          width="700"
          />
      4. Click **Yes** on the dialoge box, to specify the **Monitoring Group**.
      4. Select the required monitoring groups for the system, then click <img src="/images/generate.webp" class="inline" style={{height: "25px", width: "50px"}} alt="generate icon in New Relic" title="Multiple apps name indicator in New Relic" /> when completed.

    <CollapserGroup>
      <Collapser
          id="sap-versions"
          title="SAP component versions"
        >
      
      <table>
        <thead>
          <tr>
            <th style={{ width: "200px" }}>
                Monitor Group
              </th>
              <th>
                Included Data Providers
              </th>
              <th>
                Applied to the System Type
              </th>
              <th>
                Special Notes
              </th>
            </tr>
        </thead>
          <tbody>
            <tr>
              <td>
              BIZ_DOC
              </td>
              <td>
              Change document event for business objects
              </td>
              <td>
              ECC systems and S/4 HANA
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              DB_KPI
              </td>
              <td>
              Key Performance Indicators for databases, such as availability, space, etc.
              </td>
              <td>
              All Systems, except HANA Database
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              HANA_DB
              </td>
              <td>
              HANA Database data providers connect directly to the HANA DB
              </td>
              <td>
              All HANA databases
              </td>
              <td>
              Requires Database Connection
              </td>
            </tr>
            <tr>
              <td>
              HOST
              </td>
              <td>
              Host metrics such as CPU, Memory, Disk Usage
              </td>
              <td>
              All ABAP Systems
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              IDOC
              </td>
              <td>
              IDOC events
              </td>
              <td>
              ECC systems and S/4 HANA
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              MAXDB
              </td>
              <td>
              Metrics for MAXDB database
              </td>
              <td>
              Systems with MAXDB
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              MS_SQL
              </td>
              <td>
              Metrics for Microsoft SQL Server database
              </td>
              <td>
              Systems with Microsoft SQL Server
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              Oracle
              </td>
              <td>
              Metrics for Oracle Database
              </td>
              <td>
              Systems with Oracle Database
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              SAP_APPL
              </td>
              <td>
              Events, Logs, Metrics, and Traces for SAP Application Monitoring such as RFCs, Jobs, Transactions, etc.
              </td>
              <td>
              All ABAP Systems
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              SAP_SYSTEM
              </td>
              <td>
              Metrics for SAP System and application server instances, monitoring such as User, System Performances, etc.
              </td>
              <td>
              All ABAP Systems
              </td>
              <td>
              </td>
            </tr>
            <tr>
              <td>
              CUSTOM
              </td>
              <td>
              Any data provider added by the customer
              </td>
              <td>
              </td>
              <td>
              </td>
            </tr>
            </tbody>
        </table>
        </Collapser>
      </CollapserGroup>

    <Callout variant="tip">
      Maintain the list of Monitoring Groups by navigating to **Expert Mode > Installation Setups > Monitoring Group Maintenance**.
      </Callout>
      5. Once entries are saved, click **BACK** or the **F3** key to go to the next step.
  </Step>

  <Step>
    ### Check RFC Destinations [#check-rfc-destinations]
      1. Use this menu option to test the RFC destinations for each of the Monitored Systems and NR API endpoints.
      2. Note that RFC destinations ‘NONE’ are not tested.
  </Step>

  <Step>
    ### Generate Configurations for New Data Providers [#generate-configurations]
      - Use this menu option to generate all the new data providers related to the new release/patch.
      - For a fresh install, all Data Providers (DP) are generated in this step.
      - When executing this option, confirm the release and patch to be installed on the first screen.
      - If the installation release and patch number is empty, it means the configuration has already been generated.
      - If the configuration needs to be re-generated, use the **Re-generate Data Provider Configurations** in the **Maintain Monitored Systems** folder.

      <img
        title="Maintain Monitored Systems"
        alt="A screenshot displaying the SAP maintain monitored systems"
        src="/images/maintain-monitored-systems.webp"
        width="500"
      />
      - Alternatively, use the menu option **Reset Installation Flag (to re-install only)** to reset the installation flag and re-generate the configurations.

  </Step>

  <Step>
    ### Verify Installation Completeness [#verify-installation-completeness]
      1. Click **Verify Installation Completeness** to ensure everything is **OK**.
      2. If any item shows a red light, click on the execution button in the **Action Needed** column.
  </Step>

  <Step>
    ### Configuration Verification
      1. To verify that data providers are correctly configured, select the **Data Provider Registry Maintenance** folder.
      2. Click **Data Provider Registry**, or use transaction `/n/NEWR/REGISTRY`.
      3. Select any **Data Provider Name** and click **Configure** to verify the configuration parameters.
      4. Click the **TestDP** to test the data provider.

  <img
      title="Data Provider Registry"
      alt="A screenshot displaying the SAP data provider registry"
      src="/images/data-provider-registry-1.webp"
      width="1000"
    />

  </Step>

</Steps>