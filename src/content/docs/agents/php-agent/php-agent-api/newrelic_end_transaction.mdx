---
title: newrelic_end_transaction (PHP agent API)
type: apiDoc
shortDescription: Stop instrumenting the current transaction immediately.
tags:
  - Agents
  - PHP agent
  - PHP agent API
metaDescription: New Relic PHP agent API call to stop a transaction immediately. Useful for job queue processing.
---

## Syntax

```
newrelic_end_transaction([bool $ignore])
```

Stop instrumenting the current transaction immediately.

## Requirements

Agent version [3.0.5.95](https://docs.newrelic.com/docs/release-notes/agent-release-notes/php-release-notes/php-agent) or higher.

## Description

Stop instrumenting the current transaction immediately, and send the data to the daemon. This call simulates what the agent normally does when PHP terminates the current transaction. The most common use for this call is to improve instrumentation of command line scripts that handle job queue processing. Call this method at the end of a particular job, and then call [`newrelic_start_transaction()`](/docs/agents/php-agent/php-agent-api/newrelic_start_transaction) when a new task is pulled off the queue.

Normally, when you end a transaction you want the agent to record the associated data. However, you can also discard the data by setting `$ignore` to `true`.

<Callout variant="tip">
  Compare [`newrelic_end_of_transaction()`](/docs/agents/php-agent/php-agent-api/newrelic_end_of_transaction), which stops timing the transaction but continues to instrument it.
</Callout>

## Parameters

<table>
  <thead>
    <tr>
      <th width="25%">
        Parameter
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `$ignore`

        _boolean_
      </td>

      <td>
        Optional. Defaults to `false`.

        If `false` or omitted, data from the transaction **is** recorded by the daemon.

        If `true`, data from the transaction **is** **not** recorded by the daemon.
      </td>
    </tr>
  </tbody>
</table>

## Return values

Returns `true` if the transaction was successfully ended and data was sent to the New Relic daemon.

## Examples

### Stop a transaction, then start another [#stop-and-start]

```
function example() {
    <var>... // queuing logic</var>
    if (extension_loaded('newrelic')) { // Ensure PHP agent is available
        newrelic_end_transaction(); // stop recording the current transaction
        newrelic_start_transaction(ini_get("newrelic.appname")); // start recording a new transaction
    }
    <var>... // more queuing logic</var>
}
```

### Stop instrumenting entirely [#stop-entirely]

```
function example() {
    <var>... // this code is instrumented</var>
    if (extension_loaded('newrelic')) { // Ensure PHP agent is available
        newrelic_end_transaction();
    }
    <var>... // this code is ignored</var>
}
```

## For more help

If you need more help, check out these support and learning resources:

* Suggest a change and learn how to [contribute](https://github.com/newrelic/newrelic-php-agent/issues) to our PHP agent open source repository.
* Browse the [Explorers Hub](https://discuss.newrelic.com/) to get help from the community and join in discussions.
* Find [answers on our sites and learn how to use our support portal](https://docs.newrelic.com/docs/using-new-relic/welcome-new-relic/get-started/find-help-use-support-portal/).
* Run [New Relic Diagnostics](https://docs.newrelic.com/docs/using-new-relic/cross-product-functions/troubleshooting/new-relic-diagnostics/), our troubleshooting tool for Linux, Windows, and macOS.
* Review New Relic's [data security](https://docs.newrelic.com/docs/security/) and [licenses](https://docs.newrelic.com/docs/licenses/) documentation.