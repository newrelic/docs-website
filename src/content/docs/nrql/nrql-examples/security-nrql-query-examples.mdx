---
title: Security data NRQL query examples
tags:
  - Query your data
  - 'NRQL: New Relic Query Language'
  - NRQL query tutorials
  - Security
  - Vulnerability management
  - Security RX
metaDescription: Basic examples of using NRQL to query security data collected by New Relic Security RX, including vulnerability and cloud misconfiguration findings.
freshnessValidatedDate: never
---

You can use NRQL to query the security data collected by [Security RX](/docs/vulnerability-management/), including vulnerabilities and cloud misconfigurations. This data is stored as `SECURITY_FINDING` entities in NRDB and can be queried to answer various security questions. Here are practical examples for monitoring and analyzing your security posture.

## Raw security findings [#raw-security-findings]

How can I see all security findings in my environment?

```sql
FROM Entity
SELECT *
WHERE type = 'SECURITY_FINDING'
```

## Active critical vulnerabilities by entity [#critical-vulnerabilities]

Which entities have the most active critical vulnerabilities?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND status = 'AFFECTED'
 AND severity = 'CRITICAL'
FACET impactedEntity.name
```

## CVE impact analysis [#cve-impact]

Which entities are affected by a specific CVE?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND status = 'AFFECTED'
 AND cve.id = 'CVE-2024-23944'
FACET impactedEntity.name
```

## Security data sources [#security-sources]

What sources are reporting security findings in my environment?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET source
```

## Active exploit detection [#active-exploits]

Which CVEs with known active exploits have been detected in my entities?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND cve.exploitKnown IS true
FACET impactedEntity.name, cve.id
```

## High probability exploits [#high-probability-exploits]

Which CVEs have a high likelihood of being exploited (EPSS > 95th percentile)?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND cve.epssPercentile > '0.95'
FACET cve.id
```

## Vulnerability threshold monitoring [#vulnerability-thresholds]

Which entities exceed security thresholds (more than 5 critical or 10 high-severity vulnerabilities)?

```sql
SELECT impactedEntity FROM (
 SELECT count(*) AS vulnerableCount
 FROM Entity
 WHERE type = 'SECURITY_FINDING' AND severity IN ('CRITICAL', 'HIGH')
 FACET impactedEntity.name AS impactedEntity, severity
)
WHERE (severity = 'HIGH' AND vulnerableCount > 10) OR (severity = 'CRITICAL' AND vulnerableCount > 5)
```

## Cloud misconfiguration overview [#cloud-misconfigurations]

How can I see all cloud misconfigurations?

```sql
FROM Entity
SELECT *
WHERE type = 'SECURITY_FINDING' AND findingType = 'MISCONFIGURATION'
```

## Misconfiguration status summary [#misconfiguration-status]

What's the breakdown of misconfiguration findings by status?

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING' AND findingType = 'MISCONFIGURATION'
FACET status
```

## Top misconfiguration types [#top-misconfigurations]

What are the most common types of active misconfigurations?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND findingType = 'MISCONFIGURATION'
 AND internalState.active = true
FACET misconfiguration.issueTitle
LIMIT 10
```

## Riskiest cloud accounts [#risky-accounts]

Which AWS accounts have the most high/critical severity misconfigurations?

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
 AND findingType = 'MISCONFIGURATION'
 AND internalState.active = true
 AND severity IN ('CRITICAL', 'HIGH')
FACET aparse(additionalInfo, '%"key":"cloudProviderAccountId","values":["*"]%') AS 'AWS Account ID'
LIMIT 10
```

## Resource type analysis [#resource-types]

Which cloud resource types have the most misconfigurations?

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
 AND findingType = 'MISCONFIGURATION'
 AND internalState.active = true
FACET misconfiguration.normalizedResourceType
```

## Critical public exposures [#critical-exposures]

Which resources are both critical severity and publicly exposed?

```sql
FROM Entity
SELECT name, impactedEntity.name, misconfiguration.misconfigurationType
WHERE type = 'SECURITY_FINDING'
 AND findingType = 'MISCONFIGURATION'
 AND internalState.active = true
 AND severity = 'CRITICAL'
 AND misconfiguration.misconfigurationType LIKE 'Effects/Data Exposure'
SINCE 1 day ago
```

## Security findings trends [#security-trends]

How have security findings changed over time?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
 AND status = 'AFFECTED'
FACET severity
TIMESERIES 1 day
SINCE 1 week ago
```

## Remediation status tracking [#remediation-tracking]

What's the remediation status of security findings?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET status, severity
```

## Integration-specific queries [#integration-queries]

How many findings are coming from each security integration?

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET source, findingType
TIMESERIES 1 day
SINCE 1 week ago
```

## What's next

- Learn more about [Security RX](/docs/vulnerability-management/)
- Set up [security integrations](/docs/vulnerability-management/integrations/) to populate your security data
- Create [custom dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/) using these queries
- Configure [alerts](/docs/vulnerability-management/set-up-alerts/) based on security findings