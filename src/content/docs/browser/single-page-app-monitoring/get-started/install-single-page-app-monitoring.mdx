---
title: Install Single Page App monitoring
tags:
  - Browser
  - Single page app monitoring
  - Get started
metaDescription: How to install New Relic's SPA monitoring for your single-page apps or any apps that pull content dynamically.
redirects:
  - /docs/browser/single-page-app-monitoring/get-started/add-apps-single-page-app-monitoring
  - /docs/browser/single-page-app-monitoring/get-started/install-single-page-app-monitoring-new-relic-browser
  - /docs/browser/single-page-app-monitoring/get-started/install-single-page-app-monitoring-browser
freshnessValidatedDate: never
---

Single page app (SPA) monitoring comes with the default [install of the <InlinePopover type="browser" /> agent](/docs/browser/browser-monitoring/installation/install-browser-monitoring-agent/).

## Requirements [#requirements]

You can review [compability and requirements for SPA monitoring here](/docs/browser/new-relic-browser/getting-started/compatibility-requirements-browser-monitoring#spa/).

When you set up your first monitored app in a New Relic account, you must agree to the Terms of Service. By agreeing to the terms, you authorize New Relic to collect hash fragments from URLs. You only need to select the checkbox option once for an account.

## Inject the Browser Agent for Next.js

### App Router (/app/layout.js)
```js
// This file defines the overall layout of all pages in the application.
// The default function exported from this module must return a document with
// `html` and `body` tags. A `head` tag will be ignored.

import Script from 'next/script'
import Link from 'next/link'
import newrelic from 'newrelic'

// Somehow, this ends up including our static stylesheet correctly.
// See https://nextjs.org/docs/app/building-your-application/styling/css-modules#global-styles.
import './style.css'

export default async function RootLayout({ children }) {
  if (newrelic.agent.collector.isConnected() === false) {
    await new Promise((resolve) => {
      newrelic.agent.on("connected", resolve)
    })
  }

  const browserTimingHeader = newrelic.getBrowserTimingHeader({
    hasToRemoveScriptWrapper: true,
    allowTransactionlessInjection: true,
  })

  return (
    <html>
    <body>
    <ul className="navbar">
      <li><a href="/">Home</a></li>
      <li><Link href="/users" key={"users"}>Users</Link></li>
      <li><Link href="/about" key={"about"}>About</Link></li>
    </ul>
    {children}

    <Script
      // We have to set an id for inline scripts.
      // See https://nextjs.org/docs/app/building-your-application/optimizing/scripts#inline-scripts
      id="nr-browser-agent"
      // By setting the strategy to "beforeInteractive" we guarantee that
      // the script will be added to the document's `head` element.
      strategy="beforeInteractive"
      // The body of the script element comes from the async evaluation
      // of `getInitialProps`. We use the special
      // `dangerouslySetInnerHTML` to provide that element body. Since
      // it requires an object with an `__html` property, we pass in an
      // object literal.
      dangerouslySetInnerHTML={{__html: browserTimingHeader}}
    />
    </body>
    </html>
  )
}
```

### Pages Router (/pages/_document.jsx)
```js
// This file provides the overall layout of the site via the `render` method.

import Document, { Html, Head, Main, NextScript } from 'next/document'
import newrelic from 'newrelic'

// In order to inject the browser agent we need to perform an asynchronous
// operation. To do that, we need to extend the `Document` object as
// described in
// https://nextjs.org/docs/pages/building-your-application/routing/custom-document#customizing-renderpage
class RootDocument extends Document {
  static async getInitialProps(context) {
    const initialProps = await Document.getInitialProps(context)

    if (newrelic.agent.collector.isConnected() === false) {
      await new Promise((resolve) => {
        newrelic.agent.on("connected", resolve)
      })
    }

    const browserTimingHeader = newrelic.getBrowserTimingHeader({
      hasToRemoveScriptWrapper: true,
      allowTransactionlessInjection: true,
    })

    return {
      ...initialProps,
      browserTimingHeader,
    }
  }

  render() {
    return (
      <Html>
        <Head>
          <script
            type="text/javascript"
            // The body of the script element comes from the async evaluation
            // of `getInitialProps`. We use the special
            // `dangerouslySetInnerHTML` to provide that element body. Since
            // it requires an object with an `__html` property, we pass in an
            // object literal.
            dangerouslySetInnerHTML={{ __html: this.props.browserTimingHeader }}
          />
          <link rel="stylesheet" href="/style.css" />
        </Head>
        <body>
        <Main />
        <NextScript />
        </body>
      </Html>
    )
  }
}

export default RootDocument
```

## Enable or disable SPA monitoring [#enable-spa]

When you [enable browser monitoring](/docs/browser/browser-monitoring/installation/install-browser-monitoring-agent#enable), SPA monitoring is included by default because it gives access to a range of our most recent features, including distributed tracing. Some older agent installations may need to be upgraded. Read more about [browser agent types](/docs/browser/browser-monitoring/installation/install-browser-monitoring-agent#agent-types).
