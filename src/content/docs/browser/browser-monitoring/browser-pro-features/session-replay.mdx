---
title: "Session replay"
metaDescription: "Play back user interactions to debug faster and improve page performance."
freshnessValidatedDate: 2024-04-01
---

import browserSessionReplayDetails from 'images/browser_screenshot-full_session-replay-details.gif'

import browserTextMaskingExample from 'images/browser_screenshot-full_text-masking-example.webp'

import browserApplicationSettingsPage from 'images/browser_screenshot-full_Application-settings-page.webp'

import browserMaskSettings from 'images/browser_screenshot-full_mask-settings.webp'

import browserSessionReplayAppSettings from 'images/browser_screenshot-full_session-replay-app-settings.webp'

import browserSessionReplayPage from 'images/browser_screenshot-full_Session-replay-page.webp'

import browserErrorsInboxSessionReplay from 'images/browser_screenshot-full_errors-inbox-session-replay.webp'

<Callout variant="important">
Session replay consumption will be billable starting May 8, 2024.
</Callout>

Session replay allows you to play back user interactions on your web app and map other telemetry data to help you understand your user's journeys. Session replay can be used for troubleshooting and improving the end-user experience, such as:

* <DoNotTranslate>**Troubleshooting JavaScript errors**</DoNotTranslate>: Troubleshoot the cause of an error by seeing what the user was doing when the error occurred. For example, if an end user receives an error while trying to complete an ecommerce transaction, you can use session replay to see which steps they took and what data they entered before the error occurred. This can help you quickly identify and fix the root cause of the problem.
* <DoNotTranslate>**Improving the user experience**</DoNotTranslate>: Discover areas of your web app that are causing users frustration. For example, you might see that users are getting lost in your navigation or clicking on buttons that don't do anything.
* <DoNotTranslate>**Identifying issues in key user journeys**</DoNotTranslate>: Identify areas of your web app that are causing performance problems. For example, if session replay reveals the `/cart/checkout` page is experiencing excessive page load time, you'd prioritize fixing this critical user journey.

Here's an example of how a session replay looks:

<img
    title="Session replay details"
    alt="Screenshot of session replay details"
    src={browserSessionReplayDetails}
/>

    <figcaption>
  <DoNotTranslate>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Browser > (select an app) > Session replay**</DoNotTranslate>: Visualize your end-user's experience and correlate issues in their journey with session traces.
</figcaption>

## How session replay works [#how-it-works]

When a user loads your web page, session replay takes a snapshot of the Document Object Model (DOM), which represents the page's structure and visual elements. To ensure accurate styling information, the browser agent accesses your CSS files. The agent then integrates these styles directly into the replay recording, eliminating the need to reference external CSS files during playback. As the user interacts with the page, a library within the browser agent captures any changes made to the DOM. This captured data is then stored securely in New Relic's database. 

Replays store up to:
* 4 hours of a user session
* 30 minutes of inactivity

Replays can be accessed for up to 8 days after the user session and provide a pixel-perfect representation of the user's screen, including any errors encountered.

### User data and security concerns [#data-security]

We take data privacy seriously, so we built session replay with:

* <DoNotTranslate>**Minimal data storage**</DoNotTranslate>: Session replay does not store screenshots or videos. It only records the essential DOM state changes required to recreate the user's experience. This results in a much smaller amount of data being stored.
* <DoNotTranslate>**Robust default privacy settings**</DoNotTranslate>: Session replay includes default privacy settings designed to limit the potential sharing of sensitive customer information. These settings can be further customized to meet specific privacy requirements.

## Impact on app performance [#performance-impact]

Session replay minimizes impact on your app's performance with:

* <DoNotTranslate>**Minimal initial impact**</DoNotTranslate>: Session replay loads asynchronously after full page load, ensuring no interference with early page load performance metrics.
* <DoNotTranslate>**DOM mutation tracking**</DoNotTranslate>: Once loaded, session replay monitors DOM changes and reports them as compressed payloads. The size of these payloads correlates with the complexity of the DOM tree.
* <DoNotTranslate>**Performance optimization techniques**</DoNotTranslate>: Payload size can also increase if the DOM is large. However, session replay uses a number of techniques to reduce payload size, such as:
    * GZIP compression
    * Duplication reduction
    * Strategic payload harvesting: It only sends a large (compressed) payload when the full DOM is captured, which typically only happens when the replay feature is first imported. After that, it will only send small payloads that relate to the user's actions.

## Get started [#get-started]

<Steps>

  <Step>
    ### Enable session replay [#enable-configure-settings]

    1. Go to <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com/all-capabilities) > All Capabilities > Browser**</DoNotTranslate>.
    2. Select your browser app.
    3. In the left-hand menu, click  <DoNotTranslate>**Application settings**</DoNotTranslate>.
    2. On the Application settings page, make sure <DoNotTranslate>**Pro**</DoNotTranslate> or <DoNotTranslate>**Pro + SPA**</DoNotTranslate> browser agent is selected. Session replay is not available for the Lite browser agent.
    3. Toggle ON <DoNotTranslate>**Session tracking**</DoNotTranslate> and <DoNotTranslate>**Session replay**</DoNotTranslate> settings.
    </Step>

  <Step>
    ### Configure sampling rates [#configure-sampling-rates]
    
Set a sampling rate (0%-100%) for the following samples:

    * <DoNotTranslate>**User sessions**</DoNotTranslate> records a random sample of all user sessions.

    * <DoNotTranslate>**Errored session**</DoNotTranslate> records a random sample of all errored sessions. The agent buffers for up to 30 seconds on the client-side, and if errors occur, the session will be recorded. If an error does not occur, the replay is not harvested. 

Here's an example of configuring sampling rates: If you set the session sampling rate to 50% and the error sampling rate to 100%, it means that:

* Half of all user sessions will be recorded.
* All errored sessions will be recorded, even if they're not part of the 50% sample.

  </Step>

    <Step>
    ### Configure privacy settings [#configure-privacy-settings]

    New Relic takes your data privacy seriously. The default setting masks everything by replacing all text with asterisks. 

    Here's an example of how a replay looks with the default privacy settings:

    <img
        title="Example of default privacy settings"
        alt="Example of default privacy settings"
        src={browserTextMaskingExample}
    />

If you need to change the default privacy settings, you can choose specific classes and attributes to mask, block, or ignore:

* <DoNotTranslate>**Mask**</DoNotTranslate> means specific text will be replaced with asterisks (*). For example, you could mask sensitive user input such as login information.



      <CollapserGroup>
      <Collapser
      id="mask-user-data"
      title="How to mask user data"
  >
      If you want to customize exactly what is masked with asterisks, you have a few options:

        * On the <DoNotTranslate>**Application settings**</DoNotTranslate> page, add your own CSS selectors or check the masking boxes. Note that using mask selectors will **not** mask user input, so if you need to hide user input, we recommend using block selectors. 

                <img
                    title="Mask settings"
                    alt="Screenshot of mask settings in the ui"
                    src={browserMaskSettings}
                />
        * Add our CSS class `nr-mask` or attribute `data-nr-mask` to your webpage HTML.
        For example, if you want to mask user-entered email address, add `nr-mask` to your email class attribute in `<div>`:

            ```html
            <div class="email-input nr-mask">
              <input type="email" name="email" placeholder="Enter your email address">
            </div>
            ```

        These options use an asterisk (*) to mask all text in that element, hiding the actual text but revealing the number of characters entered. However, asterisks are not valid numbers, so masking number type-specific fields such as telephone or credit card numbers will result in a blank field in a replay.

  </Collapser>
  </CollapserGroup>

* <DoNotTranslate>**Block**</DoNotTranslate> means content will be replaced with an empty placeholder. For example, if you have text fields for sensitive billing information, you could block the class containing those fields.


          <CollapserGroup>
        <Collapser
        id="block-user-data"
        title="How to block user data"
    >
        If you want to block specific classes or attributes, you have a few options:

          * On the Application settings page, add your CSS selectors in the **Block selectors* field.

                <img
                    title="Block Selectors"
                    alt="Screenshot of session replay settings"
                    src={browserSessionReplayAppSettings}
                />
          *  Manually add our CSS class `nr-block` or attribute `data-nr-block` to your webpage HTML. For example, if you wanted to block irrelevant text and images from session replay, add `nr-block` to `<div class>`:

              ```html
              <html>
              <head>
                <title>Sample image and text</title>
              </head>
              <body>
                <div class="image-text-container nr-block">
                  <img src="https://example.com/image.png" alt="Image description">
                </div>
              </body>
              </html>
              ```
              
            </Collapser>
            </CollapserGroup>

* <DoNotTranslate>**Ignore**</DoNotTranslate> means user input will be ignored entirely. For example, if you want to ignore sensitive information like a user's email address and password, you could ignore the element that contains those fields.



        <CollapserGroup>
        <Collapser
        id="ignore-user-data"
        title="How to ignore user data"
    >
        Add the CSS class `nr-ignore` to the input field’s class name. For example, if you want to ignore sensitive information on a billing page, add `class="nr-ignore"` to `<input type>`:

          ```html
          <div class="sensitive-information">
            <h2>Sensitive Information</h2>
            <p>Credit card number: <input type="number" class="nr-ignore" id="creditCardNumber"></p>
            <p>Expiration date: <input type="number" class="nr-ignore" id="expirationDate"></p>
            <p>CVV code: <input type="number" class="nr-ignore" id="cvvCode"></p>
          </div>
          ```
    </Collapser>
    </CollapserGroup>

<Callout variant="tip">

  Always check with your privacy teams if you decide to customize settings. Exposing user input can expose sensitive data.
</Callout>

  </Step>

      <Step>
    ### (For copy/paste deployed agents) Manually update the JavaScript snippet [#update-snippet]

    If you deployed the browser agent using the copy/paste method, you'll need to copy/paste from the UI again. This is because when you enable session replay, the JavaScript snippet updates to include the new feature flag. 

    To update your agent code:

    1. Go to the <DoNotTranslate>**Application Settings**</DoNotTranslate> page and copy the JavaScript snippet.

        <img
            title="Copy/paste installation method"
            alt="Screenshot of the application settings page."
            src={browserApplicationSettingsPage}
        />

    2. Paste it in your code where the old snippet was.
    3. Deploy your app.

  </Step>



<Step>

### View session replays in New Relic [#view-data]

In the UI, you can find session replays in two places:

  * On the <DoNotTranslate>**Session replay**</DoNotTranslate> page:
        1. Go to <DoNotTranslate>**[one.newrelic.com > All Capabilities](https://one.newrelic.com/all-capabilities) > Browser**</DoNotTranslate>.
        2. Select your browser app.
        3. In the left-hand menu, scroll down and click <DoNotTranslate>**Session replay**</DoNotTranslate>.
        4. Click into each replay to view session details.

        <img
            title="Session replay"
            alt="screenshot of the session replay page in browser"
            src={browserSessionReplayPage}
        />



  * On the <DoNotTranslate>**Errors inbox**</DoNotTranslate> page:
        1. In the left-hand browser menu, click <DoNotTranslate>**Errors**</DoNotTranslate>.
        2. Click on the <DoNotTranslate>**Triage**</DoNotTranslate> and <DoNotTranslate>**Group errors**</DoNotTranslate> pages to see replays attached to errors.

        <img
            title="Replays in errors inbox"
            alt="Screenshot of replays in errors inbox"
            src={browserErrorsInboxSessionReplay}
        />


        <figcaption>
              <DoNotTranslate>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > Browser > Errors (errors inbox)**</DoNotTranslate>: View a replay queued up to 5 seconds before an error occurred to see what the user was doing on the page.
        </figcaption>


</Step>

</Steps>

## (Optional) Manually record session replays [#manual-replays]

You can manually invoke a session to be collected by using these two API methods:

* [`NREM.startSessionReplay`](/docs/browser/new-relic-browser/browser-apis/start/)
* [`NREM.stopSessionReplay`](/docs/browser/new-relic-browser/browser-apis/stop/)

If you use these methods, you'll need to set both sampling rates in application settings to 0%. This is beneficial if you’d like a user to opt in to having user interactions recorded for page performance and observability purposes.  

## Troubleshooting [#troubleshoot]

<CollapserGroup>
<Collapser
    id="Troubleshoot-missing-data"
    title="Not seeing replays in the UI"
>
    ### Problem

Session replay feature is enabled, but you're not seeing any replays.

### Solution

Here are some possible fixes:

* Check your sampling rates. There is sampling for both replays and errors.
* Make sure you have permission to view replays.
* Make sure you're using the Pro or Pro+SPA version of the browser agent. Session replay does not work with the Lite browser agent.
* Make sure your browser agent meets these requirements:
  * Agent version v1.240.0 or greater. We recommend [upgrading to the latest agent version](/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes) as we continue making improvements.
  * Agent type: Pro or Pro+SPA. Session replay does not work with the Lite browser agent.
* In [Errors Inbox](docs/errors-inbox/errors-inbox/), you can use the toggle to show only errors with replays. This will filter your views so that you always see a replay. Replays have a standard retention period of 8 days.
* If you're using the copy/paste deployment method, make sure you [updated your agent code](#update-snippet).
* If you’re using the APM deployment method, you may need to wait a while for session replay to be automatically enabled. If you’re still not seeing data, try restarting the agent.
</Collapser>

<Collapser
    id="troubleshoot-missing-css"
    title="Replays not displaying correctly"
>
    ### Problem

You're seeing replays, but they're not displaying correctly.

This may be because your CSS files are hosted on a separate domain and Cross-Origin Resource Sharing (CORS) security measures are preventing our agent from accessing the CSS files. This can result in incomplete or inaccurate replays, as essential styling information may be missing.

Here's what's happening behind the scenes:

* Session replay works by rebuilding the user's DOM, which includes your website's structure and visual elements. To achieve this, our agent needs to access your CSS files to accurately capture styling information. We then inline these styles directly into the replay recording, eliminating the need to reference the original CSS files during playback.

* If your CSS files are hosted on a separate domain, CORS may prevent our agent from accessing them. The agent attempts to fix the broken CSS. If it cannot, it sends the replay with broken styles along with attributes `hasCrossOriginCSS:true` and `inlinedCrossOriginCSS:false` so the UI knows some styles are broken and we can notify the user watching it with his to fix it. The agent is set up to report:
  * `inlinedAllStylesheets`: if it was successful at inlining or not
  * `invalidStylesheetsDetected`: if stylesheets were detected that could not be read by the agent


This can result in incomplete or inaccurate replays, as essential styling information may be missing.

### Solution

To ensure your CSS files are accessible, add the `crossorigin="anonymous"` attribute to your `<link rel="stylesheet">` elements within your HTML code. This attribute instructs the browser to allow cross-origin access for those specific CSS files, allowing our browser agent to record and integrate the styling information.

Here's an example of adding the `crossorigin="anonymous"` attribute:

```
 <link rel="stylesheet" href="assets.yoursite.com/styles.css" crossorigin="anonymous">
```
</Collapser>
</CollapserGroup>

## Use Nerdgraph to configure replay settings [#nerdgraph-mutation]

You can configure session replay settings using our [NerdGraph API](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/) instead of using the UI. This method is helpful if you need to make bulk changes, such as applying sampling rates to multiple browser entities.

Here's an example mutation and variables to create a new browser application with default settings:

<table>
    <thead>
        <tr>
            <th>
                Mutation
            </th>
            <th>
                Variables
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
                ```graphql
                mutation SessionReplayConfigUpdate($guid: EntityGuid!, $settings: AgentApplicationSettingsUpdateInput!) {
                  agentApplicationSettingsUpdate(guid: $guid, settings: $settings) {
                    browserSettings {
                      sessionReplay {
                        blockSelector
                        errorSamplingRate
                        maskTextSelector
                        enabled
                        collectFonts
                        inlineImages
                        inlineStylesheet
                        samplingRate
                        maskAllInputs
                        maskInputOptions {
                          color
                          date
                          datetimeLocal
                          email
                          month
                          number
                          range
                          search
                          select
                          tel
                          text
                          textArea
                          time
                          url
                          week
                        }
                      }
                    }
                    errors {
                      field
                      errorClass
                      description
                    }
                  }
                }
                ```
            </td>
            <td>
                ```json
                {
                  "sessionReplay": {
                    "enabled": true,
                    "collectFonts": true,
                    "blockSelector": "String",
                    "maskTextSelector": "String",
                    "inlineStylesheet": false,
                    "maskAllInputs": true,
                    "maskInputOptions": {
                      "color": true,
                      "date": true,
                      "textArea": true
                    },
                    "samplingRate": 9.99,
                    "errorSamplingRate": 1.11
                  }
                }
                ```
            </td>
        </tr>
    </tbody>
</table>