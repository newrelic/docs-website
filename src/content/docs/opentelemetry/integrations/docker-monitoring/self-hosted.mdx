---
title: Install Docker OpenTelemetry integration
tags:
  - Integrations
  - OpenTelemetry
  - Docker

metaDescription: "Install OpenTelemetry Collector on Linux hosts to monitor self-hosted Docker containers with comprehensive metrics and logging."
freshnessValidatedDate: never
---

Monitor your Docker containers by installing an OpenTelemetry Collector directly on Linux hosts. This guide provides complete setup instructions for collecting container metrics and optional log collection using either the New Relic NRDOT Collector (recommended) or OpenTelemetry Collector Contrib.

## Before you begin [#prerequisites]

- A [New Relic account](https://newrelic.com/signup) with a <InlinePopover type="licenseKey"/>
- Docker Engine (API version 1.25+) installed and running
- Access to the Docker socket (typically `/var/run/docker.sock`)
- One of the following collectors installed on a Linux host:
  - [NRDOT Collector](https://github.com/newrelic/nrdot-collector-releases) (recommended - New Relic's OpenTelemetry distribution), or
  - [OpenTelemetry Collector Contrib](https://github.com/open-telemetry/opentelemetry-collector-contrib/releases/latest) (alternative option)
- Network access from the Linux host to:
  - Docker Engine socket
  - One of the [New Relic OTLP](https://docs.newrelic.com/docs/opentelemetry/best-practices/opentelemetry-otlp/#configure-endpoint-port-protocol) endpoints
- For log collection: Read permissions to `/var/lib/docker/containers/` directory (typically requires root or docker group membership)

### Verify your setup

<CollapserGroup>
<Collapser
  id="check-docker-version"
  title="Check Docker version and API"
>

```bash
docker version --format '{{.Client.APIVersion}}'
```
Expected output: `1.25` or higher

</Collapser>

<Collapser
  id="check-otelcol"
  title="Check OpenTelemetry Collector"
>

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-version">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-version">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-version">
```bash
nrdot-collector --version
```
Expected output: Version information
    </TabsPageItem>

    <TabsPageItem id="otelcol-version">
```bash
otelcol-contrib --version
```
Expected output: Version information (minimum v0.88.0 recommended)
    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>

<Collapser
  id="test-docker-socket"
  title="Test Docker socket access"
>

```bash
docker info
```
Expected output: Docker system information (confirms socket access)

</Collapser>

<Collapser
  id="test-network-connectivity"
  title="Test network connectivity"
>

```bash
# For US region
curl -I https://otlp.nr-data.net

# For EU region
curl -I https://otlp.eu01.nr-data.net
```
Expected output: HTTP/2 200 response

</Collapser>
</CollapserGroup>

## Integration steps [#integration-steps]

Follow these steps to configure Docker container monitoring with OpenTelemetry.

<CollapserGroup>
<Collapser
  id="install-collector"
  title="Step 1: Install your chosen collector (if not already installed)"
>

Choose one of the following collectors and install it if you haven't already:

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-install">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-install">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-install">
      The NRDOT Collector is New Relic's distribution of OpenTelemetry with pre-configured settings optimized for New Relic.

      Follow the [installation guide](https://github.com/newrelic/nrdot-collector-releases/blob/main/distributions/README.md#installation) in the nrdot-collector-releases repository.
    </TabsPageItem>

    <TabsPageItem id="otelcol-install">
      Download and install the OpenTelemetry Collector Contrib following the [official installation guide](https://github.com/open-telemetry/opentelemetry-collector-contrib/releases/latest).
    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>

<Collapser
  id="configure-collector"
  title="Step 2: Configure the collector for Docker monitoring"
>

Update the `endpoint` value if your Docker socket is at a different location.

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-config">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-config">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-config">
      For NRDOT Collector, create a standalone Docker monitoring configuration file that replaces the default configuration.

<Callout variant="important">
  **Standalone vs. Combined monitoring**: This configuration monitors Docker containers only. If you also need host metrics (CPU, memory, disk) or system logs, use the NRDOT Collector's [default configuration](https://github.com/newrelic/nrdot-collector-releases/blob/main/distributions/nrdot-collector/config.yaml) which includes the `hostmetrics` and `filelog` receivers, and add the `docker_stats` receiver to it.
</Callout>

**Create `/etc/nrdot-collector/docker-stats-config.yaml` with the following content:**

```yaml
extensions:
  health_check:

receivers:
  # Docker Stats Receiver - collects container metrics
  docker_stats:
    endpoint: unix:///var/run/docker.sock
    collection_interval: 15s
    timeout: 5s
    api_version: "1.25"
    # Most metrics required for New Relic UI are enabled by default:
    # CPU: container.cpu.usage.total, container.cpu.utilization
    # Memory: container.memory.usage.total, container.memory.percent
    # Network: container.network.io.usage.tx_bytes, container.network.io.usage.rx_bytes
    #          container.network.io.usage.tx_dropped, container.network.io.usage.rx_dropped
    # Storage: container.blockio.io_service_bytes_recursive
    #
    # The following metrics need to be explicitly enabled:
    metrics:
      # Required for New Relic UI
      container.pids.count:
        enabled: true
      # Additional network error metrics
      container.network.io.usage.tx_errors:
        enabled: true
      container.network.io.usage.rx_errors:
        enabled: true

processors:
  # Batch processor optimizes data transmission
  batch:
    timeout: 10s
    send_batch_size: 1024

  # Attributes processor adds entity type for New Relic correlation
  attributes:
    actions:
      - key: nr.entity_type
        value: CONTAINER
        action: upsert

exporters:
  otlphttp:
    endpoint: ${env:OTEL_EXPORTER_OTLP_ENDPOINT:-https://otlp.nr-data.net}
    headers:
      api-key: ${env:NEW_RELIC_LICENSE_KEY}
    compression: gzip

service:
  pipelines:
    metrics/docker:
      receivers: [docker_stats]
      processors: [batch, attributes]
      exporters: [otlphttp]

  extensions: [health_check]
```

Save the file and ensure the `nrdot-collector` system user can read it:
```bash
sudo chown nrdot-collector:nrdot-collector /etc/nrdot-collector/docker-stats-config.yaml
sudo chmod 644 /etc/nrdot-collector/docker-stats-config.yaml
```
    </TabsPageItem>

    <TabsPageItem id="otelcol-config">
      For OpenTelemetry Collector Contrib, merge the receivers, processors, exporters, and service pipelines into your configuration file (typically `/etc/otelcol-contrib/config.yaml`).

```yaml
receivers:
<DNT>
  # Docker Stats Receiver - collects container metrics
</DNT>
  docker_stats:
    endpoint: unix:///var/run/docker.sock
    collection_interval: 15s
    timeout: 5s
    api_version: "1.25"
    # Most metrics required for New Relic UI are enabled by default:
    # CPU: container.cpu.usage.total, container.cpu.utilization
    # Memory: container.memory.usage.total, container.memory.percent
    # Network: container.network.io.usage.tx_bytes, container.network.io.usage.rx_bytes
    #          container.network.io.usage.tx_dropped, container.network.io.usage.rx_dropped
    # Storage: container.blockio.io_service_bytes_recursive
    #
    # The following metrics need to be explicitly enabled:
    metrics:
      # Required for New Relic UI
      container.pids.count:
        enabled: true
      # Additional network error metrics
      container.network.io.usage.tx_errors:
        enabled: true
      container.network.io.usage.rx_errors:
        enabled: true

processors:
  # Resource detection - adds host metadata
  resourcedetection:
    detectors: [system, docker]
    system:
      resource_attributes:
        host.name:
          enabled: true
        host.id:
          enabled: true
  # Batch processor - optimizes data transmission
  batch:
    timeout: 30s
    send_batch_size: 512

exporters:
  # New Relic OTLP Exporter
  otlphttp/newrelic:
    endpoint: ${env:NEWRELIC_OTLP_ENDPOINT}
    headers:
      api-key: ${env:NEWRELIC_LICENSE_KEY}
    compression: gzip
    timeout: 30s
    retry_on_failure:
      enabled: true
      initial_interval: 5s
      max_interval: 30s
      max_elapsed_time: 300s

service:
  pipelines:
    metrics:
      receivers: [docker_stats]
      processors: [resourcedetection, batch]
      exporters: [otlphttp/newrelic]
```

Save the file and ensure the `otelcol-contrib` system user can read it.
    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>

<Collapser
  id="configure-permissions"
  title="Step 3: Configure Docker socket permissions"
>

The collector needs access to the Docker socket to collect container metrics. Grant the collector user access to the Docker group.

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-permissions">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-permissions">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-permissions">

```bash
# Add nrdot-collector user to docker group
sudo usermod -aG docker nrdot-collector

# Verify the user was added
groups nrdot-collector

# Restart Docker to apply group changes
sudo systemctl restart docker

# Test Docker socket access
sudo -u nrdot-collector docker ps
```

If the test command succeeds and shows your containers, permissions are correctly configured.

    </TabsPageItem>

    <TabsPageItem id="otelcol-permissions">

```bash
# Add otelcol-contrib user to docker group
sudo usermod -aG docker otelcol-contrib

# Verify the user was added
groups otelcol-contrib

# Restart Docker to apply group changes
sudo systemctl restart docker

# Test Docker socket access
sudo -u otelcol-contrib docker ps
```

If the test command succeeds and shows your containers, permissions are correctly configured.

    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>

<Collapser
  id="configure-logs"
  title="Step 4: Optional - Configure log collection"
>

You can also collect logs from your Docker containers using the OpenTelemetry [receiver creator](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator) with the [Docker observer](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer/dockerobserver) extension.

<Callout variant="important">
  **Requirements for log collection:**
  - The collector process must have read permissions to the `/var/lib/docker/containers/` directory. This typically requires running the collector as root or adding the collector user to the docker group.
  - Container ports must be exposed for the receiver creator to discover and scrape logs from containers.
</Callout>

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-logs">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-logs">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-logs">
      For NRDOT Collector, add the log collection configuration to a separate file (e.g., `/etc/nrdot-collector/docker-logs-config.yaml`) or merge it with your existing docker-config.yaml.

```yaml
extensions:
  # Docker observer - discovers running containers
  docker_observer:
    endpoint: unix:///var/run/docker.sock
    use_hostname_if_present: true
    use_container_labels: true

receivers:
  # Receiver creator - dynamically creates filelog receivers for discovered containers
  receiver_creator:
    watch_observers: [docker_observer]
    receivers:
      filelog:
        rule: type == "container"
        config:
          include:
            - /var/lib/docker/containers/`container_id`/`container_id`-json.log
          poll_interval: 200ms
          start_at: end
          include_file_name: false
          include_file_path: false
          operators:
            - id: container-parser
              type: container
              format: docker
              add_metadata_from_filepath: false

processors:
  # Add entity type attribute for logs (required for New Relic entity correlation)
  attributes/logs:
    actions:
      - key: nr.entity_type
        value: CONTAINER
        action: upsert

service:
  extensions: [docker_observer]
  pipelines:
    logs:
      receivers: [receiver_creator]
      processors: [attributes/logs, batch]
      exporters: [otlphttp]
```

If using a separate logs config file, add it to your systemd service with an additional `--config` flag (see Step 4).
    </TabsPageItem>

    <TabsPageItem id="otelcol-logs">
      For OpenTelemetry Collector Contrib, merge the following configuration with your existing config file at `/etc/otelcol-contrib/config.yaml`.

```yaml
extensions:
  # Docker observer - discovers running containers
  docker_observer:
    endpoint: unix:///var/run/docker.sock
    use_hostname_if_present: true
    use_container_labels: true

receivers:
  # Receiver creator - dynamically creates filelog receivers for discovered containers
  receiver_creator:
    watch_observers: [docker_observer]
    receivers:
      filelog:
        rule: type == "container"
        config:
          include:
            - /var/lib/docker/containers/`container_id`/`container_id`-json.log
          poll_interval: 200ms
          start_at: end
          include_file_name: false
          include_file_path: false
          operators:
            - id: container-parser
              type: container
              format: docker
              add_metadata_from_filepath: false

processors:
  # Add entity type attribute for logs (required for New Relic entity correlation)
  attributes/logs:
    actions:
      - key: nr.entity_type
        value: CONTAINER
        action: upsert

service:
  extensions: [docker_observer]
  pipelines:
    logs:
      receivers: [receiver_creator]
      processors: [resourcedetection, attributes/logs, batch]
      exporters: [otlphttp/newrelic]
```
    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>

<Collapser
  id="set-environment-variables"
  title="Step 5: Configure authentication and start the collector"
>

Configure authentication by adding your New Relic <InlinePopover type="licenseKey"/> and OTLP endpoint to the collector service.

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-env">
      NRDOT Collector
    </TabsBarItem>
    <TabsBarItem id="otelcol-env">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-env">
      **NRDOT Collector environment variables:**

      | Variable | Description | Default | Required |
      |----------|-------------|---------|----------|
      | `NEW_RELIC_LICENSE_KEY` | Your New Relic ingest license key | None | Yes |
      | `OTEL_EXPORTER_OTLP_ENDPOINT` | New Relic OTLP endpoint for your region | `https://otlp.nr-data.net` (US) | No |
      | `OTELCOL_OPTIONS` | Additional collector configuration flags | Empty | No |

      **Endpoint configuration:**
      - **US region**: `https://otlp.nr-data.net` (default)
      - **EU region**: `https://otlp.eu01.nr-data.net`

      For more endpoint options, see the [New Relic OTLP documentation](/docs/opentelemetry/best-practices/opentelemetry-otlp/#configure-endpoint-port-protocol).

      **Setup steps:**

      1. Create a systemd override directory:
         ```bash
         sudo mkdir -p /etc/systemd/system/nrdot-collector.service.d
         ```

      2. Create an override configuration to use the Docker stats config. Replace `YOUR_LICENSE_KEY` with your New Relic license key and `YOUR_OTLP_ENDPOINT` with the appropriate endpoint for your region:
         ```bash
         cat <<EOF | sudo tee /etc/systemd/system/nrdot-collector.service.d/override.conf
         [Service]
         Environment="NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY"
         Environment="OTEL_EXPORTER_OTLP_ENDPOINT=YOUR_OTLP_ENDPOINT"
         ExecStart=
         ExecStart=/usr/bin/nrdot-collector --config=/etc/nrdot-collector/docker-stats-config.yaml
         EOF
         ```

      3. Reload systemd and restart the collector:
         ```bash
         sudo systemctl daemon-reload
         sudo systemctl restart nrdot-collector

         # Verify the collector is running
         sudo systemctl status nrdot-collector

         # Check logs for any errors
         journalctl -u nrdot-collector -f
         ```

      <Callout variant="tip">
        The empty `ExecStart=` line clears the default command before setting the new one. This ensures the collector uses only the Docker stats configuration instead of the default configuration.
      </Callout>
    </TabsPageItem>

    <TabsPageItem id="otelcol-env">
      **OpenTelemetry Collector Contrib environment variables:**

      | Variable | Description | Required |
      |----------|-------------|----------|
      | `NEWRELIC_LICENSE_KEY` | Your New Relic ingest license key | Yes |
      | `NEWRELIC_OTLP_ENDPOINT` | New Relic OTLP endpoint for your region | Yes |

      **Endpoint configuration:**
      - **US region**: `https://otlp.nr-data.net:4318`
      - **EU region**: `https://otlp.eu01.nr-data.net:4318`

      For more endpoint options, see the [New Relic OTLP documentation](/docs/opentelemetry/best-practices/opentelemetry-otlp/#configure-endpoint-port-protocol).

      **Setup steps:**

      1. Create a systemd override directory:
         ```bash
         sudo mkdir -p /etc/systemd/system/otelcol-contrib.service.d
         ```

      2. Create `environment.conf` with your configuration. Replace `YOUR_LICENSE_KEY` with your New Relic license key and `YOUR_OTLP_ENDPOINT` with the appropriate endpoint for your region:
         ```bash
         cat <<EOF | sudo tee /etc/systemd/system/otelcol-contrib.service.d/environment.conf
         [Service]
         Environment="NEWRELIC_LICENSE_KEY=YOUR_LICENSE_KEY"
         Environment="NEWRELIC_OTLP_ENDPOINT=YOUR_OTLP_ENDPOINT"
         EOF
         ```

      3. Reload systemd and restart the collector:
         ```bash
         sudo systemctl daemon-reload
         sudo systemctl restart otelcol-contrib

         # Verify the collector is running
         sudo systemctl status otelcol-contrib

         # Check logs for any errors
         journalctl -u otelcol-contrib -f
         ```
    </TabsPageItem>
  </TabsPages>
</Tabs>

</Collapser>
</CollapserGroup>

## View your data in New Relic [#view-data]

Once the integration is complete and the collector is running, you should start seeing data in New Relic within a few minutes:

1. Go to <DNT>**[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > All entities**</DNT>.
2. Search for your Docker host by hostname or container name.
3. Click your entity to view Docker container metrics and details.
4. Explore the **Summary** page to see performance metrics, resource usage, and container health.

The Docker container metrics are attached to the `Metric` [event type](/docs/data-apis/understand-data/new-relic-data-types/). You can [query this data](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) for troubleshooting purposes or to create custom charts and dashboards.

## Troubleshooting [#troubleshooting]

If you encounter issues during setup, see the [Docker monitoring troubleshooting guide](/docs/opentelemetry/integrations/docker-monitoring/troubleshooting) for detailed diagnostic steps and solutions for common problems including:

- Collector startup and configuration issues
- Missing metrics or data connectivity problems
- Permission denied errors
- Performance optimization
- Log collection troubleshooting

## Next steps [#next-steps]

Now that you have Docker container monitoring set up, you can enhance your observability stack:

- **Create custom dashboards**: Build [custom queries and charts](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) using NRQL to analyze container performance patterns
- **Set up alerts**: Create proactive monitoring with [alert conditions](/docs/alerts/create-alert/create-alert-condition/create-nrql-alert-conditions/) for critical container metrics
- **Explore metrics**: Review the complete [Docker metrics reference](/docs/opentelemetry/integrations/docker-monitoring/metrics-reference) for detailed metric descriptions and alerting recommendations
- **OpenTelemetry fundamentals**: Deepen your understanding with [OpenTelemetry in New Relic](/docs/opentelemetry/opentelemetry-introduction/)
- Explore additional Docker OpenTelemetry configuration examples in the [New Relic OpenTelemetry examples repository](https://github.com/newrelic/newrelic-opentelemetry-examples/tree/main/other-examples/collector/docker)
