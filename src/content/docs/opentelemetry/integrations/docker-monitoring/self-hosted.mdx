---
title: Install Docker OpenTelemetry integration
tags:
  - Integrations
  - OpenTelemetry
  - Docker

metaDescription: "Install OpenTelemetry Collector on Linux hosts to monitor self-hosted Docker containers with comprehensive metrics and logging."
freshnessValidatedDate: never
---

Monitor your Docker containers by installing the OpenTelemetry Collector directly on Linux hosts. This guide provides complete setup instructions for collecting container metrics and optional log collection.

## Before you begin [#prerequisites]

Before you begin, ensure you have:

- A [New Relic account](https://newrelic.com/signup) with a <InlinePopover type="licenseKey"/>
- Docker Engine (API version 1.25+) installed and running
- Access to the Docker socket (typically `/var/run/docker.sock`)
- [OpenTelemetry Collector Contrib](https://github.com/open-telemetry/opentelemetry-collector-contrib/releases/latest) installed and running on a Linux host
- Network access from the Linux host to:
  - Docker Engine socket
  - One of the [New Relic OTLP](https://docs.newrelic.com/docs/opentelemetry/best-practices/opentelemetry-otlp/#configure-endpoint-port-protocol) endpoints
- For log collection: Read permissions to `/var/lib/docker/containers/` directory (typically requires root or docker group membership)

### Verify your setup

<CollapserGroup>
<Collapser
  id="check-docker-version"
  title="Check Docker version and API"
>

```bash
docker version --format '{{.Client.APIVersion}}'
```
Expected output: `1.25` or higher

</Collapser>

<Collapser
  id="check-otelcol"
  title="Check OpenTelemetry Collector"
>

```bash
otelcol-contrib --version
```
Expected output: Version information (minimum v0.88.0 recommended)

</Collapser>

<Collapser
  id="test-docker-socket"
  title="Test Docker socket access"
>

```bash
docker info
```
Expected output: Docker system information (confirms socket access)

</Collapser>

<Collapser
  id="test-network-connectivity"
  title="Test network connectivity"
>

```bash
# For US region
curl -I https://otlp.nr-data.net/v1/metrics

# For EU region
curl -I https://otlp.eu.nr-data.net/v1/metrics
```
Expected output: HTTP/2 200 response

</Collapser>
</CollapserGroup>

## Integration Steps [#integration-steps]

Follow these steps to configure Docker container monitoring with OpenTelemetry.

<CollapserGroup>
<Collapser
  id="configure-collector"
  title="Step 1: Configure the OpenTelemetry Collector"
>

Update the `endpoint` value if your Docker socket is at a different location. Merge the receivers, processors, exporters, and service pipelines from the snippet below into your current configuration (typically located at `/etc/otelcol-contrib/config.yaml`).

```yaml
receivers:
  # Docker Stats Receiver - collects container metrics
  docker_stats:
    endpoint: unix:///var/run/docker.sock
    collection_interval: 15s
    timeout: 5s
    api_version: "1.25"
    # Most metrics required for New Relic UI are enabled by default:
    # CPU: container.cpu.usage.total, container.cpu.utilization
    # Memory: container.memory.usage.total, container.memory.percent
    # Network: container.network.io.usage.tx_bytes, container.network.io.usage.rx_bytes
    #          container.network.io.usage.tx_dropped, container.network.io.usage.rx_dropped
    # Storage: container.blockio.io_service_bytes_recursive
    #
    # The following metrics need to be explicitly enabled:
    metrics:
      # Required for New Relic UI
      container.pids.count:
        enabled: true
      # Additional network error metrics
      container.network.io.usage.tx_errors:
        enabled: true
      container.network.io.usage.rx_errors:
        enabled: true

processors:
  # Resource detection - adds host metadata
  resourcedetection:
    detectors: [system, docker]
    system:
      resource_attributes:
        host.name:
          enabled: true
        host.id:
          enabled: true

  # Batch processor - optimizes data transmission
  batch:
    timeout: 30s
    send_batch_size: 512

exporters:
  # New Relic OTLP Exporter
  otlphttp/newrelic:
    endpoint: ${env:NEWRELIC_OTLP_ENDPOINT}
    headers:
      api-key: ${env:NEWRELIC_LICENSE_KEY}
    compression: gzip
    timeout: 30s
    retry_on_failure:
      enabled: true
      initial_interval: 5s
      max_interval: 30s
      max_elapsed_time: 300s

service:
  pipelines:
    metrics:
      receivers: [docker_stats]
      processors: [resourcedetection, batch]
      exporters: [otlphttp/newrelic]
```

Save the file and ensure the `otelcol-contrib` system user can read it.

</Collapser>

<Collapser
  id="configure-logs"
  title="Step 2: Optional - Configure log collection"
>

You can also collect logs from your Docker containers using the OpenTelemetry [receiver creator](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator) with the [Docker observer](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer/dockerobserver) extension.

<Callout variant="important">
  **Requirements for log collection:**
  - The OpenTelemetry Collector process must have read permissions to the `/var/lib/docker/containers/` directory. This typically requires running the collector as root or adding the collector user to the docker group.
  - Container ports must be exposed for the receiver creator to discover and scrape logs from containers.
</Callout>

Add the following configuration to collect container logs:

```yaml
extensions:
  # Docker observer - discovers running containers
  docker_observer:
    endpoint: unix:///var/run/docker.sock
    use_hostname_if_present: true
    use_container_labels: true

receivers:
  # Receiver creator - dynamically creates filelog receivers for discovered containers
  receiver_creator:
    watch_observers: [docker_observer]
    receivers:
      filelog:
        rule: type == "container"
        config:
          include:
            - /var/lib/docker/containers/`container_id`/`container_id`-json.log
          poll_interval: 200ms
          start_at: end
          include_file_name: false
          include_file_path: false
          operators:
            - id: container-parser
              type: container
              format: docker
              add_metadata_from_filepath: false

processors:
  # Add entity type attribute for logs (required for New Relic entity correlation)
  attributes/logs:
    actions:
      - key: nr.entity_type
        value: CONTAINER
        action: upsert

service:
  extensions: [docker_observer]
  pipelines:
    logs:
      receivers: [receiver_creator]
      processors: [resourcedetection, resource/docker, attributes/logs, batch]
      exporters: [otlphttp/newrelic]
```

</Collapser>

<Collapser
  id="set-environment-variables"
  title="Step 3: Set environment variables"
>

Configure your New Relic credentials and endpoint:

```bash
# Set your New Relic license key
export NEWRELIC_LICENSE_KEY="your-license-key-here"

# Set the appropriate OTLP endpoint for your region
# For US region:
export NEWRELIC_OTLP_ENDPOINT="https://otlp.nr-data.net/v1/metrics"
# For EU region:
export NEWRELIC_OTLP_ENDPOINT="https://otlp.eu.nr-data.net/v1/metrics"
```

For persistent configuration, add these to your shell profile or create a systemd environment file:

```bash
# Create environment file for systemd
sudo tee /etc/default/otelcol-contrib <<EOF
NEWRELIC_LICENSE_KEY="your-license-key-here"
NEWRELIC_OTLP_ENDPOINT="https://otlp.nr-data.net/v1/metrics"
EOF
```

Then update your systemd service to use the environment file:
```bash
sudo systemctl edit otelcol-contrib
```

Add the following content:
```ini
[Service]
EnvironmentFile=/etc/default/otelcol-contrib
```

</Collapser>

<Collapser
  id="restart-collector"
  title="Step 4: Restart the collector"
>

Restart the OpenTelemetry Collector to apply the new configuration:

```bash
sudo systemctl restart otelcol-contrib
```

Verify the collector is running:
```bash
sudo systemctl status otelcol-contrib
```

</Collapser>
</CollapserGroup>

## View your data in New Relic [#view-data]

After a few minutes, you should start seeing data in New Relic:

1. Go to **[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > All entities**.
2. Search for your Docker host by hostname or container name.
3. Click your entity to view Docker container metrics and details.
4. Explore the **Summary** page to see performance metrics, resource usage, and container health.

The Docker container metrics are attached to the `Metric` [event type](/docs/data-apis/understand-data/new-relic-data-types/). You can [query this data](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) for troubleshooting purposes or to create custom charts and dashboards.

## Troubleshooting [#troubleshooting]

If you encounter issues during setup, see the [Docker monitoring troubleshooting guide](/docs/opentelemetry/integrations/docker-monitoring/troubleshooting) for detailed diagnostic steps and solutions for common problems including:

- Collector startup and configuration issues
- Missing metrics or data connectivity problems
- Permission denied errors
- Performance optimization
- Log collection troubleshooting

## Next steps [#next-steps]

Now that you have Docker container monitoring set up, you can enhance your observability stack:

- **Create custom dashboards**: Build [custom queries and charts](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) using NRQL to analyze container performance patterns
- **Set up alerts**: Create proactive monitoring with [alert conditions](/docs/alerts/create-alert/create-alert-condition/create-nrql-alert-conditions/) for critical container metrics
- **Explore metrics**: Review the complete [Docker metrics reference](/docs/opentelemetry/integrations/docker-monitoring/metrics-reference) for detailed metric descriptions and alerting recommendations
- **OpenTelemetry fundamentals**: Deepen your understanding with [OpenTelemetry in New Relic](/docs/opentelemetry/opentelemetry-introduction/)