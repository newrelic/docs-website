---
title: Integrate via CloudFormation and CloudWatch metric stream
tags:
    - Integration via CloudFormation
    - AWS metric integration
    - Amazon integrations
    - AWS integrations
    - Integration with CloudWatch Metric Streams via CloudFormation
translate:
metaDescription: Integrate New Relic with AWS services using CloudFormation templates to automate the setup of CloudWatch Metric Streams for metrics ingestion.
redirects:
    - /install/aws-cloudwatch

freshnessValidatedDate: never
---

For seamless integration of your AWS account with New Relic, this is the most recommended integration process. You can utilize API Polling for services not supported by CloudWatch Metric Stream.

## Prerequisites [#prerequisites]

Before you begin integrating your AWS account with New Relic, ensure that you meet the following prerequisites:
* **A New Relic [Ingest - license key and a User key](https://one.newrelic.com/api-keys)**: You'll need these keys to connect your AWS services to your New Relic account.
* **[Permissions](https://docs.aws.amazon.com/ARG/latest/userguide/gettingstarted-prereqs-permissions.html)** to deploy new AWS resources and **[IAM roles](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html)**: You’ll need this permission for your AWS account.
* **[Permissions](/docs/accounts/accounts-billing/new-relic-one-user-management/user-permissions/#infrastructure)** for cloud integrations: You’ll need these permissions for your New Relic account.

## Integration steps [#integration-steps]

To integrate your AWS account with New Relic using CloudFormation and CloudWatch Metric Streams, follow these steps:

1. Navigate to [<DNT>**Infrastructure > AWS**</DNT>](https://one.newrelic.com/infra/infrastructure/cloud-aws).
2. Select the correct account.
3. Click <DNT>**Set up integration**</DNT>.
4. Follow the instructions on each screen, and fill in the fields that apply to you. For this integration, choose the following options in the given screens:

    1. <DNT>**Choose Data type(s)**</DNT>: <DNT>Metrics</DNT>
    2. <DNT>**Choose a setup method**</DNT>: <DNT>Automate AWS with CloudFormation (Recommended)</DNT>
    3. <DNT>**Choose a metrics integration type**</DNT>: <DNT>CloudWatch Metric Stream (Recommended)</DNT>

5. If you are using any of the services that are not supported in CloudWatch Metric Stream, on the <DNT>**Choose a metrics integration type**</DNT> page, select <DNT>**Yes**</DNT> in the third step for API polling and continue.

        <img
            title="AWS Integration with CWMS and API Polling"
            alt="AWS Integration with CWMS and API Polling"
            src="/images/aws-integration-cf-apipolling.webp"
        />
        <figcaption>
        CWMS integration of AWS services with API polling selected for unsupported services.
        </figcaption>

        Do the necessary setup as guided on the <DNT>**Enable API Polling (optional)**</DNT> page and continue.

7. <DNT>Auto-discovery</DNT> automatically detects and visualizes the relationships between your AWS entities on maps and leverages a few other flexibilities. For more details, refer to [Auto-discovery of AWS entities](/docs/infrastructure/amazon-integrations/connect/set-up-auto-discovery-of-aws-entities/). If you want this feature, enable it on the <DNT>**Enable Auto Discovery (optional)**</DNT> page, and continue.
8. Click <DNT>**Launch your CloudFormation in AWS**</DNT>. The CloudFormation template opens in your AWS console with the configured parameters based on your selections in New Relic, so no additional editing is necessary unless you want to make changes.
9. Paste the Ingest - License key and the User key into your AWS console.

<Callout variant="tip">
    To get additional metadata from your AWS services, enable <DNT>**AWS Config**</DNT> from the AWS console.
  </Callout>

10. To deploy the CloudFormation stack, in the AWS console, select <DNT>**Create stack**</DNT>. Creating the stack resources may take several minutes and may generate multiple stacks, depending on how you configure metrics forwarding. If stack creation fails, refer to the [troubleshooting procedure](https://docs.newrelic.com/docs/logs/troubleshooting/aws-log-integration-issues/stack-creation-fails/).

11. After a successful stack creation, switch to the New Relic platform and continue with the guided integration till you see your AWS data in New Relic.

## Related topics [#related-topics]

<DocTiles>
  <DocTile title="Collect data from multiple AWS accounts" path="/docs/infrastructure/amazon-integrations/manage-aws-data/aws-multi-account/" >Learn how to collect data from multiple AWS accounts.</DocTile>
  <DocTile title="AWS integrations metrics" path="/docs/infrastructure/amazon-integrations/manage-aws-data/aws-integrations-metrics/" >Explore and use metrics from CloudWatch Metric Stream.</DocTile>
  <DocTile title="AWS integrations via CloudFormation and API Polling" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/via-cloudformation-and-api-polling" >Integrate AWS services with New Relic using CloudFormation and API Polling.</DocTile>
  <DocTile title="AWS integrations via Terraform" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/terraform" >Integrate AWS services with New Relic using Terraform.</DocTile>
  <DocTile title="Manual integrations from AWS console" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/manual" >Manually integrate AWS services with New Relic from AWS console.</DocTile>
</DocTiles>




