---
title: 'Install, update, or uninstall your Prometheus OpenMetrics integration'
tags:
  - Integrations
  - Prometheus integrations
  - Install and configure OpenMetrics
metaDescription: 'How to install, update, or uninstall your Prometheus OpenMetrics integration with New Relic for your Docker or Kubernetes environment.'
redirects:
  - /docs/integrations/prometheus-integrations/install-configure-openmetrics/install-update-or-uninstall-your-prometheus-openmetrics-integration
  - /docs/integrations/prometheus-integrations/get-started/install-your-prometheus-openmetrics-integration
  - /docs/integrations/prometheus-integrations/get-started/install-update-or-uninstall-your-prometheus-openmetrics-integration
  - /docs/integrations/prometheus-integrations/install-configure/install-update-or-uninstall-your-prometheus-openmetrics-integration
---

Before you install New Relic's Prometheus OpenMetrics integration, [review the requirements](/docs/integrations/prometheus-integrations/get-started/monitor-prometheus-new-relic#OpenMetrics-Compatibility).

## Install in Kubernetes [#kubernetes]

We encourage you to use our automated installer for servers, VMs, and unprivileged environments which also covers the configuration of the monitorization of Kubernetes clusters.

You can find the documentation of how to install Kubernetes integration (which includes the feature flag for Prometheus OpenMetric's integration) here: [Kubernetes integration: install and configure](/docs/kubernetes-pixie/kubernetes-integration/installation/kubernetes-integration-install-configure)

Alternatively, we also offer fully manual instructions for [deploying our integration using Helm](/docs/kubernetes-pixie/kubernetes-integration/installation/install-kubernetes-integration-using-helm).

By default, the New Relic Prometheus OpenMetrics integration uses the same labels as Prometheus to discover targets. For more information, see the [metrics filtering](/docs/integrations/prometheus-integrations/configure/filter-prometheus-metrics) documentation.

Confirm that the integration has been configured correctly: Wait a few minutes, then go to the New Relic UI, and run this NRQL query to see if data has been reported:

```
FROM Metric SELECT count(*) WHERE clusterName = '<var>YOUR_CLUSTER_NAME</var>' since 1 hour ago
```

## Docker [#docker]

### Install [#docker-install]

To install the New Relic Prometheus OpenMetrics integration in a Docker environment:

1. Create a configuration file `config.yaml`. Use the [example configuration file](/docs/integrations/prometheus-integrations/install-configure/configure-prometheus-openmetrics-integration#example-configuration-file), or look at the [`nri-prometheus-latest.yaml`](https://download.newrelic.com/infrastructure_agent/integrations/kubernetes/nri-prometheus-latest.yaml) manifest file, which includes the `nri-prometheus-cfg` config map and an example configuration.

* **Required:** Add your [New Relic license key](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key) and a cluster name to identify your Docker container.
* Add the endpoints to scrape; for example, add the `http://localhost:8080/metrics` endpoint to collect metrics about the integration itself.
* Specify which metrics you want to ignore or include according to the prefixes for the metrics and labels. For more information, see the [metrics filtering](/docs/integrations/prometheus-integrations/configure/filter-prometheus-metrics) documentation.

2. Start the integration in the background:

   ```
   docker run -d --restart unless-stopped \
       --name nri-prometheus \
       -e LICENSE_KEY="<var>YOUR_LICENSE_KEY</var>" \
       -v "$(pwd)/config.yaml:/config.yaml" \
       newrelic/nri-prometheus:1.5
   ```

3. Confirm the container is running properly:

   ```
   docker ps -f "name=nri-prometheus"
   ```

4. Confirm that the integration has been configured correctly: Wait a few minutes, then go to the New Relic UI, and run this NRQL query to see if data has been reported:

   ```
   FROM Metric SELECT count(*) WHERE clusterName = '<var>YOUR_CLUSTER_NAME</var>' since 1 hour ago
   ```

 ## Linux [#linux]

 ### Install [#linux-install]

To install the New Relic Prometheus OpenMetrics integration on a Linux operating system:

1. Install the [infrastructure monitoring agent for Linux](/docs/infrastructure/install-configure-manage-infrastructure/linux-installation/install-infrastructure-linux-using-package-manager).

2. Once you've installed the infrastructure agent, go to this folder in your machine: `/var/db/newrelic-infra/newrelic-integrations/bin`. You should see a `nri-prometheus` file inside.

<Callout variant="important">
  If you don't see the `nri-prometheus` file, follow the [manual installation steps](#manual-install-linux).
</Callout>

3. Create a configuration file with the name `nri-prometheus-config.yml`, in `/etc/newrelic-infra/integrations.d` by running the following command:

```shell
touch /etc/newrelic-infra/integrations.d/nri-prometheus-config.yml
```

<Callout variant="tip">
Your configuration file must match the [nri-prometheus configuration file template](https://github.com/newrelic/nri-prometheus/blob/main/configs/nri-prometheus-config.yml.sample).
 Also, make sure to update your prometheus formatted metric URLs in the `targets > urls` section of the configuration file, so the infrastructure agent can send those metrics to New Relic.
</Callout>

4. [Restart the infrastructure agent](/docs/infrastructure/install-infrastructure-agent/manage-your-agent/start-stop-restart-infrastructure-agent/).

5. To make sure that the integration has been configured correctly, go to **[one.newrelic.com](https://one.newrelic.com)** and run this NRQL query:

```sql
FROM Metric SELECT count(*) WHERE clusterName = 'YOUR_CLUSTER_NAME' since 1 hour ago
```

#### Manual installation of nri-prometheus [#manual-install-linux]

Choose one of the following options according to your needs and preferences:

<CollapserGroup>
  <Collapser
    id="OpenMetrics-Linux-install-from-source"
    title="Using the nri-prometheus compressed file"
  >
    1. Download the latest release of file name ending with (tar.gz) from [newrelic's nri-prometheus github repository](https://github.com/newrelic/nri-prometheus/releases).
    2. Extract the downloaded file.
    3. Open the extracted directory and navigate to the following path to find `nri-prometheus` file by running:
    
    ```shell
    cd /<extracted_directory>/var/db/newrelic-infra/newrelic-integrations/bin
    ```
    
    4. Place the `nri-prometheus` file in the `/var/db/newrelic-infra/newrelic-integrations/bin` directory.
  </Collapser>
  <Collapser
    id="OpenMetrics-Linux-install-host-integration"
    title="Using host integration"
  >
    Follow the instructions for [installing the infrastructure on-host integration](/docs/infrastructure/host-integrations/installation/install-infrastructure-host-integrations/) using the `INTEGRATION_FILE_NAME = nri-prometheus`.
  </Collapser>
</CollapserGroup>

<InstallFeedback />

### Update the integration [#docker-update]

To update the Prometheus OpenMetrics integration, follow the procedures for Docker or Kubernetes as applicable:

1. Remove the Docker container.
2. Follow [standard installation procedures](#docker-install) to start a new Docker container.

The integration logs its current version when it starts up. To determine the running version:

```
docker logs nri-prometheus 2>&1 | grep "Integration version"
```

Example output:

```
time="2019-02-26T09:21:21Z" level=info msg="Starting New Relic's Prometheus OpenMetrics Integration version <var>1.0.0</var>"
```

### Uninstall [#docker-uninstall]

To uninstall the Prometheus OpenMetrics integration for Docker or Kubernetes, execute the following command:

```
docker rm -f nri-prometheus
```
