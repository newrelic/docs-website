---
title: PostgreSQL integration's configuration settings
tags:
  - Integrations
  - On-host integrations
  - Advanced configuration
translate:
  - kr
metaDescription: New Relic's PostgreSQL monitoring integration's advanced configuration
---

This integration is open source software. That means you can [browse its source code](https://github.com/newrelic/nri-postgresql) and send improvements, or create your own fork and build it.

### PostgreSQL instance settings [#instance-settings]

The PostgreSQL integration collects both Metrics (**M**) and Inventory (**I**) information. The **Applies To** column in the following table indicates which settings can be used for each specific collection:

<table>
  <thead>
    <tr>
      <th>
        Setting
      </th>

      <th>
        Description
      </th>

      <th style={{ width: '150px' }}>
        Applies To
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `HOSTNAME`
      </td>

      <td>
        The hostname for the PostgreSQL connection. Default is localhost.
      </td>

      <td style={{ "text-align": "center" }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `PORT`
      </td>

      <td>
        The port where PostgreSQL is running. Default is 5432.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `USERNAME`
      </td>

      <td>
        The user name for the PostgreSQL connection. **Required.**
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `PASSWORD`
      </td>

      <td>
        The password for the PostgreSQL connection. **Required.**
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `COLLECTION_LIST`
      </td>

      <td>
        JSON array, a JSON object, or the string literal `ALL` that specifies the entities to be collected. The PostgreSQL user can only collect table and index metrics from tables it has `SELECT` permissions for.

        **Required except for `PgBouncer`.**

        [Examples](/docs/infrastructure/host-integrations/host-integrations-list/postgresql/postgresql-integration#examples)
      </td>

      <td style={{ "text-align": "center" }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `COLLECTION_IGNORE_DATABASE_LIST`
      </td>

      <td>
        JSON array of database names that will be ignored for metrics collection. Typically useful for cases where `COLLECTION_LIST` is set to `ALL` and some databases need to be ignored. Default is `[]`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `PGBOUNCER`
      </td>

      <td>
        Collect `pgbouncer` metrics. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `ENABLE_SSL`
      </td>

      <td>
        Determines if SSL is enabled. If `true`, `ssl_cert_location` and `ssl_key_location` are required. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `TRUST_SERVER_CERTIFICATE`
      </td>

      <td>
        If `true`, the server certificate is not verified for SSL. If `false`, the server certificate identified in `ssl_root_cert_location` is verified. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `SSL_ROOT_CERT_LOCATION`
      </td>

      <td>
        Absolute path to PEM-encoded root certificate file. Required if `trust_server_certificate` is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `SSL_CERT_LOCATION`
      </td>

      <td>
        Absolute path to PEM-encoded client certificate file. Required if `enable_ssl` is `true`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `SSL_KEY_LOCATION`
      </td>

      <td>
        Absolute path to PEM-encoded client key file. Required if `enable_ssl` is `true`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `TIMEOUT`
      </td>

      <td>
        Maximum wait for connection, in seconds. Set to `0` for no timeout. Default is 10.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `DATABASE`
      </td>

      <td>
        The PostgreSQL database to connect to. Default is `postgres`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M/I
      </td>
    </tr>

    <tr>
      <td>
        `CUSTOM_METRICS_QUERY`
      </td>

      <td>
        The SQL query that requires `columns metric_name`, `metric_type`, and `metric_value.metric_type` can be `gauge`, `rate`, `delta`, or `attribute`. Additional columns collected with the query are added to the metric set as attributes.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `CUSTOM_METRICS_CONFIG`
      </td>

      <td>
        A path to a YAML file with a list of custom queries, along with their metric type, database, and sample name overrides. See the [examples](/docs/infrastructure/host-integrations/host-integrations-list/postgresql/postgresql-integration#examples) for details.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `COLLECT_DB_LOCK_METRICS`
      </td>

      <td>
        Enable collecting database lock metrics, which can be performance intensive. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `COLLECT_BLOAT_METRICS`
      </td>

      <td>
        Enable tablespace bloat metrics, which can be performance intensive. Default is `true`.
      </td>

      <td style={{ 'text-align': 'center' }}>
        M
      </td>
    </tr>

    <tr>
      <td>
        `METRICS`
      </td>

      <td>
        Set to `true` to enable Metrics only collection. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}/>
    </tr>

    <tr>
      <td>
        `INVENTORY`
      </td>

      <td>
        Set to `true` to enable Inventory only collection. Default is `false`.
      </td>

      <td style={{ 'text-align': 'center' }}/>
    </tr>
  </tbody>
</table>

The values for these settings can be defined in several ways:

- Adding the value directly in the config file. This is the most common way.
- Replacing the values from environment variables using the `{{ }}` notation. Read more about [using environment variable passthroughs with on-host integrations](/docs/infrastructure/install-infrastructure-agent/configuration/configure-infrastructure-agent/#passthrough) or see the example for [environment variables replacement](/docs/infrastructure/host-integrations/host-integrations-list/elasticsearch/elasticsearch-integration#envvar-replacement).
<Callout variant="important">
  This requires infrastructure agent v1.14.0+. 
</Callout>

- Using secrets management. Use this to protect sensitive information, such as passwords that would be exposed in plain text on the configuration file. For more information, see [secrets management](/docs/integrations/host-integrations/installation/secrets-management).

### Labels and custom attributes [#labels]

Environment variables can be used to control config settings, such as your <InlinePopover type="licenseKey" />, and are then passed through to the infrastructure agent. For instructions on how to use this feature, see [Configure the infrastructure agent](/docs/infrastructure/install-infrastructure-agent/configuration/configure-infrastructure-agent).

You can further decorate your metrics using labels. Labels allow you to add key/value pairs attributes to your metrics which you can then use to query, filter or group your metrics on.

Our default sample config file includes examples of labels but, as they are not mandatory, you can remove, modify or add new ones of your choice:

```yml
 labels:
   env: production
   role: postgresql
```

## Inventory data [#inventory]

The PostgreSQL integration collects each setting from `pg_settings` along with its `boot_val` and `reset_val`. The [Infrastructure inventory data](/docs/infrastructure/integrations-getting-started/getting-started/understand-integration-data-data-types#inventory-data) appears on the [Inventory page](/docs/infrastructure/new-relic-infrastructure/infrastructure-ui-pages/infrastructure-inventory-page-search-your-entire-infrastructure), under the `config/postgresql` source.

## Troubleshooting [#troubleshooting]

Here are some troubleshooting tips for the PostgreSQL integration:

* If you have connection problems, make sure you can connect to the cluster from the same box with `psql`.
* If you have problems collecting `PgBouncer` metrics, make sure you are connected to the instance through `PgBouncer`. Default port is `6432`.
* If you get the error message `Error creating list of entities to collect: pq: unsupported startup parameter: extra_float_digits`, set `ignore_startup_parameters = extra_float_digits` in the `PgBouncer` config file.
