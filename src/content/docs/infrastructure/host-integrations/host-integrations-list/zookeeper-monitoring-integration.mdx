---
title: Zookeeper monitoring integration
tags:
  - Integrations
  - On-host integrations
  - On-host integrations list
metaDescription: An introduction to New Relic's open-source ZooKeeper integration.
redirects:
  - /docs/integrations/host-integrations/host-integrations-list/zookeeper-monitoring-integration
  - /docs/zookeeper-open-source-integration
  - /docs/integrations/host-integrations/host-integrations-list/zookeeper-integration
---


import infrastructureApacheZooKeeperDashboard from 'images/infrastructure_screenshot-full_apache-zookeeper-dashboard.webp'

Our Apache ZooKeeper integration monitors the performance of your ZooKeeper clusters, helping you manage and synchronize your distributed systems. Our Apache ZooKeeper integration gives you a pre-built dashboard that includes cluster-level and node-level metrics. 

<img
    src={infrastructureApacheZooKeeperDashboard}
    title="Apache ZooKeeper dashboard landing page"
    alt="A screenshot of a dashboard with Apache ZooKeeper metrics."
/>

<figcaption>
After setting up our Apache ZooKeeper integration, we give you a dashboard for your ZooKeeper web app metrics. 
</figcaption>

## Install the infrastructure agent [#infra]

Before getting ZooKeeper data into New Relic, you'll need to install our infrastructure agent, then expose your metrics by configuring NRI-ZooKeeper or NRI-Flex integration.

There are two methods to install the infrastructure agent:

* Our [guided install](https://one.newrelic.com/nr1-core?state=4f81feab-35f7-e97e-9903-52510f8542bd) is a CLI tool that inspects your system and installs the infrastructure agent alongside the application monitoring agent that best works for your system. To learn more about how our guided install works, check out our [Guided install overview](https://docs.newrelic.com/docs/infrastructure/host-integrations/installation/new-relic-guided-install-overview/).
* If youâ€™d rather install our infrastructure agent manually, you can follow a tutorial for manual installation for [Linux](https://docs.newrelic.com/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-monitoring-agent-linux/), [Windows](https://docs.newrelic.com/docs/infrastructure/install-infrastructure-agent/windows-installation/install-infrastructure-monitoring-agent-windows/), or [macOS](https://docs.newrelic.com/docs/infrastructure/install-infrastructure-agent/macos-installation/install-infrastructure-monitoring-agent-macos/).

## Integrate Apache ZooKeeper with New Relic:

 There are two ways to integrate Apache Zookeeper with New Relic. You can follow any way which you are comfortable with.

 * Using NRI-ZooKeeper for Apache ZooKeeper.
 * Using NRI-Flex for Apache ZooKeeper.

## option1. Using NRI-ZooKeeper to capture metrics
<Steps>

<Step>

### Install NRI-ZooKeeper

The New Relic infrastructure integration for ZooKeeper captures critical performance metrics reported by ZooKeeper nodes.

 1. Download the Zookeeper Integration from [Releases](https://github.com/newrelic/nri-zookeeper/releases).
 2. Place the executable `nr-zookeeper` in `/var/db/newrelic-infra/newrelic-integrations/bin/`.
 3. Place the definition file `zookeeper-definition.yml` in `/var/db/newrelic-infra/newrelic-integrations`.
 4. Set execution permissions for the binary files nr-zookeeper 

  ```
  ls -la /bin | grep nr
  ```
</Step>

<Step>

### Configuring NRI-ZooKeeper for Apache Zookeeper:

1. Place the integration configuration file `zookeeper-config.yml.sample` in `/etc/newrelic-infra/integrations.d` and update its values.
2. Rename the file `zookeeper-config.yml.sample` to `zookeeper-config.yml`.
3. Open `zookeeper-config.yml` and update `PATH_OF_NC` as per your OS.
4. Use the below command to find the path of `nc` on the Linux OS.
   ```
    which nc
   ```
Your `zookeeper-config.yml` file looks like this:
 ```
integration_name: com.newrelic.zookeeper
instances:
  - name: zookeeper
    command: metrics
    arguments:
      host: localhost
      port: 2181
      cmd: PATH_OF_NC
    labels:
      role: zookeeper
```
</Step>
</Steps>

## option2. Using NRI-Flex to capture metrics

<Steps>

<Step>

### Installing NRI-Flex

Flex comes bundled with the New Relic infrastructure agent. To install the infrastructure agent, see [Install the infrastructure agent](https://docs.newrelic.com/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent-new-relic).

</Step>

<Step>

### Configuring NRI-Flex for Apache ZooKeeper

To create a flex configuration file follow these steps:

1. Create a file named `zookeeper-config.yml` on the path below:
    * for Linux, `/etc/newrelic-infra/integrations.d`
    * for windows, `C:\Program Files\New Relic\newrelic-infra\integrations.d\`
2. Using this [sample configuration file](https://github.com/newrelic/nri-flex/blob/master/examples/zookeeper-cmd-raw-example.yml) as a guide, modify your zookeeper-config.yml file.
   * Update the `EVENT_TYPE`, as the value in event_type can be used to store metrics in NRDB.

Once your configuration file is updated, it will look like this:

```
integrations:
  - name: nri-flex
    # interval: 30s
    config:
      name: zookeeperFlex
      apis:
        - name: zookeeper
          event_type: EVENT_TYPE
          commands:
            - run: echo mntr | nc localhost 2181  ## change to your zookeeper server
              split_by: "\t"  ## split by tab
          snake_to_camel: true
          custom_attributes:
            myCustomAttr: theValue  ## inject your own additional custom attributes
```

</Step>

## Restart the New Relic infrastructure agent 
Before you can start reading your data, use the instructions in our [infrastructure agent docs](https://docs.newrelic.com/docs/infrastructure/install-infrastructure-agent/manage-your-agent/start-stop-restart-infrastructure-agent/) to restart your infrastructure agent.

  ```
  sudo systemctl restart newrelic-infra.service
  ```

## Monitor your application

 You can choose our pre-built dashboard template named `Apache ZooKeeper` to monitor your Zookeeper application metrics. Follow these steps to use our pre-built dashboard template:

1. Go to **[one.newrelic.com](https://one.newrelic.com/)** and click on **+ Add data**.
2. Click on the **Dashboards** tab.
3. In the search box, type `Apache ZooKeeper`.
4. When you see our pre-build dashboard, click on it to install it in your account.


Once your application is integrated by following the above steps, the dashboard should reflect metrics on it.

To instrument the Apache ZooKeeper quickstart and to see metrics and alerts, you can also follow our [Apache ZooKeeper quickstart page](https://newrelic.com/instant-observability/apache-zookeeper) by clicking on the `Install now` button.

Here are some example queries:

**Example:** Below is the query to check the number of znodes in the zookeeper namespace.

```sql
FROM ZookeeperSample SELECT latest(zk_znode_count)
```

When integrated with `nri-zookeeper` the metrics will be exported into `ZookeeperSample`. Whereas, when integrated with nri-flex, the metrics will be exported into the given `EVENT_TYPE`. All the metrics captured can be queried using the NRQL.

```sql
FROM <EVENT_TYPE> SELECT latest(zkZnodeCount)
```

## What's next?

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your dashboards display mode, or to add more content to your dashboard.
