---
title: Apache Hadoop integration
tags:
   - Apache Hadoop  integration
   - New Relic integrations
metaDescription: Install our Apache Hadoop dashboards and see your Apache Hadoop  data in New Relic.
---
import infrastructureApacheHadoopDashboard from 'images/infrastructure_screenshot-full_apache-hadoop-dashboard.webp'

Use the New Relic Infrastructure agent and nri-flex to instrument and monitor your Apache Hadoop. Evaluate the data for storing and analyzing large datasets on your system clusters. It stores its data in the HDFS (Hadoop Distributed File System) and uses MapReduce to process it.


<img
    title="Apache Hadoop dashboard"
    alt="Apache Hadoop dashboard"
    src={infrastructureApacheHadoopDashboard}
/>

<figcaption>
After setting up the integration with New Relic, see your data in dashboards like these, right out of the box.
</figcaption>

## Install the infrastructure agent [#infra]

To get data into New Relic, install our infrastructure agent. Our infrastructure agent collects and ingests data so you can keep track of your app's performance. The version should be 1.10.7 or later to support NRI-Flex integration.

You can install the infrastructure agent two different ways:

* Our [guided install](https://one.newrelic.com/nr1-core?state=4f81feab-35f7-e97e-9903-52510f8542bd) is a CLI tool that inspects your system and installs the infrastructure agent alongside the application monitoring agent that best works for your system. To learn more about how our guided install works, check out our [Guided install overview](/docs/infrastructure/host-integrations/installation/new-relic-guided-install-overview).
* If you'd rather install our infrastructure agent manually, you can follow a tutorial for manual installation for [Linux](/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-monitoring-agent-linux), [Windows](/docs/infrastructure/install-infrastructure-agent/windows-installation/install-infrastructure-monitoring-agent-windows/), or [macOS](/docs/infrastructure/install-infrastructure-agent/macos-installation/install-infrastructure-monitoring-agent-macos/).


## Expose your metrics

After successful installation, Apache Hadoop has to be started successfully, then it should start running on a domain with ports `9870` and `8088`. Hence,  Make sure your metrics are exposed on the below URLs.

- Metrics of name node: https://YOUR_DOMAIN:9870/jmx
- Metrics of resource manager: https://YOUR_DOMAIN:8088/jmx?qry=Hadoop:*



## NRI-Flex configuration

Once you've installed the infrastructure agent on your host, `nri-flex` binary is also installed with it.

If the infrastructure agent was not installed, follow the [installation steps](https://github.com/newrelic/nri-flex/blob/master/docs/basic-tutorial.md) of `nri-flex` from [nri-flex repository](https://github.com/newrelic/nri-flex).

To create a flex configuration file follow these steps:

1. Create a file named `nri-flex-hadoop-config.yml` in this path:

  ```shell
  /etc/newrelic-infra/integrations.d
  ```
2. Update the file `nri-flex-hadoop-config.yml` with these configurations:
    Then, use our [configuration template](https://github.com/newrelic/nri-flex/blob/master/examples/json-read-cmd-example.yml) to update the created file named `nri-flex-hadoop-config.yml`

    Now, update the fields listed below:

    From the below configuration, update the fields `EVENT_TYPE` and `YOUR_DOMAIN`

    The value on the `event_type` is used to store metrics on the NRDB.
    Example:
    * `EVENT_TYPE1` can be updated to `HadoopResourceManagerSample`
    * `EVENT_TYPE2` can be updated to `HadoopNameNodeSample`


  Your `nri-flex-hadoop-config.yml` file should look like this:

  ```yml
  ---
  integrations:
    - name: nri-flex
      # interval: 30s
      config:
        name: hadoopMetrics
        apis:
          - event_type: EVENT_TYPE1
            commands: 
              # run any command, you could cat .json file, or run some commands that produce a json output
            # the example just calls an API that returns json
              - run: curl -s https://YOUR_DOMAIN:9870/jmx #json output is retrieved from this command
          - event_type: EVENT_TYPE1
            commands: 
              - run: curl -s https://YOUR_DOMAIN:8088/jmx?qry=Hadoop:*
  ```

## Forward Apache Hadoop logs to New Relic

You can use our [log forwarding](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/) to forward Apache Hadoop logs to New Relic.

On Linux machines, your log file named `logging.yml` should be present in the path below. If you don't see your log file, then you will need to create it by following the above log forwarding documentation.

```shell
/etc/newrelic-infra/logging.d/
```

Once the log file is created, add the following script to the `logging.yml` file:

```yml
  - name: hadoop_secondarynamenode_log
    file: /usr/local/hadoop/logs/hadoop-hadoopuser-secondarynamenode-hadoop-master.log
    attributes:
      logtype: hadoop_secondarynamenode_logs
  - name: hadoop_resourcemanager_log
    file: /usr/local/hadoop/logs/hadoop-hadoopuser-resourcemanager-hadoop-master.log
    attributes:
      logtype: hadoop_hadoop_resourcemanager_logs
  - name: hadoop_namenode_log
    file: /usr/local/hadoop/logs/hadoop-hadoopuser-namenode-hadoop-master.log
    attributes:
      logtype: hadoop_namenode_logs
```



### Restart the New Relic infrastructure agent

Before you can start reading your data, use the instructions in our [infrastructure agent docs](/docs/infrastructure/install-infrastructure-agent/manage-your-agent/start-stop-restart-infrastructure-agent/) to restart your infrastructure agent.

```shell
sudo systemctl restart newrelic-infra.service
```


###  Monitor your application

You can choose our pre-built dashboard template named `Apache Hadoop` to monitor your Apache Hadoop server metrics. Follow these steps to use our pre-built dashboard template:

1. Go to **[one.newrelic.com](https://one.newrelic.com/)** and click on **+ Add data**.
2.  Click on the **Dashboards** tab.
3.  In the search box, type `Apache Hadoop`.
4.  When you see our pre-build dashboard, click on it to install it in your account.

Once your Apache Hadoop server is integrated by following the above steps, the dashboard should reflect metrics on it.

To instrument the Apache Hadoop quickstart and to see metrics and alerts, you can also follow our [Apache Hadoop quickstart page](https://newrelic.com/instant-observability/apache-hadoop) that has an **Install now** button.

Here are some example queries:

**Example:** Below query is to check if Apache Hadoop active users from Resource manager.

```sql
SELECT latest(activeUsers) FROM HadoopResourceManagerSample
```

**Example:** Below query is to check if Apache Hadoop number of active clients from Name node.

```sql
SELECT latest(numActiveClients) FROM HadoopNameNodeSample
```


## See Apache Hadoop metrics in a dashboard [#dash]

With only the infrastructure agent installed and instrumented with your Apache Hadoop, you can view your raw data in our Metrics & events. Our default dashboards transform that raw data into charts and graphs, which provide a bird's eye view of your system's health. To install our default dashboards, go to our Apache Hadoop instant observability page.

## What's next?

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your dashboards display mode, or to add more content to your dashboard.