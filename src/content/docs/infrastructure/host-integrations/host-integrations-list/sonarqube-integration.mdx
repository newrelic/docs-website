---
title: SonarQube monitoring integration
tags:
    - New Relic integrations
    - SonarQube
metaDescription: Use New Relic browser monitoring to get a dashboard with metrics from your SonarQube.
redirects: 
---
import SonarQubeDashboard from 'images/infrastructure_screenshot_full-sonarqube-dashboard.webp'

Our SonarQube integration monitors the performance of your SonarQube application, helping you evaluate the data from your project, such as line duplications, flaws, and other mistakes in order to diagnose and optimize the code.. Our SonarQube integration makes use of our infrastructure monitoring agent and NRI-Prometheus, and gives you a pre-built dashboard with your most important SonarQube metrics 

<img
    title="New Relic SonarQube dashboard"
    alt="New Relic SonarQube dashboard"
    src={SonarQubeDashboard}
/>
<figcaption>
After setting up our SonarQube integration, we give you a dashboard for your SonarQube metrics. 
</figcaption>

### Step 1: Install the relevant agents [#iinstall]

1.  Follow [the infrastructure agent install steps](/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent) for the host containing your SonarQube app.
2. If your infrastructure has PostgreSQL configured and running, then PostgreSQL agent will also be installed along with the New Relic infrastructure agent but if the automated installation did not occur, follow the PostgreSQL agent [install steps](https://docs.newrelic.com/docs/infrastructure/host-integrations/host-integrations-list/postgresql/postgresql-integration/).
3. Follow the [PostgreSQL quickstart page](https://newrelic.com/instant-observability/postresql) to install the agent by clicking the `Install now` button.
4. Or execute the command below by updating the `YOUR_KEY` and the `ACCOUNT_ID` fields.

```
curl -Ls https://download.newrelic.com/install/newrelic-cli/scripts/install.sh | bash && sudo  NEW_RELIC_API_KEY=YOUR_KEY NEW_RELIC_ACCOUNT_ID=ACCOUNT_ID /usr/local/bin/newrelic install -n postgres-open-source-integration
```

## Integrate SonarQube with New Relic [#integrate]

<CollapserGroup>
<Collapser
    id="step1"
    title="Step 1. Create a user token"
    >

1. Login into **SonarQube**, select **My Account** then click **Security**.
2. Name your token. Make sure that you've selected the type as `user token`.
3. Copy the created token and save it in a file of your desired path.
</Collapser>
<Collapser
    id="step2"
    title="Step 2. Configure NRI-Prometheus"
    >
1. Create a file named `nri-prometheus-config.yml` using this path: `/etc/newrelic-infra/integrations.d/nri-prometheus-config.yml`
2. Use our [configuration template](https://github.com/newrelic/nri-prometheus/blob/main/configs/nri-prometheus-config.yml.sample) to update the created file named `nri-prometheus-config.yml`.
3. Update these fields 

* cluster_name: `YOUR_DESIRED_CLUSTER_NAME`
* bearer_token_file: `USER_TOKEN_FILE_PATH`
* urls: `[“https://YOUR_HOST_IP:9000/api/monitoring/metrics”]`
* Insecure_skip_verify: `true`

Your `nri-prometheus-config.yml` file should look like this:

```yml
integrations:
  - name: nri-prometheus
    config:
    # When standalone is set to false nri-prometheus requires an infrastructure agent to work and send data. Defaults to true
    standalone: false

    # When running with infrastructure agent emitters will have to include infra-sdk
    emitters: infra-sdk

    # The name of your cluster. It's important to match other New Relic products to relate the data.
    cluster_name: "YOUR_DESIRED_CLUSTER_NAME"
    bearer_token_file: "BEARER_TOKEN_FILE_PATH"

    targets:
      - description: Sonarqube metrics list
        urls: ["https://YOUR_HOST_IP:9000/api/monitoring/metrics"]
        bearer_token: true

    #    tls_config:
    #      ca_file_path: "/etc/etcd/etcd-client-ca.crt"
    #      cert_file_path: "/etc/etcd/etcd-client.crt"
    #      key_file_path: "/etc/etcd/etcd-client.key"

    # Whether the integration should run in verbose mode or not. Defaults to false.
    verbose: false

    # Whether the integration should run in audit mode or not. Defaults to false.
    # Audit mode logs the uncompressed data sent to New Relic. Use this to log all data sent.
    # It does not include verbose mode. This can lead to a high log volume, use with care.
    audit: true

    # The HTTP client timeout when fetching data from endpoints. Defaults to 30s.
    # scrape_timeout: "30s"

    # Length in time to distribute the scraping from the endpoints.
    scrape_duration: "30s"

    # Number of worker threads used for scraping targets.
    # For large clusters with many (&gt;400) endpoints, slowly increase until scrape
    # time falls between the desired `scrape_duration`.
    # Increasing this value too much will result in huge memory consumption if too
    # many metrics are being scraped.
    # Default: 4
    # worker_threads: 4

    # Whether the integration should skip TLS verification or not. Defaults to false.
    insecure_skip_verify: true

timeout: 10s
```
</Collapser>
<Collapser
id="step3"
    title="Step 3. Forward SonarQube logs to New Relic"
>
You can use our [log forwarding](https://docs.newrelic.com/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/) to forward SonarQube logs to New Relic.

On Linux machines, your log file named logging.yml should be present in this path: `/etc/newrelic-infra/logging.d/`.

After creating the log file, add the script below to the `logging.yml` file:

```yml
logs:
  - name: sonar_logs
    file: /opt/sonarqube/logs/sonar.log
    attributes: 
      logtype: sonar_logs
``` 
</Collapser>
<Collapser
id="step4"
    title="Step 4. Restart the New Relic infrastructure agent"
>

Restart your application. 

```shell
sudo systemctl restart newrelic-infra.service
```
Wait five minutes and then proceed to finding your data in New Relic. 
</Collapser>
</CollapserGroup>

## Find your data 

To get your SonarQube dashboard: 

1. From [one.newrelic.com](https://one.newrelic.com), go to the [**Add data** page](https://one.newrelic.com/marketplace). 
2. Click on **Dashboards**.
3. In the search bar, type `flutter web`. 
4. The SonarQube dashboard should appear. Click on it to install it.

Your Flutter dashboard is considered a custom dashboard and can be found in the **Dashboards** UI. For docs on using and editing dashboards, see [our dashboard docs](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards).

Here's an example NRQL query....

```sql
SELECT latest(activeUsers) FROM HadoopResourceManagerSample
```


## What's next?

To learn more about building NRQL queries and generating dashboards, check out these docs:

* [Introduction to the query builder](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder) to create basic and advanced queries.
* [Introduction to dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards) to customize your dashboard and carry out different actions.
* [Manage your dashboard](/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard) to adjust your dashboards display mode, or to add more content to your dashboard.
