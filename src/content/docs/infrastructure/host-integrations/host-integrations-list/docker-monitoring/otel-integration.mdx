---
title: Docker container monitoring with OpenTelemetry
tags:
  - Integrations
  - OpenTelemetry
  - Docker
  - Containers
metaDescription: Monitor Docker containers using OpenTelemetry Collector with seamless integration into New Relic.
freshnessValidatedDate: 2024-12-19
---

Monitor your Docker containers using the OpenTelemetry Collector to send metrics and telemetry data to New Relic. This integration leverages the OpenTelemetry Docker Stats receiver to capture comprehensive container performance data.

<Callout variant="tip">
  The OpenTelemetry Docker Stats receiver is part of the [OpenTelemetry Collector Contrib](https://github.com/open-telemetry/opentelemetry-collector-contrib) distribution.
</Callout>

## Prerequisites [#prerequisites]


Before you begin, ensure you have:

- A New Relic account with a valid <InlinePopover type="licenseKey"/>.
- Docker Engine installed and running
- Access to the Docker socket (typically `/var/run/docker.sock` on Linux)
- OpenTelemetry Collector (Contrib distribution) installed

## Installation [#installation]

### Step 1: Configure the OpenTelemetry Collector [#configure-collector]

Create or update your OpenTelemetry Collector configuration file (`config.yaml`) with the Docker Stats receiver:

```yaml
receivers:
  docker_stats:
    endpoint: unix:///var/run/docker.sock
    collection_interval: 15s
    timeout: 20s

processors:
  batch:
    timeout: 10s
  resourcedetection:
    detectors: [docker, system]
    timeout: 5s

exporters:
  otlp:
    endpoint: https://otlp.nr-data.net:4317
    headers:
      api-key: YOUR_LICENSE_KEY_HERE

service:
  pipelines:
    metrics:
      receivers: [docker_stats]
      processors: [batch, resourcedetection]
      exporters: [otlp]
```

### Step 2: Run the OpenTelemetry Collector [#run-collector]

Run the collector with your configuration:

```bash
# Using Docker
docker run -d \
  --name otel-collector \
  -v /var/run/docker.sock:/var/run/docker.sock:ro \
  -v $(pwd)/config.yaml:/etc/otel/config.yaml \
  otel/opentelemetry-collector-contrib:latest \
  --config=/etc/otel/config.yaml

# Using standalone binary
./otelcol-contrib --config=config.yaml
```

### Step 3: Verify data in New Relic [#verify-data]

After a few minutes, check that your Docker metrics are flowing into New Relic:

1. Go to **[one.newrelic.com](https://one.newrelic.com)**
2. Navigate to **Query your data**
3. Run this NRQL query:

```sql
FROM Metric SELECT * WHERE instrumentation.provider = 'opentelemetry' 
AND service.name = 'otelcol-contrib' 
LIMIT MAX
```

## Available metrics [#available-metrics]

The Docker Stats receiver collects the following metrics:

<table>
  <thead>
    <tr>
      <th style={{ width: "300px" }}>
        Metric
      </th>
      <th>
        Description
      </th>
      <th>
        Unit
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        `container.cpu.usage.total`
      </td>
      <td>
        Total CPU time consumed by the container
      </td>
      <td>
        nanoseconds
      </td>
    </tr>
    <tr>
      <td>
        `container.cpu.usage.percpu`
      </td>
      <td>
        CPU time consumed per CPU core
      </td>
      <td>
        nanoseconds
      </td>
    </tr>
    <tr>
      <td>
        `container.cpu.usage.system`
      </td>
      <td>
        System CPU usage
      </td>
      <td>
        nanoseconds
      </td>
    </tr>
    <tr>
      <td>
        `container.cpu.throttling_data.throttled_time`
      </td>
      <td>
        Total time the container was throttled
      </td>
      <td>
        nanoseconds
      </td>
    </tr>
    <tr>
      <td>
        `container.memory.usage.total`
      </td>
      <td>
        Total memory usage
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.memory.usage.limit`
      </td>
      <td>
        Memory usage limit
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.memory.usage.max`
      </td>
      <td>
        Maximum memory usage recorded
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.memory.cache`
      </td>
      <td>
        Memory used for cache
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.rx_bytes`
      </td>
      <td>
        Network bytes received
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.tx_bytes`
      </td>
      <td>
        Network bytes transmitted
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.rx_packets`
      </td>
      <td>
        Network packets received
      </td>
      <td>
        packets
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.tx_packets`
      </td>
      <td>
        Network packets transmitted
      </td>
      <td>
        packets
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.rx_dropped`
      </td>
      <td>
        Incoming packets dropped
      </td>
      <td>
        packets
      </td>
    </tr>
    <tr>
      <td>
        `container.network.io.usage.tx_dropped`
      </td>
      <td>
        Outgoing packets dropped
      </td>
      <td>
        packets
      </td>
    </tr>
    <tr>
      <td>
        `container.blockio.io_service_bytes_recursive.read`
      </td>
      <td>
        Bytes read from block devices
      </td>
      <td>
        bytes
      </td>
    </tr>
    <tr>
      <td>
        `container.blockio.io_service_bytes_recursive.write`
      </td>
      <td>
        Bytes written to block devices
      </td>
      <td>
        bytes
      </td>
    </tr>
  </tbody>
</table>

## Configuration options [#config-options]

### Docker Stats Receiver options [#receiver-options]

You can customize the Docker Stats receiver with these configuration options:

```yaml
receivers:
  docker_stats:
    # Docker API endpoint (required)
    endpoint: unix:///var/run/docker.sock
    
    # How often to collect metrics (default: 10s)
    collection_interval: 10s
    
    # API request timeout (default: 5s)
    timeout: 20s
    
    # Collect per-core CPU metrics (default: false)
    provide_per_core_cpu_metrics: true
    
    # Filter containers by name or ID
    container_labels_to_metric_labels:
      - com.example.environment
      - com.example.service
    
    # Exclude specific containers
    excluded_images:
      - ".*pause.*"
      - "k8s.gcr.io/pause"
```

## Create dashboards and alerts [#dashboards-alerts]

### Example NRQL queries [#example-queries]

**Container CPU usage:**
```sql
FROM Metric SELECT average(container.cpu.usage.total) 
FACET container.name 
TIMESERIES AUTO
```

**Container memory usage:**
```sql
FROM Metric SELECT average(container.memory.usage.total) / 1024 / 1024 / 1024 
FACET container.name 
TIMESERIES AUTO
```

**Network I/O:**
```sql
FROM Metric SELECT 
  rate(sum(container.network.io.usage.rx_bytes), 1 second) as 'Received',
  rate(sum(container.network.io.usage.tx_bytes), 1 second) as 'Transmitted'
FACET container.name 
TIMESERIES AUTO
```

### Create alerts [#create-alerts]

Set up alerts for key container metrics:

1. Go to **[one.newrelic.com > Alerts](https://one.newrelic.com/alerts-ai)**
2. Click **Create a condition**
3. Select **NRQL** as the condition type
4. Use queries like:

```sql
FROM Metric SELECT average(container.memory.usage.total) / average(container.memory.usage.limit) * 100
FACET container.name
```

## Troubleshooting [#troubleshooting]

### No metrics appearing [#no-metrics]

If you don't see metrics in New Relic:

1. Verify the collector is running: `docker logs otel-collector`
2. Check Docker socket permissions: `ls -l /var/run/docker.sock`
3. Verify your New Relic license key is correct
4. Ensure the OTLP endpoint is accessible

### Permission denied errors [#permission-errors]

If you see permission errors accessing Docker socket:

```bash
# On Linux, add your user to the docker group
sudo usermod -aG docker $USER

# Or run the collector with appropriate permissions
docker run -d --user root ...
```

### High resource usage [#high-resources]

If the collector uses too many resources:

1. Increase the `collection_interval`
2. Exclude unnecessary containers using `excluded_images`
3. Disable per-core CPU metrics by setting `provide_per_core_cpu_metrics: false`

## What's next? [#whats-next]

- Learn more about [querying your data](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/)
- Create [custom dashboards](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/) to visualize your Docker metrics
- Set up [alerts](/docs/alerts-applied-intelligence/new-relic-alerts/get-started/introduction-alerts/) to notify you of container performance issues
- Explore the [OpenTelemetry Collector documentation](https://opentelemetry.io/docs/collector/) for advanced configurations
