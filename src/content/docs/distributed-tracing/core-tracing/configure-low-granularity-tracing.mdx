---
title: Configure low-granularity tracing
tags:
  - Understand dependencies
  - Distributed tracing
  - Core Tracing
metaDescription: Reduce trace data volume by 30-45% with low-granularity tracing while maintaining service connectivity and flow visualization.
freshnessValidatedDate: never
---

Low-granularity tracing (LGT) reduces the size of each span by sending only essential attributes needed for service relationships and trace connectivity. You can cut data volume by 30-45% while still maintaining complete end-to-end traces and Dynamic Flow Maps.

## Before you begin [#before-you-begin]

Make sure you have:

* [Distributed tracing enabled](/docs/distributed-tracing/concepts/quick-start) on your services
* Agent versions that support LGT (see [requirements](#requirements) below)
* Permission to modify agent configuration files or environment variables
* Understanding of which attributes your teams actively use for troubleshooting

<Callout variant="important">
  LGT does **not** include custom attributes by default. If you need custom attributes on LGT spans, you must explicitly opt in. See [Add custom attributes](#custom-attributes).
</Callout>

## What data gets captured with LGT [#what-data]

LGT sends a minimal set of attributes focused on maintaining trace connectivity and service relationships:

### Attributes included in LGT

<table>
  <thead>
    <tr>
      <th width={250}>
        Attribute category
      </th>
      <th>
        Specific attributes
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **Core trace identifiers**
      </td>
      <td>
        * `trace.id`
        * `span.id`
        * `parent.id`
        * `entity.guid`
        * `entity.name`
      </td>
    </tr>

    <tr>
      <td>
        **Service relationship data**
      </td>
      <td>
        * `service.name`
        * `span.kind` (server, client, internal)
        * `component` (e.g., http, database, message)
      </td>
    </tr>

    <tr>
      <td>
        **Timing information**
      </td>
      <td>
        * `timestamp`
        * `duration`
      </td>
    </tr>

    <tr>
      <td>
        **Request basics**
      </td>
      <td>
        * `http.method` (GET, POST, etc.)
        * `http.status_code`
        * `error` (true/false)
      </td>
    </tr>

    <tr>
      <td>
        **LGT metadata**
      </td>
      <td>
        * `nr.lowGranularity` (set to `true` for identification)
      </td>
    </tr>
  </tbody>
</table>

### Attributes excluded from LGT

<table>
  <thead>
    <tr>
      <th width={250}>
        Attribute category
      </th>
      <th>
        Examples of excluded attributes
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **Detailed HTTP information**
      </td>
      <td>
        * `http.url`
        * `http.request.headers.*`
        * `http.response.headers.*`
        * Query parameters
      </td>
    </tr>

    <tr>
      <td>
        **Database details**
      </td>
      <td>
        * SQL statements
        * Database connection strings
        * Query parameters
      </td>
    </tr>

    <tr>
      <td>
        **Custom attributes**
      </td>
      <td>
        * All custom attributes (unless explicitly opted in)
        * User-defined metadata
        * Business context attributes
      </td>
    </tr>

    <tr>
      <td>
        **Detailed error information**
      </td>
      <td>
        * Stack traces
        * Error messages
        * Exception details
      </td>
    </tr>

    <tr>
      <td>
        **Performance details**
      </td>
      <td>
        * Queue time
        * External segment details
        * Database rollup metrics
      </td>
    </tr>
  </tbody>
</table>

The key principle: LGT keeps everything needed for "what service called what service and how long did it take" while removing the detailed "how and why" information.

## Requirements [#requirements]

Minimum agent versions for LGT:

<table>
  <thead>
    <tr>
      <th width={200}>
        Agent
      </th>
      <th>
        Minimum version
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Java
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        .NET
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        Node.js
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        Python
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        Go
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        Ruby
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>

    <tr>
      <td>
        PHP
      </td>
      <td>
        TBD (check with Engineering)
      </td>
    </tr>
  </tbody>
</table>

## Configure LGT [#configure]

Choose your agent language to see configuration instructions:

<CollapserGroup>
  <Collapser
    id="java"
    title="Java agent"
  >
    To configure LGT for your Java application, add the `span_events.attributes.enabled` setting to your `newrelic.yml` configuration file.

    **Configuration file approach:**

    1. Open your `newrelic.yml` file.
    2. Under the `distributed_tracing` section, add the `span_events.attributes` configuration:

    ```yml
    distributed_tracing:
      enabled: true
      span_events:
        attributes:
          enabled: false  # Disable all attributes
          include:
            - minimal_set  # Include only minimal attributes
    ```

    3. Save the file and restart your Java application.

    **Environment variable approach:**

    ```bash
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="dotnet"
    title=".NET agent"
  >
    To configure LGT for your .NET application, modify the `span` element attributes in your `newrelic.config` file.

    **Configuration file approach:**

    1. Open your `newrelic.config` file.
    2. Configure the span events attributes:

    ```xml
    <configuration>
      <distributedTracing enabled="true">
        <spanEvents>
          <attributes enabled="false">
            <include>minimal_set</include>
          </attributes>
        </spanEvents>
      </distributedTracing>
    </configuration>
    ```

    3. Save the file and restart your .NET application or IIS.

    **Environment variable approach:**

    ```bash
    set NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    set NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="nodejs"
    title="Node.js agent"
  >
    To configure LGT for your Node.js application, add the `span_events.attributes` settings to your `newrelic.js` configuration file.

    **Configuration file approach:**

    1. Open your `newrelic.js` file.
    2. Add the `span_events` configuration:

    ```js
    'use strict'

    exports.config = {
      distributed_tracing: {
        enabled: true
      },
      span_events: {
        attributes: {
          enabled: false,  // Disable all attributes
          include: ['minimal_set']  // Include only minimal attributes
        }
      }
    }
    ```

    3. Save the file and restart your Node.js application.

    **Environment variable approach:**

    ```bash
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="python"
    title="Python agent"
  >
    To configure LGT for your Python application, add the `span_events.attributes` settings to your `newrelic.ini` file.

    **Configuration file approach:**

    1. Open your `newrelic.ini` file.
    2. Add the settings under the `[newrelic]` section:

    ```ini
    [newrelic]
    distributed_tracing.enabled = true
    span_events.attributes.enabled = false
    span_events.attributes.include = minimal_set
    ```

    3. Save the file and restart your Python application.

    **Environment variable approach:**

    ```bash
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="go"
    title="Go agent"
  >
    To configure LGT for your Go application, set the configuration when initializing the New Relic application.

    **Code-based configuration:**

    ```go
    app, err := newrelic.NewApplication(
        newrelic.ConfigAppName("Your Application Name"),
        newrelic.ConfigLicense("YOUR_LICENSE_KEY"),
        newrelic.ConfigDistributedTracerEnabled(true),
        func(cfg *newrelic.Config) {
            cfg.SpanEvents.Attributes.Enabled = false
            cfg.SpanEvents.Attributes.Include = []string{"minimal_set"}
        },
    )
    ```

    **Environment variable approach:**

    ```bash
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="ruby"
    title="Ruby agent"
  >
    To configure LGT for your Ruby application, add the `span_events.attributes` settings to your `newrelic.yml` file.

    **Configuration file approach:**

    1. Open your `newrelic.yml` file.
    2. Add the settings under the `common` section:

    ```yml
    common: &default_settings
      distributed_tracing:
        enabled: true
      span_events:
        attributes:
          enabled: false  # Disable all attributes
          include:
            - minimal_set  # Include only minimal attributes
    ```

    3. Save the file and restart your Ruby application.

    **Environment variable approach:**

    ```bash
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_ENABLED=false
    export NEW_RELIC_DISTRIBUTED_TRACING_SPAN_EVENTS_ATTRIBUTES_INCLUDE=minimal_set
    ```

  </Collapser>

  <Collapser
    id="php"
    title="PHP agent"
  >
    To configure LGT for your PHP application, add the settings to your `newrelic.ini` file.

    **Configuration file approach:**

    1. Open your `newrelic.ini` file.
    2. Add the settings:

    ```ini
    newrelic.distributed_tracing.enabled = true
    newrelic.span_events.attributes.enabled = false
    newrelic.span_events.attributes.include = "minimal_set"
    ```

    3. Save the file and restart your web server.

    **Runtime configuration:**

    ```php
    ini_set('newrelic.span_events.attributes.enabled', 'false');
    ini_set('newrelic.span_events.attributes.include', 'minimal_set');
    ```

  </Collapser>
</CollapserGroup>

## Add custom attributes (optional) [#custom-attributes]

By default, LGT does **not** include custom attributes. This is intentional to keep costs predictable. If you have custom attributes that are critical for your troubleshooting workflows, you can explicitly opt them in.

<Callout variant="caution">
  Adding custom attributes to LGT spans increases ingest volume and costs. Only include attributes you actively use for troubleshooting or business intelligence.
</Callout>

### Opt in specific custom attributes

To include specific custom attributes in LGT spans, add them to the `include` list:

**Java example:**

```yml
distributed_tracing:
  enabled: true
  span_events:
    attributes:
      enabled: false
      include:
        - minimal_set
        - user.id          # Custom attribute
        - transaction.type  # Custom attribute
```

**Node.js example:**

```js
span_events: {
  attributes: {
    enabled: false,
    include: [
      'minimal_set',
      'user.id',          // Custom attribute
      'transaction.type'  // Custom attribute
    ]
  }
}
```

### Monitor custom attribute impact

After adding custom attributes, monitor your ingest volume:

```sql
SELECT bytecountestimate() / 1e9 as 'GB Estimate'
FROM Span
WHERE nr.lowGranularity = true
SINCE 1 day ago
COMPARE WITH 1 day ago
```

If ingest increases more than expected, review which custom attributes are actually being used in queries and remove unused ones.

## Combine LGT with minimal spans tracing [#combine]

For maximum cost reduction, combine LGT with [minimal spans tracing (MST)](/docs/distributed-tracing/core-tracing/configure-minimal-spans-tracing). This approach reduces both span count and span size:

**Java example combining MST + LGT:**

```yml
distributed_tracing:
  enabled: true
  span_events:
    span_type_filter: minimal  # MST: Reduce span count
    attributes:
      enabled: false            # LGT: Reduce span attributes
      include:
        - minimal_set
```

**Expected results:**
* MST alone: 50-70% span volume reduction
* LGT alone: 30-45% data size reduction
* MST + LGT: 60-80% total data volume reduction

This combined approach is ideal for supporting services where you need connectivity data but not detailed telemetry.

## Verify LGT is working [#verify]

After configuring LGT, verify it's working correctly:

### Check for LGT spans

Run this NRQL query to confirm LGT spans are being reported:

```sql
SELECT count(*)
FROM Span
WHERE nr.lowGranularity = true
AND entity.name = 'YOUR_SERVICE_NAME'
SINCE 30 minutes ago
```

You should see spans with `nr.lowGranularity = true`.

### Compare attribute counts

Check the difference in attribute count between full DT and LGT spans:

```sql
SELECT average(nr.attributeCount)
FROM Span
WHERE entity.name = 'YOUR_SERVICE_NAME'
FACET nr.lowGranularity
SINCE 30 minutes ago
```

LGT spans should show significantly fewer attributes (typically 10-15 attributes vs 40-60 for full spans).

### Verify trace completeness

Ensure Dynamic Flow Maps and trace visualization still work:

1. Go to **[one.newrelic.com > All capabilities](https://one.newrelic.com/all-capabilities) > APM & services > Service map**.
2. Verify your LGT-enabled services appear correctly in the map.
3. Check that service-to-service connections are visible.
4. Click on a service to view distributed tracing and confirm traces are complete.

## Troubleshoot issues [#troubleshoot]

### LGT configuration not taking effect

**Problem:** You configured LGT but spans still have all attributes.

**Solutions:**

1. Restart your application after configuration changes.
2. Check agent logs for configuration errors.
3. Verify your agent version supports LGT.
4. Confirm syntax matches your agent's configuration format exactly.

### Custom attributes not appearing

**Problem:** You opted in custom attributes but they're not in LGT spans.

**Solutions:**

1. Verify the attribute names match exactly (case-sensitive).
2. Confirm attributes are being set before the span is created.
3. Check that the attributes exist on full DT spans first:
   ```sql
   SELECT uniques(attribute.names)
   FROM Span
   WHERE entity.name = 'YOUR_SERVICE_NAME'
   AND nr.lowGranularity IS NULL
   SINCE 1 hour ago
   ```

### Ingest volume didn't decrease as expected

**Problem:** LGT is enabled but ingest volume hasn't decreased significantly.

**Solutions:**

1. Verify LGT spans are actually being created (check `nr.lowGranularity = true`).
2. Check if you opted in many custom attributes, which increases span size.
3. Consider combining LGT with MST for greater reduction.
4. Allow 24-48 hours for ingest metrics to stabilize before evaluating impact.

<Callout variant="important">
  For additional troubleshooting help, see [Troubleshoot Core Tracing issues](/docs/distributed-tracing/troubleshooting/core-tracing-issues) or contact [New Relic Support](https://support.newrelic.com).
</Callout>

## What's next [#whats-next]

Now that you've configured LGT:

* [Configure minimal spans tracing](/docs/distributed-tracing/core-tracing/configure-minimal-spans-tracing) to combine LGT with span volume reduction
* [Optimize your costs](/docs/distributed-tracing/core-tracing/cost-optimization-strategies) with a comprehensive service prioritization strategy
* [Review use cases](/docs/distributed-tracing/core-tracing/use-cases-examples) to learn how other customers use LGT
