---
title: 'Installation on Windows'
tags:
    - Integrations
    - Kubernetes integration
    - Installation
    - Windows
metaDescription: "New Relic's Kubernetes integration: Installing the Kubernetes integration on Windows-based nodes"
freshnessValidatedDate: never
---

<Callout title="preview">
  We're still working on this feature, but we'd love for you to try it out!

  This feature is currently provided as part of a preview program pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Use this option when you would like to monitor Windows-based nodes and applications deployed to Windows-based nodes. Note that Windows integration has several [limitations](#k8-windows-limitations).

## Compatibility and requirements [#compability-requirements]

Before you install the [Kubernetes integration](/docs/integrations/kubernetes-integration/get-started/introduction-kubernetes-integration), review the [compatibility and requirements](/docs/integrations/kubernetes-integration/get-started/kubernetes-integration-compatibility-requirements).

<Callout variant="important">
  When using containers in Windows, the container host version and the container image version must be the same. Our Kubernetes integration can run on Windows versions LTSC 2019 and LTSC 2022.
</Callout>

To check your Windows version, open a Powershell or command prompt window, and run this command:

```shell
systeminfo
```
Look for the the lines beginning with `OS Name` and `OS Version`, which should give you the corresponding OS information and build number. Windows Server LTSC 2019 corresponds to build number 10.0.17763, and Windows Server LTSC 2022 corresponds to build number 10.0.20348. When installing the integration, you will not need to specify version information. This is just to verify installability.

## Install Kubernetes on Windows [#install-windows]

Enabling Windows for the Kubernetes integration is a straightforward process. The integration is designed to work seamlessly with Windows nodes in your Kubernetes cluster, allowing you to monitor and manage your Windows-based applications alongside your Linux-based ones.

A Kubernetes DaemonSet will be created for each supported Windows version, but pods will be created only for Windows node versions that exist in the cluster. This means you may see multiple DaemonSet in your cluster, but not all of them will have desired pods.

Example output where the cluster has two Linux nodes, one Windows LTSC 2022 node, and no Windows LTSC 2019 nodes:
```shell
kubectl -n newrelic get daemonsets
NAME                                                DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                                                          AGE
<...snip...>
newrelic-bundle-nrk8s-kubelet                       2         2         2       2            2           kubernetes.io/os=linux                                                 24h
newrelic-bundle-nrk8s-kubelet-windows-ltsc2019      0         0         0       0            0           kubernetes.io/os=windows,node.kubernetes.io/windows-build=10.0.17763   24h
newrelic-bundle-nrk8s-kubelet-windows-ltsc2022      1         1         1       1            1           kubernetes.io/os=windows,node.kubernetes.io/windows-build=10.0.20348   24h
```


You can enable Windows integration on your Kubernetes cluster using one of the following methods:

- [Integrations & Agents](#guided-installation)
- [Manual installation](#manual-installation)


### Prerequisites [#prerequisites]

* Ensure that all [Kubernetes integration compatibility and requirements](/docs/kubernetes-pixie/kubernetes-integration/get-started/kubernetes-integration-compatibility-requirements/) are met.


### Integration & Agents [#guided-installation]

The Integration & Agents installation paths are the recommended way to install the Kubernetes integration for Windows. They provide a guided installation experience that simplifies the process of setting up the integration on your cluster, and provide a more complete way of installing New Relic's various integration options for Kubernetes.

<Steps>
  <Step>
    ### Log in to New Relic

    Log in to your New Relic account.
  </Step>

  <Step>
    ### Go to Integration & Agents

    Go to **left navigation pane > + Integration & Agents > Guided install > Kubernetes**.
  </Step>

  <Step>
    ### Select instrumentation method

    Select the instrumentation method from one of the following displayed options:

    - **Guided**: For integration using New Relic CLI.
    - **Helm**: For integration using New Relic Helm charts.
    - **Manifest**: For integration using New Relic Manifests.
  </Step>

  <Step>
    ### Configure the Kubernetes integration

    Follow the steps as instructed in the UI, including adding or generating a key and entering a cluster name. On the `Configure the Kubernetes integration` page under `Windows node monitoring`, select `Enable monitoring of your Windows nodes`.
  </Step>
  <Step>
    ### Complete the installation walkthrough

    Please note that eAPM instrumentation and APM auto-instrumentation are not supported for Windows nodes, but may be selected for use on Linux nodes in the same cluster if desired.

    Continue following the steps in the UI. Depending on your select installation method, you will be provided a different command to install the integration.
    - **Guided**: The UI will provide you with a command to run in your terminal to install the integration using the New Relic CLI. You should see `NR_CLI_WINDOWS=true` in the command.
    - **Helm**: The UI will provide you with a command to run in your terminal to install the integration using Helm. You should see `--set newrelic-infrastructure.enableWindows=true` in the command.
    - **Manifest**: The UI will provide you with a command to run in your terminal to generate a manifest file as well as the `kubectl` installation command. In the manifest file, you should see a section titled `# Source: nri-bundle/charts/newrelic-infrastructure/templates/kubelet/daemonset-windows.yaml`.

  </Step>
</Steps>

Run the provided command in your terminal to complete the installation.

### Manual installation [#manual-installation]

If you would like to install only the core Kubernetes integration chart ([nri-kubernetes on GitHub](https://github.com/newrelic/nri-kubernetes)), you can do so using Helm.

<Steps>
  <Step>
    ### Add the New Relic Helm repository

    If you haven't done so before, run this command to add the New Relic Helm repository:

    ```shell
    helm repo add newrelic https://helm-charts.newrelic.com
    ```
  </Step>
  <Step>
    ### Create a namespace for newrelic

    Run this command to create a namespace for newrelic:

    ```shell
    kubectl create namespace newrelic
    ```

    You may also pass in `--create-namespace` to the Helm install command to create the namespace automatically.
  </Step>
  <Step>
    ### Install `kube-state-metrics`

    The `kube-state-metrics` pod is a mandatory dependency of the integration, and is only supported for Linux nodes. You must have a Linux worker node in your cluster.

    You may provide your own `kube-state-metrics` pod, or install a new one using the following command:

    ```shell
    helm repo add ksm https://kubernetes.github.io/kube-state-metrics
    helm install ksm ksm/kube-state-metrics --version 2.13.2
    ```
  </Step>
  <Step>
    ### Create a `values-newrelic.yaml` file

    Create a `values-newrelic.yaml` file with the following data. This is what Helm will use:

    ```yaml
    global:
      licenseKey: YOUR_NEW_RELIC_LICENSE_KEY
      cluster: YOUR_K8S_CLUSTER_NAME

      enableWindows: true
    ```

    This is all the installation needs, by default. However, if you would like to supply images from your own private repository, you may add the following to your values file:

    ```yaml
    images:
      windowsIntegration:
        registry: YOUR_PRIVATE_REGISTRY
        repository: YOUR_PRIVATE_REPOSITORY/INTEGRATION_IMAGE_NAME
        tag: YOUR_INTEGRATION_VERSION_TAG
        pullPolicy: IfNotPresent
      windowsAgent:
        registry: YOUR_PRIVATE_REGISTRY
        repository: YOUR_PRIVATE_REPOSITORY/AGENT_IMAGE_NAME
        tag: YOUR_AGENT_VERSION_TAG
        pullPolicy: IfNotPresent

    windowsOsList:
      - version: ltsc2019                      # Human-readable version identifier
        imageTagSuffix: YOUR_IMAGE_TAG_SUFFIX  # Tag to be used for nodes running the windows version above
        buildNumber: 10.0.17763                # Build number for your nodes running the version above. Used as a selector.
      - version: ltsc2022
        imageTagSuffix: YOUR_IMAGE_TAG_SUFFIX
        buildNumber: 10.0.20348
    ```

    By default the `imageTagSuffix` is `ltsc2019` and `ltsc2022` respectively, but if your Windows images do not have a suffix, you can provide an empty string `""` for the `imageTagSuffix`.

    Changing the version and build numbers are not recommended.
  </Step>
  <Step>
    ### Install the integration

    Run this command to install the integration:

    ```shell
    helm upgrade --install newrelic newrelic/newrelic-infrastructure \
    --namespace newrelic --create-namespace \
    -f values-newrelic.yaml
    ```
  </Step>

  <Step>
    ### Verify pods

    Verify that pods deploy and reach a stable state:

    ```shell
    kubectl -n newrelic get pods -w
    ```

    The Helm chart will create one `DaemonSet` per each version of Windows that is in the list and use `NodeSelector` to deploy the corresponding pod per node.
  </Step>
</Steps>

## Limitations to the Kubernetes integration for Windows [#k8-windows-limitations]
The Windows agent only sends the [Kubernetes samples](/docs/kubernetes-pixie/kubernetes-integration/understand-use-data/find-use-your-kubernetes-data/#event-types), such as `K8sNodeSample` or `K8sPodSample`. These limitations apply to the Kubernetes integration for Windows:

* `SystemSample`, `StorageSample`, `NetworkSample`, and `ProcessSample` are not generated at this time. This is due to limitations in permissions for Windows containers in Kubernetes.
* The use of `hostNetwork` in a Kubernetes spec is not supported for Windows pods in Kubernetes
* Some [Kubernetes metrics](/docs/integrations/kubernetes-integration/understand-use-data/understand-use-data#metrics) are missing because the Windows kubelet doesn't have them or they are not relevant for Windows:
  * Node:
    * `fsInodes`: not sent (not relevant for Windows)
    * `fsInodesFree`: not sent (not relevant for Windows)
    * `fsInodesUsed`: not sent (not relevant for Windows)
    * `memoryMajorPageFaultsPerSecond`: always returns zero as a value
    * `memoryPageFaults`: always returns zero as a value
    * `memoryRssBytes`: always returns zero as a value
    * `runtimeInodes`: not sent (not relevant for Windows)
    * `runtimeInodesFree`: not sent (not relevant for Windows)
    * `runtimeInodesUsed`: not sent(not relevant for Windows)
    * `net.errorsPerSecond`: not sent
    * `net.rxBytesPerSecond`: not sent
    * `net.txBytesPerSecond`: not sent
  * Container:
    * `containerID`: not sent
    * `containerImageID`: not sent
    * `cpuCfs*`: all `cpuCfs*` values not sent (not relevant for Windows)
    * `memoryMappedFileBytes`: not sent
    * `memoryUsedBytes`: not sent. `memoryWorkingSetBytes` may be used instead.
    * `memoryUtilization`: computed from `memoryUsedBytes`, so not sent. May be computed from `memoryWorkingSetBytes` / `memoryLimitBytes` instead.
    * `requestedMemoryUtilization`: computed from `memoryUsedBytes`, so not sent. May be computed from `memoryWorkingSetBytes` / `memoryRequestedBytes` instead.
  * Volume:
    * `fsUsedBytes`: always returns zero as a value
    * `fsUsedPercent`: zero, because `fsUsedBytes` is always zero
