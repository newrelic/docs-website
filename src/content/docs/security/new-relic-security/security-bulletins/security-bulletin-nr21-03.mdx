---
title: Apache Log4j Critical Vulnerability - CVE 2021-44228
tags:
  - Security
  - Security and Privacy
  - Security bulletin
  - Log4j
metaDescription: 'RCE Log4j CVE 2021-44228, Security Bulletin NR21-03'
---

## Summary

New Relic has released [Java agents 6.5.1](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-651/) and [7.4.1](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-741/) to address a critical vulnerability in the open source log4j framework that was publicly disclosed on 2021-12-09. A malicious actor may be able to exfiltrate data or execute arbitrary code using log messages or log message parameters.

New Relic will update this Security Bulletin and our customer guidance as new information becomes available.

**Publication history**

* December 13, 2021 - NR21-03 updated to include more explicit workaround guidance and FAQs
* December 10, 2021 - NR21-03 published

**Vulnerability identifier:** NR21-03

**Priority:** Critical

## Affected software [#affected]

The following New Relic Java agent versions are affected:

<table>
  <thead>

      <th>
        Affected Java agent version
      </th>

      <th>
        Remediated version
      </th>
    </tr>
  </thead>

  <tbody>

      <td>
        All Java agent versions between 4.12.0 to 6.5.0 or 7.4.0
      </td>

      <td>
        6.5.1 and 7.4.1
      </td>
    </tr>
  </tbody>
</table>

## Action items [#action]

To remediate this vulnerability in the New Relic Java agent, we recommend customers take one of the following actions immediately:

1. Upgrade your Java Agent to either version 6.5.1 or 7.4.1. These agent versions have been updated to use the remediated 2.15.0 version of the Apache Log4j framework.

System Requirement: Java 8 or higher. If you are on Java 7 or earlier and unable to update to Java 8, please use the following workaround.

OR

2. [Apache has published workaround options](https://logging.apache.org/log4j/2.x/index.html), one of which we recommend for customers that are unable to update their version of log4j at this time. You should define the `log4j2.formatMsgNoLookups=true` system property as part of your application startup.

This step will remediate your New Relic Java agent only. Customers that are using affected versions of the log4j framework (versions 2.10 to 2.14.1) directly in their applications will also need to either upgrade log4j to version 2.15.0 or use the published workaround to remediate this issue for their application.

## Frequently asked questions [#faq]

<CollapserGroup>
  <Collapser
    id="upgrade-options"
    title="What are our options if we are not able to upgrade our Java agent or version of Java?"
  >

  Please implement one of the [recommended workarounds in this bulletin](#action).

  </Collapser>

  <Collapser
    id="versions"
    title="How do I find out which versions of the agent we are running?"
  >

  To see agent version information, go to your **Environment** page in New Relic One. See our [environment documentation](/docs/apm/agents/manage-apm-agents/troubleshooting/get-environment-data-about-your-apm-app) for more information.

  </Collapser>
  
  <Collapser
    id="patch-v5"
    title="Why isn't there a patch for agent v5 and below?"
  >

  Most of our customers are using agent versions 6.x or 7.x, and we encourage customers to use newer versions of our agent to ensure they have the best experience. If you are not able to upgrade your agent version, please implement the [recommended workarounds in this bulletin](#action).

  </Collapser>

</CollapserGroup>

## Vulnerability information [#vuln-info]

A high level vulnerability was publicly disclosed for the log4j framework on 2021-12-09. An attacker is able to execute arbitrary code using log messages or log message parameters. We have updated the New Relic Java agent to use a remediated version 2.15.0 of the Apache log4j 2 logging framework. Due to the vulnerability in the log4j logging framework in versions 2.0 to 2.14.1 customers are encouraged to immediately update their agent versions to either 6.5.1 or 7.4.1.

Separately, customers that are using affected versions of the log4j framework (versions 2.0 to 2.14.1) directly in their applications are also encouraged to upgrade log4j to 2.15.0 to remediate this issue for their application.

Upgrading your New Relic Java Agent will not remediate this issue for your application itself, if you use affected versions of log4j.

* [CVE-2021-44228: Log4j 2 Vulnerability Analysis](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228)
* [Apache log4j Issue](https://issues.apache.org/jira/browse/LOG4J2-3198)
* [Apache log4j Security Vulnerabilities](https://logging.apache.org/log4j/2.x/security.html)
* [New Relic Explorers Hub](https://discuss.newrelic.com/t/log4j-zero-day-vulnerability-and-the-new-relic-java-agent/170322)

## Report security vulnerabilities to New Relic [#report]

New Relic is committed to the security of our customers and your data. If you believe you have found a security vulnerability in one of our products or websites, we welcome and greatly appreciate you reporting it to New Relic's coordinated disclosure program. For more information, see our documentation about [reporting security vulnerabilities](/docs/security/new-relic-security/data-privacy/reporting-security-vulnerabilities).
