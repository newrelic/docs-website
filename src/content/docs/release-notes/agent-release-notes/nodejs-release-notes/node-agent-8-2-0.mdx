---
subject: Node.js agent
releaseDate: '2021-08-25'
version: 8.2.0
features: ["Add a new feature flag `unresolved_promise_cleanup`.","Support using `connect` to route middleware calls."]
bugs: []
security: []
downloadLink: 'https://www.npmjs.com/package/newrelic'
---

## Notes

* Added a new feature flag `unresolved_promise_cleanup` that defaults to `true` only when `new_promise_tracking` feature flag is set to `true`.  If disabled, this will help with performance of agent when an application has a lot of promises.  To disable, in your config set `feature_flag.unresolved_promise_cleanup` to `false` or pass in the environment var of `NEW_RELIC_FEATURE_FLAG_UNRESOLVED_PROMISE_CLEANUP=false` when starting application with agent.

  **WARNING**: If you set `unresolved_promise_cleanup` to `false`, failure to resolve all promises in your application will result in memory leaks even if those promises are garbage collected

* Supported using `connect` to route middleware calls.

* Removed stubbed out tests in memcached unit tests.

* Refactored `dropTestCollections` in mongo versioned tests to await for all `dropCollection` operations to be finished before closing connection and returning.

* Ported remaining mocha tests in `test/unit/instrumentation` to exclusively use tap.

* Added `@newrelic/eslint-config` to rely on a centralized eslint ruleset.

* Removed integration tests for oracle.

* Converted config unit tests to fully use tap API and extracted related tests into more-specific test files.

* Added a pre-commit hook to check if package.json changes and run `oss third-party manifest` and `oss third-party notices`.  This will ensure the `third_party_manifest.json` and `THIRD_PARTY_NOTICES.md` up to date

* Replaced `JSV` with `ajv` for JSON schema validation in tests.

* Removed `through` in lieu of core Node.js implementation of Transform stream in tests.
