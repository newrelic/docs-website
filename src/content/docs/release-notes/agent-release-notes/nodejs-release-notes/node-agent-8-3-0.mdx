---
subject: Node.js agent
releaseDate: '2021-09-09'
version: 8.3.0
features: ["Enable Distributed Tracing (DT) by default.","Add support for properly setting the `host` and `port` for mongodb requests that are to cluster.","Add several environment variables for the corresponding configuration items."]
bugs: ["Fix an issue where `.fastify` and `.default` properties would be missing from the `fastify` export when instrumented."]
security: []
downloadLink: 'https://www.npmjs.com/package/newrelic'
---

## Notes

* Enabled Distributed Tracing (DT) by default.
  * Added ability to configure the maximum number of spans that can be collected per minute via `span_events.max_samples_stored` and environment variable `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`.
  * Added supportability metric SpanEvent/Limit.

* Added support for properly setting the `host` and `port` for clustered MongoDB requests.

* Fixes issue where `.fastify` and `.default` properties would be missing from the `fastify` export when instrumented.

  Instrumentation now sets `.fastify` and `.default` properties to the wrapped `fastify` export function for fastify v3.

* Added the following environment variables for the corresponding configuration items:

  * **config item:** `transaction_events.max_samples_stored`
    **env var:** `NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`

  * **config item:** `custom_insights_events.max_samples_stored`
    **env var:** `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`

  * **config item:** `error_collector.max_event_samples_stored`
    **env var:** `NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`

* Converted several unit tests to use the tap API.

* Changed assertions for two HTTP error message tests to work with all versions of Node.js.
