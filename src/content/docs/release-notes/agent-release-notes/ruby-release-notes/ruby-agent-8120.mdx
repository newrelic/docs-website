---
subject: Ruby agent
releaseDate: '2022-10-26'
version: 8.12.0
downloadLink: 'https://rubygems.org/downloads/newrelic_rpm-8.12.0.gem'
features: ["Add Elasticsearch instrumentation", "Increase default custom event limit from 1000 to 3000 events per minute", "Deprecate support for Ruby 2.3"]
bugs: []
security: []
---

  ## v8.12.0

  Version 8.12.0 of the Ruby agent delivers new Elasticsearch instrumentation. Version 8.12.0 of the Ruby agent also increases the default number of recorded custom events, announces the deprecation of Ruby 2.3, and brings some valuable code cleanup.

  * **Support for Elasticsearch instrumentation**

    This release of the Ruby agent adds support to automatically instrument the [elasticsearch](https://rubygems.org/gems/elasticsearch) gem. Versions 7.x and 8.x are supported. [PR#1525](https://github.com/newrelic/newrelic-ruby-agent/pull/1525)

    | Configuration name | Default | Behavior |
    | ----------- | ----------- |----------- |
    | `instrumentation.elasticsearch` | auto | Controls auto-instrumentation of the elasticsearch library at start up. May be one of `auto`, `prepend`, `chain`, `disabled`. |
    | `elasticsearch.capture_queries` | true | If `true`, the agent captures Elasticsearch queries in transaction traces. |
    | `elasticsearch.obfuscate_queries` | true |  If `true`, the agent obfuscates Elasticsearch queries in transaction traces. |

  * **Custom Event Limit Increase**

    This version of the Ruby agent increases the default limit of custom events from 1000 events per minute to 3000 events per minute. If your custom events were being limited, this change will allow more custom events to be sent to New Relic. There is also a new configurable maximum limit of 100,000 events per minute. To change the limits, see the documentation for [max_samples_stored](https://docs.newrelic.com/docs/apm/agents/ruby-agent/configuration/ruby-agent-configuration/#custom_insights_events-max_samples_stored). To learn more about the change and how to determine if custom events are being dropped, see our Explorers Hub [post](https://discuss.newrelic.com/t/send-more-custom-events-with-the-latest-apm-agents/190497). [PR#1541](https://github.com/newrelic/newrelic-ruby-agent/pull/1541)

  * **Deprecate support for Ruby 2.3**

    Ruby 2.3 reached end of life on March 31, 2019. The Ruby agent has deprecated support for Ruby 2.3 and will make breaking changes for this version in its next major release, v9.0.0 (release date not yet planned). All 8.x.x versions of the agent will remain compatible with Ruby 2.3.

  * **Cleanup: Remove orphaned code**

    In both the agent and unit tests, changes have taken place over the years that have left certain bits of code unreachable. This orphaned code can complicate code maintenance and refactoring, so getting it squared away can be very helpful. Commmuniy member [@ohbarye](https://github.com/ohbarye) contributed two separate cleanup PRs for this release; one for the agent and one for the tests. [PR#1537](https://github.com/newrelic/newrelic-ruby-agent/pull/1537) [PR#1548](https://github.com/newrelic/newrelic-ruby-agent/pull/1548)

    Thank you to [@ohbarye](https://github.com/ohbarye) for contributing this helpful cleanup!


## Support statement

New Relic recommends that you upgrade the Ruby agent regularly and at a minimum of every 3 months. As of this release, the oldest supported version is [6.7.0.359](https://docs.newrelic.com/docs/release-notes/agent-release-notes/ruby-release-notes/ruby-agent-670359).
