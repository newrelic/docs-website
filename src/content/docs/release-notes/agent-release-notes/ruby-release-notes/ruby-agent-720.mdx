---
subject: Ruby agent
releaseDate: '2021-07-02'
version: 7.2.0
downloadLink: 'https://rubygems.org/downloads/newrelic_rpm-7.2.0.gem'
features: ["Add configuration options for expected/ignored errors by class name, status code, and message"]
bugs: ["Add logic to avoid conflicts with use of Module#Prepend", "Fix kwarg support for Rack middleware instrumentation", "Resolve error when adding a new key into hash during iteration"]
security: []
---

## v7.2.0

* **Expected Errors and Ignore Errors**
  This release adds support for configuration of expected/ignored errors by class name, status code, and message. The following configuration options are now available:
  * `error_collector.ignore_classes`
  * `error_collector.ignore_messages`
  * `error_collector.ignore_status_codes`
  * `error_collector.expected_classes`
  * `error_collector.expected_messages`
  * `error_collector.expected_status_codes`
    For more details about expected and ignored errors, please see our [configuration documentation](https://docs.newrelic.com/docs/agents/ruby-agent/configuration/)

* **Bugfix: resolves "can't add a new key into hash during iteration" Errors**

  Thanks to @wyhaines for this fix that prevents "can't add a new key into hash during iteration" errors from occuring when iterating over environment data.

* **Bugfix: kwarg support fixed for Rack middleware instrumentation**

  Thanks to @walro for submitting this fix. This fixes the rack instrumentation when using kwargs.

* **Update known conflicts with use of Module#Prepend**

  With our release of v7.0.0, we updated our instrumentation to use Module#Prepend by default, instead of method chaining. We have received reports of conflicts and added a check for these known conflicts. If a known conflict with prepend is detected while using the default value of 'auto' for gem instrumentation, the agent will instead install method chaining instrumentation in order to avoid this conflict. This check can be bypassed by setting the instrumentation method for the gem to 'prepend'.

## Support statement

New Relic recommends that you upgrade the agent regularly and at a minimum every 3 months. As of this release, the oldest supported version is [5.2.0.345](https://docs.newrelic.com/docs/release-notes/agent-release-notes/ruby-release-notes/ruby-agent-520345).
