---
subject: .NET agent
releaseDate: '2016-08-23'
version: 5.21.74.0
---

### Fixes

* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net) - New Requirement: Await-friendly asynchronous pipeline introduced in ASP.NET 4.5 must be turned on in your web config for the instrumentation of async methods. Without this configuration, async / await is undefined in ASP.NET and could result in intermittent drops of metrics or potential deadlocks. You may stop seeing some async metrics for your application unless you update its web.config file, as documented here: [https://docs.newrelic.com/docs/agents/net-agent/troubleshooting/missing-...](https://docs.newrelic.com/docs/agents/net-agent/troubleshooting/missing-async-metrics). For a brief description of this configuration, see the section here: [https://blogs.msdn.microsoft.com/webdev/2012/11/19/all-about-httpruntime...](https://blogs.msdn.microsoft.com/webdev/2012/11/19/all-about-httpruntime-targetframework/)
* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net): Fixed issue where High-security mode was filtering some attributes that are not sensitive.
* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net): Fixed an issue that could lead to missing external segments in some async transactions.
* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net): Fixed an issue in .NET 4.0 and older where in certain instances call stacks may not accurately get tracked due to ASP.NET thread agility.
* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net): Fixed issue where calling AgentApi.GetBrowserTimingHeader() did not prevent subsequent calls in the same transaction or auto browser injection from injecting duplicate JavaScript.
* [Async mode](https://docs.newrelic.com/docs/agents/net-agent/features/async-mode-net): Fixed issue where setting browser monitoring auto instrument to false would prevent NewRelic.Api.Agent.NewRelic.GetBrowserTimingHeader() from returning the header for manual injection.
* Enhanced the instrumentation for NServiceBus (receive side) so that when a service hosted by NServiceBus throws an unhandled exception while processing a service bus request, the New Relic Agent captures information about the error and generates an error trace.

### Upgrading

* For upgrade instructions, see [Upgrade the .NET agent](/docs/agents/net-agent/installation-configuration/upgrade-net-agent#updating_net).
* If you are upgrading from a particularly old agent, see [Upgrading legacy .NET agents](/docs/agents/net-agent/troubleshooting/upgrading-legacy-net-agents) for a list of major changes to the .NET agent.
