---
title: Prerequisites for AWS CCI
metaDescription: Set up AWS for CCI with consolidated billing, CUR, IAM roles, and region activation to optimize cost analysis in New Relic.
redirect:
    - /docs/cci/getting-started/prerequisites
freshnessValidatedDate: never
---

<Callout title="preview">
  We're still working on this feature, but we'd love for you to try it out!

  This feature is currently provided as part of a preview program pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Complete these prerequisites to set up Cloud Cost Intelligence with AWS.

## Prerequisites overview

Before you begin, ensure you have:

- ✅ AWS account with consolidated billing enabled
- ✅ S3 bucket created for Cost and Usage Reports
- ✅ Cost and Usage Report (CUR) configured
- ✅ IAM policy created for CCI access
- ✅ IAM role created for CCI to assume

---

## 1. Enable consolidated billing

Ensure [consolidated billing is set up for AWS Organizations](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/consolidated-billing.html) for unified cost management across your organization.

---

## 2. Create S3 bucket

Create an S3 bucket in the `us-east-2` region to store Cost and Usage Reports:

1. Sign in to **AWS Management Console** > **S3**
2. Click **Create bucket**
3. Enter unique bucket name (e.g., `your-company-billing`)
4. Configure: Enable versioning, Disable public access, Enable encryption
5. Click **Create bucket**

<Callout variant="important">
Save the bucket name - you'll need it for CCI integration.
</Callout>

---

## 3. Configure Cost and Usage Report

Create a Cost and Usage Report with these settings:

1. Go to **AWS Management Console** > **Billing Dashboard** > **Cost & Usage Analysis** > **Data Exports**
2. Click **Create**
3. Configure these required settings:
            <table>
                <thead>
                    <tr>
                        <th width={250}>
                        **Setting**
                        </th>
                    <th>
                        **Value**
                    </th>
                    <th>
                        **Description**
                    </th>
                    </tr>
                </thead>
                    <tbody>
                        <tr>
                        <td>Export Type</td>
                        <td>`Standard Data Export`</td>
                        <td>Detailed usage and cost information</td>
                        </tr>
                        <tr>
                        <td>Export Name</td>
                        <td>`Name`</td>
                        <td>Descriptive name (e.g., `<company-name>-billing-cci`)</td>
                        </tr>
                         <tr>
                        <td>Data Table</td>
                        <td>`CUR 2.0`</td>
                        <td>Latest FOCUS format table structure</td>
                        </tr>
                         <tr>
                        <td>Include Resource IDs</td>
                        <td>`ON`</td>
                        <td>Enables detailed resource-level cost tracking</td>
                        </tr>
                         <tr>
                        <td>Split Cost Allocation Data</td>
                        <td>`OFF`</td>
                        <td>Simplifies data structure unless detailed splits needed</td>
                        </tr>
                         <tr>
                        <td>Time granularity</td>
                        <td>`Hourly`</td>
                        <td>Required for detailed cost and usage analysis</td>
                        </tr>
                         <tr>
                        <td>Compression type</td>
                        <td>`Parquet`</td>
                        <td>Enhances query performance and reduces storage</td>
                        </tr>
                         <tr>
                        <td>File Versioning</td>
                        <td>`Create New Report Version`</td>
                        <td>Retains historical reports for auditing</td>
                        </tr>
                         <tr>
                        <td>Data Refresh Settings</td>
                        <td>`AUTOMATIC`</td>
                        <td>Keeps CUR data up-to-date automatically</td>
                        </tr>
                         <tr>
                        <td>Data Export Setting S3 Bucket</td>
                        <td>`Existing (Select bucket from Step 1)`</td>
                        <td>CUR files saved to S3 bucket. Agree to overwrite policy.</td>
                        </tr>
                         <tr>
                        <td>S3 path prefix</td>
                        <td>`cost-and-usage-reports`</td>
                        <td>Organizes CUR files within S3 bucket</td>
                        </tr>
                    </tbody>
            </table>

4. Click **Next** > **Create report**

<Callout variant="important">
Save the export name - you'll need it for CCI integration. Verify S3 path prefix is `cost-and-usage-reports`.
</Callout>

<Callout variant="caution">
First report delivers within 24 hours. Subsequent reports deliver periodically.
</Callout>

---

## 4. Create IAM policy

Create an IAM policy to grant CCI read-only access to your CUR data:

1. Go to **AWS Management Console** > **IAM** > **Policies**
2. Click **Create policy**
3. Switch to **JSON editor** and paste this policy:

    ```json
    {
    "Version": "2012-10-17",
    "Statement": [
        {
        "Action": ["s3:Get*", "s3:List*"],
        "Effect": "Allow",
        "Resource": [
            "arn:aws:s3:::<bucket-name>/*",
            "arn:aws:s3:::<bucket-name>"
        ],
        "Sid": "AccessMasterPayerBillingBucket"
        },
        {
        "Effect": "Allow",
        "Action": [
            "pricing:DescribeServices",
            "pricing:GetAttributeValues",
            "pricing:GetProducts",
            "pricing:GetPriceListFileUrl",
            "pricing:ListPriceLists"
        ],
        "Resource": ["*"]
        }
    ]
    }
    ```

4. Replace `<bucket-name>` with your actual S3 bucket name
5. Click **Next** > Name the policy `CCI-Access-Policy` > **Create policy**

<Callout variant="important">
Save the policy name - you'll attach it to the IAM role in the next step.
</Callout>

---

## 5. Create IAM role

Create an IAM role for CCI to assume and access your CUR data:

1. Go to **AWS Management Console** > **IAM** > **Roles**
2. Click **Create role**
3. Select **Custom Trust Policy** and paste this trust policy:
        ```json
        {
        "Version": "2012-10-17",
        "Statement": [
            {
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::207192125115:user/cci_global_user"
            },
            "Action": "sts:AssumeRole",
            "Condition": {
                "StringEquals": {
                "sts:ExternalId": "<externalID>"
                }
            }
            }
        ]
        }
        ```

4. Click **Next**
5. Attach the `CCI-Access-Policy` you created in step 4
6. Click **Next** > Name the role `CCI-Access-Role` > **Create role**
7. Copy the **Role ARN** from the role summary page

<Callout variant="caution">
The `externalId` in the trust policy will be generated when you start CCI integration. You'll update the trust policy with this ID during setup.
</Callout>

<Callout variant="important">
Save the Role ARN - you'll need it during CCI integration.
</Callout>

---

## Additional prerequisites

### Real-time cost estimation
Prerequisites for real-time cost estimation by instrumentation method:
<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
      <th>When to choose</th>
      <th>Prerequisites</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Infrastructure agent and integrations</td>
      <td>New Relic Infrastructure Agent for detailed monitoring</td>
      <td>Deep visibility for EC2, EKS/EC2, ECS/EC2</td>
      <td>
        Standalone EC2: Install infrastructure agent<br/>
        EKS/EC2: Install Kubernetes integration<br/>
        ECS/EC2: Install ECS integration (not supported for Fargate)
      </td>
    </tr>
    <tr>
      <td>Cloud integration (metrics)</td>
      <td>AWS CloudWatch metrics for near real-time monitoring</td>
      <td>Real-time data for dynamic environments</td>
      <td>Set up [Amazon CloudWatch Metric Streams](/install/aws-cloudwatch/)</td>
    </tr>
    <tr>
      <td>Cloud integration (polling) - legacy</td>
      <td>Polls AWS services at intervals</td>
      <td>Less frequent updates. Legacy option.</td>
      <td>Set up [AWS polling integrations](/docs/infrastructure/amazon-integrations/connect/set-up-aws-api-polling/)</td>
    </tr>
  </tbody>
</table>

### Kubernetes cost allocation

**Required:**
- [Install Kubernetes integration](https://docs.newrelic.com/install/kubernetes/) (AWS Fargate not supported)

**Recommended:**
- Add custom labels: `environment`, `team` (beyond standard Kubernetes labels: `app.kubernetes.io/name`, `app.kubernetes.io/instance`, `app.kubernetes.io/component`, `app.kubernetes.io/part-of`)
- Add custom resource tags: `project`, `costCenter`

These labels and tags enable better cost segmentation and analysis.

---

## Recommendations

- Configure [cost allocation tags](https://docs.aws.amazon.com/tag-editor/latest/userguide/tagging.html) in AWS
- Apply at least 2 custom resource tags consistently across resources
- Use S3 bucket in `us-east-2` region for optimal performance

---

## Access control

All users with access to your New Relic account can view AWS cloud cost data. Select an account that aligns with your internal access control policies.

<Callout variant="important">
New Relic requires read-only access to your S3 bucket, limited to a single IAM role. Maintain this access level to protect your data.
</Callout>