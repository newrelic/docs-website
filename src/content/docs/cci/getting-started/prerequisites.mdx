---
title: Prerequisites for CCI
metaDescription: Set up AWS for CCI with consolidated billing, CUR, IAM roles, and region activation to optimize cost analysis in New Relic.
freshnessValidatedDate: never
---

Prepare your AWS environment for Cloud Cost Intelligence (CCI) integration by following these prerequisites, including setting up consolidated billing, enabling cost and usage reports, configuring IAM roles and policies for secure access, and activating necessary AWS regions. Ensure your setup supports effective cost analysis and management within the New Relic platform.

## Prerequisites

<CollapserGroup>
  <Collapser
    id="aws-account-permissions"
    title="AWS account with appropriate permissions"
  >
    Before you integrate CCI with your AWS environment, ensure [consolidated billing is set up for AWS Organizations](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/consolidated-billing.html). This consolidates billing across all accounts in your organization for unified cost management.
  </Collapser>

  <Collapser
    id="s3-bucket-creation"
    title="S3 bucket for Cost and Usage reports"
  >
  AWS Cost and Usage Reports (CUR) will be stored in an S3 bucket. We recommend the S3 bucket to be created in the `us-east-2` region. Follow these steps to create a dedicated bucket:

    <Steps>
        <Step>
            Sign in to the <DNT>**AWS Management Console**</DNT>.
        </Step>
        <Step>
            Navigate to S3 service.
        </Step>
        <Step>
            Click **Create bucket**.
        </Step>
        <Step>
            Enter a unique bucket name (e.g `<your-company-name>-billing`).
        </Step>
        <Step>
            Configure bucket settings:
            <ul>
                <li>Enable versioning</li>
                <li>Disable public access (recommended)</li>
                <li>Enable default encryption (recommended)</li>
            </ul>
        </Step>
        <Step>
            **Tags (Optional)**: Add any tags if needed for your organization's resource management.
        </Step>
        <Step>
            Click **Create bucket**.
        </Step>
    </Steps>

    <Callout variant="important">
    Remember the bucket name as you'll need them in the following steps and installation steps on CCI.
    </Callout>
  </Collapser>

    <Collapser
    id="s3-bucket-creation"
    title="AWS Cost and Usage Reports configuration"
  >

  Create a Cost and Usage Report to be delivered to your S3 bucket:
    <Steps>
        <Step>
            Sign in to the <DNT>**AWS Management Console**</DNT>.
        </Step>
        <Step>
            Navigate to the <DNT>**Billing Dashboard**</DNT>.
        </Step>
        <Step>
            In the left navigation pane, click <DNT>**Cost & Usage Analysis**</DNT>.
        </Step>
        <Step>
            Click <DNT>**Data Exports**</DNT> and then <DNT>**Create**</DNT>.
        </Step>
        <Step>
            Configure report settings:
            <table>
                <thead>
                    <tr>
                        <th width={250}>
                        <DNT>
                        **Setting**
                        </DNT>
                        </th>
                    <th>
                        <DNT>
                        **Value**
                        </DNT>
                    </th>
                    <th>
                        <DNT>
                        **Description**
                        </DNT>
                    </th>
                    </tr>
                </thead>
                    <tbody>
                        <tr>
                        <td>
                            Export Type
                        </td>
                        <td>
                            `Standard Data Export`
                        </td>
                        <td>
                            Provides detailed information about usage and costs, suitable for most billing and cost analysis use cases.
                        </td>
                        </tr>
                    </tbody>
            </table>
        </Step>
        <Step>
            Click **Review and Complete** to finalize the report creation.
        </Step>
    </Steps>

  </Collapser>
</CollapserGroup>

- IAM policy for CCI access
- IAM role for CCI to assume

- [Enable Cost and Usage Reports (CUR) in your AWS Management account](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-reports-costusage.html) (also referred to as the Payer account) with the following settings:
    
    <table>
        <thead>
        <tr>
            <th width={250}>
            <DNT>
            **Setting**
            </DNT>
            </th>

        <th>
            <DNT>
            **Value**
            </DNT>
        </th>
        <th>
            <DNT>
            **Description**
            </DNT>
        </th>
        </tr>
        </thead>

        <tbody>
        <tr>
        <td>
            S3 bucket name
        </td>

        <td>
            `<your-company-name>-billing`
        </td>

        <td>
            Specifies where the CUR data will be stored. The naming convention helps identify the bucket's purpose and ownership.
        </td>
        </tr>

        <tr>
        <td>
            Export Type
        </td>

        <td>
            Standard Data Export
        </td>

        <td>
            Provides detailed information about usage and costs, suitable for most billing and cost analysis use cases.
        </td>
        </tr>

        <tr>
        <td>
            Report Versioning
        </td>

        <td>
            Create New Report Version
        </td>

        <td>
            Each update to the CUR creates a new version. This retains historical reports, which are useful for auditing and tracking cost changes over time.
        </td>
        </tr>

        <tr>
        <td>
            File Format
        </td>

        <td>
            Parquet
        </td>

        <td>
            A columnar storage file format that enhances query performance and reduces storage space, beneficial for processing large data volumes efficiently.
        </td>
        </tr>

        <tr>
        <td>
            Include Resource IDs
        </td>

        <td>
            ON
        </td>

        <td>
            Enables detailed tracking of costs associated with individual AWS resources, aiding in fine-grained analysis and billing.
        </td>
        </tr>

        <tr>
        <td>
            Data Refresh Settings
        </td>

        <td>
            AUTOMATIC
        </td>

        <td>
            Ensures that CUR data is kept up-to-date with the latest usage and cost information without manual intervention.
        </td>
        </tr>

        <tr>
        <td>
            Split Cost Allocation Data
        </td>

        <td>
            OFF
        </td>

        <td>
            If not specifically needed, keeping this option off simplifies the data structure. It avoids separating data based on custom cost categories or splits. This might be left off unless detailed cost allocation splits are necessary for your analysis.
        </td>
        </tr>
        </tbody>
    </table>

- Configure [cost allocation tags](https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html) in your AWS account. Tagging facilitates detailed and meaningful cost categorization.
- [Create a cross-account IAM policy granting read-only access to your CUR S3 bucket](https://us-east-1.console.aws.amazon.com/iam/home?region=us-east-1#/policies/details/arn%3Aaws%3Aiam%3A%3A017663287629%3Apolicy%2Fcco-finops-user-policy?section=permissions). Here’s a policy template for reference:
    ```json
    {
	"Version": "2012-10-17",
	"Statement": 
    [
		{
			"Action": 
            [
				"s3:Get*",
				"s3:List*"
			],
			"Effect": "Allow",
			"Resource": 
            [
				"arn:aws:s3:::nr-finops-team/*",
				"arn:aws:s3:::nr-finops-team"
			],
			"Sid": "AccessMasterPayerBillingBucket"
		},
		{
			"Effect": "Allow",
			"Action": 
            [
				"pricing:DescribeServices",
				"pricing:GetAttributeValues",
				"pricing:GetProducts",
				"pricing:GetPriceListFileUrl",
				"pricing:ListPriceLists"
			],
			"Resource": 
            [
				"*"
			]
		}
	]
    }
    ```
- [Create an IAM role and attach the above permission policy to it](https://us-east-1.console.aws.amazon.com/iam/home?region=us-east-1#/roles/details/cco-data-integrator-access?section=permissions).
- Add the New Relic global user (for example, `arn:aws:iam::707672555654:user/cco-s3-migration`) to the IAM role’s trust policy and provide role permissions. This is to allow the New Relic global user for CCI to assume the IAM role.
    ```json
    {
    "Version": "2012-10-17",
    "Statement": 
    [
        {
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::707672555654:user/cco-s3-migration"
            },
            "Action": "sts:AssumeRole",
            "Condition": {
                "StringEquals": {
                    "sts:ExternalId": "sgaxJF645eg5wOdTwh8M5EG6vLv5Ap5d"
                }
            }
        }
    ]
    }
    ```
    <Callout variant="important">
    If your resources are in AWS regions where Security Token Service (STS) is not active by default (for example, ap-east-1, eu-south-1), activate STS for those regions.
    </Callout>

## Prerequisites for real-time cost estimation
To enable real-time estimated cost viewing in CCI, ensure you meet the specific prerequisites associated with your instrumentation method:
<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
      <th>When to choose</th>
      <th>Prerequisites</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Infrastructure agent and integrations</td>
      <td>Uses the New Relic Infrastructure Agent for detailed monitoring.</td>
      <td>Select for deep visibility/control, ideal for standalone EC2, EKS/EC2, or ECS/EC2 setups.</td>
      <td>
        <ul>
          <li>If you have standalone EC2, install the New Relic infrastructure agent.</li>
          <li>If you have EKS/EC2, install the Kubernetes integration.</li>
          <li> If you have ECS/EC2, install the ECS integration. This method is not supported for AWS Fargate.</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Cloud integration (metrics)</td>
      <td>Utilizes AWS CloudWatch metrics for near real-time monitoring.</td>
      <td>Opt when real-time data is essential. Suitable for dynamic environments needing up-to-date insights.</td>
      <td> Set up [Amazon CloudWatch Metric Streams](/install/aws-cloudwatch/).</td>
    </tr>
    <tr>
      <td>Cloud integration (polling) - legacy</td>
      <td>Collects data by polling AWS services at intervals.</td>
      <td>Suitable for environments tolerating less frequent updates. Legacy option used when metrics-based approach is less feasible.</td>
      <td>Set up [AWS polling integrations](/docs/infrastructure/amazon-integrations/connect/set-up-aws-api-polling/).</td>
    </tr>
  </tbody>
</table>

## Access control advisory
All users with access to the designated New Relic account/organization can view your AWS cloud cost data within Cloud Cost Intelligence. We encourage you to carefully select the appropriate New Relic account/organization that aligns with your internal access control policies to ensure secure and compliant handling of cloud cost data.

<Callout variant="important">
**S3 bucket access**<p/>
New Relic only requires read access to your S3 bucket, and this access is limited to a single IAM role from the New Relic side. Ensure that this access level is maintained to protect your data while facilitating necessary operations.
</Callout>

## What's next
- [Set up CCI](/docs/cci/getting-started/setup)
- [Troubleshoot setup issues]()