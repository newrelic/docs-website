---
title: Cloud Cost Intelligence - Amazon Web Services
tags:
  - cloud cost intelligence
  - aws
  - amazon web services
  - aws cost management
  - cloud cost optimization
  - cci aws
metaDescription: Set up AWS for CCI with consolidated billing, CUR, IAM roles, and region activation to optimize cost analysis in New Relic.
redirect:
  - /docs/cci/prerequisites
  - /docs/cci/setup
freshnessValidatedDate: never
---

<Callout title="preview">
  We're still working on this feature, but we'd love for you to try it out!

  This feature is currently provided as part of a preview program pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Set up your AWS environment for Cloud Cost Intelligence by configuring consolidated billing, cost and usage reports, IAM roles and policies, and necessary AWS regions.

## Before you begin

### AWS account with appropriate permissions [#aws-account]

Ensure the [consolidated billing is set up for AWS Organizations](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/consolidated-billing.html).

## Setup instructions

<Steps>
  <Step>
    ### Create S3 bucket for Cost and Usage reports [#create-s3-bucket]

    Create an S3 bucket to store AWS Cost and Usage Reports (CUR). We recommend using the `us-east-2` region.

    1. Sign in to the **AWS Management Console**.
    2. Navigate to **S3 service** and click **Create bucket**.
    3. Enter a unique bucket name (e.g `<your-company-name>-billing`).
    4. Configure bucket settings:
        <ul>
            <li>Enable versioning</li>
            <li>Disable public access (recommended)</li>
            <li>Enable default encryption (recommended)</li>
        </ul>
    5. **Tags (Optional)**: Add any tags if needed for your organization's resource management and click **Create bucket**.

    <Callout variant="important">
    Remember the bucket name for the following steps.
    </Callout>
  </Step>

  <Step>
    ### Configure AWS Cost and Usage Reports [#create-cur]

    Create a **Cost and Usage Report** to be delivered to your S3 bucket:

    1. Sign in to the **AWS Management Console**.
    2. Navigate to **Billing Dashboard** > **Cost & Usage Analysis** > **Data Exports**, then click **Create**.
    3. Configure report settings:
            <table>
                <thead>
                    <tr>
                        <th width={250}>
                        **Setting**
                        </th>
                    <th>
                        **Value**
                    </th>
                    <th>
                        **Description**
                    </th>
                    </tr>
                </thead>
                    <tbody>
                        <tr>
                        <td>
                            Export Type
                        </td>
                        <td>
                            `Standard Data Export`
                        </td>
                        <td>
                            Detailed usage and cost information for billing and cost analysis.
                        </td>
                        </tr>
                        <tr>
                        <td>
                            Export Name
                        </td>
                        <td>
                            `Name`
                        </td>
                        <td>
                            Name for the CUR report (e.g., `<company-name>-billing-cci`).
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Data Table
                        </td>
                        <td>
                            `CUR 2.0`
                        </td>
                        <td>
                            Supports the latest FOCUS format table structure.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Include Resource IDs
                        </td>
                        <td>
                            `ON`
                        </td>
                        <td>
                            Enables detailed tracking of costs by individual AWS resources.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Split Cost Allocation Data
                        </td>
                        <td>
                            `OFF`
                        </td>
                        <td>
                            Simplifies data structure. Leave off unless detailed cost allocation splits are required.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Time granularity
                        </td>
                        <td>
                            `Hourly`
                        </td>
                        <td>
                           Required for detailed cost and usage analysis.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Compression type
                        </td>
                        <td>
                            `Parquet`
                        </td>
                        <td>
                            Columnar storage format that enhances query performance and reduces storage space.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            File Versioning
                        </td>
                        <td>
                            `Create New Report Version`
                        </td>
                        <td>
                            Creates a new version with each update, retaining historical reports for auditing.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Data Refresh Settings
                        </td>
                        <td>
                            `AUTOMATIC`
                        </td>
                        <td>
                            Keeps CUR data up-to-date automatically.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            Data Export Setting S3 Bucket
                        </td>
                        <td>
                            Select the bucket you created in [Create S3 bucket for Cost and Usage reports](#create-s3-bucket)
                        </td>
                        <td>
                            CUR files are saved in the S3 bucket. Agree to overwrite the policy.
                        </td>
                        </tr>
                         <tr>
                        <td>
                            S3 path prefix
                        </td>
                        <td>
                            `cost-and-usage-reports`
                        </td>
                        <td>
                            Organizes Cost and Usage Reports within the S3 bucket.
                        </td>
                        </tr>
                    </tbody>
            </table>

    4. Click **Next** and then **Create report**.

    <Callout variant="important">
    Remember the export name for CCI integration. Ensure the S3 path prefix is `cost-and-usage-reports`. First report delivers within 24 hours; subsequent reports deliver periodically.
    </Callout>
  </Step>

  <Step>
    ### Create IAM policy for CCI access [#create-iam-policy]

    Create an IAM policy that grants CCI permissions to access your CUR data:

    1. Sign in to **AWS Management Console**.
    2. Navigate to **IAM service** > **Policies** and click **Create policy**.
    3. Switch to the **JSON editor** and paste the following policy:

    ```json
    {
    "Version": "2012-10-17",
    "Statement": [
        {
        "Action": ["s3:Get*", "s3:List*"],
        "Effect": "Allow",
        "Resource": [
            "arn:aws:s3:::<bucket-name>/*",
            "arn:aws:s3:::<bucket-name>"
        ],
        "Sid": "AccessMasterPayerBillingBucket"
        },
        {
        "Effect": "Allow",
        "Action": [
            "pricing:DescribeServices",
            "pricing:GetAttributeValues",
            "pricing:GetProducts",
            "pricing:GetPriceListFileUrl",
            "pricing:ListPriceLists"
        ],
        "Resource": ["*"]
        }
    ]
    }
    ```
    <Callout variant="important">
    Replace `bucket-name` with your S3 bucket name from [Create S3 bucket for Cost and Usage reports](#create-s3-bucket).
    </Callout>
    4. Click **Next**.
    5. Name the policy `CCI-Access-Policy` (or your preferred name), add a description, and click **Create policy**.
  </Step>

  <Step>
    ### Create IAM role for CCI to assume [#create-iam-role]

    Create an IAM role that CCI will assume to access your CUR data:

    1. Sign in to **AWS Management Console**.
    2. Navigate to **IAM service** > **Roles** and click **Create role**.
    3. Select **Custom Trust Policy** in the trusted entity type section and paste the following role definition:
        ```json
        {
        "Version": "2012-10-17",
        "Statement": [
            {
            "Effect": "Allow",
            "Principal": {
                "AWS": "arn:aws:iam::207192125115:user/cci_global_user"
            },
            "Action": "sts:AssumeRole",
            "Condition": {
                "StringEquals": {
                "sts:ExternalId": "<externalID>"
                }
            }
            }
        ]
        }
        ```
    <Callout variant="important" title="Note">
    The `externalId` is generated when you start the CCI integration.
    </Callout>

    4. Click **Next**.
    5. Attach the policy created in [Create IAM policy for CCI access](#create-iam-policy) and click **Next**.
    6. Name the role `CCI-Access-Role` (or your preferred name), add a description (optional), and click **Create role**.
    7. Note the Role ARN from the role summary page.

    <Callout variant="important">
    You'll need the Role ARN during the CCI integration.
    </Callout>
  </Step>

  <Step>
    ### Access integration and select New Relic account [#access-integration]

    1. Go to **Cloud Cost Intelligence** on the left panel and click **Add the integration**.
    2. Select your New Relic account and click **Continue**.
  </Step>

  <Step>
    ### Provide connection details [#provide-connection-details]

    Enter the required details:
        - **Connection name** - Default name provided. Edit for custom name.
        - **Cross-account IAM role ARN** - IAM role ARN for Cloud Cost Intelligence to access your S3 bucket (format: `arn:aws:iam::<account-id>:role/<role-name>`).
        - **External ID** - Copy the external ID and add it to your IAM role trust policy in AWS.
        - **Data export name** - Name of the data export file. For report `cci-ingestion-test`, the path is `cost-and-usage-reports/cci-ingestion-test/data`.
        - **S3 bucket name** - Exact bucket name. Use `us-east-2` region for optimal performance.
  </Step>

  <Step>
    ### Configure trust policy [#configure-trust-policy]

    Add the New Relic global user (`arn:aws:iam::207192125115:user/cci_global_user`) to your IAM role trust policy:

  ```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Principal": {
          "AWS": "arn:aws:iam::207192125115:user/cci_global_user"
        },
        "Action": "sts:AssumeRole",
        "Condition": {
          "StringEquals": {
            "sts:ExternalId": "<externalID>"
          }
        }
      }
    ]
  }
  ```
    <Callout variant="important">
    Set `sts:ExternalId` to the external ID from [Provide connection details](#provide-connection-details). Activate STS for regions where it's not active by default (e.g., `ap-east-1`, `eu-south-1`).
    </Callout>
  </Step>

  <Step>
    ### Test connection [#test-connection]

    Click **Test connection** to verify connection to your AWS environment.

    <Callout variant="important">
    Initial data processing can take a few hours after setup.
    </Callout>
  </Step>
</Steps>

## Optional: Enable advanced features

Enable these optional features to enhance your AWS cost analysis.

### Real-time cost estimation [#real-time-cost-estimation]

To enable real-time estimated cost viewing in CCI, meet the prerequisites for your instrumentation method:

<table>
  <thead>
    <tr>
      <th>Method</th>
      <th>Description</th>
      <th>When to choose</th>
      <th>Prerequisites</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Infrastructure agent and integrations</td>
      <td>Uses the New Relic Infrastructure Agent for detailed monitoring.</td>
      <td>For deep visibility/control, ideal for standalone EC2, EKS/EC2, or ECS/EC2 setups.</td>
      <td>
        <ul>
          <li>Standalone EC2: Install the New Relic infrastructure agent.</li>
          <li>EKS/EC2: Install the Kubernetes integration.</li>
          <li>ECS/EC2: Install the ECS integration. Not supported for AWS Fargate.</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>Cloud integration (metrics)</td>
      <td>Utilizes AWS CloudWatch metrics for near real-time monitoring.</td>
      <td>When real-time data is essential for dynamic environments.</td>
      <td> Set up [Amazon CloudWatch Metric Streams](/install/aws-cloudwatch/).</td>
    </tr>
    <tr>
      <td>Cloud integration (polling) - legacy</td>
      <td>Collects data by polling AWS services at intervals.</td>
      <td>For environments tolerating less frequent updates.</td>
      <td>Set up [AWS polling integrations](/docs/infrastructure/amazon-integrations/connect/set-up-aws-api-polling/).</td>
    </tr>
  </tbody>
</table>

### Kubernetes cost allocation [#k8s-cost-allocation]

- [Install the Kubernetes integration](https://docs.newrelic.com/install/kubernetes/). AWS Fargate integration is not supported.
- Beyond standard Kubernetes labels (`app.kubernetes.io/name`, `app.kubernetes.io/instance`, `app.kubernetes.io/component`, and `app.kubernetes.io/part-of`), add custom labels such as `environment` and `team`, and custom resource tags such as `project` and `costCenter` for better cost segmentation and analysis.

## Recommendations

- Configure [cost allocation tags](https://docs.aws.amazon.com/tag-editor/latest/userguide/tagging.html) in your AWS account. Apply at least two custom resource tags consistently across AWS resources for effective cost filtering and grouping.
- Use an S3 bucket in the `us-east-2` region for optimal performance and cost efficiency.

## Access control advisory

All users with access to the designated New Relic account/organization can view your AWS cloud cost data. Select the appropriate New Relic account/organization that aligns with your internal access control policies.

<Callout variant="important">
**S3 bucket access**

New Relic only requires read access to your S3 bucket, limited to a single IAM role. Maintain this access level to protect your data.
</Callout>

<DocTiles numbered>
  <DocTile
    title="Set up AWS"
    label={{text: 'You are here', color: '#FCD672'}}
    path="/docs/cci/get-started/aws-cci"
  />

  <DocTile
    title="Set up Azure"
    path="/docs/cci/get-started/azure-cci"
  />

  <DocTile
    title="Set up Google Cloud Platform"
    path="/docs/cci/get-started/gcp-cci"
  />
</DocTiles>
