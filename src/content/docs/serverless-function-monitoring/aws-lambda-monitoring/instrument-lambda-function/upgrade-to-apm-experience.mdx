---
title: Upgrade to APM experience
metaDescription: Learn how to upgrade your Lambda monitoring to the New Relic APM experience.
freshnessValidatedDate: never
---

You can upgrade your existing Lambda functions to the new unified monitoring experience with minimal effort. This transition allows you to monitor your Lambda functions with enhanced observability capabilities of New Relic. You can instrument all your existing Lambda functions in bulk, or you can choose to upgrade them one at a time. The upgrade process is non-intrusive and does not require any code changes to your existing functions.

**Prerequisites**
            
* Your Lambda functions is already instrumented in New Relic.
* Your Lambda functions are running on either `python`, `nodejs`, `ruby`, `go`, or `.NET` runtime. To view the list of supported versions of these runtimes, refer to [compatibility and requirements docs](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/compatibility-requirement-lambda-monitoring/).

## Instrumentation methods

You can upgrade your existing Lambda functions using one of the following methods:

* [New Relic UI](#ui)
* [Update using CLIs](#cli)

<Callout variant="tip">
    New Relic recommends integrating your AWS account with New Relic using the [AWS integration](/docs/infrastructure/amazon-integrations/get-started/introduction-aws-integrations/) to automatically discover and monitor your Lambda functions. This allows you to leverage the full power of New Relic APM for your serverless functions.
</Callout>

#### New Relic UI [#ui]

You can upgrade your existing Lambda functions using the New Relic UI. 

**To upgrade your existing Lambda functions from New Relic platform, follow these steps:**

1. Go to [one.newrelic.com > All capabilities > Serverless Functions](https://one.newrelic.com/nr1-core?state=23b04845-da13-2b11-5826-9c20326276d9) > select your Lambda function entity.
2. On the Summary page, click **Instrument for APM**.
3. On the Lambda Function for APM page, provide the API key then click **Continue**.
4. By default, current Lambda entity is selected for upgrade. You can also select other Lambda functions to upgrade. Click **Generate New Relic CLI command**.
5. Copy the command and run it in your terminal or in your AWS terminal. The command will install the New Relic Lambda layer on your selected functions.
6. Click **Continue** to test the installation. The test will check whether the New Relic Lambda layer is installed correctly and whether the function is sending data to New Relic.
7. If the test is successful, you will see a success message. To view your Lambda function in the New Relic APM interface, click **See your data in APM**.

#### Update using CLIs [#cli]

<CollapserGroup>

    <Collapser
        id="nr-cli"
        title="New Relic CLI"
    >

<Callout variant="important">

Ensure that your New Relic CLI version is `0.9.8` or later. You can check your CLI version by running `newrelic-lambda --version`. If you need to update your CLI, update the CLI. For example, if you installed the CLI using `pip3`, you can update it with the following command:

```bash
    pip3 install --upgrade newrelic-lambda
```

</Callout>

1. To upgrade your Lambda function, use the `newrelic-lambda` CLI quickstart as shown here.
    ```bash
    newrelic-lambda layers install --nr-account-id YOUR_NEW_RELIC_ACCOUNT_ID --function my-function --upgrade --apm
    ```

    <Callout variant="tip">
        This command automatically finds the newest available layer for your Lambda's region and runtime.
    </Callout>

2. To migrate alerts from your existing Lambda functions to APM, run the following command:
    ```bash
    newrelic-lambda apm alerts-migrate \
        --nr-account-id <YOUR_NEW_RELIC_ACCOUNT_ID> \
        --nr-api-key <YOUR_NEW_RELIC_API_KEY>
        --function <YOUR_LAMBDA_FUNCTION_NAME>
    ```

    </Collapser>
    <Collapser
        id="cdk"
        title="For AWS CDK, AWS SAM, or Terraform"
    >

    1. Update to [latest New Relic Lambda layer](https://layers.newrelic-external.com/) for your project using [AWS CDK](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cdk), [AWS SAM](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cloudformation), or [Terraform](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#terraform).
    2. Set the `NEW_RELIC_APM_LAMBDA_MODE` [environment variable](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/env-variables-lambda/) to `true` in your Lambda function configuration. This enables the APM mode for the New Relic Lambda layer.
    3. Deploy your Lambda function with the updated configuration.
    4. In the <DNT>Configuration</DNT> tab of your <DNT>AWS Management Console</DNT>, add the `NR.Apm.Lambda.Mode: true` tag to your Lambda function.

    </Collapser>

    </CollapserGroup>


## Update existing Lambda alerts and dashboards  [#alerts-dashboards]

After you upgrade your existing Lambda functions to `APM + Serverless Convergence`, it's crucial to update the NRQL queries in your alert conditions and dashboard widgets. This new upgrade changes the metric paths for your Lambda data. Modifying your queries is necessary to ensure your alerts and dashboards use these new paths and continue to provide accurate monitoring and notifications. This is required for any existing Lambda functions that you have transitioned to `APM + Serverless Convergence`.


* For alerts, review your existing Lambda alert conditions. Update any NRQL queries that use metrics sourced from layers with the new metrics. For more information on how to update your alert conditions, refer to the [Update an alert](https://docs.newrelic.com/docs/alerts/create-alert/create-alert-condition/alert-conditions/#edit-existing-alert-condition).

* For dashboards, review your existing Lambda dashboard widgets. Update any NRQL queries that use metrics sourced from layers with the new metrics. For more information on how to update your dashboard widgets, refer to the [manage dashboard](https://docs.newrelic.com/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard/).


## Find and use data [#find-data]

After you instrument your AWS Lambda functions, you can find and use the data in the New Relic APM interface. The data is organized into several key areas, each providing different insights into the performance and health of your Lambda functions.

In the APM interface, you can explore various aspects of your Lambda functions including [distributed tracing](/docs/distributed-tracing/concepts/introduction-distributed-tracing/), [service maps](/docs/new-relic-solutions/new-relic-one/ui-data/service-maps/service-maps/), [transactions](/docs/apm/transactions/intro-transactions/transactions-new-relic-apm/), and [error analysis](/docs/errors-inbox/getting-started/), and many more. Each of these areas provides detailed insights into the performance, latency, and error rates of your Lambda functions, allowing you to quickly identify and resolve issues.

<Callout variant="tip">

The Invocation experience is now integrated with APM transaction traces. This allows you to use a specific `AWS RequestId` to drill-down into an APM transaction trace for detailed information about that particular Lambda execution.

</Callout>

To view your Lambda functions in the New Relic APM interface:

1. Go to <DNT>[https://one.newrelic.com](https://one.newrelic.com) > APM & Services</DNT>.
2. Set the search criteria as `isLambdaFunction = true`.
3. From the displayed list, select your Lambda Function to view the data.


<Callout variant="tip">

The New Relic APM UI does not display historical data for Lambda functions that were instrumented before the `APM + Serverless Convergence` upgrade. To view the historical data, click the **see serverless functions** option in the <DoNotTranslate>APM Summary</DoNotTranslate> page.

</Callout>


### Rollback [#rollback]

If you need to revert your Lambda functions back to the previous serverless monitoring experience, you can do so by setting the `NEW_RELIC_APM_LAMBDA_MODE` environment variable to `false`.



## Related articles [#related-docs]

<DocTiles>
  <DocTile title="Compatibility and requirement" path="/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/compatibility-requirement-lambda-monitoring">Learn more about supported runtimes and prerequisites</DocTile>
  <DocTile title="Troubleshooting" path="/docs/serverless-function-monitoring/aws-lambda-monitoring/troubleshooting/troubleshoot-enabling-serverless-monitoring-aws-lambda" >Learn how to troubleshoot installation related issues</DocTile>
</DocTiles>
