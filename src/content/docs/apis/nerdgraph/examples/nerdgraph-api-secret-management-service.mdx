---
title: "NerdGraph tutorial: Secrets management service"
metaDescription: "Learn how to use the Secrets management service to securely store and manage your secrets."
freshnessValidatedDate: never
---

When you're working with New Relic, you might need to store sensitive information like API keys and application credentials. In New Relic, these are called secrets. The <dnt>Secrets management service</dnt> provides a secure way to store and retrieve these secrets in a centralized location through our [NerdGraph API](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/).

<Callout variant="important">

You can store secrets only in string format.

</Callout>

The key features of the <dnt>Secrets management service</dnt> are:

* **Unique keys for secrets**: You can prevent accidental exposure of secrets by assigning a unique key to each one when storing. Use the key to retrieve and manage the secrets.

* **Secrets stored  at [account or organization level](/docs/accounts/accounts-billing/account-structure/new-relic-account-structure/)**:
To access and use a secret across multiple accounts, you can store it at the organization level. If a secret is specific to a single account, you can store it at the account level.

* **Versions of secrets**: You can update a secret without losing the previous version. The <dnt>Secrets management service</dnt> tracks all versions of a secret.

* **Controlled deletion and recovery of secrets**: The service allows recoverable deletion of secrets. Users without the Purge permission can soft-delete secrets. Permanent deletion is restricted to users with the Purge permission.

* **Access control**: Admins can define who can access the secrets by setting custom roles and permissions, and specifying the scope of permissions. The scope can range from <dnt>**View**</dnt> to <dnt>**Purge**</dnt> permissions. For secrets requiring stricter access control, you can use sharable secrets with fine-grained access.

* **Sharable secrets with fine-grained access control**: Beyond standard secrets accessible to all users in an account or organization, you can create sharable secrets that are private by default. With sharable secrets, you control exactly who can read, update, or delete each secret by granting access to specific users, groups, or system identities.

## Secrets management services billing [#secrets-management-services-billing]

The <dnt>Secrets management service</dnt> is an Advanced Compute Product feature offered as an [add-on](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/add-on-billing) or as a part of the Compute pricing model. Advanced [CCUs](/docs/licenses/license-information/product-definitions/new-relic-one-pricing-definitions/#compute-capacity-unit) are consumed when NerdGraph queries are executed to store, retrieve, or manage secrets.

## Access control[#security-and-access-control]

Users with [standard roles](/docs/accounts/accounts-billing/new-relic-one-user-management/user-management-concepts/#standard-roles) can access the <dnt>Secrets management service</dnt> specific to the accounts they have access to, with the following permissions.

* **Read Only**: Users can only retrieve secrets. They can't create, update, or delete secrets.

* **Standard User**: Users can create, update, retrieve, and soft-delete secrets.

* **All Product Admin**: Users have full access to the <dnt>Secrets management service</dnt>. They can create, update, retrieve, soft-delete, permanently delete, and fetch the list of secrets.

* **Billing User**: Users can only fetch the list of secrets.


To manage secrets at the account level with a non-standard role, ask your admin to [create a custom role](/docs/accounts/accounts-billing/new-relic-one-user-management/account-user-mgmt-tutorial/#roles) with the necessary permissions, and assign them to your user group.

For managing secrets at the organization level, ask your admin to create an [org-scoped custom role via the NerdGraph API](https://docs.newrelic.com/docs/apis/nerdgraph/examples/nerdgraph-manage-groups/#create-role), add the required permissions, and assign it to the user group. [Organization Manager](/docs/accounts/accounts-billing/new-relic-one-user-management/user-management-concepts/#admin-settings) have default permissions at the organization level, but to allow them to manage secrets, ask your admin to assign them a custom role specific to the <dnt>Secrets management service</dnt>.

<Callout variant="important">

Setup and configure the users, roles, permissions, and access to the <dnt>Secrets management service</dnt> at the account and organization level, in accordance with your organization policies and requirements.

</Callout>

## Sharable secrets with fine-grained access [#sharable-secrets]

When you store secrets at the account or organization level using standard secrets, all users with access to that account or organization can access and manage those secrets. For enterprise customers, this is a security concern because within an enterprise, multiple teams work on different projects. Each team or individual has secrets specific to their tasks. Exposing these secrets to a wider audience is not advisable and might lead to a security risk.

Sharable secrets solve this problem by giving you precise control over who can access your sensitive data within your account or organization. With sharable secrets, you create private secrets that only authorized users, groups, or system identities can access.

### How it works

**Privacy by default**

When you create a sharable secret using the `secretsManagementCreateSharableSecret` mutation, the secret is private by default. No one else in the account or organization can access it until you explicitly grant permission.

**Automatic ownership**

The user who creates the sharable secret automatically becomes the secret owner. This ownership is recorded as an explicit grant in the backend. As the owner, you have full control to read, update, delete the secret, and grant or revoke permissions for other entities.

**Granular access control**

The owner can grant access to a grantee, which can be a user, group, system identity, or system identity group. You can assign specific functional permissions:

* **Read**: Allows the grantee to retrieve the secret value
* **Update**: Allows the grantee to change the secret value
* **Delete**: Allows the grantee to remove the secret

You can also use standard roles to simplify access:

* **Secret Owner**: Grants full control (read, update, delete, grant/revoke)
* **Secret Reader**: Grants read-only access

Additionally, you can define custom roles to assign limited access based on responsibility.

**Scope and admin access**

Sharable secrets can be created at either the account level or the organization level. Organization admins retain full access to all sharable secrets within their scope for necessary oversight and management.

## Pre-requisites [#prerequisites]
 
To use the <dnt>Secrets management service</dnt>, you need:

 * The [Advanced Compute](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/add-on-billing) pricing plan
 * A [New Relic account](https://newrelic.com/signup)
 * Your API user key for [queries and mutations]((https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#terminology))
 
User type and assigned roles can affect your NerdGraph permissions. For more details, refer [Factors affecting access](https://docs.newrelic.com/docs/accounts/accounts-billing/account-structure/factors-affecting-access-features-data/#user-permissions).

## Use the <dnt>Secrets management service</dnt> [#use-secrets-management-service]
From the [NerdGraph Explorer](/docs/apis/nerdgraph/get-started/nerdgraph-explorer/), use [mutations and queries](/docs/accounts/accounts-billing/account-structure/factors-affecting-access-features-data/#user-permissions) to interact with the <dnt>Secrets management service</dnt>.

Here are the common attributes you will use in the mutations and queries:

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `description`
            </td>
            <td>
            String
            </td>
            <td>
             A brief description of the secret.
            </td>
        </tr>

        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
             A unique identifier for the secret within a namespace. The same key can exist across different namespaces.
            </td>
        </tr>

        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
             Serves as a logical grouping of secrets, organizing and categorizing them to enhance management and prevent conflicts. It pairs with the key to create a unique address for the secret. This attribute is beneficial in environments with multiple teams or projects using New Relic.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            * `type`: Enum
            * `id`: string
            </td>
            <td>
            
            
            The scope of storing the secrets in terms of its accessibility. The defining attributes are:
             * `type`: To use the secret across multiple accounts, select `Organization`. If the secret is specific to a single account, select `Account`. To store a secret at the organization level, you must have the [org-scoped custom role](https://docs.newrelic.com/docs/apis/nerdgraph/examples/nerdgraph-manage-groups/#create-role) with the required permissions. Refer to the [Access control](#security-and-access-control) section for more details.
             
             * `id`: Corresponding account or organization ID.
            </td>
        </tr>

          <tr>
            <td>
            `tags`
            </td>
            <td>
            Array
            </td>
            <td>
             Functions as key-value pairs that add metadata to your entities, including applications, services, and hosts. Using tags you can enhance the ability to organize, filter, and manage secrets.
            </td>
        </tr>
        <tr>
            <td>
            `value`
            </td>
            <td>
            String
            </td>
            <td>
             The actual secret.
            </td>
        </tr>
       <tr>
            <td>
            `purge`
            </td>
            <td>
            Boolean
            </td>
            <td>
            Deletes all versions of the secret.
            * `true`: Deletes the secret permanently.
            * `false`: You can recover the deleted secret with all its versions.

            Only All Product Admins or a user having a custom role with `purge` permission can delete secrets permanently. For more details, refer to the [Access control](#security-and-access-control) section.
            </td>
        </tr>
        <tr>
            <td>
            `version`
            </td>
            <td>
            String
            </td>
            <td>
            As you can store multiple versions of a secret, it represents the version number of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `cursor` (Optional)
            </td>
            <td>
            String
            </td>
            <td>

            When retrieving a list of secrets, if the response contains the `nextCursor` attribute, it indicates that there are more secrets available beyond the current page of results. To access the next page of results, use the `nextCursor` value in the `cursor` attribute and run the query again.
            </td>
        </tr>                        
    </tbody>
</table>

<Callout variant="important">
Copy your actual secret only into the `value` attribute. Ensure it is not declared in any other attributes, such as `description`, `key`, or `namespace`.

</Callout>

### Operations[#operations]

The operations you can perform with the <dnt>Secrets management service</dnt> are as follows:

<Callout variant="tip">
**Choosing between standard and sharable secrets:**

* Use **standard secrets** (`secretsManagementCreateSecret`) when you want to share a secret with all users who have access to the account or organization.
* Use **sharable secrets** (`secretsManagementCreateSharableSecret`) when you need to control exactly who can access a secret by granting permissions to specific users, groups, or system identities.
</Callout>

<CollapserGroup>
  <Collapser
  id="create-secret"
  title="Store a secret">

Use the `secretsManagementCreateSecret` mutation with the following parameters to store a standard secret that will be accessible to all users with permissions in the specified account or organization. 


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `description` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Give a description for the secret.
            </td>
        </tr>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Assign a unique key for the secret.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Assign a name if you want to store the secret in a specific namespace.
            </td>
        </tr>
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Based on your [role](#security-and-access-control) and requirements, select `Account` or `Organization`.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>

          <tr>
            <td>
            `tags` (Optional)
            </td>
            <td>
            Array
            </td>
            <td>
             Assign a key and value pair.
            </td>
        </tr>
        <tr>
            <td>
            `value` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Enter the actual secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementCreateSecret(
    description: "ZXY"
    key: "Test2"
    scope: {id: 1, type: ACCOUNT}
    value: "1990@123"
    namespace: "Namespace1"
  )
}

```



### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description`
            </td>
            <td>
            The description of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The assigned key.
            </td>
        </tr>                  
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The version of the secret. If you have created a new secret, the version will be `0`.
            </td>
        </tr>
        <tr>
            <td>
            `metadata`
            </td>
            <td>
            Associated metadata with the secret, if any.
            </td>
        </tr>        
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `tags`
            </td>
            <td>
            The key and value pair associated with the secret, if any.
            </td>
        </tr>               
        

    </tbody>
</table>

#### Sample response:
    
    ```json
 {
  "data": {
    "secretsManagementCreateSecret": {
      "description": "ZXY",
      "key": "Test2",
      "latestVersion": 0,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  }
    ```


      </Collapser>

<Collapser
  id="create-sharable-secret"
  title="Create a sharable secret">

Use the `secretsManagementCreateSharableSecret` mutation to create a private secret with fine-grained access control. When you create a sharable secret, you automatically become the owner with full control over who can access it.

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `description` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Give a description for the secret.
            </td>
        </tr>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Assign a unique key for the secret.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Assign a name if you want to store the secret in a specific namespace.
            </td>
        </tr>
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Based on your [role](#security-and-access-control) and requirements, select `Account` or `Organization`.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>

          <tr>
            <td>
            `tags` (Optional)
            </td>
            <td>
            Array
            </td>
            <td>
             Assign a key and value pair.
            </td>
        </tr>
        <tr>
            <td>
            `value` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Enter the actual secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementCreateSharableSecret(
    description: "Private API key for production"
    key: "prod-api-key"
    scope: {id: 1, type: ACCOUNT}
    value: "sk_live_abc123xyz"
    namespace: "production"
  )
}

```



### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description`
            </td>
            <td>
            The description of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The assigned key.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The version of the secret. If you've created a new secret, the version will be `0`.
            </td>
        </tr>
        <tr>
            <td>
            `metadata`
            </td>
            <td>
            Associated metadata with the secret, if any.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>
        <tr>
            <td>
            `tags`
            </td>
            <td>
            The key and value pair associated with the secret, if any.
            </td>
        </tr>


    </tbody>
</table>

#### Sample response:

    ```json
 {
  "data": {
    "secretsManagementCreateSharableSecret": {
      "description": "Private API key for production",
      "key": "prod-api-key",
      "latestVersion": 0,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  }
    ```

<Callout variant="tip">
After creating a sharable secret, you become the owner automatically. To grant access to other users, groups, or system identities, use the `authorizationManagementGrantAccess` mutation. For more details, see the [Grant access to a sharable secret](#grant-access-sharable-secret) section.
</Callout>

      </Collapser>

<Collapser
  id="retrieve-secret"
  title="Retrieve a secret"
  >

Use the `{customerAdministration {secret}}` query to retrieve secrets along with their details. You can retrieve secrets that are scoped only for your current account or organization.


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>


        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Key of the secret that you want to retrieve.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
            The namespace of the secret, if available.
            </td>
        </tr>

        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select `account` or `organization` in which level the secret is stored.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>

        <tr>
            <td>
            `unlock` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             The default value `false` returns the metadata of the secret without unlocking it. If you want to unlock the secret and retrieve its actual value, set it to `true`.
            </td>
        </tr>
        <tr>
            <td>
            `version` (Optional)
            </td>
            <td>
            Integer
            </td>
            <td>
             Enter a specific version of the secret that you want to retrieve. If you do not provide a version, the latest version will be retrieved.
            </td>
        </tr>


    </tbody>
</table>

#### Sample query:

```graphql
{
  customerAdministration {
    secret(key: "Test2", scope: {id: 1, type: ACCOUNT}, unlock: true)
  }
}
```

### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description`
            </td>
            <td>
            The description of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `metadata`
            </td>
            <td>
            Associated metadata with the secret, if any.
            </td>
        </tr>  
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `retrievedValue`
            </td>
            <td>
            * `value`: The actual secret value, if `unlock` is set to `true`.
            * `version`: The version of the secret.
            </td>
        </tr>                                         

        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `tags`
            </td>
            <td>
            The key and value pair associated with the secret, if any.
            </td>
        </tr>               
        

    </tbody>
</table>

#### Sample response:
    
    ```json
 {
  "data": {
    "customerAdministration": {
      "secret": {
        "description": "ZXY",
        "key": "Test2",
        "namespace": null,
        "retrievedValue": {
          "value": "1995@123",
          "version": 1
        },
        "scope": {
          "id": "1",
          "type": "ACCOUNT"
        }
      }
    }
  }
    ```

</Collapser>

<Collapser 
  id="update-secret" 
  title="Update a secret">

Use the `secretsManagementUpdateSecret` mutation to update the value of existing secrets.

<Callout variant="tip">
Each update operation creates a new version of the secret. The highest version is always the latest version of the secret. To retrieve older versions of the secret, you can use the `{customerAdministration {secretVersions}}` query. For more details, refer to the [Retrieve all version information of a secret](#retrieve-secret-versions) section.
</Callout>

#### Input Parameters

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Add a description if you want to update the existing one.
            </td>
        </tr>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Enter the key of the secret for which you want to update the value.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Namespace of the secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select `Account` or `Organization` in which level the secret is stored.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>
        <tr>
            <td>
            `value` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             The updated value for the secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementUpdateSecret(
    key: "Test2"
    scope: {id: 1, type: ACCOUNT}
    value: "1995@123"
  )
}
```

### Response

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description`
            </td>
            <td>
            Updated description of the secret, if provided.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>                  
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The latest version number of the secret after the update.
            </td>
        </tr>
        <tr>
            <td>
            `metadata`
            </td>
            <td>
            Associated metadata with the secret, if any.
            </td>
        </tr>        
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if any.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `tags`
            </td>
            <td>
            The key and value pair associated with the secret, if any.
            </td>
        </tr>               
        

    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementUpdateSecret": {
      "description": "ZXY",
      "key": "Test2",
      "latestVersion": 1,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  }
```

</Collapser>

<Collapser
  id="retrieve-secret-versions"
  title="Retrieve all version information of a secret"
  >

Use the `{customerAdministration {secretVersions}}` query to retrieve up to 10 recent versions of a secret along with their details. You can retrieve secrets that are scoped only to your current account or organization.


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>


        <tr>
            <td>
            `fetchDeleted` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             To get only the non-deleted versions of the secret, set it to `false`. To get versions of the secret, including the soft-deleted ones, set it to `true`.
            </td>
        </tr>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             Key of the secret that you want to retrieve.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
            The namespace of the secret, if available.
            </td>
        </tr>

        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select `account` or `organization` in which level the secret is stored.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>


    </tbody>
</table>

#### Sample query:

```graphql
{
  customerAdministration {
    secretVersions(fetchDeleted: true, key: "Test2", scope: {id: 1, type: ACCOUNT})
  }
}
```

### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The latest version number of the secret.
            </td>
        </tr>  
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if provided.
            </td>
        </tr>                               

        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>     
        <tr>
            <td>
            `secretVersions`
            </td>
            <td>
            An array of objects containing the details of each version of the secret, including:
            * `createdAt`: Timestamps indicating when each version was created.
            * `isDeleted`: Indicates whether the secret version is deleted or not.
            * `version`: The version number of the secret.

            </td>
        </tr>               
        

    </tbody>
</table>

#### Sample response:
    
    ```json
{
  "data": {
    "customerAdministration": {
      "secretVersions": {
        "key": "Test2",
        "latestVersion": 1,
        "namespace": null,
        "scope": {
          "id": "1",
          "type": "ACCOUNT"
        },
        "secretVersions": [
          {
            "createdAt": "2025-05-26T07:52:23.920250Z",
            "isDeleted": false,
            "version": 1
          },
          {
            "createdAt": "2025-05-26T07:45:19.395796Z",
            "isDeleted": false,
            "version": 0
          }
        ]
      }
    }
  }
    ```

</Collapser>

<Collapser 
    id="delete-secrets" 
    title="Delete a secret">


Use the `secretsManagementDeleteSecret` mutation to delete all versions of a secret. Only All Product Admins or a user having a custom role with `purge` permission can choose to delete secrets permanently. Other users can't delete secrets permanently. If you have not deleted the secret permanently, you can [recover it](#recover-secrets) using the `secretsManagementRecoverSecret` mutation.


#### Input attributes

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             The key for the secret that you want to delete.
            </td>
        </tr>
        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Namespace of the secret, if available.
            </td>
        </tr>   
        <tr>
            <td>
            `purge` (Required)
            </td>
            <td>
            Boolean
            </td>
            <td>
             To delete the secret permanently,set the value to `true` . For soft deletion, set the value to `false`.
            </td>
        </tr>             
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select the level at which your secret is stored.
             * `id`: Enter the corresponding account or organization ID.
            </td>
        </tr>

    </tbody>
</table>

#### Sample query:

```graphql

mutation {
  secretsManagementDeleteSecret(
    key: "Test1"
    scope: {id: 1, type: ACCOUNT}
    purge: false
  )
}

```


### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the deleted secret.
            </td>
        </tr>             
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the deleted secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the deleted secret.
            </td>
        </tr>                   
        

    </tbody>
</table>


#### Sample response:

```json
{
  "data": {
    "secretsManagementDeleteSecret": {
      "key": "Test1",
      "namespace": null,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  },
```
  </Collapser>

<Collapser
  id="recover-secrets"
  title="Recover a secret"
>

Use `secretsManagementRecoverSecret` mutation to recover secrets that you have deleted using the `secretsManagementDeleteSecret` mutation before with the `purge` attribute set to `false`. If a secret is permanently deleted, you can't recover it.

#### Input attributes

  <table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             The key for the secret that you want to recover.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             The namespace of the deleted secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select `Account` or `Organization` in which level the secret was stored.
             * `id`: Enter the corresponding ID of the account or organization.
            </td>
        </tr>

    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementRecoverSecret(key: "Test1", scope: {id: 1, type: ACCOUNT})
}
```

### Response

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the recovered secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The latest version of the recovered secret.
            </td>
        </tr>                       
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the recovered secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the recovered secret.
            </td>
        </tr>                   
        

    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementRecoverSecret": {
      "key": "Test1",
      "latestVersion": 1,
      "namespace": null,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  }
```

</Collapser>

<Collapser 
  id="delete-secrets-version"
  title="Delete a specific version of a secret"
>  



Use the `secretsManagementDeleteSecretVersion` mutation to delete a specific version of a secret. Only All Product Admins or a user having a custom role with `purge` permission can choose to delete it permanently. Other users can't delete the secret version permanently. If you have not deleted the secret version permanently, you can [recover it](#recover-secrets-versions) using the `secretsManagementDeleteSecretVersion` mutation.



#### Input attributes


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             The key of the secret for which you want to delete one of the versions.
            </td>
        </tr>
        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Namespace of the secret, if available.
            </td>
        </tr>   
        <tr>
            <td>
            `purge` (Required)
            </td>
            <td>
            Boolean
            </td>
            <td>
             To delete the secret version permanently, set the value to `true`. For soft deletion, set the value to `false`.
            </td>
        </tr>             
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select the level at which your secret is stored.
             * `id`: Enter the corresponding ID of the account or organization.
            </td>
        </tr>
        <tr>
            <td>
            `version` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
            The specific version of the secret that you want to delete. If you do not provide a version, the latest version will be deleted, and the previous version will become the latest version.
            </td>
        </tr>
    </tbody>
</table>


#### Sample query:

```graphql

mutation {
  secretsManagementDeleteSecretVersion(
    key: "Test2"
    purge: false
    scope: {id: 1, type: ACCOUNT}
    version: 0
  )
}

```

### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The latest version of the secret available after deletion of the specified version.
            </td>
        </tr>                       
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>                   
        

    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementDeleteSecretVersion": {
      "key": "Test2",
      "latestVersion": 1,
      "scope": {
        "id": "1"
      }
    }
  }
```
</Collapser>

<Collapser
  id="recover-secrets-versions"
  title="Recover a secret version"
>

Use `secretsManagementRecoverSecretVersion` mutation to recover a specific version of the secret that you have soft-deleted using the `secretsManagementDeleteSecretVersion` mutation. If a version is permanently deleted, you can't recover it.

#### Input attributes

  <table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `key` (Required)
            </td>
            <td>
            String
            </td>
            <td>
             The key of the secret for which you want to recover one of the versions.
            </td>
        </tr>

        <tr>
            <td>
            `namespace` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             The namespace of the secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope` (Required)
            </td>
            <td>
            <td>
            `type`: Enum
            `id`: string
            </td>
            </td>
            <td>

             * `type`: Select `Account` or `Organization` in which level the secret belongs.
             * `id`: Enter the corresponding ID of the account or organization.
            </td>
        </tr>

        <tr>
            <td>
            `version` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Enter the version number of the secret that you want to recover. If you do not provide a version, it recovers the highest version of the secret that was soft-deleted.
            </td>
        </tr>        

    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementRecoverSecretVersion(
    key: "Test2"
    scope: {id: 1, type: ACCOUNT}
    version: 0
  )
}
```

### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            The latest version of the secret after recovery.
            </td>
        </tr>                       
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            The namespace of the secret, if available.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>                   
        

    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementRecoverSecretVersion": {
      "key": "Test2",
      "latestVersion": 1,
      "namespace": null,
      "scope": {
        "id": "1",
        "type": "ACCOUNT"
      }
    }
  }
```

</Collapser>

<Collapser
  id="secret-list"
  title="Retrieve the list of secrets"
  >

Use the `{customerAdministration {secrets}}` query to retrieve a list of secrets available in the account or organization. You can retrieve secrets that are scoped only for your current account or organization.

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>


        <tr>
            <td>
            `cursor` (Optional)
            </td>
            <td>
            String
            </td>
            <td>
             Use the `cursor` to navigate through secret lists. To get the first page of the secret list this parameter is not required. If you want to access the next page, use the `NextCursor` value from the previous response.
            </td>
        </tr>

        <tr>
            <td>
            `filter` (Required)
            </td>
            <td>
            * `deleted` (Optional): Boolean
            * `namespace` (Optional): String
            * `scope` (Required)
                * `type`: Enum
                * `id`: string

            </td>
            <td>
             Add the following filter to apply the search criteria:
             * `deleted`: To get all the secrets including the soft-deleted ones, set it to `true`. To get only the non-deleted secrets, set it to `false`.
             * `namespace`: To filter secrets by namespace, provide the namespace name.
             * `scope`: To filter secrets by scope, provide the level (`Account` or `Organization`) and the corresponding ID.
            </td>
        </tr>

        <tr>
            <td>
            `sort` (Optional)
            </td>
            <td>
            * `direction` (Required): Boolean
            * `key` (Required): Boolean

            </td>
            <td>
             To sort the list of secrets, provide the following attributes:
             * `direction`: Select `ASC` for ascending order or `DESC` for descending order.
             * `key`: The available option is `CREATED_AT`. This sorts the secrets based on their creation time.
            </td>
        </tr>        



    </tbody>
</table>

#### Sample query:

```graphql
{
  customerAdministration {
    secrets(
      filter: {deleted: {eq: false}, scope: {eq: {id: 1, type: ACCOUNT}}}
      cursor: ""
      sort: {direction: DESC, key: CREATED_AT}
    )
  }
}
```

### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>

        <tr>
            <td>
            `nextCursor`
            </td>
            <td>
            The cursor value to access the next page of the secret list. If there are no more pages, this value will be `null`.
            </td>
        </tr>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            The account or organization ID associated with the secret.
            </td>
        </tr>              
        <tr>
            <td>
            `secrets`
            </td>
            <td>
            The details of the listed secrets, including:
            * `description`: The description of the secret, if available.
            * `isDeleted`: Indicates whether the secret is in a soft-delete state or not.
            * `key`: The key of the secret.
            * `latestVersion`: The latest version number of the secret.
            * `metadata`: Metadata associated with the secret, if any.
                * `createdAt`: Timestamps indicating when the secret was created.
                * `updatedAt`: Timestamps indicating when the secret was last updated.
            * `namespace`: The namespace of the secret, if available.
            * `tags`: The key and value pair associated with the secret, if any.
            </td>
        </tr>  
        <tr>
            <td>
            `totalCount`
            </td>
            <td>
            The total number of secrets available in the account or organization, regardless of pagination.
            </td>
        </tr>                                            
        

    </tbody>
</table>

#### Sample response:
    
    ```json
{
  "data": {
    "customerAdministration": {
      "secrets": {
        "nextCursor": "AAAADJ_Fqig86wFIH6c3ehxxpoFy0vdW2eA4pTkQFYDztd_UIeL91kCElQaCG0iORpmDdDT6KeZAVkByh4ogENST8yjxeZ5tI6vPYnyMW5rhtGwXlgt9zQRGYj1HcdpUHdfUcTC-CSsdQDLexy52XA==",
        "scope": {
          "id": "1",
          "type": "ACCOUNT"
        },
        "secrets": [
          {
            "description": "ZXY",
            "isDeleted": false,
            "key": "test2",
            "latestVersion": 1,
            "metadata": {
              "createdAt": "2025-05-26T07:45:19.395796Z",
              "updatedAt": "2025-05-26T08:08:49.130724Z"
            },
            "namespace": null,
            "tags": null
          },
          {
            "description": "XYZ",
            "isDeleted": false,
            "key": "test2",
            "latestVersion": 0,
            "metadata": {
              "createdAt": "2025-05-26T07:26:32.114987Z",
              "updatedAt": "2025-05-26T07:26:32.114987Z"
            },
            "namespace": null,
            "tags": null
          },
          {
            "description": "CBA",
            "isDeleted": false,
            "key": "test1",
            "latestVersion": 1,
            "metadata": {
              "createdAt": "2025-05-26T07:15:08.987252Z",
              "updatedAt": "2025-05-26T08:05:17.051658Z"
            },
            "namespace": null,
            "tags": null
          },
        ],
        "totalCount": 3
      }
    }
  }
    ```

</Collapser>

<Collapser
  id="grant-access-sharable-secret"
  title="Grant access to a sharable secret">

After creating a sharable secret, you can grant specific permissions to users, groups, system identities, or system identity groups. Use the `authorizationManagementGrantAccess` mutation to share your secret with authorized entities.

<Callout variant="important">
Only the secret owner or users with the `secret.create.grants` capability can grant access to a sharable secret.
</Callout>

#### Input attributes

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `grantAccessOptions` (Required)
            </td>
            <td>
            Object
            </td>
            <td>
            Contains the grant configuration with two main components:
            * `entityAccessGrants`: Defines the secret and the role to grant
            * `grantee`: Specifies who receives access
            </td>
        </tr>
        <tr>
            <td>
            `entityAccessGrants.entity.id` (Required)
            </td>
            <td>
            String
            </td>
            <td>
            The unique ID of the secret. The format is `namespace::partition::entry_key_secret`.
            </td>
        </tr>
        <tr>
            <td>
            `entityAccessGrants.entity.type` (Required)
            </td>
            <td>
            String
            </td>
            <td>
            The entity type. For secrets, this is always `secret`.
            </td>
        </tr>
        <tr>
            <td>
            `entityAccessGrants.roleId` (Required)
            </td>
            <td>
            String
            </td>
            <td>
            The unique ID of the role to grant. Common roles:
            * Secret Owner: Full control (read, update, delete, grant/revoke)
            * Secret Reader: Read-only access
            </td>
        </tr>
        <tr>
            <td>
            `grantee.id` (Required)
            </td>
            <td>
            String
            </td>
            <td>
            The unique ID of the user, group, system identity, or system identity group receiving access.
            </td>
        </tr>
        <tr>
            <td>
            `grantee.type` (Required)
            </td>
            <td>
            Enum
            </td>
            <td>
            The type of grantee. Valid values:
            * `USER`: Individual user
            * `GROUP`: User group
            * `SYSTEM_IDENTITY`: System identity (for automated processes)
            * `SYSTEM_IDENTITY_GROUP`: System identity group
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  authorizationManagementGrantAccess(
    grantAccessOptions: {
      entityAccessGrants: {
        entity: {
          id: "production::account-1::prod-api-key",
          type: "secret"
        },
        roleId: "role-id-for-secret-reader"
      },
      grantee: {
        id: "system-identity-id-abc123",
        type: SYSTEM_IDENTITY
      }
    }
  ) {
    roles {
      id
      roleId
    }
  }
}
```

### Response

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `roles`
            </td>
            <td>
            An array of role assignments created by the grant operation, including:
            * `id`: The unique identifier of the grant
            * `roleId`: The role ID that was granted
            </td>
        </tr>
    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "authorizationManagementGrantAccess": {
      "roles": [
        {
          "id": "grant-id-xyz789",
          "roleId": "role-id-for-secret-reader"
        }
      ]
    }
  }
}
```

<Callout variant="tip">
To revoke access to a sharable secret, use the `authorizationManagementRevokeAccess` mutation with the grant ID returned from the grant operation.
</Callout>

</Collapser>

</CollapserGroup>

## Related topics [#related-topics]

<DocTiles>
  <DocTile
    title="Introduction to NerdGraph"
    path="/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph"
  >
    Get started with New Relic's GraphQL API
  </DocTile>
  <DocTile
    title="NerdGraph API explorer"
    path="/docs/apis/nerdgraph/get-started/nerdgraph-explorer"
  >
    Use the NerdGraph API explorer to test queries and mutations
  </DocTile>
  <DocTile
    title="Manage user groups"
    path="/docs/apis/nerdgraph/examples/nerdgraph-manage-groups"
  >
    Create and manage user groups with custom roles
  </DocTile>
  <DocTile
    title="Secrets management for infrastructure"
    path="/docs/infrastructure/host-integrations/installation/secrets-management"
  >
    Use secrets in infrastructure agent configuration
  </DocTile>
</DocTiles>












