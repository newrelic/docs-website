---
title: "NerdGraph tutorial: Secrets management service"
metaDescription: "Learn how to use the Secret Management Service to securely store and manage your secrets."
freshnessValidatedDate: never
---

The Secrets management service provides a secure way to store and retrieve secrets, such as tokens, API keys, passwords, or certificates, through a centralized location using our [NerdGraph API](https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/). It supports storing any string value as a secret, helping to improve your security by removing the need to hard-code secrets within New Relic platform.

<Callout variant="important">

* Secrets stored within this service are for New Relic applications only. Don't use secrets for external applications or products.

* When accessing external services, New Relic applications may need authentication credentials like API tokens or OAuth client details.
 These credentials must be securely stored in secrets store. Customer-specific data, such as passwords or Personally Identifiable Information (PII), must never be stored in the secrets store.

</Callout>


## Requirements[#review-requirements]
 
* You need a [New Relic account](https://newrelic.com/signup), and with that account, you can access your API user key that you need to include with [queries and mutations]((https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#terminology)).

* User type and assigned roles can affect your NerdGraph permissions. For more details, see [Factors affecting access](https://docs.newrelic.com/docs/accounts/accounts-billing/account-structure/factors-affecting-access-features-data/#user-permissions).

## Mutations [#nerdgraph-mutations]

The Secrets management service is a service to perform CRUD operations, and it doesn't generate secrets. Manage your secrets with the following [NerdGraph mutations](https://docs.newrelic.com/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#terminology):

<CollapserGroup>
  <Collapser 
  id="create-secret" 
  title="Create a secret">

Use `secretsManagementCreateSecret` mutation to store your secrets in a centralized location. You can assign unique keys for your secrets (API keys, passwords, certificates, or tokens) and use them to retrieve the secret value when needed.

Additionally, you can add namespace, tags, or other attributes to your secrets for better organization and management. 


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        {/* <tr>
            <td>
            `accountId`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The account ID associated with the secret.
            </td>
        </tr> */}
        {/* <tr>
            <td>
            `alias`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) An alias is a way to assign a different name to a secret. This can be useful for readability, avoiding naming conflicts, or when you want to query the same field many times with different attributes.
            </td>
        </tr> */}
        <tr>
            <td>
            `description`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) A brief description for the secret.
            </td>
        </tr>

        {/* <tr>
            <td>
            `entityGuid`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The entity GUID is a unique identifier assigned to each entity within the New Relic ecosystem. An entity can be any monitored object, such as an application, service, host, or container, among others. Use GUID to uniquely identify and reference these entities across various New Relic services and APIs, including NerdGraph.
            </td>
        </tr> */}
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) A unique key for a secret that you want to store.
            </td>
        </tr>

        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>

          <tr>
            <td>
            `tags`
            </td>
            <td>
            Array
            </td>
            <td>
            (Optional) A tag is a key-value pair that you can use to add metadata to your entities (such as applications, services, hosts, etc.). Tags help you organize, filter, and manage your entities more effectively. They're particularly useful for sharing secrets within related entities.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The namespace is a logical grouping of secrets. It helps to organize and categorize secrets, making it easier to manage and avoid potential conflicts, especially when dealing with many secrets across various entities. Namespaces can be particularly useful in environments where many teams or projects are using New Relic.
            </td>
        </tr>
        <tr>
            <td>
            `value`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The value of the secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementCreateSecret(
    key: "testkey2"
    scope: {id: 1, type: ACCOUNT}
    value: "12345"
  ) {
    description
    latestVersion
    namespace
  }
}

```


#### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `description`
            </td>
            <td>
            String
            </td>
            <td>
            The description of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The version of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            Array
            </td>
            <td>
            The namespace of the secret.
            </td>
        </tr>

    </tbody>
</table>


#### Smaple response:
    
    ```json
 {
  "data": {
    "secretsManagementCreateSecret": {
      "description": "",
      "latestVersion": 0,
      "namespace": null
    }
  }
    ```

      </Collapser>

  <Collapser 
    id="delete-secrets" 
    title="Delete a secret">


Use the `secretsManagementDeleteSecret` mutation to perform a soft delete operation, temporarily deleting a version of the secret or all versions of the secret. 
You can recover the deleted version of the secret or all versions of the secret using the `secretsManagementRecoverSecret` mutation.
#### Input attributes

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        {/* <tr>
            <td>
            `accountId`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The account ID associated with the secret.
            </td>
        </tr> */}
        {/* <tr>
            <td>
            `deleteAll`
            </td>
            <td>
            Boolean
            </td>
            <td>
            (Required) If true, it deletes all versions of the secret.
            </td>
        </tr> */}

        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The key for the secret that you want to delete.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) If provided, deletes the secret associated with the namespace.
            </td>
        </tr>
        <tr>
            <td>
            `purge`
            </td>
            <td>
            Boolean
            </td>
            <td>
            (Required) If true, it deletes all versions of the secret. If false, it soft deletes the latest version of the secret and you can retrive it later.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql

mutation {
  secretsManagementDeleteSecret(
    accountId: 12345678
    key: "test_user_key"
    deleteAll: true
  ) {
    key
    latestVersion
    tags
  }
}

```


#### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            The key of the created secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The latest version available corresponding to the key. If `deleteAll` is true or no version is available after delete, `latestVersion` will be null.
            </td>
        </tr>
    </tbody>
</table>


#### Sample response:

```json
{
  "data": {
    "secretsManagementDeleteSecret": {
      "latestVersion": null
    }
  },
}
```
  </Collapser>

<Collapser 
  id="delete-secrets-version"
  title="Delete a specific version of a secret"
>  


Use the `secretsManagementDeleteSecretVersion` mutation to perform a hard delete. It deletes the secret key permanently from the secrets store and you can't recover.


#### Input attributes


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The secret key that you permanently want to delete.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) If provided, deletes the secret associated with the namespace.
            </td>
        </tr>
        <tr>
            <td>
            `purge`
            </td>
            <td>
            Boolean
            </td>
            <td>
            (Required)If true, it deletes all versions of the secret permanently. If false, it deletes the specific version of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `version`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional)The version of the secret to delete permanently.
            </td>
        </tr>
    </tbody>
</table>


#### Sample query:

```graphql

mutation {
    secretsManagementDeleteSecretVersion(
        scope: { type: enum(ACCOUNT)!, id: ID! }!
        key: String!,
        namespace: String,
        purge: Boolean = false,
        version: integer,
    )
}

```

#### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            Associated namespace of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The available latest version corresponding to the key. If `purgeAll` is true or no version is available after purge, latestVersion will be null.
            </td>
        </tr>
    </tbody>
</table>


#### Sample response:

```json
{
  "data": {
    "secretsManagementDeleteSecretVersion": null
    }
  },
}
```
</Collapser>

<Collapser
  id="recover-secrets"
  title="Recover a secret"
>

Use `secretsManagementRecoverSecret` mutation to recover secrets that you deleted using the `secretsManagementDeleteSecret` mutation before.

#### Input attributes

  <table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The key for the secret.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The namespace to which the secret belongs.
            </td>
        </tr>

    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementRecoverSecret(key: "testkey2", scope: {id: 1}) {
    latestVersion
    namespace
  }
}
```

#### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            The recovered key.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The latest version of the recovered secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementRecoverSecret": {
      "latestVersion": 0,
      "namespace": null
    }
  },
}
```

</Collapser>

<Collapser
  id="recover-secrets-versions"
  title="Recover a secret version"
>

Use `secretsManagementRecoverSecretVersion` mutation to recover specific versions of the secret that you deleted using the `secretsManagementDeleteSecretVersion` mutation before.

#### Input attributes

  <table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The key for the secret.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The namespace to which the secret belongs.
            </td>
        </tr>
        <tr>
            <td>
            `version`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The version of the secret that you want to recover.
            </td>
        </tr>

    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementRecoverSecretVersion(
    key: "testkey2"
    scope: {id: 1, type: ACCOUNT}
  ) {
    latestVersion
    namespace
  }
}
```

#### Response


<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            The recovered namespace.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The latest version of the recovered secret.
            </td>
        </tr>
    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementRecoverSecret": {
      "latestVersion": 0,
      "namespace": null
    }
  },
}
```

</Collapser>

<Collapser
  id="retrive-secret"
  title="Retrieve a secret"
  >


Retrieve the value of a secret using the `secretsManagementRetrieveSecret` mutation.

### Input attributes

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `accountId`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The account ID associated with the secret.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The key of the secret for which you want to retrive the value.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The namespace to which the secret belongs.
            </td>
        </tr>
        <tr>
            <td>
            `version`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The version of the secret that you want to retrieve.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementRetrieveSecret(
    accountId: 12345678
    key: "
    test_user_key"
  ) { 
    key
    value
  }
}
```

#### Response

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `createdAt`
            </td>
            <td>
            String
            </td>
            <td>
            The time when you created the secret.
            </td>
        </tr>
        <tr>
            <td>
            `tags`
            </td>
            <td>
            String
            </td>
            <td>
            The tags associated with the secret.
            </td>
        </tr>
        <tr>
            <td>
            `value`
            </td>
            <td>
            String
            </td>
            <td>
            The value of the secret.
            </td>
        </tr>
    </tbody>

</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementRetrieveSecret
    ": {
      "key": "test_user_key",
      "value": "1234567890"
    }   
  }
}
```
</Collapser>

<Collapser
  id="update-secret"
  title="Update a secret"
  >


Use the `secretsManagementUpdateSecret` mutation to update the value of existing secrets.

<Callout variant="tip">
Each update operation creates a new version of the secret. The latest version is always the most recent version of the secret.
</Callout>

#### Input Parameters

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `scope`
            </td>
            <td>
            Enum, string
            </td>
            <td>
            (Required) Scope defines the type and ID associated with the secret. The scope type can be either `ACCOUNT` or `ENTITY`. If the scope type is `ACCOUNT`, the ID represents the account ID. If the scope type is `ENTITY`, the ID represents the entity GUID.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The key of the secret for which you want to update the value.
            </td>
        </tr>
        <tr>
            <td>
            `namespace`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The namespace to which the secret belongs.
            </td>
        </tr>
        <tr>
            <td>
            `description`
            </td>
            <td>
            String
            </td>
            <td>
            (Optional) The updated description of the secret.
            </td>
        </tr>

        <tr>
            <td>
            `value`
            </td>
            <td>
            String
            </td>
            <td>
            (Required) The updated value for the key.
            </td>
        </tr>
    </tbody>
</table>

#### Sample query:

```graphql
mutation {
  secretsManagementUpdateSecret(
    namespace: "test"
    key: "test_user_key"
    value: "24680"
  ) {
    key
    latestVersion
    createdAt
    updatedAt
  }
}
```

#### Response

<table>
    <thead>
        <tr>
            <th style={{ width: "200px" }}>
            **Attribute name**
            </th>
            <th style={{ width: "200px" }}>
            **Data type**
            </th>
            <th>
            **Description**
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>
            `createdAt`
            </td>
            <td>
            String
            </td>
            <td>
            The time when you created the secret.
            </td>
        </tr>
        <tr>
            <td>
            `key`
            </td>
            <td>
            String
            </td>
            <td>
            The key of the secret.
            </td>
        </tr>
        <tr>
            <td>
            `latestVersion`
            </td>
            <td>
            String
            </td>
            <td>
            The version of the created secret.
            </td>
        </tr>
        <tr>
            <td>
            `updatedAt`
            </td>
            <td>
            String
            </td>
            <td>
            The time the secret was last updated.
            </td>
        </tr>
    </tbody>
</table>

#### Sample response:

```json
{
  "data": {
    "secretsManagementUpdateSecret": {
      "createdAt": "2024-10-21T08:01:07.593140Z",
      "key": "test_user_key",
      "latestVersion": 0,
      "updatedAt": "2024-10-21T08:03:26.334448074Z"
    }
  },
}
```
</Collapser>
</CollapserGroup>












