---
title: "NerdGraph tutorial: Create custom role for Teams"
tags:
  - Teams
  - APIs
  - NerdGraph
  - Examples
  - Custom roles
metaDescription: How to use New Relic NerdGraph API to create a custom role to create and manage Teams.
freshnessValidatedDate: never
---

<Callout title="preview">
    We're still working on this feature, but we'd love for you to try it out!

    This feature is currently provided as part of a preview program pursuant to our [pre-release policies](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>


New Relic Teams lets you connect the entities you're monitoring to the teams who own them. When you can easily see who owns an entity, you can speed up troubleshooting, enhance team collaboration, and improve your operational efficiency.

## Default Teams access

New Relic provides default access to Teams through these standard roles:

* **Read Access**: All users have read access to Teams, including metadata such as contact information, team members, and other relevant details.
* **Modify Teams**: Users with the **Organization Product Admin** role can modify Teams. This is a new role assigned to all users who currently have the **All Product Admin** role.
* **Create & Delete Teams**: Users with **Organization Manager** or **Authentication Manager** roles can create and delete Teams.


You might need a custom role if the default permissions don't meet your organization's needs. This tutorial shows you how to use NerdGraph GraphQL mutations to create a custom role for managing Teams.

### Process overview

To create a Teams administrator custom role, you'll need to:

1. [Find the required permission IDs for Teams](#retrieve-organization-scoped-capabilities)
2. [Retrieve your organization ID](#retrieve-your-organization-id)
3. [Create the custom role for Teams administrator](#create-custom-role)
4. [Add the custom role to a user group](#add-custom-role-to-a-user-group)


## Prerequisites

Before you begin, ensure you have:

* [General NerdGraph requirements](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#authentication)
* Organization Admin role permissions to create custom roles

<Callout variant="tip">
  Organization Admin refers to a user with the **Core** or **Full Platform** user type who has the `Authentication Domain Manager` or `Organization Manager` role.
</Callout>


## Mutations [#mutations]

New Relic provides various NerdGraph mutations to create custom role for Team managers.

<CollapserGroup>
  <Collapser 
      id="retrieve-organization-scoped-capabilities"
      title="Retrieve organization-scoped capabilities">
    Use the `customerAdministration` query to retrieve a list of capabilities, their permission IDs, and related information.


    #### Input parameters

    <table>
      <thead>
        <tr>
          <th>Parameter</th>
          <th>Data Type</th>
          <th>Is it Required?</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>`eq`</td>
          <td>String</td>
          <td>Yes</td>
          <td>Set the value to `organization` to retrieve permissions for Teams.</td>
        </tr>
      </tbody>
    </table>

    #### Sample request

    ```graphql
      {
      customerAdministration {
        permissions(filter: {scope: {eq: "organization"}}) {
            items {
              feature
              category
              id
              product
            }
          }
        }
      }

    ```

    #### Sample response

      ```graphql
      {
        "data": {
          "customerAdministration": {
            "permissions": {
              "items": [
                {
                  "category": "READ",
                  "feature": "Teams",
                  "id": "xxxxx",
                  "product": "New Relic One"
                },
                {
                  "category": "OTHER",
                  "feature": "Teams",
                  "id": "xxxxxx",
                  "product": "New Relic One"
                },
                {
                  "category": "DELETE",
                  "feature": "Teams",
                  "id": "xxxxx",
                  "product": "New Relic One"
                },
                {
                  "category": "MODIFY",
                  "feature": "Teams",
                  "id": "xxxxxx",
                  "product": "New Relic One"
                }
              ]
            }
          }
        }
      }

    ```

    **Next step**: From the response, identify and copy the permission IDs where:
    * `category: "MANAGE"` (or the appropriate category for your needs)
    * `feature: "Teams"`
    
    You'll need these IDs for the next step.



  </Collapser>
  <Collapser 
    id="retrieve-your-organization-id"
    title="Retrieve your organization ID">

Retrieve your organization ID, which you'll use in subsequent mutations.

#### Sample request

```graphql
  {
  actor {
    organization {
      id
      }
    }
  }

  ```

  #### Sample response

  ```graphql
  {
    "data": {
      "actor": {
        "organization": {
          "id": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"
        }
      }
    }
  }

  ```

  **Next step**: Copy your organization ID from the response. You'll need it to create the custom role.

  </Collapser>
  <Collapser 
    id="create-custom-role"
    title="Create custom role">

Use the `customRoleCreate` mutation to create your custom role for Teams management.


#### Input parameters

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Data Type</th>
      <th>Is it Required?</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>`id`</td>
      <td>String</td>
      <td>Yes</td>
      <td>The organization ID copied in the previous step.</td>
    </tr>
    <tr>
      <td>`type`</td>
      <td>String</td>
      <td>Yes</td>
      <td>Set the type to `organization`.</td>
    </tr>
    <tr>
      <td>`name`</td>
      <td>String</td>
      <td>Yes</td>
      <td>The name of the role.</td>
    </tr>
    <tr>
      <td>`permissionIds`</td>
      <td>Array of Integers</td>
      <td>Yes</td>
      <td>The permission IDs for Teams features identified in the first step.</td>
    </tr>
    <tr>
      <td>`scope`</td>
      <td>String</td>
      <td>Yes</td>
      <td>Set the scope to `organization`.</td>
    </tr>
  </tbody>
</table>

#### Sample request

```graphql

mutation {
  customRoleCreate(
    container: {id: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX", type: "organization"}
    name: "Teams manager"
    permissionIds: [xxxxx, xxxxx]
    scope: "organization"
  ) {
    id
  }
}

```
#### Sample response

```graphql

{
  "data": {
    "customRoleCreate": {
      "id": 9999999
    }
  }
}

```

**Next step**: Save the returned role ID. You'll need it to assign this role to a user group.

  </Collapser>

  <Collapser 
    id="add-custom-role-to-a-user-group"
    title="Add custom role to a user group">

After creating the custom role, you need to assign it to a user group in New Relic.

### Step 1: Retrieve group IDs

Use the `customerAdministration` query to get a list of available user groups.


#### Input parameters

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Data Type</th>
      <th>Is it Required?</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>`id`</td>
      <td>String</td>
      <td>Yes</td>
      <td>The organization ID copied in the previous step.</td>
    </tr>
  </tbody>
</table>

#### Sample request

```graphql

{
  customerAdministration {
    groups(filter: {organizationId: {eq: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}}) {
      nextCursor
      items {
        id
        name
        users {
          items {
            id
            email
          }
        }
      }
    }
  }
}

```

**Next step**: From the response, copy the group ID for the group you want to assign the Teams role to.
  
### Step 2: Assign the role to a user group

Use the `authorizationManagementGrantAccess` mutation to assign the custom role to a user group.


#### Input parameters

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Data Type</th>
      <th>Is it Required?</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>`roleId`</td>
      <td>String</td>
      <td>Yes</td>
      <td>The custom role ID from the previous step.</td>
    </tr>
    <tr>
      <td>`groupId`</td>
      <td>String</td>
      <td>Yes</td>
      <td>The group ID from Step 1.</td>
    </tr>
  </tbody>
</table>

#### Sample request

```graphql
mutation {
  authorizationManagementGrantAccess(
    grantAccessOptions: {organizationAccessGrants: {roleId: "99999999"}, groupId: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}
  ) {
    roles {
      id
      name
      organizationId
      roleId
      groupId
      displayName
    }
  }
}

```

#### Sample response

```graphql
{
  "data": {
    "authorizationManagementGrantAccess": {
      "roles": [
        {
          "displayName": "Teams manager",
          "groupId": null,
          "id": "99999999",
          "name": "teams_manager",
          "organizationId": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX",
          "roleId": 99999
        }
      ]
    }
  }
}

```
  </Collapser>
</CollapserGroup>

## What's next

After successfully creating and assigning your custom Teams role, users in the assigned group will have the permissions you configured. You can:

* Monitor the role's usage through your organization's user management
* Modify the role permissions if needed using similar NerdGraph mutations
* Create additional custom roles for different levels of Teams access

For more information about Teams, see our [Teams documentation](/docs/service-architecture-intelligence/teams/teams/).
