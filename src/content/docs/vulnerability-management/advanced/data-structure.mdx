---
title: Security data structure (NRQL reference)
metaDescription: Learn about the data structure and event types used to store vulnerability data in New Relic.
freshnessValidatedDate: never
---

Security RX stores vulnerability data as events in New Relic's database (NRDB), making it queryable using NRQL. This reference guide explains the event types, attributes, and data structure you can use to build custom queries, dashboards, and alerts.

## Event types

Security RX uses the following event types to store vulnerability and security data:

### NrAiIncident

Stores vulnerability findings and their current status.

**Primary use:** Query vulnerabilities affecting your entities

**Key attributes:**

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Example
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `title`
      </td>

      <td>
        String
      </td>

      <td>
        Vulnerability title
      </td>

      <td>
        "CVE-2024-12345: SQL Injection in library-name"
      </td>

    </tr>

    <tr>
      <td>
        `priority`
      </td>

      <td>
        String
      </td>

      <td>
        Computed priority rank
      </td>

      <td>
        "CRITICAL", "HIGH", "MEDIUM", "LOW"
      </td>

    </tr>

    <tr>
      <td>
        `state`
      </td>

      <td>
        String
      </td>

      <td>
        Current vulnerability state
      </td>

      <td>
        "OPEN", "CLOSED"
      </td>

    </tr>

    <tr>
      <td>
        `acknowledged`
      </td>

      <td>
        Boolean
      </td>

      <td>
        Whether vulnerability has been reviewed
      </td>

      <td>
        `true`, `false`
      </td>

    </tr>

    <tr>
      <td>
        `conditionName`
      </td>

      <td>
        String
      </td>

      <td>
        Detection source/condition
      </td>

      <td>
        "Security RX - Vulnerability Detection"
      </td>

    </tr>

    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        String
      </td>

      <td>
        Entity GUID affected by vulnerability
      </td>

      <td>
        "ABC123..."
      </td>

    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        String
      </td>

      <td>
        Entity name
      </td>

      <td>
        "my-application"
      </td>

    </tr>

    <tr>
      <td>
        `entityType`
      </td>

      <td>
        String
      </td>

      <td>
        Type of affected entity
      </td>

      <td>
        "APPLICATION", "HOST"
      </td>

    </tr>

  </tbody>
</table>
**Query example:**
```sql
FROM NrAiIncident
SELECT count(*)
WHERE conditionName LIKE '%Security RX%'
FACET priority, state
```

### Vulnerability (Custom Event)

Stores detailed vulnerability metadata including CVE information, severity scores, and remediation guidance.

**Primary use:** Deep dive into vulnerability details and metadata

**Key attributes:**

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Example
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cveId`
      </td>

      <td>
        String
      </td>

      <td>
        CVE identifier
      </td>

      <td>
        "CVE-2024-12345"
      </td>

    </tr>

    <tr>
      <td>
        `severity`
      </td>

      <td>
        String
      </td>

      <td>
        CVSS-based severity
      </td>

      <td>
        "CRITICAL", "HIGH", "MEDIUM", "LOW"
      </td>

    </tr>

    <tr>
      <td>
        `cvssScore`
      </td>

      <td>
        Number
      </td>

      <td>
        CVSS numeric score
      </td>

      <td>
        9.8
      </td>

    </tr>

    <tr>
      <td>
        `epssScore`
      </td>

      <td>
        Number
      </td>

      <td>
        EPSS exploit probability
      </td>

      <td>
        0.95
      </td>

    </tr>

    <tr>
      <td>
        `epssPercentile`
      </td>

      <td>
        Number
      </td>

      <td>
        EPSS percentile ranking
      </td>

      <td>
        98.5
      </td>

    </tr>

    <tr>
      <td>
        `activeRansomware`
      </td>

      <td>
        Boolean
      </td>

      <td>
        Used in known ransomware campaigns
      </td>

      <td>
        `true`, `false`
      </td>

    </tr>

    <tr>
      <td>
        `affectedPackage`
      </td>

      <td>
        String
      </td>

      <td>
        Vulnerable library/package name
      </td>

      <td>
        "log4j-core"
      </td>

    </tr>

    <tr>
      <td>
        `affectedVersion`
      </td>

      <td>
        String
      </td>

      <td>
        Vulnerable package version
      </td>

      <td>
        "2.14.0"
      </td>

    </tr>

    <tr>
      <td>
        `fixedVersion`
      </td>

      <td>
        String
      </td>

      <td>
        Version with fix
      </td>

      <td>
        "2.17.1"
      </td>

    </tr>

    <tr>
      <td>
        `entityGuid`
      </td>

      <td>
        String
      </td>

      <td>
        Affected entity GUID
      </td>

      <td>
        "ABC123..."
      </td>

    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        String
      </td>

      <td>
        Detection source
      </td>

      <td>
        "APM_AGENT", "SNYK", "AWS_SECURITY_HUB"
      </td>

    </tr>

  </tbody>
</table>
**Query example:**
```sql
FROM Vulnerability
SELECT count(*)
WHERE severity = 'CRITICAL'
AND activeRansomware = true
FACET affectedPackage
```

### NrAiIncidentTimeline

Tracks status changes and lifecycle events for vulnerabilities.

**Primary use:** Audit vulnerability status history and track remediation progress

**Key attributes:**

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Example
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `incidentId`
      </td>

      <td>
        String
      </td>

      <td>
        Related incident/vulnerability ID
      </td>

      <td>
        "INC-123"
      </td>

    </tr>

    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        When status changed
      </td>

      <td>
        Unix timestamp
      </td>

    </tr>

    <tr>
      <td>
        `event`
      </td>

      <td>
        String
      </td>

      <td>
        Type of change
      </td>

      <td>
        "STATUS_CHANGED", "DETECTED", "RESOLVED"
      </td>

    </tr>

    <tr>
      <td>
        `previousState`
      </td>

      <td>
        String
      </td>

      <td>
        State before change
      </td>

      <td>
        "AFFECTED"
      </td>

    </tr>

    <tr>
      <td>
        `newState`
      </td>

      <td>
        String
      </td>

      <td>
        State after change
      </td>

      <td>
        "IGNORED"
      </td>

    </tr>

    <tr>
      <td>
        `changedBy`
      </td>

      <td>
        String
      </td>

      <td>
        User who made change
      </td>

      <td>
        "user@example.com"
      </td>

    </tr>

    <tr>
      <td>
        `reason`
      </td>

      <td>
        String
      </td>

      <td>
        Reason for status change
      </td>

      <td>
        "False positive - not using vulnerable code path"
      </td>

    </tr>

  </tbody>
</table>
**Query example:**
```sql
FROM NrAiIncidentTimeline
SELECT timestamp, event, previousState, newState, changedBy
WHERE event = 'STATUS_CHANGED'
SINCE 7 days ago
```

## Common attributes across event types

These attributes appear across multiple event types:

### Entity identification

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Description
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        Unique identifier for the affected entity
      </td>

    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        Human-readable entity name
      </td>

    </tr>

    <tr>
      <td>
        `entity.type`
      </td>

      <td>
        Entity type (APPLICATION, HOST, SERVICE)
      </td>

    </tr>

    <tr>
      <td>
        `accountId`
      </td>

      <td>
        New Relic account ID
      </td>

    </tr>

  </tbody>
</table>
### Timestamps

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Description
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        When the event occurred
      </td>

    </tr>

    <tr>
      <td>
        `detectedAt`
      </td>

      <td>
        When vulnerability was first detected
      </td>

    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        Last update timestamp
      </td>

    </tr>

    <tr>
      <td>
        `resolvedAt`
      </td>

      <td>
        When vulnerability was marked resolved
      </td>

    </tr>

  </tbody>
</table>
### Source tracking

<table>
  <thead>
    <tr>
      <th>
        Attribute
      </th>

      <th>
        Description
      </th>

    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `source`
      </td>

      <td>
        Data source (APM_AGENT, INFRASTRUCTURE, SNYK, etc.)
      </td>

    </tr>

    <tr>
      <td>
        `sourceId`
      </td>

      <td>
        Unique ID from source system
      </td>

    </tr>

    <tr>
      <td>
        `integrationName`
      </td>

      <td>
        Integration that provided data
      </td>

    </tr>

  </tbody>
</table>
## Data relationships

Understanding how event types relate to each other:

```
Entity (Application/Host)
    ↓ has many
NrAiIncident (Active vulnerabilities)
    ↓ references
Vulnerability (CVE details)
    ↓ has many
NrAiIncidentTimeline (Status history)
```

## Query patterns

### Join entity data with vulnerabilities

```sql
FROM NrAiIncident
SELECT entity.name, count(*) as 'Vulnerability Count'
WHERE conditionName LIKE '%Security RX%'
AND state = 'OPEN'
FACET entity.name
SINCE 1 day ago
```

### Calculate exposure windows

```sql
FROM Vulnerability
SELECT entity.name,
       cveId,
       (max(timestamp) - min(timestamp)) / 86400 as 'Days Exposed'
WHERE severity IN ('CRITICAL', 'HIGH')
FACET entity.name, cveId
SINCE 30 days ago
```

### Track remediation velocity

```sql
FROM NrAiIncidentTimeline
SELECT count(*) as 'Vulnerabilities Resolved'
WHERE event = 'STATUS_CHANGED'
AND newState = 'CLOSED'
FACET weekOf(timestamp)
SINCE 90 days ago
```

## Attribute types and formats

### Severity values

```
CRITICAL - CVSS 9.0-10.0
HIGH     - CVSS 7.0-8.9
MEDIUM   - CVSS 4.0-6.9
LOW      - CVSS 0.1-3.9
INFO     - CVSS 0.0
```

### State values

```
OPEN      - Vulnerability currently active
CLOSED    - Vulnerability resolved or fixed
AFFECTED  - Entity is confirmed affected
IGNORED   - Marked as not applicable
NO_LONGER_DETECTED - No longer seen in scans
```

### Source values

```
APM_AGENT            - Detected by New Relic APM agent
INFRASTRUCTURE       - Detected by Infrastructure agent
SNYK                 - Imported from Snyk
AWS_SECURITY_HUB     - Imported from AWS Security Hub
DEPENDABOT           - Imported from GitHub Dependabot
FOSSA                - Imported from FOSSA
TRIVY                - Imported from Trivy
SECURITY_DATA_API    - Sent via API
```

## Querying tips

### Filter by priority

Vulnerabilities are prioritized based on CVSS, EPSS, and ransomware data:

```sql
FROM Vulnerability
WHERE priority IN ('CRITICAL', 'HIGH')
AND state = 'OPEN'
```

### Filter by entity type

Separate application from infrastructure vulnerabilities:

```sql
-- Application vulnerabilities
FROM Vulnerability
WHERE entityType = 'APPLICATION'

-- Infrastructure vulnerabilities
FROM Vulnerability
WHERE entityType = 'HOST'
```

### Filter by detection source

Query vulnerabilities from specific integrations:

```sql
FROM Vulnerability
WHERE source = 'SNYK'
FACET severity
```

### Time-based filtering

Find recently detected vulnerabilities:

```sql
FROM Vulnerability
WHERE detectedAt > ago(7 days)
FACET cveId, severity
```

## Building custom dashboards

Use these event types and attributes to create custom dashboards:

1. **Executive dashboard** - High-level metrics using `NrAiIncident`
2. **Remediation tracking** - Status changes using `NrAiIncidentTimeline`
3. **CVE intelligence** - Deep vulnerability analysis using `Vulnerability`
4. **Entity security posture** - Per-entity views combining all event types

For query examples, see [Security data query examples](/docs/vulnerability-management/advanced/query-examples).

## What's next?

<DocTiles>
  <DocTile title="Query examples" path="/docs/vulnerability-management/advanced/query-examples">
    Ready-to-use NRQL queries for common security scenarios
  </DocTile>

  <DocTile title="Set up alerts" path="/docs/vulnerability-management/advanced/set-up-alerts">
    Create NRQL-based alerts for vulnerabilities
  </DocTile>

  <DocTile title="Manage vulnerability status" path="/docs/vulnerability-management/advanced/manage-vulnerability-status">
    Change vulnerability status and track remediation
  </DocTile>
</DocTiles>
