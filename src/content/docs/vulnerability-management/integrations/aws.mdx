---
title: AWS security integration (EventBridge method)
metaDescription: 'Send your security data from AWS Security Hub, GuardDuty, and inspector directly to New Relic.'
freshnessValidatedDate: never
---

You can import AWS Security Hub findings into New Relic to achieve a single, unified view of vulnerabilities. The process uses EventBridge to post findings from AWS Security reporting services via an AWS API Destination.

After completing these steps, you will see new vulnerabilities detected by AWS Security tools in your New Relic account in real time, and you'll be able to build out analytics dashboards and enable <InlinePopover type="alerts"/> on newly detected issues.

You can also import AWS GuardDuty and Inspector findings and view them through custom dashboards or queries using NRDB.

## Prerequisites

To send AWS security data to New Relic:

* [Enable AWS Security Hub](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-settingup.html) on your AWS account.
* Obtain a New Relic [license key](/docs/accounts-partnerships/install-new-relic/account-setup/license-key) for the account you want to report data to.

## Create an API destination for ingest

<Steps>
  <Step>
    ### Create API destination [#create-api-destination]

    1. In your AWS UI navigate to <DNT>**EventBridge > Integrations > API destinations > Create API destination**</DNT>.
    2. Fill in the prompts.
    3. Construct your endpoint using the pattern below, and enter it into API destination endpoint:

       ```
       https://security-ingest-processor.service.newrelic.com/v1/security/webhooks/awssecurityhub?Api-Key=NEW_RELIC_LICENSE_KEY
       ```

       <Callout variant="important">
         Use the EU endpoint if you're using an EU license key: `https://security-ingest-processor.service.eu.newrelic.com/v1/security/webhooks/awssecurityhub?Api-Key=NEW_RELIC_LICENSE_KEY`
       </Callout>
    4. Select <DNT>**POST**</DNT> as the HTTP method.
    5. Select <DNT>**Create a new connection**</DNT>.
  </Step>

  <Step>
    ### Create a new connection [#create-new-connection]

    1. Fill in the fields in the new prompt.
    2. For <DNT>**Destination**</DNT> select <DNT>**Other**</DNT>.
    3. For <DNT>**Authorization type**</DNT> select <DNT>**API Key**</DNT>.
    4. For <DNT>**API Key Name**</DNT> type `Api-Key` and paste your New Relic <InlinePopover type="licenseKey"/> as the value.
  </Step>
</Steps>

## Create an EventBridge rule

Once you've created an API destination for ingest, create an Eventbridge rule to forward security-related events to an API destination for New Relic's ingest.

<Steps>
  <Step>
    ### Define rule detail [#define-rule-detail]

    1. In your AWS UI navigate to <DNT>**EventBridge > Rules > Create Rule**</DNT>.
    2. Enter a name in the name field, such as `SecurityEvent_NewRelicSIP_EventForwarder_Rule`.
    3. Enter a description, such as `Forwards Security Hub, GuardDuty, and Inspector events to the New Relic Security Ingest Processor (SIP)`.
    4. For event bus, select `default`.
    5. For rule type, select `Rule with an event pattern`.
    6. Select <DNT>**Next**</DNT>.
  </Step>

  <Step>
    ### Build event pattern [#build-event-pattern]

    1. In the new pane select <DNT>**AWS events or EventBridge partner events**</DNT> as the event source.
    2. Optional: Choose any Security Hub sample event from the dropdown to test your rule against.
    3. For the event pattern, enter the select the custom patterns pane and input a pattern. For example the pattern below matches events from Security Hub, Guard Duty, and Inspector:

       ```json
       {
         "detail-type": [
           {
             "prefix": "Security Hub"
           },
           {
             "prefix": "GuardDuty Finding"
           },
           {
             "prefix": "Inspector2"
           }
         ]
       }
       ```
  </Step>

  <Step>
    ### Select the API destination as the rule target [#select-api-destination]

    1. For <DNT>**Target types**</DNT>, select <DNT>**EventBridge API destination**</DNT>.
    2. For <DNT>**API destination**</DNT>, select <DNT>**Use an existing API destination**</DNT>.
    3. Using the dropdown, select the API destination you created in step 1.
    4. For execution role, select <DNT>**Create a new role for this specific resource**</DNT>.
  </Step>

  <Step>
    ### Configure tags (Optional) [#configure-tags]

    Configure your tags as needed.
  </Step>

  <Step>
    ### Review and Create [#review]

    Review all your selections and make any changes as necessary.
  </Step>

  <Step>
    ### Review in NRDB [#review-in-nrdb]

    To review logs ingested via AWS Event Bridge, you can use the following NRQL query:

    ```sql
    FROM Vulnerability SELECT * WHERE source LIKE 'AWS%' SINCE 3 MONTHS AGO
    ```

    Note that GuardDuty and Inspector results will only show this way, while SecurityHub vulnerabilities will be visible in New Relic's Security RX (if available).

    For more comprehensive NRQL query examples for security data, including vulnerabilities and cloud misconfigurations, see [Security data NRQL query examples](/docs/nrql/nrql-examples/security-nrql-query-examples).
  </Step>
</Steps>
