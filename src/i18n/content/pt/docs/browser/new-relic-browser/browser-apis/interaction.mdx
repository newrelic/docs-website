---
title: interação (API SPA)
type: apiDoc
shortDescription: Retorna um novo objeto API vinculado à interação SPA atual.
tags:
  - Browser
  - Browser monitoring
  - Browser agent and SPA API
metaDescription: SPA API call for browser monitoring to return a new API object that is bound to the current interaction.
freshnessValidatedDate: never
translationType: machine
---

## Sintaxe

```js
newrelic.interaction([JSON object $options])
```

Retorna um novo objeto de identificador que está vinculado à interação SPA atual ou uma nova interação, caso não exista uma.

## Requisitos

* Agente browser Pro+SPA (v963 ou superior)

* O parâmetro `$options` requer v1.285.0+

* Se estiver usando o npm para instalar o agente browser, você deverá ativar o recurso `spa` ao instanciar a classe `BrowserAgent` . Na matriz `features` , adicione o seguinte:

  ```js
  import { Spa } from '@newrelic/browser-agent/features/spa';

  const options = {
    info: { ... },
    loader_config: { ... },
    init: { ... },
    features: [
      Spa
    ]
  }
  ```

  Para obter mais informações, consulte a [documentação de instalação do browser npm](https://www.npmjs.com/package/@newrelic/browser-agent#new-relic-browser-agent).

## Descrição

A chamada [de monitoramento SPA](/docs/browser/single-page-app-monitoring/get-started/introduction-single-page-app-monitoring) `interaction()` retorna um novo identificador que está vinculado à interação atual.

* <DNT>**New interaction:**</DNT> Se esta função for chamada e nenhuma interação estiver aberta ou em andamento, uma nova interação [personalizada](/docs/browser/single-page-app-monitoring/use-spa-data/spa-data-collection#api-custom-events) será criada.
  * Uma interação personalizada ainda seguirá a heurística padrão e fechará automaticamente na próxima navegação suave completa, *a menos que* `waitForEnd` seja especificado.

* <DNT>**New object:**</DNT> Se esta função for chamada enquanto uma interação estiver em andamento, um novo identificador referenciando a interação atual será criado.

  * Vários identificadores podem apontar para a mesma interação. Cada chamada `.interaction` cria um novo identificador.
  * O identificador apontará para a interação aberta, independentemente de ter começado a partir de um evento do usuário, como um `click` ou de uma chamada `.interaction` acionada pela API anterior.
  * Esta função não pode substituir seu próprio efeito ou o de um evento do usuário. Ou seja, ele não pode substituir nenhuma interação aberta existente por uma nova interação orientada por API.

## Parâmetro

<table>
  <thead>
    <tr>
      <th width="25%">
        Parâmetro
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `$options`

        *Objeto JSON*
      </td>

      <td>
        Opcional: especifica opções que afetam o comportamento da interação.

        * `waitForEnd` - O padrão é `false`. Para manter a interação aberta à força até que o método `.end` seja chamado em seu identificador, defina-o como `true`. Depois que uma interação é marcada com isso, ela não pode ser desfeita.
      </td>
    </tr>
  </tbody>
</table>

## Valores de retorno

Este método retorna um objeto JS nativo que aponta para um [evento`BrowserInteraction` ](/docs/insights/explore-data/attributes/browser-default-attributes-insights#browserinteraction-attributes)potencial. Cada vez que esse método é chamado para o mesmo `BrowserInteraction` enquanto ele ainda não terminou, um novo objeto é criado, mas ele ainda faz referência à mesma interação.

## Exemplos

Os métodos da API SPA devem ser usados em `newrelic.interaction()`. Você pode atribuir o valor retornado ou o identificador a outra variável para uso posterior. Por exemplo:

```js
let myInteraction = newrelic.interaction();
...
myInteraction.save();
```

Embora o identificador nomeado possa ser salvo e usado de fora de uma interação, observe que os métodos SPA não terão efeito após o término da interação.

A duração da interação também pode ser personalizada usando o seguinte método:

```js
// Say an interaction is already open from a user click.
const userInteraction = newrelic.interaction({ waitForEnd: true }); // grabs the current interaction in-progress & keep it open
// URL changes & DOM is modified. Because of those condition being met, interaction will be saved but is kept open.
fetch('myurl.com/endpoint').then(() => userInteraction.end()) // associate this request to the interaction before completing this BrowserInteraction

const myCustomIxn = newrelic.interaction({ waitForEnd: true }) // create a new api-triggered interaction
// This interaction will be kept open indefinitely until `.end` is called, and no new interaction will start, custom or otherwise. AjaxRequest will continue to buffer under this interaction until it is closed.
```