---
title: Session Replay
metaDescription: Play back user interactions to debug faster and improve page performance.
freshnessValidatedDate: '2024-04-01T00:00:00.000Z'
translationType: machine
---

import browserSessionReplayDetails from 'images/browser_screenshot-full_session-replay-details.gif'

import browserTextMaskingExample from 'images/browser_screenshot-full_text-masking-example.webp'

import browserApplicationSettingsPage from 'images/browser_screenshot-full_Application-settings-page.webp'

import browserMaskSettings from 'images/browser_screenshot-full_mask-settings.webp'

import browserSessionReplayAppSettings from 'images/browser_screenshot-full_session-replay-app-settings.webp'

import browserSessionReplayPage from 'images/browser_screenshot-full_Session-replay-page.webp'

import browserErrorsInboxSessionReplay from 'images/browser_screenshot-full_errors-inbox-session-replay.webp'

import browserViewConsumptionDetails from 'images/browser_screenshot-crop_view-consumption-details.webp'

<Callout variant="important">
  Session replay is in limited preview. This feature will be billable starting May 15, 2024. See [Data consumption](#plan-for-paid-consumption) for details.
</Callout>

Session Replay reproduz a interação do usuário em seu aplicativo da web e mapeia outros dados de telemetria para ajudá-lo a entender as jornadas do seu usuário. Session Replay pode ser utilizado para resolução de problemas e melhoria da experiência do usuário final, como:

* **Resolução de problemas Erros de JavaScript**: Solucione a causa de um erro vendo o que o usuário estava fazendo quando o erro ocorreu. Por exemplo, se um usuário final receber um erro ao tentar concluir uma transação de comércio eletrônico, você poderá usar Session Replay para ver quais etapas ele realizou e quais dados ele inseriu antes do erro ocorrer. Isso pode ajudá-lo a identificar e corrigir rapidamente a causa raiz do problema.
* **Melhorando a experiência do usuário**: Descubra áreas do seu aplicativo web que estão causando frustração ao usuário. Por exemplo, você pode ver que o usuário está se perdendo na navegação ou clicando em botões que não fazem nada.
* **Identificando problemas nas principais jornadas do usuário**: identifique áreas do seu aplicativo Web que estão causando problemas de desempenho. Por exemplo, se Session Replay revelar que a página `/cart/checkout` está apresentando um ritmo de carregamento excessivo da página, você priorizará a correção dessa jornada crítica do usuário.

<img
  title="Session replay details"
  alt="Screenshot of session replay details"
  src={browserSessionReplayDetails}
/>

## Como funciona Session Replay [#how-it-works]

Quando um usuário carrega sua página da web, Session Replay tira um instantâneo do Document Object Model (DOM), que representa a estrutura e os elementos visuais da página. Para garantir informações de estilo precisas, o agente do browser acessa seus arquivos CSS. O agente então integra esses estilos diretamente na gravação de repetição, eliminando a necessidade de fazer referência a arquivos CSS externos durante a reprodução. À medida que o usuário interage com a página, uma biblioteca dentro do agente do browser captura todas as alterações feitas no DOM. Esses dados capturados são armazenados com segurança no banco de dados da New Relic.

Os replays armazenam até:

* 4 horas de uma sessão de usuário
* 30 minutos de inatividade

Por padrão, os dados de eventos do browser são armazenados por 8 dias, mas a retenção real de dados depende da sua conta.

Para obter mais detalhes sobre Session Replay, consulte as seções a seguir:

* [Consumo de dados](#view-consumption): visualize o consumo de dados e planeje a transição para o consumo pago.
* [Preocupações com privacidade e segurança do usuário](#data-security): Saiba como protegemos os dados do seu usuário e atendemos aos requisitos de privacidade.
* [Session Replay e o desempenho do seu aplicativo](#app-performance): Saiba como Session Replay minimiza o impacto no desempenho do seu aplicativo.

## Iniciar [#get-started]

<Steps>
  <Step>
    ### Habilitar Session Replay [#enable-configure-settings]

    1. Vá para

       <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com/all-capabilities) > All Capabilities > Browser**</DoNotTranslate>

       .

    2. Selecione seu aplicativo de browser.

    3. No menu à esquerda, clique em

       <DoNotTranslate>**Application settings**</DoNotTranslate>

       .

    4. Na página Configurações do aplicativo, certifique-se de

       <DoNotTranslate>**Pro**</DoNotTranslate>

       ou

       <DoNotTranslate>**Pro + SPA**</DoNotTranslate>

       agente browser esteja selecionado. Session Replay não está disponível para o agente browser Lite.

    5. Ative as configurações

       <DoNotTranslate>**Session tracking**</DoNotTranslate>

       e

       <DoNotTranslate>**Session replay**</DoNotTranslate>

       .
  </Step>

  <Step>
    ### Configurar taxas de amostragem [#configure-sampling-rates]

    Defina uma taxa de amostragem (0%-100%) para as seguintes amostras:

    * <DoNotTranslate>**User sessions**</DoNotTranslate> registra uma amostra aleatória de todas as sessões do usuário.

    * <DoNotTranslate>**Errored session**</DoNotTranslate> registra uma amostra aleatória de todas as sessões com erros. O agente armazena em buffer por até 30 segundos no lado do cliente e, se ocorrerem erros, a sessão será gravada. Se não ocorrer um erro, a reprodução não será coletada.

      Por exemplo, se você definir a taxa de amostragem da sessão como 50% e a taxa de amostragem de erro como 100%, isso significa que:

    * Metade de todas as sessões do usuário serão gravadas.

    * Todas as sessões com erro serão registradas, mesmo que não façam parte da amostra de 50%.
  </Step>

  <Step>
    ### (Opcional) Definir configurações de privacidade [#configure-privacy-settings]

    Por padrão, todos os textos e entradas são substituídos por asteriscos. Aqui está um exemplo da aparência de um replay com privacidade padrão:

    <img
      title="Example of default privacy settings"
      alt="Example of default privacy settings"
      src={browserTextMaskingExample}
    />

    Se esta configuração for apropriada, passe para a próxima etapa.

    Se precisar personalizar qual conteúdo ou entrada do usuário é capturado, você terá opções para mascarar, bloquear ou ignorar classes específicas e atributos de conteúdo ou entrada do usuário. Certifique-se de verificar com sua equipe de privacidade antes de alterar as configurações de privacidade.

    ### Mascarar texto sensível [#mask-text]

    Você pode mascarar texto confidencial, o que significa que o texto será substituído por asteriscos (\*). Por exemplo, você pode mascarar o ID da conta de um usuário exibido em um URL.

    Para especificar qual entrada deve ser mascarada, você tem algumas opções:

    * Na página <DoNotTranslate>**Application settings**</DoNotTranslate> , adicione seus próprios seletores CSS ou marque as caixas de mascaramento. Observe que o uso de seletores de mascarar **não** irá mascarar a entrada do usuário, portanto, se você precisar ocultar a entrada do usuário, recomendamos o uso de seletores de bloco.

      <img
        title="Mask settings"
        alt="Screenshot of mask settings in the ui"
        src={browserMaskSettings}
      />

    * Adicione nossa classe CSS `nr-mask` ou atributo `data-nr-mask` ao HTML da sua página da web. Por exemplo, para impedir que um ID de conta seja exibido no URL, adicione `nr-mask` ao `<div>` que contém o ID da conta:

      ````html
      <div>Account ID: <span class="nr-mask">99881123</span></div>
      ```
      ````

    Essas opções usam um asterisco (\*) para mascarar todo o texto desse elemento, ocultando o texto real, mas revelando o número de caracteres inseridos. No entanto, os asteriscos não são números válidos, portanto, mascarar campos específicos do tipo de número, como números de telefone ou de cartão de crédito, resultará em um campo em branco em uma repetição.

    ### Bloquear conteúdo do site [#block-content]

    Você pode bloquear seções inteiras de conteúdo do seu site, o que significa que a seção aparecerá como um espaço vazio reservado no Session Replay. Por exemplo, se você tiver uma imagem em sua página Sobre nós e não precisar capturá-la, poderá bloquear a classe que contém a imagem.

    Para bloquear aulas ou atributos específicos, você tem algumas opções:

    * Na página Configurações do aplicativo, adicione seus seletores CSS no campo \*_Seletores de bloco_ .

      <img
        title="Block Selectors"
        alt="Screenshot of session replay settings"
        src={browserSessionReplayAppSettings}
      />

    * Adicione manualmente nossa classe CSS `nr-block` ou atributo `data-nr-block` ao HTML da sua página da web. Por exemplo, se você quiser bloquear textos e imagens irrelevantes do Session Replay, adicione `nr-block` a `<div class>`:

      ```html
      <html>
      <head>
        <title>Sample image and text</title>
      </head>
      <body>
        <div class="image-text-container nr-block">
          <img src="https://example.com/image.png" alt="Image description">
        </div>
      </body>
      </html>
      ```

    ### Ignorar a entrada do usuário [#ignore-input]

    Você pode ignorar as alterações em um campo de entrada do usuário, o que significa que o campo de entrada ainda será exibido na reprodução, mas você não exibirá as alterações no valor. Por exemplo, você pode ignorar a classe que contém o endereço de e-mail ou os campos do cartão de crédito. Os campos de entrada de senha são sempre mascarados. 

    Para ignorar a entrada, adicione a classe CSS `nr-ignore` ao nome da classe do campo de entrada. Por exemplo, se quiser ignorar informações confidenciais em uma página de faturamento, adicione `class="nr-ignore"` a `<input type>`:

    ```html
    <div class="sensitive-information">
      <h2>Sensitive Information</h2>
      <p>Credit card number: <input type="number" class="nr-ignore" id="creditCardNumber"></p>
      <p>Expiration date: <input type="number" class="nr-ignore" id="expirationDate"></p>
      <p>CVV code: <input type="number" class="nr-ignore" id="cvvCode"></p>
    </div>
    ```
  </Step>

  <Step>
    ### (Para copiar/colar agente de implantação) Atualize manualmente o trecho JavaScript [#update-snippet]

    Se você implantar o navegador do agente usando o método copiar/colar, será necessário copiar/colar da interface novamente. Isso ocorre porque quando você ativa Session Replay, o trecho JavaScript é atualizado para incluir as novas atualizações de configuração.

    Para atualizar seu código de agente:

    1. Vá para a página <DoNotTranslate>**Application Settings**</DoNotTranslate> e copie o trecho JavaScript.

       <img
         title="Copy/paste installation method"
         alt="Screenshot of the application settings page."
         src={browserApplicationSettingsPage}
       />

    2. Cole-o no seu código onde estava o trecho antigo.

    3. Implantar seu aplicativo.
  </Step>

  <Step>
    ### Veja o replay da sessão no New Relic [#view-data]

    Você pode encontrar o Session Replay em dois lugares:

    * Na página <DoNotTranslate>**Session replay**</DoNotTranslate> :

      1. Vá para <DoNotTranslate>**[one.newrelic.com > All Capabilities](https://one.newrelic.com/all-capabilities) > Browser**</DoNotTranslate>.

      2. Selecione seu aplicativo de browser.

      3. No menu à esquerda, role para baixo e clique em <DoNotTranslate>**Session replay**</DoNotTranslate>.

      4. Clique em cada replay para ver os detalhes da sessão.

         <img
           title="Session replay"
           alt="screenshot of the session replay page in browser"
           src={browserSessionReplayPage}
         />

    * Na página <DoNotTranslate>**Errors inbox**</DoNotTranslate> :

      1. No menu esquerdo do browser, clique em <DoNotTranslate>**Errors**</DoNotTranslate>.

      2. Clique nas páginas <DoNotTranslate>**Triage**</DoNotTranslate> e <DoNotTranslate>**Group errors**</DoNotTranslate> para ver replays anexados aos erros.

         <img
           title="Replays in errors inbox"
           alt="Screenshot of replays in errors inbox"
           src={browserErrorsInboxSessionReplay}
         />
  </Step>
</Steps>

## Resolução de problemas [#troubleshoot]

<CollapserGroup>
  <Collapser
    id="Troubleshoot-missing-data"
    title="Não vendo replays na interface"
  >
    ### Problema

    O recurso Session Replay está ativado, mas você não vê nenhum replay.

    ### Solução

    Aqui estão algumas soluções possíveis:

    * Verifique suas taxas de amostragem. Há amostragem para replays e erros.

    * Certifique-se de ter permissão para ver replays.

    * Certifique-se de estar usando a versão Pro ou Pro+SPA do agente browser. Session Replay não funciona com o agente browser Lite.

    * Certifique-se de que seu browser agente atenda a estes requisitos:

      * Versão do agente v1.240.0 ou superior. Recomendamos [atualizar para a versão mais recente do agente](/docs/release-notes/new-relic-browser-release-notes/browser-agent-release-notes) à medida que continuamos fazendo melhorias.
      * Tipo de agente: Pro ou Pro+SPA. Session Replay não funciona com o agente browser Lite.

    * Na [Errors Inbox](docs/errors-inbox/errors-inbox/), você pode usar o botão de alternância para mostrar apenas erros com replays. Isso filtrará suas visualizações para que você sempre veja um replay. Por padrão, os dados de eventos do browser são armazenados por 8 dias, mas a retenção real de dados depende da sua conta.

    * Se você estiver usando o método de implantação copiar/colar, [atualize o código do agente](#update-snippet).

    * Se você estiver usando o método de implantação APM, talvez seja necessário aguardar um pouco para que Session Replay seja ativado automaticamente. Se ainda não estiver vendo os dados, tente reiniciar o agente.
  </Collapser>

  <Collapser
    id="troubleshoot-missing-css"
    title="Replays não são exibidos corretamente"
  >
    ### Problema

    Você está vendo replays, mas eles não estão sendo exibidos corretamente.

    Isso pode ocorrer porque seus arquivos CSS estão hospedados em um domínio separado e as medidas de segurança do Cross-Origin Resource Sharing (CORS) estão impedindo nosso agente de acessar os arquivos CSS. Isso pode resultar em replays incompletos ou imprecisos, pois podem faltar informações essenciais de estilo.

    Aqui está o que está acontecendo nos bastidores:

    * Session Replay funciona reconstruindo o DOM do usuário, que inclui a estrutura e os elementos visuais do seu site. Para conseguir isso, nosso agente precisa acessar seus arquivos CSS para capturar informações de estilo com precisão. Em seguida, incorporamos esses estilos diretamente na gravação do replay, eliminando a necessidade de fazer referência aos arquivos CSS originais durante a reprodução.
    * Se seus arquivos CSS estiverem hospedados em um domínio separado, o CORS poderá impedir que nosso agente os acesse.

    ### Solução

    Para garantir que seus arquivos CSS estejam acessíveis, adicione o atributo `crossorigin="anonymous"` aos elementos `<link rel="stylesheet">` no código HTML. Este atributo instrui o browser a permitir acesso de origem cruzada para esses arquivos CSS específicos, permitindo que nosso browser agente registre e integre as informações de estilo.

    Aqui está um exemplo de adição do atributo `crossorigin="anonymous"` :

    ```
    <link rel="stylesheet" href="assets.yoursite.com/styles.css" crossorigin="anonymous">
    ```
  </Collapser>
</CollapserGroup>

## Gravar manualmente a repetição da sessão [#manual-replays]

Se necessário, você pode invocar programaticamente uma Session Replay usando métodos API . Aqui estão alguns casos de uso:

* Permitir que o usuário opte pela gravação de interação. Por exemplo, se você tiver um pop-up perguntando "Permitir que esta sessão seja gravada para análise de desempenho?":

  1. Mediante consentimento do usuário, chame `NREM.startSessionReplay` para iniciar a gravação.
  2. Assim que a sessão for concluída ou o consentimento for retirado, use `NREM.stopSessionReplay` para interromper a captura de dados.

* Grave sessões com base em critérios específicos. Por exemplo:

  * Comece a gravar apenas sessões em URLs específicos, como um fluxo de checkout de produto.
  * Interrompa a gravação de páginas confidenciais, como `/billing` ou `/health-records`.

Consulte a documentação da API para obter instruções:

* [`NREM.startSessionReplay`](/docs/browser/new-relic-browser/browser-apis/start/)
* [`NREM.stopSessionReplay`](/docs/browser/new-relic-browser/browser-apis/stop/)

Para garantir que todas as interações do usuário sejam capturadas durante a gravação manual, defina as taxas de amostragem como 0% nas configurações do aplicativo.

## Use o Nerdgraph para definir as configurações de reprodução [#nerdgraph-mutation]

Você pode definir as configurações Session Replay usando nossa [API NerdGraph](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/) em vez de usar a interface. Este método é útil se você precisar fazer alterações em massa, como aplicar taxas de amostragem a múltiplas entidades do browser.

Aqui está um exemplo de mutação e variáveis para criar um novo aplicativo de browser com configurações padrão:

<table>
  <thead>
    <tr>
      <th>
        Mutação
      </th>

      <th>
        Variáveis
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        ```graphql
        mutation SessionReplayConfigUpdate($guid: EntityGuid!, $settings: AgentApplicationSettingsUpdateInput!) {
          agentApplicationSettingsUpdate(guid: $guid, settings: $settings) {
            browserSettings {
              sessionReplay {
                blockSelector
                errorSamplingRate
                maskTextSelector
                enabled
                collectFonts
                inlineImages
                inlineStylesheet
                samplingRate
                maskAllInputs
                maskInputOptions {
                  color
                  date
                  datetimeLocal
                  email
                  month
                  number
                  range
                  search
                  select
                  tel
                  text
                  textArea
                  time
                  url
                  week
                }
              }
            }
            errors {
              field
              errorClass
              description
            }
          }
        }
        ```
      </td>

      <td>
        ```json
        {
          "sessionReplay": {
            "enabled": true,
            "collectFonts": true,
            "blockSelector": ".private-fields",
            "maskTextSelector": "*",
            "inlineStylesheet": false,
            "maskAllInputs": true,
            "maskInputOptions": {
              "color": true,
              "date": true,
              "textArea": true
            },
            "samplingRate": 9.99,
            "errorSamplingRate": 1.11
          }
        }
        ```
      </td>
    </tr>
  </tbody>
</table>

## Consumo de dados [#data-consumption]

### Ver consumo [#view-consumption]

Antes de 15 de maio de 2024, embora os bytes Session Replay sejam gratuitos, você pode visualizar seu consumo para ajudar no planejamento assim que os bytes forem pagos:

1. Vá para <DoNotTranslate>**Application Settings**</DoNotTranslate>.

2. Role para baixo até <DoNotTranslate>**Session replay**</DoNotTranslate>.

3. Na seção <DoNotTranslate>**Session sample size**</DoNotTranslate> , clique em <DoNotTranslate>**View your account's consumption**</DoNotTranslate>.

   <img
     title="View account consumption on application settings page"
     alt="screenshot of application settings page"
     src={browserViewConsumptionDetails}
     style={{ maxWidth: '50%' }}
   />

### Plano de consumo pago [#plan-for-paid-consumption]

Após 15 de maio de 2024, Session Replay seguirá o mesmo preço de consumo dos demais bytes do navegador. A quantidade de bytes produzidos depende da contagem, duração e níveis de atividade do usuário nas sessões, bem como da complexidade do DOM do seu site.

A maneira mais precisa de projetar seu custo por repetição é ativar o recurso por um curto período de teste e medir seu consumo real. Como alternativa, você pode usar uma média de 5,3 MB por replay como uma aproximação aproximada, mas lembre-se de que seu custo real pode variar significativamente. Uma fórmula simples para projetar seus custos aproximados é: `sessions` x `sampling_rate` x `gb_per_replay` x `cost_per_gb`

* Exemplo: `sessions: 1 million` x `sampling_rate: 5%` x `gb_per_replay: 0.0053` x `cost_per_gb: $0.30` = `$79.50 for 50,000 replays`

Para controlar seu consumo, [ajuste suas taxas de amostragem](#configure-sampling-rates).

## Preocupações com privacidade e segurança do usuário [#data-security]

Levamos a privacidade dos dados a sério, por isso construímos Session Replay com configurações de privacidade padrão robustas, projetadas para limitar o possível compartilhamento de informações confidenciais dos clientes. Essas configurações [podem ser personalizadas](#configure-privacy-settings) para atender aos seus requisitos de privacidade.

Session Replay não armazena captura de tela ou vídeos. Ele registra apenas as alterações essenciais do estado do DOM necessárias para recriar a experiência do usuário. Isso resulta em uma quantidade muito menor de dados armazenados.

## Session Replay e o desempenho do seu aplicativo [#app-performance]

Session Replay minimiza o impacto no desempenho do seu aplicativo com:

* **Impacto inicial mínimo**: Session Replay carrega de forma assíncrona após o carregamento completo da página, garantindo nenhuma interferência na métrica de desempenho de carregamento inicial da página.

* **Rastreamento de mutação DOM **: uma vez carregado, Session Replay monitora as alterações DOM e as relata como carga compactada. O tamanho dessa carga está correlacionado com a complexidade da árvore DOM .

* **Técnicas de otimização de desempenho**: O tamanho da carga útil também pode aumentar se o DOM for grande. No entanto, Session Replay utiliza diversas técnicas para reduzir o tamanho da carga, como:

  * Compressão GZIP

  * Redução de duplicação

  * Coleta estratégica de carga útil: ela só envia uma carga útil grande (compactada) quando o DOM completo é capturado, o que normalmente só acontece quando o recurso de reprodução é importado pela primeira vez. Depois disso, enviará apenas pequenas cargas relacionadas às ações do usuário. O agente do browser coletará o que acontecer primeiro entre os seguintes:

    * A carga atinge mais de 64 KB compactados
    * 60 segundos se passam
    * A visibilidade das mudanças da página (mudança de guia, foco, navegação, etc)