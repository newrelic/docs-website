---
title: 'Tutorial do NerdGraph: Criar função personalizada para equipes'
tags:
  - Teams
  - APIs
  - NerdGraph
  - Examples
  - Custom roles
metaDescription: How to use New Relic NerdGraph API to create a custom role to create and manage Teams.
freshnessValidatedDate: never
translationType: machine
---

<Callout title="visualização">
  Ainda estamos trabalhando nesse recurso, mas adoraríamos que você experimentasse!

  Atualmente, esse recurso é fornecido como parte de um programa de visualização de acordo com nossas [políticas de pré-lançamento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

New Relic Teams permite que você conecte a entidade que está monitorando às equipes que as possuem. Quando você consegue ver facilmente quem é o proprietário de uma entidade, você pode acelerar a resolução de problemas, melhorar a colaboração da equipe e melhorar sua eficiência operacional.

## Acesso padrão às equipes

O New Relic fornece acesso padrão ao Teams por meio destas funções padrão:

* **Acesso de leitura**: todos os usuários têm acesso de leitura ao Teams, incluindo metadados como informações de contato, membros da equipe e outros detalhes relevantes.
* **Modificar equipes**: o usuário com a função **Organization Product Admin** pode modificar equipes. Esta é uma nova função atribuída a todos os usuários que atualmente têm a função **All Product Admin**.
* **Criar e excluir equipes**: usuários com funções **Organization Manager** ou **Authentication Manager** podem criar e excluir equipes.

Você pode precisar de uma função personalizada se as permissões padrão não atenderem às necessidades da sua organização. Este tutorial mostra como usar mutações GraphQL do NerdGraph para criar uma função personalizada para gerenciar equipes.

### Visão geral do processo

Para criar uma função personalizada de administrador do Teams, você precisará:

1. [Recuperar todos os recursos do escopo da organização](#retrieve-organization-scoped-capabilities)
2. [Recupere o ID da sua organização](#retrieve-your-organization-id)
3. [Identifique os IDs de permissão necessários para as equipes](#retrieve-organization-scoped-capabilities)
4. [Crie a função personalizada para administrador do Teams](#create-custom-role)
5. [Adicione a função personalizada a um grupo de usuários](#add-custom-role-to-a-user-group)

## Pré-requisitos

Antes de começar, certifique-se de ter:

* [Requisitos gerais do NerdGraph](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#authentication)
* Permissões de função de administrador da organização para criar funções personalizadas

## Mutações [#mutations]

O New Relic fornece várias mutações do NerdGraph para criar funções personalizadas para gerentes de equipe.

<CollapserGroup>
  <Collapser id="retrieve-organization-scoped-capabilities" title="Recuperar capacidades no escopo da organização">
    Use a mutação `customerAdministration` para recuperar uma lista de recursos, seus IDs de permissão e informações relacionadas.

    #### Parâmetro de entrada

    <table>
      <thead>
        <tr>
          <th>
            Parâmetro
          </th>

          <th>
            Tipo de dados
          </th>

          <th>
            É obrigatório?
          </th>

          <th>
            Descrição
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `eq`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            Defina o valor como 

            `organization`

             para recuperar a função para equipes.
          </td>
        </tr>
      </tbody>
    </table>

    #### Solicitação de amostra

    ```graphql
      {
      customerAdministration {
        permissions(filter: {scope: {eq: "organization"}}) {
            items {
              feature
              category
              id
              product
            }
          }
        }
      }

    ```

    #### Resposta de amostra

    ```graphql
    {
      "data": {
        "customerAdministration": {
          "permissions": {
            "items": [
              {
                "category": "READ",
                "feature": "Teams",
                "id": "xxxxx",
                "product": "New Relic One"
              },
              {
                "category": "OTHER",
                "feature": "Teams",
                "id": "xxxxxx",
                "product": "New Relic One"
              },
              {
                "category": "DELETE",
                "feature": "Teams",
                "id": "xxxxx",
                "product": "New Relic One"
              },
              {
                "category": "MODIFY",
                "feature": "Teams",
                "id": "xxxxxx",
                "product": "New Relic One"
              }
            ]
          }
        }
      }
    }

    ```

    **Próximo passo**: A partir da resposta, identifique e copie os IDs de permissão onde:

    * `category: "MANAGE"` (ou a categoria apropriada para suas necessidades)
    * `feature: "Teams"`

    Você precisará desses IDs para a próxima etapa.
  </Collapser>

  <Collapser id="retrieve-your-organization-id" title="Recupere o ID da sua organização">
    Recupere o ID da sua organização, que você usará em mutações subsequentes.

    #### Solicitação de amostra

    ```graphql
      {
      actor {
        organization {
          id
          }
        }
      }

    ```

    #### Resposta de amostra

    ```graphql
    {
      "data": {
        "actor": {
          "organization": {
            "id": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"
          }
        }
      }
    }

    ```

    **Próximo passo**: copie o ID da sua organização da resposta. Você precisará dele para criar a função personalizada.
  </Collapser>

  <Collapser id="create-custom-role" title="Criar função personalizada">
    Use a mutação `customRoleCreate` para criar sua função personalizada para gerenciamento de equipes.

    #### Parâmetro de entrada

    <table>
      <thead>
        <tr>
          <th>
            Parâmetro
          </th>

          <th>
            Tipo de dados
          </th>

          <th>
            É obrigatório?
          </th>

          <th>
            Descrição
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `id`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            O ID da organização copiada na etapa anterior.
          </td>
        </tr>

        <tr>
          <td>
            `type`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            Defina o tipo como 

            `organization`

            .
          </td>
        </tr>

        <tr>
          <td>
            `name`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            O nome da função.
          </td>
        </tr>

        <tr>
          <td>
            `permissionId`
          </td>

          <td>
            Matriz de inteiros
          </td>

          <td>
            Sim
          </td>

          <td>
            Os IDs de permissão para o recurso do Teams recuperados na primeira etapa.
          </td>
        </tr>

        <tr>
          <td>
            `scope`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            Defina o escopo como 

            `organization`

            .
          </td>
        </tr>
      </tbody>
    </table>

    #### Solicitação de amostra

    ```graphql

    mutation {
      customRoleCreate(
        container: {id: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX", type: "organization"}
        name: "Teams manager"
        permissionIds: [xxxxx, xxxxx]
        scope: "organization"
      ) {
        id
      }
    }

    ```

    #### Resposta de amostra

    ```graphql

    {
      "data": {
        "customRoleCreate": {
          "id": 9999999
        }
      }
    }

    ```

    **Próxima etapa**: salve o ID da função retornado. Você precisará dele para atribuir essa função a um grupo de usuários.
  </Collapser>

  <Collapser id="add-custom-role-to-a-user-group" title="Adicionar função personalizada a um grupo de usuários">
    Depois de criar a função personalizada, você precisa atribuí-la a um grupo de usuários no New Relic.

    ### Etapa 1: recuperar IDs de grupo

    Use a mutação `customerAdministration` para obter uma lista de grupos de usuários disponíveis.

    #### Parâmetro de entrada

    <table>
      <thead>
        <tr>
          <th>
            Parâmetro
          </th>

          <th>
            Tipo de dados
          </th>

          <th>
            É obrigatório?
          </th>

          <th>
            Descrição
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `id`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            O ID da organização copiada na etapa anterior.
          </td>
        </tr>
      </tbody>
    </table>

    #### Solicitação de amostra

    ```graphql

    {
      customerAdministration {
        groups(filter: {organizationId: {eq: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}}) {
          nextCursor
          items {
            id
            name
            users {
              items {
                id
                email
              }
            }
          }
        }
      }
    }

    ```

    **Próxima etapa**: na resposta, copie o ID do grupo ao qual você deseja atribuir a função Equipes.

    ### Etapa 2: atribuir a função a um grupo de usuários

    Use a mutação `authorizationManagementGrantAccess` para atribuir a função personalizada a um grupo de usuários.

    #### Parâmetro de entrada

    <table>
      <thead>
        <tr>
          <th>
            Parâmetro
          </th>

          <th>
            Tipo de dados
          </th>

          <th>
            É obrigatório?
          </th>

          <th>
            Descrição
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `roleId`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            O ID da função personalizada da etapa anterior.
          </td>
        </tr>

        <tr>
          <td>
            `groupId`
          </td>

          <td>
            Corda
          </td>

          <td>
            Sim
          </td>

          <td>
            O ID do grupo da Etapa 1.
          </td>
        </tr>
      </tbody>
    </table>

    #### Solicitação de amostra

    ```graphql
    mutation {
      authorizationManagementGrantAccess(
        grantAccessOptions: {organizationAccessGrants: {roleId: "99999999"}, groupId: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}
      ) {
        roles {
          id
          name
          organizationId
          roleId
          groupId
          displayName
        }
      }
    }

    ```

    #### Resposta de amostra

    ```graphql
    {
      "data": {
        "authorizationManagementGrantAccess": {
          "roles": [
            {
              "displayName": "Teams manager",
              "groupId": null,
              "id": "99999999",
              "name": "teams_manager",
              "organizationId": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX",
              "roleId": 99999
            }
          ]
        }
      }
    }

    ```
  </Collapser>
</CollapserGroup>

## Qual é o próximo

Após criar e atribuir com sucesso sua função personalizada do Teams, o usuário no grupo atribuído terá as permissões que você configurou. Você pode:

* Monitore o uso da função através do gerenciamento de usuários da sua organização
* Modifique as permissões de função, se necessário, usando mutações semelhantes do NerdGraph
* Crie funções personalizadas adicionais para diferentes níveis de acesso às equipes

Para obter mais informações sobre o Teams, consulte nossa [documentação do Teams](/docs/service-architecture-intelligence/teams/teams/).