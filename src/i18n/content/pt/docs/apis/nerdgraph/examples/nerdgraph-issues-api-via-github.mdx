---
title: 'Tutorial NerdGraph: Problema e incidente consulta API'
metaDescription: Configure issues in alerts and applied intelligence
freshnessValidatedDate: never
translationType: machine
---

Esta página é um lugar para você e sua equipe aprenderem como consultar seus dados em busca de problemas e incidentes e então configurar recursos usando nossa API NerdGraph.

Nossos dois principais tipos de dados são `Issue Type` e `Incident Type`.

## Tipo de problema [#issue-type]

Você pode aprender mais sobre os tipos de dados do New Relic aqui:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Nome
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `accountIds`
      </td>

      <td>
        \[Int!]!
      </td>

      <td>
        Uma lista de IDs de conta. Como um problema pode estar correlacionado com outros de outras contas.
      </td>
    </tr>

    <tr>
      <td>
        `acknowledgedAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o problema foi reconhecido.
      </td>
    </tr>

    <tr>
      <td>
        `acknowledgedBy`
      </td>

      <td>
        Corda
      </td>

      <td>
        O usuário que reconheceu o problema.
      </td>
    </tr>

    <tr>
      <td>
        `activatedAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o problema foi ativado: createAt + gracePeriod.
      </td>
    </tr>

    <tr>
      <td>
        `closedAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o problema foi encerrado.
      </td>
    </tr>

    <tr>
      <td>
        `closedBy`
      </td>

      <td>
        Corda
      </td>

      <td>
        O usuário que fechou o problema manualmente.
      </td>
    </tr>

    <tr>
      <td>
        `createdAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o problema foi criado.
      </td>
    </tr>

    <tr>
      <td>
        `description`
      </td>

      <td>
        \[String!]!
      </td>

      <td>
        Uma lista de descrições de incidentes.
      </td>
    </tr>

    <tr>
      <td>
        `entityGuids`
      </td>

      <td>
        \[EntityGuid!]
      </td>

      <td>
        Uma lista de identificadores de entidade exclusivos.
      </td>
    </tr>

    <tr>
      <td>
        `entityNames`
      </td>

      <td>
        \[String!]
      </td>

      <td>
        Uma lista de nomes de entidades.
      </td>
    </tr>

    <tr>
      <td>
        `entityTypes`
      </td>

      <td>
        \[String!]
      </td>

      <td>
        Uma lista de tipos de entidade.
      </td>
    </tr>

    <tr>
      <td>
        `environmentId`
      </td>

      <td>
        \[Int!]!
      </td>

      <td>
        Consulte [a visão geral dos alertas](/docs/alerts-applied-intelligence/applied-intelligence/incident-intelligence/get-started-incident-intelligence/) para saber mais sobre os ambientes.
      </td>
    </tr>

    <tr>
      <td>
        `eventType`
      </td>

      <td>
        Corda!
      </td>

      <td>
        Um evento de problema que pode ser `INCIDENT_ADDED`, `USER_ACTION`, `INCIDENT_CLOSED`, etc.
      </td>
    </tr>

    <tr>
      <td>
        `incidentIds`
      </td>

      <td>
        \[String!]
      </td>

      <td>
        Uma lista de IDs de incidentes nesta edição. Em alguns casos, pode haver milhares de incidentes em um problema.
      </td>
    </tr>

    <tr>
      <td>
        `isCorrelated`
      </td>

      <td>
        Boleano!
      </td>

      <td>
        Verdadeiro significa que outras questões foram correlacionadas a esta.
      </td>
    </tr>

    <tr>
      <td>
        `isIdle`
      </td>

      <td>
        Boleano!
      </td>

      <td>
        Consulte nossa documentação para saber mais sobre problemas de inatividade.
      </td>
    </tr>

    <tr>
      <td>
        `issueId`
      </td>

      <td>
        EU IA!
      </td>

      <td>
        Identificador de problemas.
      </td>
    </tr>

    <tr>
      <td>
        `origins`
      </td>

      <td>
        \[String!]!
      </td>

      <td>
        Uma lista de origens de incidentes como incidente, anomalia e externa.
      </td>
    </tr>

    <tr>
      <td>
        `priority`
      </td>

      <td>
        Prioridade!
      </td>

      <td>
        A prioridade do problema. Pode ser um dos seguintes: `LOW`, `MEDIUM`, `HIGH`, `CRITICAL`.
      </td>
    </tr>

    <tr>
      <td>
        `sources`
      </td>

      <td>
        \[String!]!
      </td>

      <td>
        Uma lista de fontes do incidente como newrelic ou externa.
      </td>
    </tr>

    <tr>
      <td>
        `state`
      </td>

      <td>
        Estado da questão!
      </td>

      <td>
        O estado do problema pode ser um dos seguintes: `CREATED`, `ACTIVATED`, `DEACTIVATED`, `CLOSED`.
      </td>
    </tr>

    <tr>
      <td>
        `title`
      </td>

      <td>
        \[String!]!
      </td>

      <td>
        Uma lista de títulos de incidentes subjacentes.
      </td>
    </tr>

    <tr>
      <td>
        `totalIncidents`
      </td>

      <td>
        Int!
      </td>

      <td>
        A contagem do incidente subjacente.
      </td>
    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        EpochMilliseconds!
      </td>

      <td>
        A hora em que o problema foi atualizado pela última vez.
      </td>
    </tr>
  </tbody>
</table>

## Ciclo de vida e estado do problema [#issue-lifecycle]

Problemas de inatividade:

* Um problema pode ficar ocioso se for muito grande, o que significa que contém 5.000 incidentes ou mais.
* Uma questão ociosa não aceita mais nenhum incidente.
* Um problema de inatividade não se correlacionará com outros problemas.

## Tipo de incidente [#incident-type]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Campo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `accountIds`
      </td>

      <td>
        Corda
      </td>

      <td>
        Um ID de conta em que este incidente está armazenado.
      </td>
    </tr>

    <tr>
      <td>
        `closedAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o incidente foi encerrado.
      </td>
    </tr>

    <tr>
      <td>
        `createdAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o incidente foi criado.
      </td>
    </tr>

    <tr>
      <td>
        `description`
      </td>

      <td>
        Corda
      </td>

      <td>
        A descrição é gerada a partir do nome da política e do nome da condição ou fornecida por meio da API.
      </td>
    </tr>

    <tr>
      <td>
        `entityGuids`
      </td>

      <td>
        EntityGuid
      </td>

      <td>
        Um identificador de entidade exclusivo.
      </td>
    </tr>

    <tr>
      <td>
        `entityNames`
      </td>

      <td>
        Corda
      </td>

      <td>
        Um nome de entidade.
      </td>
    </tr>

    <tr>
      <td>
        `entityTypes`
      </td>

      <td>
        Corda
      </td>

      <td>
        Um tipo de entidade.
      </td>
    </tr>

    <tr>
      <td>
        `environmentId`
      </td>

      <td>
        Int!
      </td>

      <td>
        Consulte [nossa documentação](/docs/alerts-applied-intelligence/applied-intelligence/incident-intelligence/get-started-incident-intelligence/) para aprender sobre ambientes.
      </td>
    </tr>

    <tr>
      <td>
        `incidentId`
      </td>

      <td>
        EU IA
      </td>

      <td>
        Identificador de incidentes.
      </td>
    </tr>

    <tr>
      <td>
        `priority`
      </td>

      <td>
        Prioridade
      </td>

      <td>
        Prioridade do incidente. Pode ser um dos seguintes: `LOW`, `MEDIUM`, `HIGH`, `CRITICAL`.
      </td>
    </tr>

    <tr>
      <td>
        `state`
      </td>

      <td>
        Estado do Incidente.
      </td>

      <td>
        Estado do incidente. Pode ser um dos seguintes:`CREATED`, `CLOSED`.
      </td>
    </tr>

    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        Timestamp do evento de incidente.
      </td>
    </tr>

    <tr>
      <td>
        `title`
      </td>

      <td>
        Corda
      </td>

      <td>
        A descrição que o usuário forneceu à condição, se fornecida.
      </td>
    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        EpochMilliseconds
      </td>

      <td>
        A hora em que o incidente foi atualizado pela última vez.
      </td>
    </tr>

    <tr>
      <td>
        `anomalyId`
      </td>

      <td>
        Opcional
      </td>

      <td>
        Se este incidente tiver origem em uma anomalia da New Relic, ele terá um ID de anomalia.
      </td>
    </tr>

    <tr>
      <td>
        `conditionFamilyId`
      </td>

      <td>
        Opcional
      </td>

      <td>
        O ID da condição
      </td>
    </tr>

    <tr>
      <td>
        `policyIds`
      </td>

      <td>
        Corda
      </td>

      <td>
        O ID da política que gerou este incidente.
      </td>
    </tr>

    <tr>
      <td>
        `aggregationTags`
      </td>

      <td>
        \[KeyValue!]
      </td>

      <td>
        Agregação de tags relacionadas a este incidente.
      </td>
    </tr>
  </tbody>
</table>

## Listar e filtrar problemas [#list-filter-issues]

A consulta `issues` permite paginar todos os seus problemas por conta. Também permite algumas funcionalidades de filtragem sobre os problemas.

<CollapserGroup>
  <Collapser id="list-issues" title="Listar problemas">
    Se você não fornecer dados de filtragem, receberá os dados do problema das últimas 24 horas.

    ### Solicitar

    ```graphql
    {
      actor {
        account(id: ACCOUNT_ID) {
          aiIssues {
            issues {
              issues {
                issueId
                priority
                state
                title
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "issueId": "f0668430-60c4-4bfd-8188-fcbeefb1d5ca",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": [
                      "NrAiIncident query result is > 30.0 for 1 minutes on 'ROI test for photon with checkbox'"
                    ]
                  },
                  {
                    "issueId": "12427573-fe89-4be1-9411-30158e0a9874",
                    "priority": "MEDIUM",
                    "state": "CLOSED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
                  {
                    "issueId": "2b3fcffe-5330-4766-bc51-392b6db5eedc",
                    "priority": "MEDIUM",
                    "state": "CLOSED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
    ```
  </Collapser>

  <Collapser id="cursor" title="Paginação do cursor">
    Observe que o número máximo de problemas que podem ser retornados por meio da paginação é definido pelo NRQL [`LIMIT` MAX](/docs.newrelic.com/docs/nrql/nrql-syntax-clauses-functions/#sel-limit) e a filtragem será necessária se esse limite for excedido.

    ### Solicitação Inicial

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issues(cursor: "") {
              issues {
                issueId
                priority
                state
                title
              }
              nextCursor
            }
          }
        }
      }
    }
    ```

    ### Resultados iniciais

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "issueId": "bda33b52-c70b-47b9-abe3-9e859a394037",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "Signal lost for 5 minutes on 'Percent All Facet'"
                    ]
                  },
                  {
                    "issueId": "242c713c-7654-491c-808e-3aa7fc44812b",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": [
                      "Anomaly: Non-web throughput"
                    ]
                  },
                  {
                    "issueId": "f19c9803-fb24-4d5d-9c35-16f659bceb3a",
                    "priority": "MEDIUM",
                    "state": "CLOSED",
                    "title": [
                      "Anomaly: Error rate"
                    ]
                  }
                ],
                "nextCursor": "=ATN"
              }
            }
          }
        }
      },
    ```

    Em seguida, na solicitação subsequente, forneça o valor do cursor da `nextCursor` resposta anterior, até que `nextCursor` esteja vazio.

    A solicitação subsequente deve ser semelhante a:

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issues(cursor: "=ATN") {
              issues {
                issueId
                priority
                state
                title
              }
              nextCursor
            }
          }
        }
      }
    }
    ```
  </Collapser>

  <Collapser id="filter" title="Problemas de filtro">
    Filtre os problemas por guias de entidade, tipos de entidade, prioridade de problemas ou estados de problemas ou qualquer combinação desses atributos.

    ```graphql
    "Filter issues"
    input FilterIssues {
      "entityGuids"
      entityGuids: [EntityGuid!]
      "entityTypes"
      entityTypes: [String!]
      "ids"
      ids: [ID!]
      "priority"
      priority: [String!]
      "states"
      states: [IssueState!]
    }
    ```

    Aqui `entityGuides` e `entityTypes` são atributo de entidade definido na página [Saiba mais sobre as entidades da New Relic](/docs/new-relic-solutions/new-relic-one/core-concepts/what-entity-new-relic/) .

    * A prioridade do problema pode ser uma das seguintes: `LOW`, `MEDIUM`, `HIGH`, `CRITICAL`
    * Os estados do problema podem ser um dos seguintes: `CREATED`, `ACTIVATED`, `DEACTIVATED`, `CLOSED`
    * `timeWindow` com horários de início e término no formato EpochMilliseconds. Se não for fornecido, o valor padrão será as últimas 24 horas
    * E `cursor` como já vimos

    Vamos encontrar problemas com prioridade `CRITICAL` e estado `CLOSED`:

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issues(filter: {priority: "CRITICAL", states: CLOSED}) {
              issues {
                issueId
                priority
                state
                title
              }
              nextCursor
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "issueId": "5948472b-f7dd-4a6e-aec0-de0390732495",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "team_store_validation_error query result is > 0.0 on 'Team Store Domain Specific Validation Error'"
                    ]
                  },
                  {
                    "issueId": "570c2770-efd2-4c0f-8dc8-fbc1ae69a4df",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "PageViewTiming query deviated from the baseline at least once in 5 minutes on 'Onyx_check_Mark test'"
                    ]
                  },
                  {
                    "issueId": "d056be64-829e-4a83-bfb1-e3232eb3a59b",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "Transaction query result is > 2.0 on 'Error fetching commitments (TF)'"
                    ]
                  },
    ```

    Os resultados podem ser filtrados ainda mais por `entityGuid`.

    ```graphql
    {
      actor {
        account(id: 1) {
          aiIssues {
            issues(filter: {priority: "CRITICAL", states: CLOSED, 
              entityGuids: ["MXxBUE18QVBQTElDQVRJT058MzIxNjY2NA", "MXxBUE18QVBQTElDQVRJT058MzIxNzY1NA"]}) {
              issues {
                entityTypes
                entityNames
                entityGuids
                issueId
                priority
                state
                title
              }
              nextCursor
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "entityGuids": [
                      "MXxBUE18QVBQTElDQVRJT058MzIxNjY2NA",
                      "MXxBUE18QVBQTElDQVRJT058MzIxNzY1NA"
                    ],
                    "entityNames": [
                      "hour-timeslice-writer (eu-production)",
                      "metric-timeslice-service (eu-production)"
                    ],
                    "entityTypes": [
                      "Application"
                    ],
                    "issueId": "1a3a0581-aefc-4027-91a0-a941072101c0",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "'Custom/CassandraClient/hour_timeslice_cluster_main/percentile/95th' > 0.5 for at least 5 minutes on 'hour-timeslice-writer (eu-production)'",
                      "'Custom/CassandraClient/hour_timeslice_cluster_main/percentile/95th' > 0.5 for at least 5 minutes on 'metric-timeslice-service (eu-production)'"
                    ]
                  },
                  {
                    "entityGuids": [
                      "MXxBUE18QVBQTElDQVRJT058MzIxNzY1NA"
                    ],
                    "entityNames": [
                      "metric-timeslice-service (eu-production)"
                    ],
                    "entityTypes": [
                      "Application"
                    ],
                    "issueId": "fd5fda9e-6bfe-469a-8cf7-822986401033",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "'Custom/CassandraClient/hour_timeslice_cluster_main/percentile/95th' > 0.5 for at least 5 minutes on 'metric-timeslice-service (eu-production)'"
                    ]
                  }
                ],
                "nextCursor": null
              }
    ```
  </Collapser>

  <Collapser id="find" title="Encontre problemas por ID">
    O NerdGraph também permite consultar por ID do problema.

    ### Solicitar

    ```graphql
    {
      actor {
        account(id: 1) {
          aiIssues {
            issues(filter: {ids: ["e506476f-d804-4e5c-92b5-da8db622f10d", 
            "1bd514d9-2682-4366-8f28-5d742fd000af"]}) {
              issues {
                entityTypes
                entityNames
                entityGuids
                issueId
                priority
                state
                title
              }
              nextCursor
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "entityGuids": [
                      ""
                    ],
                    "entityNames": [
                      "Metric query"
                    ],
                    "entityTypes": [
                      "Query"
                    ],
                    "issueId": "e506476f-d804-4e5c-92b5-da8db622f10d",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "Metric query result is > 1.4 for 1 minutes on 'Hillel March Demo'"
                    ]
                  },
                  {
                    "entityGuids": [
                      "MXxFWFR8U0VSVklDRXw1ODIzMTc1ODk4Mjc1OTI4Mjk5"
                    ],
                    "entityNames": [
                      "clm-10"
                    ],
                    "entityTypes": [
                      "Query"
                    ],
                    "issueId": "1bd514d9-2682-4366-8f28-5d742fd000af",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": [
                      "clm-10 query result is > 30.0 for 7 minutes on 'SPIKE: signal-accumulation-service (production) — Kafka lag'"
                    ]
                  }
                ],
                "nextCursor": null
              }
            }
    ```
  </Collapser>
</CollapserGroup>

## Listar e filtrar evento de problema [#list-filter-issue-events]

A consulta `issuesEvents` permite paginar todos os seus problemas por conta. Também permite alguma funcionalidade de filtragem no evento de problemas.

<CollapserGroup>
  <Collapser id="list-issue-events" title="Listar evento de problemas">
    Se você não fornecer nenhum dado de filtragem, receberá os dados do evento de problema das últimas 24 horas.

    ### Solicitar

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issuesEvents {
              issues {
                issueId
                priority
                state
                title
                eventType
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issuesEvents": {
                "issues": [
                  {
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "e6da1499-cb1c-4522-bb04-6fdb487e8e2b",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "notification-request-builder query result is < 10.0 for 1 minutes on 'error logs in nrb'",
                      "notification-request-builder query result is > 1600.0 for 5 minutes on 'nrb debug logs'"
                    ]
                  },
                  {
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "e6da1499-cb1c-4522-bb04-6fdb487e8e2b",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "notification-request-builder query result is < 10.0 for 1 minutes on 'error logs in nrb'",
                      "notification-request-builder query result is > 1600.0 for 5 minutes on 'nrb debug logs'"
                    ]
                  },
                  {
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "e6da1499-cb1c-4522-bb04-6fdb487e8e2b",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "notification-request-builder query result is < 10.0 for 1 minutes on 'error logs in nrb'",
                      "notification-request-builder query result is > 1600.0 for 5 minutes on 'nrb debug logs'"
                    ]
                  },
                  {
                    "eventType": "INCIDENT_ADDED",
                    "issueId": "e6da1499-cb1c-4522-bb04-6fdb487e8e2b",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "notification-request-builder query result is < 10.0 for 1 minutes on 'error logs in nrb'",
                      "notification-request-builder query result is > 1600.0 for 5 minutes on 'nrb debug logs'"
                    ]
                  },

    ```
  </Collapser>

  <Collapser className="freq-link" id="filter-issues-events" title="Evento de problema de filtro">
    Filtre o evento do problema por `entityGuids`, `entityTypes`, prioridade dos problemas ou estados do problema ou qualquer combinação desses atributos.

    ```graphql
    "Filter issues events"
    input FilterIssuesEvents {
      "entityGuids"
      entityGuids: [EntityGuid!]
      "entityTypes"
      entityTypes: [String!]
      "ids"
      ids: [ID!]
    }
    ```

    * `timeWindow` com horários de início e término no formato `EpochMilliseconds` . Se não for fornecido, o valor padrão será as últimas 24 horas
    * E `cursor` como já vimos

    Vamos encontrar `issuesEvents` para um `issueId` específico.

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issuesEvents(filter: {ids: "fe0d512f-36c7-4b7a-8a80-4c47c040807a"}) {
              issues {
                issueId
                priority
                state
                title
                eventType
                entityGuids
              }
            }
          }
        }
      }
    }
    ```

    <DNT>
      **Results**
    </DNT>

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issuesEvents": {
                "issues": [
                  {
                    "entityGuids": [
                      "MXxTWU5USHxNT05JVE9SfGUyMzA0MjczLTQzNjUtNDRlZS1iODcxLTM5MGRhNDc1ODUxNA"
                    ],
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "fe0d512f-36c7-4b7a-8a80-4c47c040807a",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "Test for alert emails query result is > 1.0 for 1 minutes on 'Matan email condition'"
                    ]
                  },
                  {
                    "entityGuids": [
                      "MXxTWU5USHxNT05JVE9SfGUyMzA0MjczLTQzNjUtNDRlZS1iODcxLTM5MGRhNDc1ODUxNA"
                    ],
                    "eventType": "STATE_CHANGE",
                    "issueId": "fe0d512f-36c7-4b7a-8a80-4c47c040807a",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "Test for alert emails query result is > 1.0 for 1 minutes on 'Matan email condition'"
                    ]
                  },
                  {
                    "entityGuids": [
                      "MXxTWU5USHxNT05JVE9SfGUyMzA0MjczLTQzNjUtNDRlZS1iODcxLTM5MGRhNDc1ODUxNA"
                    ],
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "fe0d512f-36c7-4b7a-8a80-4c47c040807a",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": [
                      "Test for alert emails query result is > 1.0 for 1 minutes on 'Matan email condition'"
                    ]
                  },
                  {
                    "entityGuids": [
                      "MXxTWU5USHxNT05JVE9SfGUyMzA0MjczLTQzNjUtNDRlZS1iODcxLTM5MGRhNDc1ODUxNA"
                    ],
                    "eventType": "ATTRIBUTES_UPDATED",
                    "issueId": "fe0d512f-36c7-4b7a-8a80-4c47c040807a",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": [
                      "Test for alert emails query result is > 1.0 for 1 minutes on 'Matan email condition'"
                    ]
                  },
    ...
    ```
  </Collapser>
</CollapserGroup>

## Listar e filtrar incidentes [#list-filter-incidents]

A consulta `incidents` permite paginar todos os seus incidentes por conta. Também permite alguma funcionalidade de filtragem em cada incidente.

Os seguintes tipos de incidente são suportados:

* NewRelicIncident
* AnomalyIncident
* RestIncident

<CollapserGroup>
  <Collapser id="list incidents" title="Listar incidente">
    Se você não fornecer nenhum dado de filtragem, receberá os dados do incidente das últimas 24 horas.

    O exemplo abaixo busca `NewRelicIncident` incidente:

    ### Solicitações de

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            incidents {
              incidents {
                priority
                state
                title
                description
                incidentId
                updatedAt
                ... on AiIssuesNewRelicIncident {
                  policyIds
                  conditionFamilyId
                  accountIds
                }
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "incidents": {
                "incidents": [
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "685305",
                    "description": [
                      "Policy: 'Roi nov Test'. Condition: 'RB PV '"
                    ],
                    "incidentId": "a86493e4-2d25-4023-a9e5-975bfaae19a8",
                    "policyIds": "195617",
                    "priority": "HIGH",
                    "state": "CREATED",
                    "title": "[\"PageView query result is > 1.3 for 2 minutes on 'RB PV '\"]",
                    "updatedAt": 1651058532782
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "1284850",
                    "description": [
                      "Policy: 'Itzik first policy'. Condition: 'error logs in nrb'"
                    ],
                    "incidentId": "5de80214-6444-4e0c-aaee-fb1c42fb2f23",
                    "policyIds": "707052",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"notification-request-builder query result is < 10.0 for 1 minutes on 'error logs in nrb'\"]",
                    "updatedAt": 1651058523473
                  },
                  {
                    "description": [
                      "Anomaly: Error rate"
                    ],
                    "incidentId": "df4ba4f3-9463-4389-873f-b13efb67dca5",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": "[\"Anomaly: Error rate\"]",
                    "updatedAt": 1651058478828
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "685305",
                    "description": [
                      "Policy: 'Roi nov Test'. Condition: 'RB PV '"
                    ],
                    "incidentId": "0063f153-9152-476d-b435-54cc38ce0245",
                    "policyIds": "195617",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"PageView query result is > 1.3 on 'RB PV '\"]",
                    "updatedAt": 1651058472738
                  },
                  {
                    "description": [
                      "Anomaly: It was different from normal"
                    ],
                    "incidentId": "2cb820d1-a070-4c27-860b-fb862ecd42a7",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": "[\"Anomaly: It was different from normal\"]",
                    "updatedAt": 1651058449078
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "751197",
                    "description": [
                      "Policy: 'slide_Test'. Condition: 'SumOf'"
                    ],
                    "incidentId": "07104b47-0263-4529-b27d-6aff95eecd87",
                    "policyIds": "199127",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"TransactionError query result is > 3.0 on 'SumOf'\"]",
                    "updatedAt": 1651058442361
                  },
    ```
  </Collapser>

  <Collapser id="filter-incidents" title="Filtrar incidente">
    ### Paginação do cursor

    Observe que o número máximo de incidentes que podem ser retornados através da paginação é definido pelo NRQL [LIMIT MAX](/docs.newrelic.com/docs/nrql/nrql-syntax-clauses-functions/#sel-limit), e a filtragem será necessária caso esse limite seja excedido.

    ### Filtrar incidente

    Filtre por guias de entidade, tipos de entidade, prioridade de problemas ou estados de problemas ou qualquer combinação deles.

    ```graphql
    "Filter incidents"
    input FilterIncidents {
      "entityGuids"
      entityGuids: [EntityGuid!]
      "entityTypes"
      entityTypes: [String!]
      "ids"
      ids: [ID!]
      "priority"
      priority: [String!]
      "states"
      states: [IncidentState!]
    }
    ```

    * `timeWindow` com horários de início e término no formato `EpochMilliseconds` . Se não for fornecido, o valor padrão será as últimas 24 horas.
    * E `cursor` como já vimos.
    * Vamos encontrar o incidente com prioridade `CRITICAL` e estado `CREATED`.

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            incidents(filter: {priority: "CRITICAL", states: CREATED}) {
              incidents {
                priority
                state
                title
                description
                incidentId
                updatedAt
                ... on AiIssuesNewRelicIncident {
                  policyIds
                  conditionFamilyId
                  accountIds
                }
              }
            }
          }
        }
      }
    }

    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "incidents": {
                "incidents": [
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "195908",
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Production'"
                    ],
                    "incidentId": "44630d21-9d32-4107-a308-3ed1c4f72bce",
                    "policyIds": "40053",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Production'\"]",
                    "updatedAt": 1651059983674
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "195908",
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Production'"
                    ],
                    "incidentId": "3e2b2b2a-e45b-46d6-b45d-637b74b5efda",
                    "policyIds": "40053",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Production'\"]",
                    "updatedAt": 1651059983607
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "195907",
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Staging'"
                    ],
                    "incidentId": "6e934358-d16b-494d-abb2-6300c4d96f11",
                    "policyIds": "40053",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Staging'\"]",
                    "updatedAt": 1651059983223
                  },
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "195907",
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Staging'"
                    ],
                    "incidentId": "97373770-caad-46cd-a69d-a358de3be090",
                    "policyIds": "40053",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Staging'\"]",
                    "updatedAt": 1651059983059
                  },

    ```
  </Collapser>

  <Collapser id="find-incidents-by-id" title="Encontre incidentes por ID do incidente">
    A API permite consultar por ID de incidente:

    ### Solicitar

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            incidents(filter: {ids: "97373770-caad-46cd-a69d-a358de3be090"}) {
              incidents {
                priority
                state
                title
                description
                incidentId
                updatedAt
                ... on AiIssuesNewRelicIncident {
                  policyIds
                  conditionFamilyId
                  accountIds
                }
              }
            }
          }
        }
      }
    }

    ```

    ### Resultado

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "incidents": {
                "incidents": [
                  {
                    "accountIds": "1",
                    "conditionFamilyId": "195907",
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Staging'"
                    ],
                    "incidentId": "97373770-caad-46cd-a69d-a358de3be090",
                    "policyIds": "40053",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Staging'\"]",
                    "updatedAt": 1651059983059
                  }
                ]
              }
            }
          }
        }
      },

    ```
  </Collapser>
</CollapserGroup>

## Listar e filtrar evento de incidente [#list-filter-incident-events]

A consulta `incidentsEvents` permite paginar todos os seus eventos de incidente por conta. Também permite algumas funcionalidades de filtragem no evento de incidente.

<CollapserGroup>
  <Collapser id="list-incident-events" title="Listar evento de incidente">
    Se você não fornecer nenhum dado de filtragem, você obterá os dados do evento incidente das últimas 24 horas.

    ### Solicitar

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            incidentsEvents {
              incidents {
                priority
                incidentId
                state
                title
                updatedAt
                description
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "incidentsEvents": {
                "incidents": [
                  {
                    "description": [
                      "Policy: 'e2e: hrr9ISoLd'. Condition: 'e2e: VceqCmtcT'"
                    ],
                    "incidentId": "693b7dcb-5a6b-4923-acaa-9d4e7e568ae5",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": "[\"Provider . Burst Balance . Average < 1 at least once in 2 minutes on 'vol-03e3199dd4b4ffac4'\"]",
                    "updatedAt": 1651060591602
                  },
                  {
                    "description": [
                      "Policy: 'e2e: hrr9ISoLd'. Condition: 'e2e: VceqCmtcT'"
                    ],
                    "incidentId": "fb0dcb8b-052f-4056-8579-ff7cae8fa879",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": "[\"Provider . Burst Balance . Average < 1 at least once in 2 minutes on 'vol-00163b96c3ccd2199'\"]",
                    "updatedAt": 1651060587005
                  },
                  {
                    "description": [
                      "Policy: 'AirMonitor ML Dashboard Staging'. Condition: 'Latency in Staging'"
                    ],
                    "incidentId": "42bcd3e2-bc2d-4a3d-9e85-ebd8597e6eba",
                    "priority": "CRITICAL",
                    "state": "CLOSED",
                    "title": "[\"Metric query result is > 0.69 for 5 minutes on 'Latency in Staging'\"]",
                    "updatedAt": 1651060560312
                  },

    ```
  </Collapser>

  <Collapser id="filter-incident-events" title="Filtrar evento de incidente">
    ### Paginação do cursor

    Para paginar seus dados, você deve incluir o campo `nextCursor` em sua consulta inicial.

    ### Filtrar evento de incidente

    Filtre o evento por guias de entidade, tipos de entidade, prioridade do incidente ou estados do incidente ou qualquer combinação destes.

    ```handlebars
    "Filter incidents events"
    input FilterIncidentsEvents {
      "entityGuids"
      entityGuids: [EntityGuid!]
      "entityTypes"
      entityTypes: [String!]
      "ids"
      ids: [ID!]
    }
    ```

    * `timeWindow` com horários de início e término no formato `EpochMilliseconds` . Se não for fornecido, o valor padrão será as últimas 24 horas.
    * E `cursor` como já vimos.

    Vamos consultar o incidente do evento, para que possamos obter seus &apos;incidentId&apos;s:

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            incidentsEvents(filter: {ids: "cd512082-6ebe-46ac-a6dc-d387dc86dc80"}) {
              incidents {
                priority
                incidentId
                state
                title
                updatedAt
                description
                createdAt
                timestamp
                ... on AiIssuesNewRelicIncident {
                  accountIds
                  policyIds
                }
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "incidentsEvents": {
                "incidents": [
                  {
                    "accountIds": "1",
                    "createdAt": "1651060523109",
                    "description": [
                      "Policy: 'KPT: Low-urgency'. Condition: 'Kafka broker offline'"
                    ],
                    "incidentId": "cd512082-6ebe-46ac-a6dc-d387dc86dc80",
                    "policyIds": "80113",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "timestamp": 1651060523110,
                    "title": "[\"Signal lost for 35 minutes on 'Kafka broker offline'\"]",
                    "updatedAt": 1651060523110
                  },
                  {
                    "accountIds": "1",
                    "createdAt": "1651060523109",
                    "description": [
                      "Policy: 'KPT: Low-urgency'. Condition: 'Kafka broker offline'"
                    ],
                    "incidentId": "cd512082-6ebe-46ac-a6dc-d387dc86dc80",
                    "policyIds": "80113",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "timestamp": 1651060523110,
                    "title": "[\"Signal lost for 35 minutes on 'Kafka broker offline'\"]",
                    "updatedAt": 1651060523110
                  },
                  {
                    "accountIds": "1",
                    "createdAt": "1651060523109",
                    "description": [
                      "Policy: 'KPT: Low-urgency'. Condition: 'Kafka broker offline'"
                    ],
    ```
  </Collapser>
</CollapserGroup>

## Configurar recurso de problemas [#configure-some-issues-features]

O serviço de problemas possui algum parâmetro de configuração.

Para obter o parâmetro de configuração atual para seu ambiente, você pode executar a consulta `configByEnvironment` .

<CollapserGroup>
  <Collapser className="freq-link" id="configbyenvironment" title="Consulta ConfigByEnvironment">
    ### Solicitar

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            configByEnvironment {
              config {
                flappingInterval
                inactivePeriod
                incidentTimeout
                issueTtl
                maxIssueSize
              }
            }
          }
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "configByEnvironment": {
                "config": {
                  "flappingInterval": 0,
                  "gracePeriod": [
                    {
                      "period": 60,
                      "priority": "CRITICAL"
                    },
                    {
                      "period": 300,
                      "priority": "HIGH"
                    },
                    {
                      "period": 600,
                      "priority": "MEDIUM"
                    },
                    {
                      "period": 900,
                      "priority": "LOW"
                    }
                  ],
                  "inactivePeriod": 14400,
                  "incidentTimeout": 90000,
                  "issueTtl": 259200,
                  "maxIssueSize": 5000
                }
              }
            }
          }
        }
      }
    ```

    Aqui, cada configuração de ambiente possui o seguinte parâmetro:

    ```graphql
    "Environment configuration object"
    type EnvironmentConfiguration {
      "Flapping interval in seconds"
      flappingInterval: Seconds
      "Grace periods per priority"
      gracePeriod: [GracePeriodConfig!]
      "Inactive period in seconds"
      inactivePeriod: Seconds
      "Incident timeout in seconds"
      incidentTimeout: Seconds
      "Issue TTL in seconds"
      issueTtl: Seconds
      "Max incidents in the issue"
      maxIssueSize: Int
    }
    ```

    Usando o `mutations` correspondente, você também pode alterar os parâmetros de configuração do ambiente `issueTtl` e `gracePeriod` .

    * `aiIssuesUpdateIssueTtl`
    * `aiIssuesUpdateGracePeriod`

    ### Solicitar

    ```graphql
    mutation {
      aiIssuesUpdateIssueTtl(accountId: YOUR_ACCOUNT_ID, issueTtl: 259200) {
        error
        config {
          flappingInterval
          gracePeriod {
            period
            priority
          }
          inactivePeriod
          incidentTimeout
          issueTtl
          maxIssueSize
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "aiIssuesUpdateIssueTtl": {
          "config": {
            "flappingInterval": 0,
            "gracePeriod": [
              {
                "period": 60,
                "priority": "CRITICAL"
              },
              {
                "period": 300,
                "priority": "HIGH"
              },
              {
                "period": 600,
                "priority": "MEDIUM"
              },
              {
                "period": 900,
                "priority": "LOW"
              }
            ],
            "inactivePeriod": 14400,
            "incidentTimeout": 90000,
            "issueTtl": 259200,
            "maxIssueSize": 5000
          },
          "error": null
        }
      },

    ```
  </Collapser>
</CollapserGroup>

## Reconhecer ou não reconhecer problemas [#resolve-ack-issues]

Usando `mutations` você pode confirmar ou não e resolver o problema específico por meio de seu `issueId`.

* aiIssuesAckIssue
* aiIssuesResolveIssue
* aiIssuesUnackIssue

<CollapserGroup>
  <Collapser className="freq-link" id="ackissues" title="Reconhecer ou não reconhecer problemas">
    ### Solicitar

    ```graphql
    mutation {
      aiIssuesResolveIssue(accountId: 10581561, issueId: "f0846f5e-fc9d-4dc0-afdd-07cce7cc6fc4") {
        error
        result {
          action
          accountId
          issueId
          routingKey
        }
      }
    }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "aiIssuesResolveIssue": {
          "error": null,
          "result": {
            "accountId": 10581561,
            "action": "RESOLVE",
            "issueId": "f0846f5e-fc9d-4dc0-afdd-07cce7cc6fc4",
            "routingKey": "93538a443af520d10e7999fdb183ebf21e4cb6bd"
          }
        }
    ```
  </Collapser>
</CollapserGroup>

## Executando a partir da linha de comando [#running-from-command-line]

Para executar a consulta na linha de comando:

1 Obtenha sua chave de API, busque ou crie uma na [interface API Key](https://staging-one.newrelic.com/api-keys-ui).

2 Exporte-o para o seu shell com `export API_KEY=my_api_key`

3 Execute estes exemplos:

<Callout variant="important">
  Você deve incluir um cabeçalho de aceitação experimental em suas solicitações. Caso contrário, você receberá erros de acesso como este:

  ```json
  {"data":{"actor":{"account":{"aiIssues":{"issues":null}}}},"errors":[{"extensions":{"errorClass":"ACCESS_DENIED","nrOnly":{}},"locations":[{"column":70,"line":1}],"message":"You must opt in to using experimental schemas by passing the 'nerd-graph-unsafe-experimental-opt-in: AiIssues' header.\n\nProviding the header indicates that you acknowlege that the field(s) you are querying are subject to breaking changes.\n","path":["actor","account","aiIssues","issues"]}]}%
  ```
</Callout>

<CollapserGroup>
  <Collapser className="freq-link" id="listallissues" title="Exemplo: liste todos os problemas">
    Liste todos os problemas das últimas 24 horas

    ### Como aparecem as solicitações na interface GraphQL

    ```graphql
    {
      actor {
        account(id: YOUR_ACCOUNT_ID) {
          aiIssues {
            issues {
              issues {
                issueId
                priority
                state
                title
              }
            }
          }
        }
      }
    }
    ```

    ### Na linha de comando a mesma solicitação

    ```json
    {
      "data": {
        "aiIssuesResolveIssue": {
          "error": null,
          "result": {
            "accountId": 10581561,
            "action": "RESOLVE",
            "issueId": "f0846f5e-fc9d-4dc0-afdd-07cce7cc6fc4",
            "routingKey": "93538a443af520d10e7999fdb183ebf21e4cb6bd"
          }
        }
    ```

    ### Resultados

    ```json
    {
      "data": {
        "actor": {
          "account": {
            "aiIssues": {
              "issues": {
                "issues": [
                  {
                    "issueId": "eb152a9f-def7-45bd-9b3f-34ec61ef8c82",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
                  {
                    "issueId": "9ae6a86a-582f-4102-8757-ee11c1a20dfc",
                    "priority": "HIGH",
                    "state": "CREATED",
                    "title": [
                      "Web throughput < 50 for at least 5 minutes on 'error-group-control-plane (staging)'"
                    ]
                  },
                  {
                    "issueId": "e19aa2d0-2b12-4148-aedd-848577e9c4fc",
                    "priority": "CRITICAL",
                    "state": "CREATED",
                    "title": [
                      "clm-10 query result is > 1.0 for 15 minutes on 'NO_CONSUMER'"
                    ]
                  },
                  {
                    "issueId": "9184ab3c-4e45-4bc9-b2a5-f78c23a13197",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
                  {
                    "issueId": "e2d05a25-2a7e-4b3c-b5bf-8a236f2a0360",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
                  {
                    "issueId": "b478bd0e-baa1-42ed-8911-d32249d45010",
                    "priority": "CRITICAL",
                    "state": "ACTIVATED",
                    "title": [
                      "PageViewTiming query deviated from the baseline at least once in 5 minutes on 'Onyx_check_Mark test'"
                    ]
                  },
                  {
                    "issueId": "f672153a-262b-4405-85a7-874709ed21ff",
                    "priority": "MEDIUM",
                    "state": "CREATED",
                    "title": [
                      "Anomaly: It was different from normal"
                    ]
                  },
                  ...
    ```
  </Collapser>
</CollapserGroup>