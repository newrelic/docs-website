---
subject: Python agent
releaseDate: '2025-09-04'
version: 10.17.0
downloadLink: 'https://pypi.python.org/pypi/newrelic'
features:
  - Adds support for custom tasks in Celery
  - Adds support for graphene-django
  - Adds support for middleware filtering in Django
  - Adds support for AWS Bedrock Converse API
  - Adds support for W3CTraceParent header sampled flag
bugs:
  - Safeguard for deepest unique path in GraphQL
  - Safeguard for web request parsing
  - Fix crash in GraphQL
  - Fix crash in ElasticSearch
translationType: machine
---

## Notas

Esta versão do agente Python adiciona suporte para o seguinte:

* Tarefas personalizadas no [Celery](https://pypi.org/project/celery/)
* Monitoramento de [Graphene-Django](https://pypi.org/project/graphene-django/)
* Filtragem de middleware em [Django](https://pypi.org/project/django/)
* API AWS Bedrock [Converse](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-runtime/client/converse.html)
* Sinalizador de amostra do cabeçalho W3CTraceParent

Esta versão também fornece as seguintes correções:

* Salvaguardas para o caminho único mais profundo em GraphQL
* Salvaguardas para análise de solicitações de URL da web
* Alternativa para ElasticSearch e GraphQL quando `trace.settings==None`
* Remover o método `options` da lista de clientes do ElasticSearch assíncrono

Instale o agente usando `easy_install/pip/distribute` por meio do [Índice de Pacotes Python](https://pypi.python.org/pypi/newrelic) ou baixe-o diretamente do [site de download do New Relic](https://download.newrelic.com/python_agent/release).

## Novo recurso

* Adiciona suporte para tarefas personalizadas no Celery

  * Adicione suporte de monitoramento para classes de tarefas personalizadas no [Celery](https://pypi.org/project/celery/). Anteriormente, somente tarefas que usavam a classe de tarefa padrão podiam ser monitoradas. Observação: esta versão do agente Python não oferecerá mais suporte a versões do Celery anteriores à [v5.2.0](https://github.com/celery/celery/releases/tag/v5.2.0).

* Adiciona suporte para Graphene-Django

  * Adicione suporte de monitoramento para esquemas síncronos criados com [Graphene-Django](https://pypi.org/project/graphene-django/). Anteriormente, esquemas criados com Graphene-Django eram monitorados apenas parcialmente, resultando na ausência de atributos relacionados [GraphQL](https://pypi.org/project/graphql-core/).

* Adiciona suporte para filtragem de middleware no Django

  * Os usuários agora podem filtrar qual middleware [Django](https://pypi.org/project/django/) monitorar. Agora há [três configurações adicionais](/docs/apm/agents/python-agent/configuration/python-agent-configuration/#middleware-filters):

    * `instrumentation.middleware.django.enabled` (O padrão é `true`)
    * `instrumentation.middleware.django.exclude`
    * `instrumentation.middleware.django.include`

  Veja a [página Filtragem de Middleware do Django](/docs/apm/agents/python-agent/supported-features/django-middleware-filtering/) para mais informações e exemplos.

* Adiciona suporte para a API AWS Bedrock Converse

  * Adicione suporte de monitoramento para API [Converse](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-runtime/client/converse.html) não streaming. Isso inclui suporte para `converse` chamadas de conclusão de bate-papo feitas usando clientes `boto3` e `aioboto3`.

* Adiciona suporte para o sinalizador de amostra do cabeçalho W3CTraceParent

  * Quando um serviço upstream envia o cabeçalho W3CTraceParent com o sinalizador de amostragem definido, o New Relic levará em consideração essa decisão de amostragem ao decidir se a transação atual será amostrada.

* Suporte adicionado para decisões de amostragem com base na amostragem do pai remoto

  * Adicionado suporte para duas novas opções de configuração:

    * `distributed_tracing.sampler.remote_parent_sampled`
    * `distributed_tracing.sampler.remote_parent_not_sampled`

  * `default` é o comportamento padrão e se comporta como antes dessa alteração (ele passa a decisão de amostragem para o algoritmo de amostragem adaptável para determinar se a transação será amostrada).

  * `always_on` significa que o trace que tem um pai remoto amostrado ou um pai remoto não amostrado sempre será amostrado.

  * `always_off` significa que o trace que tem um pai remoto amostrado ou um pai remoto não amostrado nunca será amostrado.

## Correções de bugs

* Adicionar proteção para o caminho único mais profundo em GraphQL

  * Alguns usuários estavam enfrentando problemas com o caminho único mais profundo no [GraphQL](https://pypi.org/project/graphql-core/) não sendo gerado devido a um nome de campo retornando `None`. Este problema foi corrigido.

* Adicionar proteção para análise de solicitação da web

  * Alguns usuários experimentaram um erro de análise quando `request_uri` estava malformado ou continha caracteres inválidos. Isso pode acontecer neste ponto se o `request_uri` no cabeçalho da solicitação for inválido e não corresponder ao URL (válido) fornecido originalmente. Embora essa proteção já tenha sido implementada no New Relic, `urllib` resolveu esse problema para versões do Python lançadas após 31 de janeiro de 2025.

* Corrigir travamento no ElasticSearch e GraphQL quando `trace.settings==None`

  * Nos casos em que `trace.settings` é `None`, a instrumentação do ElasticSearch travou o aplicativo. Um fallback `global_settings` foi implementado. Isso também resolve o mesmo problema encontrado no GraphQL.

* Remover o método `options` da lista de clientes do ElasticSearch assíncrono

  * A instrumentação anterior do ElasticSearch causou uma falha porque `options` estava na lista de métodos assíncronos. Este método não é mais encapsulado em um `DatastoreTrace` pois não é um método que conduz nenhuma operação/requests de armazenamento de dados.

## Declaração de apoio

Recomendamos atualizar para a versão mais recente do agente assim que estiver disponível. Se você não puder atualizar para a versão mais recente, atualize seu agente para uma versão com no máximo 90 dias. Saiba [mais](/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/) sobre como manter o agente atualizado.

Consulte a New Relic Python [política](/docs/apm/agents/python-agent/getting-started/python-agent-eol-policy/) de fim de vida útil do agente para obter informações sobre lançamentos de agentes e datas de suporte.