---
title: Envie dados Snyk para New Relic
metaDescription: Send your security data from Snyk directly to New Relic.
freshnessValidatedDate: never
translationType: machine
---

Este guia descreve como integrar New Relic Integrações de Agentes com <DNT>Snyk</DNT> Webhooks. Os webhooks em <DNT>Snyk</DNT> são um recurso beta disponível somente para clientes <DNT>Snyk&apos;s Business</DNT> ou Enterprise. Como um recurso beta, o <DNT>Webhook API</DNT> e a estrutura podem mudar sem aviso prévio, portanto, tenha cuidado ao usar Webhooks para automação em seus processos de segurança.

Embora façamos todos os esforços para nos mantermos sincronizados com as alterações em <DNT>Snyk Webhooks</DNT>, se você perceber que estamos fora de sintonia, avise-nos.

Após a conclusão dessas etapas, você verá novas vulnerabilidades detectadas por <DNT>Snyk</DNT> em sua conta New Relic em tempo real e poderá criar um dashboard de análise de problemas recém-detectados.

Para obter mais informações, consulte a [documentação oficial do <DNT>Snyk</DNT> ](https://snyk.docs.apiary.io/#reference/webhooks).

## Pré-requisitos [#prereqs]

* Um token de API <DNT>Snyk</DNT>
* New Relic<InlinePopover type="licenseKey" />
* Você deve ser um administrador da organização <DNT>Snyk</DNT> para configurar Webhooks via API

## Configuração de webhook [#webhook-config]

Para configurar seu webhook, siga as seguintes etapas:

<Steps>
  <Step>
    ### Obtenha seu token da API Snyk [#snky-API-token]

    Na interface do Snyk, no menu do usuário, clique <DNT>**Account settings**</DNT> em e copie sua <DNT>Snyk</DNT> API token chave. Leia mais na [documentação oficial do Snyk](https://docs.snyk.io/snyk-admin/snyk-broker/snyk-broker-code-agent/setting-up-the-code-agent-broker-client-deployment/step-1-obtaining-the-required-tokens-for-the-setup-procedure/obtaining-your-snyk-api-token).
  </Step>

  <Step>
    ### New Relic <DNT>**License - Insert**</DNT> [#nr-license-key]

    Selecione um <DNT>**License - Insert**</DNT> <InlinePopover type="licenseKey" />em sua conta New Relic ou crie uma nova.

    <Callout variant="important">
      Além de suas chaves <DNT>Snyk</DNT> e New Relic, você precisa gerar um segredo de assinatura aleatório. Isso é exigido pelo Snyk, mas não é usado pela New Relic ao receber dados.
    </Callout>
  </Step>

  <Step>
    ### Compilar IDs de organização Snyk [#sny-org-ids]

    Obtenha uma lista dos <DNT>Snyk</DNT> IDs de organização aos quais você tem acesso executando o seguinte comando:

    ```shell
    curl -H "content-type: application/json" \
      -H "authorization: token YOUR_SNYK_API_TOKEN" \
      "https://api.snyk.io/api/v1/orgs" | jq -r '.orgs[] | "\(.id)\t\(.name)"'
    ```

    <Callout variant="important">
      Para executar este comando, você precisa instalar [jq](https://stedolan.github.io/jq/), um processador JSON de linha de comando.
    </Callout>
  </Step>

  <Step>
    ### Crie um webhook em cada organização Snyk [#create-webhook]

    Você deve configurar um webhook separadamente para cada <DNT>Snyk</DNT> organização.

    Execute o comando a seguir para criar um webhook que será postado no processador de ingestão de segurança no New Relic sempre que um projeto for testado. Isso é enviado por meio do tipo de evento [project\_snapshot](https://snyk.docs.apiary.io/#introduction/consuming-webhooks/event-types) .

    ```shell
    curl -X POST -H "content-type: application/json" \
      -H "authorization: token <SNYK_API_TOKEN>" \
      --data '{"url": 
          "https://security-ingest-processor.service.newrelic.com/v1/security/webhooks/snyk?Api-Key=YOUR_NEW_RELIC_LICENSE_KEY",
          "secret": "YOUR_SIGNING_SECRET"}' \
      "https://api.snyk.io/api/v1/org/<SNYK_ORG_ID>/webhooks"
    ```

    <Callout variant="important">
      Se você estiver usando uma chave de licença da UE, use o endpoint da UE: `https://security-ingest-processor.service.eu.newrelic.com/v1/security/webhooks`.
    </Callout>
  </Step>

  <Step>
    ### Testar uma conexão de webhook [#confirm-webhook]

    O comando a seguir retorna uma matriz de resultados com um ID de webhook e URL para cada webhook configurado na organização:

    ```shell
    curl -H "content-type: application/json" \
      -H "authorization: token YOUR_SNYK_API_TOKEN" \
      "https://api.snyk.io/api/v1/org/YOUR_SNYK_ORG_ID/webhooks"
    ```

    Para testar um webhook, copie o ID do webhook que deseja testar e execute o seguinte comando:

    ```shell
    curl -X POST --data "" -H "content-type: application/json" \
      -H "authorization: token YOUR_SNYK_API_TOKEN" \
      "https://api.snyk.io/api/v1/org/YOUR_SNYK_ORG_ID/webhooks/YOUR_WEBHOOK_ID/ping"
    ```

    O comando retornará `OK` se você configurou o webhook corretamente.
  </Step>
</Steps>

## Teste um Webhook manualmente [#webhook-test]

Talvez seja necessário acionar uma verificação manual de um projeto em <DNT>Snyk</DNT> para que os dados fluam para o New Relic. Você pode fazer isso por meio da CLI ou API <DNT>Snyk</DNT> ou da interface <DNT>Snyk</DNT>, clicando em <DNT>**Retest now**</DNT> em um destino de verificação dentro de um projeto.

Verifique a documentação oficial <DNT>Snyk</DNT> sobre [a execução de testes manuais](https://docs.snyk.io/getting-started/running-tests#run-tests-manually).

<img title="Test a webhook manually" alt="Test a webhook manually" src="/images/vulnerability-management_screenshot-crop_test-webhook.webp" />

<figcaption>
  Clique em <DNT>**Retest now**</DNT> em um destino de verificação em um projeto.
</figcaption>

## Verifique se seus dados Snyk foram enviados para New Relic [#verify-snyk-sending]

Verifique o login no New Relic para verificar se as descobertas <DNT>Snyk</DNT> do seu teste manual foram entregues com sucesso inserindo `logtype:security` para filtrar o evento de segurança.

1. Vá para <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Logs**</DNT>.
2. Na barra de pesquisa, digite `logtype:security` e clique em <DNT>**Query logs**</DNT>.

<img title="Logs screen" alt="Logs screen" src="/images/vulnerability-management_screenshot-crop_verify-snyk-data.webp" />

<figcaption>
  <DNT>
    **[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Logs**
  </DNT>
</figcaption>

Os transportes Snyk Webhook retornam apenas <DNT>**New Issues**</DNT> e <DNT>**Removed Issues**</DNT> que ocorrem com cada teste. New Relic analisará apenas o <DNT>**New Issues**</DNT>. Se o teste manual não revelar nenhum problema novo, você não verá nenhum novo log de segurança no New Relic. Nesse caso, você verá uma mensagem do log no New Relic para o transporte bem-sucedido do webhook nos moldes de:

```sql
SnykWebhook scan reported 879 byte payload with 0 events (0 unique issue ids) from '' errors=no
```

## Veja os dados do Snyk no New Relic [#view-data-NR]

Depois de configurar um ou mais eventos de webhook, você poderá visualizar os resultados do webhook <DNT>Snyk</DNT> sendo enviado para nosso endpoint de ingestão de segurança no New Relic.

Confira as três maneiras que você pode usar para identificar dados <DNT>Snyk</DNT> no New Relic:

### Visualizando dados em Security RX [#view-data]

Você pode encontrar esta página em <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Security RX**</DNT>.

Essa visualização oferece uma visão panorâmica de todas as vulnerabilidades do seu software, incluindo todos os dados que foram consumidos pela integração do <DNT>Snyk</DNT>. Use as diversas guias para identificar e fazer a triagem de vulnerabilidades.

<img title="Vulnerability Management overview" alt="An image showing the summary Vulnerability Management overview page." src="/images/security_screenshot-full_security-overview.webp" />

<figcaption>
  <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Security RX**</DNT>.
</figcaption>

### Consultando evento de vulnerabilidades [#query-vuln-events]

Quando <DNT>Snyk</DNT> eventos são processados, eles são armazenados na tabela <DNT>**Vulnerability**</DNT>. Para consultar esta tabela e visualizar os dados brutos, faça o seguinte:

1. Vá para <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Query your data**</DNT>.

2. Insira a seguinte consulta:

   ```sql
   FROM Vulnerability SELECT * WHERE source = 'Snyk' SINCE 7 days ago
   ```

   <img title="Query vulnerability events" alt="Query vulnerability events" src="/images/vulnerability-management_screenshot-full_query-vuln-events.webp" />

   <figcaption>
     <DNT>
       **[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Query your data**
     </DNT>
   </figcaption>

### Dashboard Snyk [#snyk-dashboard]

Você pode instalar o dashboard <DNT>Snyk</DNT> pré-construído do [mercado de observabilidadeNew Relic Instant](https://newrelic.com/instant-observability/snyk).

Este dashboard oferece outra visão dos dados de vulnerabilidades, e você pode usar o widget de gráfico para construir suas próprias visualizações dashboard a partir dos dados de integração do Snyk.

<img title="Snyk dashboard" alt="Snyk dashboard" src="/images/vm_screenshot-full_snyk-dashboard.webp" />

<figcaption>
  Instale o [dashboard de Instant Observability Snyk](https://newrelic.com/instant-observability/snyk).
</figcaption>