---
title: Envie dados Snyk para New Relic
metaDescription: Send your security data from Snyk directly to New Relic.
freshnessValidatedDate: never
translationType: machine
---

import vulnerabilitymanagementTestWebhook from 'images/vulnerability-management_screenshot-crop_test-webhook.webp'

import vulnerabilitymanagementVerifySnykData from 'images/vulnerability-management_screenshot-crop_verify-snyk-data.webp'

import accountsVmLanding from 'images/accounts_screenshot-full_vm-landing.webp'

import vulnerabilitymanagementQueryVulnEvents from 'images/vulnerability-management_screenshot-full_query-vuln-events.webp'

import vmSnykDashboard from 'images/vm_screenshot-full_snyk-dashboard.webp'

Este guia descreve como integrar o New Relic Gerenciamento de vulnerabilidades com Snyk Webhooks. Webhooks no Snyk são um recurso beta disponível apenas para clientes Business ou Enterprise do Snyk. Como um recurso beta, a API e a estrutura do Webhook podem mudar sem aviso prévio, portanto, seja discreto ao usar Webhooks para automação em seus processos de segurança.

Embora façamos todos os esforços para nos mantermos sincronizados com as alterações nos Snyk Webhooks, se você perceber que estamos fora de sintonia, avise-nos.

Após a conclusão dessas etapas, você verá novas vulnerabilidades detectadas pelo Snyk em sua conta New Relic em tempo real e poderá criar um painel de análise de problemas recém-detectados.

Para mais informações, consulte a [documentação oficial do Snyk](https://snyk.docs.apiary.io/#reference/webhooks).

## Pré-requisitos [#prereqs]

* Um token de API Snyk

* New Relic

  <InlinePopover type="licenseKey"/>

* Você deve ser um administrador da organização Snyk para configurar Webhooks via API

## Configuração de webhook [#webhook-config]

Para configurar seu webhook, siga as seguintes etapas:

<Steps>
  <Step>
    ### Obtenha seu token da API Snyk [#snky-API-token]

    Na interface do Snyk, no menu do usuário, clique em <DoNotTranslate>**Account settings**</DoNotTranslate> e copie sua chave do token de API do Snyk. Leia mais na [documentação oficial do Snyk](https://docs.snyk.io/snyk-admin/snyk-broker/snyk-broker-code-agent/setting-up-the-code-agent-broker-client-deployment/step-1-obtaining-the-required-tokens-for-the-setup-procedure/obtaining-your-snyk-api-token).
  </Step>

  <Step>
    ### New Relic <DoNotTranslate>**License - Insert**</DoNotTranslate> chave de licença [#nr-license-key]

    Selecione um <DoNotTranslate>**License - Insert**</DoNotTranslate> <InlinePopover type="licenseKey"/>em sua conta New Relic ou crie uma nova.

    <Callout variant="important">
      Além das chaves Snyk e New Relic, você precisa gerar um segredo de assinatura aleatório. Isso é exigido pelo Snyk, mas não é usado pela New Relic ao receber dados.
    </Callout>
  </Step>

  <Step>
    ### Compilar IDs de organização Snyk [#sny-org-ids]

    Obtenha uma lista dos IDs da organização Snyk aos quais você tem acesso executando o seguinte comando:

    ```shell
    curl -H "content-type: application/json" \
    -H "authorization: token YOUR_SNYK_API_TOKEN" \
    "https://api.snyk.io/api/v1/orgs" | jq -r '.orgs[] | "\(.id)\t\(.name)"'
    ```

    <Callout variant="important">
      Para executar este comando, você precisa instalar [jq](https://stedolan.github.io/jq/), um processador JSON de linha de comando.
    </Callout>
  </Step>

  <Step>
    ### Crie um webhook em cada organização Snyk [#create-webhook]

    Você deve configurar um webhook separadamente para cada organização Snyk.

    Execute o comando a seguir para criar um webhook que será postado no processador de ingestão de segurança no New Relic sempre que um projeto for testado. Isso é enviado por meio do tipo de evento [project_snapshot](https://snyk.docs.apiary.io/#introduction/consuming-webhooks/event-types) .

    ```shell
    curl -X POST -H "content-type: application/json" \
    -H "authorization: token <SNYK_API_TOKEN>" \
    --data '{"url": 
        "https://security-ingest-processor.service.newrelic.com/v1/security/webhooks/snyk?Api-Key=YOUR_NEW_RELIC_LICENSE_KEY",
        "secret": "YOUR_SIGNING_SECRET"}' \
    "https://api.snyk.io/api/v1/org/<SNYK_ORG_ID>/webhooks"
    ```
  </Step>

  <Step>
    ### Testar uma conexão de webhook [#confirm-webhook]

    O comando a seguir retorna uma matriz de resultados com um ID de webhook e URL para cada webhook configurado na organização:

    ```shell
    curl -H "content-type: application/json" \
    -H "authorization: token YOUR_SNYK_API_TOKEN" \
    "https://api.snyk.io/api/v1/org/YOUR_SNYK_ORG_ID/webhooks"
    ```

    Para testar um webhook, copie o ID do webhook que deseja testar e execute o seguinte comando:

    ```shell
    curl -X POST --data "" -H "content-type: application/json" \
    -H "authorization: token YOUR_SNYK_API_TOKEN" \
    "https://api.snyk.io/api/v1/org/YOUR_SNYK_ORG_ID/webhooks/YOUR_WEBHOOK_ID/ping"
    ```

    O comando retornará `OK` se você configurou o webhook corretamente.
  </Step>
</Steps>

## Teste um Webhook manualmente [#webhook-test]

Pode ser necessário acionar uma verificação manual de um projeto no Snyk para que os dados fluam para o New Relic. Você pode fazer isso por meio da CLI ou API do Snyk, ou da interface do Snyk, clicando em <DoNotTranslate>**Retest now**</DoNotTranslate> em um destino de verificação em um projeto.

Verifique a documentação oficial do Snyk sobre [a execução de testes manuais](https://docs.snyk.io/getting-started/running-tests#run-tests-manually).

<img
  title="Test a webhook manually"
  alt="Test a webhook manually"
  src={vulnerabilitymanagementTestWebhook}
/>

<figcaption>
  Clique em <DoNotTranslate>**Retest now**</DoNotTranslate> em um destino de verificação em um projeto.
</figcaption>

## Verifique se seus dados Snyk foram enviados para New Relic [#verify-snyk-sending]

Verifique o login no New Relic para verificar se as descobertas do Snyk do seu teste manual foram entregues com sucesso inserindo `logtype:security` para filtrar o evento de segurança.

1. Vá para

   <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com) > All capabilities > Logs**</DoNotTranslate>

   .

2. Na barra de pesquisa, digite `logtype:security` e clique em

   <DoNotTranslate>**Query logs**</DoNotTranslate>

   .

<img
  title="Logs screen"
  alt="Logs screen"
  src={vulnerabilitymanagementVerifySnykData}
/>

<figcaption>
  <DoNotTranslate>
    **[one.newrelic.com](https://one.newrelic.com) > All capabilities > Logs**
  </DoNotTranslate>
</figcaption>

Os transportes Snyk Webhook retornam apenas <DoNotTranslate>**New Issues**</DoNotTranslate> e <DoNotTranslate>**Removed Issues**</DoNotTranslate> que ocorrem com cada teste. New Relic analisará apenas o <DoNotTranslate>**New Issues**</DoNotTranslate>. Se o teste manual não revelar nenhum problema novo, você não verá nenhum novo log de segurança no New Relic. Nesse caso, você verá uma mensagem do log no New Relic para o transporte bem-sucedido do webhook nos moldes de:

```sql
SnykWebhook scan reported 879 byte payload with 0 events (0 unique issue ids) from '' errors=no
```

## Veja os dados do Snyk no New Relic [#view-data-NR]

Depois de configurar um ou mais eventos de webhook, você poderá visualizar os resultados do webhook Snyk sendo enviado para nosso endpoint de ingestão de segurança no New Relic.

Confira as 3 maneiras que você pode usar para identificar dados Snyk no New Relic:

### Visualizando dados no Gerenciamento de vulnerabilidades [#view-data]

Você pode encontrar esta página em <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com) > All capabilities > Vulnerability Management**</DoNotTranslate>.

Essa visualização oferece uma visão panorâmica de todas as vulnerabilidades do seu software, incluindo quaisquer dados que foram consumidos pela integração do Snyk. Use as diversas guias para identificar e fazer a triagem de vulnerabilidades.

<img
  title="Vulnerability management screen"
  alt="Vulnerability management screen"
  src={accountsVmLanding}
/>

<figcaption>
  <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com) > All capabilities > Vulnerability Management**</DoNotTranslate>.
</figcaption>

### Consultando evento de vulnerabilidades [#query-vuln-events]

Quando os eventos Snyk são processados, eles são armazenados na tabela <DoNotTranslate>**Vulnerability**</DoNotTranslate> . Para consultar esta tabela e visualizar os dados brutos, faça o seguinte:

1. Vá para <DoNotTranslate>**[one.newrelic.com](https://one.newrelic.com) > All capabilities > Query your data**</DoNotTranslate>.

2. Insira a seguinte consulta:

   ```sql
   FROM Vulnerability SELECT * where source = 'Snyk' since 7 days ago
   ```

   <img
     title="Query vulnerability events"
     alt="Query vulnerability events"
     src={vulnerabilitymanagementQueryVulnEvents}
   />

   <figcaption>
     <DoNotTranslate>
       **[one.newrelic.com](https://one.newrelic.com) > All capabilities > Query your data**
     </DoNotTranslate>
   </figcaption>

### Dashboard Snyk [#snyk-dashboard]

Você pode instalar o dashboard Snyk pré-construído no [mercado de observabilidade New Relic Instant](https://newrelic.com/instant-observability/snyk).

Este dashboard oferece outra visão dos dados de vulnerabilidades, e você pode usar o widget de gráfico para construir suas próprias visualizações dashboard a partir dos dados de integração do Snyk.

<img
  title="Snyk dashboard"
  alt="Snyk dashboard"
  src={vmSnykDashboard}
/>

<figcaption>
  Instale o [dashboard de observabilidade instantânea Snyk](https://newrelic.com/instant-observability/snyk).
</figcaption>