---
title: Estrutura de dados de segurança (referência NRQL)
metaDescription: Learn about the data structure and entity types used to store security data in New Relic.
freshnessValidatedDate: never
translationType: machine
---

O Security RX armazena dados de vulnerabilidades e configurações incorretas no banco de dados da New Relic (NRDB), permitindo que sejam consultados usando NRQL. Este guia de referência explica os tipos de entidades, atributos e estrutura de dados que você pode usar para criar consultas, dashboards e alertas personalizados.

## Tipos de entidade e evento

O Security RX utiliza os seguintes tipos de entidade e evento para armazenar dados de segurança:

### Entidade SecurityFinding (Recomendado)

O `SECURITY_FINDING` é um tipo de entidade especializada que serve como um contêiner genérico para todos os problemas de segurança detectados pelo Security RX. Esta é a forma recomendada de consultar dados de segurança no New Relic.

**Importante:** SecurityFinding é consultado como um tipo de entidade, não como um evento tradicional:

```sql
FROM Entity
SELECT * WHERE type = 'SECURITY_FINDING'
```

#### Compreendendo o tipo de descoberta

O atributo `findingType` é o campo chave para distinguir a fonte de dados:

* **`findingType = 'VULNERABILITY'`**: Indica uma descoberta de vulnerabilidades de fontes como agente APM, agente de infraestrutura ou scanners de terceiros (Snyk, Trivy, FOSSA)
* **`findingType = 'MISCONFIGURATION'`**: Indica uma descoberta de gerenciamento de postura de segurança cloud (CSPM) do Security RX Cloud (por exemplo, do AWS Security Hub, GuardDuty ou Config)

Outros valores de findingType incluem: `LIBRARY_VULNERABILITY`, `INFRASTRUCTURE_VULNERABILITY`, `APPLICATION_VULNERABILITY`, `SYSTEM_VULNERABILITY`, `SECURITY_EVENT` e `OTHER`.

#### Campos principais da entidade

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>

      <th>
        Exemplo
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `id`
      </td>

      <td>
        Corda
      </td>

      <td>
        Identificador globalmente exclusivo para este SecurityFinding (CVE específico do destino e entidade impactada)
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `type`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de entidade - sempre &quot;SECURITY_FINDING&quot;
      </td>

      <td>
        &quot;SECURITY_FINDING&quot;
      </td>
    </tr>

    <tr>
      <td>
        `name`
      </td>

      <td>
        Corda
      </td>

      <td>
        Título das vulnerabilidades ou má configuração
      </td>

      <td>
        &quot;CVE-2024-12345: SQL injeção na biblioteca-name&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.id`
      </td>

      <td>
        Corda
      </td>

      <td>
        ID da conta onde essa descoberta foi detectada.
      </td>

      <td>
        &quot;1234567&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.type`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de escopo - normalmente &quot;ACCOUNT&quot;
      </td>

      <td>
        &quot;ACCOUNT&quot;
      </td>
    </tr>

    <tr>
      <td>
        `metadata.createdAt`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando esta entidade foi criada
      </td>

      <td>
        TimestampUnix
      </td>
    </tr>

    <tr>
      <td>
        `metadata.updatedAt`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando esta entidade foi atualizada pela última vez
      </td>

      <td>
        TimestampUnix
      </td>
    </tr>

    <tr>
      <td>
        `tags`
      </td>

      <td>
        Matriz
      </td>

      <td>
        Lista de tags aplicáveis à entidade (normalmente vazia para SecurityFinding)
      </td>

      <td>
        \[]
      </td>
    </tr>
  </tbody>
</table>

#### Campos de classificação

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>

      <th>
        Exemplo
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityIdentifier`
      </td>

      <td>
        Corda
      </td>

      <td>
        Identificador para agregar SecurityFindings (geralmente um ID CVE)
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingType`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de descoberta de nível superior
      </td>

      <td>
        &quot;VULNERABILITY&quot;, &quot;MISCONFIGURATION&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingSubType`
      </td>

      <td>
        Corda
      </td>

      <td>
        Subtipo (idioma para vulnerabilidades APM, INFRA_OS_VULNERABILITY ou INFRA_PACKAGE_VULNERABILITY para infraestrutura)
      </td>

      <td>
        &quot;java&quot;, &quot;INFRA_PACKAGE_VULNERABILITY&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        Corda
      </td>

      <td>
        Fonte da descoberta
      </td>

      <td>
        &quot;New Relic&quot;, &quot;Snyk&quot;, &quot;AWS Security Hub&quot;
      </td>
    </tr>
  </tbody>
</table>

#### Campos de status e gravidade

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>

      <th>
        Valores
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `severity`
      </td>

      <td>
        Corda
      </td>

      <td>
        Gravidade relatada da descoberta
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;, &quot;UNKNOWN&quot;, &quot;INFO&quot;
      </td>
    </tr>

    <tr>
      <td>
        `status`
      </td>

      <td>
        Corda
      </td>

      <td>
        Estado atual da descoberta
      </td>

      <td>
        &quot;AFFECTED&quot;, &quot;IGNORED&quot;, &quot;NO_LONGER_DETECTED&quot;, &quot;UNKNOWN&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationExists`
      </td>

      <td>
        Boleano
      </td>

      <td>
        Existe alguma solução?
      </td>

      <td>
        true, false
      </td>
    </tr>

    <tr>
      <td>
        `remediation.upgradeAction`
      </td>

      <td>
        Corda
      </td>

      <td>
        Atualização sugerida pela Security RX
      </td>

      <td>
        &quot;Atualize para a versão 2.17.1&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationDetails`
      </td>

      <td>
        Corda
      </td>

      <td>
        Breve texto de correção da fonte
      </td>

      <td>
        &quot;Atualizar biblioteca para a versão corrigida&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.url`
      </td>

      <td>
        Corda
      </td>

      <td>
        URL da documentação da fonte
      </td>

      <td>
        &quot;

        [https://example.com/security-advisory](https://example.com/security-advisory)

        &quot;
      </td>
    </tr>
  </tbody>
</table>

#### Campos de referência CVE

Para informações sobre vulnerabilidades, o objeto `cve` contém informações detalhadas sobre CVEs:

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cve.id`
      </td>

      <td>
        Corda
      </td>

      <td>
        Identificador CVE
      </td>
    </tr>

    <tr>
      <td>
        `cve.description`
      </td>

      <td>
        Corda
      </td>

      <td>
        Descrição da CVE
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssScore`
      </td>

      <td>
        Número
      </td>

      <td>
        Pontuação CVSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssVector`
      </td>

      <td>
        Corda
      </td>

      <td>
        string vetorial CVSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssScore`
      </td>

      <td>
        Número
      </td>

      <td>
        Pontuação de probabilidade de exploração EPSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssPercentile`
      </td>

      <td>
        Número
      </td>

      <td>
        Classificação percentual EPSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.exploitKnown`
      </td>

      <td>
        Boleano
      </td>

      <td>
        Existe alguma vulnerabilidade conhecida que possa ser explorada?
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosureUrl`
      </td>

      <td>
        Corda
      </td>

      <td>
        URL onde a CVE foi divulgada
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosedAt`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando o CVE foi divulgado
      </td>
    </tr>
  </tbody>
</table>

#### Campos de configuração incorreta (Resultados na nuvem)

Para informações sobre erros de configuração, o objeto `misconfiguration` contém informações específicas da nuvem:

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `misconfiguration.cloudProvider`
      </td>

      <td>
        Corda
      </td>

      <td>
        Provedor de nuvem
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.issueTitle`
      </td>

      <td>
        Corda
      </td>

      <td>
        Título da configuração incorreta
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.misconfigurationType`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de resultado bruto da fonte
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.normalizedResourceType`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de recurso simplificado (ex.: &quot;S3&quot;, &quot;EC2&quot;, &quot;RDS&quot;)
      </td>
    </tr>
  </tbody>
</table>

#### Campos da entidade afetados

O objeto `impactedEntity` identifica qual entidade do New Relic é afetada:

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `impactedEntity.id`
      </td>

      <td>
        Corda
      </td>

      <td>
        GUID da entidade
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.name`
      </td>

      <td>
        Corda
      </td>

      <td>
        Nome da entidade
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.type`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de entidade (APM-APPLICATION, INFRA-HOST, etc.)
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.id`
      </td>

      <td>
        Corda
      </td>

      <td>
        ID da conta
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.type`
      </td>

      <td>
        Corda
      </td>

      <td>
        Tipo de escopo
      </td>
    </tr>
  </tbody>
</table>

#### campos de carimbo de data/hora

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `firstDetected`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando a descoberta foi detectada pela primeira vez
      </td>
    </tr>

    <tr>
      <td>
        `findingUpdatedAt`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando a descoberta foi atualizada pela última vez
      </td>
    </tr>

    <tr>
      <td>
        `lastSeen`
      </td>

      <td>
        Timestamp
      </td>

      <td>
        Quando a descoberta foi considerada ativa pela última vez
      </td>
    </tr>
  </tbody>
</table>

#### interface e campos internos

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityUILinks.detailsUrl`
      </td>

      <td>
        Corda
      </td>

      <td>
        Link para a página de detalhes na interface do usuário do Security RX.
      </td>
    </tr>

    <tr>
      <td>
        `vulnerabilityUILinks.tabUrl`
      </td>

      <td>
        Corda
      </td>

      <td>
        Link para a visualização da entidade na interface do usuário do Security RX
      </td>
    </tr>

    <tr>
      <td>
        `internalState.status`
      </td>

      <td>
        Corda
      </td>

      <td>
        Campo de status interno
      </td>
    </tr>

    <tr>
      <td>
        `internalState.active`
      </td>

      <td>
        Boleano
      </td>

      <td>
        Sinalizador interno ativo (usado no cloud Consulta)
      </td>
    </tr>

    <tr>
      <td>
        `entityLookupValue`
      </td>

      <td>
        Corda
      </td>

      <td>
        Campo interno (ficará oculto em produção)
      </td>
    </tr>

    <tr>
      <td>
        `issueInstanceKey`
      </td>

      <td>
        Corda
      </td>

      <td>
        Campo interno (ficará oculto em produção)
      </td>
    </tr>

    <tr>
      <td>
        `additionalInfo`
      </td>

      <td>
        matriz de objetos
      </td>

      <td>
        Adicionalmente, com pares de valores principais (usados para IDs de contas cloud, etc.)
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="tip">
  Os campos marcados como &quot;internos&quot; estão atualmente visíveis no NRDB, mas podem ficar ocultos após o lançamento final. O campo `internalState.active` é comumente usado em consultoria de configuração incorreta cloud para filtrar resultados ativos.
</Callout>

#### exemplos de consulta para vulnerabilidades

**Contabilizar vulnerabilidades críticas ativas por entidade:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND severity = 'CRITICAL'
FACET impactedEntity.name
```

**Encontre a entidade afetada por uma CVE específica:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND cve.id = 'CVE-2024-23944'
FACET impactedEntity.name
```

**Encontre vulnerabilidades CVE com campanhas de ransomware ativas:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.exploitKnown IS true
FACET impactedEntity.name, cve.id
```

**Identificar vulnerabilidades provavelmente exploráveis (pontuação EPSS alta):**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.epssPercentile > '0.95'
FACET cve.id
```

**Encontre fontes de informação para suas descobertas:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET source
```

**entidade com elevado limite de vulnerabilidades:**

```sql
SELECT impactedEntity
FROM (
  SELECT count(*) AS vulnerableCount
  FROM Entity
  WHERE type = 'SECURITY_FINDING'
    AND severity IN ('CRITICAL', 'HIGH')
  FACET impactedEntity.name AS impactedEntity, severity
)
WHERE (severity = 'HIGH' AND vulnerableCount > 10)
   OR (severity = 'CRITICAL' AND vulnerableCount > 5)
```

#### exemplos de consulta para configurações incorretas cloud

**Contabilizar configurações incorretas únicas por status:**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET status
```

**Os 10 tipos de erros de configuração mais comuns:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.issueTitle
LIMIT 10
```

**Encontre as contas da AWS mais arriscadas:**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity IN ('CRITICAL', 'HIGH')
FACET aparse(additionalInfo, '%"key":"cloudProviderAccountId","values":["*"]%') AS 'AWS Account ID'
LIMIT 10
```

**Contabilizar configurações incorretas por tipo de recurso:**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.normalizedResourceType
```

**Encontre recursos essenciais e de acesso público:**

```sql
FROM Entity
SELECT name, impactedEntity.name, misconfiguration.misconfigurationType
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity = 'CRITICAL'
  AND misconfiguration.misconfigurationType LIKE 'Effects/Data Exposure'
SINCE 1 day ago
```

### Vulnerabilidades (evento personalizado)

Armazena metadados detalhados sobre vulnerabilidades, incluindo informações sobre CVEs, pontuações de gravidade e orientações para correção.

**Uso principal:** Análise detalhada das vulnerabilidades e metadados.

**Atributo chave:**

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Tipo
      </th>

      <th>
        Descrição
      </th>

      <th>
        Exemplo
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cveId`
      </td>

      <td>
        Corda
      </td>

      <td>
        Identificador CVE
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `severity`
      </td>

      <td>
        Corda
      </td>

      <td>
        Gravidade baseada no CVSS
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;
      </td>
    </tr>

    <tr>
      <td>
        `cvssScore`
      </td>

      <td>
        Número
      </td>

      <td>
        Pontuação numérica CVSS
      </td>

      <td>
        9,8
      </td>
    </tr>

    <tr>
      <td>
        `epssScore`
      </td>

      <td>
        Número
      </td>

      <td>
        EPSS explora probabilidade
      </td>

      <td>
        0,95
      </td>
    </tr>

    <tr>
      <td>
        `epssPercentile`
      </td>

      <td>
        Número
      </td>

      <td>
        Classificação percentual EPSS
      </td>

      <td>
        98,5
      </td>
    </tr>

    <tr>
      <td>
        `activeRansomware`
      </td>

      <td>
        Boleano
      </td>

      <td>
        Utilizado em campanhas de ransomware conhecidas
      </td>

      <td>
        `true`, `false`
      </td>
    </tr>

    <tr>
      <td>
        `affectedPackage`
      </td>

      <td>
        Corda
      </td>

      <td>
        Nome da biblioteca/pacote vulnerável
      </td>

      <td>
        &quot;log4j-core&quot;
      </td>
    </tr>

    <tr>
      <td>
        `affectedVersion`
      </td>

      <td>
        Corda
      </td>

      <td>
        Versão vulnerável do pacote
      </td>

      <td>
        &quot;2.14.0&quot;
      </td>
    </tr>

    <tr>
      <td>
        `fixedVersion`
      </td>

      <td>
        Corda
      </td>

      <td>
        Versão com correção
      </td>

      <td>
        &quot;2.17.1&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entityGuid`
      </td>

      <td>
        Corda
      </td>

      <td>
        GUID da entidade afetada
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        Corda
      </td>

      <td>
        Fonte de detecção
      </td>

      <td>
        &quot;APM\_AGENT&quot;, &quot;SNYK&quot;, &quot;AWS\_SECURITY\_HUB&quot;
      </td>
    </tr>
  </tbody>
</table>

**Exemplo de consulta:**

```sql
FROM Vulnerability
SELECT count(*)
WHERE severity = 'CRITICAL'
AND activeRansomware = true
FACET affectedPackage
```

## Atributo comum a todos os tipos de eventos

Esses atributos aparecem em vários tipos de eventos:

### Identificação da entidade

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        Identificador único da entidade afetada
      </td>
    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        Nome da entidade legível por humanos
      </td>
    </tr>

    <tr>
      <td>
        `entity.type`
      </td>

      <td>
        tipo de entidade (APPLICATION, HOST, SERVICE)
      </td>
    </tr>

    <tr>
      <td>
        `accountId`
      </td>

      <td>
        ID da conta New Relic
      </td>
    </tr>
  </tbody>
</table>

### Carimbo de data/hora

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        Quando o evento ocorreu
      </td>
    </tr>

    <tr>
      <td>
        `detectedAt`
      </td>

      <td>
        Quando foi detectado pela primeira vez
      </td>
    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        Última timestamp
      </td>
    </tr>

    <tr>
      <td>
        `resolvedAt`
      </td>

      <td>
        Quando (s) foi marcado como resolvido
      </td>
    </tr>
  </tbody>
</table>

### Rastreamento de origem

<table>
  <thead>
    <tr>
      <th>
        Atributo
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `source`
      </td>

      <td>
        Fonte de dados (APM\_AGENT, INFRASTRUCTURE, SNYK, etc.)
      </td>
    </tr>

    <tr>
      <td>
        `sourceId`
      </td>

      <td>
        ID único do sistema de origem
      </td>
    </tr>

    <tr>
      <td>
        `integrationName`
      </td>

      <td>
        integração que forneceu dados
      </td>
    </tr>
  </tbody>
</table>

## Relações de dados

Entender como os tipos de dados se relacionam entre si:

```
SecurityFinding Entity (type = 'SECURITY_FINDING')
    ↓ contains
    ├─ findingType (VULNERABILITY or MISCONFIGURATION)
    ├─ cve (CVE details for vulnerabilities)
    ├─ misconfiguration (Cloud security details)
    └─ impactedEntity (Affected New Relic entity)
```

## Padrões de consulta

Para padrões de consulta que utilizam a entidade SecurityFinding, consulte as [seções de exemplos de consulta acima](#query-examples-for-vulnerabilities).

## Tipos e formatos de atributos

### Valores de gravidade

```
CRITICAL - CVSS 9.0-10.0
HIGH     - CVSS 7.0-8.9
MEDIUM   - CVSS 4.0-6.9
LOW      - CVSS 0.1-3.9
INFO     - CVSS 0.0
```

### Valores do Estado

```
OPEN      - Vulnerability currently active
CLOSED    - Vulnerability resolved or fixed
AFFECTED  - Entity is confirmed affected
IGNORED   - Marked as not applicable
NO_LONGER_DETECTED - No longer seen in scans
```

### Valores de origem

```
APM_AGENT            - Detected by New Relic APM agent
INFRASTRUCTURE       - Detected by Infrastructure agent
SNYK                 - Imported from Snyk
AWS_SECURITY_HUB     - Imported from AWS Security Hub
DEPENDABOT           - Imported from GitHub Dependabot
FOSSA                - Imported from FOSSA
TRIVY                - Imported from Trivy
SECURITY_DATA_API    - Sent via API
```

## Dicas para fazer consultas

### Filtrar por gravidade (abordagem moderna)

Os resultados são priorizados com base na gravidade:

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND severity IN ('CRITICAL', 'HIGH')
  AND status = 'AFFECTED'
FACET impactedEntity.name
```

### Filtrar por tipo de busca

Separar vulnerabilidades de configurações incorretas:

```sql
-- Vulnerabilities only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'VULNERABILITY'
FACET impactedEntity.type

-- Misconfigurations only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET misconfiguration.normalizedResourceType
```

### Filtrar por tipo de entidade

Separe o aplicativo das vulnerabilidades de infraestrutura:

```sql
-- Application vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%APPLICATION%'
FACET impactedEntity.name

-- Infrastructure vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%HOST%'
FACET impactedEntity.name
```

### Filtrar por fonte de detecção

resultados da consulta de integração específica:

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND source = 'Snyk'
FACET severity
```

### Filtragem baseada no tempo

Encontre as descobertas detectadas recentemente:

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND firstDetected > ago(7 days)
FACET cve.id, severity
```

## Construindo dashboards personalizados

Utilize a entidade SecurityFinding para criar um dashboard de segurança abrangente:

1. **Dashboard executivo** - Métricas de segurança de alto nível para todos os tipos de achados.

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET severity, findingType
   ```

2. **tendências de vulnerabilidades** - Rastreie a detecção de vulnerabilidades ao longo do tempo

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'VULNERABILITY'
   FACET weekOf(firstDetected)
   SINCE 90 days ago
   ```

3. **Postura de segurança na nuvem** - Monitore configurações incorretas cloud

   ```sql
   FROM Entity
   SELECT uniqueCount(misconfiguration.issueTitle)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'MISCONFIGURATION'
   FACET misconfiguration.cloudProvider, severity
   ```

4. **Postura de segurança da entidade** - Visualizações de segurança por entidade

   ```sql
   FROM Entity
   SELECT count(*) AS 'Findings'
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET impactedEntity.name, severity
   ```

Para mais exemplos de consulta, veja [Exemplos de consulta de dados de segurança](/docs/vulnerability-management/advanced/query-examples).

### Abordagens legadas dashboards

Para compatibilidade com versões anteriores, você ainda pode usar o tipo de evento legado (`Vulnerability`), mas recomendamos migrar para a entidade SecurityFinding para o novo painel.

## Qual é o próximo?

<DocTiles>
  <DocTile title="Exemplos de consulta" path="/docs/vulnerability-management/advanced/query-examples">
    Consulta NRQL pronta para uso em cenários de segurança comuns.
  </DocTile>

  <DocTile title="Configurar alerta" path="/docs/vulnerability-management/advanced/set-up-alerts">
    Criar alertas baseados em NRQL para vulnerabilidades
  </DocTile>

  <DocTile title="Gerenciar status de vulnerabilidades" path="/docs/vulnerability-management/advanced/manage-vulnerability-status">
    Alterar o status de vulnerabilidade e acompanhar a remediação.
  </DocTile>
</DocTiles>