---
title: Evento de reinicialização frequente Fluent Bit
type: troubleshooting
tags:
  - Infrastructure
  - Infrastructure monitoring troubleshooting
  - Troubleshoot infrastructure
  - Fluent Bit
metaDescription: Troubleshooting steps to resolve the infrastructure agent bug causing endless Fluent Bit restart events due to hostname resolution issues.
freshnessValidatedDate: never
translationType: machine
---

## Problema

O agente da New Relic Infrastructure está enviando eventos `Fluent Bit Started` e `Fluent Bit Stopped` excessivos sem reinicializações reais Fluent Bit. Isso pode desorganizar os logs, afetar a precisão do monitoramento e aumentar a ingestão de dados, o que pode levar a cobranças inesperadas.

## Causa

Isso é causado por um bug no componente de resolução de nome do host do agente de infraestrutura. O agente detecta incorretamente mudanças frequentes de nome de host, o que aciona o `LogForwarderSupervisor` para enviar este evento falso de reinicialização Fluent Bit. Você pode ver milhares de mensagens de depuração semelhantes ao exemplo a seguir:

```
time="2024-04-20T02:46:47Z" level=debug msg="Notifying observers." change=2 component=HostnameResolver
time="2024-04-20T02:46:47Z" level=debug msg="Observer notified." component=HostnameResolver name=LogForwarderSupervisor
```

## Solução

Para resolver esse problema, modifique o comportamento de resolução do nome do host na configuração do seu agente de infraestrutura. Esta correção se aplica aos sistemas Windows e Linux.

Adicione a seguinte configuração ao arquivo de configuração do seu agente de infraestrutura:

**Linux**: `/etc/newrelic-infra.yml` **Windows**: `C:\Program Files\New Relic\newrelic-infra\newrelic-infra.yml`

```yml
dns_hostname_resolution: false
override_hostname: "your-server-hostname"
```

Substitua `"your-server-hostname"` pelo nome do host do seu servidor real.

Esta configuração:

* Desativa pesquisas reversas de DNS que podem estar causando detecção instável de host de nome
* Força o agente a usar um nome de host específico, impedindo qualquer detecção de alteração de nome de host

### Aplicar a configuração

Depois de adicionar a configuração:

1. Salve o arquivo de configuração.

2. Reinicie o agente New Relic Infrastructure:

   **Linux**:

   ```bash
   sudo systemctl restart newrelic-infra
   ```

   **Windows**:

   ```powershell
   Restart-Service newrelic-infra
   ```

## Verificação

Para confirmar se o problema foi resolvido:

1. Monitore os logs do seu agente de infraestrutura para verificar a ausência de mensagens `HostnameResolver` repetidas.
2. Verifique o dashboard New Relic para garantir que os eventos `Fluent Bit Started` e `Fluent Bit Stopped` não estejam mais aparecendo continuamente.
3. Verifique se o encaminhamento de logs continua funcionando normalmente e se os logs aparecem conforme configurado.

## Recursos adicionais

* [agente de infraestrutura nome do host documentação de resolução](https://github.com/newrelic/infrastructure-agent/blob/master/docs/hostname_resolution.md)
* [Definições de configuração do agente de infraestrutura](/docs/infrastructure/install-infrastructure-agent/configuration/infrastructure-agent-configuration-settings/)