---
title: Configurar o ATP para o host
metaDescription: Step-by-step guide to install and configure the Adaptive Telemetry Processor (ATP) with NRDOT Collector Host distribution.
tags:
  - Open source telemetry integrations
  - OpenTelemetry
  - NRDOT
  - Adaptive Telemetry Processor
  - ATP
  - Configuration
  - Setup
  - Installation
freshnessValidatedDate: never
translationType: machine
---

<Callout title="Visualização">
  Ainda estamos trabalhando nesse recurso, mas adoraríamos que você experimentasse!

  Atualmente, esse recurso é fornecido como parte de uma prévia, de acordo com nossas [políticas de pré-lançamento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/).
</Callout>

Saiba como instalar e configurar o Adaptive Telemetry Processor (ATP) com o NRDOT Collector. O ATP está incluído na distribuição padrão do NRDOT para reduzir o volume de dados de telemetria, mantendo a visibilidade crítica.

## Opções de instalação [#installation-options]

Escolha a abordagem de instalação que corresponde à sua configuração atual:

<Tabs>
  <TabsBar>
    <TabsBarItem id="new">Nova instalação</TabsBarItem> <TabsBarItem id="upgrade">Atualização do NRDOT</TabsBarItem> <TabsBarItem id="native">Migração do agente nativo</TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="new">
      <Steps>
        <Step>
          ### Antes de você começar [#prereq]

          Certifique-se de ter:

          * Sua chave de licença New Relic
          * Privilégios de root ou sudo.
          * Acesso de rede às releases do GitHub
        </Step>

        <Step>
          ### Instalar o host do coletor NRDOT [#install-nrdot]

          O ATP vem pré-empacotado com a distribuição do coletor NRDOT. Com base no seu sistema operacional, escolha o método de instalação:

          <CollapserGroup>
            <Collapser id="deb" title="Para Debian/Ubuntu">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o pacote NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Instale o pacote baixado:

                 ```bash
                 sudo dpkg -i collector.deb
                 ```

              4. Configure o coletor NRDOT para usar variáveis de ambiente definidas:

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Inicie o serviço de coletor NRDOT:

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="rhel" title="Para RHEL/CentOS">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o pacote NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Instale o pacote baixado:

                 ```bash
                 sudo rpm -i collector.rpm
                 ```

              4. Configure o coletor NRDOT para usar variáveis de ambiente definidas:

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Inicie o serviço de coletor NRDOT:

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="binary" title="Para binário manual">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o coletor NRDOT:

                 ```bash
                 # Download the tarball
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.tar.gz" \
                   --location \
                   --output collector.tar.gz
                 ```

              3. Extraia o coletor NRDOT:

                 ```bash
                 # Extract contents
                 tar -xzf collector.tar.gz
                 ```

              4. Execute o coletor:

                 ```bash
                 # Run collector in foreground
                 NEW_RELIC_LICENSE_KEY="${license_key}" ./nrdot-collector --config ./config.yaml
                 ```
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurar ATP [#configure-atp]

          Assim que o coletor NRDOT estiver instalado, edite o arquivo de configuração do coletor para ativar e personalizar o ATP. Os caminhos do arquivo de configuração variam dependendo do seu método de instalação:

          * Para instalações DEB/RPM, o arquivo de configuração está localizado em `/etc/nrdot-collector/config.yaml`.
          * Para instalações manuais de binários, o arquivo de configuração está localizado dentro da pasta extraída.

          Para editar o arquivo de configuração:

          1. Abra o arquivo de configuração (`config.yaml`) com um editor de texto:

             * Para instalações DEB/RPM:

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Para instalações manuais de binários:

             ```bash
             nano config.yaml
             ```

          2. Para coletar as métricas de processo, na seção `scrapers` do receiver `hostmetrics`, adicione a seguinte configuração `process`:

             ```yaml
             receivers:
               hostmetrics:
                 scrapers:
                   # Your existing scrapers...
                   process:
                     metrics:
                       process.cpu.utilization:
                         enabled: true
                       process.memory.utilization:
                         enabled: true
                     mute_process_name_error: true
                     mute_process_exe_error: true
                     mute_process_io_error: true
                     mute_process_user_error: true
             ```

          3. Para habilitar o ATP, localize a seção `processors` existente e adicione a configuração `adaptivetelemetry` abaixo dela:

             ```yaml
             processors:
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Adicione o processador ATP ao seu pipeline de métricas na seção `service`:

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Opcional)* Atualize a configuração do ATP, como limites de métrica, conforme necessário. Para mais detalhes sobre as opções de configuração, consulte os [Parâmetros de configuração](#config-parameters).

          6. Salve o arquivo de configuração.

          7. Reinicie o coletor NRDOT para aplicar as alterações:

          ```bash
          sudo systemctl restart nrdot-collector
          ```
        </Step>

        <Step>
          ### Acesse os dados do ATP no New Relic [#access-data]

          Assim que o ATP for configurado, ele começa a coletar dados do seu host Linux. Você pode acessar esses dados na interface do New Relic OpenTelemetry. Para mais informações sobre a interface do usuário do New Relic OpenTelemetry, consulte [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Para visualizar os dados de métrica do processo ATP no New Relic:**

          1. Vá para **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Vá para <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Pesquise a entidade onde você instalou o coletor NRDOT com ATP.

          3. Selecione a entidade e clique em **<DNT>Process</DNT>** no painel esquerdo.

             Na página <DNT>Process</DNT>, você pode visualizar todos os processos em execução no seu host, juntamente com seus IDs e métricas de utilização de CPU e memória. Ele também exibe a relação pai-filho entre processos se um processo gerar outros processos.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>

      /* ### Configure o ATP [#atp-configuration] Adicione a configuração do processador ATP ao seu `config.yaml` arquivo. Aqui está um exemplo completo de configuração: ```yaml processors: adaptivetelemetry: enable_storage: true retention_minutes: 30 include_process_list: - &quot;stress-ng&quot; metric_thresholds: process.cpu.utilization: 0,05 process.memory.utilization: 0.05 process.memory.virtual: 20971520 # 20 MB process.threads: 16 process.open_file_descriptors: 30 process.disk.io: 204800 # 200KB process.disk.operations: 300 process.context_switches: 8 process.paging.faults: 50 process.cpu.time: 0.01 # Ativar camadas de inteligência enable_dynamic_thresholds: true dynamic_smoothing_factor: 0.1 min_thresholds: process.cpu.utilization: 0.0005 process.memory.utilization: 0.0005 max_thresholds: process.cpu.utilization: 0.30 process.memory.utilization: 0.30 # Pontuação composta multimétrica enable_multi_metric: true composite_threshold: 1.5 weights: process.cpu.utilization: 0.5 process.memory.utilization: 0.5 # Detecção de anomalias enable_anomaly_detection: true anomaly_history_size: 15 anomaly_change_threshold: 50.0 anomaly_min_data_points: 3 service: pipelines: metrics: receivers: [hostmetrics] processors: [adaptivetelemetry, batch] exporters: [otlp] ``` */
    </TabsPageItem>

    <TabsPageItem id="upgrade">
      <Steps>
        <Step>
          ### Antes de você começar [#upgrade-prereq]

          Certifique-se de ter:

          * NRDOT Collector existente versão `1.11.0` ou posterior
          * Sua chave de licença New Relic
          * Privilégios de root ou sudo
          * Backup da configuração atual
        </Step>

        <Step>
          ### Fazer backup da configuração atual [#backup-config]

          Salve suas configurações atuais antes de prosseguir:

          ```bash
          sudo cp /etc/nrdot-collector/config.yaml /etc/nrdot-collector/config.yaml.bak
          ```
        </Step>

        <Step>
          ### Atualizar o coletor NRDOT [#upgrade-collector]

          Para atualizar o coletor NRDOT para a versão mais recente com suporte ao ATP, execute novamente os comandos de instalação da versão mais recente. Isso sobrescreverá o binário antigo, preservando seu arquivo de configuração existente.

          <CollapserGroup>
            <Collapser id="upgrade-deb" title="Para Debian/Ubuntu">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 ```

              2. Baixe a versão mais recente do coletor NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Instale o pacote do coletor NRDOT baixado:

                 ```bash
                 sudo dpkg -i collector.deb
                 ```
            </Collapser>

            <Collapser id="upgrade-rpm" title="Para RHEL/CentOS">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>"
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 ```

              2. Baixe a versão mais recente do coletor NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Instale o pacote do coletor NRDOT baixado:

                 ```bash
                 sudo rpm -U collector.rpm
                 ```
            </Collapser>

            <Collapser id="upgrade-manual" title="Para binário manual">
              1. Pare o coletor em execução e faça o backup da sua configuração:

                 ```bash
                 pkill -f nrdot-collector
                 cp config.yaml config.yaml.bak
                 ```

              2. Siga as etapas de instalação na aba **New Installation** → seção **For manual binary** para concluir as etapas restantes.

                 <Callout variant="caution">
                   Isso sobrescreverá seu config.yaml atual, e é por isso que o backup na Etapa 1 foi necessário.
                 </Callout>
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurar ATP [#configure-atp-upgrade]

          A atualização preservou suas configurações anteriores, então seu `config.yaml` ainda não contém as novas configurações de ATP. Você deve adicioná-los manualmente.

          Para editar o arquivo de configuração:

          1. Abra o arquivo de configuração (`config.yaml`) com um editor de texto usando privilégios de root ou sudo:

             * Para instalações DEB/RPM:

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Para instalações manuais de binários:

             ```bash
             nano config.yaml
             ```

          2. Para coletar as métricas de processo, na seção `scrapers` do receiver `hostmetrics`, adicione a seguinte configuração `process`:

             ```yaml
             processes:
             process:
               metrics:
                 process.cpu.utilization:
                   enabled: true
                 process.memory.utilization:
                   enabled: true
               mute_process_name_error: true
               mute_process_exe_error: true
               mute_process_io_error: true
               mute_process_user_error: true
             ```

          3. Para habilitar o ATP, localize a seção `processors` existente e adicione a configuração `adaptivetelemetry` abaixo dela:

             ```yaml
             processors:
               # Your existing processors...
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Adicione o processador ATP ao seu pipeline de métricas na seção `service`:

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Opcional)* Atualize a configuração do ATP, como limites de métrica, conforme necessário. Para mais detalhes sobre as opções de configuração, consulte os [Parâmetros de configuração](#config-parameters).

          6. Salve o arquivo de configuração.

          7. Reinicie o coletor NRDOT para aplicar as alterações:

             ```bash
             sudo systemctl restart nrdot-collector
             ```
        </Step>

        <Step>
          ### Acesse os dados do ATP no New Relic [#access-data]

          Assim que o ATP for configurado, ele começa a coletar dados do seu host Linux. Você pode acessar esses dados na interface do New Relic OpenTelemetry. Para mais informações sobre a interface do usuário do New Relic OpenTelemetry, consulte [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Para visualizar os dados de métrica do processo ATP no New Relic:**

          1. Vá para **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Vá para <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Pesquise a entidade onde você instalou o coletor NRDOT com ATP.

          3. Selecione a entidade e clique em **<DNT>Process</DNT>** no painel esquerdo.

             Na página <DNT>Process</DNT>, você pode visualizar todos os processos em execução no seu host, juntamente com seus IDs e métricas de utilização de CPU e memória. Ele também exibe a relação pai-filho entre processos se um processo gerar outros processos.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>
    </TabsPageItem>

    <TabsPageItem id="native">
      Para instalar o ATP migrando do agente de infraestrutura nativo da New Relic para a distribuição de host do coletor NRDOT, você precisa desinstalar o agente nativo e configurar o NRDOT com o ATP.

      <Steps>
        <Step>
          ### Antes de você começar [#prereq-native]

          Certifique-se de ter:

          * Sua chave de licença New Relic
          * Privilégios de root ou sudo
          * Planeje para uma interrupção mínima do serviço
        </Step>

        <Step>
          ### Parar e desabilitar o agente nativo [#stop-native-agent]

          1. Para parar o agente de infraestrutura existente para evitar conflito de dados, execute:

             ```bash
             # Stop the service
             sudo systemctl stop newrelic-infra
             ```

          2. Para desabilitar a inicialização do agente de infraestrutura no boot, execute:

             ```bash
             # Disable from starting on boot
             sudo systemctl disable newrelic-infra
             ```
        </Step>

        <Step>
          ### Instalar o host do coletor NRDOT [#install-nrdot-native]

          O ATP vem pré-empacotado com a distribuição do coletor NRDOT. Com base no seu sistema operacional, escolha o método de instalação:

          <CollapserGroup>
            <Collapser id="deb-native" title="Para Debian/Ubuntu">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o pacote NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Instale o pacote baixado:

                 ```bash
                 sudo dpkg -i collector.deb
                 ```

              4. Configure o coletor NRDOT para usar variáveis de ambiente definidas:

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Inicie o serviço de coletor NRDOT:

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="rhel-native" title="Para RHEL/CentOS">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o pacote NRDOT:

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Instale o pacote baixado:

                 ```bash
                 sudo rpm -i collector.rpm
                 ```

              4. Configure o coletor NRDOT para usar variáveis de ambiente definidas:

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Inicie o serviço de coletor NRDOT:

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="binary-native" title="Para binário manual">
              1. Defina as variáveis de ambiente:

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Baixe o coletor NRDOT:

                 ```bash
                 # Download the tarball
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.tar.gz" \
                   --location \
                   --output collector.tar.gz
                 ```

              3. Extraia o coletor NRDOT:

                 ```bash
                 # Extract contents
                 tar -xzf collector.tar.gz
                 ```

              4. Execute o coletor:

                 ```bash
                 # Run collector in foreground
                 NEW_RELIC_LICENSE_KEY="${license_key}" ./nrdot-collector --config ./config.yaml
                 ```
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurar ATP [#configure-atp-native]

          Assim que o coletor NRDOT estiver instalado, edite o arquivo de configuração do coletor para ativar e personalizar o ATP. Os caminhos do arquivo de configuração variam dependendo do seu método de instalação:

          * Para instalações DEB/RPM, o arquivo de configuração está localizado em `/etc/nrdot-collector/config.yaml`.
          * Para instalações manuais de binários, o arquivo de configuração está localizado dentro da pasta extraída.

          Para editar o arquivo de configuração:

          1. Abra o arquivo de configuração (`config.yaml`) com um editor de texto:

             * Para instalações DEB/RPM:

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Para instalações manuais de binários:

             ```bash
             nano config.yaml
             ```

          2. Para coletar as métricas de processo, na seção `scrapers` do receiver `hostmetrics`, adicione a seguinte configuração `process`:

             ```yaml
             receivers:
               hostmetrics:
                 scrapers:
                   # Your existing scrapers...
                   process:
                     metrics:
                       process.cpu.utilization:
                         enabled: true
                       process.memory.utilization:
                         enabled: true
                     mute_process_name_error: true
                     mute_process_exe_error: true
                     mute_process_io_error: true
                     mute_process_user_error: true
             ```

          3. Para habilitar o ATP, localize a seção `processors` existente e adicione a configuração `adaptivetelemetry` abaixo dela:

             ```yaml
             processors:
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Adicione o processador ATP ao seu pipeline de métricas na seção `service`:

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Opcional)* Atualize a configuração do ATP, como limites de métrica, conforme necessário. Para mais detalhes sobre as opções de configuração, consulte os [Parâmetros de configuração](#config-parameters).

          6. Salve o arquivo de configuração.

          7. Reinicie o coletor NRDOT para aplicar as alterações:

          ```bash
          sudo systemctl restart nrdot-collector
          ```
        </Step>

        <Step>
          ### Verificar migração [#verify-migration]

          Assim que a instalação for concluída com sucesso, verifique se os dados estão fluindo para o New Relic:

          1. Para verificar o status do serviço, execute:

             ```bash
             sudo systemctl status nrdot-collector
             ```

          2. Para verificar os logs, execute:

             ```bash
             sudo journalctl -u nrdot-collector -f
             ```
        </Step>

        <Step>
          ### Acesse os dados do ATP no New Relic [#access-data]

          Assim que o ATP for configurado, ele começa a coletar dados do seu host Linux. Você pode acessar esses dados na interface do New Relic OpenTelemetry. Para mais informações sobre a interface do usuário do New Relic OpenTelemetry, consulte [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Para visualizar os dados de métrica do processo ATP no New Relic:**

          1. Vá para **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Vá para <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Pesquise a entidade onde você instalou o coletor NRDOT com ATP.

          3. Selecione a entidade e clique em **<DNT>Process</DNT>** no painel esquerdo.

             Na página <DNT>Process</DNT>, você pode visualizar todos os processos em execução no seu host, juntamente com seus IDs e métricas de utilização de CPU e memória. Ele também exibe a relação pai-filho entre processos se um processo gerar outros processos.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>
    </TabsPageItem>
  </TabsPages>
</Tabs>

## Parâmetro de configuração [#config-parameters]

<CollapserGroup>
  <Collapser id="core-settings" title="Configurações principais">
    <table>
      <thead>
        <tr>
          <th>
            **Parâmetro**
          </th>

          <th>
            **Tipo**
          </th>

          <th>
            **Padrão**
          </th>

          <th>
            **Descrição**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_storage`
          </td>

          <td>
            boleano
          </td>

          <td>
            `true`
          </td>

          <td>
            Habilite o armazenamento persistente. Os caminhos de armazenamento são determinados automaticamente: Linux: `/var/lib/nrdot-collector/adaptiveprocess.db`, Windows: `%LOCALAPPDATA%\nrdot-collector\adaptiveprocess.db`
          </td>
        </tr>

        <tr>
          <td>
            `retention_minutes`
          </td>

          <td>
            inteiro
          </td>

          <td>
            `30`
          </td>

          <td>
            Por quanto tempo reter o estado do processo em minutos
          </td>
        </tr>

        <tr>
          <td>
            `include_process_list`
          </td>

          <td>
            matriz
          </td>

          <td>
            `[]`
          </td>

          <td>
            Nomes de processos a serem sempre incluídos (ignora a filtragem)
          </td>
        </tr>

        <tr>
          <td>
            `metric_thresholds`
          </td>

          <td>
            map
          </td>

          <td>
            `{}`
          </td>

          <td>
            Limites estáticos por tipo de métrica
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="dynamic-thresholds" title="Limiares dinâmicos">
    <table>
      <thead>
        <tr>
          <th>
            **Parâmetro**
          </th>

          <th>
            **Tipo**
          </th>

          <th>
            **Padrão**
          </th>

          <th>
            **Descrição**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_dynamic_thresholds`
          </td>

          <td>
            boleano
          </td>

          <td>
            `false`
          </td>

          <td>
            Habilitar ajuste de limite adaptativo
          </td>
        </tr>

        <tr>
          <td>
            `dynamic_smoothing_factor`
          </td>

          <td>
            float
          </td>

          <td>
            `0.1`
          </td>

          <td>
            Fator de suavização para adaptação de limiar (0.0-1.0)
          </td>
        </tr>

        <tr>
          <td>
            `min_thresholds`
          </td>

          <td>
            map
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valores de limiar mínimo por métrica
          </td>
        </tr>

        <tr>
          <td>
            `max_thresholds`
          </td>

          <td>
            map
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valores máximos de limite por métrica
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="multi-metric-scoring" title="Pontuação composta multimétrica">
    <table>
      <thead>
        <tr>
          <th>
            **Parâmetro**
          </th>

          <th>
            **Tipo**
          </th>

          <th>
            **Padrão**
          </th>

          <th>
            **Descrição**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_multi_metric`
          </td>

          <td>
            boleano
          </td>

          <td>
            `false`
          </td>

          <td>
            Habilitar pontuação composta em métricas
          </td>
        </tr>

        <tr>
          <td>
            `composite_threshold`
          </td>

          <td>
            float
          </td>

          <td>
            `1.5`
          </td>

          <td>
            Limiar para avaliação da pontuação composta. Esta pontuação deve ser maior que `0.0`
          </td>
        </tr>

        <tr>
          <td>
            `weights`
          </td>

          <td>
            map
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valores de peso por métrica para pontuação composta
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="anomaly-detection" title="Detecção de anomalia">
    <table>
      <thead>
        <tr>
          <th>
            **Parâmetro**
          </th>

          <th>
            **Tipo**
          </th>

          <th>
            **Padrão**
          </th>

          <th>
            **Descrição**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_anomaly_detection`
          </td>

          <td>
            boleano
          </td>

          <td>
            `false`
          </td>

          <td>
            Ativar camada de detecção de anomalias
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_history_size`
          </td>

          <td>
            inteiro
          </td>

          <td>
            `15`
          </td>

          <td>
            Número de pontos de dados históricos para rastrear
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_change_threshold`
          </td>

          <td>
            float
          </td>

          <td>
            `50.0`
          </td>

          <td>
            Limite de variação percentual para anomalias
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_min_data_points`
          </td>

          <td>
            inteiro
          </td>

          <td>
            `3`
          </td>

          <td>
            Mínimo de pontos de dados necessários antes da detecção de anomalias
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

/\* ## Diretrizes de limite de métricas ### Utilização de CPU (escala 0.0-1.0) - \*\*Filtragem leve\*\*: \`0.10\` (10% CPU) - \*\*Filtragem padrão\*\*: \`0.05\` (5% CPU) - \*\*Filtragem agressiva\*\*: \`0.02\` (2% CPU) ### Utilização de memória (escala 0.0-1.0) - \*\*Filtragem leve\*\*: \`0.10\` (10% memória) - \*\*Filtragem padrão\*\*: \`0.05\` (5% memória) - \*\*Filtragem agressiva\*\*: \`0.02\` (2% memória) ### Uso de memória (bytes) - \*\*Processos pequenos\*\*: \`52428800\` (50 MB) - \*\*Processos médios\*\*: \`104857600\` (100 MB) - \*\*Processos grandes\*\*: \`209715200\` (200 MB) ### Limites de E/S (bytes) - \*\*E/S leve\*\*: \`1048576\` (1 MB) - \*\*E/S média\*\*: \`5242880\` (5 MB) - \*\*E/S pesada\*\*: \`10485760\` (10 MB) ## Correspondência de nome de processo O ATP corresponde nomes de processos usando o caminho completo: ### Exemplos - ✅ \*\*Correto\*\*: \`/usr/sbin/nginx\` - ✅ \*\*Correto\*\*: \`/usr/bin/java\` - ❌ \*\*Incorreto\*\*: \`&quot;nginx&quot;\` não corresponderá ### Nomes de processos comuns \`\`\`yaml include\_process\_list: # Servidores web - &quot;nginx&quot; - &quot;apache2&quot; - &quot;httpd&quot; # Bancos de dados - &quot;postgres&quot; - &quot;mysql&quot; - &quot;redis&quot; - &quot;mongodb&quot; # Aplicações - &quot;java&quot; - &quot;python&quot; - &quot;node&quot; - &quot;php-fpm&quot; \`\`\` \*/

## Recursos relacionados [#related-resources]

<DocTiles>
  <DocTile title="Resolução de problemas" path="/docs/opentelemetry/nrdot/atp/troubleshooting">
    Saiba como solucionar problemas de ATP no seu ambiente.
  </DocTile>

  <DocTile title="Consulte seus dados" path="/docs/opentelemetry/nrdot/atp/query">
    Saiba como consultar dados de ATP no New Relic usando NRQL.
  </DocTile>

  <DocTile title="Recursos-avançados" path="/docs/opentelemetry/nrdot/atp/advanced-features">
    Saiba como ativar recursos avançados para sua implantação do ATP.
  </DocTile>
</DocTiles>