---
title: 'Escopo do erro: usuários, sessões e dispositivos afetados'
metaDescription: 'Triage more effectively by viewing how many users, sessions, or devices are impacted by an error group.'
freshnessValidatedDate: never
translationType: machine
---

O agente New Relic captura automaticamente dados sobre o escopo dos erros que afetam seu aplicativo. Ao organizar por grupo de erros, você pode ver o impacto por meio de três métricas principais:

* **usuário impactado**: O número de usuários únicos afetados por erros
* **Sessões afetadas**: O número de sessões únicas do browser afetadas (valor padrão para a entidade do browser).
* **Dispositivos afetados**: Número de dispositivos móveis únicos afetados (recurso alternativo para entidades móveis)

Quando os dados que afetam o usuário não estão disponíveis, New Relic exibe automaticamente a métrica alternativa apropriada com base no tipo da sua entidade. Isso ajuda você a priorizar onde concentrar seus esforços de depuração, mostrando os erros com maior potencial de impacto.

<img title="An image showing how to navigate impact metrics in errors inbox" alt="This is an image of the main errors inbox showing users, sessions, and devices impacted" src="/images/errors-inbox_screenshot-full_users-impacted.webp" />

<figcaption>
  Acesse **[one.newrelic.com](https://one.newrelic.com) &gt; APM &amp; Services &gt; Errors (errors inbox) &gt; Triage**: Você pode encontrar o impacto métrico na segunda coluna da tabela **Error groups** , localizada abaixo das séries temporais **Error count** e **Error rate** .
</figcaption>

## Impacto de fallback Métrica [#fallback-metrics]

New Relic prioriza a exibição dos dados de impacto mais relevantes para o seu tipo específico de aplicativo. Quando os dados do **Users impacted** não estão disponíveis, o sistema recorre automaticamente à métrica específica da entidade:

* **Entidade de Browser **: Exibe as **Sessions impacted** - o número de sessões únicas do browser afetadas por erros.
* **Entidade móvel**: Exibe os **Devices impacted** - o número de dispositivos móveis únicos afetados por erros.

Essas métricas de fallback são coletadas automaticamente sem necessidade de configuração adicional, ao contrário do usuário impactado que pode necessitar de atributo personalizado. Isso garante que você sempre tenha visibilidade do escopo dos erros que afetam seu aplicativo, independentemente da sua configuração.

## Atributo personalizado para rastrear usuário impactado [#custom-attributes]

Em alguns casos, um evento de erro pode não ter atributos que identifiquem o usuário final afetado por esse evento de erro. Você pode adicionar manualmente um atributo personalizado para que nosso agente capture metadados de identificação do usuário no momento da ingestão.

Para casos em que você precisa adicionar um atributo personalizado, recomendamos revisar [as convenções de atributo doOpenTelemetry](/docs/more-integrations/open-source-telemetry-integrations/opentelemetry/opentelemetry-introduction) porque há várias convenções comuns para nomear o atributo final do usuário.

Por exemplo, [os padrõesOpenTelemetry ](https://opentelemetry.io/docs/reference/specification/trace/semantic_conventions/span-general/#general-identity-attributes)usam o seguinte atributo em ordem de prioridade:

* `userId`
* `user`

Você pode revisar como New Relic processa o atributo personalizado lendo nosso documento sobre como [coletar eventos personalizados](/docs/data-apis/custom-data/custom-events/collect-custom-attributes/#enabling-custom).

## consulta para impacto Métrica [#query]

As métricas de impacto para grupos de erros são registradas como [tipos de dados métrica](/docs/data-apis/understand-data/metric-data/metric-data-type/) com nomes métrica específicos:

<CollapserGroup>
  <Collapser className="freq-link" id="users" title="usuário afetado">
    Você pode consultar o número de usuários impactados usando `newrelic.error.group.userImpact` como nome da métrica na consulta NRQL :

    ```sql
    SELECT uniqueCount(newrelic.error.group.userImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.userImpact'
    ```

    Esta consulta métrica NRQL captura o número aproximado de usuários únicos no período de tempo selecionado. Atributos adicionais fornecidos pela métrica `userImpact` que podem ser usados em uma cláusula `FACET` são `error.group.guid` e `entity.guid`.
  </Collapser>

  <Collapser className="freq-link" id="sessions" title="Sessões afetadas">
    Você pode consultar o número de sessões impactadas usando `newrelic.error.group.sessionImpact` como nome da métrica na consulta NRQL :

    ```sql
    SELECT uniqueCount(newrelic.error.group.sessionImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.sessionImpact'
    ```
  </Collapser>

  <Collapser className="freq-link" id="devices" title="Dispositivos afetados">
    Você pode consultar o número de dispositivos afetados usando `newrelic.error.group.deviceUuidImpact` como nome da métrica na consulta NRQL :

    ```sql
    SELECT uniqueCount(newrelic.error.group.deviceUuidImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.deviceUuidImpact'
    ```
  </Collapser>
</CollapserGroup>

## Alerta sobre impacto Métrica [#alert]

Ao criar uma [condição de alertaNRQL ](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-alert-conditions/), os desenvolvedores podem acionar <InlinePopover type="alerts" />quando o escopo dos erros exceder um limite. Você pode criar alertas para qualquer um dos indicadores de impacto da Métrica:

* **Usuário impactado**: alerta quando o impacto do usuário ultrapassa seu limite
* **Sessões afetadas**: Receba um alerta quando o impacto nas sessões do browser exceder o limite definido.
* **Dispositivos afetados**: Receba um alerta quando o impacto em dispositivos móveis ultrapassar o seu limite.

A criação desse alerta requer a determinação da [consulta NRQL](/docs/query-your-data/nrql-new-relic-query-language/get-started/introduction-nrql-new-relics-query-language/) que mede a quantidade de usuários impactados da maneira que melhor captura seu caso de uso.

Como exemplo, a seguinte consulta NRQL mede a quantidade de usuários únicos que foram impactados por um [grupo de erros](/docs/errors-inbox/errors-inbox/#groups) vindo de uma entidade específica:

<CollapserGroup>
  <Collapser className="freq-link" id="user" title="alertas sobre o usuário afetado">
    ```sql
    SELECT uniqueCount(newrelic.error.group.userImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.userImpact' 
    AND entity.guid='RXxCUk9XU9182nNEFQUExJQ0FLsU9OfDgzNzgwNw' FACET error.group.guid TIMESERIES
    ```

    Leia mais sobre como usar a função [`uniqueCount()`](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions/) e [como encontrar o GUID da entidade](/docs/new-relic-solutions/new-relic-one/core-concepts/what-entity-new-relic/#find) para suas entidades.

    Da mesma forma, a seguinte consulta NRQL mede o número total de usuários impactados por erros de todas as entidades da conta na última hora:

    ```sql
    SELECT count(newrelic.error.group.userImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.userImpact' SINCE 1 hour ago TIMESERIES
    ```
  </Collapser>

  <Collapser className="freq-link" id="session" title="alertas sobre sessões afetadas">
    Para aplicativos de browser, você pode criar alertas com base nas sessões afetadas:

    ```sql
    SELECT uniqueCount(newrelic.error.group.sessionImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.sessionImpact' 
    AND entity.guid='YOUR_BROWSER_ENTITY_GUID' FACET error.group.guid TIMESERIES
    ```
  </Collapser>

  <Collapser className="freq-link" id="device" title="alertas em dispositivos afetados">
    Para aplicativos móveis, você pode criar alertas com base nos dispositivos afetados:

    ```sql
    SELECT uniqueCount(newrelic.error.group.deviceUuidImpact) 
    FROM Metric 
    WHERE metricName='newrelic.error.group.deviceUuidImpact' 
    AND entity.guid='YOUR_MOBILE_ENTITY_GUID' FACET error.group.guid TIMESERIES
    ```
  </Collapser>
</CollapserGroup>

Depois de decidir sobre uma consulta NRQL, ela pode ser usada para criar uma [condição do alerta NRQL](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions/#create).

Para melhorar a relação sinal-ruído dos alertas acionados, consulte [dicas de criação de alertas](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions/#condition-tips), [como os limites de alerta são avaliados](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions/#advanced-signal) e [exemplos de condição do alerta](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions/#examples).

## Definir usuário impactado pelo método setUser [#set-users]

Você pode usar um método agente para identificar um usuário final para a métrica do **Users impacted**. As sessões e os dispositivos afetados são coletados automaticamente, sem necessidade de configuração adicional. Veja abaixo os detalhes de implementação para cada agente:

<table>
  <thead>
    <tr>
      <th>
        Agente
      </th>

      <th>
        Método para identificar um usuário final
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Browser
      </td>

      <td>
        [`newrelic.setUserId(value: string|null)`](/docs/browser/new-relic-browser/browser-apis/setuserid/)
      </td>
    </tr>

    <tr>
      <td>
        Go
      </td>

      <td>
        [`txn.SetUserID("example user ID")`](/docs/apm/agents/go-agent/api-guides/guide-using-go-agent-api/#user-tracking)
      </td>
    </tr>

    <tr>
      <td>
        Java
      </td>

      <td>
        [`NewRelic.setUserId(String userId);`](/docs/apm/agents/java-agent/attributes/java-agent-attributes/#user-attributes)
      </td>
    </tr>

    <tr>
      <td>
        Mobile
      </td>

      <td>
        [`setUserId`](/docs/data-apis/custom-data/custom-events/report-mobile-monitoring-custom-events-attributes/#track-user)
      </td>
    </tr>

    <tr>
      <td>
        .NET
      </td>

      <td>
        [`SetUserId`](/docs/apm/agents/net-agent/net-agent-api/itransaction/#setuserid)
      </td>
    </tr>

    <tr>
      <td>
        Node.js
      </td>

      <td>
        [`setUserID(id)`](https://newrelic.github.io/node-newrelic/API.html#setUserID)
      </td>
    </tr>

    <tr>
      <td>
        PHP
      </td>

      <td>
        [`newrelic_set_user_id(string $user_id)`](https://docs.newrelic.com/docs/apm/agents/php-agent/php-agent-api/newrelic_set_user_id/)
      </td>
    </tr>

    <tr>
      <td>
        Python
      </td>

      <td>
        [`newrelic.agent.set_user_id(user_id)`](https://docs.newrelic.com/docs/apm/agents/python-agent/python-agent-api/setuserid-python-agent-api)
      </td>
    </tr>

    <tr>
      <td>
        Ruby
      </td>

      <td>
        [`NewRelic::Agent.set_user_id`](/docs/apm/agents/ruby-agent/api-guides/sending-handled-errors-new-relic/#user-tracking)
      </td>
    </tr>
  </tbody>
</table>