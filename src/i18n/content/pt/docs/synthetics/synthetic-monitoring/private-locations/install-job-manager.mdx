---
title: Instale o gerenciador de tarefas Sintético
tags:
  - Synthetics
  - Synthetic monitoring
  - Private locations
metaDescription: Install New Relic's container based job manager that accepts and runs jobs assigned to your private locations
freshnessValidatedDate: never
translationType: machine
---

Nossos gerenciadores de tarefas de monitoramento Sintético são recursos baseados em [contêineresDocker ](https://www.docker.com/resources/what-container)que aceitam e executam [monitores Sintético](/docs/synthetics/synthetic-monitoring/using-monitors/intro-synthetic-monitoring/#types-of-synthetic-monitors) atribuídos a [localização privada](/docs/synthetics/synthetic-monitoring/private-locations/private-locations-overview-monitor-internal-sites-add-new-locations).

O gerenciador de tarefas pode operar em um ambiente de sistema de contêiner Docker, um ambiente de sistema de contêiner Podman, um ambiente de sistema de orquestração de contêiner Kubernetes ou um ambiente de sistema de contêiner OpenShift. O gerenciador de tarefas detecta automaticamente seu ambiente para selecionar o modo operacional apropriado.

## Recurso sintético do gerenciador de tarefas [#enhancements]

Como o gerenciador de tarefas Sintético opera como um contêiner em vez de uma máquina virtual, simplificamos [a instalação](#install), [os primeiros passos ](#start)e [a atualização](#install) do gerenciamento e da orquestração de tarefas. Ele também vem com algumas funcionalidades adicionais:

* Compatível com Linux, [macOS](https://docs.docker.com/docker-for-mac/) e [Windows](https://docs.docker.com/docker-for-windows/).
* [Segurança](#security) aprimorada e suporte para execução de usuário [não root](#run-as-non-root) .
* Capacidade de aproveitar um contêiner Docker como um ambiente [sandbox](#docker-dependencies) .

## Recurso específico do Kubernetes [#kubernetes-enhancements]

O gerenciador de tarefas apresenta algumas funcionalidades adicionais específicas do Kubernetes:

* Usa recursos CronJob do Kubernetes para executar o monitor sem ping
* Não requer acesso privilegiado ao soquete Docker
* Suporta cluster hospedado e local do Kubernetes
* Suporta vários motores de contêiner, como Docker e Containerd
* Implantável por meio de gráficos Helm, bem como YAMLs de configuração
* Permite alocação de recursos baseada em tempo de execução de trabalho configurável (ping, API e browser) para gerenciamento ideal de recursos
* Observabilidade oferecida através do cluster New Relic do Kubernetes Explorer

## Requisito do sistema e compatibilidade [#system-requirements]

Para hospedar gerenciadores de tarefas Sintético, seu sistema deve atender aos requisitos mínimos para o ambiente de sistema escolhido.

<Callout variant="caution">
  Não modifique nenhum arquivo do gerenciador de tarefas Sintético. A New Relic não se responsabiliza por quaisquer modificações que você fizer. Para obter mais informações, entre em contato com seu representante de conta ou com um [representante técnico de vendas](https://newrelic.com/contact-sales) da New Relic.
</Callout>

<CollapserGroup>
  <Collapser
    id="docker-requirements"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Requisitos do ambiente do sistema docker contêiner</>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilidade para
          </th>

          <th>
            Requisitos
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            Sistema operacional
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou superior<br /> <DNT>**macOS:**</DNT> 10.11 ou superior<br /> <DNT>**Windows:**</DNT> Windows 10 de 64 bits ou superior

            Você também deve configurar Docker para executar o contêiner Linux para que os gerenciadores de tarefas Sintético funcionem em sistemas Windows.
          </td>
        </tr>

        <tr>
          <td>
            Processador
          </td>

          <td>
            Uma CPU AMD64 ou x86\_64 moderna e multi-core
          </td>
        </tr>

        <tr>
          <td>
            Memória
          </td>

          <td>
            3.256 GiB de RAM por núcleo de CPU (dedicado)
          </td>
        </tr>

        <tr>
          <td>
            Tamanho do disco
          </td>

          <td>
            Um mínimo de 50 GiB por host
          </td>
        </tr>

        <tr>
          <td>
            Sistema de arquivos em disco
          </td>

          <td>
            NFSv4.1 ou superior (se estiver usando NFS)
          </td>
        </tr>

        <tr>
          <td>
            [Versão Docker](https://docs.docker.com/engine/release-notes/)
          </td>

          <td>
            Docker [17.12.1-ce](https://docs.docker.com/engine/release-notes/17.12/) ou mais alto
          </td>
        </tr>

        <tr>
          <td>
            Chave de localização privada
          </td>

          <td>
            Você deve ter uma [chave de localização privada](#private-location-key)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      O gerenciador de tarefas Docker Sintéticos não foi projetado para uso com orquestradores de contêineres, como AWS ECS, Docker Swarm, Apache Mesos, instância de contêiner Azure , etc. Executar o gerenciador de tarefas Docker Sintéticos em um orquestrador de contêineres resulta em problemas inesperados, pois ele próprio funciona como um orquestrador. Se você estiver usando a orquestração de contêineres, consulte nossos [requisitos do gerenciador de tarefasKubernetes Sintéticos](/docs/synthetics/synthetic-monitoring/private-locations/install-job-manager/#kubernetes-requirements).
    </Callout>
  </Collapser>

  <Collapser
    id="podman-requirements"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilidade para
          </th>

          <th>
            Requisitos
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            Sistema operacional
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou superior<br />
          </td>
        </tr>

        <tr>
          <td>
            Processador
          </td>

          <td>
            Uma CPU AMD64 ou x86\_64 moderna e multi-core
          </td>
        </tr>

        <tr>
          <td>
            Memória
          </td>

          <td>
            3.256 GiB de RAM por núcleo de CPU (dedicado)
          </td>
        </tr>

        <tr>
          <td>
            Tamanho do disco
          </td>

          <td>
            Um mínimo de 50 GiB por host
          </td>
        </tr>

        <tr>
          <td>
            Sistema de arquivos em disco
          </td>

          <td>
            NFSv4.1 ou superior (se estiver usando NFS)
          </td>
        </tr>

        <tr>
          <td>
            [Versão Podman](https://github.com/containers/podman/releases)
          </td>

          <td>
            Podman [5.0.0-ce](https://github.com/containers/podman/releases/tag/v5.0.0) ou superior
          </td>
        </tr>

        <tr>
          <td>
            Chave de localização privada
          </td>

          <td>
            Você deve ter uma [chave de localização privada](#private-location-key)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      O gerenciador de tarefas Podman Sintéticos não foi projetado para uso com orquestradores de contêineres, como AWS ECS, Docker Swarm, Apache Mesos, Azure contêiner instância, etc. Executar o gerenciador de tarefas Docker Sintéticos em um orquestrador de contêineres resulta em problemas inesperados, pois ele próprio funciona como um orquestrador. Se você estiver usando a orquestração de contêineres, consulte nossos [requisitos do gerenciador de tarefasKubernetes Sintéticos](/docs/synthetics/synthetic-monitoring/private-locations/install-job-manager/#kubernetes-requirements).
    </Callout>
  </Collapser>

  <Collapser
    id="kubernetes-requirements"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="Kubernetes icon" alt="Kubernetes icon" style={{ height: '35px', width: '40px' }} />Requisitos do ambiente do sistema de orquestração de contêineres Kubernetes</>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilidade para
          </th>

          <th>
            Requisitos
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            Sistema operacional
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou superior<br /> <DNT>**macOS:**</DNT> 10.11 ou superior<br />

            O contêiner Linux, incluindo o gerenciador de tarefas, é executado apenas em nós Linux K8s.
          </td>
        </tr>

        <tr>
          <td>
            Processador
          </td>

          <td>
            Uma CPU moderna e multi-core
          </td>
        </tr>

        <tr>
          <td>
            Podde gerenciador de tarefas sintético
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 800 Mi até 1.600 Mi

            Os recursos alocados para um pod do gerenciador de tarefas Sintético são configuráveis pelo usuário.
          </td>
        </tr>

        <tr>
          <td>
            Podde tempo de execução de ping
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi até 1 Gi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução de ping são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Podtempo de execução da API Node.js
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 1.250 Mi até 2.500 Mi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução da API Node.js são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Podde tempo de execução do browser Node.js
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 1,0 até 1,5<br /> <DNT>**Memory:**</DNT> 2.000 Mi até 3.000 Mi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução do browser Node.js são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Tamanho do disco
          </td>

          <td>
            <DNT>**Root volume:**</DNT> Um mínimo de 50 GiB<br />
          </td>
        </tr>

        <tr>
          <td>
            Sistema de arquivos em disco
          </td>

          <td>
            NFSv4.1 ou superior (se estiver usando NFS)
          </td>
        </tr>

        <tr>
          <td>
            Versão do Kubernetes
          </td>

          <td>
            É necessário [o Kubernetes v1.21](https://kubernetes.io/blog/2021/04/08/kubernetes-1-21-release-announcement/) ou mais recente.
          </td>
        </tr>

        <tr>
          <td>
            Chave de localização privada
          </td>

          <td>
            Você deve ter uma [chave de localização privada](#private-location-key)
          </td>
        </tr>

        <tr>
          <td>
            Leme
          </td>

          <td>
            Siga [as instruções de instalação do Helm v3](https://helm.sh/docs/intro/install/) para o seu sistema operacional.
          </td>
        </tr>

        <tr>
          <td>
            Kubectl
          </td>

          <td>
            Siga [as instruções de instalação do Kubectl](https://kubernetes.io/docs/tasks/tools/install-kubectl/) para o seu sistema operacional.
          </td>
        </tr>
      </tbody>
    </table>

    Para visualizar versões, dependência, valores padrão de quantos pods de tempo de execução iniciam com cada gerenciador de tarefas Sintético e muito mais, consulte [Mostrar ajuda e exemplos](#help) abaixo.
  </Collapser>

  <Collapser id="Openshift-requirements" title="Requisitos do ambiente do sistema de contêiner OpenShift">
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilidade para
          </th>

          <th>
            Requisitos
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            Sistema operacional
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> [3.10 ou superior](https://docs.redhat.com/en/documentation/openshift_container_platform/3.11/html/installing_clusters/install-config-install-prerequisites#hardware)<br /> <DNT>**macOS:**</DNT> 10.11 ou superior<br />

            O contêiner Linux, incluindo o gerenciador de tarefas, é executado apenas em nós Linux K8s.
          </td>
        </tr>

        <tr>
          <td>
            Processador
          </td>

          <td>
            Um moderno, multi-core `AMD64` ou `x86_64 CPU`
          </td>
        </tr>

        <tr>
          <td>
            Podde tempo de execução de ping
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi até 1 Gi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução de ping são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Podtempo de execução da API Node.js
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi até 1 Gi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução de ping são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Podtempo de execução da API Node.js
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 até 0,75<br /> <DNT>**Memory:**</DNT> 1.250 Mi até 2.500 Mi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução da API Node.js são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Podde tempo de execução do browser Node.js
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 1,0 até 1,5<br /> <DNT>**Memory:**</DNT> 2.000 Mi até 3.000 Mi

            Considerações adicionais:

            * Os recursos alocados para um pod de tempo de execução do browser Node.js são configuráveis pelo usuário.
            * A proporção máxima de recursos de solicitação de limite para CPU e memória é 2.
          </td>
        </tr>

        <tr>
          <td>
            Tamanho do disco
          </td>

          <td>
            <DNT>**Root volume:**</DNT> Um mínimo de 50 GiB<br />
          </td>
        </tr>

        <tr>
          <td>
            Sistema de arquivos em disco
          </td>

          <td>
            NFSv4.1 ou superior (se estiver usando NFS)
          </td>
        </tr>

        <tr>
          <td>
            Versão
          </td>

          <td>
            Versão 4.11 e posteriores.
          </td>
        </tr>

        <tr>
          <td>
            Chave de localização privada
          </td>

          <td>
            Você deve ter uma [chave de localização privada](#private-location-key)
          </td>
        </tr>

        <tr>
          <td>
            Leme
          </td>

          <td>
            Siga [as instruções de instalação do Helm v3](https://helm.sh/docs/intro/install/) para o seu sistema operacional.
          </td>
        </tr>
      </tbody>
    </table>

    Para visualizar versões, dependência, valores padrão de quantos pods de tempo de execução iniciam com cada gerenciador de tarefas Sintético e muito mais, consulte [Mostrar ajuda e exemplos](#help) abaixo.
  </Collapser>
</CollapserGroup>

## Chave de localização privada

Antes de lançar os gerenciadores de empregos Sintético, você deve ter uma [chave de localização privada](/docs/synthetics/synthetic-monitoring/private-locations/private-locations-overview-monitor-internal-sites-add-new-locations#create-location). Seu gerenciador de tarefas Sintético usa a chave para autenticar no New Relic e executar o monitoramento associado a essa localização privada.

Para encontrar a chave da localização privada existente:

1. Vá para <DNT>**[one.newrelic.com &gt; Synthetic monitoring &gt; Private locations](https://one.newrelic.com/synthetics-nerdlets/private-location-list)**</DNT>.
2. No índice <DNT>**Private locations**</DNT> , localize a localização privada à qual você deseja que seu gerente de tarefas Sintético seja atribuído.
3. Observe a chave associada à localização privada com a chave <Icon name="fe-key" /> ícone.

## Instalar, atualizar e configurar o gerenciador de tarefas Sintético [#install]

Se você estiver executando mais de um Docker ou Podman no mesmo host, você terá conflitos de porta. Para evitar essa contenção de porta, certifique-se de fazer o seguinte ao começar a configurar os gerenciadores de tarefas:

* Execute gerenciadores de tarefas e chamadas por minuto em hosts diferentes.
* Execute cada gerenciador de tarefas em um host separado.
* Execute cada chamada por minuto em um host diferente.

As imagens do gerenciador de tarefas Sintético são hospedadas no [Docker Hub](https://hub.docker.com/). Acesse [hub.docker.com/r/newrelic/synthetics-job-manager/tags](https://hub.docker.com/r/newrelic/synthetics-job-manager/tags) para obter uma lista de todos os lançamentos.

A menos que você esteja hospedando as imagens em um repositório de imagens local, você precisa permitir conexões com `docker.io` através do seu firewall para que Docker ou o Podman possam extrair o gerenciador de tarefas do Sintéticos e o tempo de execução das imagens do Synthetics. Quando o gerenciador de tarefas do Sintéticos é iniciado, as imagens de tempo de execução são extraídas automaticamente. Consulte [Configuração do ambienteDocker ](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#docker-env-config), [Configuração do ambiente Podman](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#podman-env-config) e [Configuração do ambienteKubernetes ](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#kubernetes-env-config)para obter detalhes sobre como definir um repositório local e o endpoint de registro do executor.

Para obter mais detalhes sobre definições de configuração avançadas, consulte [Configuração do gerenciador de tarefas Sintético](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration).

## Inicie o gerenciador de tarefas Sintético [#start]

A seguir estão as instruções aplicáveis do Docker, Podman ou Kubernetes para iniciar o gerenciador de tarefas.

<CollapserGroup>
  <Collapser
    id="docker-update"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Procedimento de inicialização do docker</>
    }
  >
    1. Localize sua [chave de localização privada](#private-location-key).

    2. Certifique-se de ter habilitado [a dependênciaDocker ](#docker-dependencies)para sandbox e [instalado](#install-update) o gerenciador de tarefas Sintéticos no seu sistema.

    3. Execute o script apropriado para o seu sistema. Adapte o padrão comum `/var/run/docker.sock` nos exemplos a seguir para corresponder ao seu sistema.

       * Linux/macOS:

         ```shell
         docker run \
             --name YOUR_CONTAINER_NAME \
             -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" \
             -v /var/run/docker.sock:/var/run/docker.sock:rw \
             -d \
             --restart unless-stopped \
             newrelic/synthetics-job-manager:latest
         ```

       * Windows:

         ```shell
         docker run ^
             --name YOUR_CONTAINER_NAME ^
             -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" ^
             -v /var/run/docker.sock:/var/run/docker.sock:rw ^
             -d ^
             --restart unless-stopped ^
             newrelic/synthetics-job-manager:latest
         ```

       Veja o log do seu contêiner minion:

       ```shell
       docker logs --follow YOUR_CONTAINER_NAME
       ```
  </Collapser>

  <Collapser
    id="podman-update"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    1. Localize sua [chave de localização privada](#private-location-key).
    2. Certifique-se de ter habilitado [o Podman dependência](#podman-dependencies) para sandbox e [instalado](#install-update) o gerenciador de tarefas Sintéticos no seu sistema.
    3. Execute o script abaixo para seu sistema.

    Para criar um pod no Linux e adicionar o endereço IP da máquina host:

    ```
    podman pod create --network slirp4netns --name YOUR_POD_NAME --add-host=podman.service:HOST_IP_ADDRESS
    ```

    Para iniciar o Gerenciador de Tarefas:

    ```
    podman run \
    --name YOUR_CONTAINER_NAME \
    --pod YOUR_POD_NAME \
    -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" \
    -e "CONTAINER_ENGINE=PODMAN" \
    -e "PODMAN_API_SERVICE_PORT=YOUR_PODMAN_API_SERVICE_PORT" \
    -e "PODMAN_POD_NAME=YOUR_POD_NAME" \
    -d \
    --restart unless-stopped \
    newrelic/synthetics-job-manager:latest
    ```

    Para visualizar os logs do seu contêiner minion:

    ```
    podman logs --follow YOUR_CONTAINER_NAME
    ```
  </Collapser>

  <Collapser
    id="kubernetes-install"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="img-integration-k8s@2x.png" alt="img-integration-k8s@2x.png" style={{ height: '35px', width: '40px' }} />Procedimento de inicialização do Kubernetes</>
    }
  >
    1. Localize sua [chave de localização privada](#private-location-key).

    2. Configure um namespace para o gerenciador de tarefas Sintético em seu cluster do Kubernetes:

       ```shell
       kubectl create namespace YOUR_NAMESPACE
       ```

    3. Copie os gráficos do Helm do repositório do Helm do New Relic.

       * Se você estiver copiando os gráficos pela primeira vez:

         ```shell
         helm repo add YOUR_REPO_NAME https://helm-charts.newrelic.com
         ```

       * Se você copiou anteriormente os gráficos do Helm do repositório do New Relic Helm, obtenha os mais recentes:

         ```shell
         helm repo update
         ```

    4. Instale o gerenciador de tarefas Sintético com o seguinte comando do Helm:

       * Para uma nova instalação do gerenciador de tarefas Sintético:

         ```
         helm install YOUR_JOB_MANAGER_NAME YOUR_REPO_NAME/synthetics-job-manager -n YOUR_NAMESPACE --set synthetics.privateLocationKey=YOUR_PRIVATE_LOCATION_KEY
         ```

       * Para atualizar uma instalação existente do gerenciador de tarefas Sintético:

         ```shell
         helm upgrade YOUR_JOB_MANAGER_NAME YOUR_REPO_NAME/synthetics-job-manager -n YOUR_NAMESPACE --set synthetics.privateLocationKey=YOUR_PRIVATE_LOCATION_KEY
         ```

    5. Verifique se o pod do gerenciador de tarefas Sintético está instalado e funcionando:

       ```shell
       kubectl get -n YOUR_NAMESPACE pods
       ```

       Assim que o atributo `status` de cada pod for mostrado como `running`, seu gerenciador de tarefas Sintético estará ativo e pronto para executar o monitoramento atribuído à sua localização privada.
  </Collapser>

  <Collapser id="-install" title="Procedimento de inicialização do OpenShift">
    Certifique-se de ter o [OpenShift CLI (oc)](https://docs.redhat.com/en/documentation/openshift_container_platform/4.8/html/cli_tools/openshift-cli-oc) instalado para executar comandos via OpenShift CLI.

    1. Localize sua [chave de localização privada](#private-location-key).

    2. Efetue login no seu projeto OpenShift:

       ```shell
       oc project your_namespace
       ```

    3. Crie uma tag de imagem usando o comando:

       ```shell
       oc create imagestream image_streame_name -n your_namespace
       ```

    4. Criar `buildConfig.yaml`

       ```shell
       apiVersion: build.openshift.io/v1
       kind: BuildConfig
       metadata:
       name: synthetics-node-api-runtime-build
       namespace: <your_namespace> 
       spec:
       output:
         to:
           kind: ImageStreamTag
           name: <your_output_image_name>:<output_tag> 
       source:
         type: Dockerfile
         dockerfile: |-
           FROM newrelic/synthetics-node-api-runtime:latest 
           USER root
           RUN setcap -r /usr/bin/node
           USER 2000
       strategy:
         type: Docker
         dockerStrategy:
           platform:
             architecture: amd64 
       postCommit: {}
       triggers:
         - type: ConfigChange
         - type: ImageChange
           imageChange:
             from:
               kind: ImageStreamTag
               name: <image_stream_name>:latest
       ```

    5. Aplique o `BuildConfig`:

       ```shell
       oc create -f buildConfig.yaml
       ```

    6. (Opcional) Inicie a compilação (se a compilação não iniciar automaticamente, execute este comando):

       ```shell
       oc start-build synthetics-node-api-runtime-build -n your-namespace
       ```

       <Callout variant="important">
         Monitore o progresso da construção usando:

         ```shell
         oc logs -f bc/synthetics-node-api-runtime-build -n synthetics
         ```
       </Callout>

    7. implantar com Helm:

       * Execute este comando para adicionar o repositório de gráficos do New Relic Helm à configuração local Helm , permitindo que você instale facilmente a integração do Kubernetess.

         ```shell
         helm repo add newrelic https://helm-charts.newrelic.com
         ```

       * Execute o comando abaixo para executar o SJM em sua localização privada no OpenShift:

         ```shell
         helm install release_name newrelic/synthetics-job-manager -n your_namespace --set synthetics.privateLocationKey=private_location_key --set image_stream_name.image.repository=image_repo --set image_stream_name.appVersionOverride=tag
         ```

         * **release\_name**: qualquer nome que você queira dar à sua imagem.

         * **your\_namespace**: como arquivo mentionml.

         * **private\_location\_key**: chave exclusiva correspondente à sua localização privada.

         * **image\_stream\_name**: conforme mencionado no arquivo buildConfig yaConfig yaml.

         * **tag**: conforme mencionado no arquivo yaml buildConfig.

         * **repositório de imagens**:

           * execute oc registry info no terminal para obter a url do registro.
           * image\_repo é uma combinação de url de registro, `your_namespace`, `your_output_image_name` conforme mencionado no arquivo yaml buildConfig, separados por barra. registery\_url/seu\_namespace/nome\_da\_sua\_imagem\_de\_saída

         Consideremos o seguinte exemplo:

         ```shell
         helm install synthetics-kevin newrelic/synthetics-job-manager -n synthetics --set synthetics.privateLocationKey=<PRIVATE_LOC_KEY>   --set node-api-runtime.image.repository=default-route-openshift-image-registry.apps-crc.testing/synthetics/synthetics-node-api-runtime --set node-api-runtime.appVersionOverride=custom
         ```

    8. Verifique se o pod do gerenciador de tarefas do Sintéticos está ativo e funcionando:

       ```shell
       oc get pods -n your-namespace
       ```
  </Collapser>
</CollapserGroup>

## Pare ou exclua o gerenciador de tarefas Sintético [#stop]

Em um ambiente de sistema de contêiner Docker ou Podman, use o respectivo procedimento `stop` para parar o gerenciador de tarefas do Sintéticos. Em um ambiente de sistema de orquestração de contêineres Kubernetes , use o procedimento `delete` Kubernetes para interromper a execução do gerenciador de tarefas do Sintéticos.

<CollapserGroup>
  <Collapser
    id="docker-stop"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Procedimento de parada do docker</>
    }
  >
    Você pode [parar um contêiner Docker](https://docs.docker.com/engine/reference/commandline/stop/) pelo nome do contêiner ou pelo ID do contêiner.

    * Parada de nome de contêiner para Linux, macOS e Windows:

      ```shell
      docker stop YOUR_CONTAINER_NAME
      docker rm YOUR_CONTAINER_NAME
      ```

    * Parada de ID do contêiner para Linux/macOS:

      Nos exemplos o contêiner é parado e removido. Para parar apenas o contêiner, omita `docker rm $CONTAINER_ID`.

      ```shell
      CONTAINER_ID=$(docker ps -aqf name=YOUR_CONTAINER_NAME)
      docker stop $CONTAINER_ID
      docker rm $CONTAINER_ID
      ```

    * Parada de ID do contêiner para Windows:

      Nos exemplos o contêiner é parado e removido. Para parar apenas o contêiner, omita `docker rm $CONTAINER_ID`.

      ```shell
      FOR /F "tokens=*" %%CID IN ('docker ps -aqf name=YOUR_CONTAINER_NAME') do (SET CONTAINER_ID=%%CID)
      docker stop %CONTAINER_ID%
      docker rm %CONTAINER_ID%
      ```
  </Collapser>

  <Collapser
    id="podman-stop"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Docker icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    Você pode [parar um contêiner Podman](https://docs.podman.io/en/stable/markdown/podman-stop.1.html) pelo nome do contêiner ou pelo ID do contêiner.

    * Nome do contêiner stop para Linux:

    ```
    podman stop YOUR_CONTAINER_NAME
    podman rm YOUR_CONTAINER_NAME
    ```

    * Parada de ID do contêiner para Linux:

    Nos exemplos o contêiner é parado e removido. Para parar apenas o contêiner, omita `podman rm $CONTAINER_ID`.

    ```
    CONTAINER_ID=$(podman ps -aqf name=YOUR_CONTAINER_NAME)
    podman stop $CONTAINER_ID
    podman rm $CONTAINER_ID
    ```
  </Collapser>

  <Collapser
    id="kubernetes-delete"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="img-integration-k8s@2x.png" alt="img-integration-k8s@2x.png" style={{ height: '35px', width: '40px' }} />Procedimento de exclusão do Kubernetes</>
    }
  >
    1. Obtenha o `JOB_MANAGER_POD_INSTALLATION_NAME` do pod do gerenciador de tarefas do Sintético que você deseja excluir:

       ```shell
       helm list -n YOUR_NAMESPACE
       ```

    2. Exclua o pod minion:

       ```shell
       helm uninstall -n YOUR_NAMESPACE JOB_MANAGER_POD_INSTALLATION_NAME
       ```

    3. Exclua o namespace configurado para o gerenciador de tarefas Sintético em seu cluster do Kubernetes:

       ```shell
       kubectl delete namespace YOUR_NAMESPACE
       ```
  </Collapser>

  <Collapser id="openshift-delete" title="Procedimento de exclusão do OpenShift">
    ```shell
    helm uninstall release_name -n your_namespace
    ```
  </Collapser>
</CollapserGroup>

## Sandbox e dependência [#sandboxing-and-deps]

Sandboxing e dependência são aplicáveis ao gerenciador de tarefas Sintéticos em um ambiente de sistema de contêiner Docker ou Podman.

<CollapserGroup>
  <Collapser
    id="docker-dependencies"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Dependência do docker</>
    }
  >
    O gerenciador de tarefas Sintético é executado em Docker e é capaz de aproveitar Docker como uma tecnologia de sandbox. Isso garante o isolamento completo da execução do monitor, o que melhora a segurança, a confiabilidade e a repetibilidade. Cada vez que um monitor de script ou browser é executado, o gerenciador de tarefas Sintético cria um novo contêiner Docker para executá-lo usando o tempo de execução correspondente.

    O contêiner do gerenciador de tarefas Sintético precisa ser configurado para se comunicar com o mecanismo docker para gerar contêineres de tempo de execução adicionais. Cada contêiner gerado é então dedicado a executar uma verificação associada ao [monitor Sintético](/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors) em execução na localização privada à qual o contêiner do gerenciador de tarefas Sintético está associado.

    Há uma dependência crucial no lançamento. Para ativar o sandbox, certifique-se de que:

    * Seu soquete UNIX docker gravável é montado na [variável de ambiente](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#environment-variables) `/var/run/docker.sock` ou `DOCKER_HOST`. Para obter mais informações, consulte [Opção de soquete Daemon](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option) do Docker.

      <Callout variant="caution">
        A contagem de núcleos no host determina quantos contêineres de tempo de execução o gerenciador de tarefas Sintético pode executar simultaneamente no host. Como os requisitos de memória são dimensionados para a contagem esperada do contêiner de tempo de execução, recomendamos <DNT>**not running multiple synthetics job managers on the same host**</DNT> para evitar contenção de recursos.
      </Callout>

      Para obter informações adicionais sobre sandbox e execução como usuário root ou não root, consulte [Segurança, sandbox e execução como não root](#run-non-root).
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser
    id="podman-dependencies"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    O gerenciador de tarefas do Sintéticos é executado no Podman e consegue aproveitar o Podman como uma tecnologia de sandbox. Isso garante o isolamento completo da execução do monitor, o que melhora a segurança, a confiabilidade e a repetibilidade. Toda vez que um monitor com script ou browser é executado, o gerenciador de tarefas do Sintéticos cria um novo contêiner Podman para executá-lo usando o tempo de execução correspondente.

    O contêiner do gerenciador de tarefas do Sintéticos precisa ser configurado para se comunicar com o mecanismo do Podman para gerar contêineres de tempo de execução adicionais. Cada contêiner gerado é então dedicado a executar uma verificação associada ao [monitor Sintético](/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors) em execução na localização privada à qual o contêiner do gerenciador de tarefas Sintéticos está associado.

    Há uma dependência crucial no lançamento. Para habilitar o sandbox, certifique-se de ter:

    1. Instalou o Podman [5.0.0-ce](https://github.com/containers/podman/releases/tag/v5.0.0) ou superior.

    2. Habilitou a execução sem raiz:

       * Configure o Podman para executar o contêiner sem exigir privilégios de root.
         ```
         mkdir -p ~/.config/containers
         touch ~/.config/containers/containers.conf
         vi ~/.config/containers/containers.conf
         ```
       * Edite o arquivo `containers.conf` para configurar o Podman para usar `crun` e `systemd`:
         ```
         [engine]
         runtime = "crun"
         cgroup_manager = "systemd"
         ```

    3. Habilitou o cgroups v2 (somente RHEL):
       * Edite o GRUB para habilitar o cgroups v2, o que garante compatibilidade com os tempos de execução modernos do contêiner no RHEL.
         ```
         sudo sed -i 's/GRUB_CMDLINE_LINUX="/&systemd.unified_cgroup_hierarchy=1 /' /etc/default/grub
         sudo grub2-mkconfig -o /boot/grub2/grub.cfg
         sudo reboot
         ```

    4. Habilitou a delegação em todo o sistema para permitir a delegação `cgroups` para os serviços do Podman.
       ```
       sudo mkdir -p /etc/systemd/system/user@.service.d/
       echo -e "[Service]\nDelegate=yes" | sudo tee /etc/systemd/system/user@.service.d/delegate.conf > /dev/null
       ```

    5. Configure o serviço `systemd` em nível de usuário:

       * Crie diretórios para os serviços de nível de usuário `systemd` .
         ```
         mkdir -p ~/.config/systemd/user/podman.service.d
         ```
       * Adicione a configuração de delegado ao serviço `systemd` em nível de usuário.
         ```
         echo -e "[Service]\nDelegate=yes" > ~/.config/systemd/user/podman.service.d/override.conf
         ```

    6. Habilitou e iniciou o soquete Podman.
       ```
       systemctl --user enable podman.socket
       systemctl --user start podman.socket
       systemctl --user status podman.socket
       ```

    7. Criei e configurei o serviço Podman API:

       * Crie um serviço de API do Podman e configure o Podman para fornecer acesso à API HTTP.
         ```
         mkdir -p ~/.config/systemd/user
         touch ~/.config/systemd/user/podman-api.service
         vi ~/.config/systemd/user/podman-api.service
         ```
       * Defina o serviço para expor a API do Podman na porta 8000.
         ```
         [Unit]
         Description=Podman API Service
         After=default.target

         [Service]
         Type=simple
         ExecStart=/usr/bin/podman system service -t 0 tcp:0.0.0.0:8000
         Restart=on-failure

         [Install]
         WantedBy=default.target
         ```

    8. Habilitou e iniciou o serviço da API do Podman.
       ```
       systemctl --user daemon-reload
       systemctl --user enable podman-api.service
       systemctl --user start podman-api.service
       systemctl --user status podman-api.service
       ```

    <Callout variant="caution">
      A contagem de núcleos no host determina quantos contêineres de tempo de execução o gerenciador de tarefas Sintético pode executar simultaneamente no host. Como os requisitos de memória são dimensionados para a contagem esperada do contêiner de tempo de execução, recomendamos <DNT>**not running multiple synthetics job managers on the same host**</DNT> para evitar contenção de recursos.
    </Callout>
  </Collapser>
</CollapserGroup>

## Segurança, sandbox e execução como não-root [#security]

Por padrão, o software executado dentro de um gerenciador de tarefas Sintético é executado com `root` privilégios de usuário. Isso é adequado para a maioria dos cenários, pois a execução ocorre em área restrita.

Para executar o gerenciador de tarefas Sintético como um usuário não root, são necessárias etapas adicionais:

<CollapserGroup>
  <Collapser
    id="run-non-root"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Execute como usuário não root para docker</>
    }
  >
    Para obter mais informações, consulte a documentação oficial do Docker sobre [segurança](https://docs.docker.com/engine/security/security/) e [perfis de segurança do AppArmor](https://docs.docker.com/engine/security/apparmor/).

    Se o seu ambiente exigir que você execute o gerenciador de tarefas Sintético como um usuário não-root, siga este procedimento. No exemplo a seguir, o usuário não root é `my_user`.

    1. Certifique-se de que `my_user` possa usar o mecanismo Docker no host:

       Verifique se `my_user` [pertence ao grupo de sistemas `"docker"` ](https://docs.docker.com/engine/install/linux-postinstall/). O acesso raiz com escopo ao `docker.sock` ainda é necessário para criar redes de ponte.

       OU

       Habilite a [opção de soquete Docker TCP](https://docs.docker.com/engine/reference/commandline/dockerd/#examples) e passe a [variável de ambiente](#environemnt-variables) `DOCKER_HOST` para o gerenciador de tarefas Sintético.

    2. Verifique se `my_user` tem permissões de leitura/gravação para todos os diretórios e volumes passados para o gerenciador de tarefas Sintético. Para definir essas permissões, use o comando `chmod` .

    3. Obtenha o `uid` de `my_user` para uso no comando de execução: `id -u my_user`.

       Uma vez atendidas essas condições, use a opção `"-u <uid>:<gid>"` ao iniciar o gerenciador de tarefas Sintético:

       ```shell
       docker run ... -u 1002 ...
       ```

       OU

       ```shell
       docker run ... -u 1002 -e DOCKER_HOST=http://localhost:2375 ...
       ```
  </Collapser>
</CollapserGroup>

## Entenda seus ambientes Docker, Podman, Kubernetes ou OpenShift [#understand]

Abaixo estão informações adicionais sobre como manter e compreender o ambiente de contêiner do gerenciador de tarefas. Visualize informações de licença, entenda as configurações de rede do gerenciador de tarefas e confira o repositório de imagens docker .

<CollapserGroup>
  <Collapser id="help" title="Manter o gerenciador de tarefas">
    Use estas opções conforme aplicável:

    * Para acompanhar os logs do Docker ou Podman e verificar a integridade dos seus monitores, consulte [Manutenção e monitoramento do gerenciador de tarefas da Sintéticos](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-maintenance-monitoring).

    * Para um gerenciador de tarefas do Sintéticos no ambiente do sistema de orquestração de contêineres **OpenShift** e **Kubernetes** , os seguintes comandos Helm `show` podem ser usados para visualizar o `chart.yaml` e o `values.yaml`, respectivamente:

      ```shell
      helm show chart YOUR_REPO_NAME/synthetics-job-manager
      ```

      ```shell
      helm show values YOUR_REPO_NAME/synthetics-job-manager
      ```
  </Collapser>

  <Collapser id="license" title="Mostrar informações de licença">
    Alguns de nossos softwares de código aberto estão listados sob diversas licenças de software e, nesse caso, listamos a licença que escolhemos usar. Nossas informações de licença também estão disponíveis em [nossa documentação de licenças](/docs/licenses/new-relic-products/new-relic-synthetics/new-relic-synthetics-licenses).
  </Collapser>

  <Collapser id="network" title="Configurações de rede">
    Tanto para docker quanto para Kubernetes, o gerenciador de tarefas Sintético e seu contêiner de runtime herdarão as configurações de rede do host. Para obter um exemplo disso em um ambiente de sistema de contêiner docker , consulte o [sitedocker ](https://docs.docker.com/config/containers/container-networking/).

    Uma rede bridge é criada para comunicação entre o gerenciador de tarefas Sintético e o contêiner runtime. Isso significa que opções de comando de rede como `--network` e `--dns` passadas para o contêiner do gerenciador de tarefas Sintético no lançamento (como por meio de comandos docker run em um ambiente de sistema docker contêiner) não são herdadas ou usadas pelos contêineres de tempo de execução.

    Quando essas redes são criadas, elas extraem do pool de endereços IP padrão configurado para o daemon. Para obter um exemplo disso em um ambiente de sistema de contêiner Docker , consulte o [site Docker ](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file).

    No caso do Podman, não usamos uma rede de ponte para comunicação entre o gerenciador de tarefas do Sintéticos e o contêiner de tempo de execução, em vez disso, usamos um pod Podman. Todos os contêineres em um pod Podman compartilham o mesmo namespace de rede. Isso significa que eles compartilham o mesmo endereço IP dentro desse pod. Neste caso, embora os contêineres compartilhem o mesmo IP, seus serviços são expostos em portas diferentes.
  </Collapser>

  <Collapser id="image" title="Repositório de imagens Docker">
    Uma única imagem Docker do gerenciador de tarefas Sintéticos atende ao ambiente do sistema de orquestração de contêineres **Docker**, **Podman**, **OpenShift** e **Kubernetes** . A imagem do Docker é hospedada no Docker Hub. Para garantir que sua imagem do Docker esteja atualizada, consulte o [repositório newrelic/synthetics-job-manager do Docker Hub](https://hub.docker.com/r/newrelic/synthetics-job-manager/tags).
  </Collapser>
</CollapserGroup>

## Considerações adicionais para conexão do gerenciador de tarefas Sintético [#FAQ]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Conexão
      </th>

      <th>
        Descrição
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Gestores de trabalho Sintético sem acesso à Internet
      </td>

      <td>
        Um gestor de empregos Sintético pode operar sem acesso à internet, mas com algumas exceções. O gerenciador de tarefas do Sintético precisa poder entrar em contato com o domínio `"synthetics-horde.nr-data.net"` . Isso é necessário para que ele reporte dados ao New Relic e receba o monitor para execução. Pergunte à administração da rede se isso é um problema e como configurar exceções.
      </td>
    </tr>

    <tr>
      <td>
        Comunique-se com o Sintético através de um proxy
      </td>

      <td>
        Para configurar a comunicação com o New Relic por proxy, use as [variáveis de ambiente](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration#environment-variables) denominadas `HORDE_API_PROXY*.`
      </td>
    </tr>

    <tr>
      <td>
        Argumentos aprovados no lançamento
      </td>

      <td>
        Isso se aplica somente ao ambiente de contêiner Docker e Podman. Os argumentos passados para o contêiner do gerenciador de tarefas Sintéticos no lançamento não são repassados para o contêiner de tempo de execução gerado pelo gerenciador de tarefas Sintéticos. Docker e o Podman não têm o conceito de &quot;herança&quot; ou &quot;hierarquia&quot; de contêiner, e não copiamos a configuração que é passada do gerenciador de tarefas do Sintéticos para o contêiner em tempo de execução. Entretanto, no caso do Podman, os argumentos passados no nível pod são compartilhados entre o gerenciador de tarefas do Sintéticos e o contêiner de tempo de execução no pod. A única configuração compartilhada entre eles é aquela definida no nível [do daemon do Docker](https://docs.docker.com/config/daemon/) .
      </td>
    </tr>
  </tbody>
</table>