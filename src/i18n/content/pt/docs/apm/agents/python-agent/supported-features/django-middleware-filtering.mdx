---
title: Filtragem de instrumentação de middleware Django
tags:
  - Agents
  - Python agent
  - Supported features
metaDescription: Python agent (Django) middleware instrumentation filtering
freshnessValidatedDate: never
translationType: machine
---

O agente Python agora pode filtrar qual middleware Django deve ser monitorado. Por padrão, todo o middleware será instrumentado.

<Callout variant="important">
  O middleware de instrumentação Filtering for Django está disponível para Python Agent versão 10.17.0 e superiores. Por padrão, todo o middleware será instrumentado. Para alterar essa configuração, confira nossa [documentação](/docs/apm/agents/python-agent/configuration/python-agent-configuration/#middleware-filters).
</Callout>

## Desabilitar todos os middlewares Django [#django-middleware-disable]

A desabilitação da instrumentação do middleware no Django pode ser feita de duas maneiras:

1. Defina a variável de ambiente `NEW_RELIC_INSTRUMENTATION_DJANGO_MIDDLEWARE_ENABLED` como `False`
2. Defina `instrumentation.middleware.django.enabled = false` no arquivo de configuração.

## Definições de configuração do middleware Django [#django-middleware-configuration-settings]

<CollapserGroup>
  <Collapser id="config-middleware-django-include" title="instrumentation.middleware.django.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo:
          </th>

          <td>
            Lista de strings separadas por espaço
          </td>
        </tr>

        <tr>
          <th>
            Padrão:
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado, todas as chaves de atributo desta lista serão enviadas.
  </Collapser>

  <Collapser id="config-middleware-django-exclude" title="instrumentation.middleware.django.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo:
          </th>

          <td>
            Lista de strings separadas por espaço
          </td>
        </tr>

        <tr>
          <th>
            Padrão:
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo desta lista **não** serão enviadas.
  </Collapser>
</CollapserGroup>

## Regras de exclusão/inclusão de middleware [#django-middleware-rules]

O agente segue estas regras ao determinar qual middleware incluir ou excluir para monitoramento:

<CollapserGroup>
  <Collapser id="rule-destination-precedence" title="Ativado tem precedência sobre incluir e excluir.">
    Os sinalizadores `instrumentation.middleware.FRAMEWORK.enabled` têm precedência sobre middlewares de inclusão e exclusão.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = false
    instrumentation.middleware.django.include = one two
    instrumentation.middleware.django.include = three four
    ```

    Exemplo de saída:

    ```
    Middleware used in app: one, two, three, four
    Middleware included for monitoring:
    Middleware excluded for monitoring: one, two, three, four
    ```
  </Collapser>

  <Collapser id="rule-included-destination" title="O middleware é incluído se o destino estiver habilitado.">
    Se um destino estiver habilitado, todo o middleware será enviado para esse destino por padrão.

    Todo o monitoramento de middleware é padronizado como `true`.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = baz
    ```

    Exemplo de saída:

    ```
    Middleware used in app: foo, bar, baz
    Middleware included for monitoring: foo, bar
    Middleware excluded for monitoring: baz
    ```
  </Collapser>

  <Collapser id="rule-exclude-wins" title="Excluir sempre substitui incluir.">
    Se o mesmo middleware estiver listado nas listas de inclusão e exclusão, o middleware com o nome especificado será excluído.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = foo bar
    instrumentation.middleware.django.exclude = nerd bar
    ```

    Exemplo de saída:

    ```
    Middleware used in app: foo, bar, nerd
    Middleware included for monitoring: foo
    Middleware excluded for monitoring: nerd, bar
    ```
  </Collapser>

  <Collapser id="rule-middleware-name-case-sensitive" title="Os nomes de middleware diferenciam maiúsculas de minúsculas.">
    Os nomes de middleware diferenciam maiúsculas de minúsculas.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = username UsErNaMe
    ```

    Exemplo de saída:

    ```
    Middleware used in app: username, Username, USERNAME, UsErNaMe, userNAME
    Middleware included for monitoring:  Username, USERNAME, userNAME
    Middleware excluded for monitoring:  username, UsErNaMe
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>Use <InlineCode>
      \*
    </InlineCode> para curingas.</>
    }
  >
    Você pode usar um asterisco `*` no final de um nome como curinga. Isso corresponderá a um conjunto de middleware com o mesmo prefixo.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = custom*
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Exemplo de saída:

    ```
    Middleware used in app: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: custom, custom.key1, custom.key2
    Middleware excluded for monitoring: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser id="rule-specific-wins" title="O nome mais específico do middleware tem prioridade.">
    Se vários nomes de inclusão ou exclusão afetarem o mesmo middleware, o nome mais específico terá prioridade.

    Exemplo de configuração:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = request.parameters.foo
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Exemplo de saída:

    ```
    Middleware used in app: request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: request.parameters.foo
    Middleware included for monitoring: request.parameters., request.parameters.bar
    ```
  </Collapser>
</CollapserGroup>