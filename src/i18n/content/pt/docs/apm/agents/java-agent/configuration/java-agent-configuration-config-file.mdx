---
title: 'Configuração do agente Java: arquivo de configuração'
tags:
  - Agents
  - Java agent
  - Configuration
metaDescription: 'New Relic''s Java agent config settings for APM, including transaction tracer, errors, custom instrumentation, distributed tracing, system properties, etc.'
freshnessValidatedDate: never
translationType: machine
---

O agente Java New Relic lê sua configuração do arquivo `newrelic.yml` . Por padrão, o agente procura esse arquivo no [diretório](/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent) que contém `newrelic.jar`. Você pode substituir o local do arquivo de configuração definindo a propriedade de sistema [`newrelic.config.file`](#newrelic-config-file) com um nome de arquivo completo.

Você poderá configurar nosso agente Java para se adequar ao seu ambiente depois de [criar uma conta New Relic](https://newrelic.com/signup) (é grátis, para sempre) e [instalar o agente Java](/docs/apm/agents/java-agent/installation/install-java-agent/).

## Estrutura do arquivo de configuração [#Structure]

O arquivo `newrelic.yml` possui seções separadas para ambientes diferentes:

* Teste
* Desenvolvimento
* Preparação
* Produção (padrão)

A New Relic aplica as configurações da seção `common` a cada um desses ambientes. Você pode selecionar outros ambientes como padrão configurando a propriedade de sistema [`newrelic.environment`](#newrelic-environment) como o nome do ambiente.

<Callout variant="tip">
  Um [modelo`newrelic.yml` ](/docs/java/java-agent-config-file-template)está disponível.
</Callout>

Se você editar `newrelic.yml`, tome cuidado para estar em conformidade com o [formato YAML](https://en.wikipedia.org/wiki/YAML). Use um validador YAML para garantir que a sintaxe esteja precisa antes de usar o arquivo com o agente Java da New Relic e siga estas regras:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        <DNT>
          **Java agent newrelic.yml**
        </DNT>
      </th>

      <th>
        <DNT>
          **Requirements**
        </DNT>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Formatar
      </td>

      <td>
        Os arquivos YML diferenciam maiúsculas de minúsculas.
      </td>
    </tr>

    <tr>
      <td>
        Recuos
      </td>

      <td>
        Todos os recuos devem estar em incrementos de dois caracteres. Outros recuos resultarão em um erro `Unable to parse configuration file` na inicialização do agente.

        * Use o mesmo nível de recuo para dados na mesma seção do arquivo.
        * Recue quaisquer subseções com mais dois espaços.
      </td>
    </tr>

    <tr>
      <td>
        Mudanças no arquivo
      </td>

      <td>
        Você deve reiniciar o processo do host JVM para que as alterações entrem em vigor.

        <DNT>**Exception:**</DNT> As alterações de propriedade em `log_level` e `audit_mode` não requerem reinicialização. As alterações de propriedade no circuit breaker não exigem reinicialização.
      </td>
    </tr>
  </tbody>
</table>

## Precedência das definições de configuração [#config-options-precedence]

Para substituir qualquer configuração no arquivo de configuração, use uma [substituição de propriedade do sistema](#System_Properties). Em determinados ambientes, [as variáveis de ambiente](#Environment_Variables) também podem ser usadas para substituir o arquivo de configuração e as propriedades do sistema. As variáveis de ambiente existem principalmente para oferecer suporte ao Heroku. Quando usada, [Configuração no lado do servidor](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration) substitui todas as outras definições de configuração.

<img
  title="java-config-order.png"
  alt="java-config-order.png"
  src="/images/apm_diagram_Java-config-precedence.webp"
/>

<figcaption>
  Com o agente Java, a configuração no lado do servidor substitui todas as outras configurações. Variáveis de ambiente substituem propriedades do sistema Java. As propriedades Java substituem as definições de configuração do usuário no arquivo `newrelic.yml` . As configurações do usuário substituem as configurações padrão `newrelic.yml` .
</figcaption>

## Configurando o diretório de extensões Java [#extensions-directory]

O agente Java lê os arquivos de configuração na inicialização do processo. Para identificar o diretório onde os arquivos estão localizados, crie um novo diretório ou especifique um diretório de extensões existente:

<CollapserGroup>
  <Collapser
    id="create-extensions-directory"
    title="Crie um diretório de extensões"
  >
    Para criar o diretório de extensões:

    1. Navegue até o diretório onde `newrelic.jar` e `newrelic.yml` estão localizados. Crie um diretório chamado `extensions`.
    2. Em `newrelic.yml`, verifique se a propriedade [`extensions.dir`](#cfg-extensions-dir) não está definida.
  </Collapser>

  <Collapser
    id="specify-extensions-directory"
    title="Especifique um diretório de extensões existente"
  >
    Para usar um diretório de extensões Java existente:

    1. No arquivo `newrelic.yml` , localize a seção `common` .
    2. Use a propriedade [`extensions.dir`](#cfg-extensions-dir) para especificar o local do arquivo.
  </Collapser>
</CollapserGroup>

## Configurações gerais de configuração [#General]

Defina essas opções na seção `common` . Para [substituir](#System_Properties) qualquer uma dessas opções, use uma propriedade de sistema com prefixo `newrelic.config` .

<CollapserGroup>
  <Collapser
    id="cfg-license_key"
    title="license_key (OBRIGATÓRIA)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração é <DNT>**required**</DNT>. Você deve especificar a [chave de licença](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key) associada à sua conta New Relic. Esta chave vincula os dados do seu agente à sua conta no serviço New Relic.
  </Collapser>

  <Collapser
    id="cfg-app_name"
    title="app_name (OBRIGATÓRIO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração é <DNT>**required**</DNT>. Define o [nome do aplicativo](/docs/site/naming-your-application) usado para reportar dados ao New Relic.

    Se [`enable_auto_app_naming`](#cfg-enable_auto_app_naming) for falso, o agente reportará todos os dados para este aplicativo. Caso contrário, o agente reportará apenas tarefas em segundo plano (transação para aplicativo não web) para este aplicativo.

    Para reportar dados para [mais de um aplicativo](/docs/java/multiple-application-names), separe os nomes dos aplicativos com ponto e vírgula. Por exemplo, para reportar dados para <DNT>**My Application**</DNT> e <DNT>**My Application 2**</DNT> use isto:

    ```yml
    app_name: My Application;My Application 2
    ```

    Para obter mais métodos de nomear seu aplicativo, consulte [Nomeie seu aplicativo Java](/docs/agents/java-agent/configuration/name-your-java-application).
  </Collapser>

  <Collapser
    id="cfg-agent_enabled"
    title="agent_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Sinalizador para habilitar o agente. Use esta configuração para forçar a execução ou não da execução do agente.
  </Collapser>

  <Collapser
    id="cfg-apdex_t"
    title="apdex_t (DESCONTINUADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Float
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `1.0`
          </td>
        </tr>
      </tbody>
    </table>

    O limite `apdex_t` em segundos para a pontuação [Apdex](/docs/site/apdex-measuring-user-satisfaction) do aplicativo. Para o agente Java versões 1.2.008 ou superior, o valor `apdex_t` é configurado na interface e o valor em `newrelic.yml` é ignorado.
  </Collapser>

  <Collapser
    id="cfg-appserver_port"
    title="appserver_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Número para diferenciar JVMs para o mesmo aplicativo na mesma máquina. New Relic [usa host/port para unicidade](/docs/agents/java-agent/configuration/hostname-logic-java#unique-identifier), então você pode distinguir as JVMs colocando uma opção como esta nos argumentos de inicialização de cada JVM:

    ```ini
    -Dnewrelic.config.appserver_port=<var>8081</var>
    ```

    Depois de usar `appserver_port` para nomear as JVMs e reiniciá-las, você poderá vê-las individualmente no dropdown e na interface de criação de perfil.

    <Callout variant="important">
      Esta é apenas uma mudança para a New Relic; na verdade, não afeta a porta na qual o host se comunica de forma alguma.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-audit_mode"
    title="audit_mode"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Permite o registro em texto simples de todos os dados enviados ao New Relic para o arquivo de log do agente. Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.
  </Collapser>

  <Collapser
    id="ca_config_bundle"
    title="ca_bundle_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Formato do valor
          </th>

          <td>
            `/path/to/ca/cert/bundle.pem`
          </td>
        </tr>
      </tbody>
    </table>

    Especifica um caminho para um pacote de certificado SSL personalizado que será usado pelo agente para estabelecer uma conexão segura com o New Relic. Se o seu pacote de certificado SSL personalizado não incluir certificados suficientes para se conectar ao New Relic, você precisará [mesclar os certificados necessários em seu pacote de certificados personalizado](/docs/agents/java-agent/troubleshooting/ssl-or-connection-errors-java).

    <Callout variant="important">
      Nossa implementação do Java Flight Recorder que atualmente acompanha o agente Java usa o SDK de telemetria. Especificar um ca_bundle_path não atualizará o certificado que nossa opção JFR usa para se conectar ao New Relic. Se você estiver usando um armazenamento confiável customizado e quiser usar a implementação JFR do agente Java, será necessário adicionar os certificados necessários ao seu armazenamento confiável customizado.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-enable_auto_app_naming"
    title="enable_auto_app_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Permite o relatório de dados separadamente para cada aplicativo web. Defina como `true` para ativar o suporte para nomeação automática de aplicativos. O nome de cada aplicativo web é detectado automaticamente e o agente reporta os dados separadamente para cada um. Isso fornece um detalhamento de desempenho mais detalhado para aplicativos da web no New Relic.

    Para obter mais informações, consulte [Nomeação automática de aplicativos](/docs/agents/java-agent/configuration/automatic-application-naming).

    Para obter mais métodos de nomear seu aplicativo, consulte [Nomeie seu aplicativo Java](/docs/agents/java-agent/configuration/name-your-java-application).
  </Collapser>

  <Collapser
    id="cfg-enable_auto_transaction_naming"
    title="enable_auto_transaction_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Permite nomenclatura de transação baseada em componentes. Defina como `true` para ativar a nomenclatura de transação baseada em componentes. Defina como `false` para usar o URI de uma solicitação da web como o nome da transação. Para obter mais informações, consulte [Nomenclatura de transação da web](/docs/agents/java-agent/instrumentation/naming-web-transactions).

    <Callout variant="caution">
      A menos que você implemente a chamada de API para nomear sua transação, desabilitar a nomenclatura de transação automática provavelmente causará [problemas de agrupamento métrico](/docs/features/metric-grouping-issues).
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-enable_custom_tracing"
    title="enable_custom_tracing"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Ativa toda a instrumentação [usando uma anotação `@Trace` ](/docs/agents/java-agent/custom-instrumentation/java-instrumentation-annotation). Desabilitar isso faz com que `@Trace` anotações sejam ignoradas.
  </Collapser>

  <Collapser
    id="event_ingest_uri"
    title="event_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            [`https://insights-collector.newrelic.com/v1/accounts/events`](https://insights-collector.newrelic.com/v1/accounts/events)
          </td>
        </tr>
      </tbody>
    </table>

    Evento ingerir URI usado por algum recurso do agente. O padrão é o endpoint de ingestão de produção dos EUA. Pode ser configurado manualmente para enviar o evento para outro endpoint de ingestão (por exemplo, produção na UE: [`https://insights-collector.eu01.nr-data.net/v1/accounts/events`](https://insights-collector.eu01.nr-data.net/v1/accounts/events)).

    Os clientes compatíveis com FedRAMP devem usar o [endpoint compatível com FedRAMP](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/#event-api): `https://gov-insights-collector.newrelic.com/v1/accounts/events`
  </Collapser>

  <Collapser
    id="cfg-extensions-dir"
    title="extensions.dir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Define a localização do [diretório de extensões](#extensions-directory) opcionais. Se esta propriedade não estiver configurada, o agente procurará um subdiretório denominado `extensions` no mesmo diretório que `newrelic.jar` e `newrelic.yml`.
  </Collapser>

  <Collapser
    id="cfg-enable_high_security"
    title="high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Para que [a alta segurança](/docs/subscriptions/high-security) seja ativada, esta propriedade deve ser definida como `true` e a propriedade de alta segurança na interface do usuário do New Relic deve ser ativada. Ativar alta segurança significa que o SSL está ativado, a solicitação e a fila de parâmetros não são coletadas e a consulta não pode ser enviada para a New Relic em sua forma bruta.

    <Callout variant="important">
      A partir do [agente Java 3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480), SSL está habilitado por padrão e a opção de configuração para desativá-lo foi descontinuada. A partir do [agente Java 4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400), a capacidade de desativar SSL foi removida.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-host"
    title="hospedar"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Fornece a capacidade de configurar um [endpointcompatível com FedRAMP](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/) para uso do agente, com o valor `gov-collector.newrelic.com`.
  </Collapser>

  <Collapser
    id="cfg-insert_api_key"
    title="insert_api_key"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Uma [chave de API de inserção](/docs/apis/get-started/intro-apis/types-new-relic-api-keys#event-insert-key) válida para sua conta. Isso não é usado atualmente pelo agente.
  </Collapser>

  <Collapser
    id="labels"
    title="rótulos"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    Anexe a [tag](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers) a este aplicativo.

    Observe que esta opção agora habilita o tag, que substituiu o recurso de rótulo. Você ainda pode consultar seus [rótulos](/docs/new-relic-one/use-new-relic-one/core-concepts/tagging-use-tags-organize-group-what-you-monitor#labels) históricos. Várias tags podem ser anexadas usando um ponto e vírgula como separador, como segue:

    ```ini
    -Dnewrelic.config.labels="tagName1:tagValue1;tagName2:tagValue2;tagName3:tagValue3"
    ```
  </Collapser>

  <Collapser
    id="legacy_async_api_skip_suspend"
    title="legacy_async_api_skip_suspend"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            Falso
          </td>
        </tr>
      </tbody>
    </table>

    Em casos raros, pode ocorrer um vazamento de memória com instrumentação que usa a API assíncrona herdada para rastrear o ciclo de vida de servlets assíncronos ou Jetty Continuations. O vazamento de memória se manifestaria como transações vazadas que foram suspensas, mas nunca retomadas. Esta configuração funciona como uma solução alternativa para evitar que tal cenário ocorra. É aconselhável ativar esta solução alternativa apenas ao encontrar esse tipo de vazamento de memória.
  </Collapser>

  <Collapser
    id="max-stack-trace-lines"
    title="max_stack_trace_lines"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `30`
          </td>
        </tr>
      </tbody>
    </table>

    Limita o número de linhas que o agente coleta de cada stack trace. Aumentar esse valor pode afetar o desempenho, pois aumenta a quantidade de memória que o agente usa e a quantidade de dados enviados para o New Relic.
  </Collapser>

  <Collapser
    id="metric_ingest_uri"
    title="metric_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            [`https://metric-api.newrelic.com/metric/v1`](https://metric-api.newrelic.com/metric/v1)
          </td>
        </tr>
      </tbody>
    </table>

    URI de ingestão métrica utilizada por algum recurso do agente. O padrão é o endpoint de ingestão de produção dos EUA. Pode ser configurado manualmente para enviar métricas para outro endpoint de ingestão (exemplo de URI de produção da UE: [`https://metric-api.eu.newrelic.com/metric/v1`](https://metric-api.eu.newrelic.com/metric/v1)).

    Os clientes compatíveis com FedRAMP devem usar o [endpoint compatível com FedRAMP](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/#metric-api): `https://gov-metric-api.newrelic.com/metric/v1`
  </Collapser>

  <Collapser
    id="cfg-proxy_host"
    title="proxy_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    O host proxy por meio do qual se conectará ao [coletor New Relic](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). Se um proxy for usado, a configuração do host será necessária. Outras configurações de proxy são opcionais.
  </Collapser>

  <Collapser
    id="cfg-proxy_password"
    title="proxy_password"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    A senha para autenticação de proxy. Se um proxy for usado, a configuração do host será necessária. Outras configurações de proxy são opcionais. As configurações de nome de usuário e senha serão usadas para autenticar desafios de autenticação básica de um servidor proxy.

    <Callout variant="important">
      O agente Java suporta autenticação Básica (texto não criptografado).
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-proxy_port"
    title="proxy_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `8080`
          </td>
        </tr>
      </tbody>
    </table>

    O número da porta do host proxy. Se um proxy for usado, a configuração do host será necessária. Outras configurações de proxy são opcionais.
  </Collapser>

  <Collapser
    id="cfg-proxy_user"
    title="proxy_user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    O nome de usuário para autenticação de proxy, como autenticação Básica (texto não criptografado). Se um proxy for usado, a configuração do host será necessária. Outras configurações de proxy são opcionais. As configurações de nome de usuário e senha serão usadas para autenticar desafios de autenticação básica de um servidor proxy.
  </Collapser>

  <Collapser
    id="cfg-proxy_scheme"
    title="proxy_scheme"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    O esquema de proxy usado. A configuração `proxy_scheme: "https"` permitirá que o agente se conecte por meio de proxies usando o esquema HTTPS.
  </Collapser>

  <Collapser
    id="cfg-reactor-netty-errors-enabled"
    title="reactor-netty.errors.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Se os erros são relatados para o Reactor Netty. O padrão é falso. Se definido como verdadeiro, os erros do Reactor Netty serão relatados.

    <Callout variant="important">
      Disponível apenas no [agente Java 6.3.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-630) e superior.

      Observe que o padrão foi alterado para falso a partir do agente Java 6.5.0.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-send_data_on_exit"
    title="send_data_on_exit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite o encerramento atrasado da JVM para dar ao agente a chance de enviar os dados métricos mais recentes para o New Relic antes do encerramento da JVM.
  </Collapser>

  <Collapser
    id="send_data_on_exit_threshold"
    title="send_data_on_exit_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `60`
          </td>
        </tr>
      </tbody>
    </table>

    O número de segundos após os quais o agente usará a configuração [`send_data_on_exit`](#cfg-send_data_on_exit) .
  </Collapser>

  <Collapser
    id="cfg-send_environment_info"
    title="send_environment_info"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite relatórios de configurações de JVM para New Relic.
  </Collapser>

  <Collapser
    id="cfg-send_jvm_props"
    title="send_jvm_props"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `true`, as propriedades da JVM serão enviadas para o New Relic.
  </Collapser>

  <Collapser
    id="cfg-ssl"
    title="SSL (DESATIVADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Requer conexões com o coletor New Relic para passar por SSL.

    O agente se comunica com o New Relic via HTTPS por padrão, e o New Relic [requer HTTPS](/docs/apis/rest-api-v2/troubleshooting/301-response-rest-api-calls) para todo o tráfego para <InlinePopover type="apm"/>e a API REST do New Relic.

    Este trabalho é feito de forma assíncrona com os threads que processam o código da sua aplicação, portanto o tempo de resposta não será diretamente afetado por esta mudança.

    <Callout variant="important">
      A partir do [agente Java 3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480), SSL está habilitado por padrão e a opção de configuração para desativá-lo foi descontinuada. A partir do [agente Java 4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400), a capacidade de desativar SSL foi removida.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-sync_startup"
    title="sync_startup"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Permita que o agente conecte o coletor New Relic imediatamente após a inicialização do aplicativo.
  </Collapser>

  <Collapser
    id="scala-futures-segment"
    title="scala_futures_as_segments"
  >
    <Callout variant="important">
      Isso se aplica ao agente Java [versão 3.44.0 ou superior](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Para obter detalhes mais concisos do rastreamento da transação, o agente não reporta os Futuros Scala como segmentos de transação, e esses Futuros não contribuem para o [tempo total da transação](/docs/data-analysis/user-interface-functions/view-your-data/response-time#response-time-total-time).

    Ativar `scala_futures_as_segments` aumenta sua sobrecarga. Se você deseja que o Scala Futures reporte como segmentos de transação para que você possa visualizá-los em um rastreamento da transação, você pode habilitá-lo:

    ```yml
    scala_futures_as_segments:
      enabled: true
    ```
  </Collapser>

  <Collapser
    id="trim_stats"
    title="trim_stats"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Quando o tempo exclusivo de um segmento for inferior a 2% do tempo total de transação, a métrica para aquela chamada de método será agregada em `Java/other`.

    Definir `trim_stats` como `false` desativará esse comportamento, permitindo que as métricas sejam exibidas individualmente.

    ```yml
    trim_stats: false
    ```
  </Collapser>
</CollapserGroup>

## Variáveis ambientais [#Environment_Variables]

As variáveis de ambiente têm a maior precedência e substituem as propriedades do sistema e as configurações de yml.

* Para definir variáveis de ambiente, use o comando `export VARNAME=value` .
* Para definir variáveis de ambiente permanentemente, adicione a linha de exportação a um arquivo como `~/.bashrc` ou `~/.bash_profile`.

Você pode substituir qualquer configuração de uma propriedade do sistema ou no `newrelic.yml` definindo uma variável de ambiente. A variável de ambiente correspondente a uma determinada configuração no arquivo de configuração é o nome da configuração prefixado por `NEW_RELIC` com todos os pontos (`.`) e traços (`-`) substituídos por sublinhados (`_`). Por exemplo, a variável de ambiente para a configuração `log_level` é `NEW_RELIC_LOG_LEVEL`.

Para configurações aninhadas em seções, acrescente o nome da seção ao nome da configuração. Por exemplo:

```yml:
  class_transformer:
    com.newrelic.instrumentation.kafka-clients-spans-0.11.0.0:
      enabled: true
```

A configuração acima seria convertida na seguinte variável de ambiente: `NEW_RELIC_CLASS_TRANSFORMER_COM_NEWRELIC_INSTRUMENTATION_KAFKA_CLIENTS_SPANS_0_11_0_0_ENABLED`

<Callout variant="important">
  A configuração do agente por meio de variáveis de ambiente requer [o agente Java versão 4.10.0 ou superior](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

## Propriedades do sistema [#System_Properties]

Você pode substituir qualquer configuração no arquivo `newrelic.yml` definindo uma propriedade do sistema. A propriedade do sistema correspondente a uma determinada configuração no arquivo de configuração é o nome da configuração prefixado por `newrelic.config`. Por exemplo, a propriedade do sistema para a configuração `log_level` é `newrelic.config.log_level`.

Para configurações aninhadas em seções, acrescente o nome da seção ao nome da configuração. Por exemplo, a propriedade do sistema para a configuração `enabled` na seção de transação é `newrelic.config.transaction_tracer.enabled`.

Além de substituir as definições de configuração, o agente reconhece estas propriedades do sistema:

<CollapserGroup>
  <Collapser
    id="com-newrelic-jboss-jsr77-fix"
    title="com.newrelic.jboss.jsr77.fix"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    A partir da versão do agente `8.7.0`, se definido como true e o Agente estiver em execução com o JBoss EAP/Wildfly, isso impedirá que o agente exija que qualquer classe no pacote `javax.management` seja carregada pelo carregador de classe do sistema. Isso foi adicionado para ajudar a corrigir problemas de inicialização do aplicativo com Módulos JBoss quando a API de gerenciamento J2EE/Jakarta é usada. Mais informações são fornecidas no [documento resolução de problemas do](/docs/apm/agents/java-agent/troubleshooting/classloading-issues-from-jboss-and-wildfly) JBoss/Wildfly.
  </Collapser>

  <Collapser
    id="newrelic-config-experimental-runtime"
    title="newrelic.config.experimental_runtime"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Sinalizador expiratório que permite que o agente seja executado com versões java não suportadas.
  </Collapser>

  <Collapser
    id="newrelic-bootstrap_classpath"
    title="newrelic.config.process_host.display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Defina um [nome de exibição](/docs/agents/java-agent/configuration/hostname-logic-java#display-name) para decorar o rótulo “host:port” na interface do New Relic. Requer agente Java 3.17 ou superior.
  </Collapser>

  <Collapser
    id="newrelic-config-file"
    title="newrelic.config.file"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    String contendo um caminho completo para o arquivo de configuração newrelic. Se estiver vazio, o agente assume que `newrelic.yml` está no mesmo diretório que `newrelic.jar`.
  </Collapser>

  <Collapser
    id="newrelic-debug"
    title="newrelic.debug"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Habilite o log de depuração.
  </Collapser>

  <Collapser
    id="newrelic-environment"
    title="newrelic.environment"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    String contendo a configuração do ambiente a ser usada pelo agente.
  </Collapser>

  <Collapser
    id="newrelic-home"
    title="newrelic.home"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    String contendo o diretório inicial do agente. O padrão é o mesmo diretório do jarfile do agente.
  </Collapser>

  <Collapser
    id="newrelic-logfile"
    title="newrelic.logfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    String contendo o nome do arquivo de log do agente.
  </Collapser>
</CollapserGroup>

## AI Monitoring [#ai-monitoring]

Esta seção detalha as opções de configuração do agente Java para [AI Monitoring](/docs/ai-monitoring/intro-to-ai-monitoring). Esse recurso pode ser configurado na sub-rotina do arquivo de configuração yaml `ai_monitoring` , com `newrelic.config.ai_monitoring.` propriedades de sistema prefixadas ou com `NEW_RELIC_AI_MONITORING_` variáveis de ambiente prefixadas.

<Callout variant="important">
  Se distributed tracing estiver desativado ou o modo de alta segurança estiver ativado, AI Monitoring não coletará dados de IA.
</Callout>

<CollapserGroup>
  <Collapser
    id="ai-monitoring-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `true`, ativa o AI Monitoring.
  </Collapser>

  <Collapser
    id="ai-monitoring-record-content"
    title="record_content.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Se definido como `false`, o agente omitirá o conteúdo de entrada e saída (como sequências de texto de prompt e respostas) capturado no evento LLM. Esta é uma configuração de segurança opcional se você não quiser registrar dados confidenciais enviados e recebidos de seus LLMs.
  </Collapser>
</CollapserGroup>

## Atributo [#attributes]

Para definir essas opções, use a seção `attributes` . Para [substituí-](#System_Properties) los, use uma propriedade de sistema com prefixo `newrelic.config.attributes` .

Atributo são pares de valor principal relacionados ao rastreamento da transação, erros de rastreamento, <InlinePopover type="browser"/>e evento de transação. Há uma seção `attribute` em cada destino. Para obter mais informações, consulte [Atributo do agente Java](/docs/java/java-agent-attributes), [Ativando e desativando atributo](/docs/java/enabling-and-disabling-attributes) e [exemplos de atributo](/docs/java/attribute-examples).

<CollapserGroup>
  <Collapser
    id="cfg-attributes-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos. <Callout variant="important">Por motivos de segurança, a captura de atributo personalizado usando o [Custom Instrumentation Editor](/docs/agents/java-agent/custom-instrumentation/custom-instrumentation-editor-instrument-ui#options) é definida como `false` por padrão.</Callout>
  </Collapser>

  <Collapser
    id="cfg-attributes-include"
    title="incluir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado, as chaves de atributo encontradas nesta lista serão enviadas para a New Relic. Separe as chaves da lista com vírgula; por exemplo:

    ```
    key1, key2, key3
    ```

    Consulte também as [regras de atribuição de agentes](/docs/subscriptions/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-attributes-exclude"
    title="excluir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas para a New Relic. Separe as chaves da lista com vírgula; por exemplo:

    ```
    key1, key2, key3
    ```

    Consulte também as [regras de atribuição de agentes](/docs/subscriptions/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-http_attribute_mode"
    title="http_attribute_mode"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            ambos
          </td>
        </tr>
      </tbody>
    </table>

    O relatório atributo é configurável através dos seguintes meios.

    YAML:

    ```
    attributes:
    http_attribute_mode: both
    ```

    Propriedade do sistema:

    ```properties
    -Dnewrelic.config.attributes.http_attribute_mode=both
    ```

    Variável de ambiente:

    ```properties
    NEW_RELIC_ATTRIBUTES_HTTP_ATTRIBUTE=both
    ```

    As opções de configuração são:

    * `standard` : Os relatórios utilizarão padrões (ou seja, OTEL) atributo. Esta configuração é incentivada. Isso minimizará o impacto na funcionalidade e manterá o nível mais baixo de ingestão para relatórios de atributo.
    * `legacy` : Os relatórios serão feitos pelo atributo HTTP reintroduzido, esta configuração pode impactar a funcionalidade atual ou futura.
    * `both` : Esta é a configuração padrão, o reporte será feito pelo atributo HTTP reintroduzido e pelo atributo OTEL. Esta configuração também aumentará a ingestão de dados.

    <Callout variant="important">
      Disponível desde [a versão 8.8.0 do agente Java](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-880). A configuração padrão, `both`, aumentará a ingestão de dados. Para evitar um aumento na ingestão de dados, você deve substituir o padrão definindo `http_attribute_mode` como `legacy` ou `standard`.
    </Callout>
  </Collapser>
</CollapserGroup>

## Instrumentação assíncrona [#async_config]

Essas opções são definidas diretamente na seção `common` e podem ser [substituídas](#System_Properties) usando uma propriedade de sistema prefixada.

<CollapserGroup>
  <Collapser
    id="cfg-token_timeout"
    title="token_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão (segundos)
          </th>

          <td>
            `180`
          </td>
        </tr>
      </tbody>
    </table>

    O número de segundos após os quais o agente expirará automaticamente um token assíncrono que não tenha expirado explicitamente com `token.expire()`. Para obter instruções de uso, consulte [token: Conectar threads assíncronos](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#tokens).

    <Callout variant="important">
      Aumentar esse valor pode impactar o desempenho, pois aumenta a quantidade de memória que o agente utiliza e evita que a transação seja reportada devido ao token não expirado.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-segment_timeout"
    title="segment_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão (segundos)
          </th>

          <td>
            `600`
          </td>
        </tr>
      </tbody>
    </table>

    O número de segundos após os quais o agente encerrará automaticamente um segmento que não foi explicitamente encerrado com `segment.end()` ou `segment.ignore()`. Para obter instruções de uso, consulte [Segmentos: atividade assíncrona arbitrária de tempo](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#segments).

    <Callout variant="important">
      Aumentar esse valor pode impactar o desempenho, pois aumenta a quantidade de memória que o agente utiliza e evita que a transação seja reportada devido a segmentos não finalizados.
    </Callout>
  </Collapser>
</CollapserGroup>

## Monitoramento de browser [#Browser_Monitoring]

Essas opções são definidas na seção `browser_monitoring` e podem ser [substituídas](#System_Properties) usando uma propriedade de sistema com prefixo `newrelic.config.browser_monitoring` .

O monitoramento do browser fornece insights sobre o desempenho que o usuário real está experimentando com o seu site. Isso é feito medindo o tempo que o browser do seu usuário leva para baixar e renderizar suas páginas da web, injetando uma pequena quantidade de código JavaScript no cabeçalho e rodapé de cada página.

<CollapserGroup>
  <Collapser
    id="bm-auto_instrument"
    title="auto_instrument"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Por padrão, o agente insere automaticamente uma chamada de API em JSPs compilados para injetar o JavaScript de monitoramento nas páginas da web. Defina esse atributo como `false` para desativar esse comportamento.
  </Collapser>

  <Collapser
    id="bm-disabled_auto_pages"
    title="disabled_auto_pages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings separadas por vírgula
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Quando [`auto_instrument`](#bm-auto_instrument) é `true`, por padrão todas as páginas são instrumento. Liste todas as páginas que você deseja que a instrumentação automática ignore aqui. Você ainda pode usar instrumentação manual nestas páginas.

    Por exemplo:

    ```yml
    browser_monitoring:
      disabled_auto_pages: /WEB-INF/jsp/testpage_1.jsp, /WEB-INF/jsp/testpage_2.jsp
    ```
  </Collapser>

  <Collapser
    id="cfg-browser-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos de monitoramento do Browser. Esses são os [dados que você pode consultar](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data). Se `attributes.enabled` for falso no nível raiz, nenhum atributo será enviado no monitoramento do Browser independente de como esta propriedade em `browser_monitoring` estiver configurada.
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver ativado para `browser_monitoring`, todas as chaves de atributo encontradas nesta lista serão enviadas para New Relic em visualizações de página. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas para a New Relic nas visualizações de página. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Circuit breaker

Essas configurações personalizam o comportamento do [circuit breakerJava](/docs/agents/java-agent/custom-instrumentation/circuit-breaker-java-custom-instrumentation). Essas configurações não estão incluídas em `newrelic.yml` por padrão. Você não precisa reiniciar sua JVM após alterá-las.

Se desejar personalizar o circuit breaker, adicione-o na seção `common`:

```yml
common: &default_settings​
  <var>OTHER_CONFIG_SETTINGS</var>
  circuitbreaker:
    enabled: <var>true</var>
    memory_threshold: <var>20</var>
    gc_cpu_threshold: <var>10</var>
```

<CollapserGroup>
  <Collapser
    id="cfg-circuitbreaker_enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Se o seu aplicativo estiver se comportando conforme o esperado, você pode desabilitar o circuit breaker.
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_memory_threshold"
    title="memory_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro (0 a 100)
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    Personalize a porcentagem de memória heap livre abaixo da qual o circuit breaker deve desarmar. Quando a porcentagem de memória de heap livre for menor que `memory_threshold` e o tempo de CPU gasto na coleta de lixo for maior que `gc_cpu_threshold`, o circuit breaker. Para diminuir a probabilidade de o circuit breaker desarmar, diminua `memory_threshold` e/ou aumente `gc_cpu_threshold`. Ajuste esses valores conforme necessário, com base no desempenho operacional e no comportamento do seu aplicativo.
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_gc_cpu_threshold"
    title="gc_cpu_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro (0 a 100)
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10`
          </td>
        </tr>
      </tbody>
    </table>

    Personalize a porcentagem do tempo de CPU da coleta de lixo acima do qual o circuit breaker deve desarmar. Quando a porcentagem de memória heap livre for menor que `memory_threshold` e o tempo de CPU gasto na coleta de lixo for maior que `gc_cpu_threshold`, o circuit breaker . Para diminuir a probabilidade de o circuit breaker desarmar, diminua `memory_threshold` e/ou aumente `gc_cpu_threshold`. Ajuste esses valores conforme necessário, com base no desempenho operacional e no comportamento do seu aplicativo.
  </Collapser>
</CollapserGroup>

## Utilização da plataforma em nuvem [#utilization]

Defina as configurações de utilização da plataforma de nuvem na seção `utilization` e podem ser substituídas pela propriedade de sistema prefixada `newrelic.config.utilization` .

O agente coleta informações de utilização e as envia para o serviço New Relic. O agente pode coletar informações da instância Amazon Web Services (AWS), Azure, Google Cloud Platform e Pivotal Cloud Foundry. Também coletará informações relacionadas aos serviços Docker contêiner e Kubernetes.

<CollapserGroup>
  <Collapser
    id="aws-enabled"
    title="detect_aws"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente pesquisa a API de metadados da AWS.
  </Collapser>

  <Collapser
    id="azure-enabled"
    title="detect_azure"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente pesquisa a API de metadados do Azure.
  </Collapser>

  <Collapser
    id="gcp-enabled"
    title="detect_gcp"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente pesquisa a API de metadados do Google Cloud Platform.
  </Collapser>

  <Collapser
    id="kubernetes-enabled"
    title="detect_kubernetes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente reporta a variável de ambiente `KUBERNETES_SERVICE_HOST` .
  </Collapser>

  <Collapser
    id="pcf-enabled"
    title="detect_pcf"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente lê variáveis de ambiente do Pivotal Cloud Foundry.
  </Collapser>

  <Collapser
    id="docker-enabled"
    title="detect_docker"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente lê informações Docker do sistema de arquivos.
  </Collapser>
</CollapserGroup>

## Métrica al nível do código

Nível do código métrica fornece insights detalhados sobre o desempenho do seu código no nível do método. Você verá métricas para cada método que foi instrumento automaticamente, ou que foi instrumento pela anotação @Trace. Para mais informações sobre nível do código métrico, consulte [Monitoramento de desempenho com CodeStream](/docs/codestream/how-use-codestream/performance-monitoring).

Defina as opções de nível do código métrico na seção `code_level_metrics` . Eles podem ser [substituídos](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.code_level_metrics` .

<CollapserGroup>
  <Collapser
    id="clm-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [o nível do código métrico](/docs/codestream/observability/code-level-metrics) está desabilitado por padrão na versão 7.10.0 do agente. Defina isso como verdadeiro para ativá-lo. A partir da versão 7.11.0 do agente, o padrão é, conforme observado acima, `true`.
  </Collapser>
</CollapserGroup>

## Configuração Errors Inbox [#errors-inbox-configuration]

Definir uma das tags a seguir ajudará você a identificar quais versões do seu software estão produzindo erros.

* `NEW_RELIC_METADATA_SERVICE_VERSION` criará `tags.service.version` nos dados do evento contendo a versão do seu código que está implantada, em muitos casos uma versão semântica como 1.2.3, mas nem sempre.
* `NEW_RELIC_METADATA_RELEASE_TAG `criará `tags.releaseTag` nos dados do evento contendo a tag de lançamento (como v0.1.209 ou release-209).
* `NEW_RELIC_METADATA_COMMIT` criará `tags.commit` nos dados do evento contendo o commit sha. Você pode usar o sha inteiro ou apenas os primeiros sete caracteres (por exemplo, 734713b).

Uma próxima versão da Errors Inbox rastreará automaticamente quais versões do seu software estão produzindo erros. Os dados da versão serão exibidos em [CodeStream](/docs/codestream/how-use-codestream/performance-monitoring/#buildsha).

## Tracer multiaplicativo [#Cross_Application_Tracer]

<Callout variant="important">
  O rastreamento multiaplicativo foi descontinuado a partir da versão 7.4.0 do agente e será removido em uma versão futura do agente.

  Em vez de usar rastreamento multiaplicativo, recomendamos nosso recurso [distributed tracing](#distributed-tracing) . distributed tracing é uma melhoria no recurso de rastreamento multiaplicativo e é recomendado para sistemas distribuídos grandes.
</Callout>

Defina as opções de rastreamento multiaplicativo na seção `cross_application_tracer` . Essas configurações podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.cross_application_tracer` .

[O rastreamento multiaplicativo](/docs/apm/transactions/cross-application-traces/cross-application-tracing) adiciona cabeçalhos de solicitação e resposta a chamadas externas usando a biblioteca Apache HttpClient. Isso fornece melhores dados de desempenho ao chamar o aplicativo monitor por outro agente New Relic.

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="ativado (DESATIVADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [o rastreamento multiaplicativo](/docs/apm/transactions/cross-application-traces/cross-application-tracing) está habilitado por padrão. Defina isso como falso para desligá-lo.
  </Collapser>
</CollapserGroup>

## Evento personalizado [#Custom_Events]

Defina as configurações de evento personalizado na seção `custom_insights_events` . Você pode [substituir](#System_Properties) essas configurações por uma propriedade de sistema com prefixo `newrelic.config.custom_insights_events` .

O APM permite [registrar dados personalizados de eventos](/docs/insights/insights-data-sources/custom-data/insert-custom-events-new-relic-apm-agents) através do agente de idiomas da API New Relic, que [você pode consultar](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data).

<Callout variant="important">
  Para versões do agente Java anteriores a 4.1.0, a seguinte configuração YAML é reconhecida:

  ```yml
  custom_insights_events.enabled: true
    custom_insights_events.max_samples_stored: 5000
  ```

  Para versões de agente 4.1.0 e acima, a configuração YAML usa a formatação de seção aninhada:

  ```yml
  custom_insights_events:
    enabled: false
    max_samples_stored: 5000
  ```
</Callout>

<CollapserGroup>
  <Collapser
    id="cie-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Isto habilita o serviço de evento personalizado.
  </Collapser>

  <Collapser
    id="cie-max_attribute_value"
    title="max_attribute_value"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `255`
          </td>
        </tr>
      </tbody>
    </table>

    O tamanho máximo de um valor de atributo, após o qual o valor será truncado. O padrão é `255` bytes (na codificação UTF-8 charset) e o limite máximo é `4095`.

    Esta configuração existe no agente Java versão 8.9.0+.
  </Collapser>

  <Collapser
    id="cie-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `30000`
          </td>
        </tr>
      </tbody>
    </table>

    * O número máximo de eventos personalizados amostrados relatados a cada 60 segundos.
    * Ao configurar o agente para [AI Monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), defina o valor máximo `100000`. Garante que a quantidade máxima de eventos LLM seja capturada.
  </Collapser>
</CollapserGroup>

## Transformador de classe [#Class_Transformer]

Defina as configurações relacionadas à instrumentação na seção `class_transformer` . Você pode substituir essas configurações por uma [propriedade de sistema](#System_Properties) com prefixo `newrelic.config.class_transformer` ou uma [variável de ambiente](#Environment_Variables) com prefixo `NEW_RELIC_CLASS_TRANSFORMER_` .

<CollapserGroup>
  <Collapser
    id="ct-enhanced_spring_transaction_naming"
    title="enhanced_spring_transaction_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            Falso
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, a nomenclatura aprimorada de transação Spring nomeará qualquer transação originada de um controlador Spring após a rota definida e o método HTTP. Por exemplo: `/customer/v1/edit (POST)`. Isso inclui controladores que implementam ou estendem interfaces/classes com anotações relacionadas ao WebMVC (`@RestController`, `@Controller`, `@RequestMapping`, etc).

    Por padrão, isso é configurado para `false`, que nomeará a transação para esses tipos de controladores com base no nome e método da classe do controlador. Por exemplo; `CustomerController/edit`. Esta é a lógica de nomenclatura herdada das versões anteriores do agente. Controladores "padrão", com todas as anotações relevantes presentes na classe real, ainda serão nomeados com base na rota e no método HTTP.

    Esta configuração existe no agente Java versão 8.9.0+.
  </Collapser>

  <Collapser
    id="ct-trace_annotation_class_name"
    title="trace_annotation_class_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    String contendo o nome completo da classe de anotação que o agente usa para determinar quais métodos especificados pelo usuário devem ser usados. Para obter mais informações sobre anotações customizadas, consulte [Coleção Java métrica personalizada](/docs/java/java-custom-metric-collection).
  </Collapser>

  <Collapser
    id="ct-servlet-user"
    title="com.newrelic.instrumentation.servlet-user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Ative esta opção para capturar o nome `userPrincipal` . Este nome está incluído como trace da transação atributo (com nomes de atributo `user` e `enduser.id`), e [pode ser consulta](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data). Isso também permite que você veja na [Errors Inbox quantos usuários foram impactados por um grupo de erros](/docs/errors-inbox/error-users-impacted/).
  </Collapser>
</CollapserGroup>

## Distributed tracing [#dt-main]

<Callout variant="important">
  Habilitar distributed tracing desabilita [o rastreamento multiaplicativo](#Cross_Application_Tracer) e tem outros efeitos no recurso APM. Antes de ativar, leia o [guia de transição](/docs/transition-guide-distributed-tracing).

  Requer [agente Java versão 4.3.0 ou superior](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

[distributed tracing](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) permite ver o caminho que uma solicitação percorre ao percorrer sistemas distribuídos. Está ativado por padrão para o agente Java versão 7.4.0 ou superior.

No arquivo de configuração, você pode substituir isso manualmente na seção `distributed_tracing` . Você também pode substituir isso usando uma propriedade de sistema prefixada (`newrelic.config.distributed_tracing`) ou uma variável de ambiente (`NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`). Veja os exemplos abaixo.

Para obter mais informações sobre como configurar distributed tracing, consulte [Habilitar distributed tracing para seu aplicativo Java](/docs/apm/agents/go-agent/instrumentation/distributed-tracing-go-agent).

<CollapserGroup>
  <Collapser
    id="dt-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `false` para desativar distributed tracing. Por exemplo, no arquivo de configuração, você usaria:

    ```yml
    distributed_tracing:
      enabled: false
    ```

    Aqui estão outras opções para desativar distributed tracing:

    [Propriedade do sistema](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties):

    ```ini
    -Dnewrelic.config.distributed_tracing.enabled=false
    ```

    Variável de ambiente:

    ```ini
    NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=false
    ```
  </Collapser>

  <Collapser
    id="dt-exclude_newrelic_header"
    title="exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Por padrão, as versões suportadas do agente utilizam o cabeçalho `newrelic` e os cabeçalhos W3C Trace Context para distributed tracing. O cabeçalho distributed tracing `newrelic` permite interoperabilidade com agentes mais antigos que não suportam cabeçalhos W3C Trace Context . As versões do agente que suportam cabeçalhos W3C Trace Context os priorizarão em relação a `newrelic` cabeçalhos para distributed tracing.

    Se você não quiser utilizar o cabeçalho `newrelic`, defini-lo como `true` fará com que o agente exclua o cabeçalho `newrelic` e use apenas cabeçalhos W3C Trace Context para distributed tracing.

    Por exemplo, para excluir cabeçalhos `newrelic` no arquivo de configuração, você usaria:

    ```yml
    distributed_tracing:
      exclude_newrelic_header: true
    ```

    Para excluir cabeçalhos `newrelic` usando uma [propriedade do sistema](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties), você usaria:

    ```ini
    -Dnewrelic.config.distributed_tracing.exclude_newrelic_header=true
    ```
  </Collapser>
</CollapserGroup>

## Erro no coletor [#Error_Collector]

Defina as configurações do coletor de erros na seção `error_collector` . Salvo indicação em contrário, você pode [substituir](#System_Properties) essas configurações por uma propriedade de sistema com prefixo `newrelic.config.error_collector` . O coletor de erros captura informações sobre exceções não detectadas e as envia ao New Relic para visualização.

<Callout variant="tip">
  Para saber como configurar erros para o agente Java, incluindo como configurar erros por meio da interface, consulte [Configuração de erros do agente Java](/docs/agents/java-agent/configuration/java-agent-error-configuration).
</Callout>

<CollapserGroup>
  <Collapser
    id="ec-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite a coleta de erros.
  </Collapser>

  <Collapser
    id="ec-ignore_classes"
    title="ignore_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Seção contendo uma lista de strings `class_name` totalmente qualificadas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Os nomes de classes de exceção especificados serão ignorados e não afetarão taxa de erros ou pontuação Apdex, nem serão reportados à APM. <DNT>**Cannot be specified by system property.**</DNT>

    Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

    Por exemplo:

    ```yml
    error_collector:
      ignore_classes:
        - "com.example.MyException"
        - "com.example.DifferentException"
    ```

    Uma variável de ambiente pode ser usada para listar nomes de classes de exceção que você deseja que sejam ignorados:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_messages"
    title="ignore_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Seção contendo um `class_name` totalmente qualificado e uma lista de `messages` por classe de erro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Especifique os nomes das classes de exceção que o agente deve ignorar. Mensagens ignoradas não afetarão taxa de erros ou pontuação Apdex, nem serão reportadas à APM. Contém `yaml` pares que consistem em:

    * Um nome de classe de exceção totalmente qualificado que não deve ser relatado ao APM

      E

    * Uma lista de exceções `message`s para correspondência (pelo menos uma é obrigatória)

      Se o nome da classe de exceção corresponder a um erro, mas a mensagem não, esse erro <DNT>**will not**</DNT> será ignorado. As sequências de mensagens usam `contains` para correspondência. Uma mensagem não pode ser fornecida sozinha e deve sempre ser associada a um nome de classe totalmente qualificado. <DNT>**Cannot be specified by system property.**</DNT>

      Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

      Por exemplo:

      ```yml
      error_collector:
        ignore_messages:
          com.example.MyException:
            - "Some error message to ignore"
            - "Some other error message to ignore"
          com.example.DifferentException:
            - "Some different error message to ignore"
      ```

      Uma variável de ambiente pode ser usada para listar nomes de classes de exceção e mensagens que você deseja ignorar:

      ```ini
      NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
      ```
  </Collapser>

  <Collapser
    id="ec-ignore_status_codes"
    title="ignore_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista separada por vírgulas de strings e intervalos
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `404`
          </td>
        </tr>
      </tbody>
    </table>

    Uma lista separada por vírgulas composta por intervalos individuais e tracejados de códigos de status HTTP que não devem ser tratados como erros.

    Se esta propriedade for comentada no arquivo de configuração `newrelic.yml` , o código de status 404 será automaticamente ignorado. Ao utilizar [a configuração no lado do servidor](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration), o código de status 404 deve ser especificado para que seja ignorado.

    Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

    Por exemplo:

    ```yml
    error_collector:
      ignore_status_codes: 404,507-511
    ```
  </Collapser>

  <Collapser
    id="ec-expected_classes"
    title="expected_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Seção contendo uma lista de strings `class_name` totalmente qualificadas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Impede que classes de exceção especificadas afetem a taxa de erros ou a pontuação Apdex enquanto ainda relatam os erros ao APM. <DNT>**Cannot be specified by system property.**</DNT>

    Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

    Por exemplo:

    ```yml
    error_collector:
      expected_classes:
        - "com.example.MyException"
        - "com.example.DifferentException"
    ```

    Uma variável de ambiente pode ser usada para listar nomes de classes de exceção esperados:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_messages"
    title="expected_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Seção contendo um `class_name` totalmente qualificado e uma lista de `messages` por classe de erro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Contém pares yaml que consistem em um nome de classe de exceção totalmente qualificado que deve ser marcado como esperado e, portanto, impedido de afetar taxa de erros ou pontuação Apdex e uma lista de exceções `message`s para correspondência, a última das quais pelo menos uma é obrigatória . Se o nome da classe de exceção corresponder a um erro, mas a mensagem não, então esse erro <DNT>**will not**</DNT> será marcado como esperado e, portanto, afetará a taxa de erros e a pontuação do Apdex.

    As sequências de mensagens usam `contains` para correspondência. Uma mensagem não pode ser fornecida sozinha e deve sempre ser associada a um nome de classe totalmente qualificado. <DNT>**Cannot be specified by system property.**</DNT>

    Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

    Por exemplo:

    ```yml
    error_collector:
      expected_messages:
        com.example.MyException:
          - "Some expected error message"
          - "Some other expected error message"
        com.example.DifferentException:
          - "Some different expected error message"
    ```

    Uma variável de ambiente pode ser usada para listar nomes e mensagens de classes de exceção esperadas:

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_status_codes"
    title="expected_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista separada por vírgulas de strings e intervalos
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Uma lista separada por vírgulas composta por intervalos individuais e tracejados de códigos de status HTTP a serem marcados como esperado e, assim, impedidos de afetar taxa de erros ou pontuação Apdex.

    Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.

    Por exemplo:

    ```yml
    error_collector:
      expected_status_codes: 415,500-506
    ```

    Os códigos de status esperados também podem estar na variável de ambiente `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_STATUS_CODES` .
  </Collapser>

  <Collapser
    id="cfg-error-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos para erros de rastreamento. Se `attributes.enabled` for `false` no nível raiz, nenhum atributo será enviado para erros de rastreamento, independentemente de como essa propriedade estiver configurada em `error_collector`.
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado para erros de rastreamento, todas as chaves de atributo encontradas nesta lista serão enviadas para New Relic em erros de rastreamento. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    As chaves atributo encontradas nesta lista não serão enviadas para a New Relic em caso de erros de rastreamento. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="ec-ignoreErrorPriority"
    title="ignoreErrorPriority"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Quando vários erros são detectados em uma transação, apenas o último erro será relatado por padrão. Definir esta propriedade como `false` reportará apenas o primeiro erro detectado. Para obter mais informações, consulte a [API NoticeError](/docs/agents/java-agent/configuration/java-agent-error-configuration/). Por exemplo:

    ```yml
    error_collector:
      ignoreErrorPriority: false
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_errors"
    title="ignore_errors (DESCONTINUADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de Strings separadas por vírgula
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todos os nomes de classes de exceção especificados não serão tratados como erros. Obsoleto a partir do agente Java 3.40.0 e substituído por [`ignore_classes`](#ec-ignore_classes).

    Por exemplo:

    ```yml
    error_collector:
      ignore_errors: some.other.MyException
    ```
  </Collapser>
</CollapserGroup>

## Tracer externo [#External_Tracer]

Defina as opções de rastreamento externo na seção `external_tracer` . Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.external_tracer` .

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="exclude_request_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para controlar a coleta de URIs de solicitação de saída para erros e rastreamento da transação. Defina como verdadeiro para desativar a coleta dessas informações.
  </Collapser>
</CollapserGroup>

## Nome do host configuração [#hostname_configuration]

Defina as opções de configuração do nome do host na seção `process_host` . Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.process_host` .

Use estas propriedades para configurar o nome do host exibido na interface:

<CollapserGroup>
  <Collapser
    id="display_name"
    title="display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Defina um [nome de exibição](/docs/agents/java-agent/configuration/hostname-logic-java#display-name) para decorar o rótulo “host:port” na interface do New Relic.
  </Collapser>

  <Collapser
    id="ipv_preference"
    title="ipv_preference"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `4`
          </td>
        </tr>
      </tbody>
    </table>

    Se o nome do host não puder ser determinado, o endereço IP do host será usado. Esta propriedade determina se o endereço IPv4 ou IPv6 deve ser usado. O padrão é IPv4.
  </Collapser>
</CollapserGroup>

## Rastreamento infinito

<Callout variant="important">
  Requisitos:

  * [agente Java 5.12.1 ou superior](/docs/agents/java-agent/installation/update-java-agent).
  * O rastreamento infinito não funciona se `enable_auto_app_naming` estiver ativado.
</Callout>

Para ativar o rastreamento infinito, habilite distributed tracing e adicione a configuração adicional abaixo. Por exemplo, consulte [Agente de idioma: configurar distributed tracing](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#java-config).

<CollapserGroup>
  <Collapser
    id="infinite-tracing-trace-observer-host"
    title="trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Para obter ajuda para obter uma entrada válida de host do observador trace do Infinite Tracing, consulte [localizar ou criar um Trace Observer](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).

    Você pode configurar isso via YAML:

    ```yml
    infinite_tracing:
      trace_observer:
        host: <var>YOUR_TRACE_OBSERVER_HOST</var>
    ```

    Você também pode usar a propriedade do sistema `newrelic.config.infinite_tracing.trace_observer.host` ou a variável de ambiente `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`.
  </Collapser>
</CollapserGroup>

## Instrumentação

Essas opções são definidas na sub-rotina `instrumentation` e podem ser substituídas usando uma propriedade de sistema prefixada `newrelic.config.instrumentation` .

<CollapserGroup>
  <Collapser
    id="trace-lambda-enabled"
    title="trace_lambda.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            false
          </td>
        </tr>
      </tbody>
    </table>

    Por padrão, as anotações [@TraceLambda](/docs/apm/agents/java-agent/api-guides/java-agent-api-instrument-using-annotation/#tracelambda) estão desabilitadas. Para usar a funcionalidade de anotação para rastrear métodos lambda, você deve ativar explicitamente o recurso da seguinte maneira:

    Você pode configurar isso via YAML:

    ```yml
    instrumentation:
      trace_lambda:
        enabled: true
    ```

    Você também pode usar a propriedade do sistema `newrelic.config.instrumentation.trace_lambda.enabled=true` ou a variável de ambiente `NEW_RELIC_INSTRUMENTATION_TRACE_LAMBDA_ENABLED`.
  </Collapser>
</CollapserGroup>

## Coletor de jar

O agente Java coleta informações sobre jars e suas versões no classpath do aplicativo.

Defina a configuração da coleção jar na seção `jar_collector` . Essas opções de configuração podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.jar_collector` . As opções incluem:

<CollapserGroup>
  <Collapser
    id="cfg-jar-collector-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Usado para ativar/desativar a coleta e relatórios de jar.
  </Collapser>

  <Collapser
    id="cfg-jar-collector-skip-temp-jars"
    title="skip_temp_jars"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Usado para ativar/desativar a coleta de jars temporários. Jars temporários são aqueles que residem no diretório especificado pela propriedade do sistema `java.io.tmpdir`.
  </Collapser>

  <Collapser
    id="cfg-jar-collector-jars-per-second"
    title="jars_per_second"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10`
          </td>
        </tr>
      </tbody>
    </table>

    O número máximo de jars a serem processados por segundo. Deve ser positivo.
  </Collapser>
</CollapserGroup>

## JFR (perfil em tempo real)

O agente Java usa Java Flight Recorder (JFR) para coletar dados JVM de alta fidelidade para [criação de perfil em tempo real](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/).

Configure a criação de perfil em tempo real na seção `jfr` no YAML do agente com [propriedades do sistema](#System_Properties) prefixadas por `newrelic.config.jfr.` ou com [variáveis de ambiente](#Environment_Variables) prefixadas por `NEW_RELIC_JFR_`.

<CollapserGroup>
  <Collapser
    id="jfr-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para ativar [a criação de perfil em tempo real com JFR](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/). Essa configuração será aplicada dinamicamente e não requer reinicialização da JVM.

    <Callout variant="important">
      A criação de perfil em tempo real com JFR está ativada por padrão no agente Java [versão 7.1.0](/docs/release-notes/agent-release-notes/java-release-notes). Se você estiver em qualquer outro agente versão 7.0.0 ou superior, poderá ativar o JFR alterando o valor para `true`.
    </Callout>
  </Collapser>

  <Collapser
    id="jfr-audit_logging"
    title="audit_logging"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para ativar o registro de auditoria que exibirá todas as métricas e eventos JFR em cada lote de colheita. O registro de auditoria é extremamente detalhado e só deve ser usado para fins de resolução de problemas.

    <Callout variant="important">
      Isso se aplica ao agente Java [versão 7.0.0 ou superior](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>
  </Collapser>
</CollapserGroup>

## JMX

Para definir essas opções, use a seção `jmx` . Para [substituí-](#System_Properties) los, use uma propriedade de sistema com prefixo `newrelic.config.jmx` .

O agente Java usa JMX para coletar dados JVM. Além disso, o agente pode expor metadados de vinculação por meio de JMX que podem ser usados por outros sistemas de rastreamento.

<CollapserGroup>
  <Collapser
    id="jmx-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todas as funcionalidades JMX.
  </Collapser>

  <Collapser
    id="jmx-linkingMetadataMBean"
    title="linkingMetadataMBean"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Essa configuração pode ser ativada para permitir que o agente Java exponha metadados de vinculação por meio de JMX remoto.

    <Callout variant="important">
      Isso se aplica ao agente Java [versão 6.1.0 ou superior](/docs/release-notes/agent-release-notes/java-release-notes).
    </Callout>
  </Collapser>
</CollapserGroup>

## Kafka fila de mensagens [#kafka-message-queues]

Informações detalhadas sobre a configuração da instrumentação Kafka podem ser encontradas na página [do instrumento Kafka fila de mensagens](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/) .

* \[Coleção de eventos Kafka(/docs/agente APM/java-instrumentação de agente/agente Java-instrumento-kafka-fila de mensagens/#collect-kafka-evento)
* [Métrica do nó Kafka](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/#kafka-node-metrics)
* [Evento de configuração do Kafka](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/#kafka-config)
* [Kafka transmite transação](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/#collect-kafka-streams-transactions)
* [Kafka conectar transação](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/#collect-kafka-connect-transactions)
* [Rastreamento distribuído Kafka](/docs/apm/agents/java-agent/instrumentation/java-agent-instrument-kafka-message-queues/#collect-kafka-distributed-traces)

## Logs contextualizados [#logs-in-context]

A partir da versão do agente Java `7.6.0`, o suporte para [logs contextualizados](/docs/logs/logs-context/java-configure-logs-context-all) foi adicionado ao agente, facilitando o uso da estrutura de log suportada. Para obter dicas sobre como usar o agente Java para logs contextualizados, consulte [logs contextualizados do Java](/docs/logs/logs-context/java-configure-logs-context-all).

A alteração dessas configurações no arquivo de configuração do agente local ocorre de forma dinâmica e não requer a reinicialização do agente para que essas alterações entrem em vigor. Um exemplo de configuração:

```yml
application_logging:
  enabled: true
  forwarding:
    enabled: true
    max_samples_stored: 10000
    context_data:
      enabled: false
      include:
      exclude:
  metrics:
    enabled: true
  local_decorating:
      enabled: false
```

Defina a configuração logs contextualizados na seção `application_logging` . Isso pode ser [substituído](/docs/apm/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.application_logging` . A única opção disponível é:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para ativar o recurso principal de logs contextualizados. Quando habilitado, a instrumentação adicional framework de log é habilitada, independentemente de os logs serem decorados ou enviados para o New Relic ou não.

    <Callout variant="important">
      As versões 7.7.0 e superiores do agente têm esse recurso ativado no arquivo de configuração do agente por padrão.
    </Callout>

    Defina como `false` para desativar completamente esse recurso, incluindo a coleta de métricas log .
  </Collapser>
</CollapserGroup>

### Encaminhamento de logs [#log-forwarding]

Se você estiver usando uma framework de registro compatível e quiser usar o agente para enviar o registro do aplicativo para o New Relic, poderá controlar isso por meio das configurações na seção `forwarding`. Essas configurações podem ser substituídas pela propriedade de sistema prefixada `newrelic.config.application_logging.forwarding` . As opções disponíveis são:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_forwarding-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilita o envio de log do aplicativo para New Relic.

    <Callout variant="important">
      As versões 7.7.0 e superiores do agente têm esse recurso ativado no arquivo de configuração do agente por padrão.

      Usar o recurso de encaminhamento de logs aumentará a ingestão de dados, o que pode afetar seu faturamento. Para obter mais informações, consulte nossa documentação sobre como [rastrear a ingestão de dados](/docs/apm/new-relic-apm/getting-started/get-started-logs-context#ingest).

      Se você tiver uma solução de encaminhamento de logs existente e estiver atualizando seu agente para usar o logs contextualizados automáticos, certifique-se de <DNT>**disable your old log forwarder**</DNT>. Caso contrário, seu aplicativo enviará linhas de log duplas. Dependendo da sua conta, isso pode resultar em cobrança dupla. Para obter mais informações, siga os procedimentos para desabilitar seu [direcionador de logs específico](/docs/logs/forward-logs/enable-log-management-new-relic#log-forwarding).
    </Callout>

    Defina como `true` para que seu registro decorado seja enviado para a New Relic.

    Defina como `false` se não quiser que seu registro decorado seja enviado para a New Relic.
  </Collapser>

  <Collapser
    id="cfg-application_logging_forwarding-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Um número inteiro positivo que especifica o número máximo de linhas de log por minuto a serem enviadas.

    Defina como `0` para desativar efetivamente o envio de log.

    <Callout variant="important">
      Isso controla o número de logs enviados _por minuto_. Definir `max_samples_stored` como `0` - ou qualquer valor menor que `12` - _não_ desativa o recurso em si, embora resulte no envio de nenhuma linha log para o New Relic.
    </Callout>

    Defina um valor mais baixo para reduzir a quantidade de linhas de log enviadas (pode causar amostragem de log). Defina um valor mais alto para enviar mais linhas de log.

    Cada log recebe a mesma prioridade que sua transação associada. log que ocorrem fora de uma transação receberão uma prioridade aleatória. Alguns registros podem não ser incluídos porque são limitados por `max_samples_stored`. Por exemplo, se o registro em log `max_samples_stored` estiver definido como 10.000 e a transação 1 tiver 10.000 entradas de log, somente as entradas de log da transação 1 serão registradas. Se a transação 1 tiver menos de 10.000 logs, você receberá todos os logs da transação 1. Se ainda houver espaço, você receberá todo o log da transação 2 e assim por diante.

    Se após todos os logs de transação amostrados forem registrados, e eles não atingirem o limite em `max_samples_stored`, então será enviada a mensagem do log de transação amostrada que não estava em nossa amostragem. Se sobrar alguma, as mensagens do log fora da transação serão registradas.
  </Collapser>
</CollapserGroup>

#### Log dados de contexto [#log-context-data]

O agente Java pode capturar dados de contexto (Mapped Diagnostic Context em logback/slf4j, ThreadContext em log4j2) e adicionar seu conteúdo como atributo no log encaminhado para New Relic. Você pode controlar isso por meio das configurações na seção `context_data` , aninhada na seção `forwarding` . Essas configurações podem ser substituídas pela propriedade de sistema prefixada `newrelic.config.application_logging.forwarding.context_data` . As opções disponíveis são:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_forwarding_context_data-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defina isto como `true` envio de dados de contexto como atributo log para New Relic.

    Defina como `false` se não desejar que os dados de contexto no log sejam enviados para o New Relic.
  </Collapser>

  <Collapser
    id="cfg-application_logging_forwarding_context_data-include"
    title="incluir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se `context_data` estiver habilitado para encaminhamento de logs, todas as chaves de atributo encontradas nesta lista serão enviadas para New Relic nos registros de log. Se esta lista estiver vazia, todos os atributos serão enviados.
  </Collapser>

  <Collapser
    id="cfg-application_logging_forwarding_context_data-exclude"
    title="excluir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se `context_data` estiver habilitado para encaminhamento de logs, todas as chaves de atributo encontradas nesta lista NÃO serão enviadas para New Relic nos registros de log.

    A lista de inclusão e exclusão segue as regras `Exclude overrides include`, `More specific rules take priority`, `Keys are case-sensitive` e `Use an asterisk for wildcards` definidas nas [regras de atributo](/docs/apm/agents/java-agent/configuration/java-agent-configuration-config-file).
  </Collapser>
</CollapserGroup>

### Log métrico [#log-metrics]

Além de permitir decorar e enviar linhas de log individuais, o agente Java pode capturar dados métricos de log. Você pode encontrar esses dados no gráfico de log na interface do New Relic. Você pode definir as configurações log métrica na seção `metrics`. Você pode substituir essas configurações pela propriedade de sistema prefixada `newrelic.config.application_logging.metrics` . A única opção disponível é:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging_metrics-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Possibilita a captura de informações métricas sobre seu log e nível de log, que são exibidas em gráfico na página <DNT>**Summary**</DNT> do APM.

    Deixe definido como `true` para permitir que o agente capture informações métricas sobre seu log.

    Defina como `false` para desativar esse recurso.

    <Callout variant="important">
      Se você desabilitar a coleta de log métrica, o gráfico de log na página de resumo aparecerá em branco.
    </Callout>
  </Collapser>
</CollapserGroup>

### Decoração log [#log-decorating]

Você pode definir as configurações de decoração log na seção `local_decorating`. Você pode usar isso para controlar como as linhas de log locais são decoradas. Você pode substituir essas configurações por uma propriedade de sistema com prefixo `newrelic.config.application_logging.local_decorating` . A única opção disponível é:

<CollapserGroup>
  <Collapser
    id="cfg-application_logging-local_decorating"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Isto controla se as linhas de log armazenadas localmente são decoradas ou não. Isso independe de o encaminhamento de logs estar habilitado ou não e é usado para oferecer suporte a clientes que desejam usar uma solução separada de encaminhamento de logs.

    Defina como `true` para fazer com que o agente adicione logs contextualizados vinculando metadados a linhas log armazenadas localmente pela estrutura suportada.

    <Callout variant="important">
      Ativar a decoração de log local adicionará metadados de link aos arquivos de log do aplicativo, resultando em um aumento no armazenamento em disco. Desative esse recurso se isso for inaceitável.

      Não é necessário usar decoração de log local quando o encaminhamento de logs estiver habilitado. Fazer isso fará com que metadados de link sejam adicionados desnecessariamente à sua mensagem do log, o que pode distrair visualmente.
    </Callout>

    Defina como `false` para desativar o recurso de decoração local. Isso _não_ afetará a decoração das linhas log enviadas para a New Relic.
  </Collapser>
</CollapserGroup>

## Configuração de registro [#Logging-Configuration]

Estas fazem parte das variáveis de configuração gerais. Eles são divididos aqui porque são frequentemente ajustados para depuração.

Algumas das variáveis de configuração de criação de log são dinâmicas e não precisam de reinicialização do host para que entrem em vigor. Por exemplo, se o arquivo de log estiver crescendo muito rapidamente, [`log_level`](#cfg-log_level) poderá ser definido com uma configuração menos detalhada para reduzir a taxa de relatórios.

Aqui está a ordem de precedência e a explicação das variáveis de configuração que afetam a rotação log .

* Se `log_daily` for `true`:

  * Um valor `log_limit_in_kbytes` maior que zero resultará em uma política de acionamento composta, onde o registro será rolado uma vez por dia ou quando o tamanho definido for atingido, retendo até `log_file_count` arquivos
  * Um valor `log_limit_in_kbytes` igual a zero resultará na rolagem de log uma vez por dia, retendo até `log_file_count` arquivos

* Se `log_daily` for `false` e `log_limit_in_kbytes` > 0, será configurada uma política baseada em tamanho, onde o log será rolado quando o tamanho definido for atingido, retendo até `log_file_count` arquivos

* Se `log_daily` for `false` e `log_limit_in_kbytes` = 0, nenhuma lógica contínua do arquivo de log será configurada

Dependendo da taxa de crescimento, é possível que o tamanho do arquivo de log exceda um pouco o valor configurado.

<CollapserGroup>
  <Collapser
    id="cfg-log_file_count"
    title="log_daily"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para rolar o registro diariamente.
  </Collapser>

  <Collapser
    id="cfg-log_file_count"
    title="log_file_count"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `1`
          </td>
        </tr>
      </tbody>
    </table>

    O número máximo de arquivos de log a serem mantidos ao usar rotação de log.
  </Collapser>

  <Collapser
    id="cfg-log_file_name"
    title="log_file_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    O nome do arquivo de log não qualificado ou a string `STDOUT` que fará log na saída padrão.
  </Collapser>

  <Collapser
    id="cfg-log_file_path"
    title="log_file_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `logs` subdiretório onde `newrelic.jar` está localizado
          </td>
        </tr>
      </tbody>
    </table>

    O caminho do arquivo de log.

    <Callout variant="tip">
      Se `log_file_path` for especificado, o diretório já deverá existir. Se o valor padrão for utilizado, o agente tentará criar o diretório.
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-log_level"
    title="log_level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `info`
          </td>
        </tr>
      </tbody>
    </table>

    O nível de detalhamento do log. Quando você altera essa configuração no arquivo de configuração yaml do agente, ela será atualizada dinamicamente. No entanto, a variável de ambiente e a propriedade do sistema não serão atualizadas dinamicamente.

    O agente usa seu próprio arquivo de log para manter seu registro separado do seu aplicativo. As opções válidas, em ordem de detalhamento, são:

    * `off`

    * `severe`

    * `warning`

    * `info`

    * `fine`

    * `finer`

    * `finest`

      <Callout variant="caution">
        Não use o registro `debug` ou `trace` , a menos que o suporte da New Relic solicite que você os use. Esses níveis de registro em log podem gerar sobrecarga excessiva. Na maioria das situações, use `info`.
      </Callout>

      Essa configuração é dinâmica, portanto, a execução do agente notará alterações em `newrelic.yml` sem reiniciar a JVM.
  </Collapser>

  <Collapser
    id="cfg-log_limit_in_kbytes"
    title="log_limit_in_kbytes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    O tamanho do arquivo de log em quilobytes no qual os arquivos de log são rotacionados. Defina como `0` sem limite.
  </Collapser>
</CollapserGroup>

## Tracer de mensagens [#Transaction_Tracer]

Defina as opções tracer de mensagens na seção `message_tracer`. Você pode [substituir](#System_Properties) essas configurações por uma propriedade de sistema com prefixo `newrelic.config.message_tracer` .

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="segment_parameters.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Adiciona propriedades de mensagem ao atributo tracer . Defina como `false` para desligá-lo.
  </Collapser>
</CollapserGroup>

## Abrir telemetria SDK Auto-configuração [#otel-sdk-autoconfiguration]

Configuração para a instrumentação de configuração automática do SDK de telemetria aberta na seção:

```yml
  opentelemetry:
    sdk:
      autoconfigure:
```

<CollapserGroup>
  <Collapser
    id="cfg-otel-sdk-autoconfiguration-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Permite que o recurso de autoconfiguração OpenTelemetry SDK do agente seja habilitado. Pode ser definido através da propriedade do sistema:

    ```ini
    -Dnewrelic.config.opentelemetry.sdk.autoconfigure.enabled=true
    ```

    O padrão é verdadeiro.
  </Collapser>
</CollapserGroup>

## Agente de segurança [#sec-agent]

[O teste de segurança de aplicativo interativo (IAST) do agente New Relic Security](/docs/iast/introduction/) testa seu aplicativo em busca de quaisquer vulnerabilidades exploráveis, reproduzindo a solicitação HTTP gerada com carga vulnerável.

<Callout variant="important">
  Execute o IAST apenas com implantação não produtiva para evitar a exposição de vulnerabilidades em seu software de produção.
</Callout>

Você pode definir a configuração do agente New Relic Security na seção `security` . Essas configurações podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.security` . As opções incluem:

<CollapserGroup>
  <Collapser
    id="cfg-security-agent-enabled"
    title="agent.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Para desabilitar completamente todas as funcionalidades de segurança, defina este sinalizador como falso. Esta propriedade é lida apenas uma vez no início do aplicativo. O padrão é falso.
  </Collapser>

  <Collapser
    id="cfg-security-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se os dados de segurança são enviados para o New Relic ou não. Quando estiver desabilitado e agente.enabled for verdadeiro, o módulo de segurança será executado, mas os dados não serão enviados. O padrão é falso.
  </Collapser>

  <Collapser
    id="cfg-security-mode"
    title="modo"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `IAST`
          </td>
        </tr>
      </tbody>
    </table>

    Modo de fornecimento do New Relic Security: IAST. O padrão é IAST. Devido à natureza invasiva da varredura IAST, NÃO ative esse modo em um ambiente de produção ou em um ambiente onde os dados de produção são processados.
  </Collapser>

  <Collapser
    id="cfg-security-validator-service-url"
    title="validator_service_url"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `wss://csec.nr-data.net`
          </td>
        </tr>
      </tbody>
    </table>

    URL de conexão SaaS da New Relic Security. Este é o endpoint para o qual o agente de segurança envia dados; ele deve corresponder ao ambiente que você configurou para o agente Java do APM.

    Produção nos EUA: wss://csec.nr-data.net
  </Collapser>

  <Collapser
    id="cfg-security-detection-rci-enabled"
    title="detection.rci.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Ative a detecção de eventos de segurança RCI. O padrão é verdadeiro.
  </Collapser>

  <Collapser
    id="cfg-security-detection-rxss-enabled"
    title="detection.rxss.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite a detecção de eventos de segurança RXSS. O padrão é verdadeiro.
  </Collapser>

  <Collapser
    id="cfg-security-detection-deserialization-enabled"
    title="detection.deserialization.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite a detecção de eventos de segurança de desserialização. O padrão é verdadeiro.
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  O modo de teste de segurança de aplicativo interativo (IAST) do agente de segurança New Relic requer [o agente Java versão 8.4.0 ou superior](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

## Detecção de transação lenta

O agente agora pode detectar transações lentas via evento `SlowTransaction` desde a versão do Agente Java `8.7.0`. Esses eventos são registrados quando a duração da transação excede um determinado limite. Por padrão, o limite é 600.000 milissegundos (10 minutos).

A detecção de transação lenta é definida em `slow_transactions` e pode ser [substituída](#System_Properties) usando uma propriedade de sistema com prefixo `newrelic.config.slow_transactions` . As opções incluem:

<CollapserGroup>
  <Collapser
    id="cfg-slow-transactions-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Usado para ativar/desativar a detecção de transações lentas.
  </Collapser>

  <Collapser
    id="cfg-slow-transactions-threshold"
    title="limite"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `600000`
          </td>
        </tr>
      </tbody>
    </table>

    Determina quanto tempo uma transação deve levar em milissegundos para que um evento `SlowTransaction` seja relatado.
  </Collapser>

  <Collapser
    id="cfg-evaluate_completed_transaction"
    title="evaluate_completed_transaction"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Se for definido como verdadeiro, toda transação será verificada por exceder o limite de transação definido na conclusão. Observe que se um grande número de transações exceder o limite, isso pode ser computacionalmente caro, pois um stack trace é enviado a cada evento SlowTransaction.
  </Collapser>
</CollapserGroup>

## Evento de extensão

[Os eventos Span](/docs/apm/distributed-tracing/ui-data/span-event) são relatados para [distributed tracing](#distributed-tracing). Você deve ativar distributed tracing para relatar o evento span.

Defina a configuração do evento span na seção `span_events` . Essas configurações podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.span_events` . As opções incluem:

<CollapserGroup>
  <Collapser
    id="cfg-span-events-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Usado para ativar/desativar relatórios de eventos de extensão.
  </Collapser>

  <Collapser
    id="cfg-span-events-max-samples-stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `2000`
          </td>
        </tr>

        <tr>
          <th>
            Máx.
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    * Determina o número de eventos de span que podem ser capturados durante um ciclo de coleta de agente. Disponível no agente Java 7.4.0 e superior.
    * Ao configurar o agente para [AI Monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), defina o valor máximo `10000`. Garante que a quantidade máxima de rastreamento seja capturada.

      <Callout variant="important">
        Aumentar o número de eventos de span pode levar a sobrecarga adicional do agente.
      </Callout>
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos do evento span. Se `attributes.enabled` no nível raiz for `false`, nenhum atributo será enviado para span evento, independentemente de como esta propriedade (`span_events.attributes.enabled`) estiver definida.
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado para span evento, todas as chaves de atributo encontradas nesta lista serão enviadas para New Relic em `span_events`. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas para New Relic no evento span. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  A filtragem de atributo de evento Span requer [o agente Java versão 4.10.0 ou superior](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

## Tirar exceções [#strip_exceptions]

Defina as opções de exceções de faixa na seção `strip_exception_messages` . Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.strip_exception_messages` . Habilite esta configuração para controlar se as mensagens de exceção Java serão relatadas ao New Relic.

<CollapserGroup>
  <Collapser
    id="strip_exception_messages"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Por padrão, isso é definido como `false`, o que significa que o agente envia mensagens de todas as exceções para o [coletor New Relic](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector).

    * Se você definir isso como `true`, o agente retirará as mensagens das exceções para evitar que ele capture inadvertidamente informações confidenciais.
    * Se você ativar [o modo de alta segurança](/docs/agents/manage-apm-agents/configuration/high-security-mode), ele será automaticamente definido como `true`.
    * Se você definir `enabled` como `true` , mas quiser que o agente capture mensagens de exceções específicas, adicione as exceções à sua [lista de permissões](#strip_exception_messages_whitelist).
  </Collapser>

  <Collapser
    id="strip_exception_messages_whitelist"
    title="whitelist (DESCONTINUADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Esta configuração foi descontinuada a partir da versão 5.10.0 do agente e será removida em uma versão futura do agente. Em vez disso, use `allowed_classes`.
    </Callout>

    Se você definir `enabled` como `true` , mas quiser que o agente capture mensagens para exceções específicas, adicione cada exceção a `whitelist`, separadas por vírgula.
  </Collapser>

  <Collapser
    id="strip_exception_messages_allowed_classes"
    title="allowed_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se você definir `enabled` como `true` , mas quiser que o agente capture mensagens para exceções específicas, adicione cada exceção a `allowed_classes`, separadas por vírgula.
  </Collapser>
</CollapserGroup>

## Profiler de thread [#Thread_Profiler]

Defina as opções profiler de thread na seção `thread_profiler`. Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.thread_profiler` .

O Thread profiler mede o tempo transcorrido, o tempo de CPU e a contagem de chamadas de método nos threads do seu aplicativo à medida que eles são executados.

<CollapserGroup>
  <Collapser
    id="tp-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite o profiler de thread.
  </Collapser>
</CollapserGroup>

## Evento de transação [#Transaction_Events]

Defina as opções de evento de transação na seção `transaction_events` . Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.transaction_events` .

Os dados do evento de transação são usados para exibir histograma e percentual na interface.

<Callout variant="important">
  Anteriormente, esta seção era chamada `analytics_events`. Se o seu arquivo de configuração ainda usa `analytics_events`, atualize seu agente para usar `transaction_events`.
</Callout>

<CollapserGroup>
  <Collapser
    id="ae-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite o serviço de evento de transação.
  </Collapser>

  <Collapser
    id="ae-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `2000`
          </td>
        </tr>

        <tr>
          <th>
            Máx.
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    O número máximo de eventos de transação amostrados relatados a cada 60 segundos.
  </Collapser>

  <Collapser
    id="tt-custom-request-headers"
    title="custom_request_headers"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de mapas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Ao contrário de outras configurações, `custom_request_headers` precisam ser emparelhados e definidos no arquivo `newrelic.yml` . Eles não podem ser substituídos por argumentos da máquina virtual Java (propriedade do sistema) ou variáveis de ambiente.
    </Callout>

    Uma lista de mapas com as chaves emparelhadas `header_name` e o opcional `header_alias`. Escolha um ou mais cabeçalhos de solicitação HTTP personalizados para adicionar como atributo de transação.

    Você pode listar a configuração de vários cabeçalhos:

    ```yml
    transaction_events:
      custom_request_headers:
        -
          header_name: "X-Custom-Header-1"
        -
          header_name: "X-Custom-Header-2"
          header_alias: "CustomHeader2alias"
    ```

    No primeiro conjunto de mapas, `X-Custom-Header-1` é capturado e relatado pelo agente como o nome do cabeçalho para um valor correspondente do objeto de solicitação. O `header_name` também será o nome do atributo enviado para New Relic.

    No segundo conjunto de mapas, o cabeçalho da solicitação é `X-Custom-Header-2`, mas `CustomHeader2alias` é o nome enviado para New Relic.
  </Collapser>

  <Collapser
    id="cfg-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos do evento de transação. Se `attributes.enabled` for `false` no nível raiz, nenhum atributo será enviado para o evento de transação, independentemente de como essa propriedade estiver configurada em `transaction_events`.
  </Collapser>

  <Collapser
    id="cfg-te-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se o atributo estiver habilitado para evento de transação, todas as chaves de atributo encontradas nesta lista serão enviadas para a New Relic no evento de transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-te-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas para a New Relic em evento de transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Segmentos de transação

Defina as opções de segmentos de transação na seção `transaction_segments` . Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.transaction_segments` .

Os segmentos de transação representam partes discretas de trabalho (geralmente chamadas de método) e são exibidos no [trace da transação](/docs/traces/transaction-traces).

<Callout variant="important">
  A filtragem de atributo do segmento de transação requer [o agente Java versão 4.10.0 ou superior](/docs/agents/java-agent/installation/upgrade-java-agent).
</Callout>

<CollapserGroup>
  <Collapser
    id="cfg-ts-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos para segmentos de transação. Se `attributes.enabled` no nível raiz for `false`, nenhum atributo será enviado para segmentos de transação, independentemente de como esta propriedade (`transaction_segments.attributes.enabled`) estiver configurada.
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado para segmentos de transação, todas as chaves de atributo encontradas nesta lista serão enviadas para a New Relic em segmentos de transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas para a New Relic em segmentos de transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

## Tracer de transação

Defina as opções tracer de transação na seção `transaction_tracer`. Essas opções podem ser [substituídas](#System_Properties) por uma propriedade de sistema com prefixo `newrelic.config.transaction_tracer` .

[O rastreamento de transação](/docs/traces/transaction-traces) captura informações profundas sobre transações lentas e as envia para o serviço New Relic. A transação inclui a sequência exata de chamadas das transações, incluindo quaisquer declarações de consulta emitidas.

<Callout variant="important">
  Não use colchetes `[suffix]` no final do nome da sua transação. O New Relic remove automaticamente os colchetes do nome. Em vez disso, use parênteses `(suffix)` ou outros símbolos, se necessário.
</Callout>

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="habilitado"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    O tracer de transação está habilitado por padrão. Defina como `false` para desligá-lo.
  </Collapser>

  <Collapser
    id="tt-explain_enabled"
    title="explain_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Determina se o agente irá capturar o plano `EXPLAIN` para consulta lenta. [Compatível apenas com MySQL e PostgreSQL.](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)
  </Collapser>

  <Collapser
    id="tt-explain_threshold"
    title="explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Float
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    Limite em segundos para o tempo de execução da consulta abaixo do qual a consulta lenta e o plano `EXPLAIN` ([se compatível](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)) não serão capturados. Relevante para consulta lenta somente quando `record_sql` está definido como `raw` ou `obfuscated`. Relevante para planos `EXPLAIN` somente quando `explain_enabled` está definido como `true`.
  </Collapser>

  <Collapser
    id="insert_sql_max_length"
    title="insert_sql_max_length"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `2000`
          </td>
        </tr>
      </tbody>
    </table>

    O limite de caracteres para a cadeia de consulta SQL. Se você tiver muitas consultas SQL lentas com grandes quantidades de informações, isso poderá afetar negativamente o desempenho ou a rapidez com que você vê seus dados no New Relic. Aumente o valor gradualmente até encontrar o equilíbrio certo entre informação e desempenho.
  </Collapser>

  <Collapser
    id="tt-log_sql"
    title="log_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para ativar o registro de consulta ao arquivo de log do agente em vez de fazer upload para o New Relic. consulta são logados usando o modo `record_sql` .
  </Collapser>

  <Collapser
    id="tt-record_sql"
    title="record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>
      </tbody>
    </table>

    Quando o tracer de transação está ativado, as instruções de consulta podem ser gravadas opcionalmente. O gravador possui três modos:

    * `off`: Não envie nenhuma consulta.
    * `raw`: Envie a instrução de consulta em seu formato original.
    * `obfuscated`: remove literais numéricos e de string.
  </Collapser>

  <Collapser
    id="tt-stack_based_naming"
    title="stack_based_naming (somente Play 2.x+)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`

            O padrão é `true` até o agente Java versão 3.12.1, quando foi alterado para `false`.
          </td>
        </tr>
      </tbody>
    </table>

    Esta opção é apenas para Play 2.x+. A instrumentação Play/Scala pode usar `Thread.getStackTrace()` para melhorar a nomenclatura tracer , mas ao custo de maior sobrecarga.
  </Collapser>

  <Collapser
    id="tt-stack_trace_threshold"
    title="stack_trace_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    Define um limite (em segundos) para coletar rastreamento de pilha de uma chamada SQL. Quando as instruções SQL excederem esse limite, o agente capturará o stack trace atual. Isso é útil para identificar a origem das longas chamadas SQL.
  </Collapser>

  <Collapser
    id="tt-top_n"
    title="top_n"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    Use esta configuração para controlar a variedade do seu rastreamento de transação. `top_n` é um número inteiro que representa o número de transações lentas e exclusivas para as quais o rastreamento será criado.

    * Se você quiser que o rastreamento da transação reflita com mais precisão as transações reais mais lentas no seu aplicativo, defina esse valor <DNT>**lower**</DNT>.

    * Se você deseja amostrar um conjunto mais diversificado de transações, defina o valor <DNT>**higher**</DNT>.

      Um valor `0` significaria que <DNT>**only**</DNT> a transação mais lenta é sempre rastreada. No entanto, isso não é considerado o ideal, porque você pode ter uma ou duas transações que são sempre as mais lentas e ver repetidamente o mesmo rastreamento da transação provavelmente não lhe dará muito valor.

      Se a mesma transação for frequentemente a mais lenta, a configuração `top_n` permitirá que o agente Java (ao longo do tempo) obtenha amostras das transações `n` mais lentas. Isso oferece maior variedade e mais insights sobre seu aplicativo.
  </Collapser>

  <Collapser
    id="tt-transaction_threshold"
    title="transaction_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            String (float)
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>
      </tbody>
    </table>

    O limite de tempo usado para determinar quando uma transação está qualificada para ser rastreada. Quando o tempo de resposta da transação ultrapassar esse limite, um [trace da transação](/docs/apm/transactions/transaction-traces/transaction-traces) será registrado e enviado à New Relic.

    O padrão é `apdex_f` (padrão), que define o limite como o nível de [Apdex](/docs/site/apdex-measuring-user-satisfaction) ["Frustrated"](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_f) (quatro vezes o `apdex_t` valor ). Você também pode definir um limite de tempo específico inserindo um valor float que representa um número de segundos.
  </Collapser>

  <Collapser
    id="tt-slow_query_whitelist"
    title="slow_query_whitelist (DESCONTINUADO)"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Esta configuração foi descontinuada a partir da versão 5.10.0 do agente e será removida em uma versão futura do agente. Em vez disso, use `collect_slow_queries_from`.
    </Callout>

    Por padrão, [o modo de alta segurança](/docs/accounts-partnerships/accounts/security/high-security) não permite que o agente colete [consulta lenta](/docs/apm/applications-menu/monitoring/viewing-slow-query-details). Habilite esta opção para coletar consultas Cassandra do driver DataStax, mesmo com alta segurança habilitada. Caso não utilize alta segurança, o agente coleta a consulta lenta automaticamente.

    Para o driver DataStax 2.1.2, adicione esta regra à sua lista de permissões:

    ```yml
    transaction_tracer:
      slow_query_whitelist:
        'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    Para o driver DataStax 3.0.0, adicione esta regra à sua lista de permissões:

    ```yml
    transaction_tracer:
      slow_query_whitelist:
        'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="tt-collect_slow_queries_from"
    title="collect_slow_queries_from"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Por padrão, [o modo de alta segurança](/docs/accounts-partnerships/accounts/security/high-security) não permite que o agente colete [consulta lenta](/docs/apm/applications-menu/monitoring/viewing-slow-query-details). Habilite esta opção para coletar consultas Cassandra do driver DataStax, mesmo com alta segurança habilitada. Caso não utilize alta segurança, o agente coleta a consulta lenta automaticamente.

    Para o driver DataStax 2.1.2, adicione esta regra à sua lista de permissões:

    ```yml
    transaction_tracer:
      collect_slow_queries_from:
        'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    Para o driver DataStax 3.0.0, adicione esta regra à sua lista de permissões:

    ```yml
    transaction_tracer:
      collect_slow_queries_from:
        'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar todos os atributos de rastreamento da transação. Se `attributes.enabled` no nível raiz for `false`, nenhum atributo será enviado para o rastreamento da transação, independentemente de como esta propriedade (`transaction_tracer.attributes.enabled`) estiver definida.
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de strings
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Se os atributo estiverem habilitados para rastreamento da transação, todas as chaves de atributo encontradas nesta lista serão enviadas para a New Relic no rastreamento da transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Lista de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas à New Relic no rastreamento da transação. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser
    id="cfg-tt-token_limit"
    title="token_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    Limita o número de tokens que podem ser criados por transação. Aumentar esse valor pode afetar o desempenho, pois aumenta a quantidade de memória que o agente usa e a quantidade de dados enviados para o New Relic.
  </Collapser>

  <Collapser
    id="cfg-tt-segment_limit"
    title="segment_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    Limita o número de segmentos que podem ser criados por transação. Aumentar esse valor pode afetar o desempenho, pois aumenta a quantidade de memória que o agente usa e a quantidade de dados enviados para o New Relic.
  </Collapser>
</CollapserGroup>
