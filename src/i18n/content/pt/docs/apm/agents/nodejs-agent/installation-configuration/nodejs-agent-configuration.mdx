---
title: Configuração do agente Node.js
tags:
  - Agents
  - Nodejs agent
  - Installation and configuration
metaDescription: 'For New Relic''s Node.js agent: how to set configuration using your config file, environment variables, or server-side config.'
freshnessValidatedDate: never
translationType: machine
---

Você pode adaptar o agente Node.js aos requisitos do seu aplicativo editando o arquivo de configuração `newrelic.js` ou definindo uma variável de ambiente. O arquivo de configuração reside no diretório raiz do seu aplicativo. Você também pode configurar algumas opções do New Relic ou usar a [API do agente Node.js.](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api)

## Iniciar [#requirements]

Você poderá configurar nosso agente Node.js para se adequar ao seu ambiente depois de [criar uma conta New Relic](https://newrelic.com/signup) (é grátis, para sempre) e [instalar o agente Node.js.](/docs/apm/agents/nodejs-agent/installation-configuration/install-nodejs-agent/)

A configuração [`license_key`](#license) é obrigatória. Além disso, é altamente recomendável definir [`app_name`](#app_name) para que seu aplicativo tenha um [nome significativo](/docs/apm/new-relic-apm/installation-configuration/name-your-application) em vez do `My Application` padrão.

## Métodos de configuração e precedência [#methods-and-precedence]

O método principal para configurar o agente Node.js é o arquivo de configuração do agente (`newrelic.js`). Você também pode definir a maioria das configurações com [variáveis de ambiente](#environment). Você também pode ajustar algumas configurações com [Configuração no lado do servidor](#server-side).

O agente Node.js usa esta ordem de precedência para métodos de configuração:

<img title="Node.js agent configuration precedence" alt="Node.js agent configuration precedence" src="/images/apm_diagram_nodejs-agent-configuration-hierarchy.webp" />

<figcaption>
  <DNT>**Node.js configuration hierarchy:**</DNT> Configuração no lado do servidor as configurações substituem as variáveis de ambiente. As variáveis de ambiente substituem o arquivo de configuração do agente. O arquivo de configuração substitui os padrões do agente.
</figcaption>

Aqui estão descrições detalhadas de cada método de configuração:

<CollapserGroup>
  <Collapser className="freq-link" id="config_file" title="Arquivo de configuração do agente">
    O arquivo de configuração (`newrelic.js`) contém todas as configurações do agente Node.js. Ao [instalar o agente Node.js](/docs/agents/nodejs-agent/installation-configuration/installing-maintaining-nodejs#installing), você deve copiar `newrelic.js` no diretório raiz do seu aplicativo. A maioria das configurações está vazia por padrão; eles herdam seus valores de `config/default.js`.

    Se seu aplicativo estiver rodando em CommonJS, basta alterar o tipo do arquivo de configuração para (`newrelic.cjs`). Este tipo de arquivo é suportado a partir da [versão 7.5.0](/docs/release-notes/agent-release-notes/nodejs-release-notes/node-agent-7-5-0/) do agente Node.js.
  </Collapser>

  <Collapser className="freq-link" id="environment" title="Variáveis ambientais">
    Todas as definições de configuração em `newrelic.js` possuem variáveis de ambiente equivalentes. Eles são úteis, por exemplo, se o seu agente for executado em um ambiente PaaS como Heroku ou Microsoft Azure. As variáveis de ambiente do agente Node.js sempre começam com `NEW_RELIC_`.

    Essas variáveis de ambiente estão documentadas abaixo em opções de configuração individuais como <DNT>**Environ variable**</DNT>. Existem também duas configurações raramente usadas que [só podem ser definidas por meio de variáveis de ambiente](#environment-variable-overrides). Se você não tiver certeza de como especificar tipos mais complexos como variáveis de ambiente, [use o guia de referência](#environment-variable-type-reference-guide).

    Se você estiver usando New Relic CodeStream para monitor o desempenho do seu IDE, talvez você também queira [associar o repositório aos seus serviços](/docs/codestream/observability/repo-association) e [associar SHAs de compilação ou tag de lançamento aos erros](/docs/codestream/observability/error-investigation/#buildsha).
  </Collapser>

  <Collapser className="freq-link" id="server-side" title="Configuração no lado do servidor">
    Proprietários e administradores podem visualizar e definir algumas configurações [diretamente no New Relic](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration). Quando disponíveis, os rótulos de interface para configuração do lado do servidor estão listados neste documento em opções de configuração individuais como <DNT>**Server-side label**</DNT>.
  </Collapser>
</CollapserGroup>

## Exporta variáveis [#exports\_config][#exports_config]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `exports.config = {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="app_name" title="app_name (OBRIGATÓRIO)">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `"My Application"`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APP_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    O [nome que a New Relic usa para identificar seu aplicativo](/docs/apm/new-relic-apm/installation-configuration/name-your-application). Por exemplo, `app_name: ['MyNodeApp']`. Para [usar vários nomes para seu aplicativo](/docs/apm/new-relic-apm/installation-configuration/use-multiple-names-app), especifique uma lista de nomes delimitados por vírgulas.

    Os dados de todos os aplicativos com o mesmo nome serão mesclados na interface do New Relic, portanto, defina isso com cuidado. Solicitamos <DNT>**highly recommend**</DNT> que você substitua o nome padrão por um nome descritivo para evitar confusão e agregação não intencional de dados.

    <Callout variant="tip">
      Para [usuário do Azure](/docs/agents/nodejs-agent/hosting-services/nodejs-agent-microsoft-azure), o agente Node.js usará `APP_POOL_ID` se estiver definido, para que você possa usar o nome escolhido para o servidor Web do Azure sem configurá-lo duas vezes.
    </Callout>
  </Collapser>

  <Collapser id="license" title="license_key (OBRIGATÓRIA)">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_LICENSE_KEY`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração é obrigatória. Sua New Relic <InlinePopover type="licenseKey" />. Por exemplo, `license_key: '40HexadecimalCharacters'`.
  </Collapser>

  <Collapser id="agent-enabled" title="agent_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `false` para interromper a inicialização do agente. Isso é útil quando a depuração do seu código requer a desativação temporária do agente. Impede que o agente inicie sua instrumentação ou configure todas as suas peças, o que impede que o agente inicialize e se conecte aos servidores da New Relic.
  </Collapser>

  <Collapser id="allow_all_headers" title="allow_all_headers">
    Se `true`, permite a captura de todos os cabeçalhos HTTP, exceto aqueles filtrados pelas regras `exclude` . Se `false`, os cabeçalhos coletados serão limitados àqueles definidos no [atributo do agente Node.js.](/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-attributes)

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ALLOW_ALL_HEADERS`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
    </Callout>
  </Collapser>

  <Collapser id="compressed_content_encoding" title="compressed_content_encoding">
    Se o limite de compactação de dados for atingido na carga útil, o agente compactará os dados usando a compactação gzip por padrão. A opção de configuração `compressed_content_encoding` pode ser definida como `deflate` para usar compactação deflacionada.

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `gzip`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_COMPRESSED_CONTENT_ENCODING`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="apdex" title="apdex_t (DESCONTINUADO)">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Número
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `0.100`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Apdex T`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APDEX_T`
          </td>
        </tr>
      </tbody>
    </table>

    Configure seu Apdex T [através da interface do New Relic](/docs/apm/new-relic-apm/apdex/apdex-measure-user-satisfaction/#apm-apdex).
  </Collapser>

  <Collapser id="certificates" title="certificados">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz de cordas
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CERTIFICATES`
          </td>
        </tr>
      </tbody>
    </table>

    Certificados adicionais para confiar em conexões SSL, especificados como uma matriz de strings no formato PEM. Isso afeta as conexões com um proxy HTTPS e as conexões com o New Relic.

    <Callout variant="tip">
      Você também pode configurar o agente para ler seus certificados de um arquivo:

      ```js
      certificates: [ fs.readFileSync('myca.crt', {encoding: 'utf8'}) ]
      ```
    </Callout>
  </Collapser>

  <Collapser id="high_security" title="high_security">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_HIGH_SECURITY`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `true`, ativa [alta segurança v2](/docs/accounts-partnerships/accounts/security/high-security#version2description). Você também deve ativar a configuração [`ssl`](#ssl) e [ativar alta segurança na interface](/docs/accounts-partnerships/accounts/security/high-security#version2enabled).
  </Collapser>

  <Collapser id="host" title="hospedar">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `collector.newrelic.com`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Não edite esse valor, a menos que o suporte da New Relic solicite que você o altere.
    </Callout>

    Nome do host para o [coletor New Relic](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector) se conectar à Internet; por exemplo, `host: 'collector.newrelic.com'`.
  </Collapser>

  <Collapser id="labels" title="rótulos">
    Adiciona [etiqueta](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers). Especifique sua tag como objetos ou uma string delimitada por ponto e vírgula de pares separados por dois pontos (por exemplo, `Server:One;Data Center:Primary`).

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Objeto ou string
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_LABELS`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="port" title="port">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `443`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Não edite esse valor, a menos que o suporte da New Relic solicite que você o altere.
    </Callout>

    Número da porta para conexão ao coletor New Relic; por exemplo, `port: 443`.
  </Collapser>

  <Collapser id="proxy" title="procurador">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_URL`
          </td>
        </tr>
      </tbody>
    </table>

    Uma URL especificando o servidor proxy para conexão com a Internet. Por exemplo, `proxy: 'http://user:pass@10.0.0.1:8000/'`. Considerações importantes:

    * A configuração do arquivo de configuração `proxy` substitui as outras configurações de proxy do arquivo de configuração (`proxy_host`, `proxy_port`, `proxy_user`, `proxy_pass`), se usada. Da mesma forma, a variável de ambiente `NEW_RELIC_PROXY_URL` substitui as outras configurações de proxy da variável de ambiente (`NEW_RELIC_PROXY_HOST`, `NEW_RELIC_PROXY_PORT`, `NEW_RELIC_PROXY_USER` e `NEW_RELIC_PROXY_PASS`), se usada.
    * Se você estiver usando [o Infinite Tracing](/docs/distributed-tracing/infinite-tracing/introduction-infinite-tracing): [veja como configurar um proxy para o Infinite Tracing](/docs/distributed-tracing/infinite-tracing/infinite-tracing-configure-proxy-support/#node-php-python-ruby).
  </Collapser>

  <Collapser id="proxy_host" title="proxy_host">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Nome do host ou endereço IP do servidor proxy para conexão com a Internet.
  </Collapser>

  <Collapser id="proxy_pass" title="proxy_pass">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PASS`
          </td>
        </tr>
      </tbody>
    </table>

    Senha para autenticação no servidor proxy. O agente oferece suporte apenas à autenticação HTTP básica.
  </Collapser>

  <Collapser id="proxy_port" title="proxy_port">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    Número da porta do servidor proxy para conexão à Internet.
  </Collapser>

  <Collapser id="proxy_user" title="proxy_user">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_USER`
          </td>
        </tr>
      </tbody>
    </table>

    Nome de usuário para autenticação no servidor proxy. O agente oferece suporte apenas à autenticação HTTP básica.
  </Collapser>
</CollapserGroup>

## Variáveis de registro [#logging\_config][#logging_config]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `logging: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="log-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true` (`false` em `serverless_mode`)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Habilita ou desabilita o log específico do agente.
  </Collapser>

  <Collapser id="log_level" title="nível">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `info`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_LEVEL`
          </td>
        </tr>
      </tbody>
    </table>

    Define o nível de detalhe registrado no log do agente. Do menor ao maior detalhe, os valores possíveis são `fatal`, `error`, `warn`, `info`, `debug` ou `trace`.

    <Callout variant="caution">
      Não use o registro `debug` ou `trace` , a menos que o suporte da New Relic solicite que você os use. Esses níveis de registro em log podem gerar sobrecarga excessiva. Na maioria das situações, use `info`.
    </Callout>
  </Collapser>

  <Collapser id="log" title="caminho de arquivo">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `process.cwd()` mais `newrelic_agent.log`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG`
          </td>
        </tr>
      </tbody>
    </table>

    Caminho completo para o log do agente New Relic, incluindo o nome do arquivo. O padrão é `filepath: require('path').join(process.cwd(), 'newrelic_agent.log')`. Se o agente não puder criar o arquivo de log, então ele:

    * Registra o erro `New Relic failed to open log file` usando `console.error`.
    * Armazena em buffer todas as mensagens subsequentes do log na memória.
    * Quando o buffer de memória atinge seu limite de 128 MiB, o agente descarta qualquer nova mensagem do log e emite o seguinte aviso via `process.emitWarning`: `[NRWARN001] NewRelicWarning: Dropping log message, buffer would overflow.`

    Ao criar o arquivo de log, o agente define as permissões do arquivo como 0o600 (legível/gravável para o proprietário).

    * Para gravar todos os registros em <DNT>**stdout**</DNT>, defina como `stdout`.
    * Para gravar todos os registros em <DNT>**stderr**</DNT>, defina como `stderr`.

    <Callout variant="important">
      Em versões do agente anteriores à 7.0.0, o agente encerrava o processo se não conseguisse criar esse arquivo.
    </Callout>
  </Collapser>
</CollapserGroup>

## AI Monitoring [#ai-monitoring]

Esta seção inclui a configuração do agente Node.js para configurar AI Monitoring.

<Callout variant="important">
  Você deve habilitar [distributed tracing](/docs/apm/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration/#dt-main) para capturar dados de IA. Ele está ativado por padrão no agente Node.js 8.3.0 e superior. Se você ativou o modo de alta segurança, AI Monitoring não funcionará.
</Callout>

<Callout variant="important">
  Quando ativado, AI Monitoring registrará uma cópia de streaming das entradas e saídas enviadas de e para os modelos que você escolher monitorar, incluindo quaisquer informações pessoais contidas neles. Ao usar AI Monitoring, você é responsável por obter o consentimento do seu usuário modelo para que sua interação possa ser gravada por um terceiro (New Relic) com a finalidade de fornecer o recurso AI Monitoring .
</Callout>

<CollapserGroup>
  <Collapser id="ai-monitoring-enabled" title="ai_monitoring.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `true`, ativa o AI Monitoring. Permite que o agente capture dados de eventos LLM.
  </Collapser>

  <Collapser id="ai-monitoring-streaming" title="ai_monitoring.streaming.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_STREAMING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `false`, desativa a instrumentação para dados LLM transmitidos. Definido como `true`, captura dados transmitidos para evento LLM.
  </Collapser>

  <Collapser id="ai-monitoring-record-content" title="ai_monitoring.record_content.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_RECORD_CONTENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se definido como `false`, o agente omite o conteúdo de entrada e saída (como sequências de texto de prompt e respostas) capturado no evento LLM. Esta é uma configuração de segurança opcional se você não quiser registrar dados confidenciais enviados e recebidos de seus LLMs.
  </Collapser>
</CollapserGroup>

## Variáveis de nuvem [#cloud\_config][#cloud_config]

Esta seção define as variáveis do agente Node.js para criar um relacionamento entre provedores de nuvem e aplicativos APM .

<CollapserGroup>
  <Collapser id="cloud-variables" title="cloud.aws.account_id">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `null`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CLOUD_AWS_ACCOUNT_ID`
          </td>
        </tr>
      </tbody>
    </table>

    O ID da conta AWS AWS associada a este aplicativo.
  </Collapser>
</CollapserGroup>

## Registro de auditoria [#audit\_log][#audit_log]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `audit_log: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="audit_log-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente registra a carga que envia ao coletor. Esses dados são incluídos no arquivo de log principal mesmo quando o nível de log está definido para o nível mais baixo.
  </Collapser>

  <Collapser id="endpoints" title="ponto final">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]` (incluir todos os tipos)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENDPOINTS`
          </td>
        </tr>
      </tbody>
    </table>

    O agente envia vários tipos diferentes de dados ao coletor em cargas separadas. Por padrão, todos eles estão incluídos no arquivo de log. Esta opção permite limitar o registo apenas a tipos específicos de dados.

    Os valores válidos incluem:

    * `agent_settings`
    * `analytic_event_data`
    * `connect`
    * `custom_event_data`
    * `error_data`
    * `error_event_data`
    * `metric_data`
    * `preconnect`
    * `shutdown`
    * `span_event_data`
    * `sql_trace_data`
    * `transaction_sample_data`
  </Collapser>
</CollapserGroup>

## Configuração de API [#api\_config][#api_config]

Esta seção permite que você escolha quais métodos de API estão habilitados. Cada opção de configuração permite habilitar modularmente métodos de API responsáveis pelo envio de informações personalizadas para o New Relic.

<Callout variant="important">
  Todos eles são definidos como `false` quando o agente está no modo de alta segurança.
</Callout>

<CollapserGroup>
  <Collapser id="custom-attributes" title="custom_attributes_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_ATTRIBUTES`
          </td>
        </tr>
      </tbody>
    </table>

    Esta opção ativa [`newrelic.addCustomAttribute`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-param) e [`newrelic.addCustomAttributes`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-params).
  </Collapser>

  <Collapser id="custom-events" title="custom_events_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_EVENTS`
          </td>
        </tr>
      </tbody>
    </table>

    Esta opção ativa [`recordCustomEvent`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#record_custom_event).
  </Collapser>

  <Collapser id="notice-error" title="notice_error_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_API_NOTICE_ERROR`
          </td>
        </tr>
      </tbody>
    </table>

    Esta opção habilita [`newrelic.noticeError`](https://newrelic.github.io/node-newrelic/API.html#noticeError).
  </Collapser>
</CollapserGroup>

## Atributo [#node-js-attributes]

Esta seção define as variáveis para [o atributo do agente Node.js](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes) na ordem em que normalmente aparecem na seção `attributes: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<Callout variant="caution">
  Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
</Callout>

<CollapserGroup>
  <Collapser id="attributes_enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, habilita a captura de atributo para todos os destinos.
  </Collapser>

  <Collapser id="attributes_exclude" title="excluir">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo a ser excluído de todos os destinos. Permite `*` como curinga no final. Por exemplo, no arquivo de configuração, isso incluiria todos os parâmetros, exceto `somethingSecret`:

    ```js
    attributes: {
      include: [ 'request.parameters.*' ],
      exclude: [ 'request.parameters.somethingSecret' ]
    }
    ```
  </Collapser>

  <Collapser id="attributes_include" title="incluir">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo para incluir de todos os destinos. Permite `*` como curinga no final.

    Por exemplo, no arquivo `config` , isso incluiria todos os parâmetros:

    ```js
    attributes: {
      include: [ 'request.parameters.*' ]
    }
    ```

    Usando este exemplo de definição de rota expressa e URL de solicitação:

    ```js
    app.get('/api/users/:id', myMiddleware, myController)
    ```

    ```sh
    curl http://localhost:3000/api/users/abc123?id=true
    ```

    O *parâmetro de rota* é `id` e tem um valor de `abc123`. Isso se torna o atributo `request.parameters.route.id: abc123` na transação, segmento raiz e intervalo. Este exemplo também tem um *parâmetro de consulta* de `id`, que tem um valor de `true`. Isso se tornaria o atributo `request.parameters.id: true` na Transação, Segmento raiz e Span.
  </Collapser>

  <Collapser id="attributes_include_enabled" title="include_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando `true`, os padrões podem ser adicionados à lista [`attributes.include`](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes#cfg-attributes-include) .
  </Collapser>
</CollapserGroup>

## Variáveis do coletor de erros [#error\_config][#error_config]

Você pode [gerenciar como os erros são tratados](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected) no New Relic. Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `error_collector: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="error_collector" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Enable error collection?`
          </td>
        </tr>
      </tbody>
    </table>

    Quando ativado, o agente coleta [rastreamento de erros](/docs/apm/applications-menu/events/viewing-apm-errors-error-traces) do seu aplicativo.
  </Collapser>

  <Collapser id="error_ignore" title="ignore_status_codes">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz de inteiros
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[404]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Ignore these status codes`
          </td>
        </tr>
      </tbody>
    </table>

    Lista delimitada por vírgulas de códigos de status HTTP para o coletor de erros ignorar.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="error_ignore_classes" title="ignore_classes">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz|Objeto
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Lista delimitada por vírgulas de tipos/classes de erros javascript para o coletor de erros ignorar.

    A seguinte configuração

    ```js
    error_collector: {
        /* ... */
        ignore_classes: ["ReferenceError"]
    }
    ```

    Ignoraria todos os erros de referência.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="error_ignore_messages" title="ignore_messages">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Objeto
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    Um objeto JavaScript que descreve uma lista de classes vinculadas à mensagem de erro para o coletor ignorar. A configuração a seguir ignoraria todos os erros do tipo `Error` com as sequências de mensagens exatas (diferenciando maiúsculas de minúsculas) de `Undefined` e `Out of time`:

    ```js
    error_collector: {
        /* ... */
        ignore_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Ignoraria todos os erros do tipo `Error`, com as sequências de mensagens exatas (diferenciando maiúsculas de minúsculas) de `Undefined` e `Out of time`.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="expected_status_codes" title="expected_status_codes">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz de inteiros
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES`
          </td>
        </tr>
      </tbody>
    </table>

    Lista delimitada por vírgulas de códigos de status HTTP para o coletor de erros marcar como esperado.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="expected_classes" title="expected_classes">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    A seguinte configuração

    ```js
    error_collector: {
        /* ... */
        expected_classes: ["ReferenceError"]
    }
    ```

    Marcaria todos os erros de referência como esperado.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="expected_messages" title="expected_messages">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Objeto
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    Um objeto javascript que descreve uma lista de classes javascript vinculadas à mensagem de erro javascript para o coletor ignorar. A seguinte configuração.

    ```js
    error_collector: {
        /* ... */
        expected_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Marcaria todos os erros do tipo `Error`, com as sequências de mensagens exatas (diferenciando maiúsculas de minúsculas) de `Undefined` e `Out of time`.

    <Callout variant="caution">
      Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
    </Callout>
  </Collapser>

  <Collapser id="error_attributes_enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, o agente captura um atributo da coleta de erros.

    <Callout variant="caution">
      Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
    </Callout>
  </Collapser>

  <Collapser id="error_attributes_exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo para excluir da coleta de erros. Permite `*` como curinga no final.
  </Collapser>

  <Collapser id="error_attributes_include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo do atributo a ser incluído na coleta de erros. Permite `*` como curinga no final.
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="error_max_event_samples_stored" title="max_event_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `100`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de eventos que o agente coleta por minuto. Se houver mais que esse número, o agente coleta uma amostragem estatística.
  </Collapser>
</CollapserGroup>

## Variáveis tracer de transação [#tx\_tracer\_config][#tx_tracer_config]

O agente agrupa suas solicitações em [transação](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction), que servem para:

* Visualize onde seu aplicativo gasta seu tempo (em falhas de transação).
* Identifique solicitações lentas.
* Métrica de grupo.
* Isole outros problemas, como [desempenho lento do banco de dados](/docs/apm/applications-menu/monitoring/databases-slow-queries-dashboard).

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `transaction_tracer: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<Callout variant="important">
  Não use colchetes `[suffix]` no final do nome da sua transação. O New Relic remove automaticamente os colchetes do nome. Em vez disso, use parênteses `(suffix)` ou outros símbolos, se necessário.
</Callout>

<CollapserGroup>
  <Collapser id="tracer_enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Enable transaction tracing?`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente coleta [rastreamento lento da transação](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="explain_threshold" title="explain_threshold">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_EXPLAIN_THRESHOLD`
          </td>
        </tr>
      </tbody>
    </table>

    Duração mínima da consulta (em milissegundos) para que uma transação seja elegível para [consulta lenta](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) no [rastreamento da transação](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="record-sql" title="record_sql">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Sequência (`obfuscated`, `off` ou `raw`)
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_RECORD_SQL`
          </td>
        </tr>
      </tbody>
    </table>

    Esta opção afeta tanto [a consulta lenta](#slow-queries) quanto `record_sql` para rastreamento da transação. Pode ter estes valores: `off`, `obfuscated` ou `raw`.

    Quando definido como `off` , nenhuma consulta lenta será capturada e backtraces e SQL não serão incluídos no rastreamento da transação. Se definido como `raw` ou `obfuscated`, o agente envia SQL bruto ou ofuscado e uma amostra de consulta lenta para o [coletor](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). O agente também pode enviar SQL quando outros critérios forem atendidos, como quando `slow_sql.enabled` for definido.
  </Collapser>

  <Collapser id="tracer_top" title="top_n">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `20`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_TOP_N`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de solicitações elegíveis para [rastreamento da transação](/docs/apm/transactions/transaction-traces/transaction-traces).

    Transações são nomeadas com base na solicitação e `top_n` refere-se às &quot;transações principais e mais lentas&quot; agrupadas por esses nomes. O módulo substitui um trace gravado por um novo trace apenas se o novo trace for mais lento que o trace anterior mais lento com esse nome. O valor padrão para esta configuração é `top_n: 20`, porque a [página<DNT>**Transactions**</DNT> ](/docs/apm/transactions/transaction-traces/transaction-traces)também assume como padrão as 20 transações mais lentas.

    O agente Node.js captura pelo menos cinco transações lentas diferentes no primeiro ciclo de coleta após a inicialização. Ele também redefinirá e capturará diferentes transações se nenhuma transação lenta tiver sido capturada nos últimos cinco [ciclos de coleta](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle). Isso permite que você veja mais informações sobre mais caminhos de solicitação do seu aplicativo, ao possível custo de não focar na solicitação absolutamente mais lenta para aquele ciclo de coleta.

    <Callout variant="tip">
      Para registrar a transação mais lenta absoluta no último minuto, você pode definir `top_n: 0` ou `top_n: 1`. No entanto, isso faz com que uma rota muito lenta domine seu rastreamento de transação.
    </Callout>
  </Collapser>

  <Collapser id="tracer_threshold" title="transaction_threshold">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro ou `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_THRESHOLD`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Threshold`
          </td>
        </tr>
      </tbody>
    </table>

    Define o tempo, em segundos, para que um [trace da transação](/docs/apm/transactions/transaction-traces/transaction-traces) seja considerado lento. O valor padrão é `apdex_f`; isso define o limite trace para quatro vezes o [Apdex T](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_t) do seu aplicativo. Se for fornecido um número, ele será definido em segundos.

    O `apdex_t` padrão é 500 milissegundos. Se o seu limite de transação estiver definido como `apdex_f`, uma transação &quot;lenta&quot; dura 2 segundos.
  </Collapser>

  <Collapser id="hide-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, o agente captura o atributo do rastreamento da transação.

    <Callout variant="caution">
      Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
    </Callout>
  </Collapser>

  <Collapser id="hide-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo para excluir do rastreamento da transação. Permite `*` como curinga no final.
  </Collapser>

  <Collapser id="hide-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo do atributo a incluir no rastreamento da transação. Permite `*` como curinga no final.
  </Collapser>
</CollapserGroup>

## Variáveis de regras [#rules\_config][#rules_config]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `rules: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="rules_names" title="nome">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Strings ou expressões regulares
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_NAMING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Uma lista de regras delimitadas por vírgulas para corresponder aos URLs de solicitação recebida e nomear a transação New Relic associada. Usa o formato:

    ```js
    name: [
        { pattern: 'STRING_OR_REGEX', name: 'NAME' },
        { pattern: 'STRING_OR_REGEX', name: 'NAME' }
    ]
    ```

    Ambos os parâmetros são obrigatórios. Para strings, você deve escapar dos caracteres de controle. Você não precisa escapar dos caracteres de controle em expressões regulares. Atributos adicionais são ignorados.

    As expressões regulares suportam grupos de captura no estilo JavaScript e os nomes usam strings de substituição no estilo `$1` . As expressões regulares encontram apenas o primeiro resultado correspondente; as correspondências subsequentes são ignoradas. Para obter mais informações, consulte [API de nomenclatura de transação do Node.js.](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#ignoring)

    Para a variável de ambiente `NEW_RELIC_NAMING_RULES` , transmita as regras como literais de objeto JSON delimitados por vírgula:

    ```ini
    NEW_RELIC_NAMING_RULES='{"pattern":"^t","name":"u"},{"pattern":"^u","name":"t"}'
    ```
  </Collapser>

  <Collapser id="rules_ignore" title="ignorar">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Strings ou expressões regulares
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `['^/socket.io/.*/xhr-polling/']`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_IGNORING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Defina uma lista de URLs de solicitação que você deseja que o agente ignore. Especifique a lista como padrões, que podem ser strings ou expressões regulares. O valor padrão é uma expressão regular para corresponder às solicitações de pesquisa longa do socket.io
  </Collapser>

  <Collapser id="enforce_backstop" title="enforce_backstop">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_ENFORCE_BACKSTOP`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Não altere esta configuração a menos que você entenda [os problemas de agrupamento métrico](/docs/features/metric-grouping-issues).
    </Callout>

    Quando ativado, o agente renomeia transações que não são afetadas por outra lógica de nomenclatura (como API, regras ou regras de normalização de métricas) para `NormalizedUri/*`. Se você definir isso como `false`, o agente definirá os nomes de transação como `Uri/path/to/resource`.
  </Collapser>
</CollapserGroup>

## Variáveis de evento de transação [#tx\_events][#tx_events]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `transaction_events: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="tx_events_enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente envia evento de transação para New Relic. Esses dados do evento incluem o tempo da transação, o nome da transação e qualquer atributo personalizado. Se estiver desabilitado, o agente não coleta esses dados nem os envia para a New Relic.
  </Collapser>

  <Collapser id="tx_events_max_samples_stored" title="max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de eventos que o agente coleta por minuto. Se houver mais que esse número, o agente coleta uma amostragem estatística.

    Não recomendamos configurar além de 10.000. O servidor limitará os dados a 10.000 por minuto.

    <Callout variant="important">
      Esta configuração teve comportamento diferente nas versões do agente inferiores à 6.0.0. Consulte [`max_samples_stored` (DEPRECATED)](#tx_events_max_samples_stored_legacy) para versões de agente 5.x ou anteriores.
    </Callout>
  </Collapser>

  <Collapser id="tx_events_max_samples_stored_legacy" title="max_samples_stored (DESCONTINUADO)">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `20000`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de eventos que o agente armazena caso não consiga se comunicar com o [coletor New Relic](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). Os valores do [ciclo de coleta](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#harvest-cycle) anterior serão mesclados no próximo, limitando esta opção o número máximo. Certifique-se de que este número seja maior que `max_samples_per_minute`; por exemplo, defina-o para o dobro. Considere a sobrecarga de memória antes de aumentar esse valor.

    <Callout variant="caution">
      Esta configuração tem um comportamento diferente a partir da versão 6.0.0 do agente e um novo máximo recomendado. Consulte [`max_samples_stored`](#tx_events_max_samples_stored) para versões do agente 6.x ou superior.
    </Callout>
  </Collapser>

  <Collapser id="tx_events_max_samples_per_minute" title="max_samples_per_minute (DESCONTINUADO)">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de eventos que o agente coleta por minuto. Se houver mais que esse número, o agente coleta uma amostragem estatística.

    <Callout variant="caution">
      Esta configuração foi substituída por `max_samples_stored` a partir da versão 6.0.0 do agente. Consulte [`max_samples_stored`](#tx_events_max_samples_stored) para agente 6.x ou posterior.
    </Callout>
  </Collapser>

  <Collapser id="tx-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, o agente captura o atributo do evento de transação.

    <Callout variant="caution">
      Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
    </Callout>
  </Collapser>

  <Collapser id="tx-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo do atributo para excluir do evento de transação. Permite `*` como curinga no final.
  </Collapser>

  <Collapser id="tx-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo do atributo a ser incluído no evento da transação. Permite `*` como curinga no final.
  </Collapser>
</CollapserGroup>

## Monitoramento de variáveis do browser [#browser-variables]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `browser_monitoring: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="browser" title="habilitar">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_ENABLE`
          </td>
        </tr>

        <tr>
          <th>
            [Etiqueta do lado do servidor](#server-side)
          </th>

          <td>
            `Enable browser monitoring?`
          </td>
        </tr>
      </tbody>
    </table>

    Gere cabeçalhos JavaScript para instrumentação do browser. Se definido como `true` o agente não injetará automaticamente o código JS do browser, a menos que você tenha [ativado manualmente <InlinePopover type="browser" />](/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser). Mesmo que você tenha ativado e [adicionado o cabeçalho de tempo do browser](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#procedures), você pode [desativar o monitoramento do browser para seu aplicativo](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#disabling) configurando-o como `false`.
  </Collapser>

  <Collapser id="browser-debug" title="depurar">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_DEBUG`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, solicite fontes não minificadas do servidor.
  </Collapser>

  <Collapser id="browser-debug-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se `true`, o agente envia um atributo personalizado ao monitoramento do Browser.

    <Callout variant="caution">
      Quaisquer regras de inclusão/exclusão relacionadas ao cabeçalho devem estar no formato camelCase para serem filtradas.
    </Callout>
  </Collapser>

  <Collapser id="browser-debug-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo para excluir do monitoramento de Browser. Permite `*` como curinga no final.
  </Collapser>

  <Collapser id="browser-debug-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Prefixo de atributo a incluir no monitoramento de Browser. Permite `*` como curinga no final.
  </Collapser>
</CollapserGroup>

## Variáveis personalizadas do evento [#custom\_events][#custom_events]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `custom_insights_events: {` do arquivo de configuração `newrelic.js` do seu aplicativo.

<CollapserGroup>
  <Collapser id="custom_events_enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente envia evento personalizado gravado com [`recordCustomEvent()`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#custom-events-api) para [New Relic](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-insights-api). Se estiver desabilitado, o agente não coleta esses dados nem os envia para a New Relic.
  </Collapser>

  <Collapser id="custom_events_max_samples_stored" title="max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `3000`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    * Define o número máximo de eventos personalizados que o agente coleta por minuto. Caso o número de eventos personalizados ultrapasse esse limite, o agente coleta uma amostragem estatística.

    * Ao configurar o agente para [AI Monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), defina o valor máximo `100000`. Garante que a quantidade máxima de eventos LLM seja capturada.

      <Callout variant="important">
        Aumentar esse limite pode aumentar o uso de memória.
      </Callout>
  </Collapser>
</CollapserGroup>

## Consulta lenta variáveis [#slow-queries]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `slow_sql: {` do arquivo de configuração `newrelic.js` do seu aplicativo. Estas opções controlam o comportamento da consulta lenta, mas não afetam os nós SQL no rastreamento da transação.

<CollapserGroup>
  <Collapser id="slow-sql-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SLOW_SQL_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando ativado, o agente coleta [detalhes da consulta lenta](/docs/apm/applications-menu/monitoring/viewing-slow-query-details).
  </Collapser>

  <Collapser id="slow-sql-max-samples" title="max_samples">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_MAX_SQL_SAMPLES`
          </td>
        </tr>
      </tbody>
    </table>

    Define o número máximo de consultas lentas que o agente coleta por minuto. O agente descarta consultas adicionais após atingir o limite.

    <Callout variant="important">
      Aumentar esse limite aumenta o uso de memória.
    </Callout>
  </Collapser>
</CollapserGroup>

## Nome personalizado das variáveis de host [#custom-hostnames]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `process_host: {` do arquivo de configuração `newrelic.js` do seu aplicativo. Essas opções controlam o comportamento em relação ao nome de exibição do host na interface do APM.

<CollapserGroup>
  <Collapser id="custom-hostnames-display" title="display_name">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            String de 255 bytes ou menos
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    Especifique um nome do host personalizado para [exibição no New Relic](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name). Se você não definir este campo, o New Relic continuará usando o nome do host padrão encontrado chamando `os.hostname()`.

    * Se você usar as configurações padrão de nome do host, o New Relic encontrará o nome do host por meio de `os.hostname()`.
    * Se esta chamada falhar, o New Relic usará o IP do host como nome.
    * Se você definir `ipv_preference: 4` ou `ipv_preference: 6`, poderá selecionar o tipo de endereço IP (IPv4 ou IPv6) que aparece na interface do New Relic.
  </Collapser>

  <Collapser id="custom-hostnames-ipv" title="ipv_preference">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Inteiro (`4` ou `6`)
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `4`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_IPV_PREFERENCE`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Variáveis tracer do armazenamento de dados [#datastore-tracer]

Esta seção define as variáveis do agente Node.js na ordem em que normalmente aparecem na seção `datastore_tracer` do arquivo de configuração `newrelic.js` do seu aplicativo. Essas opções controlam o comportamento de coleta de métricas de instâncias de armazenamento de dados.

<CollapserGroup>
  <Collapser id="datastore-instance-enabled" title="instance_reporting.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_INSTANCE_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente coleta métricas de instância do datastore (como host e porta) para [algum driver do banco de dados](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information). Estes são relatados em consulta lenta trace e trace da transação.
  </Collapser>

  <Collapser id="datastore-name-enabled" title="database_name_reporting.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_DATABASE_NAME_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente coleta o nome do banco de dados em consulta lenta trace e trace da transação para [algum driver do banco de dados](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information).
  </Collapser>
</CollapserGroup>

## Rastreamento multiaplicativo (DEPRECADO) [#cross-app-tracing]

As variáveis do agente Node.js que controlam [o rastreamento multiaplicativo](/docs/apm/transactions/cross-application-traces/introduction-cross-application-traces) normalmente aparecem na seção `cross_application_tracer` do arquivo de configuração `newrelic.js` do seu aplicativo:

<Callout variant="important">
  O rastreamento multiaplicativo foi descontinuado em favor do [Distributed tracing](/docs/enable-distributed-tracing) e será removido em uma versão futura do agente.
</Callout>

<CollapserGroup>
  <Collapser id="cat-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CROSS_APPLICATION_TRACER_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando definido como `true`, permite o rastreamento de transações em mais de um aplicativo monitor New Relic.
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  O rastreamento multiaplicativo (CAT) foi descontinuado e será removido em uma versão principal futura. Para visibilidade entre serviços, recomendamos usar [distributed tracing](#distributed-tracing), que é habilitado por padrão a partir da versão 8.3.0 do agente. Antes de ativar, leia o [guia de transição](/docs/transition-guide-distributed-tracing).
</Callout>

## Mensagem de erro variáveis de redação [#err-message-redact]

As variáveis do agente Node.js que controlam a redação da mensagem de erro aparecem na seção `strip_exception_messages` do arquivo de configuração `newrelic.js` do seu aplicativo:

<CollapserGroup>
  <Collapser id="allow-raw-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_STRIP_EXCEPTION_MESSAGES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando `true`, o agente redigirá as mensagens de erros capturados.
  </Collapser>
</CollapserGroup>

## Distributed tracing [#dt-main]

[distributed tracing](/docs/intro-distributed-tracing) permite ver o caminho que uma solicitação percorre ao percorrer sistemas distribuídos. Ao configurar por meio do arquivo de configuração, coloque a seguinte opção na seção `distributed_tracing` . Ele está ativado por padrão no agente Node.js 8.3.0 e superior.

<Callout variant="important">
  A ativação distributed tracing desativa [o rastreamento multiaplicativo](#cross-app-tracing) e tem efeitos em outros recursos do APM. Antes de ativar, leia o [guia de transição](/docs/transition-guide-distributed-tracing). Requer [agente Node.js versão 4.7.0 ou superior](/docs/agents/nodejs-agent/installation-configuration/upgrade-nodejs-agent).
</Callout>

Para obter mais informações sobre como configurar distributed tracing, consulte [Habilitar distributed tracing para seu aplicativo Node.js.](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent)

<CollapserGroup>
  <Collapser id="dt-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `false` para desativar distributed tracing. Por exemplo, no arquivo de configuração, você usaria:

    ```js
    distributed_tracing: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser id="dt-exclude-newrelic-header" title="exclude_newrelic_header">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_EXCLUDE_NEWRELIC_HEADER`
          </td>
        </tr>
      </tbody>
    </table>

    Defina como `true` para excluir o cabeçalho New Relic anexado às solicitações de saída e, em vez disso, confiar apenas nos cabeçalhos W3C Trace Context para distributed tracing. Se for `false` , ambos os tipos de cabeçalho serão usados.

    Por exemplo, para habilitar isso no arquivo de configuração, você usaria:

    ```js
    distributed_tracing: {
        enabled: true,
        exclude_newrelic_header: true
    }
    ```
  </Collapser>

  <Collapser id="dt-sampler-remote-parent-sampled" title="sampler.remote_parent_sampled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando o cabeçalho traceparent tem um sinalizador amostrado de `01`, isso controla como lidar com a amostragem de intervalos. Os valores permitidos são:

    * `always_on`: o agente irá amostrar intervalos
    * `always_off`: o agente NÃO fará amostragem de intervalos
    * `default`: o agente usará a amostragem NR existente (padrão)

    Por exemplo, para habilitar isso no arquivo de configuração, você usaria:

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_sampled: 'always_on'
        }
    }
    ```
  </Collapser>

  <Collapser id="dt-sampler-remote-parent-not-sampled" title="sampler.remote_parent_not_sampled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_NOT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    Quando o cabeçalho traceparent tem um sinalizador amostrado de `00`, isso controla como lidar com a amostragem de intervalos. Os valores permitidos são:

    * `always_on`: o agente irá amostrar intervalos
    * `always_off`: o agente NÃO fará amostragem de intervalos
    * `default`: o agente usará a amostragem NR existente (padrão)

    Por exemplo, para habilitar isso no arquivo de configuração, você usaria:

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_not_sampled: 'always_on'
        }
    }
    ```
  </Collapser>
</CollapserGroup>

## Instrumentação de servidor gRPC [#grpc\_server][#grpc_server]

A seção `grpc` controla o comportamento de como o servidor gRPC é instrumentado.

<CollapserGroup>
  <Collapser id="record_errors" title="record_errors">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_GRPC_RECORD_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Quando habilitado, o agente enviará todos os códigos de status gRPC de erro para o New Relic, ou seja, códigos de status diferentes de zero. Se desativado, a instrumentação do servidor não enviará nenhum código de status diferente de zero para o New Relic.
  </Collapser>
</CollapserGroup>

<Collapser id="grpc_error_ignore" title="ignore_status_codes">
  <table>
    <tbody>
      <tr>
        <th>
          Tipo
        </th>

        <td>
          Matriz de inteiros
        </td>
      </tr>

      <tr>
        <th>
          Padrão
        </th>

        <td>
          `[]`
        </td>
      </tr>

      <tr>
        <th>
          [Variável ambiental](#environment)
        </th>

        <td>
          `NEW_RELIC_GRPC_IGNORE_STATUS_CODES`
        </td>
      </tr>
    </tbody>
  </table>

  Lista delimitada por vírgulas de códigos de status gRPC para o coletor de erros ignorar, tanto na instrumentação do lado do cliente quanto do lado do servidor.

  <Callout variant="caution">
    Erros registrados usando [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) não obedecem a este valor de configuração.
  </Callout>
</Collapser>

## Evento de extensão

[Os dados de extensão](/docs/apm/distributed-tracing/ui-data/span-event) são relatados para [distributed tracing](#distributed-tracing). distributed tracing deve ser ativado para relatar períodos. Defina a configuração do intervalo na seção `span_events` . As opções incluem:

<CollapserGroup>
  <Collapser id="span-events-enabled" title="habilitado">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Ativa ou desativa o relatório do evento span.
  </Collapser>

  <Collapser id="span-events-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração pode ser usada para ativar ou desativar o relatório de atributo para períodos. Se `attributes.enabled` no nível raiz for `false`, nenhum atributo será enviado com intervalos, independentemente de como isso for definido.
  </Collapser>

  <Collapser id="span-events-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Se atributo estiver habilitado para spans, todas as chaves atributo encontradas nesta lista serão anexadas aos spans. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser id="span-events-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Todas as chaves de atributo encontradas nesta lista não serão enviadas com spans. Para mais informações, consulte as [regras de atribuição de agentes](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

<Collapser id="span-events-max-samples-stored" title="max_samples_stored">
  <table>
    <tbody>
      <tr>
        <th>
          Tipo
        </th>

        <td>
          Inteiro
        </td>
      </tr>

      <tr>
        <th>
          Padrão
        </th>

        <td>
          `2000`
        </td>
      </tr>

      <tr>
        <th>
          [Variável ambiental](#environment)
        </th>

        <td>
          `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`
        </td>
      </tr>
    </tbody>
  </table>

  * Define o número máximo de eventos que o agente coleta por minuto. Se houver mais que esse número, o agente coleta uma amostragem estatística.

  * Não recomendamos configurar além de 10k. O servidor limitará os dados a 10k por minuto.

  * Ao configurar o agente para [AI Monitoring](/docs/ai-monitoring/intro-to-ai-monitoring), defina o valor máximo `10000`. Garante que a quantidade máxima de rastreamento seja capturada.

    <Callout variant="important">
      `max_samples_stored` as definições de configuração exigem [o agente Node.JS versão 8.3.0 ou superior](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).
    </Callout>
</Collapser>

## Rastreamento infinito

Para ativar o Rastreamento infinito, adicione as configurações abaixo. Defina a configuração do Rastreamento infinito na seção `infinite_tracing` . Além disso, distributed tracing deve estar [habilitado](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent). Observe que distributed tracing é habilitado por padrão para o agente APM Node.js versões 8.3.0 e superiores.

<CollapserGroup>
  <Collapser id="infinite-tracing-host" title="trace_observer.host">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Para obter ajuda para obter uma entrada válida de host do observador trace do Infinite Tracing, consulte [Localizar ou criar um endpoint do observador trace ](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).
  </Collapser>

  <Collapser id="infinite-tracing-queue-size" title="span_events.queue_size">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Número
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_SPAN_EVENTS_QUEUE_SIZE`
          </td>
        </tr>
      </tbody>
    </table>

    A quantidade de intervalos de rastreamento infinito que o agente manterá na memória antes de descartá-los.

    Essa configuração raramente precisa ser alterada do padrão, pois a fila não está em uso na maior parte do tempo. A fila está em uso somente durante reconexões com o endpoint do Infinite Tracing enquanto o agente não consegue transmitir dados. É possível que o agente elimine períodos de rastreamento infinito durante esses períodos; nesse caso, aumentar esse número pode ajudar.
  </Collapser>

  <Collapser id="infinite-tracing-batching" title="loteamento">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_BATCHING`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração envia intervalos em lotes de 250 ou a cada 5 segundos.

    Esta configuração não deve ser alterada, pois a quantidade de saída aumentará significativamente.
  </Collapser>

  <Collapser id="infinite-tracing-compression" title="compressão">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_COMPRESSION`
          </td>
        </tr>
      </tbody>
    </table>

    Esta configuração gzip compacta span(s).

    Esta configuração não deve ser alterada, pois a quantidade de saída aumentará significativamente.
  </Collapser>
</CollapserGroup>

## Registro de aplicativo [#app-logging]

As definições de configuração de log do aplicativo requerem [o agente Node.JS versão 8.11.0 ou superior](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

Para obter dicas sobre como configurar o log para o agente Node.js, consulte [Configurar o logs contextualizados do Node.js](/docs/logs/logs-context/configure-logs-context-nodejs).

<CollapserGroup>
  <Collapser id="application-logging-enabled" title="application_logging.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Permite a geração automática [de logs contextualizados](/docs/logs/logs-context/configure-logs-context-nodejs/).

    Por exemplo, para desabilitar esse recurso no arquivo de configuração, você usaria:

    ```js
    application_logging: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser id="application-logging-metrics-enabled" title="application_logging.metrics.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se o agente coleta métricas de Log usadas no gráfico Logs na página Resumo do APM.
  </Collapser>

  <Collapser id="application-logging-forwarding-enabled" title="application_logging.forwarding.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se o agente coleta registros de log para enviar ao New Relic.
  </Collapser>

  <Collapser id="application-logging-forwarding-max_samples_stored" title="application_logging.forwarding.max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Número
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Número de registros de log a serem enviados por minuto para o New Relic. Controla o consumo geral de memória ao usar o encaminhamento de logs.

    Defina um valor mais baixo para reduzir a quantidade de linhas de log enviadas (pode causar amostragem de log). Defina um valor mais alto para enviar mais linhas de log.

    Cada log recebe a mesma prioridade que sua transação associada. log que ocorrem fora de uma transação receberão uma prioridade aleatória. Alguns registros podem não ser incluídos porque são limitados por `max_samples_stored`. Por exemplo, se o registro em log `max_samples_stored` estiver definido como 10.000 e a transação 1 tiver 10.000 entradas de log, somente as entradas de log da transação 1 serão registradas. Se a transação 1 tiver menos de 10.000 logs, você receberá todos os logs da transação 1. Se ainda houver espaço, você receberá todo o log da transação 2 e assim por diante.

    Se após todos os logs de transação amostrados forem registrados, e eles não atingirem o limite em `max_samples_stored`, então será enviada a mensagem do log de transação amostrada que não estava em nossa amostragem. Se sobrar alguma, as mensagens do log fora da transação serão registradas.
  </Collapser>

  <Collapser id="application-logging-forwarding-labels" title="application_logging.forwarding.labels.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            false
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se o agente adicionará rótulos aos registros de log para envio ao New Relic.
  </Collapser>

  <Collapser id="application-logging-forwarding-labels-exclude" title="application_logging.forwarding.labels.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Matriz
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            \[]
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Uma lista de nomes de rótulos que não diferenciam maiúsculas de minúsculas a serem excluídos quando você habilita a inclusão de rótulos no log. Este atributo não suporta curingas ou regex.
  </Collapser>

  <Collapser id="application-logging-local_decorating-enabled" title="application_logging.local_decorating.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se o agente executa a decoração log local na saída de log padrão.
  </Collapser>
</CollapserGroup>

## Nível do código métrico [#code-level-metrics]

As definições de configuração do nível do código métrico requerem [o agente Node.JS versão 9.7.5 ou superior](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

Para obter mais detalhes, consulte [nossos documentos sobre nível do código métrico](/docs/apm/agents/nodejs-agent/installation-configuration/codestream-integration).

<CollapserGroup>
  <Collapser id="code-level-metrics-enabled" title="code_level_metrics.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_CODE_LEVEL_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se é necessário capturar atributo adicional em spans de middleware para toda a estrutura da web Node.js que ajuda a impulsionar [o nível do código métrico](/docs/codestream/observability/code-level-metrics). Os atributos adicionais são: `code.filepath`, `code.function`, `code.lineno` e `code.column`.
  </Collapser>
</CollapserGroup>

## Configuração Errors Inbox [#errors-inbox-configuration]

Definir uma das tags a seguir ajudará você a identificar quais versões do seu software estão produzindo erros.

* `NEW_RELIC_METADATA_SERVICE_VERSION` irá criar tag.service.version nos dados do evento contendo a versão do seu código que está implantada, em muitos casos uma versão semântica como 1.2.3, mas nem sempre.
* `NEW_RELIC_METADATA_RELEASE_TAG `criará tags.releaseTag nos dados do evento contendo a tag de lançamento (como v0.1.209 ou release-209).
* `NEW_RELIC_METADATA_COMMIT` criará tag.commit nos dados do evento contendo o commit sha. O sha inteiro pode ser usado ou apenas os primeiros sete caracteres (por exemplo, 734713b).

Uma próxima versão da Errors Inbox rastreará automaticamente quais versões do seu software estão produzindo erros. Quaisquer dados de versão também serão exibidos no [CodeStream](/docs/codestream/how-use-codestream/performance-monitoring/#buildsha).

## Url ofuscação [#url-obfuscation]

As definições de configuração de ofuscação de URL exigem [o agente Node.js versão 9.9.0 ou superior](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

Para obter um exemplo de configuração, consulte nossa documentação sobre [ofuscação de URL do agente do nó](/docs/url-obfuscation/configure-url-obfuscation-nodejs).

<CollapserGroup>
  <Collapser id="url-obfuscation-enabled" title="url_obfuscation.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Ativa [a ofuscação de URL do agente de nó](/docs/url-obfuscation/configure-url-obfuscation-nodejs/) com base em regex.
  </Collapser>

  <Collapser id="url-obfuscation-regex-pattern" title="url_obfuscation.regex.pattern">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            String ou RegExp
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_PATTERN`
          </td>
        </tr>
      </tbody>
    </table>

    Especifica o padrão regex a ser usado para ofuscação de URL. Se isso não for definido, nenhuma ofuscação de URL será executada.
  </Collapser>

  <Collapser id="url-obfuscation-regex-flags" title="url_obfuscation.regex.flags">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_FLAGS`
          </td>
        </tr>
      </tbody>
    </table>

    Especifica os sinalizadores regex a serem usados para correspondência de padrão de ofuscação de URL, por exemplo `g` para correspondência global, `i` para correspondência sem distinção entre maiúsculas e minúsculas, etc. Vários sinalizadores podem ser especificados como uma string, por exemplo `gi`. Se isso não for definido, nenhum sinalizador será usado.
  </Collapser>

  <Collapser id="url-obfuscation-regex-replacement" title="url_obfuscation.regex.replacement">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_REPLACEMENT`
          </td>
        </tr>
      </tbody>
    </table>

    Especifica a cadeia de caracteres de substituição a ser usada para ofuscação de URL. Pode conter referências para capturar grupos no padrão, por exemplo `$1`. Se não for definido, tudo será substituído por uma única string vazia.
  </Collapser>
</CollapserGroup>

## Agente de segurança [#security-agent]

[O teste de segurança de aplicativo interativo (IAST) do agente New Relic Security](/docs/iast/introduction/) testa seu aplicativo em busca de quaisquer vulnerabilidades exploráveis, reproduzindo a solicitação HTTP gerada com carga vulnerável.

<Callout variant="caution">
  Execute o IAST apenas com implantação não produtiva para evitar a exposição de vulnerabilidades em seu software de produção.
</Callout>

<Callout variant="important">
  As definições de configuração do agente de segurança exigem [o agente Node.js versão 10.3.0 ou superior](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).
</Callout>

<CollapserGroup>
  <Collapser id="security-enabled" title="security.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se os dados do agente de segurança da New Relic são enviados para a New Relic ou não. Quando estiver desabilitado e security.agente.enabled for verdadeiro, o agente de segurança será cadastrado mas os dados não serão enviados.
  </Collapser>

  <Collapser id="security-agent-enabled" title="security.agent.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_AGENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Alterna se o agente New Relic Security está carregado. Esta propriedade é lida apenas uma vez no início do aplicativo.
  </Collapser>

  <Collapser id="security-mode" title="security.mode">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `IAST`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_MODE`
          </td>
        </tr>
      </tbody>
    </table>

    Modo fornecido pela New Relic Security: IAST. O padrão é IAST. Devido à natureza invasiva da varredura IAST, NÃO ative esse modo em um ambiente de produção ou em um ambiente onde os dados de produção são processados.
  </Collapser>

  <Collapser id="security-validator-url" title="security.validator_service_url">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `wss://csec.nr-data.net`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_VALIDATOR_SERVICE_URL`
          </td>
        </tr>
      </tbody>
    </table>

    URL de conexão New Relic Security. Este é o endpoint para o qual o agente de segurança envia dados; ele deve corresponder ao ambiente que você configurou para o agente Node.js.
  </Collapser>

  <Collapser id="security-rci-detection" title="security.detection.rci.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RCI_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Ative a detecção de eventos de segurança RCI.
  </Collapser>

  <Collapser id="security-xss-detection" title="security.detection.rxss.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RXSS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite a detecção de eventos de segurança RXSS.
  </Collapser>

  <Collapser id="security-deserialization-detection" title="security.detection.deserialization.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_DESERIALIZATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Habilite a detecção de eventos de segurança de desserialização.
  </Collapser>
</CollapserGroup>

## Heroku [#heroku]

<CollapserGroup>
  <Collapser id="heroku-dyno" title="heroku.use_dyno_names">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_HEROKU_USE_DYNO_NAMES`
          </td>
        </tr>
      </tbody>
    </table>

    Se for verdade, o agente usa nomes dyno Heroku como nome do host.
  </Collapser>
</CollapserGroup>

## Threads de trabalho [#worker-threads]

Nas versões do agente anteriores à 11.0.0, o agente era executado nos threads principal e de trabalho. Na versão 11.0.0 o agente parou de funcionar em threads de trabalho devido à sua incompatibilidade com nossa propagação de contexto assíncrono. A capacidade de execução em encadeamentos de trabalho foi restaurada na versão 11.3.0, mas você deve configurar `worker_threads.enabled` como `true`. O comportamento de execução nos threads de trabalho varia e não oferecemos suporte oficial para isso. Algumas coisas como geração de métricas e rastreamento de transação independente podem funcionar, mas isso é um uso por sua conta e risco.

<CollapserGroup>
  <Collapser id="worker-threads" title="worker_threads.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variável ambiental](#environment)
          </th>

          <td>
            `NEW_RELIC_WORKER_THREADS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Se for verdade, o agente será carregado quando estiver em um thread de trabalho, se especificado.
  </Collapser>
</CollapserGroup>

## Substituições de variáveis de ambiente

Esta seção define duas opções de configuração disponíveis apenas com variáveis de ambiente. Essas substituições não são usadas na maioria das configurações.

<CollapserGroup>
  <Collapser id="home" title="NEW_RELIC_HOME">
    Caminho para o diretório que contém `newrelic.js`. Isso está disponível apenas como uma variável de ambiente. Você não pode configurá-lo em seu arquivo de configuração.

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="filename" title="NEW_RELIC_CONFIG_FILENAME">
    Usado para definir um nome de arquivo de configuração diferente do padrão `newrelic.js`. Isto está disponível apenas como uma variável de ambiente. Você não pode defini-lo no seu arquivo de configuração.

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Corda
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            (nenhum)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="no_file" title="NEW_RELIC_NO_CONFIG_FILE">
    Se usado, evita que o agente leia as definições de configuração de `newrelic.js`. Os valores padrão e os valores das variáveis de ambiente ainda serão definidos.

    Isso está disponível apenas como uma variável de ambiente. Você não pode configurá-lo em seu arquivo de configuração.

    <table>
      <tbody>
        <tr>
          <th>
            Tipo
          </th>

          <td>
            Boleano
          </td>
        </tr>

        <tr>
          <th>
            Padrão
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Guia de referência de tipo de variável de ambiente

Esta seção descreve como formatar corretamente os tipos de dados complexos.

<CollapserGroup>
  <Collapser id="array" title="Matriz">
    Tipos de matriz são definidos como strings delimitadas por vírgula.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES=404,500,429
    ```
  </Collapser>

  <Collapser id="object" title="Objeto">
    Os tipos de objeto são definidos como uma string json.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES='{"Error":["Undefined", "No soup for you!"]}'
    ```
  </Collapser>
</CollapserGroup>