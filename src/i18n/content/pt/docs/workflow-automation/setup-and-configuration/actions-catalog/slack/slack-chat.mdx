---
title: Ações do Slack
tags:
  - workflow automation
  - workflow
  - workflow automation actions
  - Slack actions
  - communication actions
  - Slack Chat actions
metaDescription: A list of available slack chat actions in the actions catalog for workflow definitions
freshnessValidatedDate: never
translationType: machine
---

<Callout title="visualização">
  Ainda estamos trabalhando nesse recurso, mas adoraríamos que você experimentasse!

  Atualmente, esse recurso é fornecido como parte de um programa de visualização de acordo com nossas [políticas de pré-lançamento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Esta página fornece uma referência completa para as ações de chat do Slack disponíveis no catálogo de ações de automação de fluxo de trabalho. Essas ações permitem que você relaxe as operações de mensagens.

## Pré-requisitos

Antes de usar ações de comunicação na automação de fluxo de trabalho, certifique-se de ter:

* Um espaço de trabalho do Slack com as permissões apropriadas.
* Um token de bot do Slack configurado como um segredo na automação de fluxo de trabalho.
* Acesso aos canais do Slack onde você deseja enviar mensagens.

## Configurar a integração do Slack [#slack-configuration]

Esta seção detalha as instruções para configurar um aplicativo Slack com as permissões de escopo mínimas para permitir as ações de automação do fluxo de trabalho do Slack.

### Crie um aplicativo Slack

1. Vá para [Slack API](https://api.slack.com/apps) &gt; **Create New App &gt; From Scratch**

2. Dê um nome ao seu aplicativo e selecione um espaço de trabalho e clique em **Create App**.

3. Após a criação, vá para **App Home** na navegação à esquerda e certifique-se de que seu bot esteja online.

   <img width="40%;" style={{align: "left"}} title="Always show My Bot as Online" alt="The Slack App Home page with the My Bot online status highlighted." src="/images/my-bot-always-online.webp" />

### Configurar permissões OAuth

1. Na navegação à esquerda, selecione **OAuth &amp; Permissions**.

2. Role a tela para baixo até a seção **Bot Token Scopes** e adicione os seguintes escopos para permitir o uso das ações de automação do fluxo de trabalho:

   * `chat:write` - Necessário para postar uma mensagem
   * `reactions:read` - Necessário para obter reação de um tópico
   * `files:write` - Necessário para carregar um anexo de arquivo em um tópico

   <img width="40%;" style={{align: "left"}} title="Workflow automation Slack scopes" alt="The image of the scope that needs to be added for workflow automation Slack actions." src="/images/slack-workflow-scopes.webp" />

3. Role para cima e clique no botão **Install to \[espaço de trabalho]** para iniciar a configuração do OAuth com seu espaço de trabalho do Slack.

4. Você deve ver um prompt de confirmação. Clique em **Allow** para confirmar.

5. Após o sucesso, copie o **Bot token** e guarde-o para a próxima etapa. O token deve começar com `xoxb-...`.

### Adicionar aplicativo aos canais

Agora que o aplicativo Slack foi criado e configurado, adicione-o aos canais do Slack que você gostaria de usar editando as **Integrações** desse canal e adicionando o aplicativo Slack a ele.

### Configuração do New Relic

Depois de configurar um aplicativo Slack e obter um token de bot, armazene essa credencial no gerenciamento de segredos do New Relic usando a mutação GraphQL abaixo:

```graphql
mutation {
  secretsManagementCreateSecret(
    scope: {type: ACCOUNT id: "12345678"}
    namespace: "slack"
    key: "my-app-bot-token"
    description: "A slack token to send messages with newrelic workflow automation"
    value: "xoxb-..."
  ) {
    key
  }
}
```

Configure os seguintes valores:

* `id` - Seu ID da conta New Relic
* `namespace` - Opcional, use qualquer string alfanumérica para categorizar seu segredo
* `key` - Use uma string alfanumérica para referenciar este segredo
* `description` - Descrição opcional para o segredo
* `value` - O token do bot do Slack que você copiou da etapa anterior

Você pode executar esta mutação usando o [NerdGraph GraphiQL explorer](https://one.newrelic.com/nerdgraph-graphiql) com sua chave de API de usuário do New Relic. Após o envio com sucesso, você deverá ver um resultado semelhante a este:

```json
{
  "data": {
    "secretsManagementCreateSecret": {
      "key": "my-app-bot-token"
    }
  }
}
```

### Use o token do Slack em fluxos de trabalho

Use o recurso de automação de fluxo de trabalho aproveitando o segredo do token do bot do Slack armazenado com seu namespace e nomes de chave.

**Exemplo:**

```yaml
name: to-slack

steps:
  - name: postCsv
    type: action
    action: slack.chat.postMessage
    version: 1
    inputs:
      channel: test-channel-workflow
      text: "Hello World!"
      token: ${{ :secrets:slack:my-app-bot-token }}
```

<Callout variant="tip">
  Se você não usou um namespace, remova a parte `:namespace` da entrada do token, assim: `${{ :secrets:my-app-bot-token }}`
</Callout>

## Ações do Slack

<CollapserGroup>
  <Collapser id="slack-chat-postmessage" title="Publique uma mensagem no canal do Slack.">
    Envia uma mensagem para um canal do Slack, com a opção de anexar um arquivo.

    <Tabs>
      <TabsBar>
        <TabsBarItem id="chatpostmessageinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="chatpostmessageoutputs">
          Saídas
        </TabsBarItem>

        <TabsBarItem id="chatpostmessageexample">
          Exemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="chatpostmessageinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidade
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Descrição
                </th>

                <th>
                  Exemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **token**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Segredo
                </td>

                <td>
                  O token do bot do Slack a ser usado. Isso deve ser passado como uma sintaxe secreta. Consulte 

                  [Adicionar configuração do Slack](#slack-configuration)

                   para obter instruções sobre como configurar um token.
                </td>

                <td>
                  `${{ :secrets:slackToken }}`
                </td>
              </tr>

              <tr>
                <td>
                  **canal**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  O nome do canal, ou um ID de canal, para enviar a mensagem. Consulte 

                  [a API do Slack](https://docs.slack.dev/reference/methods/chat.postMessage/#arg_channel)

                   para obter mais informações.
                </td>

                <td>
                  `my-slack-channel`
                </td>
              </tr>

              <tr>
                <td>
                  **texto**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  A mensagem a ser postada no Slack no 

                  `channel`

                   especificado.
                </td>

                <td>
                  `Hello World!`
                </td>
              </tr>

              <tr>
                <td>
                  **threadTs**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Carimbo de data/hora pertencente à mensagem principal, usado para criar uma resposta em uma conversa.
                </td>

                <td>
                  `<digits>.<digits>`
                </td>
              </tr>

              <tr>
                <td>
                  **anexo**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Mapa
                </td>

                <td>
                  Permite anexar um arquivo com uma mensagem ao 

                  `channel`

                   especificado.
                </td>

                <td />
              </tr>

              <tr>
                <td>
                  **anexo.nome do arquivo**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Especifique o nome do arquivo carregado no Slack.
                </td>

                <td>
                  `file.txt`
                </td>
              </tr>

              <tr>
                <td>
                  **anexo.conteúdo**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  O conteúdo do arquivo a ser carregado está em UTF-8.
                </td>

                <td>
                  `Hello\nWorld!`
                </td>
              </tr>

              <tr>
                <td>
                  **seletores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  Os seletores permitem obter como saída apenas o parâmetro especificado.
                </td>

                <td>
                  `[{\"name\": \"threadTs\", \"expression\": \".threadTs\"}, {\"name\": \"channelID\", \"expression\": \".channelID\")\"}]`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="chatpostmessageoutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de saída
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Descrição
                </th>

                <th>
                  Exemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **threadTs**
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Carimbo de data/hora da conversa. Pode ser usado em chamadas futuras 

                  `postMessage`

                   para postar uma resposta em um tópico.
                </td>

                <td>
                  `<digits>.<digits>`
                </td>
              </tr>

              <tr>
                <td>
                  **ID do canal**
                </td>

                <td>
                  Corda
                </td>

                <td>
                  ID do canal onde a mensagem foi publicada.
                </td>

                <td>
                  `<string>`
                </td>
              </tr>

              <tr>
                <td>
                  **sucesso**
                </td>

                <td>
                  Boleano
                </td>

                <td>
                  Estado da solicitação
                </td>

                <td>
                  `true / false`
                </td>
              </tr>

              <tr>
                <td>
                  **mensagem de erro**
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Motivo da falha conforme mensagem
                </td>

                <td>
                  `<string>`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="chatpostmessageexample">
          **Exemplo 1: Enviar mensagem no Slack**

          <table>
            <thead>
              <tr>
                <th>
                  Exemplo de fluxo de trabalho
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  ```yaml
                    name: SendMessage

                    steps:
                      - name: send_slack_message
                        type: action
                        action: slack.chat.postMessage 
                        version: 1
                        inputs:
                          token: ${{ :secrets:dn_staging_slack_token }}
                          channel: ${{ .workflowInputs.channel }}
                          text: ${{ .workflowInputs.text }}
                          selectors:
                            - name: threadTs
                              expression: ".threadTs"
                            - name: channelID
                              expression: ".channelID"
                  ```

                  **Entradas:**

                  ```json
                    {
                      "inputs": [
                        {
                          "key" : "channel",
                          "value" : "test-channel-workflow"
                        },
                        {
                          "key" : "text",
                          "value" : "This is my message *with bold text* and `code backticks`"
                        }
                      ]
                    }
                  ```

                  **Resultado esperado:**

                  ```json
                    [
                      {
                        "threadTs": "1718897637.400609",
                        "channelID": "C063JK1RHN1"
                        "success": true
                      }
                    ]
                  ```
                </td>
              </tr>
            </tbody>
          </table>

          **Exemplo 2: Anexar um arquivo**

          <table>
            <thead>
              <tr>
                <th>
                  Exemplo de fluxo de trabalho
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  ```yaml
                    name: SendFileMessage

                    steps:

                      - name: postCsv
                        type: action
                        action: slack.chat.postMessage
                        version: 1
                        inputs:
                          token: ${{ :secrets:dn_staging_slack_token }}
                          channel: test-channel-workflow
                          text: "Please find the attached file:"
                          attachment:
                            filename: 'file.txt'
                            content: "Hello\nWorld!"
                  ```

                  **Resultado esperado:**

                  ```json
                    [
                      {
                        "threadTs": "1718897637.400609",
                        "channelID": "C063JK1RHN1"
                        "success": true
                      }
                    ]
                  ```
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="slack-chat-getreactions" title="Receba uma reação a uma mensagem do canal do Slack.">
    Receba uma reação a uma mensagem de um canal do Slack.

    <Tabs>
      <TabsBar>
        <TabsBarItem id="chatgetreactionsinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="chatgetreactionsoutputs">
          Saídas
        </TabsBarItem>

        <TabsBarItem id="chatgetreactionsexample">
          Exemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="chatgetreactionsinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidade
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Descrição
                </th>

                <th>
                  Exemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **token**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Segredo
                </td>

                <td>
                  O token do bot do Slack a ser usado. Isso deve ser passado como uma sintaxe secreta. Consulte 

                  [Adicionar configuração do Slack](#slack-configuration)

                   para obter instruções sobre como configurar um token.
                </td>

                <td>
                  `${{ :secrets:slackToken }}`
                </td>
              </tr>

              <tr>
                <td>
                  **ID do canal**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  O ID do canal, para obter as reações às mensagens. Consulte 

                  [o método`reactions.get`](https://docs.slack.dev/reference/methods/reactions.get/#arg_channel)
                </td>

                <td>
                  `C063JK1RHN1`
                </td>
              </tr>

              <tr>
                <td>
                  **Tempo esgotado**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Interno
                </td>

                <td>
                  O tempo em segundos que se deve esperar por qualquer reação. O valor padrão é 60 segundos, o máximo permitido é 600 segundos (10 minutos).
                </td>

                <td>
                  60
                </td>
              </tr>

              <tr>
                <td>
                  **threadTs**
                </td>

                <td>
                  Obrigatório
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Carimbo de data/hora pertencente à mensagem, usado para obter a reação a essa mensagem.
                </td>

                <td>
                  `<digits>.<digits>`
                </td>
              </tr>

              <tr>
                <td>
                  **seletores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  Os seletores permitem obter como saída apenas o parâmetro especificado.
                </td>

                <td>
                  `[{\"name\": \"reactions\", \"expression\": \".reactions \"}]`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="chatgetreactionsoutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de saída
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Descrição
                </th>

                <th>
                  Exemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **reações**
                </td>

                <td>
                  Lista
                </td>

                <td>
                  Lista de elementos com todas as reações registradas ou uma lista vazia caso tenha ocorrido um tempo limite.
                </td>

                <td>
                  `<list>`
                </td>
              </tr>

              <tr>
                <td>
                  **sucesso**
                </td>

                <td>
                  Boleano
                </td>

                <td>
                  Estado da solicitação
                </td>

                <td>
                  `true / false`
                </td>
              </tr>

              <tr>
                <td>
                  **mensagem de erro**
                </td>

                <td>
                  Corda
                </td>

                <td>
                  Motivo da falha conforme mensagem
                </td>

                <td>
                  `Invalid slack token`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="chatgetreactionsexample">
          **Exemplo 1: Slack recebe reações**

          <table>
            <thead>
              <tr>
                <th>
                  Exemplo de fluxo de trabalho
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  ```yaml
                    name: GetReactions

                    steps:
                        - name: getReactions
                        type: action
                        action: slack.chat.getReactions
                        version: 1
                        inputs:
                          token: ${{ :secrets:dn_staging_slack_token }}
                          channelID: ${{ .steps.promptUser.outputs.channelID }}
                          threadTs: ${{ .steps.promptUser.outputs.threadTs }}
                          timeout: ${{ .workflowInputs.timeout }}
                          selectors: ${{ .workflowInputs.selectors }}
                  ```

                  **Entradas:**

                  ```json
                    {
                      "inputs": [
                        {
                          "key" : "channelID",
                          "value" : "C063JK1RHN1"
                        },
                        {
                          "key" : "threadTs",
                          "value" : "1718897637.400609"
                        },
                        {
                          "key" : "selectors",
                          "value" : "[{\"name\": \"reactions\", \"expression\": \".reactions \"}]"
                        }
                      ]
                    }
                  ```

                  **Resultados:**

                  ```json
                    [
                                {
                                    "name": "grinning",
                                    "users": [
                                        "W222222"
                                    ],
                                    "count": 1
                                },
                                {
                                    "name": "question",
                                    "users": [
                                        "W333333"
                                    ],
                                    "count": 1
                                }
                            ]

                    or if it is timed out,
                    []
                  ```
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>