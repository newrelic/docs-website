---
title: API AWS Execute
tags:
  - workflow automation
  - workflow
  - workflow automation actions
  - AWS actions
  - AWS Execute API
metaDescription: A list of available aws execute api in the actions catalog for workflow definitions
freshnessValidatedDate: never
translationType: machine
---

<Callout title="visualização">
  Ainda estamos trabalhando nesse recurso, mas adoraríamos que você experimentasse!

  Atualmente, esse recurso é fornecido como parte de um programa de visualização de acordo com nossas [políticas de pré-lançamento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Esta página fornece uma referência completa para a API de execução da AWS disponível no catálogo de ações de automação de fluxo de trabalho. Essas ações permitem que você execute qualquer operação da API da AWS.

## Pré-requisitos

Antes de usar as ações AWS na automação do fluxo de trabalho, certifique-se de ter:

* Uma conta da AWS com as permissões apropriadas.
* Credenciais da AWS configuradas (credenciais de usuário do IAM, ARN da função do IAM ou credenciais de sessão).
* As permissões IAM necessárias para os serviços específicos da AWS que você planeja usar.

Consulte [Configurar credenciais AWS ](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/)para obter informações sobre como criar usuários e funções do IAM e configurar credenciais estáticas e de sessão AWS para integração com as ações de automação de fluxo de trabalho AWS.

## Configuração de segurança e IAM

Para usar essa ação, você precisa configurar as credenciais da AWS. Consulte [Configurar credenciais da AWS](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/) para obter instruções detalhadas sobre como criar uma função ou um usuário do IAM.

<Callout variant="important">
  **Práticas de segurança recomendadas:** Ao definir políticas de IAM para esta ação, utilize sempre o princípio do menor privilégio. Conceda apenas as ações específicas da API da AWS que seu fluxo de trabalho exige e restrinja as permissões a recursos específicos em vez de usar curingas.
</Callout>

## Permissões IAM necessárias

As permissões necessárias dependem dos serviços da AWS e das APIs que seu fluxo de trabalho utiliza. Utilize os exemplos abaixo como modelos para criar políticas de privilégio mínimo.

**Exemplo 1: Enviar mensagens para uma fila SQS específica**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "sqs:SendMessage",
        "Resource": "arn:aws:sqs:us-west-2:<your-aws-account-id>:<your-queue-name>"
      }
    ]
  }
```

**Exemplo 2: consultar uma tabela específica do DynamoDB**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "dynamodb:Query",
        "Resource": "arn:aws:dynamodb:us-west-2:<your-aws-account-id>:table/<your-table-name>"
      }
    ]
  }
```

**Exemplo 3: Vários serviços com permissões específicas**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "sqs:SendMessage",
        "Resource": "arn:aws:sqs:us-west-2:<your-aws-account-id>:<your-queue-name>"
      },
      {
        "Effect": "Allow",
        "Action": "dynamodb:Query",
        "Resource": "arn:aws:dynamodb:us-west-2:<your-aws-account-id>:table/<your-table-name>"
      }
    ]
  }
```

<Callout variant="important">
  * Substitua `<your-aws-account-id>`, `<your-queue-name>` e `<your-table-name>` pelos seus valores reais.
  * Encontre os serviços disponíveis das APIs da AWS na [documentação do Boto3.](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/index.html)
  * Para padrões de política do IAM mais complexos, consulte a [documentação do AWS IAM.](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html)
</Callout>

Para obter mais informações sobre como essa ação funciona, consulte a [documentação do AWS Systems Manager executeAwsApi](https://docs.aws.amazon.com/systems-manager/latest/userguide/automation-action-executeAwsApi.html).

## Inicie uma chamada para uma API da AWS. [#aws-execute-api]

Execute qualquer operação da API da AWS para um serviço específico. Ele permite fornecer credenciais AWS, região, nome do serviço, nome API e parâmetros opcionais. A ação pode retornar resultados como status de sucesso, dados de resposta e mensagem de erro, tornando-a versátil para interagir programaticamente com os serviços da AWS.

<Tabs>
  <TabsBar>
    <TabsBarItem id="awsexecuteinputs">
      Entradas
    </TabsBarItem>

    <TabsBarItem id="awsexecuteoutputs">
      Saídas
    </TabsBarItem>

    <TabsBarItem id="awsexecuteexamples">
      Exemplo
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="awsexecuteinputs">
      <table>
        <thead>
          <tr>
            <th>
              Campo de entrada
            </th>

            <th>
              Opcionalidade
            </th>

            <th>
              Tipo
            </th>

            <th>
              Exemplo
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
              **awsRoleArn**
            </td>

            <td>
              Opcional
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              arn:aws:iam::123456789012:role/my-workflow-role
              ```
            </td>
          </tr>

          <tr>
            <td>
              **awsAccessKeyId**
            </td>

            <td>
              Opcional
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              ${{ :secrets:<awsAccessKeyId> }}
              ```
            </td>
          </tr>

          <tr>
            <td>
              **awsSecretAccessKey**
            </td>

            <td>
              Opcional
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              ${{ :secrets:<awsSecretAccessKey> }}
              ```
            </td>
          </tr>

          <tr>
            <td>
              **awsSessionToken**
            </td>

            <td>
              Opcional
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              ${{ :secrets:<awsSessionToken> }}
              ```
            </td>
          </tr>

          <tr>
            <td>
              **região**
            </td>

            <td>
              Obrigatório
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              region: "us-east-2"
              ```
            </td>
          </tr>

          <tr>
            <td>
              **serviço**
            </td>

            <td>
              Obrigatório
            </td>

            <td>
              Corda
            </td>

            <td>
              `service: "sqs"`

              [Serviços disponíveis da AWS](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/index.html)
            </td>
          </tr>

          <tr>
            <td>
              **API**
            </td>

            <td>
              Obrigatório
            </td>

            <td>
              Corda
            </td>

            <td>
              ```yaml
              api: "create_queue"
              ```
            </td>
          </tr>

          <tr>
            <td>
              **parâmetro**
            </td>

            <td>
              Obrigatório
            </td>

            <td>
              Mapa
            </td>

            <td>
              ```yaml
              parameters: {
                  "QueueName": "dks-testing-queue",
                  "Attributes": {
                      "DelaySeconds": "0",
                      "MessageRetentionPeriod": "86400"
                  }
              }
              ```
            </td>
          </tr>

          <tr>
            <td>
              **seletores**
            </td>

            <td>
              Opcional
            </td>

            <td>
              Lista
            </td>

            <td>
              ```yaml
              [{\"name\": \"response\", \"expression\": \".response\"}, {\"name\": \"success\", \"expression\": \".success\"}, {\"name\": \"errorMessage\", \"expression\": \".errorMessage\"}]
              ```
            </td>
          </tr>
        </tbody>
      </table>
    </TabsPageItem>

    <TabsPageItem id="awsexecuteoutputs">
      <table>
        <thead>
          <tr>
            <th>
              Campo de saída
            </th>

            <th>
              Tipo
            </th>

            <th>
              Exemplo
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
              **response**
            </td>

            <td>
              Objeto
            </td>

            <td>
              `{"response":<aws api reponse>}`

               \- Cada serviço e API tem uma resposta diferente; veja, por exemplo, a 

              [resposta da consulta do DynamoDB](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb/client/query.html)

              .
            </td>
          </tr>

          <tr>
            <td>
              **sucesso**
            </td>

            <td>
              Boleano
            </td>

            <td>
              `success: true | false`
            </td>
          </tr>

          <tr>
            <td>
              **mensagem de erro**
            </td>

            <td>
              Corda
            </td>

            <td>
              `errorMessage: "User does not have permission to query DynamoDB"`
            </td>
          </tr>
        </tbody>
      </table>

      <Callout variant="important">
        * É necessário fornecer pelo menos uma das credenciais da AWS (curta, longa ou função), sendo que a função tem precedência sobre as demais.
        * Na entrada de ação, se `awsAccessKeyId` e `awsSecretAccessKey` forem fornecidos, certifique-se de que sejam credenciais estáticas de um usuário IAM.
        * Se as credenciais da sessão forem usadas, `awsAccessKeyId`, `awsSecretAccessKey` e `awsSessionToken` devem ser passados para a entrada de ação.
        * Consulte as [credenciais da AWS](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/) para obter instruções.
        * Utilize seletores para obter apenas o parâmetro especificado como saída.
      </Callout>
    </TabsPageItem>

    <TabsPageItem id="awsexecuteexamples">
      ### Exemplo: consulta uma tabela do DynamoDB

      Este exemplo demonstra como consultar uma tabela do DynamoDB usando a ação `aws.execute.api` com credenciais de sessão.

      ```yaml
      name: aws_execute_api_dynamoDB_dks

      workflowInputs:
        key:
          type: String
          defaultValue: "${{ :secrets:<aws_access_key_id> }}"
        access:
          type: String
          defaultValue: "${{ :secrets:<aws_secret_access_key? }}"
        token:
          type: String
          defaultValue: "${{ :secrets:<aws_session_token> }}"
        region:
          type: String
          defaultValue: us-east-2
        tableName:
          type: String
          defaultValue: workflow-definitions-dev
        scopedName:
          type: String
        version:
          type: String
          defaultValue: "1"

      steps:
        - name: executeApi
          type: action
          action: aws.execute.api
          version: 1
          inputs:
            awsAccessKeyId: ${{ .workflowInputs.key }}
            awsSecretAccessKey: ${{ .workflowInputs.access }}
            awsSessionToken: ${{ .workflowInputs.token }}
            region: ${{ .workflowInputs.region }}
            service: dynamodb
            api: query
            parameters:
              TableName: ${{ .workflowInputs.tableName }}
              KeyConditionExpression: "ScopedName = :scopedNameValue AND Version = :VersionValue"
              ExpressionAttributeValues:
                ":scopedNameValue":
                  S: ${{ .workflowInputs.scopedName }}
                ":VersionValue":
                  N: ${{ .workflowInputs.version }}
            selectors:
              - name: response
                expression: '.response'
              - name: errorMessage
                expression: '.errorMessage'
              - name: success
                expression: '.success'
              
            
        - name: wait
          type: wait
          seconds: 2
          
        - name: logOutput
          type: action
          action: newrelic.instrumentation.log
          version: 1
          inputs:
            message: 'The execute API message output is:${{ .steps.executeApi.outputs.response.Item }}'
            licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
        - name: logOutput1
          type: action
          action: newrelic.instrumentation.log
          version: 1
          inputs:
            message: 'does execute API have any error :${{ .steps.executeApi.outputs.errorMessage }}'
            licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
        - name: logOutput2
          type: action
          action: newrelic.instrumentation.log
          version: 1
          inputs:
            message: 'is execute successful :${{ .steps.executeApi.outputs.success }}'
            licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
      ```
    </TabsPageItem>
  </TabsPages>
</Tabs>

Para obter mais exemplos de fluxo de trabalho usando a API AWS Execute, consulte a página [Exemplos de fluxo de trabalho](/docs/workflow-automation/workflow-examples/workflow-examples).