---
title: Instrument your app with the C SDK
tags:
  - Agents
  - C SDK
  - Instrumentation
translate:
  - jp
redirects:
  - /docs/instrument-your-app-c-sdk
---

うフルユーザーと基本ユーザ2-04-2021

Cライブラリをインポートできる言語を使用して Linux上でアプリケーションをモニターするには、以下が必要です：

1. \[TEST0203]でアプリケーション `newrelic_new_app_config()`,\[TEST0203]でアプリケーション[`newrelic_init()`](https://newrelic.github.io/c-sdk/libnewrelic_8h.html#a03f07e64a51b5f0cd51caa4f28c8b6c1), \[TEST0203]でアプリケーション [`newrelic_create_app()`](https://newrelic.github.io/c-sdk/libnewrelic_8h.html#a61dd90439ae3cc5060021f6ab4701132).\[TEST0203]でアプリケーション [C SDK installation procedures](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code).
2. 本ドキュメントの説明通り、C SDKを使用して手動でトランザクションをインストゥルメントします。

\[TEST0203]でアプリケーション [web or non-web transaction](/docs/apm/transactions/intro-transactions/transactions-new-relic-apm) \[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション [**Transactions** page](/docs/apm/applications-menu/monitoring/transactions-page) \[TEST0203]でアプリケーション New Relic.\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション

## トランザクションをインストゥルメントする [#instrument-c-txn]

\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション [web or non-web transaction](/docs/apm/transactions/intro-transactions/transactions-new-relic-apm#types).

\[TEST0203]でアプリケーション `newrelic_create_app()`.\[TEST0203]でアプリケーション [C SDK\[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション [C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).

1. \[TEST0203]でアプリケーション **プリケーショ**\[TEST0203]でアン\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション

   ウェブトランザクションの場合：

   ```
   // Example code:
   <a href="https://newrelic.github.io/c-sdk/libnewrelic_8h.html#add4646ef16f4f0c9b75934cf96909655">newrelic_txn_t</a> *txn;
   /* ... */
   txn = <a href="https://newrelic.github.io/c-sdk/libnewrelic_8h.html#adbf7c1fa57482f6e0a7f291e0b5ec80f">newrelic_start_web_transaction</a>(app, "<var>NAME_YOUR_TRANSACTION</var>");
   ```

   非ウェブトランザクションの場合：

   ```
   // Example code:
   newrelic_txn_t *txn;
   /* ... */
   txn = <a href="https://newrelic.github.io/c-sdk/libnewrelic_8h.html#a88648cc287f8d7e371139dc3809b7afb">newrelic_start_non_web_transaction</a>(app, "<var>NAME_YOUR_TRANSACTION</var>");
   ```

2. `newrelic_end_transaction()` \[TEST0203]でアョン **プリケーシ** \[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション `&txn`。

## セグメントをインストゥルメントする [#segments]

\[TEST0203]でアプリケーション [segments](/docs/apm/transactions/intro-transactions/transactions-new-relic-apm#segments)\[TEST0203]でアプリケーション。セグメントをインストゥルメントすることにより、トランザクション内の個別の機能および呼び出しをモニターできます。

**セグメントの例**

チェックアウトプロセスに関連するトランザクションがあり、これは、発送情報とクレジットカード情報の両方をプロセスするものです。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

セグメントをインストゥルメントし、次のような種類の呼び出しをモニターできます：

* [External services](#external-segments) \[TEST0203]でアプリケーション。
* [Custom segments](#custom-segments)\[TEST0203]でアプリケーション。
* [Datastores](#datastore-segments) \[TEST0203]でアプリケーション。
* [Slow query traces](#slow-query-datastore) \[TEST0203]でアプリケーション。

\[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).

<CollapserGroup>
  <Collapser
    id="external-segments"
    title="外部サービスの呼び出しをインストゥルメントする"
  >
    外部サービスへの呼び出しをモニターするには、インストゥルメントされたトランザクション内の外部セグメントをインストゥルメントします。\[TEST0203]でアプリケ[**ーション**](/docs/apm/applications-menu/monitoring/transactions-page-find-specific-performance-problems)。\[TEST0203]でア**プリケー**ション。\[TEST0203]でアプリケーション。[**\[TEST0203\]でアプリケーション。**](/docs/apm/applications-menu/monitoring/external-services-page)

    外部セグメントをインストゥルメントするには、モニターしたい機能の周囲でインストゥルメンテーションを開始および停止するNew Relic機能をラップします：

    1. [Instrument a \[TEST0203\]でアプリケーション。](#instrument-c-txn).

    2. \[TEST0203]でアプリケーション。 [`newrelic_external_segment_params_t`](https://newrelic.github.io/c-sdk/structnewrelic__external__segment__params__t.html) \[TEST0203]でアプリケーション。

    3. `newrelic_start_external_segment()` \[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

    4. `newrelic_end_segment()` \[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

       \[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).
  </Collapser>

  <Collapser
    id="custom-segments"
    title="任意コードへの呼び出しをインストゥルメントする（カスタムセグメント）"
  >
    任意コードへの呼び出しをモニターするには、インストゥルメントされたトランザクション内のカスタムセグメントをインストゥルメントします。\[TEST0203]でアプ**リケーション。\[**TEST0203]でアプリケーション。[**\[TEST0203\]**でアプリケーション。](/docs/apm/applications-menu/monitoring/transactions-page-find-specific-performance-problems)

    カスタムセグメントをインストゥルメントするには、モニターしたい機能の周囲でインストゥルメンテーションを開始および停止するNew Relic機能をラップします。

    1. [Instrument a \[TEST0203\]でアプリケーション。](#instrument-c-txn).

    2. `newrelic_start_segment()`\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

    3. `newrelic_end_segment()` \[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

       \[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).
  </Collapser>

  <Collapser
    id="datastore-segments"
    title="データストアへの呼び出しをインストゥルメントする"
  >
    データストアへの呼び出しをモニターするには、インストゥルメントされたトランザクション内のデータストアセグメントをインストゥルメントします。\[TEST0203]でアプーション。 **Breakdown** でアプリケーション。 **Databases**アプリケーション。 [**Transactions** page](/docs/apm/applications-menu/monitoring/transactions-page) リケ New Relic.\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。 [`databaseDuration` ケーション。](https://docs.newrelic.com/attribute-dictionary/transaction/databaseduration) of [APM `Transaction` ーション。](/docs/insights/insights-data-sources/default-events-attributes/apm-default-event-attributes).

    データストアセグメントをインストゥルメントするには、モニターしたい機能の周囲でインストゥルメンテーションを開始および停止するNew Relic機能をラップします。

    1. [Instrument a \[TEST0203\]でアプリケーション。](#instrument-c-txn).

    2. \[TEST0203]でアプリケーション。[`newrelic_datastore_segment_params_t`](https://newrelic.github.io/c-sdk/structnewrelic__datastore__segment__params__t.html)TEST0203]でアプリケーション。

    3. \[TEST0203]で`newrelic_start_datastore_segment()`でアプリケーション。\[TEST0203]でアプリケーション。

    4. `newrelic_end_segment()` \[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。

       \[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).

       <Callout variant="tip">
         \[TEST0203]でアプリケーション\[TEST0203]でアプリケーション\[TEST0203]でアプリケーション[`newrelic_datastore_segment_config_t`](https://newrelic.github.io/c-sdk/structnewrelic__datastore__segment__config__t.html).
       </Callout>
  </Collapser>

  <Collapser
    id="slow-query-datastore"
    title="データストアセグメントの低速クエリトレースを報告する（SQLのみ）"
  >
    <Callout variant="important">
      低速クエリトレースを報告できるのは、SQLデータベースのみです。
    </Callout>

    \[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。[newrelic_app_config_t](https://newrelic.github.io/c-sdk/structnewrelic__app__config__t.html):

    1. \[TEST0203]でアプリケーション。 [`transaction_tracer.datastore_reporting.enabled`](https://newrelic.github.io/c-sdk/structnewrelic__transaction__tracer__config__t.html) \[TEST0203]でアプリケーション。 `true`.

    2. \[TEST0203]でアプリケーション。 [`transaction_tracer.datastore_reporting.threshold_us`](https://newrelic.github.io/c-sdk/structnewrelic__transaction__tracer__config__t.html).

       その後、データストアの呼び出し時間が閾値より長くかかる場合は、C SDKが低速クエリとして報告します。\[TEST0203]でアプリケーション。 [**Databases**](/docs/apm/applications-menu/monitoring/databases-page) ケーション。 [**Slow queries**](/docs/apm/applications-menu/monitoring/view-slow-query-details) \[TEST0203]でアプリケーション。

       \[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).
  </Collapser>
</CollapserGroup>

## エラーをインストゥルメントする [#errors]

\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。 [`newrelic_notice_error()`](https://newrelic.github.io/c-sdk/libnewrelic_8h.html#a02a9a959015a0ca68ce11c750f690475) \[TEST0203]でアプリケーション。

\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。 [**Error analytics** \[TEST0203\]でアプリケーション。](/docs/apm/applications-menu/error-analytics/error-analytics-manage-error-traces) \[TEST0203]でアプリケーション。 New Relic.C SDKは、エラーの総数および1分間に最大100件までのエラートレースを報告します。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。 [APM `TransactionError` events](/docs/insights/insights-data-sources/default-events-attributes/apm-default-event-attributes).

<Callout variant="tip">
  \[TEST0203]でアプリケーション。 `-rdynamic` \[TEST0203]でアプリケーション。[\[TEST0203\]でアプリケーション。](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code#compile).\[TEST0203]でアプリケーション。 `-rdynamic` \[TEST0203]でアプリケーション。
</Callout>

トランザクションのエラーをインストゥルメントするには：

1. \[TEST0203]でア[プリケーション。\[TEST020](#start-transaction)3]でアプリケーション。
2. \[TEST0203]でアプリケーション[`。[TEST0203]でアプリケーション。`](https://newrelic.github.io/c-sdk/libnewrelic_8h.html#a02a9a959015a0ca68ce11c750f690475)\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。
3. \[TEST0203]でアプリケーション。[\[TEST0203\]でアプリケーション](#end-transaction)。

\[TEST0203]でアプリケーショ [C SDK \[TEST0203\]でアプリケーション](/docs/agents/c-sdk/install-configure/install-c-sdk-compile-link-your-code) \[TEST0203]でアプリケーション[C SDK `libnewrelic.h` \[TEST0203\]でアプリケーション](https://newrelic.github.io/c-sdk/libnewrelic_8h.html).

## メトリクスのグループ化問題を回避する [#mgi]

\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。\[TEST0203]でアプリケーション。**\[TEST0203]でア**プリケーション。**MGI**\[TEST0203]でアプリケーション。アプリケーションがNew Relicに不必要に大量なデータを送信している場合、これが原因となってチャート、表、そしてレポートの有効性が損なわれることとなります。

メトリックのグループ化問題が最も起きやすいのはWebトランザクションであり、特に当てはまるのはURLに基づく命名が行われた場合です。\[TEST0203]でアプリケーション。[Metric grouping issues](/docs/agents/manage-apm-agents/troubleshooting/metric-grouping-issues).