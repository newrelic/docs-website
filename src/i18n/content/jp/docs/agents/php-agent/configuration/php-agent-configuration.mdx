---
title: PHPエージェントの設定
tags:
  - Agents
  - PHP agent
  - Configuration
metaDescription: 'New Relic PHP agent configuration: How to edit newrelic.ini config settings (like app name, slow traces, parameters, log file levels, custom frameworks).'
---

PHPエージェントには、レポートされたデータのタイプと量を微調整するための設定がいくつかあります。大半のユーザーにとっては、デフォルトの値で最善のオーバーヘッドと使用しやすさが実現されますが、特定のニーズにより設定を変更することもできます。

<Callout variant="important">
  INI設定の変更後、必ずウェブサーバーを再起動してください。再起動しないと、[すぐに有効になりません](/docs/agents/php-agent/troubleshooting/ini-settings-not-taking-effect-immediately)。
</Callout>

## 優先度の設定 [#config-options-precedence]

PHPエージェントが設定で従う優先度が、次の図に簡単に示されています。[サーバー側の設定](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration)には適用されません。PHPエージェントを使用してアプリのUIで変更できる唯一の値は、アプリのエイリアスとApdex-T値です。

![php-config-order.png](./images/php-config-cascade.png "php-config-order.png")

<figcaption>
  New RelicのPHPエージェントを使用すると、API設定は[ディレクトリごとの設定](/docs/agents/php-agent/configuration/php-directory-ini-settings)を上書きします。ディレクトリごとの設定は、`php.ini`ファイル設定を上書きします。サーバー側の設定には適用されません。
</figcaption>

## 設定ファイルの変数 [#inivar-background]

インストールの間、[`newrelic-install`](/docs/agents/php-agent/installation/newrelic-install-script)スクリプトは、作成された設定ファイルまたは編集が必要なファイルのリストについての情報を提供します。デフォルトでは、`newrelic.ini`という名前の設定ファイルを作成しようとします。

場合によっては、設定オプションを`php.ini`ファイルに追加するよう指示されます。必要な場合にのみそうしてください。どのファイルを編集する必要があるかは、PHPの特定のバージョン（1つまたは複数）が設定されているかどうかで異なります。

2つの最も一般的な設定は次のとおりです：

* 単一の`newrelic.ini`ファイルを使用する。特別のオプションなしでPHPを自分でインストールまたはコンパイルした場合、これが通常デフォルトとなります。
* すべての`.ini`ファイルについて所定のディレクトリをスキャンする。

どのファイルを編集するか分からない場合：

* コマンドラインから、`php -i`の出力を見直します。
* ブラウザで、次のスクリプトを含むページの出力を見直します：

  ```
  <?php phpinfo(); ?>
  ```
* `newrelic.ini`ファイルが表示されている場合、それを使用します。

## 変数の範囲 [#inivar-scope]

`newrelic.ini`ファイルの各変数には、定義された範囲があります。範囲は、設定をどこで確立または変更できるかを制御します。

New Relic設定でサポートされた2つの範囲は次のとおりです：

* **SYSTEM**: 値はグローバルの`newrelic.ini`ファイルでグローバルに設定されます。
* **PERDIR**: 値は[ディレクトリごと](/docs/agents/php-agent/configuration/php-directory-ini-settings)に設定されます。

それぞれ、より一般的なレベルで設定することもできます。それぞれの有効なロケーションは次のとおりです：

<table>
  <thead>
    <tr>
      <th width={275}>
        **次のものについて設定できます：**
      </th>

      <th>
        SYSTEM
      </th>

      <th>
        PERDIR
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        グローバルな`newrelic.ini`ファイルで設定します。
      </td>

      <td>
        <Icon
          style={{color: '#328787'}}
          name="fe-check"
        />
      </td>

      <td>
        <Icon
          style={{color: '#328787'}}
          name="fe-check"
        />
      </td>
    </tr>

    <tr>
      <td>
        ディレクトリごとに設定します。
      </td>

      <td/>

      <td>
        <Icon
          style={{color: '#328787'}}
          name="fe-check"
        />
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="important">
  New Relic設定では`ini_set()`を使用できません。
</Callout>

## 変数のタイプ [#inivar-type]

`newrelic.ini`ファイルの各変数には、定義されたタイプがあります。タイプは、使用する値の構文を指定します。

<table>
  <thead>
    <tr>
      <th width={100}>
        **変数のタイプ**
      </th>

      <th>
        **フォーマットと内容**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **文字列**
      </td>

      <td>
        文字列の値には、英数字とピリオドを含めることができます。値は引用符で区切られます。
      </td>
    </tr>

    <tr>
      <td>
        **ブール値**
      </td>

      <td>
        論理的な真偽設定。有効な値は次のとおりです：

        * trueまたは有効な場合：`on`、`true`、数字の`1`。
        * falseまたは無効な場合: `off`、`false`、数字の`0`。
      </td>
    </tr>

    <tr>
      <td>
        **数値**
      </td>

      <td>
        数値には、数字に加え、浮動小数を表すピリオドのみを含めることができます。別途記載がある場合を除き、すべての数字は浮動小数ではなく整数です。
      </td>
    </tr>

    <tr>
      <td>
        **期間**
      </td>

      <td>
        期間を表す、引用符で区切られた文字列の値。文字フラグを使用して、時間コンポーネントを区切ります。フラグがない場合、時間はミリ秒となります。

        * `w`\\= 週
        * `d`\\= 日
        * `h`\\= 時間
        * `m`\\= 分
        * `s`\\= 秒
        * `ms`\\= ミリ秒
        * `us`\\= マイクロ秒

        期間の例：

        * `"1w3d23h10m"`\\= 1週、3日、23時間、10分
        * `"5h30m"`\\= 5時間30分
        * `"500"`\\= 500ミリ秒
      </td>
    </tr>
  </tbody>
</table>

## 一般構成設定 [#inivar-settings]

この設定は、`newrelic.ini`ファイルで使用できます。

<CollapserGroup>
  <Collapser
    id="inivar-appname"
    title="newrelic.appname （強く推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"PHP Application"`
          </td>
        </tr>
      </tbody>
    </table>

    この設定オプションは、APMでデータがレポートされるアプリケーションの名前を設定します。当社では、混同や非意図的なデータの集計を避けるために、デフォルト名を分かりやすい名前に置き換えることを強く推奨しています。同じ名前のすべてのアプリケーションのデータはNew Relicにマージされるため、この設定は慎重に行ってください。

    ディレクトリごとの設定を含むすべてのアプリケーション命名オプションについては、[PHPアプリケーションの命名](/docs/agents/php-agent/configuration/name-your-php-application)をご覧ください。

    設定の値は、最大で3つのアプリケーション名のセミコロン区切りのリストです。リストの最初は、**主たる**アプリケーション名となります。各アカウントにつき[一意でなければなりません](/docs/apm/new-relic-apm/installation-configuration/name-your-application#app-name)。アプリケーション名は、キャッシュのキーとして使用します。[アプリに複数の名前](/docs/agents/manage-apm-agents/app-naming/use-multiple-names-app)を使用する場合、New Relicはキャッシュに最初の名前のみを使用します。よって、各アプリケーション名は、最初の要素として**一度**しか表示されません。

    <CollapserGroup>
      <Collapser
        id="cache-example"
        title="キャッシュの例"
      >
        `newrelic.appname="App1;App2"` を設定し、その後コードで`newrelic.appname="App1;App3"`を設定すると、2番目は動作しなくなります。キャッシュのため、**App1**と**App2**にレポートします。
      </Collapser>
    </CollapserGroup>

    [アプリケーション名の重複](/docs/agents/manage-apm-agents/app-naming/use-multiple-names-app)が必要な場合、共通のアプリケーション名を第二または第三の位置で設定します。例えば：`newrelic.appname="App2;App1"` and `newrelic.appname="App3;App1"`. 一例として、これはアプリケーションのスーパーセットを追跡する場合に有用です。
  </Collapser>

  <Collapser
    id="inivar-capture_params"
    title="newrelic.capture_params"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      この設定は非推奨となっており、想定どおりに動作しない場合があります。代わりに、[属性プロパティ](/docs/agents/php-agent/attributes/enable-or-disable-attributes#deprecated-properties)を使用します。
    </Callout>

    この値をプログラミングで設定するには、[`newrelic_capture_params()`](/docs/agents/php-agent/php-agent-api/newrelic_capture_params) API関数を使用します。

    機密情報をURLで直接渡す場合、これを無効にしてください。

    `true`に設定すると、トランザクショントレースでURLを介してPHPスクリプトに渡されたパラメーターの記録が有効になります（URLの`?`の後のすべて）。これは、トランザクショントレースを表示すると、**パラメーター**ドロップダウンの下に表示されます。
  </Collapser>

  <Collapser
    id="inivar-framework"
    title="newrelic.framework"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            （自動検出）
          </td>
        </tr>
      </tbody>
    </table>

    New Relic PHPエージェントは、サポートしているフレームワークを自動的に検出しますが、実験的な新バージョンを使用している、またはフレームワークをカスタマイズしている場合は、問題が発生することがあります。この設定では、エージェントに指定のフレームワークに従いトランザクションに名前を付けるよう指示するのではなく、フレームワークの自動検知が無効になります。

    `"no_framework"`を指定すると、フレームワーク関連のトランザクションのネーミングがすべて無効になります。

    次の値のいずれかを適宜しようします：

    * `"cakephp"`
    * `"codeigniter"`
    * `"drupal"`（Drupal 6および7について）
    * `"drupal8"`
    * `"joomla"`
    * `"kohana"`
    * `"laravel"`
    * `"magento"`
    * `"magento2"`
    * `"mediawiki"`
    * `"silex"`
    * `"symfony1"`
    * `"symfony2"` （Symfony 2および3について）
    * `"symfony4"`
    * `"wordpress"`
    * `"yii"`
    * `"zend"`
    * `"zend2"`（Zend Framework 2および3について）
    * `"no_framework"` （1つ検出された場合でもフレームワークなしを強制実行）

    フレームワークの自動検知に失敗した場合、このコマンドも失敗します。
  </Collapser>

  <Collapser
    id="inivar-ignored_params"
    title="newrelic.ignored_params"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      この設定は非推奨となっており、想定どおりに動作しない場合があります。代わりに、[属性プロパティ](https://docs.newrelic.co.jp/docs/agents/php-agent/attributes/enable-or-disable-attributes#deprecated-properties)を使用します。
    </Callout>

    `newrelic.ignored_params` 設定を使用して、New Relic Serversに送信されたパラメーターのリストから除外されるパラメーター名のカンマ区切りのリストを指定します。引用符で文字列の値を囲います。

    [`newrelic.capture_params`](#inivar-capture_params)でパラメーターのキャプチャを有効にした場合、New Relicによってキャプチャされたくない、またはトランザクションのトレースに表示したくない機密性の高いユーザーデータを持つパラメーターがある可能性がります。これを使用して、このデータの記録をブロックします。
  </Collapser>

  <Collapser
    id="inivar-license"
    title="newrelic.license （必須）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>

        <tr>
          <th>
            メモ：
          </th>

          <td>
            エージェントバージョン3.0で導入
          </td>
        </tr>
      </tbody>
    </table>

    使用する[New Relicライセンスキー](/docs/accounts-partnerships/accounts/account-setup/license-key)を設定します。マルチテナントシステムでは、これはディレクトリごとに設定できます。

    <Callout variant="tip">
      以前のバージョンから3.0以上にアップグレードすると、ライセンスは（理由を説明するコメントとともに）デーモン設定ファイルから削除され、ファイル`/etc/newrelic/upgrade_please.key`に保存されます。そのファイルからライセンスをコピーし、`newrelic.ini`ファイルで設定します。`upgrade_please.key`ファイルを削除します。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-loglevel"
    title="newrelic.loglevel"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"info"`
          </td>
        </tr>
      </tbody>
    </table>

    ログファイルに送信されたメッセージの詳細度を設定します。詳細の度合いが低い順の、取り得る値は次のとおりです：

    * `error`
    * `warning`
    * `info`
    * `verbose`
    * `debug`
    * `verbosedebug`

    エージェントの問題をNew Relicテクニカルサポートに報告する場合、`verbosedebug`が最も有用な設定ですが、これにより多くの情報が非常に迅速に生成されることがあるため、発生している問題の再現にかかる時間以上に、[`verbosedebug`レベルでエージェントを保存しないようにしてください](/docs/agents/php-agent/troubleshooting/generating-logs-troubleshooting-php)。

    エージェントの問題をNew Relicテクニカルサポートに報告する際、これをカスタムレベルに設定し、特定のサブシステムについてのみデバッグを有効にするよう求められる場合があります。カスタムレベルは本ドキュメントの範囲を超えています。
  </Collapser>

  <Collapser
    id="inivar-tt-detail"
    title="newrelic.transaction_tracer.detail"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            数値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            1
          </td>
        </tr>

        <tr>
          <th>
            メモ：
          </th>

          <td id="inivar-tt-top100">
            これは以前は`newrelic.transaction_tracer.top100`でした。
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレースで詳細のレベルを設定します：

    * `1`に設定すると、すべてのサーバーの呼び出しがトレースされます。
    * `0`に設定すると、トレースにはNew Relicにより内部でインストゥルメントされた呼び出しと、[`newrelic.transaction_tracer.custom`](#inivar-tt-custom)を使用してユーザーが定義した呼び出しのみが含まれます。

    デフォルトのレベル`1`は、パフォーマンスに影響を与えます。パフォーマンスを改善する必要がある場合、詳細のレベルを0に設定するようにしてください。

    すべてのサーバーの呼び出しのトレースを行っていない場合、トランザクショントレースの時間のブロックには**インストゥルメントされていない時間**とラベルが付けられ、特定の関数（エージェントにより内部で定義）のみがインストゥルメントされます。すべての呼び出しをレポートする場合でも、トレースに[インストゥルメントされない時間](/docs/agents/php-agent/troubleshooting/uninstrumented-time-traces)がある場合があります。
  </Collapser>

  <Collapser
    id="inivar-high-security"
    title="newrelic.high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    すべてのアプリケーションについて高いセキュリティを有効にします。高いセキュリティを`true`に設定すると、次の動作が有効になります:

    * newrelic-daemonが安全な接続（HTTPS）を使用している場合を除き、データはNew Relicに送信されません。PHPプロセスがnewrelic-daemonを作成する場合、`newrelic.daemon.ssl`の値にかかわらずHTTPSを使用するよう設定されます。
    * 行のクエリ文字列は、`newrelic.transaction_tracer.record_sql`の値にかかわらず収集されることはありません。
    * リクエスト属性は、`newrelic.attributes`設定にかかわらず取得されることはありません。
    * [`newrelic_add_custom_parameter`](/docs/agents/php-agent/php-agent-api/newrelic_add_custom_parameter)および[`newrelic_set_user_attributes`](/docs/agents/php-agent/php-agent-api/newrelic_set_user_attributes) API関数には影響はなく、これらの関数は`false`を返します。
    * [`newrelic_record_custom_event`](/docs/agents/php-agent/php-agent-api/newrelic_record_custom_event) API関数はイベントを[New Relic](/docs/insights/new-relic-insights/understanding-insights/new-relic-insights)に送信しません。
    * エージェントはエラーから例外メッセージを除去します。

    <Callout variant="caution">
      `newrelic.high_security`設定を変更する場合、APMユーザーインタフェースでセキュリティ設定**も**変更する必要があります。2つの設定が一致しない場合、データは収集されません。詳細については、[高いセキュリティ](/docs/subscriptions/high-security)をご覧ください。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-labels"
    title="newrelic.labels"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    [タグ](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers)を追加します。

    **タグの例**

    ```
    "Server:One;Data Center:Primary"
    ```
  </Collapser>

  <Collapser
    id="inivar-process_host-display_name"
    title="newrelic.process_host.display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    [APM UIに表示される](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name)ホスト名を設定します。設定すると、エージェントが自動的に取得するデフォルトのホスト名を上書きします。
  </Collapser>
</CollapserGroup>

## デーモンの .ini設定 [#inivar-daemon-settings]

この設定の値は、デーモン起動を制御します。デーモンの起動が必要なことをエージェントが検知すると、このオプションが、そのデーモンについて適切なコマンドラインオプションに変換されます。

これらすべての設定は、`newrelic.cfg`ファイルの設定を反映します。すべての .ini設定を1か所に保管するため、これらはここで繰り返されます。`newrelic.cfg`の各設定にではここに、 プレフィックスとして`newrelic.daemon.`が付いた相手があります。たとえば、`newrelic.cfg`の`ssl`設定は、.iniファイルの`newrelic.daemon.ssl`となります。

<Callout variant="important">
  ファイル`/etc/newrelic/newrelic.cfg`がある場合、エージェントはこの設定を無視し、デーモンを自動的に起動**しません**。
</Callout>

デーモンの起動方法および外部設定ファイルをいつ使用するかの詳細については、[PHPデーモン起動モード](/docs/agents/php-agent/installation/starting-php-daemon)をご覧ください。

<CollapserGroup>
  <Collapser
    id="inivar-daemon-app_timeout"
    title="newrelic.daemon.app_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            時間仕様文字列はたとえば、`"5m"`または`"1h20m"`となります
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"10m"`
          </td>
        </tr>
      </tbody>
    </table>

    アプリケーションが使用されていないと見なされてからの経過時間を設定します。使用されていないアプリケーションは、アプリケーションの上限250にはカウントされません。認められた単位は、`"ns"`および`"us"`、`"ms"`、`"s"`、`"m"`、`"h"`です。

    値`0`は、「タイムアウトなし」と解釈されます。これにより、新規アプリケーションが常にアプリケーションの上限250に対しカウントされ、またデーモンはアプリケーションごとに少量のメモリをオペレーティングシステムに解放できなくなります。

    **推奨事項**：New Relic Supportの要請がある場合を除き、この値は使用しないでください。時折行われるバックグラウンドトランザクションでは、間隔の2倍の値を使用してください。たとえば、1時間ごとのバックグラウンドジョブでは、タイムアウトを2時間に設定します。
  </Collapser>

  <Collapser
    id="inivar-daemon-app_timeout"
    title="newrelic.daemon.app_connect_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            時間仕様文字列はたとえば、`"1s"`または`"5m"`となります
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"0"`
          </td>
        </tr>
      </tbody>
    </table>

    アプリケーションに接続するデーモンについての、エージェントの最大の待ち時間を設定します。値が`0`の場合、エージェントはデーモンへの接続を1回しか試みません。認められた単位は、`"ns"`および`"us"`、`"ms"`、`"s"`、`"m"`、`"h"`です。

    このタイムアウトが設定されていると、デーモンがまだバックエンドに接続していない場合エージェントはただちにトランザクションを停止せず、デーモンに接続を確立する時間を許可します。

    **推奨事項**：タイムアウトを設定する場合、推奨値は`15s`です。接続に問題がある場合、エージェントはすべてのトランザクション開始時に所定のタイムアウトをブロックするため、時間のかかるバックグラウンドタスクのインストゥルメントを行っている場合にのみこのタイムアウトを設定してください。
  </Collapser>

  <Collapser
    id="inivar-daemon-auditlog"
    title="newrelic.daemon.auditlog"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    設定では、監査ログの名前を指定します。ログには、完全なURLや日付、時間、各リクエストのエンコード化されていない非圧縮データを含む、デーモンからNew Relicサーバーに送信されたすべてのデータが含まれます。

    このファイルは、デーモンのログと同じファイルとすることはできません。

    <Callout variant="important">
      この監査ログは、非常に短時間で非常に大きくなる場合があります。長期間`newrelic.daemon.auditlog`設定を使用しないようにしてください。システムアドミニストレーターがセキュリティレビューを行い、どのデータが転送されるかを正確に観察できるようにすることが、主な目的です。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-daemon-collector"
    title="newrelic.daemon.collector_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"collector.newrelic.com"`
          </td>
        </tr>
      </tbody>
    </table>

    ライセンスキーの確認およびエージェントデータの送信のためにデーモンが連絡するコレクターホストの名前とオプションのポートを設定します。

    これは単なるホスト名か、または`"hostname:port"`形式の名前とポート番号です。ポート番号を`0`に指定すると、デフォルトのポートである80を使用します。

    <Callout variant="caution">
      New Relic Supportからのガイダンスなしに、この値を変更しないでください。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-daemon-launch"
    title="newrelic.daemon.dont_launch"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            数値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントの起動前にデーモンを外部で起動したい場合、この値により、エージェントがデーモンの起動をいつ許可されるかが決まります：

    * `0`: デーモンの起動には制限はなく、エージェントはデーモンをいつでも起動できます。
    * `1`: 非コマンドライン（Apacheやphp-fpmなど）エージェントは、デーモンを起動できます。
    * `2`: コマンドラインエージェントのみが、デーモンを起動できます。
    * `3`: このエージェントはデーモンを起動することはありません。`newrelic.cfg`を介してデーモンを設定しており、エージェント以外から起動している場合、この設定を使用します。

    <Callout variant="important">
      `/etc/newrelic/newrelic.cfg`がある場合、エージェントは、エージェントを介してではなく起動スクリプトによりデーモンが起動されると仮定します。この設定は`newrelic.cfg`に影響を与えず、そこに表示されません。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-daemon-location"
    title="newrelic.daemon.location"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"/usr/bin/newrelic-daemon"`
          </td>
        </tr>
      </tbody>
    </table>

    起動可能なデーモンの名前を設定します。

    この変数は、デーモンが実行可能なファイルへのフルパスを特定します。標準パッケージを使用してNew Relicシステムがインストールされた場合、デフォルトの場所は正しいものとなります。tar配布を使用してカスタムの場所にインストールした（かつ`/usr/bin`への書き込み許可がない)場合、デーモンが別の場所にある場合があります。

    この設定はPHPにのみ関連しているため、`newrelic.cfg`ファイルには表示されません。

    <Callout variant="important">
      OpenSolarisでは、`/usr`は多くの場合読み取り専用ファイルシステムです。OpenSolarisのデフォルトのデーモンの場所は`/opt/newrelic/bin/newrelic-daemon`です。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-daemon-logfile"
    title="newrelic.daemon.logfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"/var/log/newrelic/newrelic-daemon.log"`
          </td>
        </tr>
      </tbody>
    </table>

    デーモン固有のログメッセージを記録するためのログファイルの名前を設定します。デーモンがこのファイルに書き込める必要があります。一般的には、Apacheユーザーの場合、Apache自体が起動するとデーモンが起動されるため、Apacheプロセスを実行しているユーザーがファイルに書き込みを行えることを確認してください。

    <Callout variant="caution">
      デーモンのログファイルに書き込みを行えない場合、デーモンは自動的に起動せず、データのレポートは行われません。誰がデーモンを起動できるかを制限する手段として、このファイルへの書き込み許可を使用できます。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-daemon-loglevel"
    title="newrelic.daemon.loglevel"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"info"`
          </td>
        </tr>
      </tbody>
    </table>

    New Relicのデーモンのログファイルに記録されるメッセージの詳細レベルを設定します。詳細の度合いが低い順の、取り得る値は次のとおりです：

    * `error`
    * `warning`
    * `info`
    * `debug`

    設定が詳細なほど、多くの情報を非常に迅速に生成できます。必要に応じて、問題を特定するために短期間`debug`を設定します。
  </Collapser>

  <Collapser
    id="inivar-daemon-pidfile"
    title="newrelic.daemon.pidfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            （OSにより異なります）
          </td>
        </tr>
      </tbody>
    </table>

    デーモンがプロセスID（pid）を記録するファイルの名前を設定します。

    このファイルは、デーモンがすでに実行中かどうか判断するため、デーモン起動とシャットダウンスクリプトが使用します。
  </Collapser>

  <Collapser
    id="inivar-daemon-port"
    title="newrelic.daemon.address（newrelic.daemon.portのエイリアス）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列または数字
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"@newrelic" on Linux, "/tmp/.newrelic.sock" otherwise`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="tip">
      [v9.2.0.247](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-920247)から、PHPエージェントは新たな設定である`newrelic.daemon.address`をサポートします。この設定は、`newrelic.daemon.port`のエイリアスとなるものです。New Relic PHPデーモンの場所を指定するのにも使用できます。両方の値が設定された場合、`newrelic.daemon.address`が優先されます。
    </Callout>
  </Collapser>

  <dd>
    エージェントとデーモン間の通信向けにソケットエンドポイントを設定します。

    これは4つの方法で指定できます。

    * UNIXドメインソケット（UDS）として指定されたファイルを使用するには、文字列として**絶対**パス名を記入します。これが、非Linuxシステムではデフォルトです。
    * 標準のTCPポートを使用するには、1から65534の範囲で数字を指定します。
    * 抽象ソケットを使用するには、値`@newrelic-daemon`（エージェントバージョン[5.2.0.141](https://docs.newrelic.co.jp/docs/release-notes/agent-release-notes/php-release-notes/php-agent-520141)以上で使用可能）を使用します。これが、Linuxシステムではデフォルトです。
    * 別のホストで実行しているデーモンに接続するには（[コンテナ環境](/docs/agents/php-agent/advanced-installation/install-php-agent-docker)で有用）、この値を`host:port`に設定します。ここで、`host`はホスト名またはIP、`port`は有効なポート番号を表します。IPv4とIPv6の両方がサポートされています。これは、エージェントバージョン9.2.0.247以上で使用できます。

      <Callout variant="caution">
        エージェントからデーモンに転送されたデータは暗号化**されません**。唯一の例外は、データをデーモンに送信する前に行われる[SQL難読化](https://docs.newrelic.co.jp/docs/agents/php-agent/configuration/php-agent-configuration#inivar-tt-sql)です。当社では、エージェントとデーモンとの間ではプライベートネットワーク接続のみを使用することを推奨しています（これは、エージェントとデーモンが別のホストで実行されている場合にのみ該当します）。
      </Callout>

    ポート番号を使用する場合、Unixシステムでは、ポートは1から1023の範囲にあり、デーモンはスーパーユーザーとして実行する必要があります。デーモンで標準以外のポートを使用する場合、この変数は、エージェントがデーモンとの通信に使用するポート番号も設定します。

    <Callout variant="important">
      デーモンについて`newrelic.cfg`起動メカニズムを使用している場合、この設定とそのファイルの[`アドレス`](/docs/agents/php-agent/configuration/proxy-daemon-newreliccfg-settings#cfgvar-port)設定は一致する必要があります。
    </Callout>
  </dd>

  <Collapser
    id="inivar-daemon-proxy"
    title="newrelic.daemon.proxy"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    イグレスプロキシとして使用するホストとユーザー認証情報を設定します。

    これは、New Relicデータ収集サーバーにアクセスするのにサイトでプロキシが必要な場合にのみ使用します。プロキシ設定により、次のいずれかの形態となります：

    * `hostname`
    * `hostname:port`
    * `user@hostname`
    * `user@hostname:port`
    * `user:password@hostname`
    * `user:password@hostname:port`
    * `proxytype://user:password@hostname:port`

    別の<var>proxytype</var>が指定されている場合を除き、プロキシタイプはHTTPとなります。この場合、<var>proxytype</var>は<var>http</var>または<var>socks4</var>、<var>socks4a</var>、<var>socks5</var>のうち1つとすることができます。
  </Collapser>

  <Collapser
    id="inivar-daemon-ssl"
    title="newrelic.daemon.ssl"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定はPHPエージェントバージョン8.0以上では無視され、HTTPSを常に使用してNew Relicとの通信を行います。

    PHPエージェントバージョンが8.0以前の場合、New Relicコレクターとの通信でセキュアなHTTP接続を使用するかどうかを制御します。エージェントはデフォルトでHTTPSを介してNew Relicと通信します。New Relicは、 APMとNew Relic REST APIへのすべてのトラフィックに対して[HTTPSを要求](/docs/apis/rest-api-v2/troubleshooting/301-response-rest-api-calls)します。
  </Collapser>

  <Collapser
    id="inivar-daemon-ssl-ca-bundle"
    title="newrelic.daemon.ssl_ca_bundle"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    PEM形式のCA証明書を含むファイルの場所を設定します。設定すると、このファイルの証明書を使用して、New Relicコレクターの認証を行います。大半の場合、CAバンドの設定は不要です。New Relic PHPエージェントは、必要なCA証明書とバンドルで提供されます。

    [`newrelic.daemon.ssl_ca_path`](#inivar-daemon-ssl-ca-path)も設定している場合、このファイルの証明書が最初に検索され、次に`newrelic.daemon.ssl_ca_path`ディレクトリに含まれる証明書が検索されます。

    [`newrelic.daemon.ssl`](#inivar-daemon-ssl)が`false`に設定されている場合、この設定は影響を及ぼしません。
  </Collapser>

  <Collapser
    id="inivar-daemon-ssl-ca-path"
    title="newrelic.daemon.ssl_ca_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    PEM形式の信頼されたCA証明書を含むディレクトリの場所を設定します。設定すると、このディレクトリの証明書を使用して、New Relicコレクターの認証を行います。大半の場合、CAパスの設定は不要です。New Relic PHPエージェントは、必要なCA証明書とバンドルで提供されます。

    [`newrelic.daemon.ssl_ca_bundle`](#inivar-daemon-ssl-ca-bundle)も設定している場合、これが最初に検索され、次に`newrelic.daemon.ssl_ca_path`に含まれるものが検索されます。

    [`newrelic.daemon.ssl`](#inivar-daemon-ssl)が`false`に設定されている場合、この設定は影響を及ぼしません。
  </Collapser>

  <Collapser
    id="inivar-daemon-app_timeout"
    title="newrelic.daemon.start_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            時間仕様文字列はたとえば、`"1s"`または`"5m"`となります
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"0"`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <dd>
    デーモン起動がトリガーされた後に、デーモンについてのエージェントの最大待ち時間を設定します。値を`0`にすると、エージェントが待たなくなります。認められた単位は、`"ns"`および`"us"`、`"ms"`、`"s"`、`"m"`、`"h"`です。

    指定されたタイムアウト値は、`--wait-for-port`フラグを介してデーモンに渡されます。これにより、ソケットの取得、またはタイムアウトの時間が経過するまで、デーモンの起動がブロックされます。

    **推奨事項：**タイムアウトを設定する場合、推奨値は`2s`から`5s`です。デーモンの起動に問題がある場合、エージェントはすべてのトランザクション開始時に所定のタイムアウトをブロックするため、時間のかかるバックグラウンドタスクのインストゥルメントを行っている場合にのみこのタイムアウトを設定することが推奨されます。
  </dd>
</CollapserGroup>

## トランザクショントレーサー .ini設定 [#inivar-tt-settings]

この設定の値を使用して、トランザクショントレースを制御します。

<CollapserGroup>
  <Collapser
    id="inivar-tt-custom"
    title="newrelic.transaction_tracer.custom"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    これを、ユーザー定義の関数またはインストゥルメントのメソッドの、コンマ区切りのリストに設定します。

    ```
    "<var>myfunction</var>,<var>myclass</var>::<var>method</var>,<var>otherfunction</var>"
    ```

    内部PHP関数は、カスタムトレーシングを有することはできません。

    各PERDIRファイルをカスタム関数のリストに追加できますが、すでに追加されている関数またはメソッドを削除することはできません。プログラムにより関数やインストゥルメントするメソッドを追加する場合、[`newrelic_add_custom_tracer()`](/docs/agents/php-agent/php-agent-api/newrelic_add_custom_tracer) API関数呼び出しを使用します。
  </Collapser>

  <Collapser
    id="inivar-tt-enable"
    title="newrelic.transaction_tracer.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレーサーを有効化または無効化します。

    トレーサーは、`newrelic.transaction_tracer.threshold`値により設定された、閾値より多くの時間がかかるトランザクションについて、詳細なトランザクショントレースを作成します。1収集サイクル、1アプリケーションにつき1つのトランザクショントレースのみが保存され、トランザクションは常にそのサイクルで最も遅いトランザクションとなります。

    [トランザクショントレース](/docs/apm/transactions/transaction-traces/transaction-traces)は、特定のトランザクションが遅い理由を診断するのに有用です。メモリとパフォーマンスが逼迫している場合を除き、無効には絶対にしないでください。これを有効にしてもパフォーマンスへの影響は非常に些少で、メモリの使用量が増えます。

    詳細については、[`newrelic.transaction_tracer.detail`](#inivar-tt-detail)をご覧ください。
  </Collapser>

  <Collapser
    id="inivar-tt-expenable"
    title="newrelic.transaction_tracer.explain_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    スロークエリの呼び出しについてのMySQLiおよびPDO MySQLライブラリからの説明プランを有効または無効にします。説明プランは、[`newrelic.transaction_tracer.slow_sql`](#inivar-tt-slowsql)が`true`に設定され、[`newrelic.transaction_tracer.record_sql`](#inivar-tt-sql)が`"off"`に設定**されていない**場合にのみ使用できます。
  </Collapser>

  <Collapser
    id="inivar-tt-epthreshold"
    title="newrelic.transaction_tracer.explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            期間
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"500"`
          </td>
        </tr>
      </tbody>
    </table>

    クエリが「遅い」と見なされ、[**スロークエリ**](/docs/apm/applications-menu/monitoring/databases-slow-queries-dashboard)ページの候補となる閾値を設定します。単位付きの絶対値として期間を指定します。指定がない場合、デフォルトの単位はミリ秒となります。

    **期間の例**

    * `"200ms"`
    * `"1s250ms"`
    * `"1h30m"`
    * `"750us"`
  </Collapser>

  <Collapser
    id="inivar-tt-internalfun"
    title="newrelic.transaction_tracer.internal_functions_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    内部関数（Cで書かれ、PHP標準ライブラリまたはPECLエクステンションのいずれかを通じて提供される関数）のトレーシングのサポートを有効化または無効化します有効にすると、内部関数は、PHPで書かれた関数のように[トランザクショントレース](/docs/apm/transactions/transaction-traces/introduction-transaction-traces)に表示されます。

    このオプションを有効にすると、特にPHP 5.xから多くのトレースを収集する際に、トランザクションが遅くなる場合があります。このオプションを有効にすることは、内部関数が遅いと疑われるパフォーマンス問題のデバッグを特に行う場合にのみ推奨されます。
  </Collapser>

  <Collapser
    id="inivar-tt-sql"
    title="newrelic.transaction_tracer.record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"obfuscated"`
          </td>
        </tr>
      </tbody>
    </table>

    クエリの記録方法（行う場合）を設定します。

    トランザクショントレースを内部で記録する場合、スロークエリ呼び出しのクエリ全体が記録されます。このクエリをNew Relicに送信すると、セキュリティに重大な影響が生じる場合があるため、デフォルトではすべてのデータベースステートメントは、New Relicに送信する前に難読化されます。難読化ではクエリの文字列と数字を疑問符に置換するため、可逆性はありません。値も変わるため、影響がないのは、フィールド名だけとなります。

    * 機密でないデータでテストを行っており、トランザクショントレースで生クエリを表示する必要がある場合、`"raw"`に設定します。
    * クエリを全く記録しない場合、`"off"`に設定します。

    <Callout variant="important">
      本番環境では、必ず`"obfuscated"`または`"off"`に戻してください。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-tt-slowsql"
    title="newrelic.transaction_tracer.slow_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    スロークエリ機能を有効化または無効化するには、この設定を使用します。有効化すると、次のようになります：

    * 1分当たり、1アプリケーション毎に、最も遅いデータベースクエリの上位10位を記録します。
    * クエリにつながるスタックトレースを作成します。

    この変数が`false`に設定されている、またはSQL記録が無効になっている場合、New Relicエージェントはスロークエリデータを収集しません。
  </Collapser>

  <Collapser
    id="inivar-tt-stthreshold"
    title="newrelic.transaction_tracer.stack_trace_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            期間
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            "500"
          </td>
        </tr>
      </tbody>
    </table>

    これにより、クエリを記録しているトランザクショントレースのPHPスタック全体をエージェントが記録する下限の閾値を設定します。

    単位付きの絶対値として期間を指定します。指定がない場合、デフォルトの単位はミリ秒となります。

    **期間の例**

    * `"200ms"`
    * `"1s250ms"`
    * `"1h30m"`
    * `"750us"`

    スタックトレースはメモリを消費するので、この値をあまり低く設定しないよう注意してください。[`newrelic.transaction_tracer.record_sql`](#inivar-tt-sql)が`"off"`に設定されている場合、この変数には意味はありません。
  </Collapser>

  <Collapser
    id="inivar-tt-threshold"
    title="newrelic.transaction_tracer.threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            期間
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"apdex_f"`
          </td>
        </tr>
      </tbody>
    </table>

    この変数を使用して、トランザクションがトレースの対象となる閾値を設定します。使用できる値としては次のものがあります：

    * `"apdex_f"`を使用して、閾値をアプリケーションの[apdex_t](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_t)値の4倍に設定します。詳細については、「[Apdex: ユーザー満足度の測定](/docs/apm/new-relic-apm/apdex/apdex-measuring-user-satisfaction)」をご覧ください。
    * 特定の時間閾値を設定するには、その他の期間文字列を使用します。絶対値および測定単位として、期間を指定します。指定がない場合、デフォルトの単位はミリ秒となります。

    **期間の例**

    * `"200ms"`
    * `"1s250ms"`
    * `"1h30m"`
    * `"750us"`
  </Collapser>

  <Collapser
    id="inivar-tt-gather-input-queries"
    title="newrelic.transaction_tracer.gather_input_queries"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、スロークエリおよびトランザクショントレースによるDQL入力クエリの収集を有効化または無効化します。有効にすると、スロークエリおよびトランザクショントレースとともに表示されます。
  </Collapser>

  <Collapser
    id="inivar-tt-maxsegweb"
    title="newrelic.transaction_tracer.max_segments_web"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            数値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    PHPエージェントがウェブトランザクションについて記録するセグメントの最大数を指定します。この最大値に達すると、サンプリングが行われます。

    PHPエージェントは、収集したセグメントとして、トランザクショントレースとディストリビューティッド（分散）トレースをレポートします。各セグメントは、トランザクショントレースでのメソッドや関数呼び出しを表します。この設定のデフォルト値は`0`です。これは、PHPエージェントがウェブトランザクションの間にすべてのセグメントを捕捉することを表します。トランザクション終了時に、最も優先順位の高いセグメントを組み合わせて、トランザクショントレースでレポートします。

    数十万または数百万の関数呼び出しのある、長時間実行されるPHPプロセスでは、この値を`1`より大きな値に設定すると、PHPエージェントがセグメント記録時にシステムメモリを大量に消費することがなくなります。

    セグメントのサイズは、対応するメソッド名やクラス名の長さ、メソッドが行う以後の呼び出しの数により異なります。つまり、控えめに見積もっても、1セグメント当たり400バイトとなります。PHPエージェントをセグメント捕捉につき40 MBに制限するには、この値を`100000`に設定します。この値を`2000`より低く設定すると、トランザクショントレースについてレポートされるセグメントの合計数がさらに制限されます。

    この設定はPHPウェブプロセス専用です。PHP CLIプロセスには影響はありません。CLIプロセスに制限を設定するには、`newrelic.transaction_tracer.max_segments_cli`を使用します。
  </Collapser>

  <Collapser
    id="inivar-tt-maxsegcli"
    title="newrelic.transaction_tracer.max_segments_cli"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            数値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `100000`
          </td>
        </tr>
      </tbody>
    </table>

    PHPエージェントがCLIトランザクションについて記録するセグメントの最大数を指定します。この最大値に達すると、サンプリングが行われます。

    PHPエージェントは、収集したセグメントとして、トランザクショントレースとディストリビューティッド（分散）トレースをレポートします。各セグメントは、トランザクショントレースでのメソッドや関数呼び出しを表します。この設定のデフォルト値は`0`です。これは、PHPエージェントがウェブトランザクションの間にすべてのセグメントを捕捉することを表します。トランザクション終了時に、最も優先順位の高いセグメントを組み合わせて、トランザクショントレースでレポートします。

    数十万または数百万の関数呼び出しのある、長時間実行されるPHPプロセスでは、この値を`1`より大きな値に設定すると、PHPエージェントがセグメント記録時にシステムメモリを大量に消費することがなくなります。

    セグメントのサイズは、対応するメソッド名やクラス名の長さ、メソッドが行う以後の呼び出しの数により異なります。つまり、控えめに見積もっても、1セグメント当たり400バイトとなります。PHPエージェントをセグメント捕捉につき40 MBに制限するには、この値を`100000`に設定します。この値を`2000`より低く設定すると、トランザクショントレースについてレポートされるセグメントの合計数がさらに制限されます。

    この設定はPHP CLIプロセス専用です。PHPウェブプロセスには影響はありません。ウェブプロセスに制限を設定するには、`newrelic.transaction_tracer.max_segments_web`を使用します。
  </Collapser>
</CollapserGroup>

## その他のトレーサーの .ini設定 [#inivar-misctt-settings]

この設定の値を使用して、さまざまなトレーサー機能を制御します。

<CollapserGroup>
  <Collapser
    id="inivar-cross-app-tracer-enabled"
    title="newrelic.cross_application_tracer.enabled"
  >
    <Callout variant="important">
      [ディストリビューティッド（分散）トレーシング](https://docs.newrelic.co.jp/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing)機能が利用できるようになりました。ディストリビューティッド（分散）トレーシングは[クロスアプリケーショントレーシング](/docs/traces/cross-application-traces)を改良したもので、複雑な分散システムのアクティビティを監視するのにお薦めです。
    </Callout>

    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    クロスアプリケーショントレーサーを有効化または無効化します。クロスアプリケーショントレーサーは、アプリケーション間でウェブトランザクションメトリックスとトランザクショントレースを関連付けるため、HTTPヘッダーをアウトバウンドリクエストとレスポンスに挿入します。

    アウトバウンドトレーシングとクロスアプリケーショントレーシングは同時に使用できません。PHPエージェントのデフォルト設定では、ディストリビューティッド（分散）トレーシングが無効になり、クロスアプリケーショントレーシングが有効になります。
  </Collapser>

  <Collapser
    id="inivar-distributed-enabled"
    title="newrelic.distributed_tracing_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      ディストリビューティッド（分散）トレーシングを有効にすると、[クロスアプリケーショントレーシング](#inivar-cross-app-tracer-enabled)が無効になります。有効にする前に、[移行ガイド](/docs/apm/distributed-tracing/getting-started/transition-guide-distributed-tracing)を読み、New Relicの機能への影響について理解してください。
    </Callout>

    [ディストリビューティッド（分散）トレーシング](https://docs.newrelic.co.jp/docs/agents/php-agent/features/distributed-tracing)を有効化または無効化します。エージェントのトランザクショントレーサーとディストリビューティッド（分散）トレーシング機能が有効になっている場合、エージェントはヘッダーをアウトバウンドリクエストに挿入し、ディストリビューティッド（分散）トレーシングヘッダーの着信リクエストをスキャンします。

    ```
    newrelic.transaction_tracer.enabled = true
    newrelic.distributed_tracing_enabled = true
    ```
  </Collapser>

  <Collapser
    id="inivar-dt-exclude-newrelic"
    title="newrelic.distributed_tracing_exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    アウトバウンドリクエストに添付されたNew Relicディストリビューティッド（分散）トレーシングヘッダーを除外するには、これをtrueに設定し、ディストリビューティッド（分散）トレーシング用のW3Cトレースコンテキストヘッダーにのみ依存します。これがfalseの場合、両方のタイプのヘッダーがアウトバウンドリクエストに添付されます。

    New Relicディストリビューティッド（分散）トレーシングヘッダーを使用すると、W3Cトレースコンテキストヘッダーをサポートしない古いエージェントとの相互運用が可能になります。W3Cトレースコンテキストヘッダーをサポートするエージェントバージョンは、ディストリビューティッド（分散）トレーシング用のNew Relicヘッダーよりこのヘッダーを優先します。
  </Collapser>

  <Collapser
    id="inivar-span-enabled"
    title="newrelic.span_events_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    スパンイベントは[ディストリビューティッド（分散）トレーシング](#inivar-distributed-enabled)に関してレポートされます。スパンイベントをレポートするには、[ディストリビューティッド（分散）トレーシング](https://docs.newrelic.co.jp/docs/agents/php-agent/features/distributed-tracing)が有効になっている必要があります。このオプションは、スパンイベントのレポートを有効化/無効化します。
  </Collapser>

  <Collapser
    id="inivar-inftr-host"
    title="newrelic.infinite_tracing.trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    Infinite Tracingに使用するトレースオブザーバーを設定します。空白の場合、Infinite Tracingサポートは無効になります。この場合、[ディストリビューティッド（分散）トレーシング](#inivar-distributed-enabled)とスパンイベントが有効になっている必要があります。
  </Collapser>

  <Collapser
    id="inivar-inftr-port"
    title="newrelic.infinite_tracing.trace_observer.port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `443`
          </td>
        </tr>
      </tbody>
    </table>

    Infinite Tracingトレースオブザーバーとの通信に使用するTCP/IPポートを設定します。`newrelic.infinite_tracing.trace_observer.host`が空白の場合、この設定は無視されます。この設定は通常、変更する必要はありません。
  </Collapser>

  <Collapser
    id="inivar-inftr-queue"
    title="newrelic.infinite_tracing.span_events.queue_size"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            整数（1000以上）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `100000`
          </td>
        </tr>
      </tbody>
    </table>

    Infinite Tracingトレースオブザーバーへの送信についてキューに登録可能なスパンイベントの数を設定します。エージェントは、スパンバッチ内のInfinite Tracingのスパンイベントを内部で管理します。このスパンバッチは、最大で1000スパンを保有できます。よって、スパンイベントのキューサイズは1000以下にはできません。1000以下にすると、1つのスパンバッチもキューに登録できません。1000以下のキューのサイズを指定すると、最大サイズ1000を使用します。
  </Collapser>

  <Collapser
    id="inivar-err-enabled"
    title="newrelic.error_collector.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    エラーコレクターを有効化または無効化します。有効にすると、エージェントはPHPエラーを収集し、New Relic UIにレポートします。

    エージェントは、各トランザクションについて最も重大なエラー、および1[収集サイクル](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle)当たり最大20件のエラーのみを記録します。

    <Callout variant="tip">
      APMでのエラー設定の概要については、[APMでのエラーの管理](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected)をご覧ください。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-err-db"
    title="newrelic.error_collector.record_database_errors"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [有効](#inivar-err-enabled)にすると、エージェントはMySQL関数が返したエラーを、PHPエラーとして収集します。
  </Collapser>

  <Collapser
    id="inivar-err-priority"
    title="newrelic.error_collector.prioritize_api_errors"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    [`newrelic_notice_error()`](/docs/agents/php-agent/php-agent-api/newrelic_notice_error) API関数を通じて特定されたエラーに最も高い優先度を割り当てるには、これを`true`に設定します。
  </Collapser>

  <Collapser
    id="inivar-err-ignore-exceptions"
    title="newrelic.error_collector.ignore_exceptions"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    エージェントが無視すべき完全修飾例外クラス名の、カンマ区切りのリスト。扱っていない例外が発生した場合、エージェントはリストにある各クラスについて、`$exception instanceof Class`と同様のことを行います。これらのチェックでtrueが返された場合、エージェントは例外を記録しません。

    [サポートされたPHPリリース](/docs/agents/php-agent/getting-started/php-agent-compatibility-requirements#php-release)によっては、この値は例外のレポートを**無効にする**のと等しくなります:

    * サポートされたPHP 5バージョン: `newrelic.error_collector.ignore_exceptions = Exceptions`
    * サポートされたPHP 7バージョン: `newrelic.error_collector.ignore_exceptions = Throwable`
  </Collapser>

  <Collapser
    id="inivar-err-ignore-errors"
    title="newrelic.error_collector.ignore_errors"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            整数または[PHPで定義されたエラー定数](http://php.net/manual/en/errorfunc.constants.php)のビット単位式
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    PHPエージェントの[エラーレベル](http://php.net/manual/en/errorfunc.constants.php)を**ignore**に設定します。この設定の値は、[PHPの`error_reporting`オプション](http://php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)と同様の構文を使用します。たとえば、PHP agentが`E_WARNING`と`E_ERROR`レベルエラーを無視するよう設定するには、次のものを使用します:

    `newrelic.error_collector.ignore_errors = E_WARNING | E_ERROR`

    または

    `newrelic.error_collector.ignore_errors = 3`

    PHPエージェントを使用して`E_WARNING`以外のすべてを無視するよう設定するには、次のものを使用します:

    `newrelic.error_collector.ignore_errors = E_ALL & ~E_WARNING`
  </Collapser>

  <Collapser
    id="inivar-framework-drupal-modules"
    title="newrelic.framework.drupal.modules"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            メモ：
          </th>

          <td>
            バージョン3.0以前のエージェントでは、この値のデフォルトは`false`でした。このオプションを設定すると、`newrelic.transaction_tracer.detail = 1`となりました。
          </td>
        </tr>
      </tbody>
    </table>

    Drupalモジュールトラッキングを有効にするには、これを`true`に設定します。このオプションのパフォーマンスへの影響は、[`newrelic.transaction_tracer.detail`](#inivar-tt-detail)と同じです。Drupalモジュール関数と呼び出し数の記録が有効になり、ウェブトランザクションのように**Modules**タブの下に表示されます。
  </Collapser>

  <Collapser
    id="inivar-framework-wordpress-hooks"
    title="newrelic.framework.wordpress.hooks"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    WordPressフックトラッキングを有効にするには、これを`true`に設定します。WordPressフックやプラグイン、テーマの記録が有効になり、 New Relic UIの[**WordPress**](/docs/agents/php-agent/frameworks-libraries/wordpress-specific-functionality)タブの下に表示されます。
  </Collapser>

  <Collapser
    id="inivar-wt-files"
    title="newrelic.webtransaction.name.files"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    ファイル名を使用してウェブトランザクションに名前を付ける場合を除き、これは[`newrelic.webtransaction.name.functions`](#inivar-wt-funcs)と同じです。ファイル名は、PCREで使用する標準のPOSIX正規表現にできます。たとえば、`"controllers/actions/.*"`のようになります。
  </Collapser>

  <Collapser
    id="inivar-wt-funcs"
    title="newrelic.webtransaction.name.functions"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    New RelicエージェントがDrupalやWordpressなど特定のフレームワークを検知する場合を除き、最初のPHPファイルの後でウェブトランザクションに名前が付けられます。たとえば、`article.php`のようになります。

    最初のファイルがディスパッチャーの場合、この命名スキームでは有用性の低いデータが生成されます。この変数を使用して、ディスパッチャーが生成した「アクション」である関数のリストを指定します。ウェブトランザクションの名前は、実行した最初のアクション関数となります。

    **ディスパッチ関数命名の例**

    `index.php`が次の名前の関数にディスパッチを行う場合:

    * login、
    * logout、
    * admin、
    * show、および
    * 編集

    この値を`"login,logout,admin,show,edit"`に設定します。

    ウェブトランザクションは、`/index.php`（最初のファイル名）ではなく、`login`、`logout`などと命名されます。
  </Collapser>

  <Collapser
    id="inivar-wt-remove-path"
    title="newrelic.webtransaction.name.remove_trailing_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    有効になっている場合、これにより、スクリプト名の後にあるリクエストURIの内容が削除されます。たとえば、これにより、末尾の`/xyz/zy`が`/path/to/foo.php/xyz/zy`から削除されます。
  </Collapser>

  <Collapser
    id="ini-var-dt-instance-reporting"
    title="newrelic.datastore_tracer.instance_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    `false`の場合、エージェントはデータストアインスタンスメトリックスをレポートせず、`host`や`port_path_or_id`パラメーターをトランザクションや遅いsqlトレースに追加しません。
  </Collapser>

  <Collapser
    id="ini-var-dt-database-name-reporting"
    title="newrelic.datastore_tracer.database_name_reporting.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    `false`の場合、エージェントは`database_name`パラメーターをトランザクションや遅いsqlトレースに追加しません。
  </Collapser>
</CollapserGroup>

## 属性の設定 [#inivar-attribute-settings]

このセクションには、属性の収集とレポートに影響を与える設定が一覧記載されています。

<CollapserGroup>
  <Collapser
    id="inivar-attributes-enabled"
    title="newrelic.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    PHPエージェントが生成した、または[newrelic_add_custom_parameter()](/docs/agents/php-agent/php-agent-api/newrelic_add_custom_parameter)を通じてユーザーが生成した属性の収集を有効化または無効化します。この設定は、その他すべての属性収集設定に優先します。

    詳細については、[属性を有効または無効にする](/docs/php/php-agent-enabling-and-disabling-attributes#cfg-attributes-enabled)をご覧ください。
  </Collapser>

  <Collapser
    id="inivar-attributes-enabled"
    title="newrelic.{destination}.attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            browser_monitoring.attributes.enabledについての場合を除きtrue
          </td>
        </tr>
      </tbody>
    </table>

    どの宛先が属性を受信するかを制御します。この設定は、`.include`および`.exclude`[設定](#inivar-attributes-include-exclude)を上書きします。

    使用可能な宛先の詳細については、[属性を有効または無効にする](/docs/agents/php-agent/attributes/enabling-and-disabling-attributes#properties)をご覧ください。
  </Collapser>

  <Collapser
    id="inivar-attributes-include-exclude"
    title="newrelic.attributes.{include|exclude}"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    これは、属性の宛先の細かい制御を可能にする設定オプションのファミリーです。詳細については、[属性を有効または無効にする](/docs/php/php-agent-enabling-and-disabling-attributes#cfg-attributes-include)をご覧ください。
  </Collapser>
</CollapserGroup>

## その他の .ini設定 [#inivar-rare-settings]

このセクションには、残りのnewrelic.ini設定が一覧記載されています。

<CollapserGroup>
  <Collapser
    id="inivar-enabled"
    title="newrelic.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    New Relicエージェントを有効化または無効化します。デフォルトでは、New Relic PHPエージェントはすべてのディレクトリについて有効になっています。

    ウェブサーバーに複数のサイトがあるが、PHPエージェントに特定のサイトのみを監視させたい場合：

    1. `newrelic.enabled`が、`newrelic.ini`ファイルでグローバル（システム）レベルで`true`に設定されていることを確認します。
    2. 1つ以上の特定のサイトについて、ディレクトリごと（PERDIR）に、`newrelic.enabled`を`false`に設定します。

    グローバルにエージェントを無効にする必要がある場合、`newrelic.ini`ファイルで`newrelic.enabled`の値を`false`に設定します。

    エージェントがグローバルで無効になっている場合、完全に初期化されません。重要な理由でグローバルに無効にしていると想定し、エージェントはPHPへの影響を可能な限りゼロに近くしようとします。

    <Callout variant="important">
      エージェントをグローバルで無効にしてから、`.htaccess`を使用してディレクトリごとに選択的に有効にすることはできません。
    </Callout>
  </Collapser>

  <Collapser
    id="inivar-logfile"
    title="newrelic.logfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            文字列（引用符を使用）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `"/var/log/newrelic/php_agent.log"`
          </td>
        </tr>
      </tbody>
    </table>

    ここでは、メッセージのロギング用のファイル名を特定します。これは、エージェントによる問題のデバッグに有用です。設定がどのようなものであっても、次のことを確認してください。

    * 含まれるディレクトリとファイル自体の許可が正しい。
    * PHPを実行するユーザーがファイルに書き込みを行える。通常、これはウェブサーバーと同じユーザーです。
  </Collapser>

  <Collapser
    id="inivar-analytics-events"
    title="newrelic.transaction_events.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    `true`に設定すると、エージェントは分析イベントデータを収集しレポートします。イベントデータを使用して、New Relic UIは、[ヒストグラム](/docs/applications-menu/histograms-viewing-data-distribution)や[パーセンタイル](/docs/applications-menu/percentiles-comparing-ranked-data)などの追加情報を表示できます。
  </Collapser>

  <Collapser
    id="inivar-error-events"
    title="newrelic.error_collector.capture_events"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    `true`に設定すると、エージェントはエラーイベントデータを収集しレポートします。イベントデータを使用して、New Relic UIはエラー分析を表示できます。
  </Collapser>

  <Collapser
    id="inivar-feature-flag"
    title="newrelic.feature_flag"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定により、PHPエージェント内の新規および実験的な機能が有効になります。これらのフラグを使用して、PHPエージェントの以後のバージョンでデフォルトで有効にされる予定の機能を、選択的に有効にします。
  </Collapser>

  <Collapser
    id="inivar-autorum"
    title="newrelic.browser_monitoring.auto_instrument"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    これにより、ブラウザモニタリングのためのJavaScript断片の自動挿入が有効になります。有効にすると、エージェントがヘッダーとフッターをHTML出力に挿入し、エンドユーザー体験のためページロードタイミングについてのメトリックスが生成されます。詳しくは、[PHPでのページロードタイミング](/docs/php/page-load-timing-in-php)をご覧ください。
  </Collapser>

  <Collapser
    id="inivar-autorum"
    title="newrelic.guzzle.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            PERDIR
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [New Relicとともに使用する際のGuzzleライブラリ](https://docs.newrelic.com/docs/agents/php-agent/frameworks-libraries/guzzle)のサポートを有効化または無効化します。

    * PHPエージェントのバージョン6.4またはそれ以降：この設定は、デフォルトで`true`に設定されます。
  </Collapser>

  <Collapser
    id="inivar-autorum"
    title="newrelic.preload_framework_library_detection"
  >
    <table>
      <tbody>
        <tr>
          <th>
            範囲：
          </th>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <th>
            種類：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            メモ：
          </th>

          <td>
            PHPエージェントバージョン9.4で導入
          </td>
        </tr>
      </tbody>
    </table>

    プレロードが有効になっている場合に、フレームワークとライブラリの検知が有効になります。プレロードはPHPバージョン7.4で導入されました。`newrelic.preload_framework_library_detection`は、`opcache.preload`が`php.ini`ファイルで設定されている場合にのみ有効です。
  </Collapser>
</CollapserGroup>

## その他のヘルプ

さらに支援が必要な場合は、これらのサポートと学習リソースを確認してください：

* [Explorers Hub](https://discuss.newrelic.com/)を参照して、コミュニティから支援を受け、ディスカッションに参加してください。
* [当社のサイトで回答を見つけ、サポートポータルの使用方法について学びます](/docs/using-new-relic/welcome-new-relic/get-started/find-help-use-support-portal)。
* Linux、Windows、およびmacOSのトラブルシューティングツールである[New Relic Diagnosticsを実行します](/docs/using-new-relic/cross-product-functions/troubleshooting/new-relic-diagnostics)。
* New Relicの[データセキュリティ](/docs/security)と[ライセンス](/docs/licenses)ドキュメントを見直してください。
