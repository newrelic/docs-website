---
title: 外部サービス
tags:
  - APM
  - APM UI pages
  - Monitoring
metaDescription: 'The external services page captures metric details about out-of-process services such as web services, cloud resources, or other network calls.'
translationType: machine
---

import apmExternalServiceIntro from 'images/apm_screenshot-crop_external-service-intro.webp'

外部サービス機能を使用すると、1つのサービスのアップストリームおよびダウンストリームのアクティビティを詳細に確認することができます。これらのアップストリームまたはダウンストリームの外部サービスは、あなたがインスツルメンテーションした独自のサービスの場合もあれば、トランザクションの過程で単に呼び出したサービスを指す場合もあります。外部サービスには、MemCacheやデータベースなどの一部のバックエンド・コンポーネントは含まれません。

外部サービス機能は、New Relic APM エージェントユーザーだけのものではありません。 [OpenTelemetry](/docs/more-integrations/open-source-telemetry-integrations/opentelemetry/introduction-opentelemetry-new-relic) も含まれており、分散型トレースの力を利用して、サービスのアクティビティに関する洞察を得ることができます。従来の外部サービス機能もUIのトグルで利用可能ですが、拡張された外部サービスのフルパワーをぜひお試しください。

この機能では、地図とグラフを組み合わせて提供しています。

* レイテンシーやエラーの原因を探る
* 上流の発信者に対する遅延の影響を評価する
* トランザクションレベルのパフォーマンスのレビュー
* 興味のある取引に関連するトレースを見つける

外部サービス機能を利用するには、分散型トレーシングを有効にしたAPMエージェントをインストールしたNew Relicアカウントが必要です。まだお持ちでない場合は、 [サインアップ](https://newrelic.com/signup) で無料アカウントを取得してください。

<img
  title="Screenshot showing the opening map for external services"
  alt="Screenshot showing the opening map for external services"
  src={apmExternalServiceIntro}
/>

<figcaption>
  線の太さは、サービスからアップストリームまたはダウンストリームサービスへのスループットを表します。特定のサービスを選択すると、2つのサービス間で呼び出しを行うさまざまなエンドポイントが表示されます。
</figcaption>

ここでは、外部サービスダッシュボードを使って、アプリケーションが依存するすべての依存関係やサービスを追跡する方法を短いビデオ（1分30秒）でご紹介します。

<Video
  id="903EF9MAql8"
  type="youtube"
/>

## どのような時に外部サービスを利用しますか？ [#when-to-use]

外部サービス機能は、特定のサービスの調整やトラブルシューティングのために単独で使用できるツールです。また、分散型トレースによるトラブルシューティングの出発点としても使用できます。

例えば、あなたがサービスAを担当する開発者だとします。

1. 平均応答時間が異常に長くなったというアラートが表示されます。
2. 自分のサービスを見てみると、アラートが鳴った頃に他のサービスへの通報に費やす時間が増えています。
3. 外部サービスを調べてみると、特にサービスBの呼び出し時間がアラート発生の直前に増加しています。
4. 地図上でサービスBを選択し、サービスBのトランザクションを呼び出すサービスAの個々のトランザクションのパフォーマンスを確認します。サービスAの特定のトランザクションが通常よりも遅く、サービスBの1つのトランザクションを呼び出していることに気づきます。

そして、分散したトレースを使って、より詳細に掘り下げることができます。

1. 分散したトレースにドリルダウンして、このトランザクションのコールが何か変なことをしていることをトレースで確認します。
2. サービスBのトランザクションにジャンプして、デプロイ後に遅くなったことを確認します。

## 古典的な外部サービスとの関係 [#classic-external-services]

UIトグルを使用して従来の外部サービスにアクセスすることはできますが、メインの外部サービスのUIには、分散型トレーシングからのデータが表示されます。従来の外部サービスと同様にトランザクションデータが提供されますが、拡張された外部サービスについて知っておくべき重要な点を以下に示します。

* **依存関係：** 外部サービス機能を使用するには、相互に呼び出しを行うサービスで分散型トレースを有効にする必要があります。
* **互換性：** ディストリビュートトレースは、クロスアプリケーショントレースとの下位互換性はありませんので、現在クラシックな外部サービスに依存している場合は、同じプロトコルを使用しているサービス間のコールのみを可視化することができますのでご注意ください。
* **データ：** 従来の外部サービスとは異なり、分散型トレーシングのトランザクションレベルの詳細は、メトリクスではなくサンプリングに基づいています。このサンプリングされたデータが分散型トレーシングにリンクすることで、何がトランザクションのパフォーマンスを動かしているのか、より深い洞察を得ることができるのです。

<Callout variant="tip">
  外部サービス機能は、ブラウザやモバイルデータには対応していません。
</Callout>

## 次は何ですか？ [#next]

この機能を有効にする準備ができたら、 [セットアップ手順](/docs/apm/apm-ui-pages/monitoring/external-services/external-services-setup) をご覧ください。