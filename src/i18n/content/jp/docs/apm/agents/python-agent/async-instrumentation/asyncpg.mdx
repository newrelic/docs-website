---
title: 非同期PG
tags:
  - Agents
  - Python agent
  - Async instrumentation
metaDescription: How to use New Relic's Python agent with asyncpg
freshnessValidatedDate: never
translationType: machine
---

Python エージェントは、[ PostgresSQL](https://www.postgresql.org/) の データベース[`asyncpg`](https://pypi.org/project/asyncpg/) クライアント モジュールを使用する場合のデータベース トランザクションの記録をサポートします。この機能は、データベース書き込みのタイミング、データベース書き込みの SQL ステートメント、および長いデータベース書き込みのスタックトレースをキャプチャします。

[`asyncpg`](https://pypi.org/project/asyncpg/)使用するアプリに Python エージェントを統合するための要件とヒントについて説明します。 一般的なインストール手順に戻るには、 [「Python エージェントのインストール」](/docs/agents/python-agent/installation-configuration/python-agent-installation)に進みます。

## 管理用スクリプトによる自動初期化 [#wrapper-script]

`python app.py`でアプリを起動し、Python エージェント<DNT>**version 5.20.0.149**</DNT>以上を使用する場合は、推奨される[admin スクリプト インテグレーション メソッド](/docs/agents/python-agent/installation-configuration/python-agent-installation#integration)を使用できます。例:

```sh
NEW_RELIC_CONFIG_FILE=path/to/newrelic.ini newrelic-admin run-program python path_to_app
```

## PythonエージェントAPIの使用 [#api]

[Python エージェント API](/docs/agents/python-agent/python-agent-api) を使って、任意の ASGI サーバやフレームワークを監視することができます。そのためには、 [ASGIアプリケーションのエントリーポイント](/docs/agents/python-agent/python-agent-api/asgiapplication-python-agent-api) をマークし、 [トランザクション名](/docs/agents/python-agent/python-agent-api/settransactionname-python-agent-api) を設定します。

## イベントループ診断対応 [#event-loops]

Python エージェントは、 `asyncio`イベント ループ診断をサポートしています。詳細については、「 [Python イベント ループの診断](/docs/agents/python-agent/supported-features/python-event-loop-diagnostics)」を参照してください。