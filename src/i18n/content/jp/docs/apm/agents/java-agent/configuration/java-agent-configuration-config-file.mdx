---
title: Javaエージェント設定：設定ファイル
tags:
  - Agents
  - Java agent
  - Configuration
metaDescription: 'New Relic''s Java agent config settings for APM, including transaction tracer, errors, custom instrumentation, distributed tracing, system properties, etc.'
---

New Relic Javaエージェントは、`newrelic.yml`ファイルから設定を読み取ります。デフォルトで、エージェントは、[newrelic.jar](/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#java-agent)を含む`ディレクトリ`でこのファイルを検索します。[`newrelic.config.file`](#newrelic-config-file)システムプロパティを完全修飾ファイル名に設定して、設定ファイルの場所を上書きできます。

## 設定ファイルの構成 [#Structure]

`newrelic.yml`ファイルは、次の異なる環境に対応するスタンザに分割されます:

* テスト
* 開発
* ステージング
* 本番環境（デフォルト）

New Relicは、共通するスタンザの設定を、これらの各環境に適用します。[`newrelic.environment`](#newrelic-environment)システムプロパティを環境名に設定して、デフォルトとしてその他の環境を選択できます。

<Callout variant="tip">
  [`newrelic.yml`テンプレート](/docs/java/java-agent-config-file-template)をご利用いただけます。
</Callout>

`newrelic.yml`を編集する場合、[YAML形式](https://en.wikipedia.org/wiki/YAML)に従うよう注意してください。New RelicのJavaエージェントで使用する前に、YAMLバリデータを使用して構文が正しいことを確認し、以下の規則に従ってください。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **Javaエージェント newrelic.yml**
      </th>

      <th>
        **要件**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        形式
      </td>

      <td>
        YMLファイルには、大文字と小文字の区別があります。
      </td>
    </tr>

    <tr>
      <td>
        インデント
      </td>

      <td>
        すべてのインデントは、2文字の空白にする必要があります。その他のインデントにすると、エージェントの起動時に`設定ファイルをパースできません`エラーが生じます。

        * ファイルの同じスタンザのデータは、同じレベルのインデントを使用します。
        * サブスタンザは、2つの空白を追加してインデントします。
      </td>
    </tr>

    <tr>
      <td>
        ファイルの変更
      </td>

      <td>
        変更を有効にするには、JVMホストプロセスを再起動する必要があります。

        **例外：**プロパティを`log_level`および`audit_mode`に変更しても、再起動は不要です。ブレーカーの下でのプロパティの変更では、再起動が必要です。
      </td>
    </tr>
  </tbody>
</table>

## 設定の優先順位 [#config-options-precedence]

設定ファイルで設定を上書きするには、[システムプロパティの上書き](#System_Properties)を使用します。環境によっては、[環境変数](#Environment_Variables)を使用して、設定ファイルとシステムプロパティの両方を上書きすることもできます。環境変数は主に、Herokuをサポートするために存在します。使用すると、[サーバーサイドコンフィグレーション](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration)が、その他すべての設定を上書きします。

![java-config-order.png](./images/java-config-cascade.png "java-config-order.png")

<figcaption>
  Javaエージェントでは、サーバーサイドコンフィグレーションが、その他すべての設定を上書きします。環境変数は、Javaシステムプロパティを上書きします。Javaプロパティは、お使いの`newrelic.yml`ファイルのユーザー設定を上書きします。ユーザー設定は、`newrelic.yml`デフォルト設定を上書きします。
</figcaption>

## Javaエクステンションディレクトリの設定 [#extensions-directory]

Javaエージェントは、プロセスの開始時に設定ファイルを読み込みます。ファイルのあるディレクトリを特定するには、新規のディレクトリを作成するか、既存のエクステンションディレクトリを指定します。

<CollapserGroup>
  <Collapser
    id="create-extensions-directory"
    title="extensionsディレクトリを作成する"
  >
    エクステンションディレクトリを作成するには：

    1. `newrelic.jar`と`newrelic.yml`のあるディレクトリに移動します。`extensions`という名前のディレクトリを作成します。
    2. `newrelic.yml`で、プロパティ[`extensions.dir`](#cfg-extensions-dir)が設定されていないことを確認します。
  </Collapser>

  <Collapser
    id="specify-extensions-directory"
    title="既存のextensionsディレクトリを指定する"
  >
    既存のJavaエクステンションディレクトリを使用するには：

    1. `newrelic.yml`ファイルで、`共通の`セクションを検索します。
    2. プロパティ[`extensions.dir`](#cfg-extensions-dir)を使用して、ファイルの場所を指定します。
  </Collapser>
</CollapserGroup>

## 一般構成設定 [#General]

`共通の`スタンザでこのオプションを設定します。このオプションを[上書き](#System_Properties)するには、`newrelic.config`プリフィックスの付いたシステムプロパティを使用します。

<CollapserGroup>
  <Collapser
    id="cfg-license_key"
    title="license_key（必須）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    この設定は**必須**です。お使いのNew Relicアカウントに関連付けられた[ライセンスキー](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key)を指定する必要があります。このキーは、エージェントのデータを、New Relicサービスにあるアカウントと結びつけます。
  </Collapser>

  <Collapser
    id="cfg-app_name"
    title="app_name（必須）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    この設定は**必須**です。New Relicへのデータのレポートに使用する[アプリケーション名](/docs/site/naming-your-application)を定義します。

    [`enable_auto_app_naming`](#cfg-enable_auto_app_naming)がfalseの場合、エージェントはすべてのデータをこのアプリケーションにレポートします。それ以外の場合、エージェントはバックグラウンドタスク（ウェブ以外のアプリケーションのトランザクション）のみをこのアプリケーションにレポートします。

    [複数のアプリケーション](/docs/java/multiple-application-names)にデータをレポートするには、アプリケーション名をセミコロンで区切ります。たとえば、データを**My Application**と**My Application 2**にレポートするには、以下を使用します:

    ```
    app_name: My Application;My Application 2
    ```

    アプリケーションの命名方法の詳細については、[Javaアプリケーションを命名する](/docs/agents/java-agent/configuration/name-your-java-application)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-agent_enabled"
    title="agent_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    フラグを付けてエージェントを有効にします。この設定を使用して、エージェントに実行するかどうかを強制します。
  </Collapser>

  <Collapser
    id="cfg-apdex_t"
    title="apdex_t（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            フロート
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `1.0`
          </td>
        </tr>
      </tbody>
    </table>

    アプリケーションの[Apdex](/docs/site/apdex-measuring-user-satisfaction)スコアの、秒単位での`apdex_t`閾値。Javaエージェントバージョン1.2.008以上では、`apdex_t`の値はUIで設定され、`newrelic.yml`にある値は無視されます。
  </Collapser>

  <Collapser
    id="cfg-appserver_port"
    title="appserver_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    同じマシン上の同じアプリについて、JVMを区別するための数。New Relicは[一意性を保つためにhost/portを使用している](/docs/agents/java-agent/configuration/hostname-logic-java#unique-identifier)ため、このようなスイッチを各JVMの起動引数に付けて、JVMを区別できます:

    ```
    -Dnewrelic.config.appserver_port=<var>8081</var>
    ```

    `appserver_port`を使用してJVMに名前を付け再起動すると、ドロップダウンとプロファイルインタフェースで個別に表示できるようになります。

    <Callout variant="important">
      これがNew Relicについての唯一の変更です。ホストが何らかの方法で通信を行うポートには、実際には影響はありません。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-audit_mode"
    title="audit_mode"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    New Relicに送信されたすべてのデータのエージェントログファイルへのプレーンテキストロギングを有効にします。この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。
  </Collapser>

  <Collapser
    id="ca_config_bundle"
    title="ca_bundle_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            値の形式
          </th>

          <td>
            `/path/to/ca/cert/bundle.pem`
          </td>
        </tr>
      </tbody>
    </table>

    New Relicへのセキュアな接続を確立するためにエージェントが使用するカスタムSSL証明書バンドルへのパスを指定します。カスタムSSL証明書バンドルにNew Relicに接続するのに十分な証明書が含まれていない場合は、[必要な証明書をカスタム証明書バンドル](/docs/agents/java-agent/troubleshooting/ssl-or-connection-errors-java)にマージする必要があります。
  </Collapser>

  <Collapser
    id="use_private_ssl"
    title="use_private_ssl"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    次のSSL証明書がエージェントjarにバンドルされています。

    ```
    META-INF/certs/eu-newrelic-com.pem
      META-INF/certs/eu01-nr-data-net.pem
      META-INF/certs/newrelic-com.pem
    ```

    デフォルト（`use_private_ssl: false`）では、エージェントはJDKにバンドルされているSSL証明書を使用して、New Relicまたは`ca_bundle_path`で指定されたカスタムSSL証明書バンドルへのセキュアな接続を確立します。エージェントにバンドルされているSSL証明書を使用する場合は、`use_private_ssl：true`を設定します。

    注：`ca_bundle_path`が設定されている場合、`use_private_ssl`は無視されます。
  </Collapser>

  <Collapser
    id="cfg-enable_auto_app_naming"
    title="enable_auto_app_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    各ウェブアプリについて別個に、データのレポート作成を有効にします。自動アプリネーミングのサポートを有効にするには、`true`に設定します。各ウェブアプリの名前は自動的に検知され、エージェントはそれぞれについてデータを別個にレポートします。これにより、New Relicのウェブアプリのパフォーマンスが、より詳細な粒度で分類されます。

    詳細については、[自動的なアプリケーションのネーミング](/docs/agents/java-agent/configuration/automatic-application-naming)をご覧ください。

    アプリケーションの命名方法の詳細については、[Javaアプリケーションを命名する](/docs/agents/java-agent/configuration/name-your-java-application)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-enable_auto_transaction_naming"
    title="enable_auto_transaction_naming"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    コンポーネントベースのトランザクションネーミングを有効にします。コンポーネントベースのトランザクションネーミングを有効にするには、`true`に設定します。トランザクションの名前としてウェブリクエストのURIを使用するには、`false`に設定します。詳細については、[ウェブトランザクションのネーミング](/docs/agents/java-agent/instrumentation/naming-web-transactions)をご覧ください。

    <Callout variant="caution">
      API呼び出しを実装してトランザクションに名前を付ける場合を除き、自動トランザクションネーミングを無効にすると、[メトリクスのグループ化問題](/docs/features/metric-grouping-issues)が発生する可能性が非常に高くなります。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-enable_custom_tracing"
    title="enable_custom_tracing"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [`@Trace`アノテーションを使用して](/docs/agents/java-agent/custom-instrumentation/java-instrumentation-annotation)、すべてのインストゥルメンテーションを有効にします。これを無効にすると、`@Trace`アノテーションが無視されます。
  </Collapser>

  <Collapser
    id="event_ingest_uri"
    title="event_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            [https://insights-collector.newrelic.com/v1/accounts/events](https://insights-collector.newrelic.com/v1/accounts/events)
          </td>
        </tr>
      </tbody>
    </table>

    一部のエージェント機能で使用されるイベント取り込みURI。デフォルトで米国生産取り込みエンドポイントに設定されます。他の取り込みエンドポイントにイベントを送信するように手動で設定できます（例：EU生産：[https://insights-collector.eu01.nr-data.net/v1/accounts/events](https://insights-collector.eu01.nr-data.net/v1/accounts/events)）。
  </Collapser>

  <Collapser
    id="cfg-extensions-dir"
    title="extensions.dir"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    オプションの[エクステンションディレクトリ](#extensions-directory)の場所を定義します。このプロパティを設定しない場合、エージェントは`newrelic.jar`や`newrelic.yml`と同じディレクトリで`extensions`問いいう名前のサブディレクトリを検索します。
  </Collapser>

  <Collapser
    id="cfg-enable_high_security"
    title="high_security"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    [高いセキュリティ](/docs/subscriptions/high-security)を有効にするには、このプロパティを`true`に設定し、New Relicユーザーインタフェースの高セキュリティプロパティを有効にする必要があります。高いセキュリティを有効にするとSSLがオンになり、リクエストとメッセージキューのパラメーターが収集されず、クエリを生の形式でNew Relicに送信できません。

    <Callout variant="important">
      [Javaエージェント3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480)では、SSLはデフォルトで有効になっており、これを無効にする設定オプションは非推奨となっています。[Javaエージェント4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400)では、SSLを無効にする機能は削除されています。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-insert_api_key"
    title="insert_api_key"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    アカウントの有効な[挿入APIキー](/docs/apis/get-started/intro-apis/types-new-relic-api-keys#event-insert-key)です。これは現在、エージェントによって使用されていません。
  </Collapser>

  <Collapser
    id="labels"
    title="labels"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `""`
          </td>
        </tr>
      </tbody>
    </table>

    このアプリに[タグ](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers)を添付します。

    このオプションでタグが有効になり、ラベル機能が置き換えられたことに注意してください。ここで、過去の[ラベル](/docs/new-relic-one/use-new-relic-one/core-concepts/tagging-use-tags-organize-group-what-you-monitor#labels)を引き続きクエリできます。
  </Collapser>

  <Collapser
    id="max-stack-trace-lines"
    title="max_stack_trace_lines"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `30`
          </td>
        </tr>
      </tbody>
    </table>

    各スタックトレースからエージェントが収集する行数を制限します。この値を増やすと、エージェントが使用するメモリの量とNew Relicに送信されるデータの量が増えるため、パフォーマンスに影響が生じる場合があります。
  </Collapser>

  <Collapser
    id="metric_ingest_uri"
    title="metric_ingest_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            [https://metric-api.newrelic.com/metric/v1](https://metric-api.newrelic.com/metric/v1)
          </td>
        </tr>
      </tbody>
    </table>

    一部のエージェント機能で使用されるメトリクス取り込みURI。デフォルトで米国生産取り込みエンドポイントに設定されます。メトリクスを他の取り込みエンドポイントに送信するように手動で構成できます（例：EU本番：[https://metric-api.eu.newrelic.com/metric/v1](https://metric-api.eu.newrelic.com/metric/v1)）。
  </Collapser>

  <Collapser
    id="cfg-proxy_host"
    title="proxy_host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    [New Relicコレクター](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector)への接続経路となるプロキシホスト。プロキシを使用している場合、ホスト設定が必須です。その他のプロキシ設定はオプションです。
  </Collapser>

  <Collapser
    id="cfg-proxy_password"
    title="proxy_password"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    プロキシ認証のパスワード。プロキシを使用している場合、ホスト設定が必須です。その他のプロキシ設定はオプションです。ユーザー名とパスワード設定を使用して、プロキシサーバーからのBasic Authのチャレンジの認証を行います。

    <Callout variant="important">
      Javaエージェントは、Basic（クリアテキスト）認証をサポートします。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-proxy_port"
    title="proxy_port"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `8080`
          </td>
        </tr>
      </tbody>
    </table>

    プロキシホストのポート番号。プロキシを使用している場合、ホスト設定が必須です。その他のプロキシ設定はオプションです。
  </Collapser>

  <Collapser
    id="cfg-proxy_user"
    title="proxy_user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    Basic（クリアテキスト）認証など、プロキシ認証のユーザー名。プロキシを使用している場合、ホスト設定が必須です。その他のプロキシ設定はオプションです。ユーザー名とパスワード設定を使用して、プロキシサーバーからのBasic Authのチャレンジの認証を行います。
  </Collapser>

  <Collapser
    id="cfg-proxy_scheme"
    title="proxy_scheme"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    使用したプロキシスキーム。`proxy_scheme: "https"`を設定すると、エージェントはHTTPSスキームを使用してプロキシを通じて接続できるようになります。
  </Collapser>

  <Collapser
    id="cfg-reactor-netty-errors-enabled"
    title="reactor-netty.errors.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Reactor Nettyに対してエラーが報告されたかどうか。デフォルトはfalseです。trueに設定すると、Reactor Nettyエラーがレポートされます。

    <Callout variant="important">
      [Javaエージェント6.3.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-630)以降でのみ利用可能です。

      注意：Javaエージェント6.5.0ではデフォルトがfalseに変更されました。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-send_data_on_exit"
    title="send_data_on_exit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントが直近のメトリクスデータをJVMのシャットダウンの前にNew Relicに送信できるようにするには、JVMシャットダウンの遅延を有効にします。
  </Collapser>

  <Collapser
    id="send_data_on_exit_threshold"
    title="send_data_on_exit_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `60`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントが[`send_data_on_exit`](#cfg-send_data_on_exit)設定を使用するまでの秒数。
  </Collapser>

  <Collapser
    id="cfg-send_environment_info"
    title="send_environment_info"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    JVM設定のNew Relicへのレポートを有効にします。
  </Collapser>

  <Collapser
    id="cfg-send_jvm_props"
    title="send_jvm_props"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    `true`に設定すると、JVMプロパティがNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-ssl"
    title="ssl（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    SSLに移動するには、New Relicコレクターとの接続が必要です。

    エージェントはデフォルトでHTTPSを介してNew Relicと通信します。New Relicは、 APMとNew Relic REST APIへのすべてのトラフィックに[HTTPSを要求](/docs/apis/rest-api-v2/troubleshooting/301-response-rest-api-calls)します。

    この作業は、アプリケーションコードを処理するスレッドとは非同期的に行われるので、レスポンスタイムはこの変更の影響を直接には受けません。
  </Collapser>

  <dd>
    <Callout variant="important">
      [Javaエージェント3.48.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-3480)では、SSLはデフォルトで有効になっており、これを無効にする設定オプションは非推奨となっています。[Javaエージェント4.0.0](/docs/release-notes/agent-release-notes/java-release-notes/java-agent-400)では、SSLを無効にする機能は削除されています。
    </Callout>
  </dd>

  <Collapser
    id="cfg-sync_startup"
    title="sync_startup"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントを有効にして、アプリの起動直後にNew Relicコレクターを接続します。
  </Collapser>

  <Collapser
    id="scala-futures-segment"
    title="scala_futures_as_segments"
  >
    <Callout variant="important">
      Javaエージェントの[バージョン3.44.0またはそれ以降](/docs/release-notes/agent-release-notes/java-release-notes)に適用されます。
    </Callout>

    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレースの詳細をより簡潔にするため、エージェントはScala Futuresをトランザクションセグメントとしてレポートせず、このFuturesは[トランザクションの合計時間](/docs/data-analysis/user-interface-functions/view-your-data/response-time#response-time-total-time)には寄与しません。

    `scala_futures_as_segments`を有効にすると、オーバーヘッドが増加します。Scala Futuresにトランザクションセグメントとしてレポートさせたい場合、トランザクショントレースで表示し、有効化できます:

    ```
    scala_futures_as_segments:
            enabled: true
    ```
  </Collapser>
</CollapserGroup>

## ロギングの設定 [#Logging-Configuration]

これは、一般的な設定変数の一部です。デバッグのため頻繁に微調整が行われるため、ここで分割されます。

ロギング設定変数の一部は動的であり、有効にするのにホストの再起動は不要です。たとえば、ログファイルの増加が速すぎる場合、[`log_level`](#cfg-log_level)の設定の詳細度を下げてレポートの頻度を減らすことができます。

ログのローテーションに影響を与える設定変数の優先順位は次のとおりです。

* `log_daily`が`true`の場合、その他のログローテーション設定は無視されます。
* `log_file_count`が`1`または`0`の場合、サイズ制限は無視されます。
* 最後に、エージェントは`log_limit_in_kbytes`を適用します。

増加率によっては、ログファイルのサイズが設定した値を若干超えることがあります。

<CollapserGroup>
  <Collapser
    id="cfg-log_file_count"
    title="log_daily"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    ログのローテーションを毎日行うには、`true`に設定します。ログのローテーションに影響を与えるその他の設定変数を上書きします。
  </Collapser>

  <Collapser
    id="cfg-log_file_count"
    title="log_file_count"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `1`
          </td>
        </tr>
      </tbody>
    </table>

    ログローテーションを使用する際に保存するログファイルの最大数。
  </Collapser>

  <Collapser
    id="cfg-log_file_name"
    title="log_file_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    制限のないログファイル名または標準出力に記録される文字列`STDOUT`。
  </Collapser>

  <Collapser
    id="cfg-log_file_path"
    title="log_file_path"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `newrelic.jar`がある`logs`サブディレクトリ
          </td>
        </tr>
      </tbody>
    </table>

    ログファイルのパス。

    <Callout variant="tip">
      `log_file_path`が指定されている場合、ディレクトリがすでに存在する必要があります。デフォルトの値を使用している場合、エージェントはディレクトリを作成しようとします。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-log_level"
    title="log_level"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `情報`
          </td>
        </tr>
      </tbody>
    </table>

    ログの詳細度のレベル。

    エージェントは自身のログファイルを使用して、自身のロギングをアプリケーションのロギングとは別個に保存します。詳細であるために有効なオプションは次のとおりです：

    * `off`

    * `severe`

    * `警告`

    * `情報`

    * `fine`

    * `finer`

    * `finest`

      この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。
  </Collapser>

  <Collapser
    id="cfg-log_limit_in_kbytes"
    title="log_limit_in_kbytes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    ログファイルのローテーション時の、キロバイト単位でのログファイルのサイズ。制限をなくすには、`0`に設定します。
  </Collapser>
</CollapserGroup>

## JMX

このオプションを設定するには、`jmx`スタンザを使用します。[上書き](#System_Properties)するには、`newrelic.config.jfr`プリフィックス化システムプロパティを使用します。

Javaエージェントは、JMXを使用してJVMデータを収集します。また、このエージェントは、他のトレースシステムで使用できるJMX上のリンクメタデータを公開できます。

<CollapserGroup>
  <Collapser
    id="jmx-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、すべてのJMX機能をオンまたはオフにできます。
  </Collapser>

  <Collapser
    id="jmx-linkingMetadataMBean"
    title="linkingMetadataMBean"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を有効にすると、JavaエージェントがリンクメタデータをリモートJMXに公開できるようになります。

    <Callout variant="important">
      Javaエージェントの[バージョン6.1.0以降](/docs/release-notes/agent-release-notes/java-release-notes)に適用されます。
    </Callout>
  </Collapser>
</CollapserGroup>

## JFR（リアルタイムプロファイリング）

Javaエージェントは、Java Flight Recorder（JFR）を使用して、[リアルタイムプロファイリング](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/)用の忠実度の高いJVMデータを収集します。

リアルタイムプロファイリングは、エージェントyaml内の`jfr`スタンザで設定できます。この場合、`newrelic.config.jfr`でプリフィックス化された[システムプロパティ](#System_Properties)、または `NEW_RELIC_JFR_`でプリフィックス化された[環境変数](#Environment_Variables)を使用します。

<CollapserGroup>
  <Collapser
    id="jfr-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    `true`に設定すると、[JFRを使用したリアルタイムプロファイリング](/docs/agents/java-agent/features/real-time-profiling-java-using-jfr-metrics/)が有効になります。

    <Callout variant="important">
      Javaエージェント[バージョン7.1.0](/docs/release-notes/agent-release-notes/java-release-notes)では、JFRによるリアルタイムプロファイリングはデフォルトでオンになっています。他のエージェントのバージョン7.0.0以降を使用している場合は、値を`true`に変更することでJFRをオンにすることができます。
    </Callout>
  </Collapser>

  <Collapser
    id="jfr-audit_logging"
    title="audit_logging"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    `true`に設定すると、各収集バッチ内のすべてのJFRメトリクスおよびイベントを表示する監査ログが有効になります。監査ログは非常に詳細であり、トラブルシューティングの目的にのみ使用する必要があります。

    <Callout variant="important">
      Javaエージェントの[バージョン7.0.0以降](/docs/release-notes/agent-release-notes/java-release-notes)に適用されます。
    </Callout>
  </Collapser>
</CollapserGroup>

## 属性 [#attributes]

このオプションを設定するには、`属性`スタンザを使用します。[上書き](#System_Properties)するには、`newrelic.config.attributes`プリフィックス化システムプロパティを使用します。

属性は、トランザクショントレースやトレースされたエラー、ブラウザモニタリング、トランザクションイベントについての情報を提供するキーの値のペアです。各宛先の下に、属性スタンザもあります。詳細については、[Javaエージェント属性](/docs/java/java-agent-attributes)および[属性の有効化と無効化](/docs/java/enabling-and-disabling-attributes)、[属性の例](/docs/java/attribute-examples)をご覧ください。

<CollapserGroup>
  <Collapser
    id="cfg-attributes-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、すべての属性をオンまたはオフにできます。

    <Callout variant="important">
      セキュリティ上の理由から、[カスタムインストゥルメンテーションエディタ](/docs/agents/java-agent/custom-instrumentation/custom-instrumentation-editor-instrument-ui#options)を使用してのカスタムアトリビュートの捕捉は、デフォルトで`false`に設定されています。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-attributes-include"
    title="include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性が有効になっている場合、このリストにある属性のキーはNew Relicに送信されます。カンマでリストにあるキーを区切ります。例：

    ```
    key1, key2, key3
    ```

    [エージェント属性のルール](/docs/subscriptions/agent-attributes)も参照してください。
  </Collapser>

  <Collapser
    id="cfg-attributes-exclude"
    title="exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、New Relicに送信されることはありません。カンマでリストにあるキーを区切ります。例：

    ```
    key1, key2, key3
    ```

    [エージェント属性のルール](/docs/subscriptions/agent-attributes)も参照してください。
  </Collapser>
</CollapserGroup>

## トランザクショントレーサー

このオプションは`transaction_tracer`スタンザで設定され、`newrelic.config.transaction_tracer`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

[トランザクショントレーシング](/docs/traces/transaction-traces)は、スロートランザクションについての深い情報を捕捉し、New Relicサービスに送信します。トランザクションには、発効されたクエリステートメントを含む、トランザクションの正確な呼び出しの順序が含まれます。

<Callout variant="important">
  トランザクション名の末尾に角括弧`[suffix]`を使わないでください。New Relicは名前から自動的に角括弧を除去します。代わりに、必要に応じて丸括弧`(suffix)`、またはその他の記号を使ってください。
</Callout>

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレーサーは、デフォルトで有効になっています。オフにするには、`false`に設定します。
  </Collapser>

  <Collapser
    id="tt-explain_enabled"
    title="explain_enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントがスロークエリの`EXPLAIN`プランを捕捉するかどうかを決定します。[ MySQLとPostgreSQLでのみサポートされています。](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)
  </Collapser>

  <Collapser
    id="tt-explain_threshold"
    title="explain_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            フロート
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    スロークエリと`EXPLAIN`プラン（[サポートされている場合](/docs/agents/java-agent/getting-started/compatibility-requirements-java-agent#JDBC)）の捕捉の上限となる、クエリ実行時間の秒単位の閾値。`record_sql`が`raw`または`obfuscated`に設定されている場合にのみ、スロークエリに関連します。`explain_enabled `が`true`に設定されている場合にのみ、`EXPLAIN`プランに関連します。
  </Collapser>

  <Collapser
    id="insert_sql_max_length"
    title="insert_sql_max_length"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            2000
          </td>
        </tr>
      </tbody>
    </table>

    SQLクエリ設定の文字制限。膨大な情報を含む遅いSQLクエリが多数ある場合、パフォーマンスやNew Relicでのデータ表示の速度に悪影響が及ぶ場合があります。情報とパフォーマンスの適切なバランスが見つかるまで、値を徐々に上げます。
  </Collapser>

  <Collapser
    id="tt-log_sql"
    title="log_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    New Relicへのアップロードではなく、クエリのエージェントログファイルへのロギングを有効にするには、`true`に設定します。`record_sql`モードを使用して、クエリのロギングを行います。
  </Collapser>

  <Collapser
    id="tt-record_sql"
    title="record_sql"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレーサーがオンの場合、クエリステートメントをオプションで記録できます。レコーダーには次の3つのモードがあります：

    * `off`：クエリを送信しません。
    * `raw`：クエリステートメントを元の形式で送信します。
    * `obfuscated`：数字と文字列リテラルを除去します。
  </Collapser>

  <Collapser
    id="tt-stack_based_naming"
    title="stack_based_naming（Play 2.x+のみ）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`

            Javaエージェントのバージョン3.12.1までは、`false`に変更された場合に、デフォルトで`true`に変更されました。
          </td>
        </tr>
      </tbody>
    </table>

    このオプションはPlay 2.x+専用です。Play/Scalaインストゥルメンテーションは、`Thread.getStackTrace()`を使用してトレーサーのネーミングを改善できますが、その代わりにオーバーヘッドが増加します。
  </Collapser>

  <Collapser
    id="tt-stack_trace_threshold"
    title="stack_trace_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `0.5`
          </td>
        </tr>
      </tbody>
    </table>

    SQL呼び出しからスタックトレースを収集するための閾値（秒単位）を定義します。SQLステートメントがこの閾値を超えると、エージェントが現在のスタックトレースを取得します。これは、長いSQL呼び出しの発信元を特定するのに役立ちます。
  </Collapser>

  <Collapser
    id="tt-top_n"
    title="top_n"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、さまざまなトランザクショントレースを制御します。`top_n`は、トレースを作成する一意のスロートランザクションの数を表す整数です。

    * トランザクショントレースが、アプリで実際に最も遅いトランザクションを正確に反映するようにするには、この値を**低くします**。

    * より広範なトランザクションの配列をサンプリングする場合は、値を**高くします**。

      値が0の場合、最も遅いトランザクション**のみ**がトレースされることになります。これは最適ではないと考えられていますが、1つや2つのトランザクションが常に最も遅い場合があり、同じトランザクションのトレースを繰り返し見ても、おそらくあまり意味がないと思われます。

      同じトランザクションが頻繁に最も遅い場合、`top_n`設定により、Javaエージェントで（その期間で）最も遅い`n`個のトランザクションのサンプリングを行えます。これにより、アプリケーションの知見の多様性と個数が増えます。
  </Collapser>

  <Collapser
    id="tt-transaction_threshold"
    title="transaction_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列（フロート）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションのトレースをいつ行えるかを決定するのに使用する時間閾値。トランザクションのレスポンスタイムがこの閾値を超えると、[トランザクショントレース](/docs/apm/transactions/transaction-traces/transaction-traces)が記録され、New Relicに送信されます。

    デフォルトは`apdex_f`（デフォルト）です。これにより、閾値は[「不満」](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_f)[Apdex](/docs/site/apdex-measuring-user-satisfaction)レベル（apdex_t値の4倍）に設定されます。フロート値を秒数で入力して、特定の時間閾値を設定することもできます。
  </Collapser>

  <Collapser
    id="tt-slow_query_whitelist"
    title="slow_query_whitelist（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      この設定はエージェントバージョン5.10.0では非推奨となっており、将来のエージェントバージョンでは削除されます。代わりに`collect_slow_queries_from`を使用します。
    </Callout>

    デフォルトで、[高セキュリティモード](/docs/accounts-partnerships/accounts/security/high-security)では、エージェントは[スロークエリ](/docs/apm/applications-menu/monitoring/viewing-slow-query-details)を収集できません。高セキュリティが有効になっていても、DataStaxドライバからCassandraクエリを収集するには、このオプションを有効にします。高セキュリティを使用しない場合、エージェントはスロークエリを自動的に収集します。

    DataStaxドライバ2.1.2の場合、このルールを許可リストに追加します。

    ```
    transaction_tracer:
              slow_query_whitelist:
               'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    DataStaxドライバ3.0.0の場合、このルールを許可リストに追加します。

    ```
    transaction_tracer:
              slow_query_whitelist:
               'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="tt-collect_slow_queries_from"
    title="collect_slow_queries_from"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    デフォルトで、[高セキュリティモード](/docs/accounts-partnerships/accounts/security/high-security)では、エージェントは[スロークエリ](/docs/apm/applications-menu/monitoring/viewing-slow-query-details)を収集できません。高セキュリティが有効になっていても、DataStaxドライバからCassandraクエリを収集するには、このオプションを有効にします。高セキュリティを使用しない場合、エージェントはスロークエリを自動的に収集します。

    DataStaxドライバ2.1.2の場合、このルールを許可リストに追加します。

    ```
    transaction_tracer:
              collect_slow_queries_from:
               'com.newrelic.instrumentation.cassandra-datastax-2.1.2'
    ```

    DataStaxドライバ3.0.0の場合、このルールを許可リストに追加します。

    ```
    transaction_tracer:
              collect_slow_queries_from:
               'com.newrelic.instrumentation.cassandra-datastax-3.0.0'
    ```
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、トランザクショントレースのすべての属性をオンまたはオフにできます。ルートレベルで`attributes.enabled`が`false`である場合は、このプロパティ（`transaction_tracer.attributes.enabled`）が設定されているかにかかわらず、属性がトランザクショントレースに送信されることはありません。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性がトランザクショントレースについて有効になっている場合、このリストにあるすべての属性キーが、トランザクショントレースでNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、トランザクショントレースでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-tt-token_limit"
    title="token_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            3000
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションごとに作成可能なトークンの数を制限します。この値を増やすと、エージェントが使用するメモリの量とNew Relicに送信されるデータの量が増えるため、パフォーマンスに影響が生じる場合があります。
  </Collapser>

  <Collapser
    id="cfg-tt-segment_limit"
    title="segment_limit"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            3000
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションごとに作成可能なセグメントの数を制限します。この値を増やすと、エージェントが使用するメモリの量とNew Relicに送信されるデータの量が増えるため、パフォーマンスに影響が生じる場合があります。
  </Collapser>
</CollapserGroup>

## トランザクションセグメント

`transaction_segments`スタンザで設定されたこれらのオプションは、`newrelic.config.transaction_segments`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

トランザクションセグメントは、個別の作業単位（一般的にはメソッド呼び出し）を表し、[トランザクショントレース](/docs/traces/transaction-traces)内に表示されます。

<Callout variant="important">
  トランザクションセグメント属性のフィルタリングには、[Javaエージェントバージョン4.10.0以上](/docs/agents/java-agent/installation/upgrade-java-agent)が必要です。
</Callout>

<CollapserGroup>
  <Collapser
    id="cfg-ts-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、トランザクションセグメントのすべての属性をオンまたはオフにできます。ルートレベルで`attributes.enabled`が`false`である場合は、このプロパティ（`transaction_segments.attributes.enabled`）が設定されているかにかかわらず、属性がトランザクションセグメントに送信されることはありません。
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性がトランザクションセグメントについて有効になっている場合、このリストにあるすべての属性キーが、トランザクションセグメントでNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-ts-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、トランザクションセグメントでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>
</CollapserGroup>

## ブラウザのモニタリング [#Browser_Monitoring]

これらのオプションは`browser_monitoring`スタンザで設定され、`newrelic.config.browser_monitoring`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

ブラウザモニタリングにより、ウェブサイトでユーザーが実際に体験しているパフォーマンスについての知見が得られます。これは、少量のJavacriptコードを書くページのヘッダーとフッターに挿入することで、ユーザーのブラウザがウェブページのダウンロードとレンダリングにかかる時間を測定して行われます。

<CollapserGroup>
  <Collapser
    id="bm-auto_instrument"
    title="auto_instrument"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    デフォルトでは、エージェントはコンパイルされたJSPでAPI呼び出しを自動的に挿入し、モニタリングJavaScriptをウェブページに挿入します。この動作をオフにするには、この属性を`false`に設定します。
  </Collapser>

  <Collapser
    id="bm-disabled_auto_pages"
    title="disabled_auto_pages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のカンマ区切りのリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    [`auto_instrument`](#bm-auto_instrument)が`true`の場合、デフォルトですべてのページがインストゥルメントされます。自動インストゥルメンテーションを省略するすべてのページをここに一覧表示します。このページで以後も手動インストゥルメンテーションを使用できます。

    たとえば、

    ```
    browser_monitoring:
          disabled_auto_pages: /WEB-INF/jsp/testpage_1.jsp, /WEB-INF/jsp/testpage_2.jsp
    ```
  </Collapser>

  <Collapser
    id="cfg-browser-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、ブラウザモニタリングのすべての属性をオンまたはオフにできます。これは、[クエリを行えるデータ](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data)です。`attributes.enabled`がルートレベルでfalseの場合、`browser_monitoring`の下でこのプロパティがどのように設定されているかにかかわらず、ブラウザモニタリングで属性は送信されません。
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性が`browser_monitoring`に関して有効になっている場合は、このリストにあるすべての属性キーがページビューでNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、ページビューでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>
</CollapserGroup>

## 外部トレーサー [#External_Tracer]

外部トレーシングオプションは`external_tracer`スタンザで設定され、`newrelic.config.external_tracer`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="exclude_request_uri"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、エラーとトランザクショントレースについて継続中のリクエストURIの収集を制御できます。この情報の収集を無効にするには、これをtrueに設定します。
  </Collapser>
</CollapserGroup>

## クロスアプリケーショントレーサー [#Cross_Application_Tracer]

<Callout variant="important">
  クロスアプリケーショントレースは、エージェントバージョン7.4.0では非推奨となっており、将来のエージェントバージョンでは削除されます。

  クロスアプリケーショントレーシングを使用する代わりに、[ディストリビューティッド（分散）トレーシング機能](#distributed-tracing)を使用することをお勧めします。ディストリビューティッド（分散）トレーシングはクロスアプリケーショントレーシングの機能を向上させたものであり、大規模な分散システムに適しています。
</Callout>

クロスアプリケーショントレーシングは`cross_application_tracer`スタンザで設定され、`newrelic.config.cross_application_tracer`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

[クロスアプリケーショントレーシング](/docs/apm/transactions/cross-application-traces/cross-application-tracing)は、Apache HttpClientライブラリを使用して、リクエストヘッダーとレスポンスヘッダーを外部呼び出しに追加します。これにより、他のNew Relicエージェントが監視するアプリケーションを呼び出す際のデータのパフォーマンスが向上します。

<CollapserGroup>
  <Collapser
    id="cat-enabled"
    title="有効化（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    [クロスアプリケーショントレーシング](/docs/apm/transactions/cross-application-traces/cross-application-tracing)は、デフォルトで有効になっています。オフにするには、falseに設定します。
  </Collapser>
</CollapserGroup>

## エラーコレクター [#Error_Collector]

このオプションは`error_collector`スタンザで設定され、別途注記がある場合を除き、`newrelic.config.error_collector`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。エラーコレクターは、捕捉されていない例外についての情報を取得し、New Relicに送信して表示します。

<Callout variant="tip">
  UIを介してのエラー設定の方法を含む、Javaエージェントのエラー設定の方法については、[Javaエージェントのエラー設定](/docs/agents/java-agent/configuration/java-agent-error-configuration)をご覧ください。
</Callout>

<CollapserGroup>
  <Collapser
    id="ec-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    エラー収集を有効にします。
  </Collapser>

  <Collapser
    id="ec-ignore_classes"
    title="ignore_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            完全修飾`class_name`文字列のリストを含むスタンザ。
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    指定された例外クラス名は無視され、エラー率やApdexスコアには影響はなく、またAPMにレポートされません。**システムプロパティにより指定できません。**

    この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

    たとえば、

    ```
    error_collector:
          ignore_classes:
            - "com.example.MyException"
            - "com.example.DifferentException"
    ```

    環境変数を使用して、無視する例外クラス名を一覧表示できます。

    ```
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_messages"
    title="ignore_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            完全修飾`class_name`とエラークラスごとの`メッセージ`のリストを含むスタンザ
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    エージェントが無視すべき例外クラス名を指定します。無視されたメッセージはエラー率やApdexスコアには影響を与えず、またAPMにレポートされません。次のもので構成される`yaml`ペアを含みます:

    * APMにレポートされない完全修飾例外クラス名

      AND

    * 一致する例外`メッセージ`のリスト（少なくとも1つ必要）

      例外クラス名がエラーと一致するが、メッセージは一致しない場合、そのエラーは無視**されません**。メッセージ文字列は、一致の`内容`を使用します。メッセージは自身には提供できず、必ず完全修飾クラス名とペアになっている必要があります。**システムプロパティにより指定できません。**

      この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

      たとえば、

      ```
      error_collector:
            ignore_messages:
              com.example.MyException:
                - "Some error message to ignore"
                - "Some other error message to ignore"
              com.example.DifferentException:
                - "Some different error message to ignore"
      ```

      環境変数を使用して、例外クラス名と無視するメッセージを一覧表示できます。

      ```
      NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
      ```
  </Collapser>

  <Collapser
    id="ec-ignore_status_codes"
    title="ignore_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列と範囲のカンマ区切りのリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `404`
          </td>
        </tr>
      </tbody>
    </table>

    エラーとして扱わないHTTPステータスコードの個別の範囲とダッシュ付きの範囲で構成される、カンマ区切りのリスト。

    このプロパティが`newrelic.yml`設定ファイルでコメントアウトされている場合、404ステータスコードは自動的に無視されます。[サーバー側の設定](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration)を使用する場合、無視するにはステータスコード404を指定する必要があります。

    この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

    たとえば、

    ```
    error_collector:
          ignore_status_codes: 404,507-511
    ```
  </Collapser>

  <Collapser
    id="ec-expected_classes"
    title="expected_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            完全修飾`class_name`文字列のリストを含むスタンザ
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    指定された例外クラスが、エラーをAPMにレポートする間にエラー率やApdexスコアに影響を与えないようにします。**システムプロパティにより指定できません。**

    この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

    たとえば、

    ```
    error_collector:
          expected_classes:
            - "com.example.MyException"
            - "com.example.DifferentException"
    ```

    環境変数を使用して、予想例外クラス名を一覧表示できます。

    ```
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_CLASSES="[\"com.example.MyException\", \"com.example.DifferentException\"]"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_messages"
    title="expected_messages"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            完全修飾`class_name`とエラークラスごとの`メッセージ`のリストを含むスタンザ
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    想定済みとマークされ、エラー率やApdexスコアに影響を与えないようにするための完全修飾例外クラス名と、一致する例外`メッセージ`のリストで構成される、yamlペアを含みます。後者では、少なくとも1つのメッセージが必要です。例外クラス名がエラーと一致するが、メッセージが一致しない場合、そのエラーは想定済みとマーク**されず**、エラー率やApdexスコアには影響を与えません。

    メッセージ文字列は、一致の`内容`を使用します。メッセージは自身には提供できず、必ず完全修飾クラス名とペアになっている必要があります。**システムプロパティにより指定できません。**

    この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

    たとえば、

    ```
    error_collector:
          expected_messages:
            com.example.MyException:
              - "Some expected error message"
              - "Some other expected error message"
            com.example.DifferentException:
              - "Some different expected error message"
    ```

    環境変数を使用して、予想例外クラス名とメッセージを一覧表示できます。

    ```
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES="{\"com.example.MyException\": [\"Some error message to ignore\", \"Some other error message to ignore\"], \"com.example.DifferentException\": [\"Some different error message to ignore\"]}"
    ```
  </Collapser>

  <Collapser
    id="ec-expected_status_codes"
    title="expected_status_codes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列と範囲のカンマ区切りのリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    想定済みとマークされ、エラー率やApdexスコアに影響を与えない、HTTPステータスコードの個別の範囲とダッシュ付き範囲で構成される、カンマ区切りのリスト。

    この設定は動的なので、エージェントを実行すると、JVMを再起動せずに`newrelic.yml`が変更されます。

    たとえば、

    ```
    error_collector:
          expected_status_codes: 415,500-506
    ```
  </Collapser>

  <Collapser
    id="cfg-error-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、トレースエラーのすべての属性をオンまたはオフにできます。ルートレベルで`attributes.enabled`が`false`である場合は、このプロパティが`error_collector`で設定されているかにかかわらず、属性がトレースエラーに送られることはありません。
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性がトレースエラーについて有効になっている場合、このリストにあるすべての属性キーが、トレースされたエラーでNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、トレースエラーでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="ec-ignoreErrorPriority"
    title="ignoreErrorPriority"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションで複数のエラーが検出された場合、デフォルトでは最後のエラーのみがレポートされます。このプロパティを`false`に設定すると、最初に検出されたエラーのみがレポートされます。詳細については、[noticeError API](/docs/agents/java-agent/configuration/java-agent-error-configuration/)を参照してください。例：

    ```
    error_collector:
          ignoreErrorPriority: false
    ```
  </Collapser>

  <Collapser
    id="ec-ignore_errors"
    title="ignore_errors（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のカンマ区切りのリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    指定されたすべての例外クラス名は、エラーとして扱われることはありません。Javaエージェント3.40.0で非推奨となり、[`ignore_classes`](#ec-ignore_classes)で置換されています。

    たとえば、

    ```
    error_collector:
          ignore_errors: some.other.MyException
    ```
  </Collapser>
</CollapserGroup>

## 例外の除去 [#strip_exceptions]

`strip_exception_messages`スタンザで設定されたこれらのオプションは、別途注記がある場合を除き、`newrelic.config.strip_exception_messages​`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。この設定を有効にして、Java例外メッセージをNew Relicにレポートするかどうかを制御できます。

<CollapserGroup>
  <Collapser
    id="strip_exception_messages"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    デフォルトでは、これは`false`に設定されます。つまり、エージェントはすべての例外からのメッセージを[New Relicコレクター](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector)に送信します。

    * これを`true`に設定すると、誤って機密情報を取得しないようにするため、エージェントは例外からメッセージを除去します。
    * [高セキュリティモード](/docs/agents/manage-apm-agents/configuration/high-security-mode)を有効にすると、これは自動的に`true`に設定されます。
    * `enabled`を`true`に設定するが、エージェントで特定の例外からメッセージを取得したい場合、例外を[許可リスト](#strip_exception_messages_whitelist)に追加します。
  </Collapser>

  <Collapser
    id="strip_exception_messages_whitelist"
    title="ホワイトリスト（非推奨）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      この設定はエージェントバージョン5.10.0では非推奨となっており、将来のエージェントバージョンでは削除されます。代わりに`allowed_classes`を使用します。
    </Callout>

    `enabled`を`true`に設定するが、エージェントで特定の例外のメッセージを取得したい場合、各例外をカンマで区切って`ホワイトリスト`に追加します。
  </Collapser>

  <Collapser
    id="strip_exception_messages_allowed_classes"
    title="allowed_classes"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    `enabled`を`true`に設定するが、エージェントで特定の例外のメッセージを取得したい場合、各例外をカンマで区切って`allowed_classes`に追加します。
  </Collapser>
</CollapserGroup>

## スレッドプロファイラー [#Thread_Profiler]

`thread_profiler`スタンザで設定されたこれらのオプションは、`newrelic.config.thread_profiler`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

スレッドプロファイラーは、実行時に、アプリケーションのスレッドでのウォールクロックタイムやCPU時間、メソッド呼び出し数を測定します。

<CollapserGroup>
  <Collapser
    id="tp-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    スレッドプロファイラーを有効にします。
  </Collapser>
</CollapserGroup>

## Transactionイベント [#Transaction_Events]

このオプションは`transaction_events`スタンザで設定され、`newrelic.config.transaction_events`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

トランザクションイベントは、UIでヒストグラムとパーセンタイルを表示するためのデータを提供します。

<Callout variant="important">
  以前はこのスタンザは`analytics_events`と呼ばれていました。設定ファイルで現在も`analytics_events`を使用している場合、エージェントを更新して`transaction_events`を使用します。
</Callout>

<CollapserGroup>
  <Collapser
    id="ae-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションイベントサービスを有効にします。
  </Collapser>

  <Collapser
    id="ae-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `2000`
          </td>
        </tr>

        <tr>
          <th>
            Max
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    60秒ごとにレポートされた、サンプリングされたトランザクションイベントの最大数。
  </Collapser>

  <Collapser
    id="tt-custom-request-headers"
    title="custom_request_headers"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            マップのリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            なし
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      その他の設定と異なり、`custom_request_headers`はペアにする必要があり、`newrelic.yml`ファイルで設定する必要があります。Java仮想マシン引数（システムプロパティ）や環境変数で上書きすることはできません。
    </Callout>

    ペアになったキー`header_name`とオプションの`header_aliasのあるマップのリスト。1つ以上のカスタムHTTPリクエストを選択して、トランザクション属性として追加します。`

    複数のヘッダー設定を一覧表示できます。

    ```
    transaction_events:
           custom_request_headers:
              -
                header_name: "X-Custom-Header-1"
              -
                header_name: "X-Custom-Header-2"
                header_alias: "CustomHeader2alias"
    ```

    最初のマップセットで、`X-Custom-Header-1`は、リクエストオブジェクトから対応する値のヘッダー名としてエージェントにより取得されレポートされます。`header_name`は、New Relicに送信される属性の名前ともなります。

    第二のマップセットで、リクエストヘッダーは`X-Custom-Header-2`ですが、`CustomHeader2alias`はNew Relicに送信される名前です。
  </Collapser>

  <Collapser
    id="cfg-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定を使用して、トランザクションイベントのすべての属性をオンまたはオフにできます。ルートレベルで`attributes.enabled`が`false`である場合は、このプロパティが`transaction_events`で設定されているかにかかわらず、属性がトランザクションイベントに送られることはありません。
  </Collapser>

  <Collapser
    id="cfg-te-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性がトランザクションイベントについて有効になっている場合、このリストにあるすべての属性キーが、トランザクションイベントでNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-te-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、トランザクションイベントでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>
</CollapserGroup>

## カスタムイベント [#Custom_Events]

カスタムイベントは`custom_insights_events`スタンザで設定され、`newrelic.config.custom_insights_events`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

APMでは、New Relic言語エージェントAPIにより[カスタム イベントデータを記録](/docs/insights/insights-data-sources/custom-data/insert-custom-events-new-relic-apm-agents)でき、[これをクエリすることが可能です](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data)。

<Callout variant="important">
  4.1.0より前のJavaエージェントのバージョンでは、次のYAML設定が認識されます。

  ```
  custom_insights_events.enabled: true
      custom_insights_events.max_samples_stored: 5000
  ```

  エージェントのバージョンが4.1.0以上の場合、YAML設定はネストされたスタンザフォーマットを使用します。

  ```
  custom_insights_events:
        enabled: false
        max_samples_stored: 5000
  ```
</Callout>

<CollapserGroup>
  <Collapser
    id="cie-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    これにより、カスタムイベントサービスが有効になります。
  </Collapser>

  <Collapser
    id="cie-max_samples_stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            Default/Max
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <dd>
    60秒ごとにレポートされた、サンプリングされたカスタムイベントの最大数。
  </dd>
</CollapserGroup>

## ホスト名の設定 [#hostname_configuration]

`process_host`スタンザで設定されたこれらのオプションは、`newrelic.config.process_host`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

このプロパティは、UIに表示されるホスト名の設定に使用します：

<CollapserGroup>
  <Collapser
    id="display_name"
    title="display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    [表示名](/docs/agents/java-agent/configuration/hostname-logic-java#display-name)を設定して、New Relic UIで「host:port」ラベルを追加します。
  </Collapser>

  <Collapser
    id="ae-max_samples_stored"
    title="ipv_preference"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `4`
          </td>
        </tr>
      </tbody>
    </table>

    ホスト名を決定できない場合、ホストのIPアドレスを使用します。このプロパティは、IPv4またはIPv6アドレスを使用するかどうかを決定します。デフォルトはIPv4です。
  </Collapser>
</CollapserGroup>

## カスタムインストゥルメンテーション [#Custom_Instrumentation]

`class_transformer`スタンザで設定されたこれらのオプションは、`newrelic.config.class_transformer`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

<CollapserGroup>
  <Collapser
    id="ci-trace_annotation_class_name"
    title="trace_annotation_class_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    どのユーザー指定の方法でインストゥルメントするかの決定にエージェントが使用するアノテーションクラスのフルクラス名を含む文字列。カスタムアノテーションの詳細については、[Javaカスタムメトリック収集](/docs/java/java-custom-metric-collection)をご覧ください。
  </Collapser>

  <Collapser
    id="servlet-user"
    title="com.newrelic.instrumentation.servlet-user"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    `userPrincipal`名を取得するには、このオプションを有効にします。この名前はトランザクショントレース属性として含まれ、[クエリを行うことができます](/docs/query-your-data/explore-query-data/explore-data/introduction-querying-new-relic-data)。
  </Collapser>
</CollapserGroup>

## システムプロパティ [#System_Properties]

システムプロパティを設定して、`newrelic.yml`ファイルで設定を上書きできます。設定ファイルの所定の設定に対応するシステムプロパティは、`newrelic.config`でプリフィックス化された設定名です。たとえば、`log_level`設定のシステムプロパティは`newrelic.config.log_level`です。

スタンザにネストされた設定については、スタンザ名を設定名に追加します。一例として、transaction_tracerスタンザで`有効にされた`設定のシステムプロパティは、`newrelic.config.transaction_tracer.enabled`となります。

設定の上書きに加え、次のシステムプロパティをエージェントは認識します：

<CollapserGroup>
  <Collapser
    id="newrelic-bootstrap_classpath"
    title="newrelic.config.process_host.display_name"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `(なし)`
          </td>
        </tr>
      </tbody>
    </table>

    [表示名](/docs/agents/java-agent/configuration/hostname-logic-java#display-name)を設定して、New Relic UIで「host:port」ラベルを追加します。Javaエージェント3.17以降が必要です。
  </Collapser>

  <Collapser
    id="newrelic-config-file"
    title="newrelic.config.file"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    newrelic設定ファイルへの完全修飾パスを含む文字列。空白の場合、エージェントは`newrelic.yml`が`newrelic.jar`と同じディレクトリにあると仮定します。
  </Collapser>

  <Collapser
    id="newrelic-debug"
    title="newrelic.debug"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    デバッグロギングを有効にします。
  </Collapser>

  <Collapser
    id="newrelic-environment"
    title="newrelic.environment"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    使用するエージェントの環境設定を含む文字列。
  </Collapser>

  <Collapser
    id="newrelic-home"
    title="newrelic.home"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    エージェントのホームディレクトリを含む文字列。これはデフォルトで、エージェントのjarfileと同じディレクトリになります。
  </Collapser>

  <Collapser
    id="newrelic-logfile"
    title="newrelic.logfile"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントログファイルの名前を含む文字列。
  </Collapser>
</CollapserGroup>

## 環境変数 [#Environment_Variables]

環境変数は最優先となり、システムプロパティとyml設定を上書きします。

* 環境変数を設定するには、`export VARNAME=value`コマンドを使用します。
* 環境変数を恒久的に設定するには、`~/.bashrc` or `~/.bash_profile`のようにエクスポート行をファイルに追加します。

システムプロパティから、または環境変数を設定して`newrelic.yml`で、設定を上書きできます。設定ファイルで所定の設定に対応する環境変数は、すべてのドット（`.`）とダッシュ（`-`）をアンダースコア（`_`）で置換した`NEW_RELIC`でプリフィックス化した設定名です。たとえば、`log_level`設定の環境変数は`NEW_RELIC_LOG_LEVEL`です。

スタンザにネストされた設定については、スタンザ名を設定名に追加します。一例として、`transaction_tracer`スタンザで`有効にされた`設定の環境変数は、`NEW_RELIC_TRANSACTION_TRACER_ENABLED`となります。

<Callout variant="important">
  環境変数を介してのエージェント設定では、[Javaエージェントバージョン4.10.0以上が必要です](/docs/agents/java-agent/installation/upgrade-java-agent)。
</Callout>

4.10.0以前のエージェントバージョンについては、次の環境変数を使用できます:

<CollapserGroup>
  <Collapser
    id="ev-NEW_RELIC_APP_NAME"
    title="NEW_RELIC_APP_NAME （必須）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    この設定は**必須**です。New Relicへのデータのレポートに使用するアプリケーション名を含みます。New Relicで表示するアプリケーションの名前を設定します。

    `enable_auto_app_naming`がfalseの場合、エージェントはすべてのデータをこのアプリケーションにレポートします。それ以外の場合、エージェントはバックグラウンドタスク（ウェブ以外のアプリケーションのトランザクション）のみをこのアプリケーションにレポートします。

    複数のアプリケーションにデータをレポートするには、アプリケーション名をセミコロン`;`で区切ります。たとえば、データを**My Application**と**My Application 2**にレポートするには:

    ```
    app_name: My Application;My Application 2
    ```

    アプリケーションの命名方法の詳細については、[Javaアプリケーションを命名する](/docs/agents/java-agent/configuration/name-your-java-application)を参照してください。
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_DISTRIBUTED_TRACING_ENABLED"
    title="NEW_RELIC_DISTRIBUTED_TRACING_ENABLED"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            false
          </td>
        </tr>
      </tbody>
    </table>

    ディストリビューティッド（分散）トレーシングを有効にします。大文字と小文字が区別されます。`true`または`false`を使用してください。詳細については、[ディストリビューティッド（分散）トレーシングのセクション](#distributed-tracing)をご覧ください。
  </Collapser>

  <Collapser
    id="NEW_RELIC_PROCESS_HOST_DISPLAY_NAME"
    title="NEW_RELIC_PROCESS_HOST_DISPLAY_NAME"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    [表示名](/docs/agents/java-agent/configuration/hostname-logic-java#display-name)を設定して、New Relic UIで「host:port」ラベルを追加します。
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_LICENSE_KEY"
    title="NEW_RELIC_LICENSE_KEY （必須）"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    この設定は**必須**です。New Relicアカウントのライセンスが含まれます。

    お使いのNew Relicアカウントに関連付けられた[ライセンスキー](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key)を指定する必要があります。このキーは、エージェントのデータを、New Relicサービスにあるアカウントと結びつけます。
  </Collapser>

  <Collapser
    id="ev-NEW_RELIC_LOG"
    title="NEW_RELIC_LOG"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `newrelic_agent.log`
          </td>
        </tr>
      </tbody>
    </table>

    制限のないログファイル名または標準出力に記録される文字列`STDOUT`。
  </Collapser>
</CollapserGroup>

## クラウドプラットフォームの利用 [#utilization]

このオプションは`utilization`スタンザで設定され、`newrelic.config.utilization`プリフィックス化システムプロパティを使用して上書きできます。

エージェントは利用情報を収集し、New Relicサービスに送信します。エージェントは、Amazon Web Services（AWS）EC2インスタンスおよびDockerコンテナから情報を収集できます。

<CollapserGroup>
  <Collapser
    id="aws-enabled"
    title="detect_aws"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントがAWSメタデータAPIをポーリングするかどうかを決定します。
  </Collapser>

  <Collapser
    id="docker-enabled"
    title="detect_docker"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    エージェントがDocker情報をファイルシステムから読み取るかどうかを決定します。
  </Collapser>
</CollapserGroup>

## 非同期インストゥルメンテーション [#async_config]

このオプションは`common`スタンザで設定され、プリフィックス化されたシステムプロパティを使用して[上書き](#System_Properties)できます。

<CollapserGroup>
  <Collapser
    id="cfg-token_timeout"
    title="token_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト（秒）
          </th>

          <td>
            `180`
          </td>
        </tr>
      </tbody>
    </table>

    `token.expire()`で明示的に失効されていない非同期トークンをエージェントが自動的に失効させるまでの秒数。使用の説明については、[トークン: 非同期スレッドの接続](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#tokens)をご覧ください。

    <Callout variant="important">
      この値を増やすと、エージェントが使用するメモリの量が増え、トークンが失効していないことでトランザクションがレポートされなくなるため、パフォーマンスに影響が生じる場合があります。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-segment_timeout"
    title="segment_timeout"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト（秒）
          </th>

          <td>
            `600`
          </td>
        </tr>
      </tbody>
    </table>

    `segment.end()`または`segment.ignore()`で明示的に終了していないセグメントをエージェントが自動的に終了するまでの秒数。使用の説明については、[セグメント: 時間によらない非同期アクティビティ](/docs/agents/java-agent/java-agent-api/java-agent-api-asynchronous-applications#segments)をご覧ください。

    <Callout variant="important">
      この値を増やすと、エージェントが使用するメモリの量が増え、セグメントが終了していないことでトランザクションがレポートされなくなるため、パフォーマンスに影響が生じる場合があります。
    </Callout>
  </Collapser>
</CollapserGroup>

## サーキットブレーカー

この設定は、[Javaブレーカー](/docs/agents/java-agent/custom-instrumentation/circuit-breaker-java-custom-instrumentation)の動作をカスタマイズします。この設定は、デフォルトでは`newrelic.yml`に含まれていません。変更後にJVMを再起動する必要はありません。

サーキットブレーカーをカスタマイズする場合、スタンザを`common`スタンザの下に追加します:

```
common: &default_settings​
    ​  <var>OTHER_CONFIG_SETTINGS</var>
      circuitbreaker:
        enabled: <var>true</var>
        memory_threshold: <var>20</var>
        gc_cpu_threshold: <var>10</var>
```

<CollapserGroup>
  <Collapser
    id="cfg-circuitbreaker_enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    アプリケーションの動作が想定どおりの場合、サーキットブレーカーを無効にすることもできます。
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_memory_threshold"
    title="memory_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数（0から100）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            20
          </td>
        </tr>
      </tbody>
    </table>

    ブレーカーのトリップを下回るフリーヒープメモリの比率をカスタマイズします。フリーヒープメモリの比率が`memory_threshold`以下で、ガーベージコレクションに費やしたCPUの時間が`gc_cpu_threshold`より多い場合、ブレーカーがトリップします。ブレーカーのトリップを発生しにくくするには、`memory_threshold`を減らすか、`gc_cpu_threshold`を増やします。アプリケーションの運用パフォーマンスと動作に基づき、必要に応じてこの値を調整します。
  </Collapser>

  <Collapser
    id="cfg-circuitbreaker_gc_cpu_threshold"
    title="gc_cpu_threshold"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数（0から100）
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            10
          </td>
        </tr>
      </tbody>
    </table>

    ブレーカーのトリップを上回るCPUのガーベージコレクション時間の比率をカスタマイズします。フリーヒープメモリの比率が`memory_threshold`以下で、ガーベージコレクションに費やしたCPUの時間が`gc_cpu_threshold`より多い場合、ブレーカーがトリップします。ブレーカーのトリップを発生しにくくするには、`memory_threshold`を減らすか、`gc_cpu_threshold`を増やします。アプリケーションの運用パフォーマンスと動作に基づき、必要に応じてこの値を調整します。
  </Collapser>
</CollapserGroup>

## メッセージトレーサー [#Transaction_Tracer]

`message_tracer`スタンザで設定されたこれらのオプションは、`newrelic.config.message_tracer`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。

<CollapserGroup>
  <Collapser
    id="tt-enabled"
    title="segment_parameters.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    メッセージプロパティをトレーサー属性に追加します。オフにするには、`false`に設定します。
  </Collapser>
</CollapserGroup>

## ディストリビューティッド（分散）トレーシング

<Callout variant="important">
  ディストリビューティッド（分散）トレーシングを有効にすると、[クロスアプリケーショントレーシング](#Cross_Application_Tracer)が無効になり、他のAPM機能に影響します。有効にする前に、[移行ガイド](/docs/transition-guide-distributed-tracing)を読んでください。

  [Javaエージェントのバージョン4.3.0以降](/docs/agents/java-agent/installation/upgrade-java-agent)が必要です。
</Callout>

[ディストリビューティッド（分散）トレーシング](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing)では、リクエストが経由する分散システムのパスを見ることができます。設定ファイルで、`distributed_tracing`スタンザで設定できます。`newrelic.config.distributed_tracing`プリフィックス化システムプロパティを使用して上書きできます。

<CollapserGroup>
  <Collapser
    id="dt-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    ディストリビューティッドトレーシングを有効にするには、これを`true`に設定します。

    たとえば、設定ファイルでこれを有効にするには、次のものを使用します：

    ```
    distributed_tracing:
           enabled: true
    ```

    [システムプロパティ](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties)を使用してこれを上書きするには、次のものを使用します:

    ```
    -Dnewrelic.config.distributed_tracing.enabled=true
    ```
  </Collapser>

  <Collapser
    id="dt-exclude_newrelic_header"
    title="exclude_newrelic_header"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    デフォルトで、エージェントのサポートされたバージョンは、 `newrelic`ヘッダーとディストリビューティッド（分散）トレーシング用のW3Cトレースコンテキストヘッダーの両方を使用します。`newrelic`ディストリビューティッド（分散）トレーシングヘッダーを使用すると、W3Cトレースコンテキストヘッダーをサポートしない古いエージェントとの相互運用が可能になります。W3Cトレースコンテキストヘッダーをサポートするエージェントバージョンは、ディストリビューティッド（分散）トレーシング用の`newrelic`ヘッダーよりこのヘッダーを優先します。

    `newrelic`ヘッダーを使用しない場合、これを`true`に設定すると、エージェントが`newrelic`ヘッダーを除外し、ディストリビューティッド（分散）トレーシング用のW3Cトレースコンテキストヘッダーのみを使用するようになります。

    たとえば、設定ファイルで`newrelic`ヘッダーを除外するには、次のものを使用します:

    ```
    distributed_tracing:
           exclude_newrelic_header: true
    ```

    `システムプロパティ`を使用して[newrelic](/docs/agents/java-agent/configuration/java-agent-configuration-config-file#System_Properties)ヘッダーを除外するには、次のものを使用します:

    ```
    -Dnewrelic.config.distributed_tracing.exclude_newrelic_header=true
    ```
  </Collapser>
</CollapserGroup>

## 無限トレーシング

<Callout variant="important">
  要件：

  * [Javaエージェント 5.12.1以降](/docs/agents/java-agent/installation/update-java-agent)。
  * Infinite Tracingは、`enable_auto_app_naming`が有効な場合は動作しません。
</Callout>

Infinite Tracingをオンにするには、ディストリビューティッド（分散）トレーシングを有効にして、以下の追加設定を加えます。例えば、「[言語エージェント：ディストリビューティッド（分散）トレーシングを構成する](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#java-config)」をご覧ください。

<CollapserGroup>
  <Collapser
    id="infinite-tracing-trace-observer-host"
    title="trace_observer.host"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            なし
          </td>
        </tr>
      </tbody>
    </table>

    有効なInfinite Tracing トレース オブザーバーのホストエントリを取得する方法については、[トレースオブザーバーを検索または作成する](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer)をご覧ください。

    YAMLを介して設定することもできます：

    ```
    infinite_tracing:
        trace_observer:
          host: <var>YOUR_TRACE_OBSERVER_HOST</var>
    ```

    システムプロパティ`newrelic.config.infinite_tracing.trace_observer.host` または環境変数`NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`を使用することもできます。
  </Collapser>
</CollapserGroup>

## スパンイベント

[スパンイベント](/docs/apm/distributed-tracing/ui-data/span-event)は[ディストリビューティッド（分散）トレーシング](#distributed-tracing)に関してレポートされます。スパンイベントをレポートするには、ディストリビューティッド（分散）トレーシングが有効になっていなければなりません。

スパン設定は`span_events`スタンザで設定され、`newrelic.config.span_events`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。オプションに含まれるもの：

<CollapserGroup>
  <Collapser
    id="cfg-span-events-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    スパンイベントのレポートの有効化/無効化に使用します。
  </Collapser>

  <Collapser
    id="cfg-span-events-max-samples-stored"
    title="max_samples_stored"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `2000`
          </td>
        </tr>
      </tbody>
    </table>

    エージェント収集サイクル中にキャプチャできるスパンイベントの数を決定します。Javaエージェント7.4.0以降で利用可能です。

    <Callout variant="important">
      スパンイベントの数を増やすと、エージェントのオーバーヘッドが増える可能性があります。New Relicによって、サーバー側に最大値が課される場合があります。
    </Callout>
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-enabled"
    title="attributes.enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    この設定は、スパンイベントのすべての属性をオンまたはオフにするのに使用できます。ルートレベルで`attributes.enabled`が`false`である場合は、このプロパティ（`span_events.attributes.enabled`）が設定されているかにかかわらず、属性がスパンイベントに送信されることはありません。
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-include"
    title="attributes.include"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    属性がスパンイベントに関して有効になっている場合は、このリストにあるすべての属性キーが`span_events`でNew Relicに送信されます。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>

  <Collapser
    id="cfg-span-events-attributes-exclude"
    title="attributes.exclude"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            (なし)
          </td>
        </tr>
      </tbody>
    </table>

    このリストにある属性キーのいずれも、スパンイベントでNew Relicに送信されることはありません。詳しくは[エージェント属性ルール](/docs/apm/other-features/attributes/agent-attributes)を参照してください。
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  スパンイベント属性のフィルタリングには、[Javaエージェントバージョン4.10.0以上](/docs/agents/java-agent/installation/upgrade-java-agent)が必要です。
</Callout>

## Jarコレクター

Javaエージェントは、アプリケーションクラスパス上のJarに関する情報とそのバージョンを収集します。

Jarコレクション設定は`jar_collector`スタンザで設定され、`newrelic.config.jar_collector`プリフィックス化システムプロパティを使用して[上書き](#System_Properties)できます。オプションに含まれるもの：

<CollapserGroup>
  <Collapser
    id="cfg-jar-collector-enabled"
    title="enabled"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Jarコレクションおよびレポートの有効化/無効化に使用されます。
  </Collapser>

  <Collapser
    id="cfg-jar-collector-skip-temp-jars"
    title="skip_temp_jars"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    一時的なJarのコレクションの有効化/無効化に使用されます。一時的なJarは、`java.io.tmpdir`システムプロパティによって指定されたディレクトリにあるJarです。
  </Collapser>

  <Collapser
    id="cfg-jar-collector-jars-per-second"
    title="jars_per_second"
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            整数
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            `10`
          </td>
        </tr>
      </tbody>
    </table>

    毎秒処理するjarの最大数。正の数値でなければなりません。
  </Collapser>
</CollapserGroup>