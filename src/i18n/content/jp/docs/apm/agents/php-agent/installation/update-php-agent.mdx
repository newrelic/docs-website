---
title: PHPエージェントの更新
tags:
  - Agents
  - PHP agent
  - Installation
metaDescription: 'How to update your APM PHP agent, and notes on EOL support for early agent versions.'
translationType: machine
---

New Relic の最新の機能、拡張機能、重要なセキュリティパッチを最大限に活用するために、PHP エージェントを最新版にアップデートすることをお勧めします。特定のエージェントのアップデートに関する追加情報については、 [PHP エージェントのリリースノート](/docs/release-notes/agent-release-notes/php-release-notes) を参照してください。

のエージェントをアップデートする方法について説明しています。

* RedHatとCentOS
* UbuntuとDebian

**tar アーカイブ** でアップデートする場合は、 [tar アーカイブのインストール手順](/docs/agents/php-agent/installation/php-agent-installation-tar-file) を行ってください。(tar アーカイブのインストールとアップデートの手順は同じです。)

## `newrelic-php5` パッケージを使用します。 [#newrelic-php5]

New Relic for PHP エージェントのパッケージ名は `newrelic-php5` です。

<Callout variant="tip">
  名前はPHP 5を示していますが、このパッケージはPHP 7のバージョンを含め、すべての[サポートされているPHPバージョン](/docs/agents/php-agent/getting-started/php-agent-compatibility-requirements#php-release)に動作します。
</Callout>

## パッケージマネージャーを使って更新する [#install-overview]

PHPエージェントをアップデートするには

1. お使いのシステムに適したパッケージマネージャーを使用して、エージェントファイルを置き換えます。

   <CollapserGroup>
     <Collapser
       id="redhat-centos"
       title="RedHatまたはCentOS"
     >
       <table>
         <thead>
           <tr>
             <th style={{ width: "125px" }}>
               マネージャー
             </th>

             <th>
               手順
             </th>
           </tr>
         </thead>

         <tbody>
           <tr>
             <td>
               **yum**
             </td>

             <td>
               New Relic のリポジトリを直接使用している場合は、以下のコマンドで最新のエージェントにアップデートしてください。

               ```
               sudo yum update newrelic-php5
               ```
             </td>
           </tr>

           <tr>
             <td>
               **32ビットrpm**
             </td>

             <td>
               `.rpm` ファイルの最新版を [New Relic のダウンロードページ](https://download.newrelic.com/pub/newrelic/el5/i386/) からダウンロードし、以下のコマンドを実行します。必ず、 `X.X.X.X` を最新の [New Relic for PHP バージョン番号](/docs/releases/php) に置き換えてください。

               ```
               rpm -i newrelic-php5-common-<var>X.X.X.X</var>-1.noarch.rpm newrelic-daemon-<var>X.X.X.X</var>-1.i386.rpm newrelic-php5-<var>X.X.X.X</var>-1.i386.rpm
               ```
             </td>
           </tr>

           <tr>
             <td>
               **64ビットrpm**
             </td>

             <td>
               `.rpm` ファイルの最新版を [New Relic のダウンロードページ](https://download.newrelic.com/pub/newrelic/el5/x86_64/) からダウンロードし、以下のコマンドを実行します。必ず、 `X.X.X.X` を最新の [New Relic for PHP バージョン番号](/docs/releases/php) に置き換えてください。

               ```
               rpm -i newrelic-php5-common-<var>X.X.X.X</var>-1.noarch.rpm newrelic-daemon-<var>X.X.X.X</var>-1.x86_64.rpm newrelic-php5-X.X.X.X-1.x86_64.rpm
               ```
             </td>
           </tr>
         </tbody>
       </table>
     </Collapser>

     <Collapser
       id="ubuntu-debian"
       title="UbuntuまたはDebian"
     >
       <table>
         <thead>
           <tr>
             <th style={{ width: "125px" }}>
               マネージャー
             </th>

             <th>
               手順
             </th>
           </tr>
         </thead>

         <tbody>
           <tr>
             <td>
               **apt-get**
             </td>

             <td>
               New Relic のリポジトリを直接使用している場合は、以下のコマンドで最新のエージェントにアップデートしてください。

               ```
               apt-get update
               apt-get install newrelic-php5
               ```
             </td>
           </tr>

           <tr>
             <td>
               **32ビットdpkg**
             </td>

             <td>
               `.deb` ファイルの最新版を [New Relic のダウンロードページ](https://download.newrelic.com/debian/dists/newrelic/non-free/binary-i386/) からダウンロードし、以下のコマンドを実行します。必ず、 `X.X.X.X` を最新の [New Relic for PHP バージョン番号](/docs/releases/php) に置き換えてください。

               ```
               dpkg -i newrelic-php5-common_<var>X.X.X.X</var>_all.deb newrelic-daemon_<var>X.X.X.X</var>_i386.deb newrelic-php5_<var>X.X.X.X</var>_i386.deb
               ```
             </td>
           </tr>

           <tr>
             <td>
               **64ビットdpkg**
             </td>

             <td>
               `.deb` ファイルの最新版を [New Relic のダウンロードページ](https://download.newrelic.com/debian/dists/newrelic/non-free/binary-amd64/) からダウンロードし、以下のコマンドを実行します。必ず、 `X.X.X.X` を最新の [New Relic for PHP バージョン番号](/docs/releases/php) に置き換えてください。

               ```
               dpkg -i newrelic-php5-common_<var>X.X.X.X</var>_all.deb newrelic-daemon_X.X.X.X_amd64.deb newrelic-php5_<var>X.X.X.X</var>_amd64.deb
               ```
             </td>
           </tr>
         </tbody>
       </table>
     </Collapser>
   </CollapserGroup>

2. RedHatまたはCentOSの場合。 `newrelic-install` スクリプトを実行し、古いインストールを上書きする前に [インストールスクリプトの確認プロンプト](/docs/php/the-newrelic-install-script) に従ってください。

   ```
   sudo newrelic-install install
   ```

   UbuntuまたはDebianを使用しています。パッケージマネージャーの指示に従い、インストール作業の一環として、 `newrelic-install` スクリプトを実行してください。

3. 残存している `newrelic-daemon` のプロセスを停止します。

   ```
   kill $(pgrep newrelic-daemon)
   ```

   `newrelic-daemon` が、 [start in external mode](/docs/agents/php-agent/advanced-installation/starting-php-daemon-advanced#selecting-external) と設定されている場合は、オペレーティングシステムのサービスマネージャーを使用して再起動してください。

4. [Webサーバー](/docs/agents/php-agent/troubleshooting/why-when-you-must-restart-your-web-server) （Apache、Nginx、PHP-FPMなど）を再起動します。

5. アプリケーションがNew Relicにデータを送信し始めるまで数分間待ちます。

## サポート対象外のバージョンのエージェントのアップデート [#eol-update]

<Callout variant="important">
  メジャーバージョンのアップデートなど、以前のバージョンのエージェントからアップデートしている場合は、機能変更の以下のリストを見直してください。
</Callout>

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        移行
      </th>

      <th>
        コメント
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td id="migration-8-0-0-204">
        8.0.0.204
      </td>

      <td>
        リリースノート： [PHP agent 8.0.0.204](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-800204)

        **TLSは、 `newrelic.daemon.ssl` iniの設定を置き換えます。**

        セキュリティを高めるために、 `newrelic.daemon.ssl` ini の設定が削除されました。New Relic コレクターとの通信には、常に TLS (Transport Layer Security) が使用されるようになりました。
      </td>
    </tr>

    <tr>
      <td id="migration-7-0-0-186">
        7.0.0.186
      </td>

      <td>
        リリースノート： [PHP agent 7.0.0.186](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-700186)

        **PHP 5.2 はサポートされなくなりました。**

        New Relic では、サポートされているバージョンの PHP (5.6 以上) を使用することを強く推奨します。PHP 5.2 で New Relic PHP エージェントを継続して動作させたい場合は、エージェントバージョン 6.9 の使用を推奨します。ただし、この場合は限定的なサポートしか提供できません。
      </td>
    </tr>

    <tr>
      <td id="migration-5-0-0-115">
        5.0.0.115
      </td>

      <td>
        リリースノート： [PHP agent 5.0.0.115](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-500115)

        **デーモンのコマンドラインフラグの名称が変更されました。**

        デーモンを手動で起動するお客様は、 **新しく名前が変更されたコマンドラインフラグ** を `-h` または `--help` フラグで見つけることができます。 **以下の古いフラグは、将来のリリースで削除される予定です** 。

        * \[-p pidfile].
        * \[-d level] です。
        * \[-c config].
        * \[-l logfile].
        * \[-P port].
        * \[-s]
        * \[-n]
        * \[-b SSL-certificate-bundle].
        * \[-S SSL-certificate-path] です。
        * \[-H ホスト］
        * \[-x]プロキシ
        * \[-a auditlog］
      </td>
    </tr>
  </tbody>
</table>

## アップデート後のトラブルシューティング [#troubleshoot]

PHPをアップデートした後、エージェントが動作しなくなったり、データが報告されなくなったりした場合は、 [トラブルシューティングの手順に従ってください](/docs/agents/php-agent/troubleshooting/agent-stops-working-after-updating-php) 。