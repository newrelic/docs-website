---
title: PHPエージェントの更新
tags:
  - Agents
  - PHP agent
  - Installation
metaDescription: 'How to update your APM PHP agent, and notes on EOL support for early agent versions.'
translationType: machine
---

New Relic の最新の機能、拡張機能、重要なセキュリティパッチを最大限に活用するために、PHP エージェントを最新版にアップデートすることをお勧めします。特定のエージェントのアップデートに関する追加情報については、 [PHP エージェントのリリースノート](/docs/release-notes/agent-release-notes/php-release-notes) を参照してください。

のエージェントをアップデートする方法について説明しています。

* RedHatとCentOS
* UbuntuとDebian

**tar アーカイブ** でアップデートする場合は、 [tar アーカイブのインストール手順](/docs/agents/php-agent/installation/php-agent-installation-tar-file) を行ってください。(tar アーカイブのインストールとアップデートの手順は同じです。)

## `newrelic-php5`パッケージを使用 [#newrelic-php5]

New Relic の PHP エージェントのパッケージ名は`newrelic-php5`です。

<Callout variant="tip">
  パッケージ名は PHP 5 になっていますが、このパッケージは [でサポートされているすべての PHP バージョンで動作します。](/docs/agents/php-agent/getting-started/php-agent-compatibility-requirements#php-release).
</Callout>

## パッケージマネージャーを使って更新する [#install-overview]

PHPエージェントをアップデートするには

1. お使いのシステムに適したパッケージマネージャーを使用して、エージェントファイルを置き換えます。

   <CollapserGroup>
     <Collapser
       id="redhat-centos"
       title="RedHatまたはCentOS"
     >
       <table>
         <thead>
           <tr>
             <th style={{ width: "125px" }}>
               マネージャー
             </th>

             <th>
               手順
             </th>
           </tr>
         </thead>

         <tbody>
           <tr>
             <td>
               **yum**
             </td>

             <td>
               New Relic のリポジトリを直接使用している場合は、以下のコマンドで最新のエージェントにアップデートしてください。

               ```bash
               sudo yum update newrelic-php5
               ```
             </td>
           </tr>

           <tr>
             <td>
               **32ビットrpm**
             </td>

             <td>
               [New Relic ダウンロード ページ](https://download.newrelic.com/pub/newrelic/el5/i386/)から`.rpm`ファイルの最新バージョンをダウンロードし、次のコマンドを実行します。`X.X.X.X`を最新の[New Relic for PHP バージョン番号](/docs/releases/php)に置き換えてください。

               ```bash
               rpm -i newrelic-php5-common-X.X.X.X-1.noarch.rpm newrelic-daemon-X.X.X.X-1.i386.rpm newrelic-php5-X.X.X.X-1.i386.rpm
               ```
             </td>
           </tr>

           <tr>
             <td>
               **64ビットrpm**
             </td>

             <td>
               [New Relic ダウンロード ページ](https://download.newrelic.com/pub/newrelic/el5/x86_64/)から`.rpm`ファイルの最新バージョンをダウンロードし、次のコマンドを実行します。`X.X.X.X`を最新の[New Relic for PHP バージョン番号](/docs/releases/php)に置き換えてください。

               ```bash
               rpm -i newrelic-php5-common-X.X.X.X-1.noarch.rpm newrelic-daemon-X.X.X.X-1.x86_64.rpm newrelic-php5-X.X.X.X-1.x86_64.rpm
               ```
             </td>
           </tr>
         </tbody>
       </table>
     </Collapser>

     <Collapser
       id="ubuntu-debian"
       title="UbuntuまたはDebian"
     >
       <table>
         <thead>
           <tr>
             <th style={{ width: "125px" }}>
               マネージャー
             </th>

             <th>
               手順
             </th>
           </tr>
         </thead>

         <tbody>
           <tr>
             <td>
               **apt-get**
             </td>

             <td>
               New Relic のリポジトリを直接使用している場合は、以下のコマンドで最新のエージェントにアップデートしてください。

               ```bash
               apt-get update
               apt-get install newrelic-php5
               ```
             </td>
           </tr>

           <tr>
             <td>
               **32ビットdpkg**
             </td>

             <td>
               [New Relic ダウンロード ページ](https://download.newrelic.com/debian/dists/newrelic/non-free/binary-i386/)から`.deb`ファイルの最新バージョンをダウンロードし、次のコマンドを実行します。`X.X.X.X`を最新の[New Relic for PHP バージョン番号](/docs/releases/php)に置き換えてください。

               ```bash
               dpkg -i newrelic-php5-common_X.X.X.X_all.deb newrelic-daemon_X.X.X.X_i386.deb newrelic-php5_X.X.X.X_i386.deb
               ```
             </td>
           </tr>

           <tr>
             <td>
               **64ビットdpkg**
             </td>

             <td>
               [New Relic ダウンロード ページ](https://download.newrelic.com/debian/dists/newrelic/non-free/binary-amd64/)から`.deb`ファイルの最新バージョンをダウンロードし、次のコマンドを実行します。`X.X.X.X`を最新の[New Relic for PHP バージョン番号](/docs/releases/php)に置き換えてください。

               ```bash
               dpkg -i newrelic-php5-common_X.X.X.X_all.deb newrelic-daemon_X.X.X.X_amd64.deb newrelic-php5_X.X.X.X_amd64.deb
               ```
             </td>
           </tr>
         </tbody>
       </table>
     </Collapser>
   </CollapserGroup>

2. RedHat または CentOS: 古いインストールを上書きする前に、 `newrelic-install`スクリプトを実行し、[インストール スクリプトの確認プロンプト](/docs/php/the-newrelic-install-script)に従います。

   ```bash
   sudo newrelic-install install
   ```

   Ubuntu または Debian: パッケージ マネージャーのプロンプトに従って、インストール プロセスの一部として`newrelic-install`スクリプトを実行します。

3. 実行して残りの`newrelic-daemon`プロセスを停止します

   ```
   kill $(pgrep newrelic-daemon)
   ```

   `newrelic-daemon`が[エクスターナル モードで起動する](/docs/agents/php-agent/advanced-installation/starting-php-daemon-advanced#selecting-external)ように構成されている場合は、オペレーティング システムのサービス マネージャーを使用して再起動してください。

4. [Webサーバー](/docs/agents/php-agent/troubleshooting/why-when-you-must-restart-your-web-server) （Apache、Nginx、PHP-FPMなど）を再起動します。

5. アプリケーションがNew Relicにデータを送信し始めるまで数分間待ちます。

## サポート対象外のバージョンのエージェントのアップデート [#eol-update]

<Callout variant="important">
  メジャーバージョンのアップデートなど、以前のバージョンのエージェントからアップデートしている場合は、機能変更の以下のリストを見直してください。
</Callout>

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        移行
      </th>

      <th>
        コメントコメント
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td id="migration-8-0-0-204">
        8.0.0.204
      </td>

      <td>
        リリースノート： [PHP agent 8.0.0.204](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-800204)

        **TLS は`newrelic.daemon.ssl` ini 設定を置き換えます。**

        セキュリティを強化するために、 `newrelic.daemon.ssl` ini 設定が削除されました。Transport Layer Security (TLS) は、New Relic コレクターとの通信で常に使用されるようになりました。
      </td>
    </tr>

    <tr>
      <td id="migration-7-0-0-186">
        7.0.0.186
      </td>

      <td>
        リリースノート： [PHP agent 7.0.0.186](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-700186)

        **PHP 5.2 はサポートされなくなりました。**

        New Relic では、サポートされているバージョンの PHP (5.6 以上) を使用することを強く推奨します。PHP 5.2 で New Relic PHP エージェントを継続して動作させたい場合は、エージェントバージョン 6.9 の使用を推奨します。ただし、この場合は限定的なサポートしか提供できません。
      </td>
    </tr>

    <tr>
      <td id="migration-5-0-0-115">
        5.0.0.115
      </td>

      <td>
        リリースノート： [PHP agent 5.0.0.115](/docs/release-notes/agent-release-notes/php-release-notes/php-agent-500115)

        **デーモンのコマンドラインフラグの名称が変更されました。**

        デーモンを手動で開始するお客様は、**新しく名前が変更されたコマンド ライン フラグ**を`-h`または`--help`フラグで見つけることができます。**次の古いフラグは、将来のリリースで削除される**予定です。

        * \[-p pidfile].
        * \[-d level] です。
        * \[-c config].
        * \[-l logfile].
        * \[-P port].
        * \[-s]
        * \[-n]
        * \[-b SSL-certificate-bundle].
        * \[-S SSL-certificate-path] です。
        * \[-H ホスト］
        * \[-x]プロキシ
        * \[-a auditlog］
      </td>
    </tr>
  </tbody>
</table>

## アップデート後のトラブルシューティング [#troubleshoot]

PHPをアップデートした後、エージェントが動作しなくなったり、データが報告されなくなったりした場合は、 [トラブルシューティングの手順に従ってください](/docs/agents/php-agent/troubleshooting/agent-stops-working-after-updating-php) 。