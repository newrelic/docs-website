---
title: アトリビュートの有効化・無効化
tags:
  - Agents
  - PHP agent
  - Attributes
metaDescription: 'How to include and exclude specific attributes for your New Relic PHP agent, including properties and rules.'
translationType: machine
---

属性を有効または無効にするためのプロパティや、New Relic が [配信先](/docs/features/agent-attributes#destinations) に対してどの属性を含めるか、または除外するかを決定する際に使用するルールについて説明します。また、New Relic エージェント属性のリリースに伴い、廃止された PHP エージェントのプロパティについてもまとめています。

## プロパティ

以下のデスティネーションプロパティを使用して、任意の属性コレクションに対してデスティネーションを開いたり閉じたりします。

<CollapserGroup>
  <Collapser
    id="cfg-attributes-enabled"
    title={<InlineCode>newrelic.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            トゥルー
          </td>
        </tr>
      </tbody>
    </table>

    すべてのデスティネーションのすべてのアトリビュートをオンまたはオフにします。
  </Collapser>

  <Collapser
    id="cfg-browser-attributes-enabled"
    title={<InlineCode>newrelic.browser_monitoring.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            false
          </td>
        </tr>
      </tbody>
    </table>

    ブラウザモニタリングのすべての属性をオンまたはオフにします。これは、ページビューイベントに添付されるデータです。 `newrelic.attributes.enabled` が `false` の場合、このプロパティがどのように設定されているかに関わらず、ブラウザ・モニタリングに属性は送られません。
  </Collapser>

  <Collapser
    id="cfg-error-attributes-enabled"
    title={<InlineCode>newrelic.error_collector.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            トゥルー
          </td>
        </tr>
      </tbody>
    </table>

    トレースされたエラーのすべての属性をオンまたはオフにします。 `newrelic.attributes.enabled` が `false` の場合、このプロパティがどのように設定されているかに関わらず、トレースされたエラーに属性は送られません。
  </Collapser>

  <Collapser
    id="cfg-events-attributes-enabled"
    title={<InlineCode>newrelic.transaction_events.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            トゥルー
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションイベントのすべてのアトリビュートをオンまたはオフにします。 `newrelic.attributes.enabled` が `false` の場合、このプロパティがどのように設定されているかに関わらず、トランザクション・イベントにアトリビュートは送信されません。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-enabled"
    title={<InlineCode>newrelic.transaction_tracer.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            トゥルー
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレースのすべての属性をオンまたはオフにします。 `newrelic.attributes.enabled` が `false` の場合、このプロパティがどのように設定されているかに関わらず、トランザクション・トレースに属性は送られません。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-enabled"
    title={<InlineCode>newrelic.span_events.attributes.enabled</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ
          </th>

          <td>
            ブール値
          </td>
        </tr>

        <tr>
          <th>
            デフォルト
          </th>

          <td>
            トゥルー
          </td>
        </tr>
      </tbody>
    </table>

    `Span` データのすべての属性をオンまたはオフにします。 `newrelic.attributes.enabled` が `false` の場合、このプロパティがどのように設定されていても、スパンに属性は送られません。
  </Collapser>
</CollapserGroup>

以下の属性/デスティネーション別の `.include` または `.exclude` プロパティを使用して、特定のデスティネーションに特定の属性を追加または削除します。

<CollapserGroup>
  <Collapser
    id="cfg-attributes-include"
    title={<InlineCode>newrelic.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    属性が有効な場合、このリストにあるすべての属性キーがNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-attributes-exclude"
    title={<InlineCode>newrelic.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストのすべての属性キーは **not** New Relic に送信されます。
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-include"
    title={<InlineCode>newrelic.browser_monitoring.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    browser_monitoringで属性が有効になっている場合、このリストにあるすべての属性キーがページビューデータで送信されます。
  </Collapser>

  <Collapser
    id="cfg-bm-attributes-exclude"
    title={<InlineCode>newrelic.browser_monitoring.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストで見つかったすべての属性キーは、 **not** ページビューでNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-include"
    title={<InlineCode>newrelic.error_collector.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    エラーのトレースに属性が有効な場合、このリストのすべての属性キーがエラーのトレースで New Relic に送信されます。
  </Collapser>

  <Collapser
    id="cfg-ec-attributes-exclude"
    title={<InlineCode>newrelic.error_collector.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストに含まれるすべての属性キーは、 **not** トレースされたエラーで New Relic に送信されます。
  </Collapser>

  <Collapser
    id="cfg-te-attributes-include"
    title={<InlineCode>newrelic.transaction_events.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    トランザクションイベントで属性を有効にすると、このリストにあるすべての属性キーがトランザクションイベントでNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-te-attributes-exclude"
    title={<InlineCode>newrelic.transaction_events.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストのすべての属性キーは **not** トランザクションイベントで New Relic に送信されます。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-include"
    title={<InlineCode>newrelic.transaction_tracer.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    トランザクショントレースで属性を有効にすると、このリストのすべての属性キーがトランザクショントレースでNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-exclude"
    title={<InlineCode>newrelic.transaction_tracer.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストのすべての属性キーは **not** トランザクショントレースで New Relic に送信されます。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-include"
    title={<InlineCode>newrelic.span_events.attributes.include</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    spanイベントで属性が有効になっている場合、このリストにあるすべての属性キーがspanイベントでNew Relicに送信されます。
  </Collapser>

  <Collapser
    id="cfg-tt-attributes-exclude"
    title={<InlineCode>newrelic.span_events.attributes.exclude</InlineCode>}
  >
    <table>
      <tbody>
        <tr>
          <th>
            タイプ：
          </th>

          <td>
            コンマで区切られた文字列のリスト
          </td>
        </tr>

        <tr>
          <th>
            デフォルト：
          </th>

          <td>
            エンプティ
          </td>
        </tr>
      </tbody>
    </table>

    このリストに含まれるすべての属性キーは、 **not** spanイベントでNew Relicに送信されます。
  </Collapser>
</CollapserGroup>

## アトリビュートルール [#attruls]

New Relic は、デスティネーションにどの属性を含めるか、または除外するかを決定する際に、これらのルールに従います。

<CollapserGroup>
  <Collapser
    id="rule-root-precedence"
    title="Rootレベルが優先されて有効になります。"
  >
    `newrelic.attributes.enabled` フィールドは、他のすべての設定に優先します。 `false` の場合、属性は New Relic に報告されません。

    設定例

    ```
    newrelic.attributes.enabled = false
    newrelic.attributes.include = foo,bar
    newrelic.transaction_tracer.attributes.enabled = true
    ```

    出力例。

    ```
    Keys passed in: password, foo, bar, bat
    Keys included for all destinations:
    Keys excluded for all destinations: password, foo, bar, bat
    ```
  </Collapser>

  <Collapser
    id="rule-destination-precedence"
    title="Destination enabledはincludeやexcludeよりも優先されます。"
  >
    `newrelic.{destination}.attributes.enabled` フラグは、includeおよびexcludeキーよりも優先されます。

    設定例

    ```
    newrelic.transaction_tracer.attributes.enabled = false
    newrelic.attributes.include = one,two
    newrelic.transaction_tracer.attributes.include = three,four
    ```

    出力例。

    ```
    Keys passed in: one, two, three, four
    Keys included for transaction traces:
    Keys excluded for transaction traces: one, two, three, four
    ```
  </Collapser>

  <Collapser
    id="rule-included-destination"
    title="属性は、デスティネーションが有効な場合に含まれます。"
  >
    デスティネーションが有効な場合、すべてのユーザー属性はデフォルトでそのデスティネーションに送信されます。

    すべてのユーザー属性のデフォルトは `true` です。ただし、デフォルトでは、リクエスト属性とメッセージパラメータは、すべての宛先に対して無効になっています。

    設定例

    ```
    newrelic.attributes.enabled = true
    newrelic.attributes.exclude = myAttKey
    ```

    出力例。

    ```
    Keys passed in: foo, bar, myAttKey
    Keys included: foo, bar
    Keys excluded: myAttKey
    ```
  </Collapser>

  <Collapser
    id="rule-exclude-wins"
    title="Excludeは常にIncludeに優先します。"
  >
    includeリストとexcludeリストに同じキーが記載されている場合は、指定されたキーを持つ属性は除外されます。

    設定例

    ```
    newrelic.attributes.enabled = true
    newrelic.attributes.include = foo,myCustomAtt
    newrelic.attributes.exclude = password,myCustomAtt
    ```

    出力例。

    ```
    Keys passed in: foo, myCustomAtt, password
    Keys included: foo
    Keys excluded: password, myCustomAtt
    ```
  </Collapser>

  <Collapser
    id="rule-keys-case-sensitive"
    title="キーは大文字と小文字を区別します。"
  >
    キーは大文字と小文字を区別します。

    設定例

    ```
    newrelic.attributes.enabled = true
    newrelic.attributes.exclude = password,PaSsWoRd
    ```

    出力例。

    ```
    Keys passed in: password, Password, PASSWORD, PaSsWoRd, PassWORD
    Keys included: Password, PASSWORD, PassWORD
    Keys excluded: password, PaSsWoRd
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>ワイルドカードには星印（<InlineCode>\*</InlineCode> ）を使います。</>}
  >
    キーの最後にアスタリスクまたはスター(`*`)をワイルドカードとして使用することができます。これは、同じプレフィックスを持つ属性のセットにマッチします。

    設定例

    ```
    newrelic.attributes.enabled = true
    newrelic.attributes.include = custom*
    newrelic.attributes.exclude = request.parameters.*
    ```

    出力例。

    ```
    Keys passed in: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
    Keys included: custom, custom.key1, custom.key2
    Keys excluded: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser
    id="rule-specific-wins"
    title="キーの具体的な設定が優先されます。"
  >
    複数のincludeまたはexclude属性が同じキーに影響を与える場合は、最も具体的な設定が優先されます。

    設定例

    ```
    newrelic.attributes.enabled = true
    newrelic.attributes.include = request.parameters.foo
    newrelic.attributes.exclude = request.parameters.*
    ```

    出力例。

    ```
    Keys passed in: request.parameters., request.parameters.foo, request.parameters.bar
    Keys included: request.parameters.foo
    Keys excluded: request.parameters., request.parameters.bar
    ```
  </Collapser>

  <Collapser
    id="rule-destination-include-exclude"
    title="特定のデスティネーションに影響を与えます。"
  >
    デスティネーションにincludeまたはexclude属性が指定されている場合、そのデスティネーションにのみ影響を与えます。

    設定例

    ```
    newrelic.attributes.include = foo
    newrelic.transaction_events.attributes.exclude = foo
    ```

    出力例。

    ```
    Keys passed in: foo
    Keys included for transaction events: 
    Keys included for other destinations: foo
    Keys excluded for transaction events: foo
    ```
  </Collapser>
</CollapserGroup>

## 非推奨のプロパティ [#deprecated]

以下のプロパティは非推奨となりました。PHP エージェントをアップグレードする際には、これらのプロパティの属性設定を新しいものに切り替えてください。

<table>
  <thead>
    <tr>
      <th width={200}>
        **償却資産**
      </th>

      <th>
        **新規物件**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `newrelic.capture_params`
      </td>

      <td>
        `newrelic.attributes.include = request.parameters.*.`

        デフォルトでは、リクエストパラメーターは New Relic に送信されません。 `request.parameters.*` を `newrelic.attributes.include` のリストに追加することで、すべてのリクエストパラメーターをオンにすることができます。 `newrelic.capture_params` プロパティは非推奨となりました。
      </td>
    </tr>

    <tr>
      <td>
        `newrelic.ignored_params`
      </td>

      <td>
        `newrelic.attributes.exclude = request.parameters.{name}。`

        各リクエストパラメータキーを `newrelic.attributes.exclude` リストにカンマで区切って追加します。キーの前には必ず `request.parameters` を付けてください。 `newrelic.ignored_params` プロパティは非推奨となりました。
      </td>
    </tr>

    <tr>
      <td>
        `newrelic.{destination}.capture_attributes`
      </td>

      <td>
        `newrelic.{destination}.attributes.enabled`

        古い `newrelic.{destination}.capture_attributes` フラグでは、ユーザー属性の収集をオフにしていました。これは非推奨となっています。代わりに `newrelic.{destination}.attributes.enabled` を使用してください。
      </td>
    </tr>
  </tbody>
</table>