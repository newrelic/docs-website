---
title: メモリ使用量が多い（.NET）
type: troubleshooting
tags:
  - Agents
  - NET agent
  - Troubleshooting
metaDescription: Troubleshooting tips to determine if Windows Working Set memory usage is a concern after you install New Relic's .NET agent for your app.
translationType: machine
---

## 問題

New Relic の .NET エージェントをインストールした後、Microsoft Windows **Task Manager** のような監視ツールで `Working Set` のメモリ使用量が増加していることがわかります。この増加は通常、監視対象のアプリケーションごとに約100MBとなります。この現象は、物理マシンと仮想マシンの両方で発生する可能性があります。

## 解決策

この `Working Set` のメモリ使用量の増加は、通常、パフォーマンスに影響を与えません。Windows は、特定のアプリのために `Working Set` メモリを予約しますが、他のアプリがそのメモリを必要とする場合には、いつでも解放することができます。これは、すべての Windows アプリにとって正常であり、期待される動作です。

ごくまれに、特にRAMが限られているシステムや多くのアプリプールがあるシステムでは、メモリ使用量がパフォーマンスに影響を与えることがあります。パフォーマンスに影響がある場合は、以下のいずれかの方法をお試しください。

* [特定のアプリプールでのみインストゥルメンテーションを有効にする](/docs/agents/net-agent/configuration/net-agent-configuration#include_exclude_apps)
* マシンにRAMを追加する。
* マシンからいくつかのアプリケーションプールを削除します。
* **タスクマネージャー** に表示されるメモリ使用量の増加が実際にパフォーマンスに影響を与えているかどうかを確認するために、パフォーマンスを監視します。影響を与えている場合は、メモリを解放して他のプロセスと共有します。

## 原因

根本的な原因は、 [Windows 自身がプロセスごとにメモリを予測して割り当てる方法にあります。](https://docs.microsoft.com/en-us/windows/win32/memory/working-set) 。Windows はこのメモリを `Working Set` メモリとして割り当てます。これは OS がプロセスのために確保するメモリです。OSは、他のプロセスが必要とする場合、 `Working Set` メモリをすぐに解放することができます。メモリの割り当ては Windows が決定するため、New Relic は使用中に表示されているメモリの量を減らすことはできません。

通常、このような増加は、それに伴うパフォーマンスの低下がない限り、問題にはなりません。利用可能なメモリのすべてが `Private Working Set` メモリとして占有されている場合、パフォーマンスの問題が発生する可能性があります。サーバのメモリが不足している場合は、レスポンスタイムやトランザクションタイムを監視して、このメモリ使用量が実際にパフォーマンスに影響を与えているかどうかを確認してください。しばらくの間、増加が見られなければ、メモリの使用量は問題ではありません。

通常、 `Working Set` のメモリ使用量は、RAM が限られたシステムでのみ問題が発生します。たとえば、New Relic のテストシステムでは、監視対象のアプリまたはアプリプールごとに約 100 MB の増加が見られることがあります。80%の増加は、64GBの80%であれば注目に値しますが、4GBの80%であればあまり注目されません。

同様に、監視するアプリケーションプールの数も使用率に影響します。1つのアプリケーションプールで使用量が大幅に増加することはほとんどありませんが、4GBのRAMと30のアプリケーションプールを持つシステムでは問題が発生する可能性があります。
