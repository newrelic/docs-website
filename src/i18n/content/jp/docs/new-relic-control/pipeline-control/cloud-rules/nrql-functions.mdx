---
title: ゲートウェイルールでのNRQL関数のサポート
metaDescription: Learn about the support for NRQL functions in Pipeline Control gateway rules and how to use them effectively.
freshnessValidatedDate: never
translationType: machine
---

このドキュメントでは、Pipeline Control ゲートウェイ ルールでサポートされている NRQL 関数の概要を説明します。これらの関数を使用して、データのフィルタリングと管理のためのより強力で正確なルールを作成します。

<table>
  <thead>
    <tr>
      <th>
        働き
      </th>

      <th>
        説明
      </th>

      <th>
        NRQLクエリの例
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        [`aparse()`](/docs/nrql/nrql-syntax-clauses-functions/#func-aparse)
      </td>

      <td>
        指定されたパターンに基づいて文字列から値を抽出します。
      </td>

      <td>
        `DELETE FROM Log WHERE aparse(message, 'Error: %') = 'timeout'`
      </td>
    </tr>

    <tr>
      <td>
        [`dimensions()`](/docs/nrql/nrql-syntax-clauses-functions/#func-dimensions)
      </td>

      <td>
        メトリクス/イベントに関連付けられたファセットまたはディメンションに基づいてデータをフィルターします。
      </td>

      <td>
        `DELETE FROM Log WHERE dimensions() LIKE '%collectd%'`
      </td>
    </tr>

    <tr>
      <td>
        [`floor()`](/docs/nrql/nrql-syntax-clauses-functions/#floor)
      </td>

      <td>
        指定された数値以下の最大の整数を返します。
      </td>

      <td>
        `DELETE FROM Metric WHERE floor(duration) > 5`
      </td>
    </tr>

    <tr>
      <td>
        [`getField()`](/docs/nrql/nrql-syntax-clauses-functions/#func-getfield)
      </td>

      <td>
        複雑なデータ構造 (JSON オブジェクトなど) から特定のフィールドを抽出します。
      </td>

      <td>
        `DELETE FROM Metric WHERE getField(cpu_usage, percent) > 90`
      </td>
    </tr>

    <tr>
      <td>
        [`hourOf()`](/docs/nrql/nrql-syntax-clauses-functions/#func-minOf)
      </td>

      <td>
        タイムスタンプから時間のコンポーネントを抽出します。
      </td>

      <td>
        `DELETE FROM Log WHERE hourOf(timestamp) IN (2, 3, 4)`
      </td>
    </tr>

    <tr>
      <td>
        [`mod()`](/docs/nrql/nrql-syntax-clauses-functions/#func-mod)
      </td>

      <td>
        除算演算の余りを返します。
      </td>

      <td>
        `DELETE FROM Log WHERE mod(timestamp/1000,20) != 1`
      </td>
    </tr>

    <tr>
      <td>
        [`numeric()`](/docs/nrql/nrql-syntax-clauses-functions/#type-conversion)
      </td>

      <td>
        文字列値を数値型に変換します。
      </td>

      <td>
        `DELETE FROM Log WHERE numeric(responseTime) > 1000`
      </td>
    </tr>

    <tr>
      <td>
        [`round()`](/docs/nrql/nrql-syntax-clauses-functions/#round)
      </td>

      <td>
        数値を最も近い整数または指定された小数点以下の桁数に丸めます。
      </td>

      <td>
        `DELETE FROM Metric WHERE round(latency, 2) > 0.5`
      </td>
    </tr>

    <tr>
      <td>
        [`string()`](/docs/nrql/nrql-syntax-clauses-functions/#func-string)
      </td>

      <td>
        数値またはその他の値を文字列型に変換します。
      </td>

      <td>
        `DELETE FROM Log WHERE string(statusCode) = '404'`
      </td>
    </tr>

    <tr>
      <td>
        [`substring()`](/docs/nrql/nrql-syntax-clauses-functions/#func-substring)
      </td>

      <td>
        文字列の指定された部分を抽出します。
      </td>

      <td>
        `DELETE FROM Log WHERE substring(transactionId, 1, 3) = 'tmp'`
      </td>
    </tr>

    <tr>
      <td>
        `weekdayOf()`
      </td>

      <td>
        タイムスタンプから曜日を抽出します (例: 「月曜日」、「日曜日」)。
      </td>

      <td>
        `DELETE FROM Metric WHERE weekdayOf(timestamp) IN ('Saturday', 'Sunday')`
      </td>
    </tr>
  </tbody>
</table>

## ゲートウェイルールにおける複数のNRQL関数の例

これらの例では、複数の関数を組み合わせて、より複雑なシナリオで使用し、正確なデータのフィルタリングと削除を実現する方法を示します。

* このルールは、終了したコンテナのデータを削除しますが、過去 10 分以内に終了したコンテナのレコードは保持します。

```sql
DELETE FROM ContainerSample WHERE state = 'exited' AND status LIKE '%Exited%' AND NOT (status LIKE '%second%' AND numeric(aparse(status,'%Exited (%) * seconds ago%')) < 10) AND NOT (status LIKE '%About a minute ago%' OR status LIKE '%minute%' AND numeric(aparse(status,'%Exited (%) * minutes ago%')) < 10)
```

* このルールは、特定のログパターン ( `collectd` ) に関連付けられており、カスタムイベント タイプではないログを削除します。

```sql
DELETE FROM Log, LogExtendedRecord WHERE dimensions() LIKE '%collectd%' AND newrelic.logs.customEventType IS NULL
```

* このルールは、特定の種類のエラー ログを削除しますが、タイムスタンプが 101 の倍数であるレコードのみを保持してサンプリングします。

```sql
DELETE FROM Log WHERE message LIKE '%lib/ladon/middleware/caching.rb:49 run> terminated with exception%' AND floor(timestamp/101) = (timestamp/101) AND newrelic.logs.customEventType IS NULL
```

これらの新しい関数により、Pipeline Control ゲートウェイを操作する際の NRQL クエリの機能が大幅に拡張され、より正確なデータ分析と管理が可能になります。