---
title: パターンでログデータの価値を発見
tags:
  - Logs
  - Log management
  - UI and data
metaDescription: 'Use log patterns in New Relic to discover trends in data over time, focus your energy on what matters, and exclude what''s irrelevant.'
translationType: machine
---

import logsLogPatterns from 'images/logs_screenshot-crop_log-patterns.webp'

ログパターンは、検索せずにログデータの価値を発見する最速の方法です。

ログデータは大量のテレメトリであり、個々のレコードあたりの価値は低い。検索すれば、根本的な原因を説明するログをすぐに見つけることができますが、ほとんどのデータは反復的で、閲覧時に文脈を理解するのは困難です。パターンは、価値の低いデータを読むのに多くの時間を費やすことなく、ログデータを発見できるようにします。

<img
  title="Logs patterns UI"
  alt="Screenshot of Log patterns UI"
  src={logsLogPatterns}
/>

<figcaption>
  **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Logs > Patterns** : ログパターンは、検索に余分な時間を費やすことなく、ログメッセージの疑わしいスパイクまたはドロップを見つけるのに役立ちます。
</figcaption>

## 技術概要 [#overview]

ログパターン機能は、機械学習を応用して、フォーマットは一貫しているが内容にばらつきがあるログメッセージを正規化してグループ化します。グループ化されたメッセージはソートされ、環境内で最も頻繁に発生するログや最も稀なログのセットを簡単に見つけることができます。

パターンを利用して、重要なデータの頻度が変化したときに警告を発したり、不要な繰り返しデータを削除するドロップルールを設定したりすることができます。

ログパターンは、高度なクラスタリングアルゴリズムを使用して、類似したログメッセージを自動的にグループ化します。パターンを使用すると、以下のことが可能になります。

* 数百万件のログをより早く解析することができます。
* ログエステートの異常な動作を発見するまでの時間を短縮します。
* 既知のパターンの頻度を長期的にモニタリングし、重要なものにエネルギーを集中させ、無関係なものを除外する。

## 入手方法 [#availability]

ログ UI で **Patterns are turned off** \[パターンがオフになっていると] 表示された場合は、 **Configure patterns** \[パターンの構成] をクリックして有効にします。機能を有効にしてから 30 分以内にパターンが表示されない場合は、システムがパターンを作成するためのメッセージ属性を持つデータが不足している可能性があります。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        ログパターン
      </th>

      <th>
        限界と検討事項
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        価格
      </td>

      <td>
        ログパターンには個別の価格設定はありません。唯一のコストは、生成された追加データがログ記録に追加された場合です。

        パターン属性は、パターンにマッチするすべてのログに追加されます。また、GUID、IPアドレス、URL、電子メールアドレスなどの共通の値が見つかった場合にも、属性が追加されることがあります。これらの属性は、パターン処理の一環として、ログメッセージから自動的に抽出されます。
      </td>
    </tr>

    <tr>
      <td>
        ヒットラスト・アカウント
      </td>

      <td>
        ログパターン機能はFedRAMPに準拠していません。FedRAMPまたは他のHITRUSTアカウントはパターンを使用することができません。
      </td>
    </tr>

    <tr>
      <td>
        ログのパターンマッチングの制限
      </td>

      <td>
        ログをパターンに照合する際に、メモリやCPUのリソースに安全制限を設ける仕組みがあります。これらのマッチング制限は、ログパターンにグループ化できるログの割合に影響を与えます。しかし、ログ パターン マッチングは"ベストエフォート" プロセスです。すべてのログがパターンによってグループ化される機会がなくてもエラーではありません。リソースの制限内で行うことができるグループ化からも価値を得ることができます。
      </td>
    </tr>
  </tbody>
</table>

## 始めましょう [#get-started]

パターンの検討を始めるために

1. **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Logs**に移動し、アカウント ピッカー ドロップダウンを使用して、パターンを調査するターゲット アカウントを選択します。
2. ログ UI の左側のナビゲーションで、 **Patterns** \[パターン]をクリックします。

メインログUIが変更され、クエリバーのクエリに一致するパターンが表示されます。特定の期間のログを表示するには、チャート上のそのポイントをクリックする（または領域をクリックしてドラッグする）か、タイムピッカーを使用します。

## ログパターンの探索 [#recents]

デフォルトでは、ログパターンのUIでは、最も頻繁に発生するパターンが最初に表示されます。稀なパターンを最初に表示するようにソートするには、 **Count** カラムをクリックします。また、クエリバーや属性バーを使用して、ログパターンをフィルタリングすることもできます。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        あなたがしたい場合は...
      </th>

      <th>
        これを行う...
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        パターンの変化率を理解する
      </td>

      <td>
        折れ線グラフを見てみましょう。色分けされたパターンは、表の **plot** の列に対応しています。個々の **plot** パターンを切り替えて、焦点を絞ることができます。
      </td>
    </tr>

    <tr>
      <td>
        各パターンにマッチする個々のログメッセージを見る
      </td>

      <td>
        **パターン** をクリックすると、行が展開され、個々のログレコードの表が表示されます。

        * その他の記録を見るには、上または下にスクロールしてください。
        * 各ログの詳細を確認するには、そのログをクリックして詳細パネルを開きます。
      </td>
    </tr>

    <tr>
      <td>
        パターンの属性によるグループ化とフィルタリング
      </td>

      <td>
        クエリバーとタイムピッカーを使用します。異なるフィルターや時間帯を適用すると、ログのパターンが新しいターゲットデータに合わせて調整されます。
      </td>
    </tr>

    <tr>
      <td>
        パターンからアラートを作成
      </td>

      <td>
        クエリバーにパターンを追加し、クエリを実行します。次に、左のナビで **Create alert condition** をクリックします。
      </td>
    </tr>

    <tr>
      <td>
        パターン化されていないログメッセージのトラブルシューティング
      </td>

      <td>
        [**Logs with no pattern** タブ](#logswithnopattern) **Log patterns** UI で使用します。
      </td>
    </tr>
  </tbody>
</table>

特定のログ メッセージをクリックすると、ログ UI で使い慣れたログ メッセージの詳細パネルが開きます。

## パターンのないログの探索 [#logswithnopattern]

**Logs with no pattern** タブは、まだ既知のパターンにクラスタリングされていないアカウントのすべての最近のログメッセージをグループ化します。これらのログメッセージは、システムの問題や欠陥を表しているわけではありません。機械学習システムによって処理されるには新しすぎるため、パターンがありません。そのため、最近環境が変わったことを理解したい場合には、これらのログメッセージを調査する価値があります。

例えば：

* これらのログの中に、最近の問題に関連するものはありますか？これは、お使いの環境で初めて出現するユニークなログデータを発見するための簡単な方法です。
* あなたのログデータは新しいフォーマットになっていませんか？時には、ログが問題を表しているのではなく、アプリケーションに期待されているデータモデルから逸脱した新しいフォーマットのログデータであることがあります。

このようなログを早期にキャッチすることで、開発者にログ出力の逸脱を修正するよう求めることができます。ログデータの生成方法に一貫性があればあるほど、多様なチームでログを使用することが容易になります。

## マスクされた属性とワイルドカード [#masked]

パターン内のログメッセージの一部は変数として分類され、マスキングされた属性で置き換えられます。マスキングプロセスは、アルゴリズムが変化する詳細を無視し、反復的な構造に焦点を当てることを可能にすることで、クラスタリングフェーズをサポートし、改善します。

マスクされた属性は以下の通りです。

* `date_time`
* `ip`
* `url`
* `uuid`

以下の例のように、マスクされたアトリビュートはハイライトされ、簡単に識別できます。

ログパターンは、マスクされた属性に属していない他のささいな変数を抽出します。これらの変数は、ワイルドカード`*`として示されます。

## トラブルシューティング [#nodata]

パターンを有効にしているにもかかわらず、パターンデータが表示されない理由は以下の通りです。これらの項目に当てはまらないと思われる場合は、 [support.newrelic.com](https://support.newrelic.com) までお問い合わせください。

* ご覧になっている時間帯にデータが届いていません。タイムピッカーで表示する時間帯を広げてみてください。
* アカウントでパターンが有効になってから24時間経っていません。つまり、このアカウントにはまだMLモデルが生成されていない可能性があります。
* 入ってくるデータには、 `message`フィールドがありません。パターンは、ログレコードの`message`フィールドの値に対してのみ生成されます。ログに`message`が含まれていない場合、データはありません。

## プラットフォームをパターンで活用する [#platform]

パターンは、 `newrelic.logPattern`という名前の新しい属性として既存のログメッセージに追加される値です。ログを使用して実行できることはすべて、通常、次のようなログパターンを使用して実行できます。

* パターンを使用して独自の[ダッシュボード](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards)を作成し、関心のある特定のパターンまたはパターンのグループを監視します。
* [NRQL アラートを追加してパターンに対するアラートを作成](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-nrql-alert-conditions).
* [異常アラート条件](/docs/alerts-applied-intelligence/new-relic-alerts/advanced-alerts/other-condition-types/create-anomaly-alert-conditions)を使用して、既知のログ パターンの異常を検出します。