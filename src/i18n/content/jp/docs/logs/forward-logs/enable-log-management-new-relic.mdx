---
title: ログをNew Relicに転送する
tags:
  - Logs
  - Enable log management in New Relic
  - Enable log monitoring in New Relic
metaDescription: How to forward your logs into New Relic so you can use enhanced log management capabilities.
translationType: machine
---

import newRelicLogsInContextDiagram from 'images/new-relic-logs-in-context-diagram.jpg'

当社のログ管理機能は、ログデータの収集、処理、調査、クエリ、およびアラートの作成に役立ちます。ログをNewRelicに取り込むには、次のオプションのいずれかを使用できます。

* アプリのAPMエージェントがログデータを直接NewRelicに転送[し、コンテキスト内のAPMログを](/docs/apm/new-relic-apm/getting-started/get-started-logs-context)使用できるようにします。追加のサードパーティソフトウェアをインストールまたは保守する必要はありません。
* アプリとホストのログの軽量データコレクターとして、[インフラストラクチャ監視用のガイド付きインストールを](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent)使用してください。
* [既存のログ転送ソリューション](#log-forwarding) を利用して、ログを収集し、New Relic に転送するメタデータを拡張します。
* [Log API](/docs/logs/log-api/introduction-log-api) を利用して、HTTP経由でログを転送します。
* [TCPエンドポイント](/docs/logs/log-api/use-tcp-endpoint-forward-logs-new-relic)を介してログを転送するには、syslogプロトコルを使用します。

## ログフォワーダーを始めよう [#compatibility-requirements]

APMエージェントが[コンテキストソリューションの自動ログを](/docs/apm/new-relic-apm/getting-started/get-started-logs-context#agents)まだサポートしていない場合は、コンテキストソリューションの手動ログを引き続き使用し、インフラストラクチャエージェントまたはサポートされているサードパーティのフォワーダーを介してログを転送できます。方法は次のとおりです。

1. New Relicアカウントをまだお持ちでない場合は、[New Relicアカウントを新たに作成します](https://newrelic.com/signup)。永久無料です。
2. New Relic アカウントの [ライセンスキー](/docs/accounts/install-new-relic/account-setup/license-key) を持っています。
3. [互換性のあるログフォワーダーのインストール](#log-forwarding).
4. TCP ポート 443 でのアウトバウンド接続が、 [CIDR 範囲](/docs/using-new-relic/cross-product-functions/install-configure/networks/#infrastructure) （ [地域](/docs/using-new-relic/welcome-new-relic/get-started/our-eu-us-region-data-centers) に一致）に対して許可されていることを確認してください。
5. 構成にはDNS名`log-api.newrelic.com`または`log-api.eu.newrelic.com`を使用します。
6. New Relic APMエージェントによって監視されるアプリの場合[、コンテキスト手順の手動ログ](/docs/logs/enable-log-management-new-relic/configure-logs-context/configure-logs-context-apm-agents/)に従ってエージェントを構成します。

## ログフォワーディングオプション [#log-forwarding]

ログをNewRelicに転送するためのソリューションをいくつか提供しています。

### インフラストラクチャエージェント（推奨） [#forward-infra]

ガイド付きインストールプロセスを使用して、[ログ管理とインフラストラクチャ監視をすばやく簡単に一緒にインストール](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/)してください。これは、アプリのログデータ**と**ホストのログデータの両方をNewRelicに取り込むための最も簡単なソリューションです。[これがどのよう](#enable)に機能するかのビデオをご覧ください。

インフラストラクチャのログ転送にホストメトリックが自動的に含まれる必要がない場合、またはすでにログフォワーダーがある場合は、次のサポートされているオプションのいずれかを使用して、ログをNewRelicに転送できます。

### アマゾン [#forward-amazon]

次のAmazonログフォワーダーをサポートしています。

* [AWS CloudWatchプラグイン](/docs/logs/forward-logs/aws-lambda-sending-cloudwatch-logs/)
* [AWS FireLensプラグイン](/docs/logs/forward-logs/aws-firelens-plugin-log-forwarding/)
* [AWS Kinesis Firehose](/docs/logs/forward-logs/stream-logs-using-kinesis-data-firehose/)
* [S3からのログ送信のためのAWS Lambda](/docs/logs/forward-logs/aws-lambda-sending-logs-s3/)

### マイクロソフト [#forward-microsoft]

次のMicrosoftログフォワーダーをサポートしています。

* [Azure ARM テンプレート](/docs/logs/forward-logs/azure-log-forwarding/)

### その他のサポートされているログフォワーダー [#forward-other]

これらのログフォワーダーもサポートしています。

* [クラウドフレア Logpush](/docs/logs/forward-logs/cloudflare-logpush-forwarding/)
* [Fluent Bitプラグイン](/docs/logs/forward-logs/fluent-bit-plugin-log-forwarding/)
* [Fluentdプラグイン](/docs/logs/forward-logs/fluentd-plugin-log-forwarding/)
* [Google Cloud Platform Pub/Sub](/docs/logs/forward-logs/google-cloud-platform-log-forwarding)
* [Herokuのログストリーミング](/docs/logs/forward-logs/heroku-log-forwarding/)
* [Kubernetesプラグイン](/docs/logs/forward-logs/kubernetes-plugin-log-forwarding/)
* [Logstashプラグイン](/docs/logs/forward-logs/logstash-plugin-log-forwarding/)
* [ベクタープラグイン](/docs/logs/forward-logs/vector-output-sink-log-forwarding/)

## TCPエンドポイント [#enable-endpoint]

状況によっては、ログフォワーダーがない場合があります。たとえば、CDN、ハードウェアデバイス、またはマネージドサービスを使用します。 `rsyslog`や`syslog-ng`などのsyslogプロトコルを使用して、 [TCPエンドポイント](/docs/logs/log-management/log-api/use-tcp-endpoint-forward-logs-new-relic/)を介してログをNewRelicに転送できます。

## ログのAPI [#enable-api]

プラグインをインストールせずにNew Relicに接続したい場合は、HTTP入力の統合を提供しています。このオプションは、 [Log API](/docs/logs/log-api/introduction-log-api) を介して、監視対象のログデータを直接 New Relic に送信します。

## 使い方 [#enable]

インフラストラクチャエージェントのガイド付きインストールプロセスを使用して、ログデータをすばやく簡単に転送できます。 New Relicでログデータを使用する方法の例を含め、その方法を学ぶには、YouTubeでこのNerdlogビデオをご覧ください（14:46分）。

<Video
  id="_II9Y-jOE7k"
  type="youtube"
/>

<CollapserGroup>
  <Collapser
    id="log-forwarding-diagram"
    title="New Relicへのログ転送のライフサイクル"
  >
    次の図は、アプリのログメッセージのライフサイクルを示しています。APMエージェントのメタデータによるエンリッチメント（コンテクストロギング）から、ログデータのフォーマット、New Relicへの転送までを示しています。

    <img
      title="Lifecycle of forwarding logs to New Relic"
      alt="Diagram of logs in context in New Relic"
      src={newRelicLogsInContextDiagram}
    />

    <figcaption>
      この図は、New Relicを介したログメッセージの流れを示しています。
    </figcaption>

    標準のログフォーマッタは、ログイベントを、ダウンストリームのユーザーやプロセスが使用できる意味のある出力（テキストファイルなど）に変換します。 `NewRelicFormatter`は、ログイベントをNewRelicが期待するJSON形式に変換します。これらのファイルには、ログ情報と拡張メタデータが含まれています。

    ログフォワーダ（当社のインフラ監視エージェント、Fluentd、Logstashなど）を設定すると、ログデータを拡張し、エンリッチすることもできます。 [ログをコンテキスト](/docs/logs/enable-log-management-new-relic/configure-logs-context/configure-logs-context-apm-agents/) に設定することで、ログエンリッチャーは、フォーマットされたログデータを、アプリケーションやホストからの追加のトランザクション情報とリンクさせます。

    これにより、ログファイルは、強化されたメタデータとコンテクストのあるロギングデータで強化されます。あなたのログフォワーダーは、ファイルを私たちのロギングエンドポイントに送って処理します。そこからは、New Relic のログ管理機能を使って、ログの表示、照会、アラートの設定などを行うことができます。
  </Collapser>
</CollapserGroup>

## 次のステップ [#what-next]

ログフォワーダーを有効にした後は、ログ管理機能を使ってNew Relicのデータを最大限に活用しましょう。

* [Logs UI](/docs/logs/ui-data/use-logs-ui) を使って、プラットフォーム全体のログデータを調査してください。
* [APM UI](/docs/logs/ui-data/use-logs-ui/#links) で、ログをアプリのパフォーマンスの文脈で見ることができます。 [エラーのトラブルシューティング](/docs/apm/apm-ui-pages/error-analytics/errors-page-find-fix-verify-problems/) [分散トレース](/docs/apm/distributed-tracing/ui-data/understand-use-distributed-tracing-data) 、スタックトレース、アプリケーションログ、その他。
* [インフラ監視エージェント](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/) でログを転送している場合、アプリケーションとプラットフォームの両方のパフォーマンスデータについてより深い可視性を得ることができます。UI で [インフラストラクチャ・ログ](/docs/logs/ui-data/use-logs-ui/#links) を確認します。
* [アラートの設定](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-alert-conditions/).
* [データを照会する](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) と [ダッシュボードを作成する](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/).例えば、 [データパーティションルール](/docs/apis/nerdgraph/examples/nerdgraph-data-partition-rules-tutorial) と [ログ解析ルール](/docs/apis/nerdgraph/examples/nerdgraph-log-parsing-rules-tutorial) の問い合わせと管理については、NerdGraph のチュートリアルをご覧ください。