---
title: ステップモニターの管理
tags:
  - Synthetics
  - APIs
  - NerdGraph
  - Examples
metaDescription: How to use New Relic NerdGraph API to create and update step monitors for synthetic monitoring.
freshnessValidatedDate: never
translationType: machine
---

New Relic では、NerdGraph を使用して[ステップ モニター](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors)を作成できます。ステップ モニターは、コードレスでマルチステップのブラウザーベースの監視を提供し、コードを記述せずに複雑なユーザー ワークフローを構成できます。このチュートリアルでは、NerdGraph API を使用してステップ モニターの作成を自動化する方法の例を示します。

## ステップモニターを作成する [#create-step-monitor]

`syntheticsCreateStepMonitor`ミューテーションを使用してステップ モニターを作成できます。このミューテーションにより、一連の定義済みアクションを使用して、マルチステップのブラウザ監視を設定できます。

### 入力

<table>
  <thead>
    <tr>
      <th>
        パラメータ
      </th>

      <th>
        データタイプ
      </th>

      <th>
        必須ですか?
      </th>

      <th>
        説明
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `accountId`
      </td>

      <td>
        整数
      </td>

      <td>
        はい
      </td>

      <td>
        モニターが作成される New Relic

        [アカウント ID](/docs/accounts/accounts-billing/account-structure/account-id)

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        配列
      </td>

      <td>
        はい
      </td>

      <td>
        モニターがジョブを実行するために使用するBrowser 。 サポートされているブラウザ: 

        `CHROME`

         、 

        `FIREFOX`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        配列
      </td>

      <td>
        はい
      </td>

      <td>
        モニターがジョブを実行するために使用するデバイス。サポートされているデバイス: 

        `DESKTOP`

         、 

        `MOBILE_LANDSCAPE`

         、 

        `MOBILE_PORTRAIT`

         、 

        `TABLET_LANDSCAPE`

         、 

        `TABLET_PORTRAIT`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        配列
      </td>

      <td>
        はい
      </td>

      <td>
        モニターがチェックを実行する 

        [パブリックロケーション](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

        識別子の配列 (例: 

        `["US_EAST_1", "US_WEST_1"]`

         )。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        弦
      </td>

      <td>
        はい
      </td>

      <td>
        歩数モニターの表示名。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        イナム
      </td>

      <td>
        はい
      </td>

      <td>
        モニターが実行される頻度。オプション: 

        `EVERY_MINUTE`

         、 

        `EVERY_5_MINUTES`

         、 

        `EVERY_10_MINUTES`

         、 

        `EVERY_15_MINUTES`

         、 

        `EVERY_30_MINUTES`

         、 

        `EVERY_HOUR`

         、 

        `EVERY_6_HOURS`

         、 

        `EVERY_12_HOURS`

         、 

        `EVERY_DAY`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        弦
      </td>

      <td>
        はい
      </td>

      <td>
        モニターで使用されるランタイム タイプ。受け入れられる値は

        `CHROME_BROWSER`

        のみです。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        弦
      </td>

      <td>
        はい
      </td>

      <td>
        モニターで使用されるランタイム タイプのバージョン。受け入れられる値は

        `100`

        のみです。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        イナム
      </td>

      <td>
        はい
      </td>

      <td>
        モニターのステータス。オプション: 

        `ENABLED`

         (モニターはアクティブでチェックを実行中)、 

        `DISABLED`

         (モニターは非アクティブ)。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.steps`
      </td>

      <td>
        配列
      </td>

      <td>
        はい
      </td>

      <td>
        モニターが実行する一連の手順。各ステップ オブジェクトには、 

        `ordinal`

         (ステップの位置、0 ～ 99)、 

        `type`

         ( 

        `NAVIGATE`

         、 

        `CLICK_ELEMENT`

         、 

        `DOUBLE_CLICK_ELEMENT`

         、 

        `ASSERT_TEXT`

         、 

        `ASSERT_TITLE`

        などのステップ タイプ)、および

        `values`

         (ステップ タイプに固有の値の配列) が含まれます。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        ブール値
      </td>

      <td>
        いいえ
      </td>

      <td>
        障害が発生したときやスクリプトが実行されたときのジョブ実行中にスクリーンショットをキャプチャします。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        浮く
      </td>

      <td>
        いいえ
      </td>

      <td>
        SLA レポートの入力に使用される、モニターの Apdex ターゲット (秒単位)。デフォルトは 7.0 秒です。
      </td>
    </tr>
  </tbody>
</table>

### サンプルリクエスト

```graphql
mutation {
  syntheticsCreateStepMonitor(
    accountId: ACCOUNT_ID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
      }
      status: STATUS
      steps: [
        {
          ordinal: 0,
          type: NAVIGATE,
          values: ["MONITORED_URI", "USER_AGENT"] }
        {
          ordinal: STEP_NUMBER
          type: STEP_TYPE
          values: ["CONDITIONAL_TYPE", "VALUE"]
        }
      ]
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### サンプル回答

成功した応答はエラーに対して`null`を返します:

```json
{
  "data": {
    "syntheticsCreateStepMonitor": {
      "errors": null
    }
  }
}
```

モニターの作成中に問題が発生した場合、 `errors`配列には、何が問題であったかを説明する`description`と`type`フィールドを持つオブジェクトが含まれます。

## ステップモニターを更新する [#update-step-monitor]

`syntheticsUpdateStepMonitor`ミューテーションを使用して既存のステップ モニターを更新できます。すでに作成されているステップモニターの設定を変更することができます。

### 入力

<table>
  <thead>
    <tr>
      <th>
        パラメータ
      </th>

      <th>
        データタイプ
      </th>

      <th>
        必須ですか?
      </th>

      <th>
        説明
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `guid`
      </td>

      <td>
        弦
      </td>

      <td>
        はい
      </td>

      <td>
        更新するモニターの一意のエンティティ

        [GUID](/docs/apis/nerdgraph/examples/synthetics-api/query-synthetics-data#query-monitors)

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        配列
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターがジョブを実行するために使用するBrowser 。 サポートされているブラウザ: 

        `CHROME`

         、 

        `FIREFOX`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        配列
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターがジョブを実行するために使用するデバイス。サポートされているデバイス: 

        `DESKTOP`

         、 

        `MOBILE_LANDSCAPE`

         、 

        `MOBILE_PORTRAIT`

         、 

        `TABLET_LANDSCAPE`

         、 

        `TABLET_PORTRAIT`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        配列
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターがチェックを実行する 

        [パブリックロケーション](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

        識別子の配列 (例: 

        `["US_EAST_1", "US_WEST_1"]`

         )。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        弦
      </td>

      <td>
        いいえ
      </td>

      <td>
        歩数モニターの更新された表示名。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        イナム
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターが実行される頻度。オプション: 

        `EVERY_MINUTE`

         、 

        `EVERY_5_MINUTES`

         、 

        `EVERY_10_MINUTES`

         、 

        `EVERY_15_MINUTES`

         、 

        `EVERY_30_MINUTES`

         、 

        `EVERY_HOUR`

         、 

        `EVERY_6_HOURS`

         、 

        `EVERY_12_HOURS`

         、 

        `EVERY_DAY`

         。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        弦
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターで使用されるランタイム タイプ。受け入れられる値は

        `CHROME_BROWSER`

        のみです。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        弦
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターで使用されるランタイム タイプのバージョン。受け入れられる値は

        `100`

        のみです。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        イナム
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターのステータス。オプション: 

        `ENABLED`

         (モニターはアクティブでチェックを実行中)、 

        `DISABLED`

         (モニターは非アクティブ)。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.steps`
      </td>

      <td>
        配列
      </td>

      <td>
        いいえ
      </td>

      <td>
        モニターが実行する一連の手順。各ステップ オブジェクトには、 

        `ordinal`

         (ステップの位置、0 ～ 99)、 

        `type`

         ( 

        `NAVIGATE`

         、 

        `CLICK_ELEMENT`

         、 

        `DOUBLE_CLICK_ELEMENT`

         、 

        `ASSERT_TEXT`

         、 

        `ASSERT_TITLE`

        などのステップ タイプ)、および

        `values`

         (ステップ タイプに固有の値の配列) が含まれます。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        ブール値
      </td>

      <td>
        いいえ
      </td>

      <td>
        障害が発生したときやスクリプトが実行されたときのジョブ実行中にスクリーンショットをキャプチャします。
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        浮く
      </td>

      <td>
        いいえ
      </td>

      <td>
        SLA レポートの入力に使用される、モニターの Apdex ターゲット (秒単位)。デフォルトは 7.0 秒です。
      </td>
    </tr>
  </tbody>
</table>

### サンプルリクエスト

```graphql
mutation {
  syntheticsUpdateStepMonitor(
    guid: ENTITY_GUID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
      }
      status: STATUS
      steps: [
        {
          ordinal: 0,
          type: NAVIGATE,
          values: ["MONITORED_URI", "USER_AGENT"]
        }
        {
          ordinal: STEP_NUMBER,
          type: STEP_TYPE,
          values: ["VALUE_1", "VALUE_2"]
        }
      ]
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### サンプル回答

成功した応答はエラーに対して`null`を返します:

```json
{
  "data": {
    "syntheticsUpdateStepMonitor": {
      "errors": null
    }
  }
}
```

モニターの更新中に問題が発生した場合、 `errors`配列には、何が問題であったかを説明する`description`と`type`フィールドを持つオブジェクトが含まれます。

## 歩数モニターを削除する [#delete-monitor]

ステップ モニターが不要になった場合は、 `syntheticsDeleteMonitor`ミューテーションを使用してそれを完全に削除できます。

モニターを削除するには、 [「合成モニターの削除」](/docs/apis/nerdgraph/examples/synthetics-api/ping-monitor/#delete-monitor)セクションを参照してください。