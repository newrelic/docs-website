---
title: 新しいBrowser SPA 監視
metaDescription: The new browser SPA monitoring capability is a streamlined way to monitor your users' experience and app performance.
freshnessValidatedDate: '2024-09-04T00:00:00.000Z'
translationType: machine
---

<Callout variant="important">
  既存のブラウザ SPA エクスペリエンスをデフォルトで置き換える機能フラグを使用して、この機能を段階的に展開しています。受信する新しい SPA バージョンを選択するオプションはありません。常に最新バージョンが自動的に取得されます。
</Callout>

## SPA (エージェント v1.298.0 でリリース)

以前のシングル ページ アプリケーション (SPA) で使用されていた広範なコールバック トラッキングを置き換えるために、長いタスクの考慮が導入されました。また、BrowserInteraction に関連付けられた AjaxRequest イベントの`jsDuration` 、 `timeToSettle` 、および`timeToLastCallbackEnd`属性を埋め戻す役割も果たします。

エージェントの`nrWrapper`によってラップされたネイティブ ブラウザ オブジェクトを*選択した*場合、そのコールバックの時間が計測されます。実行時間が 50 ミリ秒を超えるもの (長いタスク) は、BrowserInteraction を拡張できます。これは、インタラクションが自然に発生するタイミングを決定するためのソフト ナビゲーション ヒューリスティックに従っています。これで、インタラクションはさらに 5 秒間待機して、長いタスクがない期間まで継続時間を延長し、終了時間がそれに応じて再調整されます。

以前は、インタラクションに関連付けられた AjaxRequest はコールバックのタイミングを報告または追跡しなかったため、上記の 3 つの属性の値が無効になっていました。今回の更新では、インタラクションの一部であり、長いタスクを引き起こすイベント リスナーを含む`XMLHttpRequest` ( `fetch`は除く) の`jsDuration` 、 `timeToSettle` 、および`timeToLastCallbackEnd`属性が更新され、長いコールバックのタイミングが反映されます。

## SPA (エージェント v1.253.0 でリリース)

顧客監視browserシングル ページ アプリケーション (SPA) については、数多くの問題点に対処することを目的とした SPA 監視機能の見直しを発表できることを嬉しく思います。

* 最新バージョンが使用できない: サードパーティのライブラリとの頻繁な競合と信頼性の低いインタラクション キャプチャが既存のエージェントに問題を引き起こし、最新バージョンが使用できなくなることがよくありました。
* パッチワーク ソリューション: SPA パッチで 1 つの問題に対処すると、別の問題が発生することが多く、修正と回帰のイライラするサイクルが発生します。
* サードパーティ ライブラリの競合: グローバル ラッピング、特に`Promises`周りでは、他のライブラリとの競合によりコードの機能が中断されることがよくあります。
* パフォーマンス ボトルネック: タイマー、RAF、Promise チェーンを使用するコードとの競合により、速度低下からフリーズに至るまでパフォーマンスの問題が発生しました。

更新された SPA 監視エクスペリエンスは、これらの問題を解消し、大幅に改善された監視エクスペリエンスを提供するように設計されています。 主な変更点は次のとおりです。

* アンラップされた実行: コア グローバルをラップしないことで、新しい SPA エクスペリエンスはアプリケーションの実行速度を大幅に向上させます。

* ソフト ナビゲーション ヒューリスティックとの調整: 新しいエクスペリエンスには Google Chrome のソフト ナビゲーションが採用されており、より正確なインタラクション トラッキングとbrowser動作との調整が改善されています。

* インタラクションの決定の簡素化: インタラクションはUIイベント (クリック/キーダウン/送信 -&gt; ルート変更 -&gt; DOM変更) として定義されるようになり、より明確で効率的なキャプチャ アプローチが提供されます。
  * イベントの関連付けが解除される可能性: UI主導のインタラクションへの重点を反映して、以前に関連付けられていた `AjaxRequest` および `JavascriptError` イベントがインタラクションから関連付けが解除される可能性があります。

* 主要なメトリクスに焦点を当てる: レポートされるデータはほとんど変更されていませんが、新しいエクスペリエンスでは、インタラクション内の JavaScript の実行やコールバック期間が追跡されなくなり、レポートされる情報が合理化されます。

* インタラクション時間の短縮: 特にルート変更の場合、インタラクション時間が大幅に短縮されます。 最初のページの読み込みはわずかに短縮されます。

* API の更新:

  * 新しいオプションの引数`.interaction({waitForEnd: true})`が[`.interaction()`](/docs/browser/new-relic-browser/browser-apis/interaction/)関数に追加されました: これにより、ユーザー インタラクションの終了時刻をカスタマイズできます。 既存の`.interaction()`機能は変更されません。
  * 非推奨の API: 関数[`createTracer`](/docs/browser/new-relic-browser/browser-apis/createtracer/) : 関数`createTracer`は引き続き機能しますが、インタラクションを開いたままにしたり、コールバックの時間を計ったりしなくなったため、非推奨になりました。 注意: 新しい SPA エクスペリエンスで`createTracer`引き続き使用すると、 `BrowserTiming`イベントは作成されません。

## 既知の問題 [#known-issues]

* API の使用法:

  * `newrelic.interaction().end()` 回避策: 以前にこれを使用してインタラクション クロージャーの問題に対処した場合、余分な不要なインタラクションが表示される可能性があります。 最適な結果を得るために使用方法を確認してください。
  * `createTracer()` 機能の変更: `createTracer()`インタラクションを開いたままにしたり、コールバックの時間を計ったりしなくなりました。 JavaScript コードの追跡にこれに依存していた場合は、別の方法を検討してください。

* `AjaxRequest` 協会：

  * インタラクションからの除外の可能性: 前回のインタラクションの終わり近くに開始された Ajax リクエストは、インタラクションの継続時間が短縮されたため、除外される可能性があります。
  * 手動拡張: リクエストを特定のインタラクションにプロパティ設定する必要がある場合は、 [`.interaction()`](/docs/browser/new-relic-browser/browser-apis/interaction/)関数に追加された引数`.interaction({waitForEnd: true})`を使用して、リクエストが起動されるまでインタラクションを開いたままにし、その後インタラクション`.end()` 。 これにより、リクエストがインタラクションに関連付けられます。

## フィードバックを残す [#feedback]

バグ、機能リクエスト、パフォーマンスの改善を報告するには、 [GitHub の問題を送信してください](https://github.com/newrelic/newrelic-browser-agent/issues)。

その他のフィードバックについては、件名を`[SoftNav]: `で始める電子メールを`browser-agent@newrelic.com`に送信して、ご意見やご提案をお寄せください。