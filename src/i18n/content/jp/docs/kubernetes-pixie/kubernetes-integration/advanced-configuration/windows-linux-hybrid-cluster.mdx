---
title: Windows ノードと Linux ノードのハイブリッド クラスタへのインストール
tags:
  - Kubernetes
  - Windows
  - Linux
  - Installation
metaDescription: Learn how to install New Relic to a hybrid Windows and Linux Kubernetes cluster.
freshnessValidatedDate: '2024-04-05T00:00:00.000Z'
translationType: machine
---

このドキュメントでは、Windows と Linux が混在するクラスタ向けのKubernetesインテグレーションのインストールについて説明します。

## 前提条件 [#prerequisites]

先に進む前に、以下を完了していることを確認してください。

* Windows ノードと Linux ノードを含むクラスター。コンテナー イメージを Windows ノードにプルする機能も備えています。

* Helm リポジトリをセットアップし、ネームスペースを作成します。

  ```shell
  helm repo add newrelic https://helm-charts.newrelic.com
  helm repo update
  kubectl create namespace newrelic
  ```

## 現在のチャートバンドルをインストールする [#install-chart-bundle]

`newrelic/nri-bundle`チャートは、Linux ノード上のすべての最新の更新情報を含む通常のチャートです。 `newrelic-logging`チャートを Windows にインストールするように構成できます。 この機能は信頼性が高く、ログ チャートでサポートされています。

他のチャートを使用することもできますが、Windows へのスケジュールを回避するには`NodeSelector`を構成する必要があります。 ガイド付きインストールのデフォルト値を使用して混合クラスタでインストールが失敗する場合は、 `nodeSelector`値を追加します。

お気に入りのテキスト エディターで値ファイルを作成し、それを`values.yaml`と呼びます。 New Relic UI からスターター`values.yaml`ファイルをダウンロードできます。 Kubernetesインテグレーションを追加し、インストゥルメント方法として**Helm**を選択します。

```yaml
global:
  licenseKey: mykey
  cluster: mycluster
  lowDataMode: true
 
newrelic-infrastructure:
  enabled: true
  nodeSelector:
    kubernetes.io/os: linux
 
kube-state-metrics:
  enabled: true
  image:
    tag: v2.10.0
  nodeSelector:
    kubernetes.io/os: linux
 
nri-kube-events:
  enabled: true
  nodeSelector:
    kubernetes.io/os: linux
 
newrelic-logging:
  enabled: true
  enableWindows: true
 
nri-metadata-injection:
  enabled: true
  nodeSelector:
    kubernetes.io/os: linux
 
newrelic-prometheus-agent:
  enabled: true
  verboseLog: true
  config:
    kubernetes:
      integrations_filter:
        enabled: false
  nodeSelector:
    kubernetes.io/os: linux
```

## バンドルをインストールする [#install-bundle]

バンドルをインストールするには、次のコマンドを実行します。

```shell
helm upgrade --install newrelic-bundle newrelic/nri-bundle --namespace newrelic -f values-newrelic.yaml

```

Helm が戻ると、各 Windows ノードのログ記録ポッドを含むすべてのポッドが起動します。 Windows ノードにはまだ他の New Relic ポッドはありません。

## Windows ノード用の newrelic-infrastructure プレビューのインストール [#newrelic-infra]

`newrelic-infrastructure` v2 チャートの値ファイルを作成します。 たとえば、 `windows-values.yaml` 。 以下の例は、Windows 2022 ノードグループまたはノード プールを持つクラスターの場合です。 [次の手順](/docs/kubernetes-pixie/kubernetes-integration/installation/kubernetes-integration-install-configure/#windows-install)に従って、 `windowsOsList`セクションを正しい値に調整します。 これは、2019 または 2022 を実行している場合に適用されます。

```yaml
global:
  licenseKey: mykey
  cluster: mycluster
 
enableLinux: false
enableWindows: true
windowsOsList:
  - version: 2022
    imageTag: 2-windows-ltsc2022-alpha
    buildNumber: 10.0.20348
windowsNodeSelector:
  kubernetes.io/os: windows
```

`newrelic-infrastructure`チャートの v2.7.2 バージョンをインストールします。 次のコマンドを実行します:

```shell
helm upgrade --install newrelic-windows newrelic/newrelic-infrastructure --namespace newrelic --version 2.7.2 -f windows-values.yaml
```

Helm が戻ると、各 Windows ノードに`newrelic-windows-newrelic-infrastructure`のポッドが表示されます。

## 予想された結果 [#expected-results]

すべての設定が完了すると、 New Relic UI Kubernetes クラスタ内の Windows ノードが表示されます。 インフラストラクチャ メトリック、実行中のポッド、および関連するすべての情報が表示されます。