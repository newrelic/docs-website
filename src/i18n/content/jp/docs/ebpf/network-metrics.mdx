---
title: eBPFネットワークメトリクス
metaDescription: Learn how to configure New Relic eBPF network monitoring dashboard.
tags:
  - Integrations
  - eBPF integration
  - eAPM
  - eBPF Network monitoring
  - extended Berkeley Packet Filter (eBPF)
  - Linux host
  - Kubernetes cluster
freshnessValidatedDate: never
translationType: machine
---

<Callout title="プレビュー">
  この機能はまだ開発中ですが、ぜひお試しください。

  この機能は現在、弊社の[プレリリース ポリシー](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/)に従ってプレビューの一部として提供されています。 HIPAA または FedRAMP 規制の対象となる顧客にはご利用いただけません。
</Callout>

eBPF ネットワーク監視は、重要な DNS および TCP メトリクスをカーネルから直接追跡することにより、システムのネットワーク状態を詳細に可視化します。 DNS 解決と TCP 接続の成功率と失敗率を分析することで、接続の問題を診断できます。TCP ハンドシェイク、パケット配信、短期間の接続の継続時間など、監視キー レイテンシによってパフォーマンス ボトルネックを特定します。 ダッシュボードでは、送信バイト数、受信バイト数、ドロップされたパケット数を視覚化することで、データ スループットを追跡することもできます。

## デプロイメントのオプション [#deployment-options]

現在の監視設定に応じて、次の 2 つの方法で eBPF ネットワーク メトリクスを有効にできます。

* **既存のNew Relic APMカスタマーの場合:** New Relic APMエージェント デプロイをすでにお持ちの場合は、既存の計装と一緒に eBPF ネットワーク メトリクスを追加できます。 eBPF エージェントはネットワーク専用モードで動作し、現在のセットアップを中断することなく、 APMデータをカーネル レベルのネットワーク インサイトで補完します。

* **包括的な監視の場合:** eAPMとネットワーク メトリクス機能の両方を備えた完全な eBPF エージェントをデプロイして、アプリケーション、インフラストラクチャ、およびネットワーク層全体にわたる完全なオブザーバビリティを実現します。 このアプローチでは、単一エージェントを通じて統合されたテレメトリー収集が提供されます。

どちらのデプロイメント オプションも、以下で説明する同じネットワーク監視機能を提供します。

## ネットワーク監視機能 [#network-capabilities]

ネットワーク メトリクス ダッシュボードには、ネットワーク パフォーマンスのさまざまな側面を監視する次のタブがあります。

* **エラー:** DNS、TCP、およびその他のネットワーク関連のエラーを表示します。
* **レイテンシ:** TCP ハンドシェイク、パケット配信、短期接続の継続時間などのモニター キー レイテンシ。
* **パケット損失:**送信中にドロップされたパケットを追跡します。また、カーネル パケットのドロップ、TCP 接続のタイムアウト、パケットの再送信などの情報も含まれます。
* **TCP フラグ:**受信トラフィックと送信トラフィックの両方について、TCP 接続のステータス フラグを表示します。
* **接続:**受信および送信 TCP 接続、接続数、平均接続期間、最大接続期間を表示します。

## eBPFネットワーク監視に登録する [#enroll-pp]

eBPF ネットワーク監視には、 <DNT>**Preview &amp; Trials**</DNT>ページから登録できます。

1. <DNT>**[one.newrelic.com &gt; Administration](https://one.newrelic.com/admin-portal)**</DNT>に移動します。
2. 左側のナビゲーションから<DNT>**Preview &amp; Trials**</DNT>をクリックします。
3. 利用可能なプレビュー機能のリストから、 <DNT>**eBPF network monitoring**</DNT>をクリックします。
4. 画面上の指示に従い、利用規約に同意してオンボーディングを完了します。これで、APM から新しい eBPF ネットワーク監視機能を体験できるようになります。

## 既存のAPM顧客に対してネットワーク メトリクス専用モードを有効にする [#network-only-mode]

New Relic APMエージェント デプロイをすでにお持ちで、現在の計装を中断せずにネットワークの可視性を追加したい場合は、ネットワーク メトリクス専用モードで動作するように eBPF エージェントを設定できます。 これにより、既存のAPMデータを補完するカーネル レベルのネットワーク インサイトが提供されます。

ネットワーク メトリクス専用モードが有効になっている場合、eBPF エージェントは、 eAPMデータ収集を抑制しながら、ネットワーク テレメトリー データを収集して報告します。 これにより、既存のAPM計画を維持しながら、ネットワーク層の可視性をさらに高めることができます。

### Kubernetes環境の場合 [#k8s-env]

<CollapserGroup>
  <Collapser className="freq-link" id="k8s-new" title="新しいインストレーション">
    次のコマンドを実行して、新しいKubernetesインストレーションでネットワーク メトリクス専用モードを有効にします。

    ```bash
    KSM_IMAGE_VERSION="v2.13.0" && helm repo add newrelic https://helm-charts.newrelic.com && helm repo update && kubectl create namespace "newrelic" ; helm upgrade --install nr-ebpf-agent newrelic/nr-ebpf-agent --set licenseKey=<your-license-key> --set cluster="cluster-name-ebpf" --set apmDataReporting=false --namespace=newrelic
    ```
  </Collapser>

  <Collapser className="freq-link" id="k8s-existing" title="既存のインストレーション">
    既存のKubernetesインストレーションでネットワーク メトリクス専用モードを有効にするには、次の手順に従います。

    1. 次の`apmDataReporting`キーと値`false`を`values.yaml`ファイルに追加します。

       ```yaml
       apmDataReporting: false
       ```

    2. 設定を適用します。

       ```bash
           helm repo update ; helm upgrade --install nr-ebpf-agent newrelic/nr-ebpf-agent -n newrelic --values values.yaml
       ```
  </Collapser>
</CollapserGroup>

### Linuxホスト環境 [#linux-env]

<CollapserGroup>
  <Collapser className="freq-link" id="linux-new" title="新しいインストレーション">
    次のコマンドを実行して、新しい Linux ホスト インストレーションでネットワーク メトリクス専用モードを有効にします。

    ```bash
    curl -Ls https://download.newrelic.com/install/newrelic-cli/scripts/install.sh | sudo bash && sudo DEPLOYMENT_NAME=<deployment-name> NEW_RELIC_API_KEY=<your-api-key> NEW_RELIC_ACCOUNT_ID=<your-account-id> NEW_RELIC_REGION=US NEW_RELIC_CLI_SKIP_CORE=1 /usr/local/bin/newrelic install -n ebpf-agent-installer
    ```
  </Collapser>

  <Collapser className="freq-link" id="linux-existing" title="既存のインストレーション">
    既存の Linux ホスト インストレーションでネットワーク メトリクス専用モードを有効にするには、以下の手順に従ってください。

    1. 次の`apmDataReporting`キーと値`false`を`newrelic-ebpf-agent.conf`ファイルに追加します。

       ```bash
       APM_DATA_REPORTING="false"
       ```

    2. eBPF エージェント サービスを再起動します。

       ```bash
       sudo systemctl restart newrelic-ebpf-agent
       sudo systemctl restart newrelic-ebpf-agent-client
       ```
  </Collapser>
</CollapserGroup>

## eBPFネットワーク監視データを見る [#view-network-data]

New Relic APM UI で eBPF ネットワーク監視データを表示できます。

1. **[one.newrelic.com](https://one.newrelic.com) &gt; APM &amp; Services**に移動します。
2. 必要な eBPF エンティティを選択します。
3. Monitor \[モニター]セクションで、 **Network Metrics** \[ネットワーク メトリクス]をクリックします。 ネットワーク メトリクスが表示されます。

<Callout variant="tip">
  eBPF エージェントは、環境に応じて異なるエンティティ名を自動的に生成します。

  * ホストまたは Docker では、これらの名前はプロセス名、そのディレクトリまたはコンテナ ID、およびリスニング ポートの組み合わせです。たとえば、 `ruby:/home/ubuntu/app:[5678]`または`java:f4aead533895:[8080]` 。

  * Kubernetes では、これらの名前はサービス名から派生されます (例: `mysql-database-service` )。

  アプリケーションにカスタム名を割り当てる:

  * dockerコンテナとオンホスト アプリケーションの両方に`NEW_RELIC_APP_NAME`環境変数を設定することで、アプリケーションに任意の名前を割り当てることができます。

  * 名前付きアプリケーションは、 New Relic UI に`-ebpf`というサフィックスが付いて表示されます。
</Callout>

<DocTiles>
  <DocTile title="eBPF Kubernetesインストレーション" path="/docs/ebpf/k8s-installation/">
    Kubernetesクラスタ用にNew Relic eBPFエージェントを設定する方法を学びます。
  </DocTile>

  <DocTile title="eBPF Linux のインストール" path="/docs/ebpf/linux-installation/">
    Linux ホストに New Relic eBPF エージェントを設定する方法を学びます。
  </DocTile>

  <DocTile title="eBPFのトラブルシューティング" path="/docs/ebpf/troubleshooting/no-ui-data/">
    New Relic eBPF エージェントの問題をトラブルシューティングする方法を学びます。
  </DocTile>
</DocTiles>