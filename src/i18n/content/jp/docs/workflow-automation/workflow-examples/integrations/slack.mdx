---
title: Slackにレポートを送信する
tags:
  - workflow automation
  - workflow
  - slack
  - reporting
metaDescription: 'Execute NRQL queries, convert results to CSV, and post to Slack channels.'
freshnessValidatedDate: never
translationType: machine
---

NRQL クエリを実行し、結果を CSV に変換して Slack に投稿します。

**要件：**

* NRQLクエリ
* 秘密の Slack トークン。

**このワークフローの機能:**

* New Relicアカウントに対してNRQLを実行する
* クエリ結果からCSVを生成する
* CSV をメッセージとともに Slack チャンネルに投稿する

**キーアクション**: `newrelic.nrdb.query` 、 `utils.transform.toCSV` 、 `slack.chat.postMessage`

```yaml
  name: nrqlToSlackReport

  workflowInputs:
    accountId:
      type: Int
    nrqlQuery:
      type: String
      defaultValue: 'FROM Transaction SELECT count(*) FACET appName SINCE 1 hour ago'
    slackChannel:
      type: String

  steps:
    - name: queryData
      type: action
      action: newrelic.nrdb.query
      version: 1
      inputs:
        accountIds:
          - ${{ .workflowInputs.accountId }}
        query: ${{ .workflowInputs.nrqlQuery }}

    - name: convertToCSV
      type: action
      action: utils.transform.toCSV
      version: 1
      inputs:
        data: ${{ .steps.queryData.outputs.results | tostring }}

    - name: postToSlack
      type: action
      action: slack.chat.postMessage
      version: 1
      inputs:
        token: ${{ :secrets:slack_token }}
        channel: ${{ .workflowInputs.slackChannel }}
        text: 'NRQL Query Report'
        attachment:
          filename: 'query-results.csv'
          content: ${{ .steps.convertToCSV.outputs.csv }}
```

## 次のステップ

* **[AWS SQS](/docs/workflow-automation/workflow-examples/integrations/aws-sqs)** : SQSキューにメッセージを送信する
* **[REST APIポーリング](/docs/workflow-automation/workflow-examples/integrations/rest-api-polling)**:外部APIをポーリングする