---
title: EC2インスタンス管理
tags:
  - workflow automation
  - workflow
  - aws
  - ec2
metaDescription: 'Respond to CPU alerts, request Slack approval, and automate EC2 instance resizing.'
freshnessValidatedDate: never
translationType: machine
---

New Relic CPU アラートに応答し、Slack の承認をリクエストし、 AWS Systems Manager 経由で EC2 インスタンスのサイズ変更を自動化します。

**要件：**

* AWS 認証情報 (EC2 + Systems Manager)
* New Relicアラートの条件
* Slack について

**このワークフローの機能:**

* New RelicからCPU使用率が高いというアラートを受信する
* 多数の詳細を取得し、影響を受ける EC2 インスタンスを特定する
* インスタンスの詳細を含む Slack 通知を送信し、承認をリクエストします
* 承認後にSSMドキュメントを作成してサイズ変更を自動化する
* インスタンスを停止し、インスタンスタイプを変更して再起動する
* サイズ変更中に進捗状況を Slack に送信する
* 完了を待ってステータスを送信します
* SSM ドキュメントをクリーンアップして最終確認を送信します

**キーアクション**: `newrelic.nerdgraph.execute` 、 `newrelic.nrdb.query` 、 `slack.chat.postMessage` 、 `slack.chat.getReactions` 、 `aws.systemsManager.writeDocument` 、 `aws.systemsManager.startAutomation` 、 `aws.systemsManager.waitForAutomationStatus` 、 `aws.systemsManager.deleteDocument` 、 `utils.datetime.fromEpoch` 、 `utils.uuid.generate`

## 次のステップ

* **[APIゲートウェイのロールバック](/docs/workflow-automation/workflow-examples/advanced/api-gateway-rollback)**: APIゲートウェイの自動化
* **[デプロイメントのロールバック](/docs/workflow-automation/workflow-examples/advanced/deployment-rollback)**: デプロイメントの監視