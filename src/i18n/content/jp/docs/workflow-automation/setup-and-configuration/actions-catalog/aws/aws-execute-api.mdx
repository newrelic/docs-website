---
title: AWS 実行 API
tags:
  - workflow automation
  - workflow
  - workflow automation actions
  - AWS actions
  - AWS Execute API
metaDescription: A list of available aws execute api in the actions catalog for workflow definitions
freshnessValidatedDate: never
translationType: machine
---

<Callout title="プレビュー">
  この機能はまだ開発中ですが、ぜひお試しください。

  この機能は現在、弊社の[プレリリース ポリシー](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy)に従ってプレビュー プログラムの一部として提供されています。
</Callout>

このページでは、ワークフロー オートメーション アクション カタログで利用可能な AWS 実行 API の包括的なリファレンスを提供します。 これらのアクションにより、任意の AWS API 操作を実行できます。

## 前提条件

ワークフロー自動化で AWS アクションを使用する前に、次の点を確認してください。

* 適切な権限を持つ AWS アカウント。
* 設定された AWS 認証情報 (IAM ユーザー認証情報、IAM ロール ARN、またはセッション認証情報)。
* 使用する予定の特定のAWSサービスに必要な IAM 権限。

IAM ユーザーおよび IAM ロールを作成する方法、およびワークフロー オートメーションAWSアクションと統合するための静的 AWS 認証情報とセッションAWS認証情報を設定する方法については[、「 AWS認証情報のセットアップ」を](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/)参照してください。

## セキュリティとIAMの設定

このアクションを使用するには、AWS 認証情報を設定する必要があります。IAM ロールまたは IAM ユーザーを作成する詳細な手順については、 [「AWS 認証情報の設定」を](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/)参照してください。

<Callout variant="important">
  **セキュリティのベストプラクティス:**このアクションの IAM ポリシーを定義するときは、常に最小特権アクセスを使用してください。 ワークフローに必要な特定の AWS API アクションのみを許可し、ワイルドカードを使用するのではなく、特定のリソースへのアクセス許可を制限します。
</Callout>

## 必要なIAM権限

必要なアクセス許可は、ワークフローが呼び出すAWSサービスと API によって異なります。 最小権限ポリシーを作成するためのテンプレートとして以下の例を使用してください。

**例1: 特定のSQSキューにメッセージを送信する**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "sqs:SendMessage",
        "Resource": "arn:aws:sqs:us-west-2:<your-aws-account-id>:<your-queue-name>"
      }
    ]
  }
```

**例 2: 特定の DynamoDB テーブルをクエリする**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "dynamodb:Query",
        "Resource": "arn:aws:dynamodb:us-west-2:<your-aws-account-id>:table/<your-table-name>"
      }
    ]
  }
```

**例3: 特定の権限を持つ複数のサービス**

```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "sqs:SendMessage",
        "Resource": "arn:aws:sqs:us-west-2:<your-aws-account-id>:<your-queue-name>"
      },
      {
        "Effect": "Allow",
        "Action": "dynamodb:Query",
        "Resource": "arn:aws:dynamodb:us-west-2:<your-aws-account-id>:table/<your-table-name>"
      }
    ]
  }
```

<Callout variant="important">
  * `<your-aws-account-id>` 、 `<your-queue-name>` 、 `<your-table-name>`を実際の値に置き換えます
  * [Boto3 ドキュメント](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/index.html)で利用可能なAWSサービス API を見つけてください。
  * より複雑なIAMポリシーパターンについては、 [AWS IAMドキュメントを](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html)参照してください。
</Callout>

このアクションの動作の詳細については、 [AWS Systems Manager の executeAwsApi ドキュメント](https://docs.aws.amazon.com/systems-manager/latest/userguide/automation-action-executeAwsApi.html)を参照してください。

## AWS APIを呼び出す [#aws-execute-api]

指定されたサービスに対して任意の AWS API 操作を実行します。AWS認証情報、リージョン、サービス名、 API名、およびオプションの懸念の提供をサポートします。 このアクションは、成功ステータス、応答データ、エラーメッセージなどの出力を返すことができるため、 AWSサービスとプログラム的にやり取りするための多用途性が得られます。

<Tabs>
  <TabsBar>
    <TabsBarItem id="awsexecuteinputs">
      入力
    </TabsBarItem>

    <TabsBarItem id="awsexecuteoutputs">
      出力
    </TabsBarItem>

    <TabsBarItem id="awsexecuteexamples">
      例
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="awsexecuteinputs">
      <table>
        <thead>
          <tr>
            <th>
              入力フィールド
            </th>

            <th>
              オプション性
            </th>

            <th>
              タイプ
            </th>

            <th>
              例
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
              **awsRoleArn**
            </td>

            <td>
              オプション
            </td>

            <td>
              弦
            </td>

            <td>
              `arn:aws:iam::123456789012:role/my-workflow-role`
            </td>
          </tr>

          <tr>
            <td>
              **awsAccessKeyId**
            </td>

            <td>
              オプション
            </td>

            <td>
              弦
            </td>

            <td>
              `${{ :secrets:<awsAccessKeyId> }}`
            </td>
          </tr>

          <tr>
            <td>
              **awsSecretAccessKey**
            </td>

            <td>
              オプション
            </td>

            <td>
              弦
            </td>

            <td>
              `${{ :secrets:<awsSecretAccessKey> }}`
            </td>
          </tr>

          <tr>
            <td>
              **awsSessionToken**
            </td>

            <td>
              オプション
            </td>

            <td>
              弦
            </td>

            <td>
              `${{ :secrets:<awsSessionToken> }}`
            </td>
          </tr>

          <tr>
            <td>
              **リージョン**
            </td>

            <td>
              必須
            </td>

            <td>
              弦
            </td>

            <td>
              `region: "us-east-2"`
            </td>
          </tr>

          <tr>
            <td>
              **サービス**
            </td>

            <td>
              必須
            </td>

            <td>
              弦
            </td>

            <td>
              `service: "sqs"`

              [AWSで利用可能なサービス](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/index.html)
            </td>
          </tr>

          <tr>
            <td>
              **API**
            </td>

            <td>
              必須
            </td>

            <td>
              弦
            </td>

            <td>
              `api: "create_queue"`
            </td>
          </tr>

          <tr>
            <td>
              **パラメーター**
            </td>

            <td>
              必須
            </td>

            <td>
              地図
            </td>

            <td>
              ```yaml
                parameters: {
                  "QueueName": "dks-testing-queue",
                  "Attributes": {
                      "DelaySeconds": "0",
                      "MessageRetentionPeriod": "86400"
                  }
                }
              ```
            </td>
          </tr>

          <tr>
            <td>
              **セレクター**
            </td>

            <td>
              オプション
            </td>

            <td>
              リスト
            </td>

            <td>
              `[{\"name\": \"response\", \"expression\": \".response\"}, {\"name\": \"success\", \"expression\": \".success\"}, {\"name\": \"errorMessage\", \"expression\": \".errorMessage\"}]`
            </td>
          </tr>
        </tbody>
      </table>
    </TabsPageItem>

    <TabsPageItem id="awsexecuteoutputs">
      <table>
        <thead>
          <tr>
            <th>
              出力フィールド
            </th>

            <th>
              タイプ
            </th>

            <th>
              例
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
              **response**
            </td>

            <td>
              オブジェクト
            </td>

            <td>
              `{"response":<aws api reponse>}`

               \- 各サービスと API には異なる応答があります。たとえば、 

              [DynamoDB クエリの応答を](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/dynamodb/client/query.html)

              参照してください。
            </td>
          </tr>

          <tr>
            <td>
              **成功**
            </td>

            <td>
              ブール値
            </td>

            <td>
              `success: true | false`
            </td>
          </tr>

          <tr>
            <td>
              **エラーメッセージ**
            </td>

            <td>
              弦
            </td>

            <td>
              `errorMessage: "User does not have permission to query DynamoDB"`
            </td>
          </tr>
        </tbody>
      </table>

      <Callout variant="important">
        * AWS 認証情報 (ショート、ロング、ロール) の少なくとも 1 つを入力する必要があります。ロールは他の認証情報よりも優先されます。
        * アクション入力で`awsAccessKeyId`と`awsSecretAccessKey`を指定する場合、それらが IAM ユーザーの静的認証情報であることを確認してください。
        * セッション資格情報を使用する場合は、 `awsAccessKeyId` 、 `awsSecretAccessKey`および`awsSessionToken`アクション入力に渡す必要があります。
        * 手順については、 [AWS 認証情報](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/)を参照してください。
        * セレクターを使用して、指定されたもののみを出力として取得します。
      </Callout>
    </TabsPageItem>

    <TabsPageItem id="awsexecuteexamples">
      ### 例: DynamoDB テーブルをクエリする

      この例では、セッション認証情報を使用して`aws.execute.api`アクションを使用して DynamoDB テーブルをクエリする方法を示します。

      ```yaml
        name: aws_execute_api_dynamoDB_dks

        workflowInputs:
          key:
            type: String
            defaultValue: "${{ :secrets:<aws_access_key_id> }}"
          access:
            type: String
            defaultValue: "${{ :secrets:<aws_secret_access_key? }}"
          token:
            type: String
            defaultValue: "${{ :secrets:<aws_session_token> }}"
          region:
            type: String
            defaultValue: us-east-2
          tableName:
            type: String
            defaultValue: workflow-definitions-dev
          scopedName:
            type: String
          version:
            type: String
            defaultValue: "1"

        steps:
          - name: executeApi
            type: action
            action: aws.execute.api
            version: 1
            inputs:
              awsAccessKeyId: ${{ .workflowInputs.key }}
              awsSecretAccessKey: ${{ .workflowInputs.access }}
              awsSessionToken: ${{ .workflowInputs.token }}
              region: ${{ .workflowInputs.region }}
              service: dynamodb
              api: query
              parameters:
                TableName: ${{ .workflowInputs.tableName }}
                KeyConditionExpression: "ScopedName = :scopedNameValue AND Version = :VersionValue"
                ExpressionAttributeValues:
                  ":scopedNameValue":
                    S: ${{ .workflowInputs.scopedName }}
                  ":VersionValue":
                    N: ${{ .workflowInputs.version }}
              selectors:
                - name: response
                  expression: '.response'
                - name: errorMessage
                  expression: '.errorMessage'
                - name: success
                  expression: '.success'
                
              
          - name: wait
            type: wait
            seconds: 2
            
          - name: logOutput
            type: action
            action: newrelic.instrumentation.log
            version: 1
            inputs:
              message: 'The execute API message output is:${{ .steps.executeApi.outputs.response.Item }}'
              licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
          - name: logOutput1
            type: action
            action: newrelic.instrumentation.log
            version: 1
            inputs:
              message: 'does execute API have any error :${{ .steps.executeApi.outputs.errorMessage }}'
              licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
          - name: logOutput2
            type: action
            action: newrelic.instrumentation.log
            version: 1
            inputs:
              message: 'is execute successful :${{ .steps.executeApi.outputs.success }}'
              licenseKey: '${{ :secrets:STAGING_NEW_RELIC_LICENSE_KEY }}'
      ```
    </TabsPageItem>
  </TabsPages>
</Tabs>

AWS Execute APIを使用したその他のワークフローの例については、[ワークフローの例の](/docs/workflow-automation/workflow-examples)ページを参照してください。