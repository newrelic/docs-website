---
title: ワークフローから通知を送信する
tags:
  - workflow automation
  - workflow
  - notifications
  - slack
  - pagerduty
metaDescription: 'Configure workflows to send notifications via Slack, PagerDuty, email, or webhooks when automation tasks complete or fail.'
freshnessValidatedDate: never
translationType: machine
---

<Callout title="プレビュー">
  この機能はまだ開発中ですが、ぜひお試しください。

  この機能は現在、弊社の[プレリリース ポリシー](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy)に従ってプレビュー プログラムの一部として提供されています。
</Callout>

このページでは、ワークフロー自動化と通知を統合する 2 つの方法について説明します。

1. **ワークフローから通知を送信する**: ワークフロー内で Slack、PagerDuty、電子メール、または Webhook アクションを使用して、ワークフローが完了したとき、失敗したとき、または承認が必要になったときにチームに通知します。
2. **アラートからワークフローをトリガーする**: New Relicアラートの宛先としてワークフロー オートメーションを設定し、アラート条件に違反したときにワークフローを自動的に開始します。

<Callout variant="important">
  **2つの異なる概念:**

  * **アウトバウンド通知**: ワークフローは次のようなアクションを使用してSlack/PagerDutyにメッセージを送信します。 `slack.chat.postMessage`
  * **インバウンドトリガー**: New Relicアラートはワークフローの実行をトリガーし、自動的に`issueId`を渡します
</Callout>

## ワークフローから通知を送信する [#send-from-workflows]

これらの通知チャネルを使用して、ワークフロー内からチームを集計します。 ユースケースに適したチャネルを選択してください。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **チャネル**
      </th>

      <th>
        **最適な用途**
      </th>

      <th>
        **セットアップの複雑さ**
      </th>

      <th>
        **特徴**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **スラック**
      </td>

      <td>
        チームコラボレーション、承認
      </td>

      <td>
        簡単 - ボットトークンが必要
      </td>

      <td>
        豊富なメッセージ、反応、スレッド
      </td>
    </tr>

    <tr>
      <td>
        **PagerDuty**
      </td>

      <td>
        インシデント管理、オンコール
      </td>

      <td>
        簡単 - APIキーが必要です
      </td>

      <td>
        エスカレーションポリシー、インシデント追跡
      </td>
    </tr>

    <tr>
      <td>
        **メール**
      </td>

      <td>
        正式な通知、報告
      </td>

      <td>
        簡単 - 目的地の設定が必要
      </td>

      <td>
        添付ファイル、HTML フォーマット、クエリ結果
      </td>
    </tr>

    <tr>
      <td>
        **Webhook**
      </td>

      <td>
        カスタムインテグレーション
      </td>

      <td>
        中 - エンドポイントが必要
      </td>

      <td>
        柔軟なペイロード、あらゆるシステム
      </td>
    </tr>
  </tbody>
</table>

## あなたが始める前に

通知を構成する前に、次の点を確認してください。

* アカウントで作成されたワークフロー ([テンプレート](/docs/workflow-automation/create-a-workflow-automation/use-a-template)または[カスタムビルド](/docs/workflow-automation/create-a-workflow-automation/create-your-own)から)。
* 通知チャネルの認証情報 (Slack ボット、 PagerDuty APIキーなど)。
* 資格情報は[シークレット マネージャー](/docs/workflow-automation/limitations-and-faq/workflow-best-practices/#secure-credentials)に保存されます。

<Callout variant="tip">
  **ワークフローから通知を送信する場合**: アクション カタログを使用して、ワークフローのステップに通知アクションを直接追加します。

  * **Slack** : Slack の直接統合には[`slack.chat.postMessage`](/docs/workflow-automation/setup-and-configuration/actions-catalog/slack/slack-chat)を使用します
  * **PagerDuty** : インシデント管理に[PagerDuty アクション](/docs/workflow-automation/setup-and-configuration/actions-catalog/pagerduty/pagerduty-incident)を使用する
  * **メール**: Slackワークスペースでメール送信先を設定した後、[Alerts &gt; Destinations](/docs/alerts/get-notified/destinations/)でメール送信先を設定した後、[`newrelic.notification.sendEmail`](/docs/workflow-automation/setup-and-configuration/actions-catalog/newrelic/newrelic-notification)を使用してください。
</Callout>

## アラートからワークフローをトリガーする [#trigger-from-alerts]

New Relicアラートの宛先としてワークフロー オートメーションを設定すると、アラート条件に違反したときにワークフローが自動的に開始されます。 カウントによってトリガーされると、ワークフローは自動的に`issueId`と`accountId`入力として受け取ります。

1. **[one.newrelic.com &gt; All capabilities](https://one.newrelic.com/all-capabilities)&gt; Alerts &gt; Destinations**に移動し、**Workflow Automation** \[ワークフロー オートメーションを]選択します。

2. **ワークフロー オートメーション**を設定するには、**ワークフロー オートメーションの宛先名**(\*\* ワークフロー オートメーション \*\* の一意の名前) や**APIキー**などの必要な情報を入力します。

3. **Save destination** \[保存先]をクリックします。

   <img title="How to add a destination" alt="Image of the Workflow Automation destination page." src="/images/add-a-destination.webp" />

## まとめ通知ワークフローを作成する [#create-the-notification-workflow]

**ワークフローオートメーションを**宛先として設定したら、分割通知ワークフローを作成して、どのアラートがワークフローをトリガーするかを定義します。

<Callout variant="important">
  以下の手順は、**ワークフロー Automation**ではなく、**分割通知**ワークフロー (New Relicアラートの一部) を設定するための手順です。 上で構成した**ワークフロー オートメーション**の宛先を含む宛先へのワークフロー ルートの問題を一括通知します。 一括ワークフローの完全なドキュメントについては、[インシデント](/docs/alerts/get-notified/incident-workflows)ワークフローを参照してください。
</Callout>

1. **Alerts &gt; Notification Workflows**に移動し、 **+ Add a workflow** \[+ ワークフローの追加]を選択します。

2. 通知ワークフローを構成するには、「通知ワークフローの構成」ページで必要な情報を入力します。

   * 認識できる一意の名前を入力します。
   * **Basic** \[基本]フィルター オプションのそれぞれのドロップダウンから**Tag** \[タグ]、**Policy** \[ポリシー]、**Priority** \[優先度の]プロパティを選択してインシデントに関する通知を受け取るか、**Advanced** \[詳細]フィルター オプションを選択して**Attributes** \[プロパティ]、**Operators** \[演算子]、**Values** \[値を]選択してより詳細なインシデント通知を取得します。
   * **Additional settings** \[追加設定]をクリックすると、 [NRQL クエリを](/docs/alerts/get-notified/incident-workflows/#enrichments)構築してデータを拡充し、New Relic プラットフォーム全体から関連データを収集できます。エンリッチメントの例については、 [「ワークフロー データ エンリッチメント」](/docs/alerts/get-notified/custom-variables-incident-workflows/#enrichment-examples)を参照してください。

3. 通知先を指定するには、 **Notify** \[通知]セクションで、前の手順で作成した**Workflow Automatio**n \[ワークフロー自動化の]通知先を選択します。

4. (オプション) ワークフローをトリガーすると同時に通知を受信するために、 [Slack](/docs/workflow-automation/setup-and-configuration/actions-catalog/slack/slack-chat/#configure-slack-integration)などの他の送信先を追加することもできます。

   1. ドロップダウンリストから**Slack destination** \[Slack の送信先]を選択します。
   2. ドロップダウン リストから**Channel** \[チャネルを]選択し、**Receive notification updates on the channel \[チャネルの通知更新を受信する]**チェックボックスをオンにします。
   3. 必要に応じて、 **Custom Details** \[カスタム詳細]セクションにカスタム メッセージを追加します。

   <Callout variant="tip">
     **Send test notification** \[テスト通知の送信]を使用してテスト通知を送信することをお勧めします。
   </Callout>

   4. **Save message** \[メッセージを保存]を選択します。

5. **Activate workflow** \[ワークフローのアクティブ化]を選択します。

   <img title="How to configure a workflow" alt="Image of how to configure a workflow" src="/images/configure-workflow.gif" />

## ワークフロー自動化に渡されるデータ [#data-passed]

一括がワークフロー オートメーションをトリガーする場合:

* **`issueId`** : ワークフローに自動的に渡されます。ワークフローはこれを入力として受け入れる必要があります。 [「独自のワークフローを作成する」](/docs/workflow-automation/create-a-workflow-automation/create-your-own)に記載されているように、 `issueId`は「ワークフローが数回から実行されるときに自動的に提供されます」。
* **`accountId`** : New Relic アカウント ID。ワークフローはこれを必須の入力として受け入れる必要があります。

ワークフロー自動化定義では、これらの入力を宣言する必要があります。例えば：

```yaml
  workflowInputs:
    accountId:
      type: Int
    issueId:
      type: String
```

<Callout variant="important">
  `defaultValue`のない入力は必須であり、ワークフローがトリガーされるときに提供する必要があります。その後、ワークフロー内で NerdGraph API使用して`issueId`を使用して集計の詳細を行うことができます。
</Callout>

## 次のステップ

* **[アクション カタログ](/docs/workflow-automation/setup-and-configuration/actions-catalog/actions-catalog)**: 利用可能なすべてのAWS 、 New Relic 、および統合アクションを表示します。
* **[テンプレートを使用します](/docs/workflow-automation/create-a-workflow-automation/use-a-template)**。一般的なシナリオには、デプロイの事前構成されたワークフローが使用されます。
* **[独自のワークフローを作成する](/docs/workflow-automation/create-a-workflow-automation/create-your-own)**: カスタム ワークフローを最初から作成します。