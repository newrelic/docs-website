---
title: ノートブックの例と活用例
tags:
  - Query your data
  - Explore and query data
  - Notebooks
  - Examples
metaDescription: 'Explore real-world examples of New Relic notebooks for incident investigations, performance analysis, and team collaboration to get inspired for your own data stories.'
freshnessValidatedDate: never
translationType: human
---

一般的なユースケースで説得力のあるデータストーリーを作成する方法を示す、実用的なノートブックの例からインスピレーションを得ましょう。各例では、クエリ、視覚化、説明テキストを組み合わせて効果的な分析ドキュメントを作成する方法を示します。

## インシデント調査ノートブック

何が起こったのか、そして今後どのようにそれを防ぐことができるのかをチームが理解するのに役立つ、包括的なインシデント調査ドキュメントを作成します。

### 構造

**Markdownブロック：インシデントの概要**

```markdown
# Production API Outage - October 15, 2024

**Incident Start**: 2024-10-15 14:32 UTC
**Incident End**: 2024-10-15 15:18 UTC
**Duration**: 46 minutes
**Impact**: 15% of API requests failed

## Summary
Our main API experienced elevated error rates starting at 14:32 UTC...
```

**クエリブロック：エラー率のタイムライン**

```sql
SELECT count(*) AS 'Total Requests',
       filter(count(*), WHERE httpResponseCode >= 400) AS 'Errors'
FROM Transaction
WHERE appName = 'api-production'
TIMESERIES 1 minute
SINCE '2024-10-15 14:00:00' UNTIL '2024-10-15 16:00:00'
```

**クエリブロック：エンドポイント別のエラー内訳**

```sql
SELECT count(*) AS 'Error Count',
       average(duration) AS 'Avg Duration (ms)'
FROM Transaction
WHERE appName = 'api-production'
  AND httpResponseCode >= 400
FACET request.uri
SINCE '2024-10-15 14:00:00' UNTIL '2024-10-15 16:00:00'
ORDER BY count(*) DESC
```

**Markdownブロック：根本原因分析**

```markdown
## Root Cause Analysis

### Timeline of Events
- **14:32**: Error rates began climbing for `/api/users` endpoint
- **14:35**: Database connection pool exhaustion detected
- **14:45**: Database scaling initiated
- **15:18**: Service fully recovered

### Contributing Factors
1. Unusual traffic spike during product launch
2. Database connection pool too small for peak load
3. Missing rate limiting on user registration endpoint
```

**クエリブロック：インシデント発生時のデータベースパフォーマンス**

```sql
SELECT average(duration) AS 'Query Duration (ms)',
       count(*) AS 'Query Count'
FROM DatabaseSample
WHERE host = 'prod-db-01'
TIMESERIES 5 minutes
SINCE '2024-10-15 14:00:00' UNTIL '2024-10-15 16:00:00'
```

## パフォーマンス分析ノートブック

アプリケーションのパフォーマンス傾向を長期的に追跡および分析して、最適化の機会を特定します。

### 構造

**Markdownブロック：分析の概要**

```markdown
# Weekly Performance Review - Week of October 14, 2024

## Objectives
- Review application response times across all services
- Identify performance regressions
- Track progress on optimization initiatives

## Key Metrics
- P95 response time target: < 500ms
- Error rate target: < 0.1%
- Apdex score target: > 0.85
```

**クエリブロック：レスポンスタイムの傾向**

```sql
SELECT percentile(duration, 50) AS 'P50',
       percentile(duration, 95) AS 'P95',
       percentile(duration, 99) AS 'P99'
FROM Transaction
WHERE appName IN ('web-frontend', 'api-backend', 'auth-service')
FACET appName
TIMESERIES 1 day
SINCE 7 days ago
```

**クエリブロック：エラー率の比較**

```sql
SELECT percentage(count(*), WHERE error IS true) AS 'Error Rate %'
FROM Transaction
WHERE appName IN ('web-frontend', 'api-backend', 'auth-service')
FACET appName
TIMESERIES 1 day
SINCE 7 days ago
COMPARE WITH 1 week ago
```

**Markdownブロック：分析とレコメンデーション**

```markdown
## Key Findings

### Performance Improvements ✅
- API backend P95 improved from 650ms to 420ms
- Authentication service error rate down 50%

### Areas for Attention ⚠️
- Web frontend P95 increased 15% week-over-week
- Database query timeouts up 25%

### Action Items
1. Investigate frontend asset loading delays
2. Optimize top 5 slowest database queries
3. Implement caching for user profile data
```

## 機能利用状況の追跡

ユーザーが新しい機能をどのように操作するかを監視し、導入の成功度を測定します。

### 構造

**Markdownブロック：機能の概要**

```markdown
# New Dashboard Feature Adoption - 30 Days Post-Launch

**Launch Date**: September 15, 2024
**Analysis Period**: September 15 - October 15, 2024

## Feature Description
New interactive dashboard builder with drag-and-drop widgets...

## Success Metrics
- **Primary**: 25% of active users create at least one custom dashboard
- **Secondary**: Average 3 widgets per custom dashboard
- **Tertiary**: < 5% bounce rate on dashboard creation page
```

**クエリブロック：ダッシュボードを作成する毎日のアクティブユーザー**

```sql
SELECT uniqueCount(userId) AS 'Users Creating Dashboards'
FROM PageView
WHERE pageUrl LIKE '%/dashboard/create%'
TIMESERIES 1 day
SINCE 30 days ago
```

**クエリブロック：ダッシュボード作成ファネル**

```sql
SELECT funnel(userId,
  WHERE pageUrl LIKE '%/dashboard/create%' AS 'Started Creation',
  WHERE pageUrl LIKE '%/dashboard/create%' AND eventType = 'widget_added' AS 'Added Widget',
  WHERE eventType = 'dashboard_saved' AS 'Saved Dashboard'
)
FROM PageView, UserAction
SINCE 30 days ago
```

## セキュリティ監視ノートブック

潜在的な脅威とシステムの脆弱性を追跡するために、継続的なセキュリティ分析を作成します。

### 構造

**Markdownブロック：セキュリティの概要**

```markdown
# Weekly Security Review - October 21, 2024

## Monitoring Scope
- Failed authentication attempts
- Unusual API access patterns
- Database query anomalies
- File system access violations

## Alert Thresholds
- Failed logins: > 100/hour from single IP
- API rate limiting: > 1000 requests/minute
- Suspicious queries: containing SQL injection patterns
```

**クエリブロック：失敗した認証パターン**

```sql
SELECT count(*) AS 'Failed Attempts',
       latest(remoteAddr) AS 'Source IP'
FROM Log
WHERE message LIKE '%authentication failed%'
FACET remoteAddr
SINCE 7 days ago
HAVING count(*) > 50
ORDER BY count(*) DESC
```

**クエリブロック：APIアクセス異常**

```sql
SELECT count(*) AS 'Request Count',
       uniqueCount(userAgent) AS 'Unique User Agents'
FROM Transaction
WHERE appName = 'api-gateway'
FACET request.headers.x-forwarded-for
SINCE 24 hours ago
HAVING count(*) > 10000
ORDER BY count(*) DESC
```

## ビジネスメトリクスダッシュボード

主要なビジネスKPIと技術的なメトリクスと併せて追跡して、全体像を理解します。

### 構造

**Markdownブロック：ビジネスコンテキスト**

```markdown
# Monthly Business & Technical Review - October 2024

## Business Objectives
- Increase user engagement by 15%
- Reduce customer support tickets by 20%
- Improve conversion rate to 3.5%

## Technical Performance Targets
- 99.9% uptime
- < 2 second page load times
- Zero security incidents
```

**クエリブロック：ユーザーエンゲージメントメトリクス**

```sql
SELECT count(*) AS 'Page Views',
       uniqueCount(userId) AS 'Active Users',
       average(duration) AS 'Avg Session Duration'
FROM PageView
TIMESERIES 1 day
SINCE 30 days ago
```

**クエリブロック：コンバージョンファネル**

```sql
SELECT funnel(userId,
  WHERE pageUrl = '/signup' AS 'Signup Page',
  WHERE pageUrl = '/signup/verify' AS 'Email Verified',
  WHERE pageUrl = '/onboarding/complete' AS 'Onboarding Complete',
  WHERE eventType = 'subscription_created' AS 'Converted'
)
FROM PageView, UserAction
SINCE 30 days ago
```

## テンプレート：調査開始

このテンプレートは、あらゆるデータ調査の開始点として使用します。

### 構造

**Markdownブロック：調査テンプレート**

```markdown
# Investigation: [ISSUE DESCRIPTION]

**Date**: [TODAY'S DATE]
**Investigator**: [YOUR NAME]
**Priority**: [HIGH/MEDIUM/LOW]

## Problem Statement
[Describe what you're investigating and why]

## Hypothesis
[What do you think might be causing the issue?]

## Investigation Plan
1. [First thing to check]
2. [Second thing to check]
3. [Third thing to check]

## Findings
_[Update this section as you discover information]_

## Next Steps
_[What actions should be taken based on your findings?]_
```

**クエリブロック：初期データ探索**

```sql
-- Replace with your initial query
SELECT count(*)
FROM [YourEventType]
WHERE [YourConditions]
SINCE 1 hour ago
```

<Callout variant="tip">
  各調査は、範囲を把握するために広範なクエリから開始し、調査結果に基づいて特定の領域に絞り込みます。
</Callout>

## ノートブックの例に関するベストプラクティス

### ストーリーを構造化する

1. **コンテキストから始める**：常にMarkdownブロックで目的を説明する
2. **論理的な流れに従う**：クエリを、ユーザーが自然に調査を進める順序で並べる
3. **結論を提供する**：Markdownブロックで調査結果と次のステップをまとめる

### クエリを再利用可能にする

* 日付、アプリケーション名、閾値には変数を使用する
* 複雑なロジックにはNRQLコメントを追加して説明する
* 分析タイプに適した時間範囲を選択する

### 視覚デザインのヒント

* 関連するクエリ全体で一貫したチャートタイプを使用する
* 物語をサポートする色を選択する
* すべての視覚化に明確なタイトルとラベルを追加する
* 詳細なデータには表を使用し、傾向やパターンにはチャートを使用する

## 次のステップ

* [ノートブックにクエリを追加する](/docs/query-your-data/explore-query-data/notebooks/add-queries-to-notebooks)方法を学ぶ
* ノートブックの[共有オプション](/docs/query-your-data/explore-query-data/notebooks/share-notebooks)を確認する
* クエリのアイデアをさらに得るために[NRQLの例](/docs/nrql/nrql-examples)をご覧ください