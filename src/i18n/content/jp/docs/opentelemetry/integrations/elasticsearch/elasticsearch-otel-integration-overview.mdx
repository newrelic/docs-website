---
title: OpenTelemetryによるElasticsearch
tags:
  - OpenTelemetry
  - Elasticsearch
  - Integrations
  - On-host integrations
  - OTEL
  - Monitoring
description: 事前に構築されたダッシュボード、インテリジェントなアラート、および既存の監視スタックとのシームレスな統合により、 Elasticsearchクラスタを完全に可視化できます。
freshnessValidatedDate: never
translationType: machine
---

New Relic Elasticsearch OpenTelemetry (OTel) 統合は、業界標準のOpenTelemetryプロトコルを使用して、 Elasticsearchクラスターの包括的な監視を提供します。 OpenTelemetry Collector活用することで、 Elasticsearchストラクチャからメトリクスとログの両方を効率的に収集する統合パイプラインが得られ、 New Relicと直接統合される高速で信頼性の高い監視が保証されます。

<Callout variant="important">
  **監視アプローチを選択してください:**このOpenTelemetryベースの統合は、最新のベンダーニュートラル監視を提供します。 従来のアプローチを好む場合、または特定の互換性が必要な場合は、 [標準のElasticsearchを](/docs/infrastructure/host-integrations/host-integrations-list/elasticsearch/elasticsearch-integration)参照してください。
</Callout>

**この OpenTelemetry アプローチを選択する理由は何ですか?**

* **統合されたデータ収集**: シングルコレクターは、 Elasticsearchとホストシステムからのメトリクス、ログ、およびトレースを処理します。
* **ベンダー中立性**: あらゆる観察プラットフォームで動作するオープンソース標準を使用し、ベンダー ロックインはありません。
* **高パフォーマンス**: 組み込みのバッチ処理、圧縮、カーディナリティ削減により、リソースへの影響が最小限に抑えられます。
* **将来性のあるアーキテクチャー: インフラストラクチャ**の成長に合わせて適応する、進化するオープンスタンダードに基づいて構築されています。
* **ネイティブNew Relic** : 最適化されたデータ処理とシームレスなダッシュボード エクスペリエンス。

**ユースケース:** eコマース企業が製品検索機能にElasticsearchを使用しています。この統合を使用することで、運用チームは検索サービスが正常かどうか、検索の応答速度がどれくらいであるかを確認し、メモリがなくなる前に通知を受け取ることができます。これらすべてを 1 つのダッシュボードから行うことができます。 顧客から検索結果の遅さについて苦情が寄せられると、チームはすべての監視データをまとめて確認することで、それが Elasticsearch の問題なのか、サーバーの問題なのか、それとも他の何かなのかをすぐに確認できます。

<img title="Elasticsearch OpenTelemetry monitoring dashboard" alt="Screenshot showing Elasticsearch cluster health, performance metrics, and resource usage in New Relic dashboards" src="/images/elasticsearch-otel-solution.png" />

**得られるもの**

Elasticsearchを次の方法で監視します。

* **Cluster健全性監視**: ノードのステータス、シャードの分散、クラスタの状態を追跡します。
* **パフォーマンス インサイト**: モニター検索レイテンシ、インデックス作成率、およびJVMパフォーマンス メトリクス。
* **リソース使用率**: すべてのノードの CPU、メモリ、ディスク、ネットワークの使用状況を表示します。
* **プロアクティブなアラート : 問題がユーザーに影響を与える前に、インテリジェントな**警告値で通知を受け取ります。
* **フルスタック相関**: Elasticsearchメトリクスとアプリケーションおよびインフラストラクチャデータを接続します。

<Callout variant="tip">
  **始める準備はできましたか?**この統合のセットアップには約 15 ～ 20 分かかります。 [Elasticsearch OpenTelemetry統合をインストールします](/docs/opentelemetry/integrations/elasticsearch/elasticsearch-otel-integration-install)。
</Callout>

***

## 主要メトリクスの概要

次の重要なメトリクスを使用して、 Elasticsearchクラスタの健全性とパフォーマンスを監視します。

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        メトリクスカテゴリー
      </th>

      <th>
        何を測定しているか
      </th>

      <th style={{ width: "120px" }}>
        優先度
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **クラスタの健全性**
      </td>

      <td>
        `elasticsearch.cluster.health`

         \- クラスター全体のステータス（緑/黄/赤）
      </td>

      <td>
        🔴 クリティカル
      </td>
    </tr>

    <tr>
      <td>
        **シャードステータス**
      </td>

      <td>
        `elasticsearch.cluster.shards`

         \- 未割り当て、再配置中、または初期化中のシャード
      </td>

      <td>
        🔴 クリティカル
      </td>
    </tr>

    <tr>
      <td>
        **ノードの可用性**
      </td>

      <td>
        `elasticsearch.cluster.data_nodes`

         \- クラスター内のアクティブなデータノード
      </td>

      <td>
        🔴 クリティカル
      </td>
    </tr>

    <tr>
      <td>
        **JVMヒープ使用量**
      </td>

      <td>
        `jvm.memory.heap.utilization`

         \- メモリ使用率
      </td>

      <td>
        🔴 クリティカル
      </td>
    </tr>

    <tr>
      <td>
        **検索パフォーマンス**
      </td>

      <td>
        `elasticsearch.node.operations.time`

         \- クエリとフェッチのレイテンシ
      </td>

      <td>
        🟡 重要
      </td>
    </tr>

    <tr>
      <td>
        **インデックス作成のパフォーマンス**
      </td>

      <td>
        `elasticsearch.node.operations.time`

         \- インデックスと削除操作のタイミング
      </td>

      <td>
        🟡 重要
      </td>
    </tr>

    <tr>
      <td>
        **サーキットブレーカー**
      </td>

      <td>
        `elasticsearch.breaker.tripped`

         \- メモリ保護が起動
      </td>

      <td>
        🟡 重要
      </td>
    </tr>

    <tr>
      <td>
        **リソースの使用**
      </td>

      <td>
        `system.cpu.utilization`

        、 

        `system.memory.usage`

         \- ホストシステムリソース
      </td>

      <td>
        🔵監視
      </td>
    </tr>
  </tbody>
</table>

## 完全なメトリクスリファレンス

この統合により、クラスター、ノード、 JVM 、ホストインフラストラクチャ全体で 60 以上のメトリクスが収集されます。 メトリクスの詳細な仕様については、以下のセクションを展開してください。

<Callout variant="tip">
  利用可能なメトリクスの完全なカタログについては、 OpenTelemetry [`elasticsearchreceiver`](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/elasticsearchreceiver)および[`hostmetricsreceiver`](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/hostmetricsreceiver)ドキュメントを参照してください。
</Callout>

<CollapserGroup>
  <Collapser id="cluster-core" title="Cluster健全性とブレーカー メトリクス (elasticsearchreceiver)">
    <table>
      <thead>
        <tr>
          <th style={{ width: "260px" }}>
            メトリック
          </th>

          <th>
            説明
          </th>

          <th style={{ width: "240px" }}>
            属性
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `elasticsearch.cluster.in_flight_fetch`
          </td>

          <td>
            シャード取得操作はまだ実行中です。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.cluster.nodes`
          </td>

          <td>
            クラスター ノードの合計数。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.cluster.pending_tasks`
          </td>

          <td>
            実行を待機している保留中のクラスター レベルのタスク。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.cluster.state_update.time`
          </td>

          <td>
            クラスターの状態の更新に費やされた累積時間。
          </td>

          <td>
            <InlineCode>
              state
            </InlineCode> （どれでも）<br /> <InlineCode>
              type
            </InlineCode> (計算、コンテキスト構築、コミット、完了、マスター適用、通知)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="index-metrics" title="インデックスアクティビティメトリクス (elasticsearchreceiver)">
    <table>
      <thead>
        <tr>
          <th style={{ width: "260px" }}>
            メトリック
          </th>

          <th>
            説明
          </th>

          <th style={{ width: "260px" }}>
            属性
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `elasticsearch.index.documents`
          </td>

          <td>
            インデックスごとのドキュメント、状態ごとに分割。
          </td>

          <td>
            <InlineCode>
              state
            </InlineCode> （アクティブ | 削除済み）<br /> <InlineCode>
              aggregation
            </InlineCode> (primary\_shards | 合計)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.index.operations.merge.current`
          </td>

          <td>
            アクティブなセグメントのマージ操作。
          </td>

          <td>
            <InlineCode>
              aggregation
            </InlineCode>

             (primary_shards | 合計)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.index.operations.time`
          </td>

          <td>
            インデックス レベルの操作に費やされた時間。
          </td>

          <td>
            <InlineCode>
              operation
            </InlineCode> (インデックス、削除、取得、クエリ、フェッチ、スクロール、提案、マージ、更新、フラッシュ、ウォーマー)<br /> <InlineCode>
              aggregation
            </InlineCode> (primary\_shards | 合計)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.indexing_pressure.memory.total.primary_rejections`
          </td>

          <td>
            一次段階のインデックス拒否の累計数。
          </td>

          <td>
            —
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="node-activity" title="ノードアクティビティとワークロードメトリクス（elasticsearchreceiver）">
    <table>
      <thead>
        <tr>
          <th style={{ width: "260px" }}>
            メトリック
          </th>

          <th>
            説明
          </th>

          <th style={{ width: "260px" }}>
            属性
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `elasticsearch.node.cache.count`
          </td>

          <td>
            ノード シャード全体のクエリ キャッシュのヒットとミス。
          </td>

          <td>
            <InlineCode>
              type
            </InlineCode>

             （ヒット｜ミス）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.cache.evictions`
          </td>

          <td>
            ノード キャッシュの削除。
          </td>

          <td>
            <InlineCode>
              cache_name
            </InlineCode>

             (フィールドデータ | クエリ)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.cache.memory.usage`
          </td>

          <td>
            キャッシュメモリの使用量（バイト単位）。
          </td>

          <td>
            <InlineCode>
              cache_name
            </InlineCode>

             (フィールドデータ | クエリ)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.cluster.io`
          </td>

          <td>
            内部クラスター ネットワーク I/O (バイト単位)。
          </td>

          <td>
            <InlineCode>
              direction
            </InlineCode>

             （受信｜送信）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.documents`
          </td>

          <td>
            ノードによってホストされるドキュメント。
          </td>

          <td>
            <InlineCode>
              state
            </InlineCode>

             （アクティブ | 削除済み）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.disk.io.read`
          </td>

          <td>
            ファイル ストア全体のディスク読み取りスループット (KiB)。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.disk.io.write`
          </td>

          <td>
            ファイル ストア全体のディスク書き込みスループット (KiB)。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.fs.disk.available`
          </td>

          <td>
            JVM で使用可能なディスク。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.fs.disk.total`
          </td>

          <td>
            ノード上のディスク容量の合計。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.http.connections`
          </td>

          <td>
            ノードによって提供される HTTP 接続。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.ingest.documents.current`
          </td>

          <td>
            現在取り込まれているドキュメント。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.ingest.operations.failed`
          </td>

          <td>
            累積的な取り込み失敗数。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.open_files`
          </td>

          <td>
            使用中のオープンファイル記述子。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.operations.completed`
          </td>

          <td>
            ノードによって完了した操作。
          </td>

          <td>
            <InlineCode>
              operation
            </InlineCode>

             (インデックス、削除、取得、クエリ、フェッチ、スクロール、提案、マージ、更新、フラッシュ、ウォーマー)
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.operations.current`
          </td>

          <td>
            現在操作が進行中です。
          </td>

          <td>
            <InlineCode>
              operation
            </InlineCode>

             （同じセット）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.operations.get.completed`
          </td>

          <td>
            GET はヒットとミスを生みます。
          </td>

          <td>
            <InlineCode>
              result
            </InlineCode>

             （ヒット｜ミス）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.operations.get.time`
          </td>

          <td>
            GET ヒット/ミスの処理に費やされた時間。
          </td>

          <td>
            <InlineCode>
              result
            </InlineCode>

             （ヒット｜ミス）
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.shards.reserved.size`
          </td>

          <td>
            回復によるシャードの増加を予測します。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.node.thread_pool.tasks.finished`
          </td>

          <td>
            スレッド プールごとに完了した (または拒否された) タスク。
          </td>

          <td>
            <InlineCode>
              thread\_pool\_name
            </InlineCode> （どれでも）<br /> <InlineCode>
              state
            </InlineCode> (拒否 | 完了)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="jvm-metrics" title="ElasticsearchによってレポートされるJVMおよび OS メトリクス (elasticsearchreceiver)">
    <table>
      <thead>
        <tr>
          <th style={{ width: "260px" }}>
            メトリック
          </th>

          <th>
            説明
          </th>

          <th style={{ width: "260px" }}>
            属性
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `elasticsearch.os.cpu.load_avg.1m`
          </td>

          <td>
            1 分間の OS 負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.os.cpu.load_avg.5m`
          </td>

          <td>
            5 分間の OS 負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.os.cpu.load_avg.15m`
          </td>

          <td>
            15 分間の OS 負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `elasticsearch.os.memory`
          </td>

          <td>
            Elasticsearch から見た物理メモリの使用量。
          </td>

          <td>
            <InlineCode>
              state
            </InlineCode>

             （無料｜中古）
          </td>
        </tr>

        <tr>
          <td>
            `jvm.gc.collections.count`
          </td>

          <td>
            ガベージコレクションの合計実行回数。
          </td>

          <td>
            <InlineCode>
              name
            </InlineCode>

             （コレクター名）
          </td>
        </tr>

        <tr>
          <td>
            `jvm.gc.collections.elapsed`
          </td>

          <td>
            ガベージコレクションに費やされた時間。
          </td>

          <td>
            <InlineCode>
              name
            </InlineCode>

             （コレクター名）
          </td>
        </tr>

        <tr>
          <td>
            `jvm.memory.heap.max`
          </td>

          <td>
            使用可能な最大ヒープ メモリ。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `jvm.memory.heap.used`
          </td>

          <td>
            現在使用中のヒープメモリ。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `jvm.threads.count`
          </td>

          <td>
            アクティブな JVM スレッド数。
          </td>

          <td>
            —
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="hostmetrics" title="ホストインフラストラクチャ メトリクス (hostmetricsreceiver)">
    <table>
      <thead>
        <tr>
          <th style={{ width: "280px" }}>
            メトリック
          </th>

          <th>
            説明
          </th>

          <th style={{ width: "220px" }}>
            属性
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `system.cpu.time`
          </td>

          <td>
            状態ごとに分割された累積 CPU 時間。
          </td>

          <td>
            <InlineCode>
              cpu
            </InlineCode> （論理CPU）<br /> <InlineCode>
              state
            </InlineCode> (上記と同じセット)
          </td>
        </tr>

        <tr>
          <td>
            `system.cpu.load_average.1m`
          </td>

          <td>
            1 分間のシステム負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `system.cpu.load_average.5m`
          </td>

          <td>
            5 分間のシステム負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `system.cpu.load_average.15m`
          </td>

          <td>
            15 分間のシステム負荷平均。
          </td>

          <td>
            —
          </td>
        </tr>

        <tr>
          <td>
            `system.memory.utilization`
          </td>

          <td>
            メモリ使用率。
          </td>

          <td>
            <InlineCode>
              state
            </InlineCode>

             （使用済み）
          </td>
        </tr>

        <tr>
          <td>
            `system.disk.io`
          </td>

          <td>
            デバイスあたりのディスク I/O スループット。
          </td>

          <td>
            <InlineCode>
              device
            </InlineCode> （ディスク）<br /> <InlineCode>
              direction
            </InlineCode> (読み取り | 書き込み)
          </td>
        </tr>

        <tr>
          <td>
            `system.disk.operations`
          </td>

          <td>
            デバイスごとのディスク操作。
          </td>

          <td>
            <InlineCode>
              device
            </InlineCode><br /><InlineCode>
              direction
            </InlineCode> (読み取り | 書き込み)
          </td>
        </tr>

        <tr>
          <td>
            `system.filesystem.usage`
          </td>

          <td>
            状態別のファイルシステム容量。
          </td>

          <td>
            <InlineCode>
              device
            </InlineCode><br /><InlineCode>
              state
            </InlineCode> (使用済み | 空き | 予約済み)
          </td>
        </tr>

        <tr>
          <td>
            `system.filesystem.utilization`
          </td>

          <td>
            ファイルシステムの使用率。
          </td>

          <td>
            <InlineCode>
              device
            </InlineCode><br /><InlineCode>
              state
            </InlineCode> (使用済み)
          </td>
        </tr>

        <tr>
          <td>
            `system.network.io`
          </td>

          <td>
            インターフェースあたりのネットワーク バイト。
          </td>

          <td>
            <InlineCode>
              interface
            </InlineCode><br /><InlineCode>
              direction
            </InlineCode> (受信 | 送信)
          </td>
        </tr>

        <tr>
          <td>
            `system.network.packets`
          </td>

          <td>
            インターフェースごとのネットワーク パケット。
          </td>

          <td>
            <InlineCode>
              interface
            </InlineCode><br /><InlineCode>
              direction
            </InlineCode> (受信 | 送信)
          </td>
        </tr>

        <tr>
          <td>
            `process.cpu.utilization`
          </td>

          <td>
            最後のスクレイプ以降にプロセスによって使用された合計 CPU 時間の割合。0 から 1 までの値で表されます。
          </td>

          <td>
            <InlineCode>
              process.pid
            </InlineCode> （PID）<br /> <InlineCode>
              process.executable.name
            </InlineCode> (バイナリ名)<br /> <InlineCode>
              process.owner
            </InlineCode> (ユーザー)<br /> <InlineCode>
              state
            </InlineCode> (ユーザー | システム | その他)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## データの整理方法 [#resource-attributes]

Elasticsearch メトリクスが New Relic に送信されると、データの整理とフィルタリングに役立つ識別情報が含まれます。このメタデータは、すべてのメトリクスにクラスタ情報を自動的にタグ付けします。

<table>
  <thead>
    <tr>
      <th style={{ width: "250px" }}>
        タグ
      </th>

      <th>
        それが何を特定するか
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `elasticsearch.cluster.name`
      </td>

      <td>
        Elasticsearchの一意の名前
      </td>
    </tr>
  </tbody>
</table>

このクラスター名タグを使用すると、次のことが可能になります。

* 複数のElasticsearch環境がある場合は、クラスタでメトリクスをフィルタリングします。
* 運用、ステージング、開発用のクラスター固有のダッシュボードを作成します。
* 個々のクラスターに対してターゲットを絞ったアラートを設定します。
* 同じクラスター識別子を使用して、さまざまな監視ツール間でデータを相関させます。

***

## 次のステップ

メトリクスを確認し、この統合が提供するものを理解した後:

1. **[インテグレーションをインストールします](/docs/opentelemetry/integrations/elasticsearch/elasticsearch-otel-integration-install)**- ステップバイステップのセットアップ ガイドに従ってください。
2. **アラートのセットアップ**- クラスターの健全性やヒープ使用量などの重要なメトリクスのプロアクティブな監視を構成します。
3. **カスタムダッシュボードの作成**- 特定のElasticsearchユースケースに合わせたビューを構築します。
4. **関連するインテグレーションを探索する** - 他の[OpenTelemetry インテグレーション](/docs/opentelemetry/get-started/opentelemetry-get-started-intro)を使用してアプリケーション スタックを監視することを検討してください。