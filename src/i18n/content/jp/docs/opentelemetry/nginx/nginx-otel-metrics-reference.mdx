---
title: NGINX OpenTelemetryメトリクスとプロパティのリファレンス
metaDescription: 'Complete reference of NGINX metrics collected via OpenTelemetry, including resource attributes for both on-host and Kubernetes deployments.'
freshnessValidatedDate: never
translationType: machine
---

このリファレンスは、 OpenTelemetry NGINX レシーバーによって収集されたすべてのメトリクスとプロパティをカバーしており、オンホストとKubernetesデプロイメントの両方に適用されます。

## コア NGINX メトリクス [#core-metrics]

OpenTelemetry Collector Contrib の[nginxreceiver は](https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/nginxreceiver)、NGINX スタブ ステータス モジュールから次のメトリクスを収集します。

<table>
  <thead>
    <tr>
      <th style={{ width: "350px" }}>
        メトリック
      </th>

      <th>
        説明
      </th>

      <th>
        タイプ
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `nginx.connections_accepted`
      </td>

      <td>
        受け入れられたクライアント接続の合計数。これを使用して、時間の経過に伴う接続受け入れ率を追跡します。
      </td>

      <td>
        サム
      </td>
    </tr>

    <tr>
      <td>
        `nginx.connections_handled`
      </td>

      <td>
        処理された接続の合計数。一般に、問題の値は nginx.connections\_accepted と同じです。 一部のリソース制限（たとえば、worker\_connections 制限）に達していない限り。承認と処理の間のギャップは、リソースの制約を示唆しています。
      </td>

      <td>
        サム
      </td>
    </tr>

    <tr>
      <td>
        `nginx.connections_current`
      </td>

      <td>
        状態別の現在の nginx 接続数。状態には、<strong>アクティブ</strong>(アクティブな接続の合計)、<strong>読み取り中</strong>(要求ヘッダーの読み取り)、<strong>書き込み中</strong>(応答の書き込み)、<strong>待機中</strong>(次の要求を待機しているキープアライブ接続) が含まれます。
      </td>

      <td>
        サム
      </td>
    </tr>

    <tr>
      <td>
        `nginx.requests`
      </td>

      <td>
        サーバーの起動以降にサーバーに対して行われたrequestsの合計数。 レート計算を使用して、パフォーマンス監視の 1 秒あたりのrequestsを導き出します。
      </td>

      <td>
        サム
      </td>
    </tr>
  </tbody>
</table>

**キャパシティプランニングのヒント:**

* `waiting`接続数が多い場合は、キープアライブの調整が必要になる可能性があります
* `accepted`と`handled`接続間のギャップはリソースの制約を示唆しています
* リクエストと接続の比率はワーカー設定の最適化に役立ちます

## リソース属性 [#resource-attributes]

リソース属性は、NGINX デプロイメントに関するコンテキストを提供し、オンホスト デプロイメントを使用しているか、Kubernetes デプロイメントを使用しているかによって異なります。

### 共通の属性 [#common-attributes]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        属性
      </th>

      <th style={{ width: "350px" }}>
        説明
      </th>

      <th>
        値の例
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `state`
      </td>

      <td>
        接続の状態（ `nginx.connections_current`メトリクスに適用）
      </td>

      <td>
        `active`、`reading`、`writing`、 `waiting`
      </td>
    </tr>

    <tr>
      <td>
        `nginx.server.endpoint`
      </td>

      <td>
        NGINX スタブ ステータスのエンドポイント URL
      </td>

      <td>
        `http://localhost:8080/stub_status`
      </td>
    </tr>
  </tbody>
</table>

### オンホスト デプロイメント プロパティ [#on-host-attributes]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        属性
      </th>

      <th style={{ width: "350px" }}>
        説明
      </th>

      <th>
        値の例
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `nginx.deployment.name`
      </td>

      <td>
        この NGINX デプロイメントを識別するための一意の名前
      </td>

      <td>
        `production-web-01`, `staging-api`
      </td>
    </tr>

    <tr>
      <td>
        `nginx.display.name`
      </td>

      <td>
        「サーバー」プレフィックスとデプロイメント名を組み合わせた表示フレンドリーな名前
      </td>

      <td>
        `server:production-web-01`
      </td>
    </tr>

    <tr>
      <td>
        `host.name`
      </td>

      <td>
        NGINXが動作しているシステムのホスト名
      </td>

      <td>
        `web-server-01.example.com`
      </td>
    </tr>

    <tr>
      <td>
        `host.id`
      </td>

      <td>
        ホストシステムの一意の識別子
      </td>

      <td>
        `i-1234567890abcdef0`
      </td>
    </tr>

    <tr>
      <td>
        `logtype`
      </td>

      <td>
        収集されるログのタイプ (ログのみに適用されます)。 New Relic の組み込み[解析ルール](https://docs.newrelic.com/docs/logs/ui-data/built-log-parsing-rules/#nginx)によって使用されます。この属性は、ログ転送が有効になっている場合にのみ使用できます。
      </td>

      <td>
        `nginx` (アクセスログの場合)、 `nginx-error` (エラーログの場合)
      </td>
    </tr>
  </tbody>
</table>

### Kubernetes デプロイメント属性 [#kubernetes-attributes]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        属性
      </th>

      <th style={{ width: "350px" }}>
        説明
      </th>

      <th>
        値の例
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `k8s.cluster.name`
      </td>

      <td>
        Kubernetesクラスターの名前
      </td>

      <td>
        `nginx-cluster`, `production-k8s`
      </td>
    </tr>

    <tr>
      <td>
        `k8s.namespace.name`
      </td>

      <td>
        NGINX ポッドが実行されているKubernetesネームスペース
      </td>

      <td>
        `default`、 `web-services` 、 `production`
      </td>
    </tr>

    <tr>
      <td>
        `k8s.pod.name`
      </td>

      <td>
        NGINX を実行しているKubernetesの名前
      </td>

      <td>
        `nginx-deployment-7d4b8c6f9-x5z8w`
      </td>
    </tr>

    <tr>
      <td>
        `nginx.deployment.name`
      </td>

      <td>
        Kubernetes デプロイメントのポッド名を設定します
      </td>

      <td>
        `nginx-deployment-7d4b8c6f9-x5z8w`
      </td>
    </tr>

    <tr>
      <td>
        `nginx.display.name`
      </td>

      <td>
        クラスタ、ネームスペース、ポッド情報を含む包括的な表示名
      </td>

      <td>
        `server:k8s:nginx-cluster:default:pod:nginx-deployment-7d4b8c6f9-x5z8w:nginx:8080`
      </td>
    </tr>
  </tbody>
</table>

## メトリクスコレクションの詳細 [#collection-details]

### 収集頻度

* **デフォルトの間隔**: 30秒
* **設定可能**: OpenTelemetry Collector の設定で調整可能

### 情報源

すべてのメトリクスは NGINX [stub\_status モジュール](https://nginx.org/en/docs/http/ngx_http_stub_status_module.html)から収集されます。HTTP エンドポイントを公開するには、このモジュールを有効にして構成する必要があります。

### メトリックのタイプ

* **合計メトリクス**: 時間の経過に伴う合計を表す累積値
* **レート計算**: New Relicの`rate()`関数を使用して、累積メトリクスを監視用の 1 秒あたりのレートに変換します

## 関連ドキュメント [#related-docs]

**セットアップガイド:**

* [セルフホスト環境での NGINX の監視](/docs/opentelemetry/nginx/nginx-otel-host/)- オンホスト展開のセットアップを完了する
* [Kubernetes上の NGINX をモニターする](/docs/opentelemetry/nginx/nginx-otel-kubernetes/)- Kubernetesデプロイメントのセットアップを完了する

**データ使用量:**

* [NGINX データを検索して書き込みます](/docs/opentelemetry/nginx/find-and-query-your-data/)- Dashboards 、 NRQL書き込み、およびアラート

**技術リファレンス:**

* [NGINX レシーバーのドキュメント](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/nginxreceiver/documentation.md)- OpenTelemetry の技術詳細