---
title: APMメトリックアラート条件
tags:
  - Alerts and Applied Intelligence
  - New Relic Alerts
  - Alert conditions
metaDescription: How to create an APM metric alert condition using NRQL.
---

APMメトリックのアラート条件を作成するには、さまざまな方法がありますが、NRQLを使用することをお勧めします。NRQLを使用すると、追加の制御が可能になり、検出時間が短縮され、すべてのデータタイプに対して一貫性を維持できます。

2021年に、New Relic One全体でチャートとクエリからアラートNRQL条件をより簡単に作成できるようになります。このインテグレーションが完了するまでは、以下に説明する方法を使用してください。NRQLを使用してAPMの外部サービス条件を作成する方法に関する例を示します。

APMのメトリックの条件の設定は2段階のプロセスです。まずエンティティを識別し、次にNRQL条件を作成する必要があります。

## エンティティの識別 [#identify]

次のように作業を開始します。

1. [one.newrelic.com](https://one.newrelic.com)に移動し、ツールバーの\[**APM**]をクリックします。
2. アラートを作成するサービスを探します。
3. サービスをクリックします。
4. 左のナビゲーションペインで、\[**External services（外部サービス）**]をクリックします。
5. \[**}Top 20 external services（トップ20外部サービス）**]で、目的のサービスを見つけてクリックします。

   ![選択できるトップ20の外部サービスのリストを示す画面キャプチャ。](./image/top-twenty-2.png "top-twenty.png")
6. ページの右側には、**Response time（レスポンスタイム）**]と\[**External calls per minute（毎分の外部呼び出し数）**（スループット）のグラフがあります。この2つのオプションからアラートを作成するオプションを選択します。
7. 選択したグラフの右上隅にある3つのドットをクリックし、\[**View query（クエリの表示）**]を選択します。

   <Callout variant="tip">
     3つのドットが表示されない場合は、ページの最上部にある\[**Show new view（新しいビューを表示）**]オプションが有効になっていることを確認します。
   </Callout>

   ![メニューのオプションを示すスクリーンショット。](./image/external_service_graph_2.png "external_service_graph.png")
8. クエリをクリップボードにコピーします。
   * レスポンスタイムを選択すると、クエリは次のようになります。

     ![レスポンスタイムのクエリを示す例。](./image/response_time_query.png "response_time_query.png")
   * 毎分の外部呼び出し数を選択すると、クエリは次のようになります。

     ![外部呼び出しのクエリを示す例。](./image/external-calls-query.png "external-calls-query.png")

クリップボードにクエリがコピーされている場合は、次のセクションに進んでNRQLアラート条件を作成します。

## NRQL条件を作成する [#nrql-condition]

クエリを生成した後に、以下を実行します。

1. この条件を作成するアラートのポリシーに移動します。
2. \[**Add a condition（条件の追加）**]をクリックし、\[**NRQL**]タブを選択し、\[**Next, define thresholds..（次に、閾値を定義）**]をクリックします。
3. \[**Define your signal（信号を定義）**]で、クリップボードからクエリを貼り付けます。
4. `LIMIT`句、`SINCE...AGO`句、または`TIMESERIES`句があれば、それらを削除します。これらは、NRQLクエリ構文を有効にするために削除する必要があります。

   <Callout variant="tip">
     結果が返されない場合は、左上隅のアカウントドロップダウンを使用して、正しいアカウントを選択していることを確認します。
   </Callout>

   ![不要なNRQL句を削除するように促すスクリーンショット。](./image/remove_nrql_clauses.png "remove_nrql_clauses.png")
5. 残りのフィールドに入力してから条件を保存します。

NRQLを使用してAPMメトリックタイムスライスのデータにクエリを実行する方法については、[追加情報](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/query-apm-metric-timeslice-data-nrql#timeslice-conversion)をご覧ください。

## その他のヘルプ [#more_help]

さらに支援が必要な場合は、これらのサポートと学習リソースを確認してください：

* [Explorers Hub](https://discuss.newrelic.com/)を参照して、コミュニティから支援を受け、ディスカッションに参加してください。
* [当社のサイトで回答を見つけ、サポートポータルの使用方法について学びます](/docs/using-new-relic/welcome-new-relic/get-started/find-help-use-support-portal)。
* Linux、Windows、およびmacOSのトラブルシューティングツールである[New Relic Diagnosticsを実行します](/docs/using-new-relic/cross-product-functions/troubleshooting/new-relic-diagnostics)。
* New Relicの[データセキュリティ](/docs/security)と[ライセンス](/docs/licenses)ドキュメントを見直してください。
