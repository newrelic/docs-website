---
title: APIによるアラート条件の無効化と有効化
tags:
  - Alerts and Applied Intelligence
  - New Relic Alerts
  - REST API alerts
metaDescription: 'Read about using the New Relic REST API (v2) to add or remove apps, servers, and other entities from a policy condition.'
translationType: machine
---

ポリシーの中で、 [条件](/docs/alerts/new-relic-alerts/configuring-alert-policies/define-alert-conditions) は、何がアラートを引き起こすかを特定します。REST API を使用して、条件を無効化および有効化することができます。また、 [New Relic One](/docs/alerts/new-relic-alerts/updating-alert-policies/disable-or-delete-alert-policies-conditions#condition-on-off) で条件の無効化と有効化ができます。

[ポリシーは、APIでもUIでも、有効にしたり無効にしたりすることはできません](/docs/alerts/new-relic-alerts/updating-alert-policies/disable-or-delete-alert-policies-conditions#disable-policy) 。ポリシーの作成、削除、条件の変更のみ可能です。

## 要件

APIを使用して条件の任意の属性を変更するには、次のことが必要です。

* [APIキー](/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key) とアラートを管理するためのパーミッションが必要です。
* [条件の `ID` (API Explorer:](https://rpm.newrelic.com/api/explore/alerts_condition/list "新しいウィンドウにリンクが開きます。") **Alerts Conditions> GET> List** から入手可能)
* アカウントがEUデータセンターでデータをホストする場合は、適切な[EUリージョンアカウント向けAPIエンドポイント](/docs/using-new-relic/welcome-new-relic/getting-started/introduction-eu-region-data-center#endpoints)を使用していることを確認してください。

## 条件の有効化・無効化

条件を無効にしたり有効にしたりするプロセスは、条件の任意の属性を変更するための一般的なプロセスと同じです。この一般的な手順の後に、より詳細な例があります。

1. 変更したい条件が含まれているポリシーのIDを探します。

   ポリシーのIDが不明な場合は、ポリシーの名前またはタイプを使用してAPIコールを行い、ポリシーのIDを見つけます。このプロセスの詳細については、 [List a single policy](/docs/alerts/alert-policies/rest-api-alert-policies/list-policies-v2#single_policy) を参照してください。

2. ポリシーIDを使って、そのポリシーに関連する条件を返すAPIコールを行います。条件には4つのカテゴリーがあります。カテゴリーがわからない場合は、条件を見つけるために最大4回のAPIコールが必要になることがあります。

   <CollapserGroup>
     <Collapser
       id="types-conditions-API"
       title="コンディションID検索の詳細"
     >
       変更したい条件のカテゴリーがわからない場合は、4つの条件カテゴリーを使ってAPIコールを行い、検索する必要があります。ここでは、さまざまな条件カテゴリに対応したAPIコールのフォーマットを紹介します。

       * [APM、ブラウザ、モバイルのモニタリング 利用できる条件： apm_app_metric , apm_kt_metric , browser_metric , and mobile_metric API Explorer link ](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#conditions-list)  
        [> Get List](https://rpm.newrelic.com/api/explore/alerts_conditions/list)
       * [外部サービス](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#ext-conditions-list)  
         利用可能な条件： `apm_external_service`, `mobile_external_service`  
         [API Explorer link Get>List](https://rpm.newrelic.com/api/explore/alerts_external_service_conditions/list)
       * [シンセティック・モニタリング](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#synthetics-conditions-list)  
         [API Explorer link Get>List](https://rpm.newrelic.com/api/explore/alerts_synthetics_conditions/list)
     </Collapser>
   </CollapserGroup>

3. 返されたJSONから、変更したい条件のJSONオブジェクトを探します。

4. 条件のJSONを任意のテキストエディタにコピー＆ペーストし、JSONを編集します。条件を有効にするには、 `" enabled"` to `true` を設定します。条件を無効にするには、 `" enabled"` to `false` を設定します。

5. 編集したJSONをUpdate APIリクエストで送信することで、条件を更新します。製品によって必要なAPIリクエストは異なります。

   <CollapserGroup>
     <Collapser
       id="update-api-requests"
       title="アップデートAPIリクエストの詳細"
     >
       該当する製品に対応するUpdate APIリクエストを使用してください。

       * [APM、ブラウザ、モバイルの条件 利用できる条件： apm_app_metric , apm_kt_metric , browser_metric , and mobile_metric ](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#conditions-update)  
        [API Explorer PUT 更新リンク](https://rpm.newrelic.com/api/explore/alerts_conditions/update)

       * [外部サービスの条件](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#ext-conditions-update)  
         利用可能な条件： `apm_external_service`, `mobile_external_service`  
         [API Explorer PUT>Update](https://rpm.newrelic.com/api/explore/alerts_external_service_conditions/update)

       * [シンセティック・モニタリングの条件](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#synthetics-conditions-update))  
         [API Explorer PUT>アップデート](https://rpm.newrelic.com/api/explore/alerts_synthetics_conditions/update)

         <Callout variant="tip">
           Update APIリクエストは、一度に1つの条件しか変更できず、オブジェクトのベクターを更新することはできません。例えば、3つの条件を変更するには、3つの異なるリクエストを行う必要があります。
         </Callout>
     </Collapser>
   </CollapserGroup>

## 例APM条件の無効化 [#example]

以下の例では、 `apm_app_metric` の条件を無効にする方法を示しています。必要なAPIコールの種類を除いては、他の条件タイプを変更するプロセスと同様です。

1. 更新したいポリシーの **policy_id** を取得します。 `Logjam Alert` という名前の想像上のポリシーの場合、コマンドは次のようになります。

   ```
   curl -X GET 'https://api.newrelic.com/v2/alerts_policies.json' \
        -H 'Api-Key:<a href="/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key"><var>$API_KEY</var></a>' -i \
        -G --data-urlencode 'filter[name]= <var>Logjam Alert</var>'    <---<<<  {policy_name}
   ```

   このリクエストの出力は次のようになります。

   ```
   {
     "policies": [
       {
         "id": <var>85</var>,      <---<<<  <var>$POLICY_ID</var>
         "incident_preference": "PER_POLICY",
         "name": "Logjam Alert",
         "created_at": 1461176510393,
         "updated_at": 1461176510393
       }
     ]
   }
   ```

2. この保険の条件をすべて列挙し、 `{condition_id}の位置を確認してください。`:

   ```
   curl -X GET 'https://api.newrelic.com/v2/alerts_conditions.json' \
        -H 'X-Api-Key:<a href="/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key"><var>$API_KEY</var></a>' -i \
        -G -d 'policy_id=<var>85</var>'
   ```

   このリクエストの出力は次のようになります。

   ```
   {
     "conditions": [
       {
         "id": <var>12345</var>,       <---<<< <var>$CONDITION_ID</var>
         "type": "apm_app_metric",
         "name": "Apdex (Low)",
         <var>"enabled": true</var>,    <---<<< Note the condition is enabled
         "entities": [
           "8288171"
         ],
         "metric": "apdex",
         "terms": [
           {
             "duration": "5",
             "operator": "below",
             "priority": "critical",
             "threshold": "1",
             "time_function": "any"
           }
         ]
       },
       {
         "id": 2468,       <---<<< another condition_id
         "type": "apm_app_metric",
         "name": "Throughput (Low)",
         ...
       }
     ]
   }
   ```

3. 問題のある条件のみのJSONをコピーして、テキストエディタに貼り付けます。 `" enabled": true` を `" enabled": false` に変更します。編集後のJSONは以下のようになります。

   ```
   curl -X PUT 'https://api.newrelic.com/v2/alerts_conditions/<var>12345</var>.json' \
        -H 'X-Api-Key:<a href="/docs/apis/rest-api-v2/getting-started/introduction-new-relic-rest-api-v2#api_key"><var>$API_KEY</var></a>' -i \
        -H 'Content-Type: application/json' \
        -d \
   '{
     "condition": {
       "type": "apm_app_metric",
       "name": "Apdex (Low)",
       <var>"enabled": false</var>,       <---<<<  Changed to false
       "entities": [
         "8288171"
       ],
       "metric": "apdex",
       "terms": [
         {
           "duration": "5",
           "operator": "below",
           "priority": "critical",
           "threshold": "1",
           "time_function": "any"
         }
       ]
     }
   }'
   ```

4. 編集した条件のJSONを更新APIリクエストで送信して、条件を更新します。この特定の条件については、 [Update conditions for APM policies](/docs/alerts/new-relic-alerts/rest-api-alerts/rest-api-calls-new-relic-alerts#conditions-update) の手順に従います。他の製品の条件については、 [Update API requests](#update-api-requests) で詳述されているように、別の API リクエストがあります。
