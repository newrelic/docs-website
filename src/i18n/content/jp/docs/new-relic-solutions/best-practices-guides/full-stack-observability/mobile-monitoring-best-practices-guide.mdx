---
title: モバイル・モニタリング・ベスト・プラクティス・ガイド
tags:
  - New Relic solutions
  - Best practices guides
metaDescription: Best practices you can employ to take full advantage of New Relic' s mobile monitoring to eliminate crashes and increase speed across the stack.
translationType: machine
---

クラッシュを排除し、スタック全体の速度を向上させることで、モバイルアプリのリリースごとにパフォーマンスの向上を図ることができます。ここでは、New Relicによるモバイルモニタリングを最大限に活用するためのベストプラクティスをご紹介します。

## 1.データ収集開始 [#start-collecting]

**本番でのデータ収集を開始します。**

モバイルモニタリングSDKをアプリストアへの次回リリース時に追加すれば、すぐにその価値を実感できるでしょう。単にNew Relicの機能をテストするだけの場合でも、本番リリースにiOSまたはAndroidエージェントをインストールすることをお勧めします。そうすることで、New Relicのモバイルモニタリング機能やエンドユーザーの体験を十分に理解するための十分なデータを得ることができます。

### 設定方法 [#1-how-to]

<CollapserGroup>
  <Collapser
    id="1-add-more"
    title="モバイルアプリをNew Relicに追加する"
  >
    まず、New Relic のユーザーインターフェイスで新しいアプリを追加します（[全手順](/docs/mobile-monitoring/new-relic-mobile/getting-started/introduction-new-relic-mobile#new_users) ）。

    1. [one.newrelic.com](https://one.newrelic.com/) にアクセスし、 **Mobile** をクリックします。

    2. 監視しているアプリのリストから、 **「Add more」** を選択します。

    3. 該当するプラットフォームを選択します。

    4. モバイルアプリケーションに名前を付けて、**Continue**を選択します。

       1つのアプリと関連するアプリトークンをiOSアプリの開発リリースに、別のアプリと関連するアプリトークンをそのiOSアプリの本番リリースに、別のアプリトークンのペアをAndroidアプリの開発リリースと本番リリースに使用します。クエリビルダーを使って、4つのアプトークンのデータを比較することができます。
  </Collapser>

  <Collapser
    id="1-install"
    title="当社のモバイルSDKのインストールと設定"
  >
    次に、モバイルエージェントのインストールと設定を行います。

    1. New Relic の iOS または Android 用 SDK の最新版をダウンロードし、モバイルアプリに追加します。(詳しい手順は [iOS](/docs/mobile-monitoring/new-relic-mobile-ios/get-started/ios-installation-configuration#configuration) と [Android](/docs/mobile-monitoring/new-relic-mobile-android/get-started/android-installation-configuration#installation))
    2. 必要に応じて、インストールの設定を行います。例えば、以下のようになります。
    3. 機能フラグを有効にして、 `MobileRequest` イベントをキャプチャして、 [iOS](/docs/mobile-monitoring/new-relic-mobile-ios/api-guides/ios-agent-configuration-feature-flags#networkRequest) または [Android](/docs/mobile-monitoring/new-relic-mobile-android/api-guides/android-agent-configuration-feature-flags#feature-settings) の完全なネットワーク分析機能を使用します。
    4. 本番環境でのdSYMアップロードを自動化します。
    5. サプライズを避けるために、モバイルエージェントを開始する場所の標準的なパターンに従ってください。また、他のSDKを起動する前にエージェントを起動してください。詳細については、 [Android のインストールと設定](/docs/mobile-monitoring/new-relic-mobile-android/install-configure/installing-android-apps-gradle-android-studio) および [iOS のインストールと設定](/docs/mobile-monitoring/new-relic-mobile-ios/get-started/ios-installation-configuration) のドキュメントを参照してください。
    6. アプリケーションの新しいリリースをデプロイします。
  </Collapser>
</CollapserGroup>

## 2.データを見る [#key-features]

**すぐにデータを調べることができます。**

New Relic がデータのレポートを開始したら、すぐにモバイルアプリに関する豊富な情報を調べてみましょう。まずは、 [one.newrelic.com](https://one.newrelic.com) にアクセスし、 **Mobile** を選択してください。

### 設定方法 [#2-howto]

<CollapserGroup>
  <Collapser
    id="2-howto"
    title="クラッシュの分析、解決、防止"
  >
    クラッシュの原因を突き止め、修正することができます。そして、クラッシュの背後にあるトレンドを明らかにすることで、クラッシュを防ぐことができます。

    1. 監視対象のモバイルアプリのサマリーUIページから、 **Crash analysis** をクリックします。

    2. [クラッシュデータを分析する](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/crash-analysis-group-filter-your-crashes) 最も影響の大きいクラッシュを確認し、修正することができます。

       [クラッシュイベントトレイル](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/mobile-crash-event-trail) のパンくずをたどると、クラッシュの修正や重大なエラーの解決が容易になります。

    3. モバイルアプリの UI の **衝突分析** ページから、 **衝突タイプ** を選択します。

    4. クラッシュタイプの **Summary** ページから、 **Crash trail** タブを選択します。
  </Collapser>

  <Collapser
    id="workflows"
    title="主要なワークフローのモニタリング"
  >
    [カスタムブレッドクラム](/docs/mobile-monitoring/new-relic-mobile/maintenance/add-custom-data-new-relic-mobile#custom-breadcrumbs) を作成して、主要なワークフロー（アプリのログインやチェックアウトのプロセスなど）を監視し、ユーザーのクリックを追跡し、タイミングを最適化し、MTTRを短縮するためにクラッシュ箇所を特定します。
  </Collapser>

  <Collapser
    id="sessions"
    title="実用的なセッションデータの取得"
  >
    [例のクエリ](/docs/insights/nrql-new-relic-query-language/nrql-examples/insights-query-examples-mobile) から借りる。

    * ユーザーのうち、どれだけの人が最新のアプリにアップグレードしたかを確認できます。
    * 採用状況を長期的に追跡する。
    * 新規インストールと旧バージョンからのアップグレードの数を把握することができます。
    * 地理的な場所、通信事業者、ASNオーナー（Wi-Fiプロバイダー）、デバイス、接続タイプなどの使用量の分布を確認できます。
  </Collapser>
</CollapserGroup>

## 3.防止策を講じる [#crashes-performance]

**アラート通知を利用して、クラッシュやエラーの原因を明らかにすることができます。**

モバイルモニタリング機能を本番環境で運用し、いくつかの主要な機能を確認したら、New Relicを使ってモバイルアプリケーションの重要な問題を発見することができます。特に、クラッシュやエラーに注目してください。

1. メトリクスベースのアラートを出発点として、問題を高レベルで可視化することができます。
2. そして、新しいサービスや機能が追加されると、New Relicのより的を絞ったイベントベース（NRQL）のアラートを使用して、最も重要な問題が迅速に処理されるようにします。

これらのアラートを使用して、クラッシュが多くのユーザーに影響を与えているかどうかを判断します。影響がある場合は、関連する人（例えば、モバイルアプリチームのオンコールメンバーと、関連するバックエンドサービスのオーナーの両方）にアラートが送られます。

モバイルアプリのクラッシュ率（セッションごとのクラッシュ）やクラッシュの影響を受けたユーザーの割合の変化に対応する方法を、チームが把握していることを確認します。

### 設定方法 [#3-howto-alerts]

<CollapserGroup>
  <Collapser
    id="3-howto-metric-alerts"
    title="メトリクスベースのアラート"
  >
    メトリクスベースのアラートやモバイルモニタリングUIをご利用ください。

    * モバイルチームの主要なメンバーが、新しいクラッシュが発生した際に [のメールを受信するように設定していることを確認してください。これらのメールは、モバイルアプリのUIページにあるクラッシュの種類を表示します。](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/receive-crash-notifications-email)

      [](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/receive-crash-notifications-email)

    * [](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/receive-crash-notifications-email)

    * [](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/receive-crash-notifications-email)

      [](/docs/mobile-monitoring/mobile-monitoring-ui/crashes/receive-crash-notifications-email)[クラッシュレートのしきい値](/docs/alerts/new-relic-alerts/defining-conditions/define-alert-conditions#create-condition) のアラートを作成し、チームの主要メンバーがSlackやその他のアラート通知チャネルで閲覧できるようにします。

      アラート通知には、当社のUIへのリンクが含まれており、そこで閾値を超えたチャートを確認することができます。そこから、関連するモバイルモニタリングページへのリンクが表示され、詳細を確認することができます。
  </Collapser>

  <Collapser
    id="3-howto-nrql"
    title="イベントベースのアラート"
  >
    メトリックベースのワークフローと、モバイルアプリやシステムに特化したイベントベースのアラートやダッシュボードを組み合わせることができます。

    1. 直近にリリースされた製品版のクラッシュに焦点を当てたNRQLアラートを作成します。
    2. 最新のアプリバージョンでクラッシュの影響を受けたユーザーの割合に焦点を当てた追加のNRQLアラートを作成します（ユーザーベースへの全体的な影響を確認します）。
  </Collapser>
</CollapserGroup>

## 4.クラッシュをより深く掘り下げる [#crash-reporting]

**あなたのクラッシュレポートを次のレベルに引き上げます。**

今度は、再現性の低いクラッシュに挑戦してみましょう。

1. アプリケーションに追加のインストルメントを適用する
2. クラッシュイベントトレイル、NRQLクエリ、ダッシュボードを活用して、データを可視化します。

### 設定方法 [#4-howto]

<CollapserGroup>
  <Collapser
    id="4-howto-analysis"
    title="クラッシュ分析"
  >
    モバイルアプリケーションを大規模に運用する場合、クラッシュは避けられません。最も影響の大きいクラッシュを把握するためのツールを提供しています。 **クラッシュ分析** UIを使用すると、どのクラッシュが最も頻繁に発生しているか、クラッシュのないユーザーの割合、クラッシュの約80％に関連するファイルやメソッド、特定のユーザーが経験したばかりのクラッシュなどを確認できます。

    衝突分析でインパクトの強い事故を追求する。

    1. [カスタム属性](/docs/insights/insights-data-sources/custom-events/insert-custom-events-attributes-mobile-data) を追加して、価値の高い顧客を分類し、その属性を使って最も価値の高いオーディエンスに応じてクラッシュをセグメント化します。
    2. パンくずやカスタムイベントを追加して、すべてのクラッシュ発生（過去90日間）に至るまでのイベントの詳細な証跡を作成することができます。そして、このクラッシュ・イベント・トレイルをモバイル・モニタリングUIで表示します。
    3. モバイルモニタリングの [**バージョンの傾向** ページ](/docs/mobile-monitoring/mobile-monitoring-ui/mobile-app-pages/version-trends-compare-user-adoption-metrics-performance) を使用して、後続のリリースでクラッシュ率が改善されていることを確認し、リグレッションを回避することができます。
  </Collapser>

  <Collapser
    id="4-howto-breadcrumbs"
    title="ブレッドクラム"
  >
    パンくずやカスタムアトリビュートを使用して、クラッシュの再現やデバッグを改善します。例えば、 `recordBreadrumb` API for [Android](/docs/mobile-monitoring/new-relic-mobile-android/android-sdk-api/recordbreadcrumb) or [iOS](/docs/mobile-monitoring/new-relic-mobile-ios/ios-sdk-api/record-breadcrumb) を使用して、以下のようなクラッシュのデバッグに役立つセッション中の状態の変化を追跡します。

    * 接続形態の変更
    * オリエンテーションの変更
    * アプリコードの重要なポイントでのCPUとメモリの状態
  </Collapser>

  <Collapser
    id="4-howto-attributes"
    title="カスタムアトリビュート"
  >
    既存のイベントにカスタム属性を追加することで、モバイルアプリに対してより正確な質問をすることができます。次のようなディメンションを追加します。

    * ユーザーID。特定のユーザーの懸念に対応し、どの顧客やセグメントが最も影響を受けているかをよりよく理解するために使用します。

    * ストアID：デバイスが古い、Wi-Fiの調子が悪いなどの問題に対処するために使用します。

    * ユーザーセグメント。どのお客様やセグメントに最も影響があるのかをよりよく理解するために使用します。例えば、ログインしたお客様とログインしていないお客様などです。

    * セッション終了時のカートの中のお金

    * アプリへのエントリーの起源または帰属

      カスタム属性名をモバイルアプリ全体で標準化し、Webサイト（ブラウザモニタリングを使用している場合）と整合させることで、エンドユーザーチャネル間のパフォーマンスを比較対照することができます。モバイルエージェントは、クラッシュしたセッションとクラッシュしていないセッションの最後のインタラクションを追跡し、ユーザーがアプリを終了する前に何を見ていたかを可視化します（意図的に、またはクラッシュのために）。
  </Collapser>
</CollapserGroup>

## 5.KPIへの注力 [#key-performance]

**重要なパフォーマンス指標に命を吹き込む**

カスタムのインタラクションやイベントを作成して、アプリのビジネスクリティカルな部分のユーザーアクティビティなど、最も重要なシグナルに焦点を当てます。これらの強力なAPIを使用することで、あらゆるものにカスタムインスツルメンテーションを追加することができます。以下に使用例を紹介します。

### 設定方法 [#5-howto]

<CollapserGroup>
  <Collapser
    id="5-howto-feature"
    title="機能の使用状況の把握と照会"
  >
    カスタムイベントを使用して、機能の使用状況を追跡します。例えば、以下のようになります。

    * カスタムイベントを使用して、アプリとウェブサイト間のユーザーフローを追跡します。

    * カスタムイベントやモバイルブレッドクラムを使用して、主要なユーザーフロー（ログイン、ショッピングカートなど）のパフォーマンスを最適化します。

    * カスタムイベントを利用して、デジタル化された顧客に、より迅速でコンテクストのあるサポート体験を提供します。

    * `recordCustomEvent` APIを使用します。そして、異なる機能の使用を使用して比較します。

      ```
      SELECT count(*) FROM MyNewMobileEventType FACET name
      ```
  </Collapser>

  <Collapser
    id="5-howto-pageload"
    title="ページのロードタイムの計測"
  >
    カスタムイベントを使用して、ページのロードタイムを測定します。

    1. アプリ起動タイマーを作成し、ユーザーがアプリを起動するためにタップしてから、アプリのコード内で最初の画面が表示されるまでの時間を測定します。タイマーの値をNew Relicに以下のような方法で記録します。

       ```
       recordCustomEvent(<myMobileTimers>, <appLaunch>, {attributes})
       ```

    2. スピナーの持続時間を測定するために開始タイマーと停止タイマーを定義し、以下のような方法でNew Relicにこの時間を記録します。

       ```
       recordCustomEvent(<myMobileTimers>, <spinnerOnScreenA>, {attributes})
       ```

    3. アプリ内の特定のユーザーアクションやファネルステップをトラッキングし（"add to cart" など）、そのイベントの属性として価格を含めます。

    4. Insightsのカスタムイベントで関連するファネルステップを表示して、アプリケーションを介したフローを測定します。例えば、タイマーを作成して、複数のファネルステップにまたがるサブフローまたはフロー全体の開始時間と終了時間を追跡し、ユーザーがプロセスを通過するのにかかった時間を理解することができます。
  </Collapser>

  <Collapser
    id="5-howto-interactions"
    title="ウェブページのインタラクションに関するデータを調べる"
  >
    カスタムインタラクションを使用して、同じウェブページに関連するトレースを確認できます。

    1. エージェントAPIを使用してデフォルトのインタラクションを無効にし、カスタムインタラクションに焦点を当てることで、プライマリーファネルにとって最も重要なページロードを見直すことができます。

    2. これらのカスタムインタラクションの開始時間と停止時間を定義することで、ファネルの個々のステップに関連するアクティビティ（例えば、特定のユーザーアクションやページロードなど）をトレースすることができます。

    3. クラッシュしたセッションとクラッシュしていないセッションの最後のインタラクションを追跡することで、ユーザーがアプリを終了する前に何を見ていたのかを知ることができます（意図的な場合も、クラッシュした場合も）。

       **クラッシュしていないセッションのクエリ例**

       ```
       SELECT count(*) FROM Mobile WHERE sessionCrashed is null FACET lastInteraction SINCE 90 days ago
       ```

       **クラッシュしたセッションのクエリ例**

       ```
       SELECT count(*) FROM Mobile WHERE sessionCrashed is true FACET lastInteraction SINCE 90 days ago
       ```
  </Collapser>
</CollapserGroup>