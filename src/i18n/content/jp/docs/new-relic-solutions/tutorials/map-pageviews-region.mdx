---
duration: 30
title: ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§åœ°åŸŸåˆ¥ã«ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã‚’ãƒãƒƒãƒ—ã™ã‚‹
metaDescription: Build a New Relic app showing page view data on a world map.
freshnessValidatedDate: never
translationType: machine
---

New Relic ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã—ã€ãã“ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ãŸã‚ã®å¼·åŠ›ã§æŸ”è»Ÿãªãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚ ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯New Relicã®ã‚¯ã‚¨ãƒªè¨€èª ( NRQL - ã€ŒãƒŠãƒ¼ã‚¯ãƒ«ã€ã¨ç™ºéŸ³) ã‚’ä½¿ç”¨ã—ã¦ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã—ã€ãƒšãƒ¼ã‚¸ ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ æ¬¡ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¾ã™ã€‚ æœ€å¾Œã«ã€ã‚‚ã†å°‘ã—æ™‚é–“ãŒã‚ã‚Šã€ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã® React ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€åé›†ã—ãŸãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã‚’ä¸–ç•Œåœ°å›³ä¸Šã«è¡¨ç¤ºã§ãã¾ã™ã€‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€æ¬¡ã® 2 ã¤ã®æ–¹æ³•ã§ãƒšãƒ¼ã‚¸ ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

* ãƒ†ãƒ¼ãƒ–ãƒ«ã§
* åœ°å›³ä¸Šã§

**Before you begin** \[å§‹ã‚ã‚‹å‰ã«]ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ã€å¿…è¦ãªã‚‚ã®ãŒã™ã¹ã¦æƒã£ã¦ã„ã‚‹ã“ã¨ã€é€”ä¸­ã§è¡Œãè©°ã¾ã‚‰ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚

## ã‚ãªãŸãŒå§‹ã‚ã‚‹å‰ã« [#begin]

ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚‚ã®ãŒå¿…è¦ã§ã™ã€‚

* New Relicã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€API ã‚­ãƒ¼ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ«ã€‚
* ã‚¢ãƒ—ãƒªã«å…¥åŠ›ã™ã‚‹ New Relic Browser ã®ãƒšãƒ¼ã‚¸ ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã€‚ ã“ã®ãƒ‡ãƒ¼ã‚¿ãŒãªã‘ã‚Œã°ã€ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’å®Œäº†ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚

ã‚¬ã‚¤ãƒ‰ã®å¾ŒåŠã§ä¸–ç•Œåœ°å›³ã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã™ã‚‹ã«ã¯:

* npm ã¯ã€ã‚¬ã‚¤ãƒ‰ã®ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ– ãƒãƒƒãƒ—ã®æ§‹ç¯‰ã«ä½¿ç”¨ã•ã‚Œã‚‹ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã® JavaScript React ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹[Leaflet ã‚’](https://www.npmjs.com/package/leaflet)ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã—ã¾ã™ã€‚ React ã¨ npm ã‚’åˆã‚ã¦ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€ã“ã“ã‹ã‚‰[Node.js ã¨ npm ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](https://nodejs.org/en/download/)ã§ãã¾ã™ã€‚

## New Relicã®ç”¨èª [#terminology]

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ä½¿ç”¨ã•ã‚Œã‚‹ç”¨èªã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

* New Relic ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³: ãƒ‡ãƒ¼ã‚¿ãŒ New Relic ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹å®Œæˆå“ã€‚ ã“ã‚Œã¯ã€ä¸€é€£ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒãƒ£ãƒ¼ãƒˆã‚„ä¸–ç•Œåœ°å›³ã®ã‚ˆã†ã«è¦‹ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚
* Nerdpack: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ©Ÿèƒ½ã¨å¤–è¦³ã‚’åˆ¶å¾¡ã™ã‚‹ JavaScriptã€JSONã€CSSã€ãŠã‚ˆã³ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã® New Relic ã®æ¨™æº–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€‚ è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [Nerdpack ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ](/docs/new-relic-solutions/build-nr-ui/nerdpack-file-structure)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
* ãƒ©ãƒ³ãƒãƒ£ãƒ¼: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒªãƒªãƒ¼ã‚¹ã™ã‚‹New Relicå†…ã®ãƒœã‚¿ãƒ³ã€‚
* Nerdlets: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹ç¯‰ã«ä½¿ç”¨ã•ã‚Œã‚‹ New Relic React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® 3 ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯`index.js` ã€ `nr1.json` ã€ `styles.scss`ã§ã™ãŒã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ç‹¬è‡ªã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

## ãƒ†ãƒ¼ãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ§‹ç¯‰ [#build-app-table-chart]

<Steps>
  <Step>
    ### ãƒ–ãƒ©ã‚¦ã‚¶ãƒ‡ãƒ¼ã‚¿ã‚’ç…§ä¼šã™ã‚‹ [#query-data]

    æ¬¡ã®ã‚ˆã†ã«ã€ã‚¯ã‚¨ãƒªãƒ“ãƒ«ãƒ€ãƒ¼ã‚’ä½¿ç”¨ã—ã¦NRQLã‚¯ã‚¨ãƒªã‚’è¨˜è¿°ã—ã€ãƒšãƒ¼ã‚¸ ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

    New Relic ã§ã€å³ä¸Šéš…ã«ã‚ã‚‹**Query your data** \[ãƒ‡ãƒ¼ã‚¿ã®ã‚¯ã‚¨ãƒª]ã‚’é¸æŠã—ã¾ã™ã€‚ ã“ã‚Œã«ã‚ˆã‚Šã€ **NRQL**ãƒ¢ãƒ¼ãƒ‰ã«ãªã‚Šã¾ã™ã€‚ ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹å‰ã«ã€NRQL ã‚’ä½¿ç”¨ã—ã¦ã‚¯ã‚¨ãƒªã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

    ã“ã®ã‚¯ã‚¨ãƒªã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚¯ãƒªã‚¢ãªã‚¯ã‚¨ãƒª ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è²¼ã‚Šä»˜ã‘ã€ **Run** \[å®Ÿè¡Œ]ã‚’é¸æŠã—ã¾ã™ã€‚

    ```sql
    FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000
    ```

    PageView ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆã€ã“ã®ã‚¯ã‚¨ãƒªã§ã¯ã€å›½åˆ¥ã«åˆ†é¡ã•ã‚Œã€1,000 é …ç›®ã«åˆ¶é™ã•ã‚ŒãŸ 1 é€±é–“ã®å¹³å‡ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ ãƒ†ãƒ¼ãƒ–ãƒ«ã¯å…¨å¹…ã«ãªã‚Šã€CSS ã§å®šç¾©ã•ã‚ŒãŸã€Œchartã€ã‚¯ãƒ©ã‚¹ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

    ã“ã®æ™‚ç‚¹ã§çµæœãŒãªã„å ´åˆã¯ã€ã‚¯ã‚¨ãƒªã«ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ ã‚ãªãŸã®æ›¸ãè¾¼ã¿ãŒæ­£ã—ã„å ´åˆã¯ã€[ãƒ–ãƒ©ã‚¦ã‚¶ ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ](/docs/browser/browser-monitoring/installation/install-browser-monitoring-agent/)ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
  </Step>

  <Step>
    ### æ–°ã—ã„Nerdpackã‚’ä½œæˆã—ã¦æä¾›ã™ã‚‹ [#create-nerdpack]

    ã¾ãšã€æ–°ã—ã„ Nerdpack ã‚’ä½œæˆã—ã€ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‹ã‚‰ New Relic ã«æä¾›ã—ã¾ã™ã€‚

    1. `nr1`ã‚’æ›´æ–°ã—ã€ã“ã®ã‚¢ãƒ—ãƒªã®æ–°ã—ã„ Nerdpack ã‚’ä½œæˆã—ã¾ã™:

    ```bash
    nr1 update
    nr1 create --type nerdpack --name pageviews-app
    [output] {success}âœ”  {plain}Component created successfully!
    [output]    {purple}nerdpack {blue}pageviews-app {plain}is available at {green}"./pageviews-app"
    ```

    2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ New Relic ã«æä¾›ã—ã¾ã™ã€‚

    ```bash animate
    cd pageviews-app && nr1 nerdpack:serve
    [output] Found and loaded {green}2 {plain}nr1.json files on PageviewsApp ({purple}00e0f043-1fc3-42cd-a8ca-7eef5fc9cd45{plain}) Nerdpack.
    [output]
    [output] {purple}Nerdpack:
    [output] {success}âœ”  PageviewsApp {purple}(00e0f043-1fc3-42cd-a8ca-7eef5fc9cd45) {blue}nr1.json
    [output]
    [output] {purple}Launchers:
    [output] {success}âœ”  {green}pageviews-app-launcher {blue}launchers/pageviews-app-launcher/nr1.json
    [output]
    [output] {purple}Nerdlets:
    [output] {success}âœ”  {green}pageviews-app-nerdlet {blue}nerdlets/pageviews-app-nerdlet/nr1.json
    [output]
    [output] ğŸ›   Built artifact files for:
    [output] {yellow}â  {purple}00e0f043-1fc3-42cd-a8ca-7eef5fc9cd45--pageviews-app-nerdlet {plain}built {success}âœ”
    [output]
    [output] {success}âœ”  {plain}Nerdpack built successfully!
    [output] {yellow}â˜…  {plain}Starting as orchestrator...
    [output]
    [output] {success}âœ”  {plain}Server ready! Test it at: https://staging-one.newrelic.com/?nerdpacks=local
    [output] {blue}â†©  Server will reload automatically if you modify any file!
    [output]
    [output] ğŸ›   Built artifact files for:
    [output] {yellow}â  {purple}00e0f043-1fc3-42cd-a8ca-7eef5fc9cd45--pageviews-app-nerdlet {plain}built {success}âœ”
    [output]
    [output] {success}âœ”  {plain}Nerdpack built successfully!
    ```
  </Step>

  <Step>
    ### ã‚¢ãƒ—ãƒªãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¢ãƒ—ãƒªã‚’è¡¨ç¤ºã™ã‚‹ [#review-files]

    1. `pageviews-app`ã«ç§»å‹•ã—ã¦ã€ãã®æ§‹é€ ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ ãƒ©ãƒ³ãƒãƒ£ãƒ¼ ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€New Relic ã®ã‚¢ãƒ—ãƒª ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã«è¡¨ç¤ºã•ã‚Œã‚‹èª¬æ˜ã¨ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚ ã¾ãŸã€ `nerdlets`ã‚‚å«ã¾ã‚Œã¦ãŠã‚Šã€ãã‚Œãã‚Œã« 3 ã¤ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ ãƒ•ã‚¡ã‚¤ãƒ« ( `index.js` ã€ `nr1.json` ã€ `styles.scss`ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ ã“ã®ã‚¬ã‚¤ãƒ‰ã®ä¸€éƒ¨ã¨ã—ã¦ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€éƒ¨ã‚’ç·¨é›†ã—ã¾ã™ã€‚ è©³ç´°ã«ã¤ã„ã¦ã¯ã€ [Nerdpack ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ](/docs/new-relic-solutions/build-nr-ui/nerdpack-file-structure)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

    2. browserã§ `https://one.newrelic.com/?nerdpacks=local` ã‚’é–‹ãã€ **Apps** \[ã‚¢ãƒ—ãƒª] ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€æä¾›ã—ãŸ `pageview-apps` Nerdpack ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

    ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚’é¸æŠã™ã‚‹ã¨ã€ `Hello`ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
  </Step>

  <Step>
    ### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã™ã‚‹ [#account-id]

    ã“ã®æ¼”ç¿’ã®ç›®çš„ã¨åˆ©ä¾¿æ€§ã®ãŸã‚ã«ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ID ã‚’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ `pageview-app-nerdlet`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®`index.js`ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ `import`è¡Œã¨`export`è¡Œã®é–“ã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚ ([ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ ID ã®ç¢ºèªæ–¹æ³•ã«ã¤ã„ã¦ã¯ã€ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„](/docs/accounts/install-new-relic/account-setup/account-id))ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return <h1>Hello, pageview-app-nerdlet Nerdlet!</h1>;
      }
    }
    ```
  </Step>

  <Step>
    ### ã‚¤ãƒ³ãƒãƒ¼ãƒˆ `TableChart` [#import-table-component]

    ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ†ãƒ¼ãƒ–ãƒ« ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã™ã‚‹ã«ã¯ã€New Relic ã‹ã‚‰`TableChart`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ `index.js`ã§ã€ `import React`ã®ä¸‹ã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return <h1>Hello, pageview-app-nerdlet Nerdlet!</h1>;
      }
    }
    ```
  </Step>

  <Step>
    ### 1è¡Œã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã™ã‚‹ [#add-single-row-table]

    1 è¡Œã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ `index.js`ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ã“ã®è¡Œã‚’æ¬¡ã®`export`ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return (
          <div className="container">
            <div className="row"></div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### ãƒ†ãƒ¼ãƒ–ãƒ«ã®å¤–è¦³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ [#customize-table]

    æ¨™æº– CSS ã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å¤–è¦³ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

    `styles.scss`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã“ã® CSS ã‚’è¿½åŠ ã—ã¾ã™ã€‚ ã“ã® CSS ã‚’å¥½ã¿ã«åˆã‚ã›ã¦è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ãã ã•ã„ã€‚

    ```css fileName=pageview-app-nerdlet/styles.scss
    .container {
      width: 100%;
      height: 99vh;
      display: flex;
      flex-direction: column;
      .row {
        margin: 10px;
        display: flex;
        flex-direction: row;
      }
      .chart {
        height: 250px;
      }
    }
    ```
  </Step>

  <Step>
    ### ãã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ [#add-data-table]

    ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚ŒãŸã®ã§ã€ã“ã®ã‚¬ã‚¤ãƒ‰ã®å†’é ­ã§è¨˜è¿°ã—ãŸ NRQL ã‚¯ã‚¨ãƒªã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿ãŒå…¥åŠ›ã•ã‚ŒãŸ`TableChart`ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã§ãã¾ã™ã€‚

    ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’`row` div ã«æŒ¿å…¥ã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return (
          <div className="container">
            <div className="row">
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    New Relic ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€ã‚¢ãƒ—ãƒªã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ãƒ¼ãƒ–ãƒ«å†…ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¾ã™ã€‚ (ã‚¢ãƒ—ãƒªã‚’å†åº¦ New Relic ã«æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚)

    ãŠã‚ã§ã¨ã†ï¼ ã‚¢ãƒ—ãƒªãŒå®Œæˆã—ã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’åœ°å›³ä¸Šã«è¡¨ç¤ºã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
  </Step>
</Steps>

## ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ã£ã¦ã‚¢ãƒ—ãƒªã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹ [#app-text-field]

ã‚¢ãƒ—ãƒªã‹ã‚‰ New Relic ã«ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ãŸã‚‰ã€ã‚¢ãƒ—ãƒªã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚ ãã®å¾Œã€ `Leaflet`ã¨ã„ã†ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã€ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸–ç•Œåœ°å›³ä¸Šã«è¡¨ç¤ºã—ã¾ã™ã€‚

<Steps>
  <Step>
    ### ã‚¤ãƒ³ãƒãƒ¼ãƒˆ `TextField` [#import-textfield]

    `TableChart`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å ´åˆã¨åŒæ§˜ã«ã€New Relic ã‹ã‚‰[`TextField`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’](/docs/new-relic-solutions/build-nr-ui/sdk-component/controls/TextField/)ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart, TextField } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return (
          <div className="container">
            <div className="row">
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¡Œã‚’è¿½åŠ ã™ã‚‹ [#add-row-textfield]

    ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä¸Šã«ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã«ã¯ã€ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’`TableChart` div ã®ä¸Šã«é…ç½®ã—ã¾ã™ã€‚ ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€ŒUSã€ã«ãªã‚Šã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart, TextField } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      render() {
        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ [#build-text-field]

    `render()`é–¢æ•°ã®ä¸Šã«ã€ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®`constructor`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart, TextField } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      render() {
        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    `return`ã®ä¸Šã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™:

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart, TextField } from 'nr1';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    æ¬¡ã«ã€ãƒ†ãƒ¼ãƒ–ãƒ« ãƒãƒ£ãƒ¼ãƒˆ ã‚¯ã‚¨ãƒªã«`countryCode`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from "react";
    import { TableChart, TextField } from "nr1";

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ""
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è©¦ã™ã«ã¯ã€ã‚¢ãƒ—ãƒªã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚
  </Step>
</Steps>

## ãƒ‡ãƒ¼ã‚¿ã‚’åœ°å›³ä¸Šã«è¡¨ç¤ºã™ã‚‹ [#add-data-map]

ãƒãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€npm ã‚’ä½¿ç”¨ã—ã¦`Leaflet`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

<Steps>
  <Step>
    ### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« `Leaflet` [#install-leaflet]

    ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§æ¬¡ã®ã‚ˆã†ã«å…¥åŠ›ã—ã¾ã™:

    ```bash
    npm install --save leaflet react-leaflet
    ```

    nerdlets `styles.scss`ãƒ•ã‚¡ã‚¤ãƒ«ã«ã€ `Leaflet` CSS ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```css fileName=pageview-app-nerdlet/styles.scss
    @import `~leaflet/dist/leaflet.css`;

    .container {
      width: 100%;
      height: 99vh;
      display: flex;
      flex-direction: column;
      .row {
        margin: 10px;
        display: flex;
        flex-direction: row;
      }
      .chart {
        height: 250px;
      }
    }
    ```

    `styles.scss`ã«ã„ã‚‹é–“ã«ã€ãƒãƒƒãƒ—ã®å¹…ã¨é«˜ã•ã‚’ä¿®æ­£ã—ã¾ã™ã€‚

    ```css fileName=pageview-app-nerdlet/styles.scss
    @import `~leaflet/dist/leaflet.css`;

    .container {
      width: 100%;
      height: 99vh;
      display: flex;
      flex-direction: column;
      .row {
        margin: 10px;
        display: flex;
        flex-direction: row;
      }
      .chart {
        height: 250px;
      }
    }

    .containerMap {
      width: 100%;
      z-index: 0;
      height: 70vh;
    }
    ```
  </Step>

  <Step>
    ### webpackè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ `Leaflet`

    nerdpack ã®æœ€ä¸Šä½ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã« webpack è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«`.extended-webpackrc.js`ã‚’è¿½åŠ ã—ã¾ã™ã€‚ ã“ã‚Œã¯ã€ `Leaflet`ã‹ã‚‰ã®ãƒãƒƒãƒ— ã‚¿ã‚¤ãƒ«æƒ…å ±ãƒ‡ãƒ¼ã‚¿ã®ä½¿ç”¨ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```jsx fileName=.extended-webpackrc.js
    module.exports = {
      module: {
        rules: [
          {
            test: /\.(png|jpe?g|gif)$/,
            use: [
              {
                loader: 'file-loader',
                options: {},
              },
              {
                loader: 'url-loader',
                options: { limit: 25000 },
              },
            ],
          },
        ],
      },
    };
    ```
  </Step>

  <Step>
    ### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ `Leaflet`

    `index.js`ã§ã€ `Leaflet`ã‹ã‚‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import { TableChart, TextField } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### New Relicã‹ã‚‰è¿½åŠ ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹

    `Leaflet`ãƒãƒƒãƒ—ã‚’æ­£å¸¸ã«å‹•ä½œã•ã›ã‚‹ã«ã¯ã€New Relic ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã•ã‚‰ã«ã„ãã¤ã‹å¿…è¦ã§ã™ã€‚ æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    `NerdGraphQuery` ä¸€åº¦ã«è¤‡æ•°ã® NRQL ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã€ãƒãƒƒãƒ—ã«ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ `Spinner`èª­ã¿è¾¼ã¿ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¿½åŠ ã—ã¾ã™ã€‚ `Button`ãƒœã‚¿ãƒ³ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚ `BlockText`ãƒ–ãƒ­ãƒƒã‚¯ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æä¾›ã—ã¾ã™ã€‚
  </Step>

  <Step>
    ### ãƒãƒƒãƒ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ [#get-data-map]

    ç·¯åº¦ã¨çµŒåº¦ã‚’å›½ã‚³ãƒ¼ãƒ‰ã¨ã¨ã‚‚ã«ä½¿ç”¨ã—ã¦ã€New Relic ãƒ‡ãƒ¼ã‚¿ã‚’åœ°å›³ä¸Šã«é…ç½®ã§ãã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      mapData() {
        const { countryCode } = this.state;
        const query = `{
          actor {
            account(id: 1606862) {
              mapData: nrql(query: "SELECT count(*) AS 'x', average(duration) AS 'y', sum(asnLatitude)/count(*) AS 'lat', sum(asnLongitude)/count(*) AS 'lng' FROM PageView FACET regionCode, countryCode WHERE appName = 'WebPortal' ${
                countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
              } LIMIT 1000 ") {
                results
                nrql
              }
            }
          }
        }`;

        return query;
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### ãƒãƒƒãƒ—ãƒãƒ¼ã‚«ãƒ¼ã®è‰²ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ [#customize-map-colors]

    `mapData`é–¢æ•°ã®ä¸Šã«ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦ã€ãƒãƒƒãƒ— ãƒãƒ¼ã‚«ãƒ¼ã®è‰²ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      getMarkerColor(measure, apdexTarget = 1.7) {
        if (measure <= apdexTarget) {
          return '#11A600';
        } else if (measure >= apdexTarget && measure <= apdexTarget * 4) {
          return '#FFD966';
        } else {
          return '#BF0016';
        }
      }

      mapData() {
        const { countryCode } = this.state;
        const query = `{
          actor {
            account(id: 1606862) {
              mapData: nrql(query: "SELECT count(*) AS 'x', average(duration) AS 'y', sum(asnLatitude)/count(*) AS 'lat', sum(asnLongitude)/count(*) AS 'lng' FROM PageView FACET regionCode, countryCode WHERE appName = 'WebPortal' ${
                countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
              } LIMIT 1000 ") {
                results
                nrql
              }
            }
          }
        }`;

        return query;
      }

      render() {
        const { countryCode } = this.state;

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    HTML ã‚«ãƒ©ãƒ¼ ã‚³ãƒ¼ãƒ‰ã®å€¤ã¯ã€å¥½ã¿ã«å¿œã˜ã¦è‡ªç”±ã«å¤‰æ›´ã§ãã¾ã™ã€‚ ã“ã®ä¾‹ã§ã¯ã€ `#11A600`ã¯ç·‘ã€ `#FFD966`ã¯é»„è‰²ã€ `#BF0016`ã¯èµ¤ã§ã™ã€‚
  </Step>

  <Step>
    ### ãƒãƒƒãƒ—ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ä¸­å¿ƒç‚¹ã‚’è¨­å®šã™ã‚‹

    ç·¯åº¦ã¨çµŒåº¦ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒãƒ—ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ä¸­å¿ƒç‚¹ã‚’è¨­å®šã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      getMarkerColor(measure, apdexTarget = 1.7) {
        if (measure <= apdexTarget) {
          return '#11A600';
        } else if (measure >= apdexTarget && measure <= apdexTarget * 4) {
          return '#FFD966';
        } else {
          return '#BF0016';
        }
      }

      mapData() {
        const { countryCode } = this.state;
        const query = `{
          actor {
            account(id: 1606862) {
              mapData: nrql(query: "SELECT count(*) AS 'x', average(duration) AS 'y', sum(asnLatitude)/count(*) AS 'lat', sum(asnLongitude)/count(*) AS 'lng' FROM PageView FACET regionCode, countryCode WHERE appName = 'WebPortal' ${
                countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
              } LIMIT 1000 ") {
                results
                nrql
              }
            }
          }
        }`;

        return query;
      }

      render() {
        const { countryCode } = this.state;
        const defaultMapCenter = [10.5731, -7.5898];

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>

  <Step>
    ### ãƒãƒƒãƒ—ã«è¡Œã‚’è¿½åŠ ã™ã‚‹ [#add-row-map]

    ãƒ†ã‚­ã‚¹ãƒˆ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¡Œã¨ãƒ†ãƒ¼ãƒ–ãƒ« ãƒãƒ£ãƒ¼ãƒˆè¡Œã®é–“ã«ã€ `NerdGraphQuery`ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒãƒ— ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”¨ã®æ–°ã—ã„è¡Œã‚’æŒ¿å…¥ã—ã¾ã™ã€‚

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      getMarkerColor(measure, apdexTarget = 1.7) {
        if (measure <= apdexTarget) {
          return '#11A600';
        } else if (measure >= apdexTarget && measure <= apdexTarget * 4) {
          return '#FFD966';
        } else {
          return '#BF0016';
        }
      }

      mapData() {
        const { countryCode } = this.state;
        const query = `{
          actor {
            account(id: 1606862) {
              mapData: nrql(query: "SELECT count(*) AS 'x', average(duration) AS 'y', sum(asnLatitude)/count(*) AS 'lat', sum(asnLongitude)/count(*) AS 'lng' FROM PageView FACET regionCode, countryCode WHERE appName = 'WebPortal' ${
                countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
              } LIMIT 1000 ") {
                results
                nrql
              }
            }
          }
        }`;

        return query;
      }

      render() {
        const { countryCode } = this.state;
        const defaultMapCenter = [10.5731, -7.5898];

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <div className="row">
                <NerdGraphQuery query={this.mapData()}>
                  {({ loading, error, data }) => {
                    if (loading) {
                      return <Spinner fillContainer />;
                    }
                    if (error) {
                      return 'Error';
                    }
                    const { results } = data.actor.account.mapData;
                    console.debug(results);
                    return 'Hello';
                  }}
                </NerdGraphQuery>
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```

    ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒå‹•ä½œã™ã‚‹ã‹ã©ã†ã‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€New Relic ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
  </Step>

  <Step>
    ### ã€ŒHelloã€ã‚’Leafletã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆã¾ã™ [#replace-hello]

    `return "Hello";`ã‚’æ¬¡ã®ã‚‚ã®ã«ç½®ãæ›ãˆã¾ã™:

    ```jsx fileName=pageview-app-nerdlet/index.js
    import React from 'react';
    import {
      TableChart,
      TextField,
      NerdGraphQuery,
      Spinner,
      Button,
      BlockText,
    } from 'nr1';
    import { Map, CircleMarker, TileLayer } from 'react-leaflet';

    const accountId = 0; // Replace with your account ID

    export default class PageViewApp extends React.Component {
      constructor(props) {
        super(props);
        this.state = {
          countryCode: null,
        };
      }

      getMarkerColor(measure, apdexTarget = 1.7) {
        if (measure <= apdexTarget) {
          return '#11A600';
        } else if (measure >= apdexTarget && measure <= apdexTarget * 4) {
          return '#FFD966';
        } else {
          return '#BF0016';
        }
      }

      mapData() {
        const { countryCode } = this.state;
        const query = `{
          actor {
            account(id: 1606862) {
              mapData: nrql(query: "SELECT count(*) AS 'x', average(duration) AS 'y', sum(asnLatitude)/count(*) AS 'lat', sum(asnLongitude)/count(*) AS 'lng' FROM PageView FACET regionCode, countryCode WHERE appName = 'WebPortal' ${
                countryCode ? ` WHERE countryCode LIKE '%${countryCode}%' ` : ''
              } LIMIT 1000 ") {
                results
                nrql
              }
            }
          }
        }`;

        return query;
      }

      render() {
        const { countryCode } = this.state;
        const defaultMapCenter = [10.5731, -7.5898];

        return (
          <div className="container">
            <div className="row">
              <div className="row">
                <TextField
                  placeholder="US"
                  onChange={(event) => {
                    this.setState({ countryCode: event.target.value });
                  }}
                />
              </div>
              <div className="row">
                <NerdGraphQuery query={this.mapData()}>
                  {({ loading, error, data }) => {
                    if (loading) {
                      return <Spinner fillContainer />;
                    }
                    if (error) {
                      return 'Error';
                    }
                    const { results } = data.actor.account.mapData;
                    console.debug(results);

                    return (
                      <Map
                        className="containerMap"
                        center={defaultMapCenter}
                        zoom={2}
                        zoomControl
                      >
                        <TileLayer
                          attribution='&amp;copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
                          url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
                        />
                        {results.map((pt, i) => {
                          const center = [pt.lat, pt.lng];
                          return (
                            <CircleMarker
                              key={`circle-${i}`}
                              center={center}
                              color={this.getMarkerColor(pt.y)}
                              radius={Math.log(pt.x) * 3}
                              onClick={() => {
                                alert(JSON.stringify(pt));
                              }}
                            />
                          );
                        })}
                      </Map>
                    );
                  }}
                </NerdGraphQuery>
              </div>
              <TableChart
                accountId={accountId}
                query={`FROM PageView SELECT count(*), average(duration) WHERE appName = 'WebPortal' ${
                  countryCode ? ` WHERE countryCode LIKR '%${countryCode}%' ` : ''
                } FACET countryCode, regionCode SINCE 1 week ago LIMIT 1000`}
                fullWidth
                className="chart"
              />
            </div>
          </div>
        );
      }
    }
    ```
  </Step>
</Steps>

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ `OpenStreetMap`ãƒ‡ãƒ¼ã‚¿ã¨ãƒãƒ¼ã‚«ãƒ¼ã®è‰²ã‚’ä½¿ç”¨ã—ã¦ã€é¸æŠã—ãŸç·¯åº¦ã¨çµŒåº¦ã‚’ä¸­å¿ƒã¨ã—ãŸä¸–ç•Œåœ°å›³ã‚’ä½œæˆã—ã¾ã™ã€‚

ã‚¢ãƒ—ãƒªã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ã€ãƒãƒƒãƒ—ä¸Šã®ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚