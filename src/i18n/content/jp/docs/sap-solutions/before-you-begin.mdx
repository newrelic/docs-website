---
title: インストールの準備
metaDescription: How to install the SAP and alert ecosystems with New Relic
freshnessValidatedDate: never
translationType: machine
---

SAP ソリューションにNew Relic監視を使用する前に、次の前提条件が満たされていることを確認してください。

* **New Relic アカウント ID** : New Relic アカウントを識別するための[アカウント ID](/docs/accounts/accounts-billing/account-setup/account-id)を取得します。

* **ライセンスキー**: 認証とデータ アクセスに必要なNew Relic <InlinePopover type="licenseKey" />を保護します。

* **データセンター地域**:[希望するデータセンターの場所 (米国または欧州) を決定し](/docs/accounts/accounts-billing/account-setup/choose-your-data-center/)、それに応じてアカウントを構成します。

* **SAP システム要件**: SAP システムが、 New Relic監視によって SAP ソリューション向けに指定された必要なソフトウェア コンポーネント リリース レベルを満たしていることを確認します。 システム タイプ別に使用可能なデータ プロバイダーの詳細については、「[データ プロバイダー リファレンス」を](/docs/sap-solutions/additional-resources/data-providers-reference)参照してください。

* **監視 BTP アカウント**: BTP アカウントが監視セットアップの一部である場合は、次のいずれかが利用可能になります。

  * **CloudALM アカウント**: BTP アカウントを監視するには、CloudALM アカウントを設定する必要があります。
  * **プロセス統合ランタイム サービス**: 監視 BTP アカウントでプロセス統合ランタイム サービスへのサブスクリプションを確保します。これは統合監視に特に必要です。

  <Callout variant="important">
    これらの前提条件を満たすには、セキュリティ チームまたはネットワーク チームからの承認または設定の支援が必要になる場合があります。 インストレーションを開始する前にこれらの手順が完了していることを確認し、 [インストレーション準備のチェックリスト](/docs/sap-solutions/additional-resources/pre-installation-checklist/#checklist-for-installation-readiness)をチェックして、すべての環境が正しく設定されていることを確認してください。
  </Callout>

## ソフトウェアをダウンロード

インストレーション パッケージは、 New Relicアカウント エグゼクティブから入手できます。 ダウンロードした.zipパッケージには次のファイルが含まれています。

<Callout variant="important">
  ファイルの完全なリストは**Packing\_List.txt**に記載されています。これらのファイルにアクセスするには、パッケージを解凍してください。
</Callout>

<CollapserGroup>
  <Collapser id="installation-package" title="インストレーションパッケージ">
    <table>
      <thead>
        <tr>
          <th style={{ width: '200px' }}>
            ファイルタイトル
          </th>

          <th>
            ファイル名
          </th>

          <th>
            備考
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            包装内容明細書
          </td>

          <td>
            `NRM4SAP<version>.txt`
          </td>

          <td>
            ファイルインベントリリスト
          </td>
        </tr>

        <tr>
          <td>
            ABAPアドオン
          </td>

          <td>
            `K-xxxAOIINNEWR.SAR`
          </td>

          <td>
            SAPアドオンのアーカイブファイル
          </td>
        </tr>

        <tr>
          <td>
            ABAP アドオン アップグレード パッケージ
          </td>

          <td>
            `K-xxxAOUINNEWR.SAP`
          </td>

          <td>
            SAPアドオンアップグレードのアーカイブファイル
          </td>
        </tr>

        <tr>
          <td>
            承認ロール
          </td>

          <td>
            `_NEWR_DATA_PROVIDER.SAP`
          </td>

          <td>
            NR RFC ユーザーの承認ロール
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## モニターシステム [#monitored-systems]

当社のエージェントレスアーキテクチャーは、 **RFC 接続**を使用してデータを取得します。 安全な接続を確保するには、これらの接続用の特定の権限プロファイルを持つ SAP システム ユーザーを作成する必要があります。

* `SAP_BASIS`が**リリース 740 以上**、 `Kernel`が**リリース 753 パッチ 602 以上**、 `ST-PI`が**リリース 740 SP 16 以上である**ことを確認します。

* **承認ロール**[`NEWR_DATA_PROVIDER`](/docs/sap-solutions/additional-resources/additional-configuration/#upload-authorization-role)をアップロードします。

* RFC 接続用にアップロードされたロールを持つシステム ユーザーを作成します。[New Relic RFC ユーザー ID の作成](/docs/sap-solutions/additional-resources/additional-configuration/#create-rfc-user-id)を参照してください。

* **HANA データベース**を監視している場合は、次の SQL コマンドを使用して、**カタログ読み取り**および**監視**アクセスを備えた**HANA データベース ユーザー NRAGENT**を作成します。

  ```sql
    CREATE ROLE NR_AGENT_ROLE;
    GRANT CATALOG READ TO NR_AGENT_ROLE;
    GRANT MONITORING TO NR_AGENT_ROLE;
  ```

  ```sql
    CREATE USER NRAGENT PASSWORD 'Xxxxxxxx' NO FORCE_FIRST_PASSWORD_CHANGE;
    GRANT NR_AGENT_ROLE TO NRAGENT;
  ```

* SQL 接続用の**HANA サーバー ホスト**と**テナント DB ポート**を収集します。

* 他のデータベースの場合は、ABAP プログラム`RSDBKPIMON`を実行して、標準**CCMS データベース KPI を**アクティブにします。

## 中央監視システム [#central-monitoring-system]

中央監視システムで、次のコンポーネント バージョンがインストールされていることを確認します。リストされていないバージョンについては、New Relic アカウント担当者に問い合わせて補足パッケージを入手してください。

<CollapserGroup>
  <Collapser id="sap-versions" title="SAPコンポーネントのバージョン">
    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            SAP\_BASISバージョン
          </th>

          <th>
            SAP\_ABA バージョン
          </th>

          <th>
            ST-PIバージョン
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            740
          </td>

          <td>
            該当なし
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            750
          </td>

          <td>
            750
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            750
          </td>

          <td>
            75A
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            751
          </td>

          <td>
            75B
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            752
          </td>

          <td>
            75℃
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            753
          </td>

          <td>
            75D
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            754
          </td>

          <td>
            75E
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            755
          </td>

          <td>
            75F
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            756
          </td>

          <td>
            75G
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            757
          </td>

          <td>
            75時間
          </td>

          <td>
            740 SP14+
          </td>
        </tr>

        <tr>
          <td>
            758
          </td>

          <td>
            75I
          </td>

          <td>
            740 SP14+
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

* ご使用の SAP バージョンがリストにない場合は、New Relic アカウント担当者に連絡して、ご使用のバージョンに合わせた補足パッケージを入手してください。
* 中央システムには、少なくとも 20 のダイアログ ワーク プロセスと 10 のバックグラウンド ワーク プロセスが必要です。
* New Relic データセンターへの送信 HTTPS アクセスが許可されていることを確認します。

<CollapserGroup>
  <Collapser id="us-eu-endpoints" title="米国/EU データセンター エンドポイント">
    <table>
      <thead>
        <tr>
          <th style={{ width: '200px' }}>
            繋がり
          </th>

          <th>
            米国データセンター
          </th>

          <th>
            EUデータセンターのエンドポイント
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            指標
          </td>

          <td>
            [https://metric-api.newrelic.com/metric/v1](https://metric-api.newrelic.com/metric/v1)
          </td>

          <td>
            [https://metric-api.eu.newrelic.com/metric/v1](https://metric-api.eu.newrelic.com/metric/v1)
          </td>
        </tr>

        <tr>
          <td>
            イベント
          </td>

          <td>
            [https://insights-collector.newrelic.com/v1/accounts/events](https://insights-collector.newrelic.com/v1/accounts/events)
          </td>

          <td>
            [https://insights-collector.eu01.nr-data.net/accounts/event/v1](https://insights-collector.eu01.nr-data.net/accounts/event/v1)
          </td>
        </tr>

        <tr>
          <td>
            ログ
          </td>

          <td>
            [https://log-api.newrelic.com/log/v1](https://log-api.newrelic.com/log/v1)
          </td>

          <td>
            [https://log-api.eu.newrelic.com/log/v1](https://log-api.eu.newrelic.com/log/v1)
          </td>
        </tr>

        <tr>
          <td>
            トレース
          </td>

          <td>
            [https://trace-api.newrelic.com/trace/v1](https://trace-api.newrelic.com/trace/v1)
          </td>

          <td>
            [https://trace-api.eu.newrelic.com/trace/v1](https://trace-api.eu.newrelic.com/trace/v1)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

* 必要に応じて、New Relic にアクセスするためのプロキシ サーバー ポリシーを調整します。プロキシ設定が構成されていることを確認します。

  * サーバーのドメイン名/IP アドレスとポート。
  * 認証が必要な場合のプロキシ アクセス資格情報。

* ファイアウォール ポリシーを変更して、ブロックされている場合でも New Relic への HTTPS トラフィックを許可します。

  <Callout variant="tip">
    これらの接続は、**Central Monitoring System** \[中央監視システム]で**SAP Transaction SM59**を使用して設定し、テストすることができます。詳細については、 [「HTTP 宛先を New Relic Cloud に設定する](/docs/sap-solutions/additional-resources/additional-configuration/#set-http-destination-to-new-relic-cloud)」を参照してください。
  </Callout>

* 指定された監視システムごとに、 `SM59`とリモート システム ID を使用して**RFC Destination** \[RFC 宛先]を作成し、接続をテストします。 詳細については、 [「モニター システムの RFC 宛先の作成」](/docs/sap-solutions/additional-resources/additional-configuration/#create-rfc-for-monitored-systems)を参照してください。

  <Callout variant="tip">
    RFC ユーザーに`/NEWR/DATA_PROVIDER`ロールが割り当てられていることを確認します。
  </Callout>

* リモート HANA データベースを監視するには、次の点を確認してください。

  * 中央監視システムは、HANA サーバーとテナント DB ポートにアクセスできる必要があります。

  * 中央監視システムが`S4HANA`システムでない場合は、次のいずれかのコンポーネントがインストールされていることを確認してください。

    * HANA クライアント v2.0 (バージョンは HANA DB と互換性がある必要があります)

    * HANA クライアント ライブラリ ファイル:

      * `libSQLDBCHDB.so` (Linux)
      * `libSQLDBCHDB.dll` （ウィンドウズ）
      * ライブラリは SAP カーネル フォルダーに配置され、SID 管理者 ID (例: sd1adm) によって所有されている必要があります。

  * 各リモート HANA データベースに対して、トランザクション`SAP DBACOCKPIT`を使用して DB 接続を作成します。詳細については、 [「DB 接続の作成」](/docs/sap-solutions/additional-resources/additional-configuration/#create-database-connection)を参照してください。

## モニターBTPアカウント

BTP アカウントを監視するには、BTP アカウントを監視するために設定された CloudALM インスタンス、またはプロセス統合ランタイム サービスへのサブスクリプション (統合監視にのみ適用) のいずれかが必要です。 接続認証にはサービス キーが必要です。詳細については、 [「サービス キーを取得する方法」を](/docs/sap-solutions/additional-resources/obtain-service-key/process-integration-runtime)参照してください。

サービス キーは、 [外部 HTTP 宛先](/docs/sap-solutions/additional-resources/additional-configuration/#create-authentication-endpoint)を作成し、API データ プロバイダーの API ホストとして機能するためにも使用されます。