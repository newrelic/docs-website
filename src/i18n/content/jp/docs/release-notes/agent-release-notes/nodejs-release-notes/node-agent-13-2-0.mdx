---
subject: Node.js agent
releaseDate: '2025-08-20'
version: 13.2.0
downloadLink: 'https://www.npmjs.com/package/newrelic'
security: []
bugs:
  - Fixed logic around detecting OTEL packages
  - Updated `shimmer.setupSubscribers` to properly setup and skip subscribers that are disabled
features:
  - Added ability to register `Supportability/Features/Instrumentation/OnRequire/<pkg>` metrics for subscriber based instrumentation
  - 'Added instrumentation for `@modelcontextprotocol/sdk` client calls `client.callTool`, `client.readResource`, and `client.getPrompt`'
  - Added esm loader hook and commonjs patch to work with orchestrion-js
translationType: machine
---

## メモ

#### 特徴

* 加入者ベースの計装用に`Supportability/Features/Instrumentation/OnRequire/<pkg>`メトリクスを登録する機能を追加しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([87bfa40](https://github.com/newrelic/node-newrelic/commit/87bfa400c216352f12bbbc500e74f8e58285a275) )
* orchestrion-js で動作するように esm ローダー フックと commonjs パッチを追加しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([415aeba](https://github.com/newrelic/node-newrelic/commit/415aeba6db04aa54cc1f44e64c0e6d2235d47108) )
* `@modelcontextprotocol/sdk`クライアント呼び出し`client.callTool` 、 `client.readResource` 、および`client.getPrompt`の計装を追加しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([5d9790b](https://github.com/newrelic/node-newrelic/commit/5d9790b4bd9ab24db4a38618ef96c3b50fbadae7) )

#### バグ修正

* OTEL パッケージの検出に関するロジックを修正しました ( [#3326](https://github.com/newrelic/node-newrelic/pull/3326) ) ([4df30e5](https://github.com/newrelic/node-newrelic/commit/4df30e5c2021e0d933e4a77ccd4409405928fa39) )
* `shimmer.setupSubscribers`を更新して、無効になっている加入者を適切に設定してスキップするようになりました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([cf5b3ec](https://github.com/newrelic/node-newrelic/commit/cf5b3ec39e2cad05c46ec7865f5b8b8377cb4710) )

#### コードリファクタリング

* `config.instrumentation.<pkg-name>.enabled`経由で購読者を無効にする機能を追加しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([55f8fe7](https://github.com/newrelic/node-newrelic/commit/55f8fe7bc7035ab1822986eb51a228e266e3d3eb) )
* 親が内部としてマークされ、同じパッケージである場合に、加入者ベースの計画でセグメントが作成されないようにする機能を追加しました ( [#3322](https://github.com/newrelic/node-newrelic/pull/3322) ) ([91f91c2](https://github.com/newrelic/node-newrelic/commit/91f91c2c85f2715bb1c1db5847704623fd65851e) )
* `opensearch`クラスから`id`問題を削除しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([8be00ce](https://github.com/newrelic/node-newrelic/commit/8be00cef67a2637f7d7a3ab33cccb6824ab34478) )
* 発行されたイベントをサブスクライブするための`opensearch`計装を更新しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([9a27a5d](https://github.com/newrelic/node-newrelic/commit/9a27a5daba8a82c350cf129e3b2548527868ae90) )
* 発行されたイベントをサブスクライブするためにelasticsearch計装を更新しました ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([a3e2348](https://github.com/newrelic/node-newrelic/commit/a3e2348d9af62d12cb570c26f557096968d38daa) )
* 発行されたイベント ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) をサブスクライブするために ioredis 計装を更新しました ([90b97d2](https://github.com/newrelic/node-newrelic/commit/90b97d28a9bbf5c1646ce3ca399bb6772c17c07c) )
* 発行されたイベント ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) をサブスクライブするために pino 計装を更新しました ([28bbe9f](https://github.com/newrelic/node-newrelic/commit/28bbe9fee831d57d4fb77d01ef4cd2f6072bf9d8) )
* サブスクライバーを更新し、セグメントを作成し、属性を割り当て、開始する共通の createSegment を追加しました ( [#3317](https://github.com/newrelic/node-newrelic/pull/3317) ) ([aa3f8d9](https://github.com/newrelic/node-newrelic/commit/aa3f8d936aa9fd7ffdad1f771dc16da8782ad917) )
* undici 計装を更新して、シムへの依存を削除しました。 また、リクエストオブジェクトのシンボルではなくコンテキストに関連するセグメントを保存するように更新しました（ [＃3312](https://github.com/newrelic/node-newrelic/pull/3312) ）（[ec17fa7](https://github.com/newrelic/node-newrelic/commit/ec17fa7ef431bf51c527d2c58cdf216fee641884) ）

#### ドキュメント

* 互換性レポートを更新しました ( [#3313](https://github.com/newrelic/node-newrelic/pull/3313) ) ([749ddc9](https://github.com/newrelic/node-newrelic/commit/749ddc9c050ee81f8969e8f173233dcb78826da1) ) ( [#3304](https://github.com/newrelic/node-newrelic/pull/3304) ) ([cc000a7](https://github.com/newrelic/node-newrelic/commit/cc000a72870b508c929449b57a35d289ce093f42) )

#### 雑用

* シムとの機能の整合性を確保するために、終了セグメントを接触セグメントに変更 ( [#3312](https://github.com/newrelic/node-newrelic/pull/3312) ) ([4d39fc5](https://github.com/newrelic/node-newrelic/commit/4d39fc564a23798d42105398d0b8ea6c0e9280cc) )
* eslint 設定を更新しました ( [#3296](https://github.com/newrelic/node-newrelic/pull/3296) ) ([5c168a6](https://github.com/newrelic/node-newrelic/commit/5c168a657cddece16c0b1124307526ffb3588953) )

#### テスト

* 計装した古いバージョンの opensearch パッケージ バージョンの取得を修正しました ( [#3314](https://github.com/newrelic/node-newrelic/pull/3314) ) ([e45ab27](https://github.com/newrelic/node-newrelic/commit/e45ab275109dd601945776c0de88ba954a8c57e2) )
* ピン留めを解除するためにテストで不要な`prisma.$use`を削除しました ( [#3303](https://github.com/newrelic/node-newrelic/pull/3303) ) ([db20324](https://github.com/newrelic/node-newrelic/commit/db20324535ebf714237dc716c3f6718fd90cfb36) )

#### 継続的なインテグレーション

* メトリクスを送信していない場合でも、ユーザーがベンチ マーク テストを実行できるようにする ( [#3307](https://github.com/newrelic/node-newrelic/pull/3307) ) ([1be1514](https://github.com/newrelic/node-newrelic/commit/1be1514c9d49465a29e6b8fbc09c3bb5ebc1b112) )
* ベンチマークテストを`TEST_LICENSE`使用するように変更 ( [#3325](https://github.com/newrelic/node-newrelic/pull/3325) ) ([1f7f733](https://github.com/newrelic/node-newrelic/commit/1f7f733b2d10a5447662e159038fa32f1c036235) )

### サポートステートメント:

最新のエージェント バージョンが利用可能になったらすぐに更新することをお勧めします。最新バージョンにアップグレードできない場合は、エージェントを 90 日以内のバージョンに更新してください。エージェントを最新の状態に保つ方法の詳細については、こちらをご覧ください。( [https://docs.newrelic.com/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/](https://docs.newrelic.com/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/) )

エージェントのリリースとサポート日については、New Relic Node.js エージェントの EOL ポリシーを参照してください。( [https://docs.newrelic.com/docs/apm/agents/nodejs-agent/getting-started/nodejs-agent-eol-policy/](https://docs.newrelic.com/docs/apm/agents/nodejs-agent/getting-started/nodejs-agent-eol-policy/) )