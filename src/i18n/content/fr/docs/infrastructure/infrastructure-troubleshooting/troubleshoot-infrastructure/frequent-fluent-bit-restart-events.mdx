---
title: Événement Fréquent Fluent Bit Restart
type: troubleshooting
tags:
  - Infrastructure
  - Infrastructure monitoring troubleshooting
  - Troubleshoot infrastructure
  - Fluent Bit
metaDescription: Troubleshooting steps to resolve the infrastructure agent bug causing endless Fluent Bit restart events due to hostname resolution issues.
freshnessValidatedDate: never
translationType: machine
---

## Problème

L&apos;agent New Relic Infrastructure envoie des événements `Fluent Bit Started` et `Fluent Bit Stopped` excessifs sans redémarrage réel Fluent Bit. Cela peut encombrer les logs, affecter la précision monitoring et augmenter l&apos;ingestion de données, ce qui peut entraîner des frais de facturation inattendus.

## Cause

Ceci est dû à un bug dans le composant de résolution du nom d&apos;hôte de l&apos;agent infrastructure. L&apos;agent détecte de manière incorrecte les changements fréquents de nom d&apos;hôte, ce qui déclenche l&apos;envoi par `LogForwarderSupervisor` de ces faux événements de redémarrage Fluent Bit. Vous pourriez voir des milliers de messages de débogage similaires à l&apos;exemple suivant :

```
time="2024-04-20T02:46:47Z" level=debug msg="Notifying observers." change=2 component=HostnameResolver
time="2024-04-20T02:46:47Z" level=debug msg="Observer notified." component=HostnameResolver name=LogForwarderSupervisor
```

## Solution

Pour résoudre ce problème, modifiez le comportement de résolution du nom d’hôte dans la configuration de votre agent d’infrastructure. Ce correctif s&apos;applique aux systèmes Windows et Linux.

Ajoutez la configuration suivante à votre fichier de configuration d’agent d’infrastructure :

**Linux**: `/etc/newrelic-infra.yml` **Windows**: `C:\Program Files\New Relic\newrelic-infra\newrelic-infra.yml`

```yml
dns_hostname_resolution: false
override_hostname: "your-server-hostname"
```

Remplacez `"your-server-hostname"` par le nom d’hôte réel de votre serveur.

Cette configuration :

* Désactive les recherches DNS inversées qui peuvent être à l&apos;origine d&apos;une détection instable du nom d&apos;hôte
* Force l&apos;agent à utiliser un nom d&apos;hôte spécifique, empêchant toute détection de changement de nom d&apos;hôte

### Appliquer la configuration

Après avoir ajouté la configuration :

1. Enregistrez le fichier de configuration.

2. Redémarrez l&apos;agent New Relic Infrastructure :

   **Linux**:

   ```bash
   sudo systemctl restart newrelic-infra
   ```

   **Windows**:

   ```powershell
   Restart-Service newrelic-infra
   ```

## Vérification

Pour confirmer que le problème est résolu :

1. Monitorez les logs de votre agent infrastructure pour détecter l&apos;absence de messages `HostnameResolver` répétés.
2. Vérifiez le dashboard de New Relic pour vous assurer que les événements `Fluent Bit Started` et `Fluent Bit Stopped` n&apos;apparaissent plus en continu.
3. Vérifiez que le transfert de logs continue de fonctionner normalement et que les logs apparaissent comme configurés.

## Ressources supplémentaires

* [documentation de résolution du nom d&apos;hôte de l&apos;agent d&apos;infrastructure](https://github.com/newrelic/infrastructure-agent/blob/master/docs/hostname_resolution.md)
* [Paramètres de configuration de l&apos;agent d&apos;infrastructure](/docs/infrastructure/install-infrastructure-agent/configuration/infrastructure-agent-configuration-settings/)