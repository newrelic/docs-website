---
title: interaction (API SPA)
type: apiDoc
shortDescription: Renvoie un nouvel objet API lié à l'interaction SPA actuelle.
tags:
  - Browser
  - Browser monitoring
  - Browser agent and SPA API
metaDescription: SPA API call for browser monitoring to return a new API object that is bound to the current interaction.
freshnessValidatedDate: never
translationType: machine
---

## Syntaxe

```js
newrelic.interaction([JSON object $options])
```

Renvoie un nouvel objet handle lié à l&apos;interaction SPA actuelle, ou une nouvelle interaction s&apos;il n&apos;en existe pas.

## Exigences

* Agent navigateur Pro+SPA (v963 ou supérieur)

* Le paramètre `$options` nécessite v1.285.0+

* Si vous utilisez npm pour installer l&apos;agent du navigateur, vous devez activer la fonctionnalité `spa` lors de l&apos;instanciation de la classe `BrowserAgent` . Dans l&apos;éventail `features` , ajoutez ce qui suit :

  ```js
  import { Spa } from '@newrelic/browser-agent/features/spa';

  const options = {
    info: { ... },
    loader_config: { ... },
    init: { ... },
    features: [
      Spa
    ]
  }
  ```

  Pour plus d&apos;informations, consultez la [documentation d&apos;installation du navigateur npm](https://www.npmjs.com/package/@newrelic/browser-agent#new-relic-browser-agent).

## Description

L&apos;appel [de monitoring SPA](/docs/browser/single-page-app-monitoring/get-started/introduction-single-page-app-monitoring) `interaction()` renvoie un nouveau handle lié à l&apos;interaction en cours.

* <DNT>**New interaction:**</DNT> Si cette fonction est appelée et qu&apos;aucune interaction n&apos;est ouverte ou en cours, une nouvelle interaction [personnalisée](/docs/browser/single-page-app-monitoring/use-spa-data/spa-data-collection#api-custom-events) est créée.
  * Une interaction personnalisée suivra toujours l&apos;heuristique par défaut et se fermera automatiquement lors de la prochaine navigation complète, *sauf si* `waitForEnd` est spécifié.

* <DNT>**New object:**</DNT> Si cette fonction est appelée alors qu&apos;une interaction est en cours, un nouveau handle référençant l&apos;interaction en cours est créé.

  * Plusieurs poignées peuvent pointer vers la même interaction. Chaque appel `.interaction` crée un nouveau handle.
  * Le handle pointera vers l&apos;interaction ouverte, qu&apos;elle ait commencé à partir d&apos;un événement utilisateur comme un `click` ou à partir d&apos;un appel `.interaction` déclenché par l&apos;API précédent.
  * Cette fonction ne peut pas remplacer son propre effet ou celui d&apos;un événement utilisateur. Autrement dit, il ne peut pas écraser une interaction ouverte existante par une nouvelle interaction pilotée par l&apos;API.

## Paramètres

<table>
  <thead>
    <tr>
      <th width="25%">
        paramètres
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `$options`

        *Objet JSON*
      </td>

      <td>
        Facultatif : spécifie les options qui affectent le comportement de l’interaction.

        * `waitForEnd` - La valeur par défaut est `false`. Pour maintenir l&apos;interaction ouverte de force jusqu&apos;à ce que la méthode `.end` soit appelée sur son handle, définissez-la sur `true`. Une fois qu&apos;une interaction est marquée avec ceci, elle ne peut pas être annulée.
      </td>
    </tr>
  </tbody>
</table>

## Valeurs de retour

Cette méthode renvoie un objet JS natif qui pointe vers un [événement`BrowserInteraction` ](/docs/insights/explore-data/attributes/browser-default-attributes-insights#browserinteraction-attributes)potentiel. Chaque fois que cette méthode est appelée pour le même `BrowserInteraction` alors qu&apos;elle n&apos;est pas encore terminée, un nouvel objet est créé, mais il fait toujours référence à la même interaction.

## Exemples

Les méthodes API SPA doivent être utilisées sur `newrelic.interaction()`. Vous pouvez affecter la valeur renvoyée ou le handle à une autre variable pour une utilisation ultérieure. Par exemple:

```js
let myInteraction = newrelic.interaction();
...
myInteraction.save();
```

Bien que le handle nommé puisse être enregistré et utilisé en dehors d&apos;une interaction, notez que les méthodes SPA n&apos;auront aucun effet une fois l&apos;interaction terminée.

La durée de l’interaction peut également être personnalisée à l’aide de la méthode suivante :

```js
// Say an interaction is already open from a user click.
const userInteraction = newrelic.interaction({ waitForEnd: true }); // grabs the current interaction in-progress & keep it open
// URL changes & DOM is modified. Because of those condition being met, interaction will be saved but is kept open.
fetch('myurl.com/endpoint').then(() => userInteraction.end()) // associate this request to the interaction before completing this BrowserInteraction

const myCustomIxn = newrelic.interaction({ waitForEnd: true }) // create a new api-triggered interaction
// This interaction will be kept open indefinitely until `.end` is called, and no new interaction will start, custom or otherwise. AjaxRequest will continue to buffer under this interaction until it is closed.
```