---
title: record_exception (Python API d'agent)
type: apiDoc
shortDescription: Enregistre les détails d'une exception Python en tant qu'erreur.
tags:
  - Agents
  - Python agent
  - Python agent API
metaDescription: 'Python API: This call records the details of a Python exception as an error.'
freshnessValidatedDate: never
translationType: machine
---

## Syntaxe

```py
newrelic.agent.record_exception(exc=None, value=None, tb=None, params={}, ignore_errors=[], application=None)
```

Cette API est obsolète. Veuillez utiliser [`notice_error()`](/docs/agents/python-agent/python-agent-api/notice_error).

## Description

Enregistre les détails d'une exception Python en tant qu'erreur.

Par défaut, l'agent Python signale uniquement les exceptions non gérées. Utilisez `record_exception` pour enregistrer toute Python exception en tant qu’erreur, qui peut ensuite être trouvée dans l’ New Relic UI. Si aucun paramètre n&amp;apos;est fourni, les détails de l&amp;apos;exception en cours de traitement seront utilisés.

Vous pouvez enregistrer jusqu'à cinq exceptions distinctes par [transaction](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction) et jusqu&amp;apos;à 20 exceptions au total pour toutes les transactions par [cycle de collecte](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle).

Lorsque `record_exception()` est appelé dans le contexte d&amp;apos;une demande Web de monitoring ou d&amp;apos;une tâche en arrière-plan, les détails de l&amp;apos;exception seront signalés par rapport à l&amp;apos; application à laquelle la demande ou la tâche est signalée.

Si appelé en dehors du contexte d'une requête Web de monitoring ou d'une tâche d'arrière-plan, l'appel sera ignoré à moins que l'argument de mot-clé [`application`](/docs/agents/python-agent/python-agent-api/application) ne soit fourni et qu&amp;apos;un objet application correspondant à l&amp;apos; application par rapport à laquelle l&amp;apos;exception doit être enregistrée soit fourni. Un objet d&amp;apos;application approprié peut être obtenu à l&amp;apos;aide de la fonction `newrelic.agent.application()` .

## Paramètres

<Callout variant="tip">
  Dans presque tous les cas, `record_exception` ne nécessitera aucun paramètre.
</Callout>

<table>
  <thead>
    <tr>
      <th width="25%">
        paramètres
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `exc`

        *objet de classe*
      </td>

      <td>
        Facultatif et rarement utilisé. Le type d'exception de l'exception en cours de traitement (un objet de classe). L'une des trois valeurs (`exc`, `value` et `tb`) renvoyées par [`sys.exc_info()`](https://docs.python.org/2/library/sys.html#sys.exc_info). Si vous souhaitez transmettre l&amp;apos;un de ces paramètres, les trois doivent être définis et ne peuvent pas être définis sur `None`. Si vous ne transmettez qu&amp;apos;une seule de ces valeurs, l&amp;apos;appel ne fonctionnera pas.
      </td>
    </tr>

    <tr>
      <td>
        `value`

        *int, chaîne, autre*
      </td>

      <td>
        Facultatif et rarement utilisé. Le paramètre d'exception. L'une des trois valeurs (`exc`, `value` et `tb`) renvoyées par [`sys.exc_info()`](https://docs.python.org/2/library/sys.html#sys.exc_info). Si vous souhaitez transmettre l&amp;apos;un de ces paramètres, les trois doivent être définis et ne peuvent pas être définis sur `None`. Si vous ne transmettez qu&amp;apos;une seule de ces valeurs, l&amp;apos;appel ne fonctionnera pas.
      </td>
    </tr>

    <tr>
      <td>
        `tb`

        *objet*
      </td>

      <td>
        Facultatif et rarement utilisé. Un objet de traceback qui encapsule la stack d’appels au point où l’exception s’est produite à l’origine. L'une des trois valeurs (`exc`, `value` et `tb`) renvoyées par [`sys.exc_info()`](https://docs.python.org/2/library/sys.html#sys.exc_info). Si vous souhaitez transmettre l&amp;apos;un de ces paramètres, les trois doivent être définis et ne peuvent pas être définis sur `None`. Si vous ne transmettez qu&amp;apos;une seule de ces valeurs, l&amp;apos;appel ne fonctionnera pas.
      </td>
    </tr>

    <tr>
      <td>
        `params`

        *dict*
      </td>

      <td>
        Facultatif. attribut personnalisé à ajouter à l'événement d'erreur (en plus de tout attribut personnalisé déjà ajouté à la transaction). Si [le mode haute sécurité](/docs/agents/manage-apm-agents/configuration/high-security-mode) est activé, cela ne fonctionnera pas.
      </td>
    </tr>

    <tr>
      <td>
        `ignore_errors`

        *chaîne*
      </td>

      <td>
        Facultatif. Les erreurs à ignorer peuvent être transmises sous la forme `module:class`. Utile lorsque certains types d&amp;apos;exceptions doivent toujours être ignorés et jamais enregistrés.
      </td>
    </tr>

    <tr>
      <td>
        `application`

        *objet d'application*
      </td>

      <td>
        Facultatif. Si appelé en dehors du contexte d'une requête Web de monitoring ou d'une tâche d'arrière-plan, l'appel sera ignoré à moins que l' [objet`application` ](/docs/agents/python-agent/python-agent-api/application)ne soit fourni.
      </td>
    </tr>
  </tbody>
</table>

## Valeurs de retour

Aucun.

## Exemples

### Exemple simple de signalement d'exceptions [#simple-example]

Dans la grande majorité des cas, vous n'aurez pas besoin de passer de paramètres. Vous devez simplement appeler ce qui suit lorsque vous souhaitez signaler une exception :

```py
newrelic.agent.record_exception()
```

### Appel avec l'uplet sys.exc\_info() et un paramètre supplémentaire [#complex-example]

Un exemple de `record_exception` utilisant les données `sys.exc_info()` :

```py
def complex_ignore_errors(exc, val, tb):
   # do some logic here
   return False

newrelic.agent.record_exception(params={'my_special_exception': True}, ignore_errors=complex_ignore_errors)
```

### Exemple d'utilisation du rappel [#callback-example]

Si vous devez filtrer les exceptions de manière dynamique en fonction de l'attribut d'un type d'exception spécifique, vous pouvez fournir une fonction de rappel :

```py
def _ignore_errors(exc, value, tb): 
    if instance(value, HTTPError): 
        if value.status == 404: 
            return True

newrelic.agent.record_exception(ignore_errors=_ignore_errors)
```

Si l'exception doit être ignorée, définissez la valeur de retour de l'appelable sur `True`. Renvoie `False` si l&amp;apos;exception ne doit jamais être ignorée, quelles que soient les autres vérifications, et `None` si les vérifications ultérieures et les règles intégrées doivent déterminer si l&amp;apos;exception doit être ignorée. Un rappel renverrait normalement soit `True` soit `None`.