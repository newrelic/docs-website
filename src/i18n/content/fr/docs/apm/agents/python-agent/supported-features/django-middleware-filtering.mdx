---
title: Filtrage de l'instrumentation du middleware Django
tags:
  - Agents
  - Python agent
  - Supported features
metaDescription: Python agent (Django) middleware instrumentation filtering
freshnessValidatedDate: never
translationType: machine
---

L&apos;agent Python peut désormais filtrer quel middleware Django doit être monitoré. Par défaut, tous les middlewares seront instrumentés.

<Callout variant="important">
  Middleware Instrumentation Filtering pour Django est disponible pour l&apos;agent Python version 10.17.0 et supérieure. Par défaut, tous les middlewares seront instrumentés. Pour modifier cette configuration, consultez notre [documentation](/docs/apm/agents/python-agent/configuration/python-agent-configuration/#middleware-filters).
</Callout>

## Désactiver tous les middlewares Django [#django-middleware-disable]

La désactivation de l&apos;instrumentation du middleware dans Django peut être effectuée de deux manières :

1. Définissez la variable d&apos;environnement `NEW_RELIC_INSTRUMENTATION_DJANGO_MIDDLEWARE_ENABLED` sur `False`
2. Définissez `instrumentation.middleware.django.enabled = false` dans le fichier de configuration.

## Paramètres de configuration du middleware Django [#django-middleware-configuration-settings]

<CollapserGroup>
  <Collapser id="config-middleware-django-include" title="instrumentation.middleware.django.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type :
          </th>

          <td>
            Liste de chaînes séparées par des espaces
          </td>
        </tr>

        <tr>
          <th>
            Défaut:
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Si les attributs sont activés, toutes les clés d&apos;attribut de cette liste seront envoyées.
  </Collapser>

  <Collapser id="config-middleware-django-exclude" title="instrumentation.middleware.django.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type :
          </th>

          <td>
            Liste de chaînes séparées par des espaces
          </td>
        </tr>

        <tr>
          <th>
            Défaut:
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Toutes les clés d’attribut de cette liste ne seront **pas** envoyées.
  </Collapser>
</CollapserGroup>

## Règles d&apos;exclusion/d&apos;inclusion du middleware [#django-middleware-rules]

L&apos;agent suit ces règles pour déterminer quel middleware inclure ou exclure pour monitoring:

<CollapserGroup>
  <Collapser id="rule-destination-precedence" title="Activé a priorité sur inclure et exclure.">
    Les indicateurs `instrumentation.middleware.FRAMEWORK.enabled` ont priorité sur les intergiciels d&apos;inclusion et d&apos;exclusion.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = false
    instrumentation.middleware.django.include = one two
    instrumentation.middleware.django.include = three four
    ```

    Exemple de sortie :

    ```
    Middleware used in app: one, two, three, four
    Middleware included for monitoring:
    Middleware excluded for monitoring: one, two, three, four
    ```
  </Collapser>

  <Collapser id="rule-included-destination" title="Le middleware est inclus si la destination est activée.">
    Si une destination est activée, tous les intergiciels sont envoyés vers cette destination par défaut.

    Toutes monitoring middleware sont par défaut définies sur `true`.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = baz
    ```

    Exemple de sortie :

    ```
    Middleware used in app: foo, bar, baz
    Middleware included for monitoring: foo, bar
    Middleware excluded for monitoring: baz
    ```
  </Collapser>

  <Collapser id="rule-exclude-wins" title="Exclure remplace toujours inclure.">
    Si le même middleware est répertorié dans les listes d&apos;inclusion et d&apos;exclusion, alors le middleware portant le nom spécifié sera exclu.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = foo bar
    instrumentation.middleware.django.exclude = nerd bar
    ```

    Exemple de sortie :

    ```
    Middleware used in app: foo, bar, nerd
    Middleware included for monitoring: foo
    Middleware excluded for monitoring: nerd, bar
    ```
  </Collapser>

  <Collapser id="rule-middleware-name-case-sensitive" title="Les noms des intergiciels sont sensibles à la casse.">
    Les noms des intergiciels sont sensibles à la casse.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = username UsErNaMe
    ```

    Exemple de sortie :

    ```
    Middleware used in app: username, Username, USERNAME, UsErNaMe, userNAME
    Middleware included for monitoring:  Username, USERNAME, userNAME
    Middleware excluded for monitoring:  username, UsErNaMe
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>Utilisez <InlineCode>
      \*
    </InlineCode> pour les caractères génériques.</>
    }
  >
    Vous pouvez utiliser un astérisque `*` à la fin d&apos;un nom comme caractère générique. Cela correspondra à un ensemble de middleware avec le même préfixe.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = custom*
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Exemple de sortie :

    ```
    Middleware used in app: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: custom, custom.key1, custom.key2
    Middleware excluded for monitoring: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser id="rule-specific-wins" title="Le nom du middleware le plus spécifique est prioritaire.">
    Si plusieurs noms d&apos;inclusion ou d&apos;exclusion affectent le même middleware, le nom le plus spécifique aura la priorité.

    Exemple de configuration :

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = request.parameters.foo
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Exemple de sortie :

    ```
    Middleware used in app: request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: request.parameters.foo
    Middleware included for monitoring: request.parameters., request.parameters.bar
    ```
  </Collapser>
</CollapserGroup>