---
title: Configuration de l'agent .NET
tags:
  - Agents
  - NET agent
  - Configuration
metaDescription: 'How to configure the New Relic .NET agent using newrelic.config, including startup and instrumentation options, and disabling unwanted features.'
freshnessValidatedDate: never
translationType: machine
---

Vous pourrez configurer notre agent .NET en fonction de votre environnement après avoir [créé un compte New Relic](https://newrelic.com/signup) (c&apos;est gratuit, pour toujours) et [installé l&apos;agent .NET](/install/dotnet).

## Présentation de la configuration [#config-overview]

Les options de configuration de l&apos;agent APM vous permettent de contrôler certains aspects du comportement de l&apos;agent. Certaines de ces options de configuration font partie du processus d&apos;installation de base (comme la définition de votre clé de licence et du nom de votre application), mais la plupart sont des paramètres plus avancés, tels que la définition d&apos;un niveau de log, la configuration de l&apos;accès à l&apos;hôte proxy, l&apos;exclusion de certains attributs et l&apos;activation du tracing distribué.

L&apos;agent .NET obtient sa configuration à partir du fichier `newrelic.config`, qui est généré dans le cadre du [processus d&apos;installation](/docs/agents/net-agent/installation/install/dotnet). Par défaut, seul un fichier global `newrelic.config` est créé, mais vous pouvez également créer des fichiers locaux `newrelic.config` pour un contrôle plus précis sur un système multi-applications. D&apos;autres façons de définir les options de configuration incluent : l&apos;utilisation de variables d&apos;environnement ou la définition configuration côté serveur à partir de l&apos;UI. Pour en savoir plus sur les différentes options de configuration et sur ce qui remplace quoi, voir [Priorité des paramètres de configuration](/docs/agents/net-agent/configuration/net-agent-configuration#config-options-precedence).

La prise en charge de .NET Framework et de .NET Core utilise les mêmes options configuration et dispose de la même fonctionnalité APM, sauf indication contraire.

Si vous apportez des modifications au fichier de configuration et souhaitez valider qu&apos;il est au bon format, vous pouvez le vérifier par rapport au fichier XSD (par exemple, à `C:\ProgramData\New Relic\.NET Agent\newrelic.xsd` pour Windows) avec n&apos;importe quel validateur XSD.

<Callout variant="important">
  <DNT>**For IIS**</DNT>: après avoir modifié votre fichier `newrelic.config` ou `app.config`, exécutez une commande `IISRESET` à partir d&apos;une invite de commande administrative. les réglages du niveau de log ne nécessitent pas de réinitialisation.
</Callout>

## Méthodes de configuration et niveaux de priorité [#config-options-precedence]

Lors de installation, le agent configuration fichier de .NET ()`newrelic.config` s&apos;applique à toutes les applications de monitoring, mais vous pouvez configurer l&apos;agent d&apos;autres manières. Voici un diagramme montrant comment différentes options de configuration ont priorité les unes sur les autres :

<img title="net-config-precedence-core.png" alt="New Relic .NET agent configuration settings precedence" src="/images/apm_diagram_net-agent-configuration-hierarchy.webp" />

<figcaption>
  Ce diagramme explique l’ordre de priorité des différentes manières de configurer l’agent .NET.
</figcaption>

Voici des détails sur les méthodes de configuration présentées dans le diagramme et leurs niveaux de priorité :

<table>
  <thead>
    <tr>
      <th style={{ width: "230px" }}>
        <DNT>
          **.NET configuration**
        </DNT>
      </th>

      <th>
        <DNT>
          **Details and precedence**
        </DNT>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `web.config` ou `app.config` ou `appsettings.json`
      </td>

      <td>
        Les paramètres de configuration définis dans ces fichiers ont la plus haute priorité.

        Si l&apos;agent est désactivé au niveau local ou global `newrelic.config`:

        * Les paramètres `NewRelic.AgentEnabled` dans `appsettings.json` <DNT>**will enable the agent**</DNT>.
        * Les paramètres `NewRelic.AgentEnabled` dans un fichier `web.config` ou `app.config` <DNT>**will be ignored**</DNT>.
      </td>
    </tr>

    <tr>
      <td>
        Variables d&apos;environnement
      </td>

      <td>
        Deuxième priorité la plus élevée. Pour en savoir plus, consultez [Variables d’environnement .NET](#environment-variables).
      </td>
    </tr>

    <tr>
      <td>
        Configuration côté serveur
      </td>

      <td>
        Troisième priorité la plus élevée. Un nombre limité de paramètres [de configuration côté serveur](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration) sont disponibles ; les autres paramètres proviendront d&apos;autres sources de configuration.
      </td>
    </tr>

    <tr id="local">
      <td>
        Application locale `newrelic.config`
      </td>

      <td>
        Quatrième priorité la plus élevée. Vous pouvez créer des fichiers `newrelic.config` locaux pour configurer des applications individuelles sur un système multi-applications. Ces fichiers de configuration locaux remplacent les paramètres du fichier global `newrelic.config` .

        L&apos;agent recherche les fichiers de configuration locaux de l&apos;application dans les répertoires suivants, dans cet ordre :

        * Un répertoire spécifié dans votre fichier `web.config` ou `app.config` avec la propriété `NewRelic.ConfigFile`

        * Le répertoire racine de l&apos;application Web (avec le `app.config` ou `web.config`)

        * Le répertoire contenant le fichier exécutable de votre application

          Notez que le fichier de configuration local de l&apos;application doit être complet et validé par rapport au fichier XSD (par exemple, à `C:\ProgramData\New Relic\.NET Agent\newrelic.xsd` pour Windows).
      </td>
    </tr>

    <tr>
      <td>
        Par défaut (global) `newrelic.config`
      </td>

      <td>
        Source par défaut et priorité la plus basse. Configurera toutes les applications sur un hôte en l&apos;absence d&apos;autres fichiers de configuration. Le fichier de configuration global se trouve dans le répertoire de base de l&apos;agent New Relic : `%PROGRAMDATA%\New Relic\.NET Agent`
      </td>
    </tr>
  </tbody>
</table>

## Variables d&apos;environnement requises [#environment-variables]

Notre agent .NET s&apos;appuie sur des variables d&apos;environnement pour indiquer au .NET Common Language Runtime (CLR) d&apos;attacher New Relic à vos processus. Certaines [procédures d&apos;installation agent .NET](/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction) (comme le programme d&apos;installation MSI) définiront automatiquement ces variables pour vous ; certaines procédures nécessiteront que vous les définissiez manuellement.

<Callout variant="caution">
  Recommandation de sécurité : vous devez déterminer quel utilisateur peut définir les variables d&apos;environnement du système. Vous devez également sécuriser les comptes sous lesquels votre application s&apos;exécute pour éviter que les variables d&apos;environnement utilisateur ne remplacent les variables d&apos;environnement système.
</Callout>

<CollapserGroup>
  <Collapser id="net-framework-env-variables" title="Variables d'environnement du framework .NET">
    Pour .NET Framework, les variables suivantes sont requises :

    ```ini
    COR_ENABLE_PROFILING=1
    COR_PROFILER={71DA0A04-7777-4EC6-9643-7D28B46A8A41}
    NEWRELIC_INSTALL_PATH="INSERT_THE_PATH_TO_THE_AGENT_DIRECTORY"
    ```

    Le Windows agent programme d&apos;installation .NET (.msi) les ajoutera à IIS par défaut, ou en tant que variables d&apos;environnement à l&apos;échelle du système lors de l&apos;activation `Instrument All` de.

    Lorsque vous utilisez le programme d’installation de l’agent Windows .NET, assurez-vous que `NEWRELIC_INSTALL_PATH` est défini sur `C:\Program Files\New Relic\.NET Agent\`. C&apos;est ici que les DLL de l&apos;agent sont placées sur le système.

    Pour plus de détails sur ces variables, ainsi que sur les valeurs correctes pour d&apos;autres scénarios d&apos;installation, veuillez consulter [Comprendre les variables d&apos;environnement de l&apos;agent .NET](/docs/apm/agents/net-agent/other-installation/understanding-net-agent-environment-variables/).

    Lors de l&apos;installation de l&apos;agent via le package Nuget, l&apos;agent nécessite [un ensemble différent de variables d&apos;environnement](/docs/apm/agents/net-agent/install-guides/install-net-agent-using-nuget/#nuget-framework).
  </Collapser>

  <Collapser id="net-core-env-variables" title="Variables d'environnement .NET Core">
    Pour .NET Core, les variables suivantes sont requises :

    <DNT>
      **Linux:**
    </DNT>

    ```ini
    CORECLR_ENABLE_PROFILING=1
    CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A}
    CORECLR_NEWRELIC_HOME=path/to/agent/directory
    CORECLR_PROFILER_PATH="${CORECLR_NEWRELIC_HOME}/libNewRelicProfiler.so"
    ```

    <DNT>
      **Windows (MSI Installer):**
    </DNT>

    ```ini
    CORECLR_ENABLE_PROFILING=1
    CORECLR_PROFILER={36032161-FFC0-4B61-B559-F6C5D41BAE5A}
    NEWRELIC_INSTALL_PATH=C:\Program Files\New Relic\.NET Agent\
    CORECLR_NEWRELIC_HOME=C:\ProgramData\New Relic\.NET Agent\
    ```

    Le Windows agent programme d&apos;installation .NET les ajoutera à IIS par défaut ou en tant que variables d&apos;environnement à l&apos;échelle du système lors de l&apos;activation `Instrument All` de. Exception : `CORECLR_ENABLE_PROFILING` doit être défini manuellement pour instrumenter une application .NET Core non hébergée par IIS. Voir [Compatibilité et exigences pour .NET Framework](/docs/apm/agents/net-agent/configuration/net-agent-configuration/) pour l&apos;application .NET Framework.

    Pour plus de détails sur ces variables, ainsi que sur les valeurs correctes pour d&apos;autres scénarios d&apos;installation, veuillez consulter [Comprendre les variables d&apos;environnement de l&apos;agent .NET](/docs/apm/agents/net-agent/other-installation/understanding-net-agent-environment-variables/).

    Lors de l&apos;installation de l&apos;agent via le package Nuget sous Windows, l&apos;agent nécessite un [ensemble différent de variables d&apos;environnement](/docs/apm/agents/net-agent/install-guides/install-net-agent-using-nuget/#nuget-windows).
  </Collapser>
</CollapserGroup>

Si votre système a déjà utilisé monitoring des services (non-New Relic), vous pouvez avoir un « conflit de profileur » lorsque vous essayez d&apos;installer et d&apos;utiliser l&apos;agent de New Relic. Plus de détails :

<CollapserGroup>
  <Collapser id="profiler-conflicts" title="Explication du conflit du profileur">
    L&apos;agent .NET de New Relic s&apos;appuie sur des variables d&apos;environnement pour indiquer au .NET Common Language Runtime (CLR) de charger New Relic dans vos processus. Les variables d’environnement liées à l’installation sont des variables Microsoft et non des variables New Relic. Ils peuvent être utilisés par d’autres profileurs .NET, et un seul profileur peut être attaché à un processus à la fois. Pour cette raison, si vous avez utilisé des produits monitoring d&apos;applicationantérieurs, vous pouvez avoir [des conflits de profileur](/docs/agents/net-agent/troubleshooting/profiler-conflicts).
  </Collapser>
</CollapserGroup>

Pour obtenir des instructions d’installation spécifiques, consultez la [documentation d’installation de l’agent .NET](/docs/agents/net-agent/installation/new-relic-net-agent-install-introduction).

## Variables d&apos;environnement facultatives [#optional-environment-variables]

Certaines options de configuration de l&apos;agent .NET de New Relic peuvent être définies via des variables d&apos;environnement au lieu de les définir dans un fichier de configuration. Vous trouverez ci-dessous une liste des variables d’environnement reconnues par l’agent .NET avec des exemples de valeurs.

```ini
NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY
NEW_RELIC_APP_NAME=Descriptive Name
MAX_TRANSACTION_SAMPLES_STORED=500
MAX_EVENT_SAMPLES_STORED=500
NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
NEW_RELIC_SPAN_EVENTS_ENABLED=false
NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED=2000
NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST=myhost.infinitetracing.com
NEW_RELIC_LABELS="foo:bar;zip:zap"
NEW_RELIC_PROCESS_HOST_DISPLAY_NAME=Custom Name
NEW_RELIC_HOST=gov-collector.newrelic.com
NEW_RELIC_PROXY_HOST=hostname
NEW_RELIC_PROXY_URI_PATH=path/to/something.aspx
NEW_RELIC_PROXY_PORT=5000
NEW_RELIC_PROXY_USER=YOUR_USER_NAME
NEW_RELIC_PROXY_PASS=YOUR_PROXY_PASSWORD
NEW_RELIC_PROXY_DOMAIN=mydomain.com
NEW_RELIC_PROXY_PASS_OBFUSCATED=YOUR_OBFUSCATED_PROXY_PASSWORD
NEW_RELIC_CONFIG_OBSCURING_KEY=YOUR_OBSCURING_KEY
NEW_RELIC_SEND_DATA_ON_EXIT=true
NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS=2000
NEW_RELIC_HIGH_SECURITY=true
NEW_RELIC_DISABLE_SAMPLERS=true
NEW_RELIC_LOG=MyApp.log
NEW_RELIC_LOG_ENABLED=true
NEWRELIC_LOG_LEVEL=info
NEW_RELIC_LOG_CONSOLE=true
NEWRELIC_PROFILER_LOG_DIRECTORY=path\to\a\directory # not configurable via config file
NEWRELIC_LOG_DIRECTORY=path\to\a\directory # Insert a directory where you want to put the agent and profiler logs. You can't set this directory for both agent and profiler logs in the configuration file.
NEW_RELIC_LOG_ROLLING_STRATEGY=day
NEW_RELIC_LOG_MAX_FILE_SIZE_MB=100
NEW_RELIC_LOG_MAX_FILES=2
NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES=401, 403.18
NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES=401, 501-503
NEW_RELIC_APPLICATION_LOGGING_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_INCLUDE="myCustomAttribute1, myOtherCustomAttribute*"
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_EXCLUDE="myCustomAttribute2, myOtherCustomAttributeMoreSpecificName"
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED=10000
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LOG_LEVEL_DENYLIST="debug, warn"
NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED=true
NEW_RELIC_ALLOW_ALL_HEADERS=true
NEW_RELIC_ATTRIBUTES_ENABLED=true
NEW_RELIC_ATTRIBUTES_INCLUDE=request.headers.*,foo.bar
NEW_RELIC_ATTRIBUTES_EXCLUDE=request.headers.cookie,request.headers.authorization
NEW_RELIC_UTILIZATION_DETECT_AWS=true
NEW_RELIC_UTILIZATION_DETECT_AZURE=true
NEW_RELIC_UTILIZATION_DETECT_GCP=true
NEW_RELIC_UTILIZATION_DETECT_PCF=true
NEW_RELIC_UTILIZATION_DETECT_DOCKER=true
NEW_RELIC_UTILIZATION_DETECT_KUBERNETES=true
NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD=true
NEW_RELIC_CODE_LEVEL_METRICS_ENABLED=true
NEW_RELIC_AI_MONITORING_ENABLED=true
NEW_RELIC_AI_MONITORING_RECORD_CONTENT_ENABLED=true
NEW_RELIC_CLOUD_AWS_ACCOUNT_ID=123456789012
```

<CollapserGroup>
  <Collapser id="net-framework-32on64-env-variables" title="Prise en charge des applications 32 bits sur un système 64 bits.">
    Le programme d&apos;installation MSI 64 bits pour l&apos;agent .NET de New Relic installe automatiquement l&apos;assembly du profileur 32 bits avec l&apos;assembly 64 bits et, à partir de la version 10.16.0, active automatiquement la prise en charge 32 bits pour IIS.Pour les applications non hébergées par IIS, vous pouvez définir manuellement la variable d&apos;environnement requise.

    ```ini
    COR_PROFILER_PATH_32="C:\Program Files (x86)\New Relic\.NET Agent\NewRelic.Profiler.dll"
    ```
  </Collapser>
</CollapserGroup>

Si vous utilisez New Relic CodeStream pour monitorer les performances de votre IDE, vous souhaiterez peut-être également [associer un référentiel à vos services](/docs/codestream/observability/repo-association) et [associer des SHA de build ou une balise de sortie à des erreurs](/docs/codestream/observability/error-investigation/#buildsha).

## Erreurs configuration de la boîte de réception [#errors-inbox-configuration]

La définition de l’une des balises suivantes vous aidera à identifier les versions de votre logiciel qui génèrent les erreurs.

* `NEW_RELIC_METADATA_SERVICE_VERSION` créera tag.service.version sur les données d&apos;événement contenant la version de votre code qui est déployée, dans de nombreux cas une version sémantique telle que 1.2.3, mais pas toujours.
* `NEW_RELIC_METADATA_RELEASE_TAG `créera tag.releaseTag sur les données d&apos;événement contenant la tag de sortie (comme v0.1.209 ou sortie-209).
* `NEW_RELIC_METADATA_COMMIT` créera tag.commit sur les données d&apos;événement contenant le commit sha. Le SHA entier peut être utilisé ou seulement les sept premiers caractères (par exemple, 734713b).

Une prochaine version de la boîte de réception des erreurs suivra automatiquement les versions de votre logiciel qui génèrent des erreurs. Toutes les données de version seront également affichées dans [CodeStream](/docs/codestream/how-use-codestream/performance-monitoring/#buildsha).

## Options de configuration, newrelic.config [#setup]

Utilisez ces options pour installer et configurer votre agent via le fichier `newrelic.config` . L&apos;agent .NET prend en charge les catégories d&apos;options de configuration suivantes :

* [Élément de configuration](#configuration)
* [Élément de service](#service)
* [Élément clé obscurcissant](#obscuring-key)
* [Élément proxy](#proxy)
* [Élément de log](#log)
* [Élément d&apos;application (configuration)](#application-configuration)
* [Élément de transmission de données](#data-transmission)
* [Nom de l&apos;hôte](#host-name)

### Élément de configuration [#configuration]

L&apos;élément racine du document de configuration est un élément `configuration` .

```xml
<configuration xmlns="urn:newrelic-config"
  agentEnabled="true"
  maxStackTraceLines="50">
```

L&apos;élément `configuration` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="config-agentEnabled" title="agentEnabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver l&apos;agent New Relic.
  </Collapser>

  <Collapser id="config-maxStackTraceLines" title="maxStackTraceLines">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `80`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximal de trames stack à trace dans n&apos;importe quel vidage stack .
  </Collapser>
</CollapserGroup>

### Élément de service [#service]

Le premier enfant de l&apos;élément `configuration` est un élément `service` . L&apos;élément de service configure la connexion de l&apos;agent au service New Relic.

```xml
<service licenseKey="YOUR_LICENSE_KEY"
  sendEnvironmentInfo="true"
  syncStartup="false"
  sendDataOnExit="false"
  sendDataOnExitThreshold="60000"
  autoStart="true"/>
```

L&apos;élément `service` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser
    id="service-licenseKey"
    title={<>Clé de licence <strong>(obligatoire)</strong></>
    }
  >
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Votre [clé de licence](/docs/apis/intro-apis/new-relic-api-keys/#ingest-license-key) New Relic. New Relic utilise la clé de licence pour faire correspondre les données de votre application au compte approprié dans l&apos;UI. Définissez la clé de licence via la variable d&apos;environnement.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_LICENSE_KEY` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_LICENSE_KEY=YOUR_LICENSE_KEY
    ```
  </Collapser>

  <Collapser id="service-sendEnvironmentInfo" title="sendEnvironmentInfo">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Demande à l&apos;agent d&apos;enregistrer les informations de l&apos;environnement d&apos;exécution. Les informations sur l’environnement incluent le système d’exploitation, la version de l’agent et les assemblys disponibles.
  </Collapser>

  <Collapser id="service-syncStartup" title="syncStartup">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Bloquer le démarrage de l&apos;application jusqu&apos;à ce que l&apos;agent se connecte à New Relic. Si la valeur est `true`, la première transaction peut prendre beaucoup plus de temps à se terminer, car elle est bloquée jusqu&apos;à ce que la connexion à New Relic soit terminée.
  </Collapser>

  <Collapser id="service-sendDataOnExit" title="sendDataOnExit">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Bloquer l&apos;arrêt application pendant que l&apos;agent lance un cycle final de collecte et envoie toutes les données à New Relic.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_SEND_DATA_ON_EXIT` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_SEND_DATA_ON_EXIT=true
    ```
  </Collapser>

  <Collapser id="service-sendDataOnExitThreshold" title="sendDataOnExitThreshold">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `60000`
          </td>
        </tr>

        <tr>
          <th>
            Unité
          </th>

          <td>
            Millisecondes
          </td>
        </tr>
      </tbody>
    </table>

    La durée minimale pendant laquelle le processus doit s&apos;exécuter avant que l&apos;agent ne l&apos;empêche de s&apos;arrêter. Ce paramètre s&apos;applique uniquement lorsque [`sendDataOnExit`](#service-sendDataOnExit) est `true`.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_SEND_DATA_ON_EXIT_THRESHOLD_MS=2000
    ```
  </Collapser>

  <Collapser id="service-completeTransactionsOnThread" title="completeTransactionsOnThread">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Si `false`, l&apos;agent utilise un thread de pool pour terminer le traitement de la transaction.

    Si cette valeur est vraie, l&apos;agent terminera le traitement de la transaction sur le thread de demande.
  </Collapser>

  <Collapser id="service-forceNewTransactionOnNewThread" title="forceNewTransactionOnNewThread">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Si `false`, l&apos;agent tente de réutiliser les transactions existantes lorsque des méthodes instrumentées personnalisées sont rencontrées dans des scénarios asynchrones/threadés.

    Si `true`, l&apos;agent tente de créer de nouvelles transactions lorsque des méthodes instrumentées personnalisées sont rencontrées dans des scénarios asynchrones/threadés.

    Alternativement, la variable d’environnement `NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD` peut être utilisée pour contrôler ce comportement.

    ```ini
    NEW_RELIC_FORCE_NEW_TRANSACTION_ON_NEW_THREAD=true
    ```
  </Collapser>

  <Collapser id="service-requestTimeout" title="requestTimeout">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `2000` (avec [`sendDataOnExit`](#service-sendDataOnExit) activé)

            `120000` (avec [`sendDataOnExit`](#service-sendDataOnExit) désactivé)
          </td>
        </tr>

        <tr>
          <th>
            Unité
          </th>

          <td>
            Millisecondes
          </td>
        </tr>
      </tbody>
    </table>

    Le délai de demande de l&apos;agent expire lors de la communication avec New Relic.
  </Collapser>

  <Collapser id="service-autoStart" title="autoStart">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Démarrez automatiquement l&apos;agent .NET lorsque la première méthode instrumentée est touchée.
  </Collapser>

  <Collapser id="service-host" title="host">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Fournit la possibilité de configurer un [point de terminaison compatible FedRAMP](/docs/security/security-privacy/compliance/fedramp-compliant-endpoints/) pour l&apos;agent à utiliser, avec la valeur `gov-collector.newrelic.com`.

    ```xml
    <service licenseKey="YOUR_LICENSE_KEY"
      host="gov-collector.newrelic.com" />
    ```

    Vous pouvez également utiliser la variable d’environnement `NEW_RELIC_HOST`.

    ```ini
    NEW_RELIC_HOST=gov-collector.newrelic.com
    ```
  </Collapser>
</CollapserGroup>

### Élément clé obscurcissant [#obscuring-key]

L&apos;élément `obscuringKey` est un enfant facultatif de l&apos;élément `service` . L&apos;agent .NET utilise cette valeur pour désobscurcir les valeurs de configuration prises en charge. Par exemple, lorsqu&apos;un [mot de passe proxy obscurci](#proxy-password) est fourni, il sera désobscurci à l&apos;aide de cette clé.

```xml
<service licenseKey="YOUR_LICENSE_KEY">
  <obscuringKey>OBSCURING_KEY</obscuringKey>
</service>
```

La clé d&apos;obscurcissement peut également être configurée en définissant la variable d&apos;environnement `NEW_RELIC_CONFIG_OBSCURING_KEY` .

<Callout variant="caution">
  Recommandation de sécurité : le placement de la clé obscurcissante dans le même fichier de configuration qu&apos;une valeur obscurcie peut présenter un risque de sécurité. Envisagez de placer la clé d’obscurcissement et [le mot de passe proxy obscurci](#proxy-password) dans les variables d’environnement et de limiter l’accès aux variables d’environnement dans votre environnement.
</Callout>

### Élément proxy [#proxy]

L&apos;élément `proxy` est un enfant facultatif de l&apos;élément `service` . L&apos;élément `proxy` est utilisé lorsque l&apos;agent communique avec le service backend New Relic via un proxy.

```xml
<service licenseKey="YOUR_LICENSE_KEY">
  <proxy
    host="hostname"
    port="PROXY_PORT"
    uriPath="path/to/something.aspx"
    domain="mydomain.com"
    user="PROXY_USERNAME"
    password="PROXY_PASSWORD"
    passwordObfuscated="OBFUSCATED_PROXY_PASSWORD"/>
</service>
```

L&apos;élément `proxy` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="proxy-host" title="host">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définit l&apos;hôte proxy.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_HOST` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-port" title="port">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `8080`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le port proxy.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_PORT` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-uripath" title="uriPath">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définissez éventuellement un chemin d&apos;URI proxy.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_URI_PATH` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-domain" title="domain">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définissez éventuellement un domaine à utiliser lors de l’authentification auprès du serveur proxy.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_DOMAIN` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-user" title="user">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définissez éventuellement un nom d&apos;utilisateur pour l&apos;authentification.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_USER` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-password" title="password">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définissez éventuellement un mot de passe pour l&apos;authentification.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_PASS` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="proxy-password" title="passwordObfuscated">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Pour plus de sécurité, l&apos;agent .NET prend en charge l&apos;utilisation d&apos;un mot de passe proxy obscurci avec l&apos;attribut `passwordObfuscated`. Le mot de passe proxy obscurci est généré à l’aide de la commande [CLI New Relic](https://github.com/newrelic/newrelic-cli) suivante :

    ```bash
    newrelic agent config obfuscate --key OBSCURING_KEY --value "PLAIN_TEXT_PROXY_PASSWORD"
    ```

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_PROXY_PASS_OBFUSCATED` dans l’environnement de l’application.

    <Callout variant="important">
      Lorsque vous utilisez un mot de passe proxy obscurci, la [clé d&apos;obscurcissement](#obscuring-key) doit également être configurée.
    </Callout>
  </Collapser>
</CollapserGroup>

### Élément de log [#log]

L&apos;élément `log` est un enfant de l&apos;élément `configuration` . L&apos;élément `log` configure le logging de New Relic. L&apos;agent génère son propre fichier de log pour conserver ses informations de logging séparées du log de votre application.

```xml
<log enabled="true"
  level="info"
  auditLog="false"
  console="false"
  directory="PATH\TO\LOG\DIRECTORY"
  fileName="FILENAME.log" />
```

L&apos;élément `log` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="log-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque la valeur est `false`, tout logging est désactivé. Vous pouvez également définir la variable d’environnement `NEW_RELIC_LOG_ENABLED` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="log-level" title="level">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `info`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le niveau de détail enregistré dans le fichier de log. Les valeurs possibles, par ordre croissant de détail, sont :

    * `off`

    * `error`

    * `warn`

    * `info`

    * `debug`

    * `finest`

    * `all`

      Vous pouvez également définir la variable d’environnement `NEWRELIC_LOG_LEVEL` dans l’environnement de l’application.

      <Callout variant="important">
        Augmenter le niveau de log augmentera l&apos;impact sur les performances de New Relic.
      </Callout>
  </Collapser>

  <Collapser id="log-auditLog" title="auditLog">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Enregistre toutes les données envoyées et reçues depuis New Relic dans un fichier log auditlog et dans le fichier log standard. Ignoré si `enabled` est défini sur `false` ou `console` est défini sur `true`.
  </Collapser>

  <Collapser id="log-console" title="console">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Envoyer le message de log à la console au lieu du fichier de log (dans les versions agent antérieures à 10.35.0, les logs sont envoyés à la fois à la console et au fichier de log). Ignoré si `enabled` est défini sur `false`. Vous pouvez également définir la variable d’environnement `NEW_RELIC_LOG_CONSOLE` dans l’environnement de l’application.

    Le logging de la console dans le profileur est limitée au niveau `info` et supérieur en raison de considérations de performances.
  </Collapser>

  <Collapser id="log-directory" title="directory">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `C:\ProgramData\New Relic\.NET Agent\Logs`
          </td>
        </tr>
      </tbody>
    </table>

    Le répertoire contenant le fichier log généré par l&apos;agent. Si cette option est omise, un répertoire nommé `Logs` dans la zone d&apos;installation de l&apos;agent New Relic sera utilisé par défaut.

    Vous pouvez également définir la variable d’environnement `NEWRELIC_LOG_DIRECTORY` dans l’environnement de l’application. Vous pouvez également envoyer votre log de profileur vers un répertoire personnalisé, mais vous ne pouvez le faire qu&apos;avec la variable d&apos;environnement `NEWRELIC_PROFILER_LOG_DIRECTORY` dans l&apos;environnement de l&apos;application:

    ```ini
    NEWRELIC_LOG_DIRECTORY=path\to\a\directory
    NEWRELIC_PROFILER_LOG_DIRECTORY=path\to\a\directory # not configurable via config file
    ```
  </Collapser>

  <Collapser id="log-fileName" title="fileName">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Définit un nom pour le fichier de log. Si vous ne définissez pas de `fileName`, le nom est dérivé du nom du processus de monitoring.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_LOG` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_LOG=MyApp.log
    ```
  </Collapser>

  <Collapser id="log-logRollingStrategy" title="logRollingStrategy">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `size`
          </td>
        </tr>
      </tbody>
    </table>

    Définit agent la log stratégie de roulement du fichier de . Les valeurs possibles sont :

    * `size` (par défaut) : Le fichier de log est renouvelé lorsqu&apos;il atteint la taille spécifiée dans `maxLogFileSizeMB`.

    * `day`: Le fichier de log se termine à minuit.

      Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_LOG_ROLLING_STRATEGY` dans l&apos;environnement de l&apos;application :

      ```ini
      NEW_RELIC_LOG_ROLLING_STRATEGY=day
      ```

      Pris en charge dans l&apos;agent .NET v10.21.0 et supérieur.
  </Collapser>

  <Collapser id="log-logMaxFiles" title="logMaxFiles">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `4`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre de agent fichiers log à conserver instance agentpar de l&apos;, plusieurs applications exécutées sur le même hôte créeront chacune autant de fichiers. Lorsque le nombre maximum de fichier de log est atteint, le fichier de log le plus ancien est supprimé. Une valeur de `0` spécifie qu&apos;il n&apos;y a pas de nombre maximum de fichier de log.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_LOG_MAX_FILES` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_LOG_MAX_FILES=2
    ```

    Pris en charge dans l&apos;agent .NET v10.21.0 et supérieur.
  </Collapser>

  <Collapser id="log-maxLogFileSizeMB" title="maxLogFileSizeMB">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            50
          </td>
        </tr>
      </tbody>
    </table>

    Définit la taille maximale du agent fichier de de log en mégaoctets avant son basculement. Valable uniquement lorsque `logRollingStrategy` est défini sur `size`. Une valeur de `0` spécifie qu&apos;il n&apos;y a pas de taille maximale de fichier log .

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_LOG_MAX_FILE_SIZE_MB` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_LOG_MAX_FILE_SIZE_MB=100
    ```

    Pris en charge dans l&apos;agent .NET v10.21.0 et supérieur.
  </Collapser>
</CollapserGroup>

### Élément d&apos;application (obligatoire) [#application-configuration]

L&apos;élément `application` est un enfant de l&apos;élément `configuration` . Cet élément obligatoire définit le nom de votre application et désactive ou active l&apos;échantillonnage.

<CollapserGroup>
  <Collapser id="app-name" title="name">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `My Application`
          </td>
        </tr>
      </tbody>
    </table>

    Le [nom de votre application .NET](/docs/agents/net-agent/installation-and-configuration/naming-your-net-application) est un enfant de l’élément `application` . New Relic regroupera vos données en fonction de ce nom. Par exemple, si vous avez deux applications en cours d&apos;exécution nommées `AppA` et `AppB`, vous verrez deux applications dans l&apos;interface New Relic : `AppA` et `AppB`.

    Vous pouvez également attribuer [jusqu&apos;à trois noms](/docs/agents/manage-apm-agents/app-naming/use-multiple-names-app) à votre application. Le prénom est le nom principal. Par exemple:

    ```xml
    <application>
      <name>MY APPLICATION PRIMARY</name>
      <name>SECOND APP NAME</name>
      <name>THIRD APP NAME</name>
    </application>
    ```

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_APP_NAME` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_APP_NAME=Descriptive Name
    ```

    Pour plusieurs noms :

    ```ini
    NEW_RELIC_APP_NAME="App Name, App Name 2, App Name 3"
    ```
  </Collapser>

  <Collapser id="app-disableSamplers" title="disableSamplers">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Les échantillonneurs collectent des informations sur la consommation de mémoire et de processeur. Réglez ceci sur `true` pour désactiver l’échantillonnage.

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_DISABLE_SAMPLERS` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_DISABLE_SAMPLERS=true
    ```
  </Collapser>
</CollapserGroup>

### Élément de transmission de données [#data-transmission]

L&apos;élément `dataTransmission` est un enfant de l&apos;élément `configuration` . Cet élément affecte la manière dont les données sont envoyées à New Relic et peut être utilisé si vous avez des exigences spécifiques en matière de transmission de données.

```xml
<dataTransmission
  putForDataSend="false"
  compressedContentEncoding="deflate"/>
```

L&apos;élément `dataTransmission` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="data-transmission-putfordatasend" title="putForDataSend">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Définit la méthode HTTP utilisée lors de l&apos;envoi de données à New Relic. Définissez cette valeur sur `true` pour activer l’utilisation de la méthode `PUT` lors de l’envoi de données. La méthode `POST` est utilisée par défaut.
  </Collapser>
</CollapserGroup>

### Nom de l&apos;hôte

Si le nom d&apos;hôte par défaut dans l&apos;UI APM n&apos;est pas utile, vous pouvez décorer ce nom dans l&apos;UI de New Relic avec un nom d&apos;affichage. Une fois le processus d’application redémarré et l’agent .NET à nouveau opérationnel, le nom d’affichage apparaît dans la liste déroulante <DNT>**Servers**</DNT>. Ce paramètre de nom d&apos;hôte n&apos;affecte pas la liste des hôtes sur [la page <DNT>**Summary**</DNT> de votre application](/docs/apm/applications-menu/monitoring/apm-overview-page-view-transaction-apdex-usage-data).

Pour définir un nom d’affichage, choisissez l’une des options suivantes. La variable d&apos;environnement a priorité sur la valeur du fichier de configuration. Redémarrez ensuite votre application pour voir vos modifications dans l&apos;UI de New Relic.

<CollapserGroup>
  <Collapser id="host-name-config" title="Définir à l'aide du fichier de configuration">
    Définissez l’attribut `displayName` dans l’élément `processHost` dans `newrelic.config`. L&apos;élément `processHost` est un enfant de l&apos;élément `configuration` .

    ```xml
    <configuration . . . >
      <processHost displayName="CUSTOM_NAME" />
    </configuration>
    ```
  </Collapser>

  <Collapser id="host-name-env_variable" title="Définir à l'aide d'une variable d'environnement">
    Définissez la variable d’environnement `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME` :

    ```ini
    NEW_RELIC_PROCESS_HOST_DISPLAY_NAME="CUSTOM_NAME"
    ```
  </Collapser>
</CollapserGroup>

## Utilisation de la plateforme cloud [#cloud-platform-util]

L&apos;élément de configuration `utilization` contrôle la manière dont l&apos;agent collecte les informations d&apos;utilisation et les envoie au service New Relic pour déterminer la tarification. L&apos;agent peut collecter des informations à partir des instances Amazon Web Services (AWS) EC2, du conteneur Docker, Microsoft Azure, Google Cloud Platform, de Pivotal Cloud Foundry et Kubernetes.

```xml
<configuration . . . >
  <utilization detectAws="true" detectAzure="true" detectGcp="true" detectPcf="true" detectDocker="true" detectKubernetes="true" />
</configuration>
```

L&apos;élément `utilization` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="detectAws" title="detectAws">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l&apos;agent interroge l&apos;API de métadonnées AWS.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_AWS` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_AWS=false
    ```
  </Collapser>

  <Collapser id="detectAzure" title="detectAzure">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l’agent interroge l’API de métadonnées Microsoft Azure.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_AZURE` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_AZURE=false
    ```
  </Collapser>

  <Collapser id="detectGcp" title="detectGcp">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l&apos;agent interroge l&apos;API de métadonnées GCP.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_GCP` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_GCP=false
    ```
  </Collapser>

  <Collapser id="detectPcf" title="detectPcf">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l&apos;agent interroge les informations PCF à partir des variables d&apos;environnement.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_PCF` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_PCF=false
    ```
  </Collapser>

  <Collapser id="detectDocker" title="detectDocker">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l&apos;agent lit les informations Docker à partir du système de fichiers.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_DOCKER` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_DOCKER=false
    ```
  </Collapser>

  <Collapser id="detectKubernetes" title="detectKubernetes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Détermine si l&apos;agent interroge les informations Kubernetes à partir des variables d&apos;environnement.

    Alternativement, ce comportement peut être contrôlé via la variable d&apos;environnement `NEW_RELIC_UTILIZATION_DETECT_KUBERNETES` :

    ```ini
    NEW_RELIC_UTILIZATION_DETECT_KUBERNETES=false
    ```
  </Collapser>
</CollapserGroup>

## Options d&apos;instrumentation [#instrumentation]

Utilisez ces options pour configurer les éléments de votre application et de votre environnement à instrument. New Relic for .NET prend en charge les catégories suivantes d’options d’instrumentation :

* [Élément d&apos;instrumentation](#instrumentation-element)
* [Élément de règles](#instrumentation-rules)
* [Élément d&apos;application (instrumentation)](#application-instrumentation)
* [élément d&apos;attribut](#agent-attributes)

### Élément d&apos;instrumentation

L&apos;élément `instrumentation` est un enfant de l&apos;élément `configuration`. Par défaut, l’ agent .NET instrumente les processus de travail IIS ASP et les rôles Web et de travail Microsoft Azure . Pour instrumenter d&apos;autres processus, voir [application personnalisée instrumentée](/docs/agents/net-agent/features/instrumenting-custom-applications).

### Élément de règles (instrumentation) [#instrumentation-rules]

<Callout variant="important">
  Cette fonctionnalité est disponible dans l&apos;agent .NET 10.21.0 et versions ultérieures.
</Callout>

L&apos;élément `rules` est un enfant de l&apos;élément `instrumentation` . L&apos;élément `rules` prend en charge n&apos;importe quel nombre d&apos;éléments enfants `ignore`, ce qui indique au profileur de NE PAS instrumenter les méthodes définies dans l&apos;assembly spécifié. Les méthodes définies dans d&apos;autres assemblages seront toujours instrumentées.

```xml
<instrumentation>
  <rules>
    <ignore assemblyName="NameOfAssemblyToIgnore" />
  </rules>
</instrumentation>
```

La règle `ignore` vous permet de définir éventuellement un nom de classe. Dans l&apos;exemple suivant, seules les méthodes définies dans `MyNamespace.MyClass` dans l&apos;assembly `MyAssembly` seront ignorées. Les autres méthodes dans d’autres classes à l’intérieur de cet assembly et dans d’autres assemblys ne seront pas ignorées par le profileur.

```xml
<instrumentation>
  <rules>
    <ignore assemblyName="MyAssembly" className="MyNamespace.MyClass" />
  </rules>
</instrumentation>
```

Plusieurs règles d’ignorance peuvent être spécifiées. L&apos;exemple suivant désactive à la fois l&apos;instrumentation Confluent Kafka et StackExchange Redis .

```xml
<instrumentation>
  <rules>
    <ignore assemblyName="Confluent.Kafka" />
    <ignore assemblyName="StackExchange.Redis" />
  </rules>
</instrumentation>
```

Veuillez noter que l&apos;instrumentation personnalisée ne peut pas être ignorée via l&apos;élément `rules` .

### Élément d&apos;application (instrumentation) [#application-instrumentation]

L&apos;élément `applications` est un enfant de l&apos;élément `instrumentation` . L&apos;élément `applications` prend en charge `application` éléments enfants qui spécifient les applications non Web à instrument. L&apos;élément `application` contient un attribut `name` .

<Callout variant="important">
  Ce n’est pas la même chose que l’élément [`application` (configuration)](#application-configuration), qui est un [enfant de l’élément `configuration`](#application).
</Callout>

```xml
<instrumentation>
  <applications>
    <application name="MyService1.exe" />
    <application name="MyService2.exe" />
    <application name="MyService3.exe" />
  </applications>
</instrumentation>
```

### élément d&apos;attribut [#agent-attributes]

Un attribut est une paire valeur clé qui détermine les propriétés d&apos;un événement ou d&apos;une transaction. Chaque attribut est envoyé à APM trace de transaction, APM error trace, `Transaction` événement, `TransactionError` événement, `Span` événement ou `PageView` événement. L&apos;élément principal `attributes` active ou désactive la collecte d&apos;attributs pour l&apos;agent .NET et définit l&apos;attribut spécifique à collecter ou à exclure. Vous pouvez également configurer les paramètres d’attribut en fonction de la destination spécifique :

* [Collecte d&apos;erreurs](#error-attributes)
* [Événement de transaction](#transaction-attributes)
* [Trace de transaction](#tracer-attributes)
* [Événements de span](#span-attributes)
* [Événement de l&apos;agent Browser](#browser-attributes)

Dans cet exemple, l&apos;agent exclut tous les attributs dont la clé commence par `myApiKey` (`myApiKey.bar`, `myApiKey.value`) mais collecte l&apos;attribut personnalisé `myApiKey.foo`.

```xml
<attributes enabled="true">
  <exclude>myApiKey.*</exclude>
  <include>myApiKey.foo</include>
</attributes>
```

Vous pouvez afficher l’attribut .NET APM sur la page [d’attributs agent .NET](/docs/agents/net-agent/attributes/net-agent-attributes). Vous pouvez également définir des attributs personnalisés avec l&apos;appel d&apos;API d&apos;agent [`AddCustomAttribute`](/docs/agents/net-agent/net-agent-api/itransaction/#addcustomattribute).

<CollapserGroup>
  <Collapser id="agent-attributes-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver la collecte d&apos;attributs. Lorsqu&apos;il est défini sur `false` dans l&apos;élément d&apos;attribut principal, ce paramètre remplace tous les paramètres d&apos;attribut pour les destinations individuelles.

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_ATTRIBUTES_ENABLED` dans l’environnement de l’application.
  </Collapser>

  <Collapser id="agent-attributes-include" title="include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Si les attributs sont activés, l&apos;agent collectera toutes les clés d&apos;attribut spécifiées dans cette liste. Pour spécifier plusieurs clés d’attribut, spécifiez chacune d’elles individuellement. Vous pouvez également utiliser un caractère générique `*` à la fin d&apos;une clé pour faire correspondre plusieurs attributs (par exemple, `myApiKey.*`). Pour plus d&apos;informations, voir [Règles d&apos;attribut](/docs/agents/net-agent/attributes/enabling-disabling-attributes#attruls).

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_ATTRIBUTES_INCLUDE` dans l’environnement de l’application. Cette variable d&apos;environnement accepte une liste de noms d&apos;attributs délimitée par des virgules.

    <Callout variant="caution">
      Lorsque vous utilisez la variable d&apos;environnement `NEW_RELIC_ATTRIBUTES_INCLUDE` l&apos;ensemble d&apos;inclusions par défaut dans `newrelic.config` est écrasé. Voir [ici](#allow-all-headers-enabled) pour une liste détaillée des inclusions et exclusions par défaut.
    </Callout>
  </Collapser>

  <Collapser id="agent-attributes-exclude" title="exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Si les attributs sont activés, l&apos;agent ne collectera pas les clés d&apos;attribut spécifiées dans cette liste. Pour spécifier plusieurs clés d’attribut, spécifiez chacune d’elles individuellement. Vous pouvez également utiliser un caractère générique `*` à la fin d&apos;une clé pour faire correspondre plusieurs attributs (par exemple, `myApiKey.*`). Pour plus d&apos;informations, voir [Règles d&apos;attribut](/docs/agents/net-agent/attributes/enabling-disabling-attributes#attruls).

    Vous pouvez également définir la variable d’environnement `NEW_RELIC_ATTRIBUTES_EXCLUDE` dans l’environnement de l’application. Cette variable d&apos;environnement accepte une liste de noms d&apos;attributs délimitée par des virgules.

    <Callout variant="caution">
      Lorsque vous utilisez la variable d&apos;environnement `NEW_RELIC_ATTRIBUTES_EXCLUDE` l&apos;ensemble d&apos;exclusions par défaut dans `newrelic.config` est écrasé. Voir [ici](#allow-all-headers-enabled) pour une liste détaillée des inclusions et exclusions par défaut.
    </Callout>
  </Collapser>
</CollapserGroup>

## Options de fonctionnalité [#features]

Utilisez ces options pour activer, désactiver et configurer la fonctionnalité New Relic. New Relic pour .NET vous permet de configurer la fonctionnalité suivante :

* [Pools d&apos;applications](#include_exclude_apps)
* [Collecte d&apos;erreurs](#error_collector)
* [Mode haute sécurité](#high_security_mode)
* [Supprimer les messages d&apos;exception](#strip_exception_messages)
* [Événement de transaction](#transaction_events)
* [Événements personnalisés](#custom_events)
* [Paramètres personnalisés](#custom_parameters)
* [Tags/étiquettes](#labels-tags)
* [Instrumentation du navigateur](#browser_monitoring)
* [Requêtes lentes](#slow_sql)
* [Trace de transaction](#transaction_tracer)
* [Traceur de datastore](#datastore_tracer)
* [Tracing distribué](#distributed_tracing)
* [Infinite Tracing](#infinite_tracing)
* [Traces inter-application](#cross_application_tracer)
* [Événements de span](#span-events)
* [Capturer les en-têtes de requête HTTP](#capture_http_request_headers)
* [Logging des applications](#application_logging)
* [Métriques au niveau du code](#code_level_metrics)
* [Fournisseur de cloud modifié](#cloud)
* [Monitoring de l&apos;IA](#ai_monitoring)

### Pools d&apos;applications [#include\_exclude\_apps][#include_exclude_apps]

<Callout variant="important">
  Ceci s&apos;applique uniquement au [fichier de configuration global](#config-options-precedence) d&apos;un système.
</Callout>

<Callout variant="important">
  Ce paramètre s&apos;applique uniquement lorsque le modèle d&apos;hébergement IIS est défini sur en cours.
</Callout>

L&apos;élément `applicationPools` est un enfant de l&apos;élément `configuration` . L&apos;élément `applicationPools` spécifie pour le profileur exactement quels pools application instrumenter et utilise le même nom que le nom du pool application IIS. Cet élément configuration est utile lorsque vous devez instrumenter uniquement un petit sous-ensemble de vos pools d&apos;applications. Par exemple, un serveur donné peut avoir plusieurs centaines de pools application, mais seuls quelques-uns de ces pools doivent être instrumentés par l’ agent.NET.

Voici un exemple de désactivation instrumentation pour des pools application spécifiques :

```xml
<applicationPools>
  <applicationPool name="Foo" instrument="false"/>
  <applicationPool name="Bar" instrument="false"/>
</applicationPools>
```

Voici un exemple de désactivation de instrumentation pour tous les pools application en cours d&apos;exécution sur le serveur et d&apos;activation de instrumentation pour des pools application spécifiques :

```xml
<applicationPools>
  <defaultBehavior instrument="false"/>
  <applicationPool name="Foo" instrument="true"/>
  <applicationPool name="Bar" instrument="true"/>
</applicationPools>
```

L&apos;élément `applicationPools` prend en charge les éléments suivants :

<CollapserGroup>
  <Collapser id="appPool-defaultBehavior" title="defaultBehavior">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le comportement de l&apos;agent .NET au niveau « global » pour les pools application servis via IIS. L&apos;agent .NET instrumente tous les pools application par défaut. Lorsque `true`, les pools application répertoriés sous [applicationPool](#appPool-applicationPool) avec un attribut `instrument` défini sur false ne seront pas instrumentés.

    Essentiellement, lorsqu&apos;elle est définie sur `false`, la liste du pool application agit comme une liste de domaines autorisés. Lorsque la valeur est `true`, la liste du pool application agit comme une liste de refus.
  </Collapser>

  <Collapser id="appPool-applicationPool" title="applicationPool">
    Définit le comportement instrumentation pour un pool application spécifique. L&apos;attribut `name` est le nom d&apos;un pool application . Activer ou désactiver le profilage dans l&apos;attribut `instrument` . Définissez cette application dans l’attribut `name` .
  </Collapser>
</CollapserGroup>

### Collecte d&apos;erreurs [#error\_collector][#error_collector]

L&apos;élément `errorCollector` est un enfant de l&apos;élément `configuration` . `errorCollector` configure la collecte d&apos;erreurs, qui capture des informations sur les exceptions non détectées et les envoie à New Relic.

```xml
<errorCollector enabled="true" captureEvents="true" maxEventSamplesStored="100">
  <ignoreClasses>
    <errorClass>System.IO.FileNotFoundException</errorClass>
    <errorClass>System.Threading.ThreadAbortException</errorClass>
  </ignoreClasses>
  <ignoreMessages>
    <errorClass name="System.Exception">
       <message>Ignore message</message>
       <message>Ignore too</message>
    </errorClass>
  </ignoreMessages>
  <ignoreStatusCodes>
    <code>401</code>
    <code>404</code>
  </ignoreStatusCodes>
  <expectedClasses>
    <errorClass>System.ArgumentNullException</errorClass>
    <errorClass>System.ArgumentOutOfRangeException</errorClass>
  </expectedClasses>
  <expectedMessages>
    <errorClass name="System.Exception">
       <message>Expected message</message>
       <message>Expected too</message>
    </errorClass>
  </expectedMessages>
  <expectedStatusCodes>403,500-505</expectedStatusCodes>
  <attributes enabled="true">
    <exclude>myApiKey.*</exclude>
    <include>myApiKey.foo</include>
  </attributes>
</errorCollector>
```

<Callout variant="tip">
  Pour un aperçu de la configuration des erreurs dans APM, voir [Gérer les erreurs dans APM](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected).
</Callout>

<Callout variant="important">
  `expectedClasses`Les paramètres de configuration `expectedMessages` et `expectedStatusCodes` nécessitent [l&apos;agent .NET version 8.31.0.0 ou supérieure](/docs/agents/net-agent/installation/update-net-agent).
</Callout>

L&apos;élément `errorCollector` prend en charge les éléments et l&apos;attribut suivants :

<CollapserGroup>
  <Collapser id="error-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver le collecteur d&apos;erreurs.
  </Collapser>

  <Collapser id="error-captureEvents" title="captureEvents">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver la capture d&apos;événement d&apos;erreur.
  </Collapser>

  <Collapser id="error-maxEventSamplesStored" title="maxEventSamplesStored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `100`
          </td>
        </tr>
      </tbody>
    </table>

    Limite du réservoir pour événement d&apos;erreur.
  </Collapser>

  <Collapser id="error-ignoreClasses" title="ignoreClasses">
    Une liste de noms de classes entièrement qualifiés à ignorer. Le nombre maximal de combinaisons de classes d&apos;erreur et de messages <DNT>**SHOULD**</DNT> être signalés est de 50. Si plus de 50 sont répertoriés, seuls les 50 premiers <DNT>**SHOULD**</DNT> doivent être utilisés.
  </Collapser>

  <Collapser id="error-ignoreMessages" title="ignoreMessages">
    Une carte facultative de noms de classes entièrement qualifiés vers une liste de chaînes correspondant à une sous-chaîne du message d&apos;une erreur. Le nombre maximal de combinaisons de classes d&apos;erreur et de messages <DNT>**SHOULD**</DNT> être signalés est de 50. Si plus de 50 sont répertoriés, seuls les 50 premiers <DNT>**SHOULD**</DNT> doivent être utilisés.
  </Collapser>

  <Collapser id="error-ignoreErrors" title="ignoreErrors (obsolète)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Répertorie les exceptions spécifiques à ne pas signaler à New Relic. Le nom complet de l’exception doit être utilisé, tel que `System.IO.FileNotFoundException`.
  </Collapser>

  <Collapser id="error-ignoreStatusCodes" title="ignoreStatusCodes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>

    Répertorie les codes d&apos;erreur HTTP spécifiques à ne pas signaler à New Relic. Vous pouvez utiliser des codes d&apos;erreur HTTP intégraux standard, tels que simplement `401`, ou vous pouvez utiliser des codes d&apos;état complets Microsoft avec des points décimaux, tels que `401.4` ou `403.18`. Les codes d’état doivent être égaux ou supérieurs à `400`.

    Cela peut également être configuré via une variable d&apos;environnement, en spécifiant plusieurs codes avec une liste séparée par des virgules :

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES=401, 403.18
    ```

    <Callout variant="tip">
      Les erreurs personnalisées signalées avec l&apos;[API`NoticeError()` ](/docs/agents/net-agent/net-agent-api/noticeerror-net-agent)de l&apos;agent sont toujours signalées à New Relic même si la transaction associée a un code d&apos;état HTTP configuré ici.
    </Callout>
  </Collapser>

  <Collapser id="error-expectedClasses" title="expectedClasses">
    Une liste de noms de classes entièrement qualifiés à marquer comme prévu. Le nombre maximal de combinaisons de classes d&apos;erreur et de messages <DNT>**SHOULD**</DNT> être signalés est de 50. Si plus de 50 sont répertoriés, seuls les 50 premiers <DNT>**SHOULD**</DNT> doivent être utilisés
  </Collapser>

  <Collapser id="error-expectedMessages" title="expectedMessages">
    Une carte facultative de noms de classes entièrement qualifiés vers une liste de chaînes correspondant à une sous-chaîne du message d&apos;une erreur. Le nombre maximal de combinaisons de classes d&apos;erreur et de messages <DNT>**SHOULD**</DNT> être signalés est de 50. Si plus de 50 sont répertoriés, seuls les 50 premiers <DNT>**SHOULD**</DNT> doivent être utilisés
  </Collapser>

  <Collapser id="error-expectedStatusCodes" title="expectedStatusCodes">
    Une liste de codes d&apos;état séparés par des virgules. La liste peut inclure des plages d&apos;entiers à l&apos;aide d&apos;un seul tiret (`-`) et comprendra à la fois l&apos;entier de début et de fin de la plage.

    Cela peut également être configuré via une variable d&apos;environnement :

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES=401, 501-503
    ```
  </Collapser>

  <Collapser id="error-attributes" title="attributes">
    Utilisez ce sous-élément pour personnaliser les paramètres d’attribut de votre agent pour le suivi des erreurs. Ce sous-élément utilise les mêmes paramètres que l’élément principal `attributes` : [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include) et [`exclude`](#agent-attributes-exclude).
  </Collapser>
</CollapserGroup>

### Mode haute sécurité [#high\_security\_mode][#high_security_mode]

L&apos;élément `highSecurity` est un enfant de l&apos;élément `configuration` . Pour activer [le mode haute sécurité](/docs/subscriptions/high-security), définissez cette propriété sur `true` et activez la propriété haute sécurité dans l&apos;interface utilisateur New Relic. L&apos;activation de la haute sécurité active SSL ; les paramètres de demande, les paramètres personnalisés et les en-têtes de demande HTTP ne sont pas collectés ; la suppression des messages d&apos;exception est activée ; et la requête ne peut pas être envoyée à New Relic sous sa forme brute.

<CollapserGroup>
  <Collapser id="highsecurity-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver le mode haute sécurité. Exemple:

    ```xml
    <highSecurity enabled="true"/>
    ```

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_HIGH_SECURITY` dans l&apos;environnement de l&apos;application :

    ```ini
    NEW_RELIC_HIGH_SECURITY=true
    ```
  </Collapser>
</CollapserGroup>

### Supprimer les messages d&apos;exception [#strip\_exception\_messages][#strip_exception_messages]

L&apos;élément `stripExceptionMessages` est un enfant de l&apos;élément `configuration` . Pour activer les messages d’exception de suppression, définissez cette propriété sur `true`. Par défaut, cette valeur est définie sur false, ce qui signifie que l&apos;agent envoie les messages de toutes les exceptions au collecteur New Relic. Si vous activez le mode haute sécurité, celui-ci est automatiquement modifié sur vrai et l&apos;agent supprime les messages des exceptions.

<CollapserGroup>
  <Collapser id="stripExceptionMessages-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver les messages d&apos;exception de bande. Exemple:

    ```xml
    <stripExceptionMessages enabled="true"/>
    ```
  </Collapser>
</CollapserGroup>

### Événement de transaction [#transaction\_events][#transaction_events]

L&apos;élément `transactionEvents` est un enfant de l&apos;élément `configuration` . Utilisez `transactionEvents` pour configurer l&apos;événement de transaction.

```xml
<transactionEvents enabled="true" maximumSamplesStored="10000">
  <attributes enabled="true">
    <exclude>myApiKey.*</exclude>
    <include>myApiKey.foo</include>
  </attributes>
</transactionEvents>
```

L&apos;élément `transactionEvents` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="transaction-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver l&apos;enregistreur d&apos;événements.
  </Collapser>

  <Collapser id="transaction-maximumSamplesStored" title="maximumSamplesStored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximal d&apos;événements de transaction échantillonnés que l&apos;agent peut stocker en mémoire à la fois. Il s&apos;agira du nombre maximal d&apos;événements de transaction que l&apos;agent peut envoyer par minute.

    Vous pouvez également définir la variable d&apos;environnement `MAX_TRANSACTION_SAMPLES_STORED` dans l&apos;environnement de l&apos;application :

    ```ini
    MAX_TRANSACTION_SAMPLES_STORED=500
    ```
  </Collapser>

  <Collapser id="transaction-attributes" title="attributes">
    Utilisez ce sous-élément pour personnaliser les paramètres d’attributs de votre agent pour l’événement de transaction. Ce sous-élément utilise les mêmes paramètres que l’élément principal `attributes` : [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include) et [`exclude`](#agent-attributes-exclude).

    <Callout variant="tip">
      Ces paramètres d&apos;attribut sont spécifiques à l&apos;événement `transaction` . les paramètres d&apos;attribut peuvent être appliqués globalement à tous les types d&apos;événements [avec ce paramètre configuration ](/docs/agents/net-agent/configuration/net-agent-configuration#agent-attributes).
    </Callout>

    <Callout variant="caution">
      Lorsque Infinite Tracing et/ou le tracing infini sont activés, les informations de l&apos;événement de transaction sont appliquées à l&apos;événement Span racine de la transaction. Envisagez d&apos;appliquer tous les paramètres d&apos;attribut pour l&apos;événement de transaction à l&apos;événement étendu et/ou de les appliquer en tant que [paramètres d&apos;attribut globaux](#agent-attributes).
    </Callout>
  </Collapser>
</CollapserGroup>

### Événements personnalisés [#custom\_events][#custom_events]

L&apos;élément `customEvents` est un enfant de l&apos;élément `configuration` . Utilisez `customEvents` pour configurer [l&apos;événement personnalisé](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-new-relic-apm-agents#net-att).

```xml
<customEvents enabled="true" maximumSamplesStored="10000"/>
```

L&apos;élément `customEvents` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="customevents-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver l&apos;enregistreur d&apos;événements.
  </Collapser>

  <Collapser id="customevents-maximumSamplesStored" title="maximumSamplesStored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximum d&apos;événements personnalisés échantillonnés que l&apos;agent peut stocker en mémoire à la fois. Ce sera le nombre maximum d&apos;événements personnalisés que l&apos;agent peut envoyer par minute.

    Vous pouvez également définir la variable d&apos;environnement `MAX_EVENT_SAMPLES_STORED` dans l&apos;environnement de l&apos;application :

    ```ini
    MAX_EVENT_SAMPLES_STORED=500
    ```

    * Si vous configurez l&apos;agent pour [monitoring de l&apos;IA](/docs/ai-monitoring/intro-to-ai-monitoring/), nous vous recommandons de définir la valeur sur `100000`.
  </Collapser>
</CollapserGroup>

### Paramètres personnalisés [#custom\_parameters][#custom_parameters]

L&apos;élément `customParameters` est un enfant de l&apos;élément `configuration` . Utilisez `customParameters` pour configurer [le paramètre personnalisé](/docs/insights/insights-data-sources/custom-data/add-custom-attributes-apm-data).

```xml
<customParameters enabled="true" />
```

L&apos;élément `customParameters` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="customparameters-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver la capture des paramètres personnalisés.
  </Collapser>
</CollapserGroup>

### Étiquettes (tag)

L&apos;élément `labels` est un enfant de l&apos;élément `configuration` .

Cela définit les noms et les valeurs [tag](/docs/new-relic-one/use-new-relic-one/core-concepts/tagging-use-tags-organize-group-what-you-monitor). La liste est une liste délimitée par des points-virgules de paires nom/valeur séparées par des deux-points. Vous pouvez également l&apos;utiliser avec la variable d&apos;environnement `NEW_RELIC_LABELS`. Exemple:

```xml
<labels>foo:bar;zip:zap</labels>
```

```ini
NEW_RELIC_LABELS="foo:bar;zip:zap"
```

### Instrumentation du navigateur [#browser\_monitoring][#browser_monitoring]

L&apos;élément `browserMonitoring` est un enfant de l&apos;élément `configuration`. `browserMonitoring` configure <InlinePopover type="browser" />dans votre application .NET. le navigateur vous donne des informations détaillées sur les performances de votre utilisateur final. Cela se fait en mesurant le temps qu&apos;il faut au navigateur de votre utilisateur pour télécharger et restituer vos pages Web en injectant une petite quantité de code JavaScript dans l&apos;en-tête et le pied de page de chaque page.

```xml
// If you use both the Exclude and Attribute elements
// the Exclude element must be listed first.
<browserMonitoring autoInstrument="true">
  <requestPathsExcluded>
    <path regex="url-regex-1"/>
    <path regex="url-regex-2"/>
    ...
    <path regex="url-regex-n"/>
  </requestPathsExcluded>
  <attributes enabled="true">
    <exclude>myApiKey.*</exclude>
    <include>myApiKey.foo</include>
  </attributes>
</browserMonitoring>
```

L&apos;élément `browserMonitoring` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="browsermon-autoInstrument" title="autoInstrument">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Par défaut, l&apos;agent injecte automatiquement le JavaScript de l&apos;agent du navigateur. Pour désactiver l&apos;injection automatique, définissez cet attribut sur `false`.
  </Collapser>

  <Collapser id="browser-attributes" title="attributes">
    Utilisez ce sous-élément pour personnaliser les paramètres d&apos;attributs de votre agent pour [monitoring des navigateurs](/docs/browser/new-relic-browser/page-load-timing/instrumentation-page-load-timing). Ce sous-élément utilise les mêmes paramètres que l’élément principal `attributes` : [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include) et [`exclude`](#agent-attributes-exclude).
  </Collapser>

  <Collapser id="browser-path-exclusion" title="requestPathsExcluded">
    Utilisez ce sous-élément pour empêcher l&apos;agent de navigateur d&apos;être injecté dans des pages spécifiques. L&apos;élément est utilisé comme suit :

    ```xml
    <requestPathsExcluded>
      <path regex="url-regex-1"/>
      <path regex="url-regex-2"/>
      ...
      <path regex="url-regex-n"/>
    </requestPathsExcluded>
    ```

    L&apos;agent n&apos;injectera pas l&apos;agent de navigateur dans les pages dont l&apos;URL correspond à l&apos;une des expressions régulières spécifiées. Les expressions régulières doivent suivre [les directives Microsoft pour la classe Regex](https://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex\(v=vs.110\).aspx).

    Il s&apos;agit d&apos;une référence au répertoire virtuel du chemin dans votre application et non à l&apos;URL complète du chemin que vous souhaitez exclure. Par exemple, pour exclure les pages de `https://www.mywebsite.com/mywebpages/` vous devez simplement insérer `/mywebpages/` comme valeur regex du chemin.

    L&apos;élément `requestPathsExcluded` doit être utilisé dans les cas où il est impossible ou indésirable d&apos;utiliser l&apos;appel [`DisableBrowserMonitoring()`](/docs/agents/net-agent/net-agent-api/disablebrowsermonitoring-net-agent). Pour minimiser un éventuel impact sur les performances, essayez d&apos;utiliser le moins d&apos;expressions régulières possible et de les garder aussi simples que possible.
  </Collapser>
</CollapserGroup>

### Requêtes lentes [#slow\_sql][#slow_sql]

L&apos;élément `slowSql` est un enfant de l&apos;élément `configuration` . `slowSql` configure la capture d&apos;informations sur les exécutions lentes de requêtes, et capture et obscurcit les plans explicatifs de ces requêtes.

```xml
<slowSql enabled="true"/>
```

L&apos;élément `slowSql` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="catracer-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activez ou désactivez le tracing des requêtes lentes.
  </Collapser>
</CollapserGroup>

### Trace de transaction [#transaction\_tracer][#transaction_tracer]

L&apos;élément `transactionTracer` est un enfant de l&apos;élément `configuration` . `transactionTracer` configure [la trace de transaction](/docs/traces/transaction-traces). La trace comprend la séquence d&apos;appel exacte des transactions, y compris toutes les instructions de requête émises.

```xml
<transactionTracer enabled="true"
    transactionThreshold="apdex_f"
    recordSql="obfuscated"
    explainEnabled="true"
    explainThreshold="500"
    maxSegments="3000"
    maxExplainPlans="20">
  <attributes enabled="true">
    <exclude>myApiKey.*</exclude>
    <include>myApiKey.foo</include>
  </attributes>
 </transactionTracer>
```

L&apos;élément `transactionTracer` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="tracer-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver [le suivi de transaction](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="tracer-transactionThreshold" title="transactionThreshold">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le seuil de trace de transaction. Si une transaction prend plus de temps que le seuil, elle est éligible au tracing. Consultez [les principes de base dutrace des transactions](/docs/apm/transactions/transaction-traces/transaction-traces#basics) pour en savoir plus sur les règles régissant le suivi.

    La valeur par défaut est `apdex_f`, ce qui définit le seuil à quatre fois la valeur `apdex_t` de l&apos;application. Pour plus d&apos;informations sur `apdex_t`, voir [Apdex](/docs/site/apdex-measuring-user-satisfaction).

    Vous pouvez également définir le seuil sur une valeur temporelle spécifique en millisecondes.
  </Collapser>

  <Collapser id="tracer-recordSql" title="recordSql">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>
      </tbody>
    </table>

    Sélectionnez une politique de suivi des requêtes. Les options sont `off`, qui n&apos;enregistre rien ; `obfuscated`, qui enregistre une version obscurcie de la requête ; ou `raw`, qui enregistre la requête exactement telle qu&apos;elle est envoyée à la base de données.

    <Callout variant="caution">
      L&apos;enregistrement d&apos;une requête brute peut capturer des informations sensibles.
    </Callout>
  </Collapser>

  <Collapser id="tracer-explainEnabled" title="explainEnabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque `true`, l&apos;agent capture `EXPLAIN` instructions pour les requêtes lentes avec des durées dépassant `explainThreshold`. Notez que l&apos;activation de cette fonctionnalité peut avoir des implications sur les performances, car les plans sont capturés pour chaque transaction jusqu&apos;à la valeur `maxExplainPlans` .
  </Collapser>

  <Collapser id="tracer-explainThreshold" title="explainThreshold">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            Unité
          </th>

          <td>
            Millisecondes
          </td>
        </tr>
      </tbody>
    </table>

    L&apos;agent collecte [les données de requête lente](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) pour les requêtes qui dépassent ce seuil, ainsi que tous les plans d&apos;explication disponibles, dans le cadre du suivi de la transaction.
  </Collapser>

  <Collapser id="tracer-maxSegments" title="maxSegments">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `3000`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximal de segments à collecter dans une trace de transaction.
  </Collapser>

  <Collapser id="tracer-maxExplainPlans" title="maxExplainPlans">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `20`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximal de plans explicatifs à collecter par transaction.
  </Collapser>

  <Collapser id="tracer-maxStackTrace" title="maxStackTrace">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `0`
          </td>
        </tr>
      </tbody>
    </table>

    Par défaut, `maxStackTrace` est défini sur `0`, ce qui désactive le suivi des appels dans le cadre d&apos;un trace de transaction. Si cette valeur est définie sur une valeur supérieure à `0`, la trace des appels sera capturée pour la trace de la transaction.
  </Collapser>

  <Collapser id="tracer-attributes" title="attributes">
    Utilisez ce sous-élément pour personnaliser les paramètres d&apos;attributs de votre agent pour le suivi de la transaction. Ce sous-élément utilise les mêmes paramètres que l’élément principal `attributes` : [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include) et [`exclude`](#agent-attributes-exclude).
  </Collapser>
</CollapserGroup>

### Traceur de datastore [#datastore\_tracer][#datastore_tracer]

L&apos;élément `datastoreTracer` est un enfant de l&apos;élément `configuration` .

```xml
<datastoreTracer>
  <instanceReporting enabled="true"  />
  <databaseNameReporting enabled="true" />
  <queryParameters enabled="false" />
</datastoreTracer>
```

L&apos;élément `datastoreTracer` prend en charge les sous-éléments suivants :

<CollapserGroup>
  <Collapser id="instance-reporting" title="instanceReporting">
    Utilisez ce sous-élément pour activer la collecte de datastore instance métriques (telles que l&apos;hôte et le port) pour [certains pilotes de base de données](/docs/agents/net-agent/features/net-agent-instance-level-database-information). Ceux-ci sont signalés sur requête lente trace et trace de transaction. La valeur par défaut de l&apos;attribut `enabled` est `true`.
  </Collapser>

  <Collapser id="database-name-reporting" title="databaseNameReporting">
    Utilisez ce sous-élément pour activer la collecte du nom de la base de données sur requête lente trace et trace de transaction pour [certains pilotes de base de données](/docs/agents/net-agent/features/net-agent-instance-level-database-information). La valeur par défaut de l&apos;attribut `enabled` est `true`.
  </Collapser>

  <Collapser id="datastore-tracer-query-parameters" title="queryParameters">
    Utilisez ce sous-élément pour activer la collecte des paramètres de requête SQL sur la trace lente de la requête. La valeur par défaut de l&apos;attribut `enabled` est `false`.

    <Callout variant="caution">
      * La requête d’enregistrement des paramètres peut capturer des informations sensibles.
      * L&apos;option de configuration `transactionTracer.recordSql` doit être définie sur `raw` sinon cette option est ignorée.
    </Callout>
  </Collapser>
</CollapserGroup>

### Tracing distribué [#distributed\_tracing][#distributed_tracing]

L&apos;élément `distributedTracing` est un enfant de l&apos;élément `configuration` .

```xml
<distributedTracing enabled="true"
   excludeNewrelicHeader="false"/>
```

Le traçage distribué permet de visualiser le chemin emprunté par une requête lors de son passage à travers un système distribué. Il nécessite [la version 8.6.45.0 ou supérieure de l&apos;agent .NET](/docs/agents/net-agent/installation/update-net-agent) et est activé par défaut dans les agents .NET 9.0.0.0 et supérieurs.

<Callout variant="important">
  L&apos;activation [du tracing distribué](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) désactive [le tracing inter-application](#cross_application_tracer) et a d&apos;autres effets sur la fonctionnalité APM . Avant l&apos;activation, lisez le [guide de planification](/docs/transition-guide-distributed-tracing).
</Callout>

Pour plus d’informations sur la configuration du tracing distribué, consultez [Activer le tracing distribué pour votre application .NET](/docs/apm/agents/net-agent/configuration/distributed-tracing-net-agent).

L&apos;élément `distributedTracing` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="dt-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Vous pouvez également activer le tracing distribué via la variable d&apos;environnement `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED` dans l&apos;environnement de l&apos;application:

    ```ini
    NEW_RELIC_DISTRIBUTED_TRACING_ENABLED=true
    ```
  </Collapser>

  <Collapser id="excludeNewrelicHeader" title="exclureNewrelicHeader">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Par défaut, les versions prises en charge de l&apos;agent utilisent à la fois l&apos;en-tête `newrelic` et les en-têtes [W3C Trace Context](/docs/understand-dependencies/distributed-tracing/get-started/how-new-relic-distributed-tracing-works#headers) pour le tracing distribué. L&apos;en-tête distribué de tracing `newrelic` permet l&apos;interopérabilité avec les agents plus anciens qui ne prennent pas en charge les en-têtes W3C Trace Context . les versions d&apos;agent qui prennent en charge les en-têtes W3C Trace Context les prioriseront par rapport aux en-têtes `newrelic` pour le tracing distribué.

    Si vous ne souhaitez pas utiliser l&apos;en-tête `newrelic`, définissez-le sur `true` pour que l&apos;agent exclue l&apos;en-tête `newrelic` et utilise uniquement les en-têtes W3C Trace Context pour le tracing distribué.
  </Collapser>
</CollapserGroup>

#### Configuration de l&apos;échantillonneur

<Callout variant="important">
  La configuration de l&apos;échantillonneur est disponible à partir de la version 10.45.0 de l&apos;agent .NET.
</Callout>

L&apos;agent .NET prend actuellement en charge 4 algorithmes d&apos;échantillonnage différents qui peuvent être configurés pour être utilisés dans le traçage distribué :

<table>
  <thead>
    <tr>
      <th>
        <DNT>
          **Sampler Type**
        </DNT>
      </th>

      <th>
        <DNT>
          **Description**
        </DNT>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Échantillonneur adaptatif
      </td>

      <td>
        L&apos;algorithme d&apos;échantillonnage d&apos;origine utilisé par l&apos;agent .NET est activé par défaut. Les décisions d&apos;échantillonnage sont prises de manière aléatoire, dans le but de conserver un nombre configuré d&apos;échantillons par période d&apos;échantillonnage.
      </td>
    </tr>

    <tr>
      <td>
        Échantillonneur basé sur le ratio d&apos;identification de trace
      </td>

      <td>
        Une implémentation de l&apos;échantillonneur basé sur le ratio d&apos;identifiants de trace Open télémétrie qui échantillonne un pourcentage configuré de la trace en fonction de l&apos;identifiant de trace (généré aléatoirement).
      </td>
    </tr>

    <tr>
      <td>
        Échantillonneur toujours actif
      </td>

      <td>
        Comme son nom l&apos;indique, cet échantillonneur analysera chaque trace. Notez que l&apos;activation de cet échantillonneur peut avoir un impact sur les performances des applications et entraînera une augmentation de l&apos;ingestion de données.
      </td>
    </tr>

    <tr>
      <td>
        Échantillon Always Off
      </td>

      <td>
        Contrairement à la fonction Always On, cet échantillonneur n&apos;échantillonne aucune trace. Utile dans des cas très spécifiques.
      </td>
    </tr>
  </tbody>
</table>

Les échantillonneurs pris en charge peuvent être configurés à plusieurs niveaux :

<table>
  <thead>
    <tr>
      <th>
        <DNT>
          **Sampler Level**
        </DNT>
      </th>

      <th>
        <DNT>
          **Description**
        </DNT>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Racine
      </td>

      <td>
        Il s&apos;agit de l&apos;échantillonneur appliqué au début d&apos;une trace. Par défaut, l&apos;échantillonneur adaptatif est configuré comme échantillonneur racine.
      </td>
    </tr>

    <tr>
      <td>
        Parent distant échantillonné
      </td>

      <td>
        Il s&apos;agit de l&apos;échantillonneur appliqué lorsque la trace a un parent distant (c&apos;est-à-dire que la trace provient d&apos;un service en amont) qui a été échantillonné. Il peut être configuré pour utiliser, par exemple, l&apos;échantillonneur Always On afin de garantir que toutes les traces de l&apos;application actuelle soient échantillonnées.
      </td>
    </tr>

    <tr>
      <td>
        Parent distant non échantillonné
      </td>

      <td>
        Il s&apos;agit de l&apos;échantillonneur appliqué lorsqu&apos;une trace a un parent distant (c&apos;est-à-dire que la trace provient d&apos;un service en amont) qui n&apos;a PAS été échantillonné.
      </td>
    </tr>
  </tbody>
</table>

L&apos;élément de configuration `<sampler>` est un enfant de l&apos;élément `<distributedTracing>` et est structuré comme suit :

```xml
  <distributedTracing ... >
    <sampler>
      <root>
        ...
      </root>
      <remoteParentSampled>
        ...
      </remoteParentSampled>
      <remoteParentNotSampled>
        ...
      </remoteParentNotSampled>
    </sampler>
  </distributedTracing>
```

Pour chaque niveau d&apos;échantillonnage, l&apos;une des configurations d&apos;échantillonnage suivantes peut être spécifiée :

```xml
  <default /> # default is a synonym for <adaptive />
  <adaptive />
  <traceIdRatioBased ratio="0.12" />
  <alwaysOn />
  <alwaysOff />
```

L&apos;élément `<traceIdRatioBased>` possède un attribut `ratio` obligatoire, qui est une valeur comprise entre 0,0 et 1,0 spécifiant le pourcentage de trace qui doit être échantillonné.

<Callout variant="important">
  Le **Adaptive Sampler** sera utilisé s&apos;il n&apos;y a pas de configuration spécifiée à un niveau d&apos;échantillonneur particulier ou si l&apos;élément de configuration pour ce niveau n&apos;est pas spécifié du tout.
</Callout>

Les variables d&apos;environnement suivantes peuvent être utilisées pour configurer l&apos;échantillonneur tracedistribuées aux différents niveaux d&apos;échantillonnage, en spécifiant l&apos;une des valeurs possibles pour le type d&apos;échantillonneur :

```
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_ROOT= default | adaptive | traceIdRatioBased | alwaysOn | alwaysOff
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_SAMPLED =  default | adaptive | traceIdRatioBased | alwaysOn | alwaysOff
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_NOT_SAMPLED = default | adaptive | traceIdRatioBased | alwaysOn | alwaysOff
```

Si la valeur de l&apos;une de ces variables d&apos;environnement est `traceIdRatioBased`, une variable d&apos;environnement correspondante spécifiant le ratio est également requise pour le même niveau d&apos;échantillonnage :

```
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_ROOT_TRACE_ID_RATIO_BASED_RATIO=0.12
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_SAMPLED_TRACE_ID_RATIO_BASED_RATIO=0.12
NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_NOT_SAMPLED_TRACE_ID_RATIO_BASED_RATIO=0.12
```

#### Reportage événementiel de Span

tracing des rapports distribués sur l&apos;ensemble des événements. La création de rapports sur les événements Span est activée par défaut, mais [le tracing distribué](/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing) doit être activé pour que les événements Span soient signalés. Pour désactiver l&apos;événement SPAN, choisissez l&apos;une des options suivantes :

<CollapserGroup>
  <Collapser id="span-events-disable-config" title="Désactiver l'événement span via le fichier de configuration">
    Définissez l&apos;élément `<spanEvents>` sur `false` pour le désactiver via le fichier `newrelic.config` . Cet élément est un enfant de l&apos;élément `<configuration>` .

    ```xml
    <configuration . . . >
      <spanEvents enabled="false" />
    </configuration>
    ```
  </Collapser>

  <Collapser id="span-events-disable-env_variable" title="Désactiver l'événement span via la variable d'environnement">
    Définissez la variable d’environnement `NEW_RELIC_SPAN_EVENTS_ENABLED` dans l’environnement de l’application :

    ```ini
    NEW_RELIC_SPAN_EVENTS_ENABLED=false
    ```
  </Collapser>
</CollapserGroup>

### Infinite Tracing [#infinite\_tracing][#infinite_tracing]

[Infinite Tracing](/docs/distributed-tracing/infinite-tracing/introduction-infinite-tracing) étend le service distribué de tracing en utilisant un observateur de trace externe à l&apos;agent. Il observe 100 % de la trace de votre application sur différents services et fournit des données exploitables afin que vous puissiez résoudre les problèmes plus rapidement.

Pour activer [Infinite Tracing](/docs/distributed-tracing/infinite-tracing/introduction-infinite-tracing), assurez-vous que vous disposez de [agent .NET version 8.30 ou supérieure](/docs/release-notes/agent-release-notes/net-release-notes) et activez le tracing distribué. Ajoutez ensuite les paramètres supplémentaires suivants :

```xml
<configuration . . . >
  <distributedTracing enabled="true" />
  <infiniteTracing>
    <trace_observer host="YOUR_TRACE_OBSERVER_HOST" />
  </infiniteTracing>
</configuration>
```

<Callout variant="important">
  Les spans de Infinite Tracing peuvent être limitées par le paramètre [`transactionTracer.maxSegments`](/docs/apm/agents/net-agent/configuration/net-agent-configuration/#tracer-maxSegments).
</Callout>

L&apos;élément `infiniteTracing` prend en charge les éléments suivants :

<CollapserGroup>
  <Collapser id="trace_observer" title="trace_observer">
    L&apos;élément `trace_observer` identifie un hôte observateur indépendant de l&apos;agent. Pour obtenir de l&apos;aide pour obtenir une entrée d&apos;hôte d&apos;observateur de trace Infinite Tracing valide, consultez [Rechercher ou créer un point de terminaison d&apos;observateur de trace](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer "https://docs.newrelic.com/docs/understand-dependencies/distributed-tracing/enable-configure/lingual-agents-enable-distributed-tracing#provision-trace-observer").

    L&apos;observateur de trace peut également être configuré à l&apos;aide de la variable d&apos;environnement `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST` .

    <Callout variant="important">
      Lors de la configuration de l&apos;observateur de trace, vous ne devez pas fournir le protocole dans le cadre de l&apos;hôte. Par exemple, utilisez `myhost.infinitetracing.com` au lieu de `https://myhost.infinitetracing.com`.
    </Callout>
  </Collapser>
</CollapserGroup>

### Traces inter-application [#cross\_application\_tracer][#cross_application_tracer]

L&apos;élément `crossApplicationTracer` est un enfant de l&apos;élément `configuration` . `crossApplicationTracer` liens tracent la transaction à travers l&apos;application. Lorsqu&apos;elles sont liées dans une architecture orientée services, toutes les applications instrumentées qui communiquent entre elles via HTTP « lieront » désormais la trace de transaction avec l&apos;application qu&apos;elles appellent et l&apos;application par laquelle elles sont appelées. [Le tracing inter-applications](/docs/traces/cross-application-traces) facilite la compréhension de la relation de performances entre les services et les applications.

<Callout variant="important">
  Le tracing inter-applications est obsolète depuis [la version 9.0.0 de l&apos;agent](/docs/release-notes/agent-release-notes/net-release-notes/net-agent-9000/) et désactivé par défaut. Il sera supprimé dans une future version de l&apos;agent. Pour utiliser CAT avec la version 9+ de l&apos;agent, vous devez définir à la fois `crossApplicationTracer.enabled = true` et `distributedTracing.enabled = false`. L&apos;activation [du tracing distribué](/docs/understand-dependencies/distributed-tracing/get-started/introduction-distributed-tracing) désactivera [le tracing inter-application](#cross_application_tracer).
</Callout>

```xml
<crossApplicationTracer enabled="true"/>
```

L&apos;élément `crossApplicationTracer` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="catracer-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver le tracing inter-applications
  </Collapser>
</CollapserGroup>

### Événements de span

L&apos;élément `spanEvents` est un enfant de l&apos;élément `configuration` . Utilisez `spanEvents` pour configurer l&apos;événement span.

```xml
<spanEvents enabled="true">
  <attributes enabled="true">
    <exclude>myApiKey.*</exclude>
    <include>myApiKey.foo</include>
  </attributes>
</spanEvents>
```

L&apos;élément `spanEvents` prend en charge l&apos;attribut suivant :

<CollapserGroup>
  <Collapser id="span-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver l&apos;enregistreur d&apos;événements.
  </Collapser>

  <Collapser id="span-max-samples-stored" title="maximumSamplesStored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Int
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `2000`
          </td>
        </tr>
      </tbody>
    </table>

    Le nombre maximal d&apos;événements d&apos;échantillonnage que l&apos;agent peut stocker en mémoire à la fois. Il s&apos;agira du nombre maximal d&apos;événements SPAN que l&apos;agent peut envoyer par minute.

    * Cela peut également être configuré à l&apos;aide de la variable d&apos;environnement `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED` .

    * Nous ne recommandons pas de configurer au-delà de 10 000. Le serveur limitera les données à 10 000 par minute.

    * Si vous configurez l&apos;agent pour [monitoring de l&apos;IA](/docs/ai-monitoring/intro-to-ai-monitoring/), nous vous recommandons de définir la valeur sur `10000`.

      <Callout variant="important">
        Cette option configuration est uniquement disponible dans l&apos;agent .NET v9.0 ou supérieur.
      </Callout>
  </Collapser>

  <Collapser id="span-attributes" title="attributes">
    Utilisez ce sous-élément pour personnaliser les paramètres d’attributs de votre agent pour l’événement span. Ce sous-élément utilise les mêmes paramètres que l’élément principal `attributes` : [`enabled`](#agent-attributes-enabled), [`include`](#agent-attributes-include) et [`exclude`](#agent-attributes-exclude).

    <Callout variant="tip">
      Ces paramètres d&apos;attribut sont spécifiques à l&apos;événement span. les paramètres d&apos;attribut peuvent être appliqués globalement à tous les types d&apos;événements [avec ce paramètre configuration ](/docs/agents/net-agent/configuration/net-agent-configuration#agent-attributes).
    </Callout>
  </Collapser>
</CollapserGroup>

### Capturer les en-têtes de requête HTTP [#capture\_http\_request\_headers][#capture_http_request_headers]

L&apos;élément `allowAllHeaders` est un enfant de l&apos;élément `configuration`. Définissez cette valeur sur `true` pour permettre à l&apos;agent .NET de capturer tous les en-têtes de requête HTTP et de les appliquer à l&apos;événement `Span` et `Transaction` en tant qu&apos;attribut `request.headers.{http-header-name}`. Définissez cette valeur sur `false` pour autoriser uniquement l&apos;agent .NET à collecter les en-têtes de requête HTTP suivants :

* `request.headers.referer`
* `request.headers.accept`
* `request.headers.content-length`
* `request.headers.host`
* `request.headers.user-agent`

<CollapserGroup>
  <Collapser id="allow-all-headers-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>

    Activer ou désactiver la capture des en-têtes de requête HTTP. Exemple:

    Vous pouvez également définir la variable d&apos;environnement `NEW_RELIC_ALLOW_ALL_HEADERS` dans l&apos;environnement de l&apos;application :

    ```xml
    <allowAllHeaders enabled="true" />
    <attributes enabled="true">
       <include>request.headers.*</include>
    </attributes>
    ```
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Le paramètre `allowAllHeaders` est uniquement disponible dans la version 8.40.0+ de l&apos;agent .NET. Lorsque vous utilisez `allowAllHeaders` pour capturer l&apos;attribut, l&apos;attribut d&apos;en-tête de demande capturé est toujours contrôlé par les paramètres [d&apos;attribut](/docs/agents/net-agent/configuration/net-agent-configuration/#agent-attributes) de niveau racine et de niveau de destination. Sans définir le `request.header.*` dans la liste `include` sous l&apos;élément `attributes` (voir ci-dessous), l&apos;agent .NET filtre toujours tous les attributs d&apos;en-tête. La valeur par défaut `newrelic.config` est définie pour inclure le `request.header.*`.

  ```xml
  <allowAllHeaders enabled="true" />
  <attributes enabled="true">
    <include>request.headers.*</include>
    ...
  </attributes>
  ```

  La valeur par défaut `newrelic.config` est également définie pour exclure explicitement les en-têtes de requête HTTP suivants afin d’empêcher l’agent .NET de collecter des données indésirables.

  ```xml
  <attributes enabled="true">
    <exclude>request.headers.cookie</exclude>
    <exclude>request.headers.authorization</exclude>
    <exclude>request.headers.proxy-authorization</exclude>
    <exclude>request.headers.x-*</exclude>
  </attributes>
  ```
</Callout>

### Logging des applications [#application\_logging][#application_logging]

<Callout variant="important">
  Ces options de configuration sont disponibles uniquement avec les versions 9.7.1 et supérieures de l&apos;agent .NET. Les options liées aux données de contexte (attribut personnalisé) ne sont disponibles que dans les versions agent .NET 10.4.0 et supérieures.
</Callout>

L&apos;élément `applicationLogging` est un enfant de l&apos;élément `configuration` . Utilisez `applicationLogging` pour configurer l’instrumentation de l’activité de logging de votre application.

Il existe trois sous-fonctionnalités principales :

1. Métriques : collectez des métriques sur le nombre total de lignes log écrites par cycle de collecte (`Logging/lines`), ainsi que le nombre de lignes log écrites à des niveaux de logging particuliers (par exemple, `Logging/lines/ERROR`).

2. transfert de logs : lorsqu&apos;il est activé, l&apos;agent capture les données log et les envoie à New Relic.

   * Données de contexte (via [`AddCustomAttribute`](/docs/apm/agents/net-agent/net-agent-api/itransaction/#addcustomattribute)) : lorsqu&apos;elles sont activées, l&apos;agent capture et transmet tout attribut log personnalisé. Les `include` `exclude` éléments et sont des listes séparées par des virgules de noms d&apos;attributs à inclure ou à exclure, suivant les [mêmes règles](/docs/apm/agents/net-agent/attributes/enable-disable-attributes-net/#attruls) que les autres agent d&apos;attributs configuration. Ils sont tous deux vides par défaut, ce qui entraîne la capture et la transmission de toutes les données de contexte log .
   * Filtrage des niveaux de log : lorsqu&apos;il est configuré avec un ou plusieurs niveaux de log dans une liste séparée par des virgules, l&apos;agent empêchera la capture et la transmission des messages à ces niveaux.
   * Étiquettes : lorsque cette option est activée, l’ agent ajoute des étiquettes personnalisées au log transféré par agent . Vous pouvez utiliser l&apos;attribut `exclude`, qui est une liste de noms d&apos;étiquettes séparés par des virgules et ne respectant pas la casse. Par défaut, l&apos;agent ajoute des étiquettes personnalisées lorsque l&apos;attribut `exclude` est vide.

3. Décoration log local : lorsqu&apos;elle est activée, votre log existant sera décoré avec des métadonnées qui relient le log à d&apos;autres données New Relic, telles que les erreurs.

Pour plus de détails, consultez [notre documentation sur l’utilisation des logs agent .NET dans contexte](/docs/logs/logs-context/net-configure-logs-context-all).

```xml
<applicationLogging enabled="true">
  <metrics enabled="true" />
  <forwarding enabled="true" maxSamplesStored="10000" logLevelDenyList="">
    <contextData enabled="false" include="" exclude="" />
    <labels enabled="false" exclude="" />
  </forwarding>
  <localDecorating enabled="false" />
</applicationLogging>
```

Ces fonctionnalités peuvent également être configurées via des variables d&apos;environnement :

```ini
NEW_RELIC_APPLICATION_LOGGING_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_INCLUDE="myCustomAttribute1, myOtherCustomAttribute*"
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_EXCLUDE="myCustomAttribute2, myOtherCustomAttributeMoreSpecificName"
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED=10000
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LOG_LEVEL_DENYLIST="debug, warn"
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_ENABLED=true
NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_EXCLUDE="label1, label2"
NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED=true
```

L&apos;élément `applicationLogging` prend en charge l&apos;attribut et les sous-éléments suivants :

<CollapserGroup>
  <Collapser id="applog-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>
      </tbody>
    </table>

    Activez ou désactivez toutes les fonctionnalités instrumentation de logging. Si `true`, la configuration de sous-fonctionnalité individuelle prend effet. Si `false`, aucune fonctionnalité d’instrumentation de logging n’est activée.

    Ou utilisez la variable d’environnement `NEW_RELIC_APPLICATION_LOGGING_ENABLED` .
  </Collapser>

  <Collapser id="applog-metrics" title="metrics">
    Utilisez ce sous-élément pour activer la collecte de métriques de logging (telles que `Logging/lines`) pour le framework de logging .NET commun. La valeur par défaut de l&apos;attribut `enabled` est `true`.

    Ou utilisez la variable d’environnement `NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED` .
  </Collapser>

  <Collapser id="applog-forwarding" title="forwarding">
    Utilisez ce sous-élément pour activer la transmission du log de votre application vers New Relic. La valeur par défaut de l&apos;attribut `enabled` est `true`, vous pouvez également utiliser la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED` .

    La valeur par défaut de l&apos;attribut `maxSamplesStored` est `10000`, vous pouvez également utiliser la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED` pour ce paramètre. Définissez cette valeur sur une valeur inférieure pour réduire la quantité de lignes log envoyées (peut provoquer un échantillonnage log ). Définissez cette valeur sur une valeur plus élevée pour envoyer plus de lignes log .

    Chaque log reçoit la même priorité que sa transaction associée. Les logs qui se produisent en dehors d&apos;une transaction recevront une priorité aléatoire. Certains logs peuvent ne pas être inclus car ils sont limités par `maxSamplesStored`. Par exemple, si le logging `maxSamplesStored` est définie sur 10 000 et que la transaction 1 comporte 10 000 entrées log, seules les entrées log de la transaction 1 seront enregistrées. Si la transaction 1 contient moins de 10 000 logs, vous recevez tous les logs de la transaction 1. S&apos;il reste de la place, vous recevez l&apos;intégralité du log de la transaction 2, et ainsi de suite.

    Si après tout le log des transactions échantillonnées est enregistré et qu&apos;elles n&apos;ont pas atteint la limite de `maxSamplesStored`, alors les messages du log des transactions qui ne figuraient pas dans notre échantillonnage sont envoyés. S&apos;il en reste, les messages de log en dehors des transactions sont enregistrés.

    Utilisez l&apos;attribut `logLevelDenyList` (ou la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LOG_LEVEL_DENYLIST`) pour filtrer les messages de log du niveau de log spécifié. La valeur de cet attribut est une liste de niveaux séparés par des virgules et ne respectant pas la casse. En dehors du cas, la chaîne de niveau de log doit correspondre exactement au niveau de log filtré, les caractères génériques et les expressions régulières ne sont pas pris en charge. Par exemple, si la valeur a été définie sur `logLevelDenyList="debug,warn"`, tout message de log avec un niveau de log de `Debug` ou `Warn` ne sera pas capturé ou transmis, mais un log avec un niveau de `Warning` sera toujours envoyé à New Relic.

    <Callout variant="caution">
      Si vous envoyez déjà le log de votre application à New Relic à l&apos;aide d&apos;une solution de transfert de logexistante, assurez-vous de la désactiver avant d&apos;activer le transfert de logdans l&apos;agent, afin d&apos;éviter d&apos;être facturé pour les données log en double.
    </Callout>
  </Collapser>

  <Collapser id="contextData" title="contextData (attribut personnalisé)">
    Utilisez ce sous-élément, qui est un enfant de l&apos;élément `forwarding`, pour configurer la capture et la transmission des données de contexte de logging ([attribut personnalisé](/docs/apm/agents/net-agent/net-agent-api/itransaction/#addcustomattribute)), dans les versions agent 10.4.0 et supérieures.

    Définissez l&apos;attribut `enabled` sur `true` pour activer la capture et la transmission des données de contexte de logging vers New Relic, vous pouvez également utiliser la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_ENABLED`. La valeur par défaut est `false`.

    L&apos;attribut `include` est une liste séparée par des virgules de noms d&apos;attributs à inclure lorsque la capture de données contextuelles est activée, vous pouvez également utiliser la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_INCLUDE`. La valeur par défaut est une chaîne vide, ce qui signifie « tout inclure ».

    L&apos;attribut `exclude` est une liste séparée par des virgules de noms d&apos;attributs à exclure lorsque la capture de données contextuelles est activée, vous pouvez également utiliser la variable d&apos;environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CONTEXT_DATA_EXCLUDE`. La valeur par défaut est une chaîne vide, ce qui signifie « ne rien exclure ».

    Les listes d&apos;inclusion et d&apos;exclusion suivent les [mêmes règles de priorité que les autres agent d&apos;attributs configuration](/docs/apm/agents/net-agent/attributes/enable-disable-attributes-net/#attruls).
  </Collapser>

  <Collapser id="labels" title="labels (tags)">
    Utilisez ce sous-élément, qui est un enfant de l&apos;élément `forwarding`, pour configurer l&apos;ajout de vos [étiquettes (tag)](/docs/apm/agents/net-agent/configuration/net-agent-configuration/#labels-tags) au log transféré agent, dans les versions agent 10.34.0 et supérieures.

    Définissez l’attribut `enabled` sur `true` pour permettre l’ajout de vos étiquettes au log transmis agent . Vous pouvez également utiliser la variable d’environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_ENABLED`. La valeur par défaut est `false`.

    L&apos;attribut `exclude` est une liste de noms d&apos;étiquettes séparés par des virgules, insensible à la casse, à exclure lorsque vous activez les étiquettes. Vous pouvez également utiliser la variable d’environnement `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_EXCLUDE`. La valeur par défaut est une chaîne vide, ce qui signifie « ne rien exclure ». Cet attribut ne prend pas en charge les caractères génériques ni les expressions régulières.
  </Collapser>

  <Collapser id="localDecorating" title="Décoration logs locaux">
    Utilisez ce sous-élément pour activer la décoration du log de votre application avec les métadonnées de liaison New Relic . La valeur par défaut de l&apos;attribut `enabled` est `false`. Certaines modifications configuration supplémentaires sont requises pour la décoration log locaux, veuillez consulter [.NET : Configurer les logs en contexte](/docs/logs/logs-context/net-configure-logs-context-all#2-decorate) pour plus d&apos;informations.
  </Collapser>
</CollapserGroup>

### Métriques au niveau du code [#code\_level\_metrics][#code_level_metrics]

L&apos;élément `codeLevelMetrics` est un enfant de l&apos;élément `configuration` . Utilisez `codeLevelMetrics` pour activer la prise en charge du niveau du code métrique dans CodeStream via des métadonnées de méthode instrumentale supplémentaires capturées en tant qu&apos;attribut sur l&apos;événement span.

Pour plus de détails, consultez notre documentation sur [l&apos;intégration de New Relic CodeStream](/docs/apm/agents/net-agent/other-features/net-codestream-integration).

```xml
<codeLevelMetrics enabled="true" />
```

Cela peut également être configuré via une variable d&apos;environnement :

```ini
NEW_RELIC_CODE_LEVEL_METRICS_ENABLED=true
```

### Fournisseur de cloud modifié [#cloud]

L&apos;élément `cloud` est un enfant de l&apos;élément `configuration` . Utilisez `cloud` pour configurer les métadonnées du fournisseur de cloud pour votre application.

L&apos;élément `cloud` prend en charge les sous-éléments suivants :

<CollapserGroup>
  <Collapser id="cloud-aws" title="aws">
    Utilisez ce sous-élément pour configurer l’ID de compte AWS pour votre application.

    <Callout variant="important">
      Notez que cette configuration n&apos;est normalement pas requise, car l&apos;agent détectera automatiquement l&apos;ID de compte AWS lors de l&apos;exécution. Si la détection automatique ne fonctionne pas, l&apos;agent reviendra à la valeur configurée ici.
    </Callout>

    ```xml
    <cloud>
      <aws accountId="123456789012" />
    </cloud>
    ```

    Cela peut également être configuré via une variable d&apos;environnement :

    ```ini
    NEW_RELIC_CLOUD_AWS_ACCOUNT_ID=123456789012
    ```
  </Collapser>
</CollapserGroup>

### Monitoring de l&apos;IA [#ai\_monitoring][#ai_monitoring]

Par défaut, monitoring de l&apos;IA est désactivée. Pour activer monitoring de l&apos;IA, définissez l&apos;attribut `enabled` sur `true` dans l&apos;élément `aiMonitoring`. L&apos;élément `aiMonitoring` est un enfant de l&apos;élément `configuration` .

<Callout variant="important">
  Lorsque cette option est activée, le monitoring de l&apos;IA enregistrera une copie en continu des entrées et des sorties envoyées vers et depuis les modèles que vous choisissez de monitorer, y compris toutes les informations personnelles qu&apos;ils contiennent. Lorsque vous utilisez la fonctionnalité de monitoring de l&apos;IA, vous êtes responsable d&apos;obtenir le consentement de l&apos;utilisateur de votre modèle pour que son interaction puisse être enregistrée par un tiers (New Relic) dans le but de fournir la fonctionnalité de monitoring de l&apos;IA.
</Callout>

```xml
<aiMonitoring enabled="true" />
```

Cela peut également être configuré via une variable d&apos;environnement :

```ini
NEW_RELIC_AI_MONITORING_ENABLED=true
```

L&apos;élément `aiMonitoring` prend en charge les sous-éléments suivants :

<CollapserGroup>
  <Collapser id="aiMonitoring_recordContent" title="recordContent">
    Utilisez ce sous-élément pour permettre à toutes les entrées et sorties de l&apos;événement LLM d&apos;être envoyées à New Relic. La valeur par défaut de l&apos;attribut `enabled` est `true`. L&apos;enregistrement de contenu est désactivé en mode haute sécurité.

    Notez que si l&apos;enregistrement de contenu est désactivé, le comptage des jetons LLM doit être fourni par les clients, en appelant l&apos;[API`SetLlmTokenCountingCallback` ](/docs/agents/net-agent/net-agent-api/setllmtokencountingcallback-net-agent-api). Si ce rappel n&apos;est pas fourni, l&apos;agent ne pourra pas fournir le comptage des jetons LLM.

    ```xml
    <aiMonitoring enabled="true">
      <recordContent enabled="false" />
    </aiMonitoring>
    ```

    Cela peut également être configuré via une variable d&apos;environnement :

    ```ini
    NEW_RELIC_AI_MONITORING_RECORD_CONTENT_ENABLED=false
    ```
  </Collapser>
</CollapserGroup>

## Paramètres dans app.config ou web.config [#app-config-settings]

Pour les applications de console ASP.NET et .NET Framework, vous pouvez également configurer les paramètres suivants dans `app.config` ou `web.config` de votre application, dans l&apos;élément le plus externe, `<configuration>`:

<CollapserGroup>
  <Collapser id="app-cfg-agent-enabled" title="Activer et désactiver l'agent">
    ```xml
    <appSettings>
       <add key="NewRelic.AgentEnabled" value="false" />
    </appSettings>
    ```

    <Callout variant="important">
      Si l&apos;agent est désactivé dans le `newrelic.config` local ou global, les paramètres `NewRelic.AgentEnabled` de ces fichiers n&apos;activeront **pas** l&apos;agent.
    </Callout>
  </Collapser>

  <Collapser id="app-cfg-application-name" title="Nom de l'application">
    Pour plus d’informations, voir [Nommer votre application .NET](/docs/agents/net-agent/installation-configuration/name-your-net-application).

    ```xml
    <appSettings>
      <add key="NewRelic.AppName" value="Descriptive Name" />
    </appSettings>
    ```
  </Collapser>

  <Collapser id="app-cfg-license-key" title="Clé de licence">
    ```xml
    <appSettings>
      <add key="NewRelic.LicenseKey" value="YOUR_LICENSE_KEY" />
    </appSettings>
    ```
  </Collapser>

  <Collapser id="app-cfg-labels" title="Étiquettes">
    ```xml
    <appSettings>
      <add key="NewRelic.Labels" value="key1:value1;key2:value2" />
    </appSettings>
    ```
  </Collapser>

  <Collapser id="app-cfg-location" title="Modifier l'emplacement de newrelic.config">
    Désigne un emplacement alternatif pour le fichier de configuration en dehors de la racine locale de l&apos;application ou de l&apos;emplacement de configuration globale. L&apos;emplacement saisi doit être un chemin absolu.

    ```xml
    <appSettings>
      <add key="NewRelic.ConfigFile" value="C:\Path-to-alternate-config-dir\newrelic.config" />
    </appSettings>
    ```
  </Collapser>
</CollapserGroup>

## Paramètres dans appsettings.json [#appsettings-json]

Pour les applications .NET Core, vous pouvez configurer les paramètres suivants dans `appsettings.json` si ce qui suit est vrai :

* Le fichier `appsettings.json` doit être situé dans le répertoire de travail actuel de l&apos;application.

* La application doit avoir la dépendance suivante :

  * [`Microsoft.Extensions.Configuration`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration)
  * [`Microsoft.Extensions.Configuration.Json`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.Json)
  * [`Microsoft.Extensions.Configuration.EnvironmentVariables`](https://www.nuget.org/packages/Microsoft.Extensions.Configuration.EnvironmentVariables)

<CollapserGroup>
  <Collapser id="appsettings-json-agent-enabled" title="Activer et désactiver l'agent">
    ```json
    {
       "NewRelic.AgentEnabled":"false"
    }
    ```

    <Callout variant="important">
      Si l&apos;agent est désactivé dans le `newrelic.config` local ou global, les paramètres `NewRelic.AgentEnabled` de ces fichiers activeront l&apos;agent.
    </Callout>
  </Collapser>

  <Collapser id="appsettings-json-application-name" title="Nom de l'application">
    Pour plus d’informations, voir [Nommer votre application .NET](/docs/agents/net-agent/installation-configuration/name-your-net-application).

    ```json
    {
      "NewRelic.AppName": "Descriptive Name"
    }
    ```
  </Collapser>

  <Collapser id="appsettings-json-application-license-key" title="Clé de licence">
    ```json
    {
      "NewRelic.LicenseKey": "YOUR_LICENSE_KEY"
    }
    ```
  </Collapser>

  <Collapser id="appsettings-json-labels" title="Étiquettes">
    ```json
    {
      "NewRelic.Labels": "key1:value1;key2:value2"
    }
    ```
  </Collapser>

  <Collapser id="appsettings-json-location" title="Modifier l'emplacement de newrelic.config">
    Désigne un emplacement alternatif pour le fichier de configuration en dehors de la racine locale de l&apos;application ou de l&apos;emplacement de configuration globale. L&apos;emplacement saisi doit être un chemin absolu.

    ```json
    {
      "NewRelic.ConfigFile": "C:\Path-to-alternate-config-dir\newrelic.config"
    }
    ```
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Pour [les applications ASP.NET Core](https://asp.net/), l&apos;agent .NET lira à partir de `appsettings.{environment}.json` si vous définissez la variable `ASPNETCORE_ENVIRONMENT`.
</Callout>