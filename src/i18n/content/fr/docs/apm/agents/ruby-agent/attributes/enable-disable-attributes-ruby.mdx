---
title: Activer et désactiver l'attribut (Ruby)
tags:
  - Agents
  - Ruby agent
  - Attributes
metaDescription: 'How to include and exclude specific attributes for your New Relic Ruby agent, including properties and rules.'
freshnessValidatedDate: never
translationType: machine
---

Ceci décrit les propriétés permettant d&apos;activer ou de désactiver [l&apos;attribut](/docs/apm/agents/ruby-agent/attributes/ruby-agent-attributes), ainsi que les règles que New Relic utilise pour déterminer l&apos;attribut à inclure ou à exclure pour une [destination](/docs/agents/manage-apm-agents/agent-data/agent-attributes#destinations). Cela inclut également un résumé des propriétés de l&apos;agent Ruby qui ont été déconseillées ou supprimées avec la sortie de l&apos;attribut de l&apos;agent New Relic.

## Propriétés

Utilisez les propriétés suivantes pour activer ou désactiver l’attribut :

<CollapserGroup>
  <Collapser id="attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, active la capture de l&apos;attribut pour toutes les destinations.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-enabled" title="transaction_tracer.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut à partir de la trace de transaction.
  </Collapser>

  <Collapser id="transaction_events-attributes-enabled" title="transaction_events.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut de l&apos;événement de transaction.
  </Collapser>

  <Collapser id="error_collector-attributes-enabled" title="error_collector.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut de la collection d&apos;erreurs.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-enabled" title="browser_monitoring.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos;agent capture l&apos;attribut de <InlinePopover type="browser" />.
  </Collapser>

  <Collapser id="span-events-attributes-enabled" title="span_events.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos;agent capture l&apos;attribut lors de l&apos;événement span.
  </Collapser>

  <Collapser id="transaction-segments-attributes-enabled" title="transaction_segments.attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (Dynamique)
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos;agent capture l&apos;attribut sur les segments de transaction.
  </Collapser>

  <Collapser id="attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de toutes les destinations. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-exclude" title="transaction_tracer.attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de la trace de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction_events-attributes-exclude" title="transaction_events.attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de l&apos;événement de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="error_collector-attributes-exclude" title="attribut_collecteur_erreur.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe de l&apos;attribut à exclure de la collecte des erreurs. Autorise `*` comme caractère générique à la fin.

    Pour éviter la collecte de [error.message](/attribute-dictionary?attribute_name=error.message) , utilisez plutôt la [strip\_exception\_messages](/docs/agents/ruby-agent/configuration/ruby-agent-configuration#strip_exception_messages-enabled) configuration.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-exclude" title="browser_monitoring.attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe de l&apos;attribut à exclure de <InlinePopover type="browser" />. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="span-events-attributes-exclude" title="span_events.attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de l&apos;événement span. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction-segments-attributes-exclude" title="transaction_segments.attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure des segments de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans toutes les destinations. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-include" title="transaction_tracer.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans la trace de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction_events-attributes-include" title="transaction_events.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans l&apos;événement de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="error_collector-attributes-include" title="error_collector.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans la collection d&apos;erreurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-include" title="browser_monitoring.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans monitoring des navigateurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="span-events-attributes-include" title="span_events.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans l&apos;événement span. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="transaction-segments-attributes-include" title="transaction_segments.attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            Variable d&apos;environnement
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans les segments de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>
</CollapserGroup>

## Règles d&apos;attribut [#attruls]

New Relic suit ces règles pour déterminer quel attribut inclure ou exclure pour une destination.

<CollapserGroup>
  <Collapser id="rule-root-precedence" title="Le niveau racine est prioritaire pour l'activation.">
    Le champ `attributes.enabled` l&apos;emporte sur tous les autres paramètres. Lorsque `false`, aucun attribut ne sera signalé à New Relic.

    Exemple de configuration :

    ```yml
    attributes.enabled: false
        attributes.include: foo, bar
        transaction_tracer.attributes.enabled: true
    ```

    Exemple de sortie :

    ```
    Keys passed in: foo, bar, baz
        Keys included for all destinations:
        Keys excluded for all destinations: foo, bar, baz
    ```
  </Collapser>

  <Collapser id="rule-destination-precedence" title="La destination activée a priorité sur l'inclusion et l'exclusion.">
    Les indicateurs `YOUR_DESTINATION.attributes.enabled` ont priorité sur les clés d&apos;inclusion et d&apos;exclusion.

    Exemple de configuration :

    ```yml
    transaction_tracer.attributes.enabled: false
        attributes.include: one, two
        transaction_tracer.attributes.include: three, four
    ```

    Exemple de sortie :

    ```
    Keys passed in: one, two, three, four
        Keys included for transaction traces:
        Keys excluded for transaction traces: one, two, three, four
    ```
  </Collapser>

  <Collapser id="rule-included-destination" title="L'attribut est inclus si la destination est activée.">
    Si une destination est activée, tous les attributs utilisateur sont envoyés à cette destination par défaut.

    <DNT>**Note:**</DNT> Tous les attributs utilisateur sont par défaut `true`. Cependant, par défaut, les paramètres de demande sont désactivés pour toutes les destinations.

    Exemple de configuration :

    ```yml
    attributes.enabled: true
        attributes.exclude: baz
    ```

    Exemple de sortie :

    ```
    Keys passed in: foo, bar, baz
        Keys included: foo, bar
        Keys excluded: baz
    ```
  </Collapser>

  <Collapser id="rule-exclude-wins" title="Exclure remplace toujours inclure.">
    Si la même clé est répertoriée dans les listes d&apos;inclusion et d&apos;exclusion, l&apos;attribut avec la clé spécifiée sera exclu.

    Exemple de configuration :

    ```yml
    attributes.enabled: true
        attributes.include: foo, bar
        attributes.exclude: nerd, bar
    ```

    Exemple de sortie :

    ```
    Keys passed in: foo, bar, nerd
        Keys included: foo
        Keys excluded: nerd, bar
    ```
  </Collapser>

  <Collapser id="rule-keys-case-sensitive" title="Les clés sont sensibles à la casse.">
    Les clés sont sensibles à la casse.

    Exemple de configuration :

    ```yml
    attributes.enabled: true
        attributes.exclude: username, UsErNaMe
    ```

    Exemple de sortie :

    ```
    Keys passed in: username, Username, USERNAME, UsErNaMe, userNAME
        Keys included: Username, USERNAME, userNAME
        Keys excluded: username, UsErNaMe
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>Utilisez <InlineCode>
      \*
    </InlineCode> pour les caractères génériques.</>
    }
  >
    Vous pouvez utiliser un astérisque `*` à la fin d&apos;une clé comme caractère générique. Cela correspondra à un ensemble d’attributs avec le même préfixe.

    Exemple de configuration :

    ```yml
    attributes.enabled: true
        attributes.include: custom*
        attributes.exclude: request.parameters.*
    ```

    Exemple de sortie :

    ```
    Keys passed in: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
        Keys included: custom, custom.key1, custom.key2
        Keys excluded: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser id="rule-specific-wins" title="Le réglage le plus spécifique pour une clé est prioritaire.">
    Si plusieurs attributs d&apos;inclusion ou d&apos;exclusion affectent la même clé, le paramètre le plus spécifique aura la priorité.

    Exemple de configuration :

    ```yml
    attributes.enabled: true
        attributes.include: request.parameters.foo
        attributes.exclude: request.parameters.*
    ```

    Exemple de sortie :

    ```
    Keys passed in: request.parameters., request.parameters.foo, request.parameters.bar
        Keys included: request.parameters.foo
        Keys excluded: request.parameters., request.parameters.bar
    ```
  </Collapser>

  <Collapser id="rule-destination-include-exclude" title="Inclure ou exclure affecte la destination spécifique.">
    Si l&apos;attribut include ou exclude est spécifié sur une destination, il n&apos;impacte que cette destination.

    Exemple de configuration :

    ```yml
    attributes.include: foo
        transaction_events.attributes.exclude: foo
    ```

    Exemple de sortie :

    ```
    Keys passed in: foo
        Keys included for transaction events:
        Keys included for other destinations: foo
        Keys excluded for transaction events: foo
    ```
  </Collapser>
</CollapserGroup>

## Propriétés liées à l&apos;URI [#uri]

Par défaut, l&apos;agent Ruby signale les identifiants de ressources uniformes (URI) à New Relic à plusieurs endroits différents, notamment les destinations suivantes :

* L&apos;attribut `request.uri` de [l&apos;événement d&apos;erreur](/docs/apm/applications-menu/error-analytics/error-analytics-manage-error-traces)
* L&apos;attribut `http.url` de [span événement](/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing)
* L&apos;attribut `url` de [la trace SQL lente](/docs/apm/applications-menu/monitoring/view-slow-query-details)
* L&apos;attribut `uri` des [segments de requête externes](/docs/agents/ruby-agent/features/http-client-tracing-ruby)

New Relic recommande de signaler ces URI, car ils peuvent contenir des informations de débogage utiles. Si vos URI contiennent des données sensibles que vous ne souhaitez pas signaler, telles que des adresses e-mail ou des identifiants de compte, vous pouvez désactiver la création de rapports d&apos;URI. Pour désactiver le rapport d&apos;URI, ajoutez l&apos;un des noms d&apos;attribut ci-dessus à la liste `attributes.exclude` .

Par exemple, l’ajout de la clé suivante à votre fichier de configuration empêchera l’agent de signaler l’une des propriétés liées à l’URI :

```yml
attributes.exclude: uri
```

## Propriétés obsolètes et supprimées [#deprecated]

Les propriétés suivantes ont été obsolètes ou supprimées. Passez à la nouvelle configuration d’attribut pour ces propriétés lors de la mise à niveau de votre agent Ruby .

<table>
  <thead>
    <tr>
      <th width={200}>
        <DNT>
          **Deprecated property**
        </DNT>
      </th>

      <th>
        <DNT>
          **New property**
        </DNT>
      </th>

      <th>
        <DNT>
          **Removed Version**
        </DNT>
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `capture_params`
      </td>

      <td>
        `attributes.include: request.parameters.*`
      </td>

      <td>
        N/A
      </td>
    </tr>

    <tr>
      <td>
        `resque.capture_params`
      </td>

      <td>
        `attributes.include: job.resque.args.*`
      </td>

      <td>
        9.0.0
      </td>
    </tr>

    <tr>
      <td>
        `sidekiq.capture_params`
      </td>

      <td>
        `attributes.include: job.sidekiq.args.*`
      </td>

      <td>
        9.0.0
      </td>
    </tr>

    <tr>
      <td>
        `transaction_tracer.capture_attributes`
      </td>

      <td>
        `transaction_tracer.attributes.enabled`
      </td>

      <td>
        9.0.0
      </td>
    </tr>

    <tr>
      <td>
        `error_collector.capture_attributes`
      </td>

      <td>
        `error_collector.attributes.enabled`
      </td>

      <td>
        9.0.0
      </td>
    </tr>

    <tr>
      <td>
        `browser_monitoring.capture_attributes`
      </td>

      <td>
        `browser_monitoring.attributes.enabled`
      </td>

      <td>
        9.0.0
      </td>
    </tr>

    <tr>
      <td>
        `analytics_events.capture_attributes`
      </td>

      <td>
        `transaction_events.attributes.enabled`
      </td>

      <td>
        9.0.0
      </td>
    </tr>
  </tbody>
</table>