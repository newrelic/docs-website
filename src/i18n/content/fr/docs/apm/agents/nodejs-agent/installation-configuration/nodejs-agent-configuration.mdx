---
title: Configuration de l'agent Node.js
tags:
  - Agents
  - Nodejs agent
  - Installation and configuration
metaDescription: 'For New Relic''s Node.js agent: how to set configuration using your config file, environment variables, or server-side config.'
freshnessValidatedDate: never
translationType: machine
---

Vous pouvez adapter l&apos;agent Node.js aux exigences de votre application en modifiant votre fichier de configuration `newrelic.js` ou en définissant une variable d&apos;environnement. Le fichier de configuration réside dans le répertoire racine de votre application. Vous pouvez également configurer quelques options depuis New Relic, ou utiliser [Node.js API l&apos;agent](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api) d&apos; .

## Démarrer [#requirements]

Vous pourrez configurer notre agent Node.js en fonction de votre environnement après avoir [créé un compte New Relic](https://newrelic.com/signup) (c&apos;est gratuit, pour toujours) et [installé l&apos;agent Node.js.](/docs/apm/agents/nodejs-agent/installation-configuration/install-nodejs-agent/)

Le paramètre [`license_key`](#license) est obligatoire. De plus, nous vous recommandons vivement de définir le [`app_name`](#app_name) afin que votre application ait un [nom significatif](/docs/apm/new-relic-apm/installation-configuration/name-your-application) au lieu du `My Application` par défaut.

## Méthodes de configuration et priorité [#methods-and-precedence]

La principale méthode pour configurer l’agent Node.js est le fichier de configuration de l’agent (`newrelic.js`). Vous pouvez également configurer la plupart des paramètres avec [des variables d&apos;environnement](#environment). Vous pouvez également ajuster certains paramètres avec [la configuration côté serveur](#server-side).

L&apos;agent Node.js utilise cet ordre de priorité pour les méthodes de configuration :

<img title="Node.js agent configuration precedence" alt="Node.js agent configuration precedence" src="/images/apm_diagram_nodejs-agent-configuration-hierarchy.webp" />

<figcaption>
  <DNT>**Node.js configuration hierarchy:**</DNT> Les paramètres de configuration côté serveur remplacent les variables d’environnement. Les variables d’environnement remplacent le fichier de configuration de l’agent. Le fichier de configuration remplace les valeurs par défaut de l&apos;agent.
</figcaption>

Voici des descriptions détaillées de chaque méthode de configuration :

<CollapserGroup>
  <Collapser className="freq-link" id="config_file" title="Fichier de configuration de l'agent">
    Le fichier de configuration (`newrelic.js`) contient tous les paramètres de l&apos;agent Node.js. Lorsque vous [installez l&apos;agent Node.js](/docs/agents/nodejs-agent/installation-configuration/installing-maintaining-nodejs#installing), vous devez copier `newrelic.js` dans le répertoire racine de votre application. La plupart des paramètres sont vides par défaut ; ils héritent leurs valeurs de `config/default.js`.

    Si votre application s&apos;exécute sur CommonJS, modifiez simplement le type de fichier de configuration en (`newrelic.cjs`). Ce type de fichier est pris en charge à partir de [la version 7.5.0](/docs/release-notes/agent-release-notes/nodejs-release-notes/node-agent-7-5-0/) de l&apos;agent Node.js.
  </Collapser>

  <Collapser className="freq-link" id="environment" title="Variables d'environnement">
    Tous les paramètres de configuration dans `newrelic.js` ont des variables d’environnement équivalentes. Ils sont utiles, par exemple, si votre agent s’exécute dans un environnement PaaS tel que Heroku ou Microsoft Azure. Les variables d&apos;environnement de l&apos;agent Node.js commencent toujours par `NEW_RELIC_`.

    Ces variables d&apos;environnement sont documentées ci-dessous sous les options de configuration individuelles sous le nom <DNT>**Environ variable**</DNT>. Il existe également deux paramètres rarement utilisés qui ne peuvent [être configurés que via des variables d&apos;environnement](#environment-variable-overrides). Si vous ne savez pas comment spécifier des types plus complexes en tant que variables d’environnement, [utilisez le guide de référence](#environment-variable-type-reference-guide).

    Si vous utilisez New Relic CodeStream pour monitorer les performances de votre IDE, vous souhaiterez peut-être également [associer un référentiel à vos services](/docs/codestream/observability/repo-association) et [associer des SHA de build ou une balise de sortie à des erreurs](/docs/codestream/observability/error-investigation/#buildsha).
  </Collapser>

  <Collapser className="freq-link" id="server-side" title="Configuration côté serveur">
    Les propriétaires et les administrateurs peuvent afficher et configurer quelques paramètres [directement dans New Relic](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration). Le cas échéant, les étiquettes d&apos; UI pour la configuration côté serveur sont répertoriées dans ce document sous les options de configuration individuelles sous la forme <DNT>**Server-side label**</DNT>.
  </Collapser>
</CollapserGroup>

## Exporter des variables [#exports\_config][#exports_config]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `exports.config = {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="app_name" title="app_name (OBLIGATOIRE)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `"My Application"`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APP_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    Le [nom que New Relic utilise pour identifier votre application](/docs/apm/new-relic-apm/installation-configuration/name-your-application). Par exemple, `app_name: ['MyNodeApp']`. Pour [utiliser plusieurs noms pour votre application](/docs/apm/new-relic-apm/installation-configuration/use-multiple-names-app), spécifiez une liste de noms délimités par des virgules.

    Les données de toutes les applications portant le même nom seront fusionnées dans l&apos;UI New Relic, alors définissez cela avec soin. Nous vous <DNT>**highly recommend**</DNT> de remplacer le nom par défaut par un nom descriptif afin d&apos;éviter toute confusion et toute agrégation involontaire de données.

    <Callout variant="tip">
      Pour [Azure l’utilisateur](/docs/agents/nodejs-agent/hosting-services/nodejs-agent-microsoft-azure), l’ Node.js agent utilisera `APP_POOL_ID` s’il est défini, vous pouvez donc utiliser le nom que vous avez choisi pour votre Azure serveur Web sans le définir deux fois.
    </Callout>
  </Collapser>

  <Collapser id="license" title="license_key (OBLIGATOIRE)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_LICENSE_KEY`
          </td>
        </tr>
      </tbody>
    </table>

    Ce paramètre est obligatoire. Votre New Relic <InlinePopover type="licenseKey" />. Par exemple, `license_key: '40HexadecimalCharacters'`.
  </Collapser>

  <Collapser id="agent-enabled" title="agent_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Définissez sur `false` pour empêcher le démarrage de l&apos;agent. Ceci est utile lorsque le débogage de votre code nécessite la désactivation temporaire de l&apos;agent. Cela empêche l&apos; agent d&apos;amorcer son instrumentation ou de configurer tous ses éléments, ce qui empêche l&apos; agent de démarrer et de se connecter aux serveurs de New Relic.
  </Collapser>

  <Collapser id="allow_all_headers" title="allow_all_headers">
    Si `true`, active la capture de tous les en-têtes HTTP, à l&apos;exception de ceux filtrés par les règles `exclude` . `false`Si, les en-têtes collectés sont limités à ceux définis dans [les attributs de l&apos;agent Node.js](/docs/agents/nodejs-agent/installation-configuration/nodejs-agent-attributes)

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ALLOW_ALL_HEADERS`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
    </Callout>
  </Collapser>

  <Collapser id="compressed_content_encoding" title="compressed_content_encoding">
    Si le seuil de compression des données est atteint dans la charge utile, l&apos;agent compresse les données, en utilisant la compression gzip par défaut. L&apos;option de configuration `compressed_content_encoding` peut être définie sur `deflate` pour utiliser la compression dégonflée.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `gzip`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_COMPRESSED_CONTENT_ENCODING`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="apdex" title="apdex_t (OBSOLÈTE)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Nombre
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `0.100`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Apdex T`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APDEX_T`
          </td>
        </tr>
      </tbody>
    </table>

    Définissez votre Apdex T [via l&apos;UI New Relic](/docs/apm/new-relic-apm/apdex/apdex-measure-user-satisfaction/#apm-apdex).
  </Collapser>

  <Collapser id="certificates" title="certificates">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Éventail de chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CERTIFICATES`
          </td>
        </tr>
      </tbody>
    </table>

    Certificats supplémentaires de confiance pour les connexions SSL, spécifiés sous la forme d&apos;un éventail de chaînes au format PEM. Cela affecte à la fois les connexions à un proxy HTTPS et les connexions à New Relic.

    <Callout variant="tip">
      Vous pouvez également configurer l&apos;agent pour lire ses certificats à partir d&apos;un fichier :

      ```js
      certificates: [ fs.readFileSync('myca.crt', {encoding: 'utf8'}) ]
      ```
    </Callout>
  </Collapser>

  <Collapser id="high_security" title="high_security">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_HIGH_SECURITY`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;il est défini sur `true`, active [la haute sécurité v2](/docs/accounts-partnerships/accounts/security/high-security#version2description). Vous devez également activer le paramètre [`ssl`](#ssl) et [activer la haute sécurité dans l&apos; UI](/docs/accounts-partnerships/accounts/security/high-security#version2enabled).
  </Collapser>

  <Collapser id="host" title="host">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `collector.newrelic.com`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Ne modifiez pas cette valeur à moins que le support New Relic ne vous demande de la modifier.
    </Callout>

    nom d&apos;hôte du [collecteurNew Relic ](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector)pour se connecter à Internet ; par exemple, `host: 'collector.newrelic.com'`.
  </Collapser>

  <Collapser id="labels" title="labels">
    Ajoute [la balise](/docs/apm/new-relic-apm/maintenance/labels-categories-organize-your-apps-servers). Spécifiez votre balise sous forme d&apos;objets ou d&apos;une chaîne délimitée par des points-virgules de paires séparées par des deux-points (par exemple, `Server:One;Data Center:Primary`).

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Objet ou chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_LABELS`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="port" title="port">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `443`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="important">
      Ne modifiez pas cette valeur à moins que le support New Relic ne vous demande de la modifier.
    </Callout>

    Numéro de port pour se connecter au collecteur New Relic ; par exemple, `port: 443`.
  </Collapser>

  <Collapser id="proxy" title="proxy">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_URL`
          </td>
        </tr>
      </tbody>
    </table>

    Une URL spécifiant le serveur proxy pour se connecter à Internet. Par exemple, `proxy: 'http://user:pass@10.0.0.1:8000/'`. Considérations importantes :

    * Le paramètre du fichier de configuration `proxy` remplace les autres paramètres proxy du fichier de configuration (`proxy_host`, `proxy_port`, `proxy_user`, `proxy_pass`) s&apos;ils sont utilisés. De même, la variable d’environnement `NEW_RELIC_PROXY_URL` remplace les autres paramètres de proxy de variable d’environnement (`NEW_RELIC_PROXY_HOST`, `NEW_RELIC_PROXY_PORT`, `NEW_RELIC_PROXY_USER` et `NEW_RELIC_PROXY_PASS`) si elle est utilisée.
    * Si vous utilisez [Infinite Tracing](/docs/distributed-tracing/infinite-tracing/introduction-infinite-tracing): [découvrez comment configurer un proxy pour Infinite Tracing](/docs/distributed-tracing/infinite-tracing/infinite-tracing-configure-proxy-support/#node-php-python-ruby).
  </Collapser>

  <Collapser id="proxy_host" title="proxy_host">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Nom d&apos;hôte ou adresse IP du serveur proxy pour se connecter à Internet.
  </Collapser>

  <Collapser id="proxy_pass" title="proxy_pass">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PASS`
          </td>
        </tr>
      </tbody>
    </table>

    Mot de passe pour l&apos;authentification auprès du serveur proxy. L&apos;agent prend uniquement en charge l&apos;authentification HTTP de base.
  </Collapser>

  <Collapser id="proxy_port" title="proxy_port">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_PORT`
          </td>
        </tr>
      </tbody>
    </table>

    Numéro de port du serveur proxy pour se connecter à Internet.
  </Collapser>

  <Collapser id="proxy_user" title="proxy_user">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROXY_USER`
          </td>
        </tr>
      </tbody>
    </table>

    Nom d&apos;utilisateur pour l&apos;authentification auprès du serveur proxy. L&apos;agent prend uniquement en charge l&apos;authentification HTTP de base.
  </Collapser>
</CollapserGroup>

## Variables de logging [#logging\_config][#logging_config]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `logging: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="log-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true` (`false` dans `serverless_mode`)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou désactive le logging spécifique à l&apos;agent.
  </Collapser>

  <Collapser id="log_level" title="level">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `info`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG_LEVEL`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le niveau de détail enregistré dans les logs de l&apos;agent. Du plus petit détail au plus détaillé, les valeurs possibles sont `fatal`, `error`, `warn`, `info`, `debug` ou `trace`.

    <Callout variant="caution">
      N&apos;utilisez pas le logging `debug` ou `trace` à moins que le support New Relic ne vous demande de les utiliser. Ces niveaux de logging peuvent générer une surcharge excessive. Dans la plupart des situations, utilisez `info`.
    </Callout>
  </Collapser>

  <Collapser id="log" title="chemin de fichier">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `process.cwd()` plus `newrelic_agent.log`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_LOG`
          </td>
        </tr>
      </tbody>
    </table>

    Chemin complet vers le log de l&apos;agent New Relic, y compris le nom du fichier. La valeur par défaut est `filepath: require('path').join(process.cwd(), 'newrelic_agent.log')`. Si l&apos;agent ne peut pas créer le fichier de log, alors il :

    * Enregistre l&apos;erreur `New Relic failed to open log file` en utilisant `console.error`.
    * Met en mémoire tampon tous les messages de log suivants.
    * Lorsque la mémoire tampon atteint sa limite de 128 Mio, l&apos;agent rejette tout nouveau message de log et émet l&apos;avertissement suivant via `process.emitWarning`: `[NRWARN001] NewRelicWarning: Dropping log message, buffer would overflow.`

    Lors de la création du fichier de log, l&apos;agent définit les autorisations du fichier sur 0o600 (lisible/inscriptible par le propriétaire).

    * Pour écrire toute le logging dans <DNT>**stdout**</DNT>, définissez ceci sur `stdout`.
    * Pour écrire toute le logging dans <DNT>**stderr**</DNT>, définissez ceci sur `stderr`.

    <Callout variant="important">
      Dans les versions d&apos;agent antérieures à 7.0.0, l&apos;agent arrêtait le processus s&apos;il ne parvenait pas à créer ce fichier.
    </Callout>
  </Collapser>
</CollapserGroup>

## Monitoring de l&apos;IA [#ai-monitoring]

Cette section comprend la Node.js agent configuration pour la mise en place monitoring de l&apos;IA.

<Callout variant="important">
  Vous devez activer [le tracing distribué](/docs/apm/agents/nodejs-agent/installation-configuration/nodejs-agent-configuration/#dt-main) pour capturer les données AI. Il est activé par défaut dans l&apos;agent Node.js 8.3.0 et supérieur. Si vous avez activé le mode haute sécurité, monitoring de l&apos;IA ne fonctionnera pas.
</Callout>

<Callout variant="important">
  Lorsque cette option est activée, le monitoring de l&apos;IA enregistrera une copie en continu des entrées et des sorties envoyées vers et depuis les modèles que vous choisissez de monitorer, y compris toutes les informations personnelles qu&apos;ils contiennent. Lorsque vous utilisez la fonctionnalité de monitoring de l&apos;IA, vous êtes responsable d&apos;obtenir le consentement de l&apos;utilisateur de votre modèle pour que son interaction puisse être enregistrée par un tiers (New Relic) dans le but de fournir la fonctionnalité de monitoring de l&apos;IA.
</Callout>

<CollapserGroup>
  <Collapser id="ai-monitoring-enabled" title="ai_monitoring.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque défini sur `true`, active monitoring de l&apos;IA. Permet à l&apos;agent de capturer les données d&apos;événement LLM.
  </Collapser>

  <Collapser id="ai-monitoring-streaming" title="ai_monitoring.streaming.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_STREAMING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;il est défini sur `false`, désactive l&apos;instrumentation pour les données LLM diffusées en continu. Défini sur `true`, capture les données diffusées pour l&apos;événement LLM.
  </Collapser>

  <Collapser id="ai-monitoring-record-content" title="ai_monitoring.record_content.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_AI_MONITORING_RECORD_CONTENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si défini sur `false`, agent omet le contenu d&apos;entrée et de sortie (comme les chaînes de texte de l&apos;invite et des réponses) capturées dans l&apos;événement LLM. Il s&apos;agit d&apos;un paramètre de sécurité facultatif si vous ne souhaitez pas enregistrer les données sensibles envoyées et reçues par vos LLM.
  </Collapser>
</CollapserGroup>

## Variables du cloud [#cloud\_config][#cloud_config]

Cette section définit les Node.js agent variables pour créer une relation entre les cloud fournisseurs et APM l&apos;application .

<CollapserGroup>
  <Collapser id="cloud-variables" title="cloud.aws.account_id">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `null`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CLOUD_AWS_ACCOUNT_ID`
          </td>
        </tr>
      </tbody>
    </table>

    L&apos;ID de compte AWS pour le compte AWS associé à cette application.
  </Collapser>
</CollapserGroup>

## Logging d&apos;audit [#audit\_log][#audit_log]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `audit_log: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="audit_log-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;elle est activée, l&apos; agent enregistre les frais qu&apos;il envoie au collecteur. Ces données sont incluses dans le fichier log principal même lorsque le niveau de logging est défini sur le niveau le plus bas.
  </Collapser>

  <Collapser id="endpoints" title="point de terminaison">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]` (inclure tous les types)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_AUDIT_LOG_ENDPOINTS`
          </td>
        </tr>
      </tbody>
    </table>

    L&apos;agent envoie plusieurs types de données différents au collecteur dans des charges séparées. Par défaut, ils sont tous inclus dans le fichier de log. Cette option permet de limiter le logging à des types de données spécifiques uniquement.

    Les valeurs valides incluent :

    * `agent_settings`
    * `analytic_event_data`
    * `connect`
    * `custom_event_data`
    * `error_data`
    * `error_event_data`
    * `metric_data`
    * `preconnect`
    * `shutdown`
    * `span_event_data`
    * `sql_trace_data`
    * `transaction_sample_data`
  </Collapser>
</CollapserGroup>

## API configuration [#api\_config][#api_config]

Cette section vous permet de choisir les méthodes API à activer. Chaque option de configuration vous permet d&apos;activer de manière modulaire les méthodes API responsables de l&apos;envoi d&apos;informations personnalisées à New Relic.

<Callout variant="important">
  Tous ces paramètres sont définis sur `false` lorsque l’agent est en mode haute sécurité.
</Callout>

<CollapserGroup>
  <Collapser id="custom-attributes" title="custom_attributes_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_ATTRIBUTES`
          </td>
        </tr>
      </tbody>
    </table>

    Cette option active [`newrelic.addCustomAttribute`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-param) et [`newrelic.addCustomAttributes`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#add-custom-params).
  </Collapser>

  <Collapser id="custom-events" title="custom_events_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_API_CUSTOM_EVENTS`
          </td>
        </tr>
      </tbody>
    </table>

    Cette option active [`recordCustomEvent`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#record_custom_event).
  </Collapser>

  <Collapser id="notice-error" title="notice_error_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_API_NOTICE_ERROR`
          </td>
        </tr>
      </tbody>
    </table>

    Cette option active [`newrelic.noticeError`](https://newrelic.github.io/node-newrelic/API.html#noticeError).
  </Collapser>
</CollapserGroup>

## Attributs [#node-js-attributes]

Cette section définit les variables des [attributs de l&apos;agent Node.js](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes) dans l&apos;ordre dans lequel elles apparaissent généralement dans la `attributes: {` section du `newrelic.js` configuration fichier de votre application.

<Callout variant="caution">
  Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
</Callout>

<CollapserGroup>
  <Collapser id="attributes_enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, active la capture de l&apos;attribut pour toutes les destinations.
  </Collapser>

  <Collapser id="attributes_exclude" title="exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de toutes les destinations. Autorise `*` comme caractère générique à la fin. Par exemple, dans le fichier de configuration, cela inclurait tous les paramètres sauf `somethingSecret`:

    ```js
    attributes: {
      include: [ 'request.parameters.*' ],
      exclude: [ 'request.parameters.somethingSecret' ]
    }
    ```
  </Collapser>

  <Collapser id="attributes_include" title="include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans toutes les destinations. Autorise `*` comme caractère générique à la fin.

    Par exemple, dans le fichier `config`, cela inclurait tous les paramètres :

    ```js
    attributes: {
      include: [ 'request.parameters.*' ]
    }
    ```

    À l’aide de cet exemple, définissez l’itinéraire Express et l’URL de la demande :

    ```js
    app.get('/api/users/:id', myMiddleware, myController)
    ```

    ```sh
    curl http://localhost:3000/api/users/abc123?id=true
    ```

    Le *paramètre d&apos;itinéraire* est `id` et a une valeur de `abc123`. Cela devient l&apos;attribut `request.parameters.route.id: abc123` sur la transaction, le segment racine et le Span. Cet exemple possède également un *paramètre de requête* de `id`, qui a une valeur de `true`. Cela deviendrait l&apos;attribut `request.parameters.id: true` sur la transaction, le segment racine et l&apos;étendue.
  </Collapser>

  <Collapser id="attributes_include_enabled" title="include_enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ATTRIBUTES_INCLUDE_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque `true`, des modèles peuvent être ajoutés à la liste [`attributes.include`](/docs/agents/nodejs-agent/attributes/nodejs-agent-attributes#cfg-attributes-include).
  </Collapser>
</CollapserGroup>

## Variables du collecteur d&apos;erreurs [#error\_config][#error_config]

Vous pouvez [gérer la manière dont les erreurs sont traitées](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-mark-expected) dans New Relic. Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `error_collector: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="error_collector" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Enable error collection?`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque cette option est activée, l&apos; agent collecte [les traces d&apos;erreur](/docs/apm/applications-menu/events/viewing-apm-errors-error-traces) de votre application.
  </Collapser>

  <Collapser id="error_ignore" title="ignore_status_codes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Éventail d&apos;entiers
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[404]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Ignore these status codes`
          </td>
        </tr>
      </tbody>
    </table>

    Liste délimitée par des virgules de codes d&apos;état HTTP que le collecteur d&apos;erreurs doit ignorer.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="error_ignore_classes" title="ignore_classes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Éventail|Objet
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Liste délimitée par des virgules de types/classes d&apos;erreurs JavaScript que le collecteur d&apos;erreurs doit ignorer.

    La configuration suivante

    ```js
    error_collector: {
        /* ... */
        ignore_classes: ["ReferenceError"]
    }
    ```

    J&apos;ignorerais toutes les erreurs de référence.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="error_ignore_messages" title="ignore_messages">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Objet
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_IGNORE_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    Un objet JavaScript décrivant une liste de classes liées au message d&apos;erreur que le collecteur doit ignorer. La configuration suivante ignorerait toutes les erreurs de type `Error` avec les chaînes de message exactes (sensibles à la casse) de `Undefined` et `Out of time`:

    ```js
    error_collector: {
        /* ... */
        ignore_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Ignorerait toutes les erreurs de type `Error`, avec les chaînes de message exactes (sensibles à la casse) de `Undefined` et `Out of time`.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="expected_status_codes" title="expected_status_codes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Éventail d&apos;entiers
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERROR_CODES`
          </td>
        </tr>
      </tbody>
    </table>

    Liste délimitée par des virgules de codes d&apos;état HTTP que le collecteur d&apos;erreurs doit marquer comme prévu.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="expected_classes" title="expected_classes">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    La configuration suivante

    ```js
    error_collector: {
        /* ... */
        expected_classes: ["ReferenceError"]
    }
    ```

    Marquerait toutes les erreurs de référence comme prévu.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="expected_messages" title="expected_messages">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Objet
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `{}`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES`
          </td>
        </tr>
      </tbody>
    </table>

    Un objet javascript décrivant une liste de classes javascript liées au message d&apos;erreur javascript que le collecteur doit ignorer. La configuration suivante.

    ```js
    error_collector: {
        /* ... */
        expected_messages: {"Error":["Undefined", "Out of time"]}
    }
    ```

    Marquerait toutes les erreurs de type `Error`, avec les chaînes de message exactes (sensibles à la casse) de `Undefined` et `Out of time`.

    <Callout variant="caution">
      Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
    </Callout>
  </Collapser>

  <Collapser id="error_attributes_enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut de la collection d&apos;erreurs.

    <Callout variant="caution">
      Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
    </Callout>
  </Collapser>

  <Collapser id="error_attributes_exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe de l&apos;attribut à exclure de la collecte des erreurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="error_attributes_include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans la collection d&apos;erreurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="error_max_event_samples_stored" title="max_event_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `100`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal d&apos;événements que l&apos; agent collecte par minute. S&apos;il y en a plus que ce nombre, l&apos;agent collecte un échantillon statistique.
  </Collapser>
</CollapserGroup>

## Variables de suivi des transactions [#tx\_tracer\_config][#tx_tracer_config]

L&apos;agent regroupe vos requests en [transactions](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#transaction), qui servent à :

* Visualisez où votre application passe son temps (en répartition des transactions).
* Identifier requests lentes.
* Métriques de groupe.
* Isoler les autres problèmes, tels que [les performances lentes de la base de données](/docs/apm/applications-menu/monitoring/databases-slow-queries-dashboard).

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `transaction_tracer: {` du fichier de configuration `newrelic.js` de votre application.

<Callout variant="important">
  N&apos;utilisez pas de crochets `[suffix]` à la fin du nom de votre transaction. New Relic supprime automatiquement les crochets du nom. Utilisez plutôt des parenthèses `(suffix)` ou d’autres symboles si nécessaire.
</Callout>

<CollapserGroup>
  <Collapser id="tracer_enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_ENABLED`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Enable transaction tracing?`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;elle est activée, l&apos; agent collecte [une trace lente de la transaction](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="explain_threshold" title="explain_threshold">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `500`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_EXPLAIN_THRESHOLD`
          </td>
        </tr>
      </tbody>
    </table>

    Durée minimale de requête (en millisecondes) pour qu&apos;une transaction soit éligible à [une requête lente](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) en [trace de transaction](/docs/apm/transactions/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="record-sql" title="record_sql">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne (`obfuscated`, `off` ou `raw`)
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `obfuscated`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_RECORD_SQL`
          </td>
        </tr>
      </tbody>
    </table>

    Cette option affecte à la fois [la requête lente](#slow-queries) et `record_sql` pour le suivi de transaction. Il peut avoir ces valeurs : `off`, `obfuscated` ou `raw`.

    Si défini sur `off`, aucune requête lente ne sera capturée et les backtraces et SQL ne seront pas inclus dans la trace de transaction. Si défini sur `raw` ou `obfuscated`, l&apos;agent envoie du SQL brut ou obscurci et un échantillon de requête lente au [collecteur](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). L&apos;agent peut également envoyer du SQL lorsque d&apos;autres critères sont remplis, par exemple lorsque `slow_sql.enabled` est défini.
  </Collapser>

  <Collapser id="tracer_top" title="top_n">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `20`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_TOP_N`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal de requests éligibles pour [le suivi de transaction](/docs/apm/transactions/transaction-traces/transaction-traces).

    Les transactions sont nommées en fonction de la demande et `top_n` fait référence aux « n transactions les plus lentes » regroupées par ces noms. Le module remplace une trace enregistrée par une nouvelle trace uniquement si la nouvelle trace est plus lente que la trace la plus lente précédente de ce nom. La valeur par défaut de ce paramètre est `top_n: 20`, car la [page<DNT>**Transactions**</DNT> ](/docs/apm/transactions/transaction-traces/transaction-traces)utilise également par défaut les 20 transactions les plus lentes.

    L&apos;agent Node.js capture au moins cinq transactions lentes différentes lors du premier cycle de collecte après le démarrage. Il réinitialisera et capturera également différentes transactions si aucune transaction lente n&apos;a été capturée au cours des cinq derniers [cycles de collecte](/docs/apm/new-relic-apm/getting-started/glossary#harvest-cycle). Cela vous permet de voir plus d&apos;informations sur davantage de chemins de requête de votre application, au risque possible de ne pas vous concentrer sur la requête la plus lente pour ce cycle de collecte.

    <Callout variant="tip">
      Pour enregistrer la transaction la plus lente au cours de la dernière minute, vous pouvez définir `top_n: 0` ou `top_n: 1`. Cependant, cela entraîne une route très lente qui domine votre trace de transaction.
    </Callout>
  </Collapser>

  <Collapser id="tracer_threshold" title="transaction_threshold">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier ou `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `apdex_f`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRACER_THRESHOLD`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Threshold`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le temps, en secondes, pendant lequel une [trace de transaction](/docs/apm/transactions/transaction-traces/transaction-traces) doit être considérée comme lente. La valeur par défaut est `apdex_f`; elle définit le seuil de trace à quatre fois [l&apos;Apdex T](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#apdex_t) de votre application. Si un nombre est fourni, il est défini en secondes.

    La valeur par défaut `apdex_t` est de 500 millisecondes. Si votre seuil de transaction est défini sur `apdex_f`, une transaction « lente » dure 2 secondes.
  </Collapser>

  <Collapser id="hide-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut à partir de la trace de transaction.

    <Callout variant="caution">
      Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
    </Callout>
  </Collapser>

  <Collapser id="hide-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de la trace de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="hide-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans la trace de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>
</CollapserGroup>

## Variables de règles [#rules\_config][#rules_config]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `rules: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="rules_names" title="name">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaînes ou expressions régulières
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_NAMING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Une liste de règles délimitées par des virgules permettant de faire correspondre les URL de requête entrantes et de nommer la transaction New Relic associée. Utilise le format :

    ```js
    name: [
        { pattern: 'STRING_OR_REGEX', name: 'NAME' },
        { pattern: 'STRING_OR_REGEX', name: 'NAME' }
    ]
    ```

    Les deux paramètres sont obligatoires. Pour les chaînes, vous devez échapper aux caractères de contrôle. Vous n’avez pas besoin d’échapper aux caractères de contrôle dans les expressions régulières. Les attributs supplémentaires sont ignorés.

    Les expressions régulières prennent en charge les groupes de capture de style JavaScript et les noms utilisent des chaînes de remplacement de style `$1` . Les expressions régulières ne trouvent que le premier résultat correspondant ; les correspondances suivantes sont ignorées. Pour plus d&apos;informations, consultez [l&apos;API de dénomination des transactions Node.js.](/docs/agents/nodejs-agent/api-guides/nodejs-agent-api#ignoring)

    Pour la variable d&apos;environnement `NEW_RELIC_NAMING_RULES`, transmettez les règles sous forme de littéraux d&apos;objet JSON délimités par des virgules :

    ```ini
    NEW_RELIC_NAMING_RULES='{"pattern":"^t","name":"u"},{"pattern":"^u","name":"t"}'
    ```
  </Collapser>

  <Collapser id="rules_ignore" title="ignorer">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaînes ou expressions régulières
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `['^/socket.io/.*/xhr-polling/']`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_IGNORING_RULES`
          </td>
        </tr>
      </tbody>
    </table>

    Définissez une liste d’URL de demande que vous souhaitez que l’agent ignore. Spécifiez la liste sous forme de modèles, qui peuvent être des chaînes ou des expressions régulières. La valeur par défaut est une expression régulière pour correspondre requestsd&apos;interrogation longue socket.io
  </Collapser>

  <Collapser id="enforce_backstop" title="enforce_backstop">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_ENFORCE_BACKSTOP`
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Ne modifiez pas ce paramètre à moins que vous ne compreniez [les problèmes de regroupement métrique](/docs/features/metric-grouping-issues).
    </Callout>

    Lorsque cette option est activée, l&apos; agent renomme les transactions qui ne sont pas affectées par une autre logique de dénomination (telle que l&apos; API, les règles ou les règles de normalisation métrique) en `NormalizedUri/*`. Si vous définissez cette valeur sur `false`, l&apos;agent définit les noms de transaction sur `Uri/path/to/resource`.
  </Collapser>
</CollapserGroup>

## Variables d&apos;événement de transaction [#tx\_events][#tx_events]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `transaction_events: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="tx_events_enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque cette option est activée, l&apos; agent envoie un événement de transaction à New Relic. Ces données d&apos;événement incluent le moment de la transaction, le nom de la transaction et tout attribut personnalisé. Si cette option est désactivée, l&apos;agent ne collecte pas ces données ni ne les envoie à New Relic.
  </Collapser>

  <Collapser id="tx_events_max_samples_stored" title="max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal d&apos;événements que l&apos; agent collecte par minute. S&apos;il y en a plus que ce nombre, l&apos;agent collecte un échantillon statistique.

    Nous ne recommandons pas de configurer au-delà de 10 000. Le serveur limitera les données à 10 000 par minute.

    <Callout variant="important">
      Cette configuration avait un comportement différent dans les versions d&apos;agent inférieures à 6.0.0. Voir [`max_samples_stored` (OBSOLÈTE)](#tx_events_max_samples_stored_legacy) pour les versions d&apos;agent 5.x ou inférieures.
    </Callout>
  </Collapser>

  <Collapser id="tx_events_max_samples_stored_legacy" title="max_samples_stored (OBSOLÈTE)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `20000`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal d&apos;événements que l&apos; agent stocke s&apos;il ne parvient pas à communiquer avec le [collecteurNew Relic ](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#collector). Les valeurs du [cycle de collecte](/docs/accounts-partnerships/education/getting-started-new-relic/glossary#harvest-cycle) précédent seront fusionnées dans le suivant, cette option limitant le nombre maximum. Assurez-vous que ce nombre est supérieur à `max_samples_per_minute`; par exemple, définissez-le à deux fois plus. Tenez compte de votre surcharge mémoire avant d’augmenter cette valeur.

    <Callout variant="caution">
      Cette configuration a un comportement différent à partir de la version 6.0.0 de l&apos;agent et un nouveau maximum recommandé. Voir [`max_samples_stored`](#tx_events_max_samples_stored) pour les versions d&apos;agent 6.x ou supérieures.
    </Callout>
  </Collapser>

  <Collapser id="tx_events_max_samples_per_minute" title="max_samples_per_minute (OBSOLÈTE)">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal d&apos;événements que l&apos; agent collecte par minute. S&apos;il y en a plus que ce nombre, l&apos;agent collecte un échantillon statistique.

    <Callout variant="caution">
      Cette configuration a été remplacée par `max_samples_stored` à partir de la version 6.0.0 de l&apos;agent. Voir [`max_samples_stored`](#tx_events_max_samples_stored) pour l&apos;agent 6.x ou version ultérieure.
    </Callout>
  </Collapser>

  <Collapser id="tx-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent capture l&apos;attribut de l&apos;événement de transaction.

    <Callout variant="caution">
      Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
    </Callout>
  </Collapser>

  <Collapser id="tx-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de l&apos;événement de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="tx-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans l&apos;événement de transaction. Autorise `*` comme caractère générique à la fin.
  </Collapser>
</CollapserGroup>

## monitoring des variables des navigateurs [#browser-variables]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `browser_monitoring: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="browser" title="activer">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_ENABLE`
          </td>
        </tr>

        <tr>
          <th>
            [Étiquette côté serveur](#server-side)
          </th>

          <td>
            `Enable browser monitoring?`
          </td>
        </tr>
      </tbody>
    </table>

    Générer des en-têtes JavaScript pour l&apos;instrumentation du navigateur. Si défini sur `true` l&apos;agent n&apos;injecte pas automatiquement le code JS du navigateur, sauf si vous avez [activé manuellement <InlinePopover type="browser" />](/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser). Même si vous l&apos;avez activé et [ajouté l&apos;en-tête de synchronisation du navigateur](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#procedures), vous pouvez [désactiver monitoring des navigateurs pour votre application](/docs/agents/nodejs-agent/supported-features/page-load-timing-nodejs#disabling) en définissant cette valeur sur `false`.
  </Collapser>

  <Collapser id="browser-debug" title="debug">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITOR_DEBUG`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, demandez des sources non minifiées au serveur.
  </Collapser>

  <Collapser id="browser-debug-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si `true`, l&apos; agent envoie l&apos;attribut personnalisé au monitoring des navigateurs.

    <Callout variant="caution">
      Toutes les règles d&apos;inclusion/exclusion liées à l&apos;en-tête doivent être au format camelCase pour être filtrées.
    </Callout>
  </Collapser>

  <Collapser id="browser-debug-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à exclure de monitoring des navigateurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>

  <Collapser id="browser-debug-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Préfixe d&apos;attribut à inclure dans monitoring des navigateurs. Autorise `*` comme caractère générique à la fin.
  </Collapser>
</CollapserGroup>

## événement personnalisé variable [#custom\_events][#custom_events]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `custom_insights_events: {` du fichier de configuration `newrelic.js` de votre application.

<CollapserGroup>
  <Collapser id="custom_events_enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque cette option est activée, l&apos; agent envoie l&apos;événement personnalisé enregistré avec [`recordCustomEvent()`](/docs/agents/nodejs-agent/supported-features/nodejs-agent-api#custom-events-api) à [New Relic](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-insights-api). Si cette option est désactivée, l&apos;agent ne collecte pas ces données ni ne les envoie à New Relic.
  </Collapser>

  <Collapser id="custom_events_max_samples_stored" title="max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `3000`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    * Définit le nombre maximum d&apos;événements personnalisés que l&apos; agent collecte par minute. Si le nombre d&apos;événements personnalisés dépasse cette limite, l&apos; agent collecte un échantillonnage statistique.

    * Lors de la configuration de l&apos;agent pour [monitoring de l&apos;IA](/docs/ai-monitoring/intro-to-ai-monitoring), définissez la valeur maximale sur `100000`. Garantit que la quantité maximale d&apos;événements LLM est capturée.

      <Callout variant="important">
        L’augmentation de cette limite peut augmenter l’utilisation de la mémoire.
      </Callout>
  </Collapser>
</CollapserGroup>

## requête de variables lentes [#slow-queries]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `slow_sql: {` du fichier de configuration `newrelic.js` de votre application. Ces options contrôlent le comportement de la requête lente, mais n&apos;affectent pas les nœuds SQL dans la trace de la transaction.

<CollapserGroup>
  <Collapser id="slow-sql-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SLOW_SQL_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;il est activé, l&apos; agent collecte [les détails de la requête lente](/docs/apm/applications-menu/monitoring/viewing-slow-query-details).
  </Collapser>

  <Collapser id="slow-sql-max-samples" title="max_échantillons">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_MAX_SQL_SAMPLES`
          </td>
        </tr>
      </tbody>
    </table>

    Définit le nombre maximal de requêtes lentes que l&apos; agent collecte par minute. L&apos;agent rejette toute requête supplémentaire une fois la limite atteinte.

    <Callout variant="important">
      L’augmentation de cette limite augmente l’utilisation de la mémoire.
    </Callout>
  </Collapser>
</CollapserGroup>

## Variables de nom d&apos;hôte personnalisées [#custom-hostnames]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `process_host: {` du fichier de configuration `newrelic.js` de votre application. Ces options contrôlent le comportement concernant le nom d&apos;affichage de l&apos;hôte dans l&apos;UI APM.

<CollapserGroup>
  <Collapser id="custom-hostnames-display" title="display_name">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne de 255 octets ou moins
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_PROCESS_HOST_DISPLAY_NAME`
          </td>
        </tr>
      </tbody>
    </table>

    Spécifiez un nom d’hôte personnalisé à [afficher dans New Relic](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name). Si vous ne définissez pas ce champ, New Relic continuera à utiliser le nom d&apos;hôte par défaut trouvé en appelant `os.hostname()`.

    * Si vous utilisez les paramètres de nom d’hôte par défaut, New Relic trouve le nom d’hôte via `os.hostname()`.
    * Si cet appel échoue, New Relic utilise l&apos;IP de l&apos;hôte comme nom.
    * Si vous `ipv_preference: 4` définissez `ipv_preference: 6` ou, vous pouvez sélectionner le type d&apos;adresse IP (IPv4 ou IPv6) qui apparaît dans l&apos;UI New Relic.
  </Collapser>

  <Collapser id="custom-hostnames-ipv" title="ipv_preference">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Entier (`4` ou `6`)
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `4`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_IPV_PREFERENCE`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Variables du traceur de datastore [#datastore-tracer]

Cette section définit les variables de l&apos;agent Node.js dans l&apos;ordre dans lequel elles apparaissent généralement dans la section `datastore_tracer` du fichier de configuration `newrelic.js` de votre application. Ces options contrôlent le comportement de collecte des datastore instance métriques .

<CollapserGroup>
  <Collapser id="datastore-instance-enabled" title="instance_reporting.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_INSTANCE_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;il est activé, l&apos;agent collecte des datastore instance métriques (telles que l&apos;hôte et le port) pour [certains pilotes de base de données](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information). Ceux-ci sont signalés sur la requête lente trace et la trace de transaction.
  </Collapser>

  <Collapser id="datastore-name-enabled" title="base de données activée">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DATASTORE_DATABASE_NAME_REPORTING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsqu&apos;il est activé, l&apos; agent collecte le nom de la base de données lors de la requête lente trace et trace de transaction pour [certains pilotes de base de données](/docs/agents/nodejs-agent/supported-features/nodejs-instance-level-database-information).
  </Collapser>
</CollapserGroup>

## Tracing inter-applications (OBSOLÈTE) [#cross-app-tracing]

Les variables de l&apos;agent Node.js qui contrôlent [le tracing inter-applications](/docs/apm/transactions/cross-application-traces/introduction-cross-application-traces) apparaissent généralement dans la section `cross_application_tracer` du fichier de configuration `newrelic.js` de votre application :

<Callout variant="important">
  Le tracing inter-applicationa été abandonné au profit du [tracing distribué](/docs/enable-distributed-tracing) et sera supprimé dans une future version agent .
</Callout>

<CollapserGroup>
  <Collapser id="cat-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CROSS_APPLICATION_TRACER_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque défini sur `true`, permet le suivi des transactions sur plusieurs applications de monitoring New Relic .
  </Collapser>
</CollapserGroup>

<Callout variant="important">
  Le tracing inter-application (CAT) est obsolète et sera supprimé dans une future sortie majeure. Pour une visibilité interservices, nous vous recommandons d&apos;utiliser [le tracing distribué](#distributed-tracing), qui est activé par défaut à partir de la version 8.3.0 agent . Avant l&apos;activation, lisez le [guide de transition](/docs/transition-guide-distributed-tracing).
</Callout>

## variables de rédaction du message d&apos;erreur [#err-message-redact]

Les Node.js agent variables qui contrôlent la rédaction du message d&apos;erreur apparaissent dans la `strip_exception_messages` section du `newrelic.js` configuration fichier de votre application :

<CollapserGroup>
  <Collapser id="allow-raw-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_STRIP_EXCEPTION_MESSAGES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque `true`, l&apos;agent rédigera les messages des erreurs capturées.
  </Collapser>
</CollapserGroup>

## Tracing distribué [#dt-main]

[Le tracing distribué](/docs/intro-distributed-tracing) vous permet de voir le chemin emprunté par une requête lorsqu&apos;elle traverse un système distribué. Lors de la configuration via le fichier de configuration, placez l&apos;option suivante dans la section `distributed_tracing` . Il est activé par défaut dans l&apos;agent Node.js 8.3.0 et supérieur.

<Callout variant="important">
  L&apos;activation du tracing distribué désactive [le tracing inter-application](#cross-app-tracing) et a des effets sur d&apos;autres fonctionnalités APM . Avant l&apos;activation, lisez le [guide de transition](/docs/transition-guide-distributed-tracing). Nécessite [l&apos;agent Node.js version 4.7.0 ou supérieure](/docs/agents/nodejs-agent/installation-configuration/upgrade-nodejs-agent).
</Callout>

Pour plus d&apos;informations sur la configuration du tracing distribué, consultez [Activer le tracing distribué pour votre application Node.js ](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent).

<CollapserGroup>
  <Collapser id="dt-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Définissez ceci sur `false` pour désactiver le tracing distribué. Par exemple, dans le fichier de configuration, vous utiliseriez :

    ```js
    distributed_tracing: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser id="dt-exclude-newrelic-header" title="exclude_newrelic_header">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_EXCLUDE_NEWRELIC_HEADER`
          </td>
        </tr>
      </tbody>
    </table>

    Définissez cette valeur sur `true` pour exclure l&apos;en-tête New Relic attaché aux requests sortantes et vous fier uniquement aux en-têtes W3C Trace Context pour le tracing distribué. Si c&apos;est `false`, les deux types d&apos;en-têtes sont utilisés.

    Par exemple, pour activer cela dans le fichier de configuration, vous utiliseriez :

    ```js
    distributed_tracing: {
        enabled: true,
        exclude_newrelic_header: true
    }
    ```
  </Collapser>

  <Collapser id="dt-sampler-remote-parent-sampled" title="échantillonneur.remote_parent_sampled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque l&apos;en-tête traceparent a un indicateur échantillonné de `01`, cela contrôle la manière de gérer l&apos;échantillonnage des étendues. Les valeurs autorisées sont :

    * `always_on`: l&apos;agent échantillonnera les étendues
    * `always_off`: l&apos;agent n&apos;échantillonnera PAS les étendues
    * `default`: l&apos;agent utilisera l&apos;échantillonnage NR existant (par défaut)

    Par exemple, pour activer cela dans le fichier de configuration, vous utiliseriez :

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_sampled: 'always_on'
        }
    }
    ```
  </Collapser>

  <Collapser id="dt-sampler-remote-parent-not-sampled" title="sampler.remote_parent_not_sampled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `default`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_REMOTE_PARENT_NOT_SAMPLED`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque l&apos;en-tête traceparent possède un indicateur échantillonné de `00`, cela contrôle la manière de gérer l&apos;échantillonnage des étendues. Les valeurs autorisées sont :

    * `always_on`: l&apos;agent échantillonnera les étendues
    * `always_off`: l&apos;agent n&apos;échantillonnera PAS les étendues
    * `default`: l&apos;agent utilisera l&apos;échantillonnage NR existant (par défaut)

    Par exemple, pour activer cela dans le fichier de configuration, vous utiliseriez :

    ```js
    distributed_tracing: {
        enabled: true,
        sampler: {
          remote_parent_not_sampled: 'always_on'
        }
    }
    ```
  </Collapser>
</CollapserGroup>

## gRPC du serveur instrumentation [#grpc\_server][#grpc_server]

La section `grpc` contrôle le comportement de la manière dont le serveur gRPC est instrumenté.

<CollapserGroup>
  <Collapser id="record_errors" title="record_errors">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_GRPC_RECORD_ERRORS`
          </td>
        </tr>
      </tbody>
    </table>

    Lorsque cette option est activée, l&apos;agent enverra tous les codes d&apos;état d&apos;erreur gRPC à New Relic, c&apos;est-à-dire les codes d&apos;état différents de zéro. Si cette option est désactivée, l&apos;instrumentation du serveur n&apos;enverra aucun code d&apos;état différent de zéro à New Relic.
  </Collapser>
</CollapserGroup>

<Collapser id="grpc_error_ignore" title="ignore_status_codes">
  <table>
    <tbody>
      <tr>
        <th>
          Type
        </th>

        <td>
          Éventail d&apos;entiers
        </td>
      </tr>

      <tr>
        <th>
          Défaut
        </th>

        <td>
          `[]`
        </td>
      </tr>

      <tr>
        <th>
          [Variable d&apos;environnement](#environment)
        </th>

        <td>
          `NEW_RELIC_GRPC_IGNORE_STATUS_CODES`
        </td>
      </tr>
    </tbody>
  </table>

  Liste délimitée par des virgules de codes d&apos;état gRPC que le collecteur d&apos;erreurs doit ignorer, à la fois sur instrumentation côté client et côté serveur.

  <Callout variant="caution">
    Les erreurs enregistrées à l’aide de [`newrelic.noticeError()`](https://newrelic.github.io/node-newrelic/API.html#noticeError) ne respectent pas cette valeur de configuration.
  </Callout>
</Collapser>

## Événements de span

[Les données Span](/docs/apm/distributed-tracing/ui-data/span-event) sont signalées pour [le tracing distribué](#distributed-tracing). Le tracing distribué doit être activé pour signaler les étendues. Définissez la configuration de l&apos;étendue dans la section `span_events` . Les options incluent :

<CollapserGroup>
  <Collapser id="span-events-enabled" title="enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou désactive le signalement d&apos;un événement SPAN.
  </Collapser>

  <Collapser id="span-events-attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Ce paramètre peut être utilisé pour activer ou désactiver la création de rapports d&apos;attributs pour les étendues. Si `attributes.enabled` au niveau racine est `false`, aucun attribut ne sera envoyé avec les étendues, quelle que soit la manière dont cela est défini.
  </Collapser>

  <Collapser id="span-events-attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Si les attributs sont activés pour les étendues, toutes les clés d&apos;attribut trouvées dans cette liste seront attachées aux étendues. Pour plus d&apos;informations, consultez les [règles d&apos;attribut de l&apos;agent](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>

  <Collapser id="span-events-attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `[]`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Toutes les clés d’attribut trouvées dans cette liste ne seront pas envoyées avec des étendues. Pour plus d&apos;informations, consultez les [règles d&apos;attribut de l&apos;agent](/docs/apm/other-features/attributes/agent-attributes).
  </Collapser>
</CollapserGroup>

<Collapser id="span-events-max-samples-stored" title="max_samples_stored">
  <table>
    <tbody>
      <tr>
        <th>
          Type
        </th>

        <td>
          Entier
        </td>
      </tr>

      <tr>
        <th>
          Défaut
        </th>

        <td>
          `2000`
        </td>
      </tr>

      <tr>
        <th>
          [Variable d&apos;environnement](#environment)
        </th>

        <td>
          `NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`
        </td>
      </tr>
    </tbody>
  </table>

  * Définit le nombre maximal d&apos;événements que l&apos; agent collecte par minute. S&apos;il y en a plus que ce nombre, l&apos;agent collecte un échantillon statistique.

  * Nous ne recommandons pas de configurer au-delà de 10 000. Le serveur limitera les données à 10 000 par minute.

  * Lors de la configuration de l&apos;agent pour [monitoring de l&apos;IA](/docs/ai-monitoring/intro-to-ai-monitoring), définissez la valeur maximale sur `10000`. Garantit que la quantité maximale de traces soit capturée.

    <Callout variant="important">
      `max_samples_stored` les paramètres de configuration nécessitent [l&apos;agent Node.JS version 8.3.0 ou supérieure](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).
    </Callout>
</Collapser>

## Infinite Tracing

Pour activer Infinite Tracing, ajoutez les paramètres ci-dessous. Définissez la configuration du Infinite Tracing dans la section `infinite_tracing` . De plus, le Infinite Tracing doit être [activé](/docs/apm/agents/nodejs-agent/installation-configuration/distributed-tracing-nodejs-agent). Notez que le tracing distribué est activé par défaut pour les Node.js agent APM versions 8.3.0 et supérieures de l&apos; .

<CollapserGroup>
  <Collapser id="infinite-tracing-host" title="trace_observer.host">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`
          </td>
        </tr>
      </tbody>
    </table>

    Pour obtenir de l&apos;aide pour obtenir une entrée d&apos;hôte d&apos;observateur de trace Infinite Tracing valide, consultez [Rechercher ou créer un point de terminaison d&apos;observateur de trace](/docs/understand-dependencies/distributed-tracing/enable-configure/language-agents-enable-distributed-tracing#provision-trace-observer).
  </Collapser>

  <Collapser id="infinite-tracing-queue-size" title="span_events.queue_size">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Nombre
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_SPAN_EVENTS_QUEUE_SIZE`
          </td>
        </tr>
      </tbody>
    </table>

    La quantité de Infinite Tracing que l&apos;agent conservera en mémoire avant de les supprimer.

    Ce paramètre devrait rarement avoir besoin d&apos;être modifié par rapport à la valeur par défaut, car la file d&apos;attente n&apos;est pas utilisée la plupart du temps. La file d&apos;attente est utilisée uniquement lors des reconnexions au point de terminaison Infinite Tracing lorsque l&apos;agent ne peut pas diffuser de données. Il est possible que l&apos;agent abandonne les intervalles de Infinite Tracing pendant ces périodes, dans ce cas, l&apos;augmentation de ce nombre peut aider.
  </Collapser>

  <Collapser id="infinite-tracing-batching" title="traitement par lots">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_BATCHING`
          </td>
        </tr>
      </tbody>
    </table>

    Ce paramètre envoie des étendues par lots de 250 ou toutes les 5 secondes.

    Ce paramètre ne doit pas être modifié car le volume de sortie augmentera considérablement.
  </Collapser>

  <Collapser id="infinite-tracing-compression" title="compression">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_INFINITE_TRACING_COMPRESSION`
          </td>
        </tr>
      </tbody>
    </table>

    Ce paramètre gzip compresse span(s).

    Ce paramètre ne doit pas être modifié car le volume de sortie augmentera considérablement.
  </Collapser>
</CollapserGroup>

## Logging des applications [#app-logging]

Les application configuration paramètres de logging nécessitent [Node.JS agent version 8.11.0 ou supérieure](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

Pour obtenir des conseils sur la configuration du log pour l&apos;agent Node.js, consultez [Configurer les logs en contexte Node.js](/docs/logs/logs-context/configure-logs-context-nodejs).

<CollapserGroup>
  <Collapser id="application-logging-enabled" title="application_logging.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Permet de générer automatiquement [des logs en contexte](/docs/logs/logs-context/configure-logs-context-nodejs/).

    Par exemple, pour désactiver cette fonctionnalité dans le fichier de configuration, vous utiliseriez :

    ```js
    application_logging: {
        enabled: false
    }
    ```
  </Collapser>

  <Collapser id="application-logging-metrics-enabled" title="application_logging.metrics.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou non la collecte par l&apos; agent des métriques de logging utilisées dans le graphique de log sur la page de résumé APM .
  </Collapser>

  <Collapser id="application-logging-forwarding-enabled" title="application_logging.forwarding.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou non la collecte par l&apos; agent des enregistrements log à envoyer à New Relic.
  </Collapser>

  <Collapser id="application-logging-forwarding-max_samples_stored" title="application_logging.forwarding.max_samples_stored">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Nombre
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `10000`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED`
          </td>
        </tr>
      </tbody>
    </table>

    Nombre d&apos;enregistrements log à envoyer par minute à New Relic. Contrôle la consommation globale de mémoire lors de l&apos;utilisation du transfert de log .

    Définissez cette valeur sur une valeur inférieure pour réduire la quantité de lignes log envoyées (peut provoquer un échantillonnage log ). Définissez cette valeur sur une valeur plus élevée pour envoyer plus de lignes log .

    Chaque log reçoit la même priorité que sa transaction associée. Les logs qui se produisent en dehors d&apos;une transaction recevront une priorité aléatoire. Certains logs peuvent ne pas être inclus car ils sont limités par `max_samples_stored`. Par exemple, si le logging `max_samples_stored` est définie sur 10 000 et que la transaction 1 comporte 10 000 entrées log, seules les entrées log de la transaction 1 seront enregistrées. Si la transaction 1 contient moins de 10 000 logs, vous recevez tous les logs de la transaction 1. S&apos;il reste de la place, vous recevez l&apos;intégralité du log de la transaction 2, et ainsi de suite.

    Si après tout le log des transactions échantillonnées est enregistré et qu&apos;elles n&apos;ont pas atteint la limite de `max_samples_stored`, alors les messages de log des transactions qui n&apos;étaient pas dans notre échantillonnage sont envoyés. S&apos;il en reste, les messages de log en dehors des transactions sont enregistrés.
  </Collapser>

  <Collapser id="application-logging-forwarding-labels" title="application_logging.forwarding.labels.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            false
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou non l&apos;ajout d&apos;étiquettes par l&apos; agent aux log de log pour l&apos;envoi à New Relic.
  </Collapser>

  <Collapser id="application-logging-forwarding-labels-exclude" title="application_logging.forwarding.labels.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Array
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            \[]
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LABELS_EXCLUDE`
          </td>
        </tr>
      </tbody>
    </table>

    Une liste insensible à la casse des noms d&apos;étiquettes à exclure lorsque vous activez l&apos;inclusion d&apos;étiquettes dans le log. Cet attribut ne prend pas en charge les caractères génériques ni les expressions régulières.
  </Collapser>

  <Collapser id="application-logging-local_decorating-enabled" title="application_logging.local_decorating.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou désactive la décoration du log local par l&apos; agent sur la sortie log standard.
  </Collapser>
</CollapserGroup>

## Métriques au niveau du code [#code-level-metrics]

Les paramètres de configuration des métriques au niveau du code nécessitent [l&apos;agent Node.JS version 9.7.5 ou supérieure](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/).

Pour plus de détails, consultez [notre documentation sur les métriques au niveau du code](/docs/apm/agents/nodejs-agent/installation-configuration/codestream-integration).

<CollapserGroup>
  <Collapser id="code-level-metrics-enabled" title="code_level_metrics.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_CODE_LEVEL_METRICS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou non la capture d&apos;attributs supplémentaires sur les étendues de middleware pour tous les frameworks Web Node.js qui aident à piloter [les métriques du niveau de code](/docs/codestream/observability/code-level-metrics). Les attributs supplémentaires sont : `code.filepath`, `code.function`, `code.lineno` et `code.column`.
  </Collapser>
</CollapserGroup>

## Erreurs configuration de la boîte de réception [#errors-inbox-configuration]

La définition de l’une des balises suivantes vous aidera à identifier les versions de votre logiciel qui génèrent les erreurs.

* `NEW_RELIC_METADATA_SERVICE_VERSION` créera tag.service.version sur les données d&apos;événement contenant la version de votre code qui est déployée, dans de nombreux cas une version sémantique telle que 1.2.3, mais pas toujours.
* `NEW_RELIC_METADATA_RELEASE_TAG `créera tag.releaseTag sur les données d&apos;événement contenant la tag de sortie (comme v0.1.209 ou sortie-209).
* `NEW_RELIC_METADATA_COMMIT` créera tag.commit sur les données d&apos;événement contenant le commit sha. Le SHA entier peut être utilisé ou seulement les sept premiers caractères (par exemple, 734713b).

Une prochaine version de la boîte de réception des erreurs suivra automatiquement les versions de votre logiciel qui génèrent des erreurs. Toutes les données de version seront également affichées dans [CodeStream](/docs/codestream/how-use-codestream/performance-monitoring/#buildsha).

## obfuscationd&apos;URL [#url-obfuscation]

Les obfuscation configuration paramètres d&apos;URL [Node.js agent nécessitent la version 9.9.0 ou supérieure](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/)

Pour un exemple de configuration, consultez notre documentation sur [l&apos;obfuscation d&apos;URL de l&apos;agent de nœud](/docs/url-obfuscation/configure-url-obfuscation-nodejs).

<CollapserGroup>
  <Collapser id="url-obfuscation-enabled" title="url_obfuscation.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active [l&apos;obscurcissement de l&apos;URL de l&apos;agent de nœud](/docs/url-obfuscation/configure-url-obfuscation-nodejs/) basé sur l&apos;expression régulière.
  </Collapser>

  <Collapser id="url-obfuscation-regex-pattern" title="url_obfuscation.regex.pattern">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne ou RegExp
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_PATTERN`
          </td>
        </tr>
      </tbody>
    </table>

    Spécifie le modèle d&apos;expression régulière à utiliser pour obfuscation de l&apos;URL. Si cette option n&apos;est pas définie, aucune obfuscation d&apos;URL ne sera effectuée.
  </Collapser>

  <Collapser id="url-obfuscation-regex-flags" title="url_obfuscation.regex.flags">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_FLAGS`
          </td>
        </tr>
      </tbody>
    </table>

    Spécifie les indicateurs d&apos;expression régulière à utiliser pour la correspondance des modèles obfuscation d&apos;URL, par exemple `g` pour la correspondance globale, `i` pour la correspondance insensible à la casse, etc. Plusieurs indicateurs peuvent être spécifiés sous forme de chaîne, par exemple `gi`. Si cette option n&apos;est pas définie, aucun indicateur ne sera utilisé.
  </Collapser>

  <Collapser id="url-obfuscation-regex-replacement" title="url_obfuscation.regex.replacement">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_URL_OBFUSCATION_REGEX_REPLACEMENT`
          </td>
        </tr>
      </tbody>
    </table>

    Spécifie la chaîne de remplacement à utiliser pour obfuscation de l&apos;URL. Peut contenir des références pour capturer des groupes dans le modèle, par exemple `$1`. Si cette valeur n&apos;est pas définie, tout sera remplacé par une seule chaîne vide.
  </Collapser>
</CollapserGroup>

## Agent de sécurité [#security-agent]

[New Relic sécurité agent interactif de test de sécurité](/docs/iast/introduction/) des (IAST) de New Relic Security teste votre application pour détecter toute vulnérabilité exploitable en rejouant la requête HTTP générée avec une charge vulnérable.

<Callout variant="caution">
  Exécutez IAST avec une déploiement de non-production uniquement pour éviter d&apos;exposer les vulnérabilités de votre logiciel de production.
</Callout>

<Callout variant="important">
  Les paramètres de configuration de l&apos;agent de sécurité nécessitent [la version 10.3.0 ou supérieure de l&apos;agent Node.js.](/docs/apm/agents/nodejs-agent/installation-configuration/update-nodejs-agent/)
</Callout>

<CollapserGroup>
  <Collapser id="security-enabled" title="security.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou non l&apos;envoi des données de l&apos;agent de sécurité New Relic à New Relic. Lorsque cette option est désactivée et que security.agent.enabled est vrai, l&apos;agent de sécurité sera enregistré mais les données ne seront pas envoyées.
  </Collapser>

  <Collapser id="security-agent-enabled" title="security.agent.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_AGENT_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Active ou désactive le chargement de l&apos;agent de sécurité New Relic. Cette propriété est lue une seule fois au démarrage de l&apos;application.
  </Collapser>

  <Collapser id="security-mode" title="security.mode">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `IAST`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_MODE`
          </td>
        </tr>
      </tbody>
    </table>

    Mode de sécurité fourni par New Relic : IAST. La valeur par défaut est IAST. En raison de la nature invasive de l&apos;analyse IAST, N&apos;ACTIVEZ PAS ce mode dans un environnement de production ou dans un environnement où des données de production sont traitées.
  </Collapser>

  <Collapser id="security-validator-url" title="security.validator_service_url">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `wss://csec.nr-data.net`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_VALIDATOR_SERVICE_URL`
          </td>
        </tr>
      </tbody>
    </table>

    URL de connexion à la sécurité New Relic. Il s’agit du point de terminaison auquel l’agent de sécurité envoie les données. Il doit correspondre à l’environnement que vous avez défini pour l’agent Node.js.
  </Collapser>

  <Collapser id="security-rci-detection" title="security.detection.rci.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RCI_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Activez la détection des événements de sécurité RCI.
  </Collapser>

  <Collapser id="security-xss-detection" title="security.detection.rxss.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_RXSS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Activez la détection des événements de sécurité RXSS.
  </Collapser>

  <Collapser id="security-deserialization-detection" title="security.detection.deserialization.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_SECURITY_DETECTION_DESERIALIZATION_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Activer la détection des événements de sécurité de désérialisation.
  </Collapser>
</CollapserGroup>

## Heroku [#heroku]

<CollapserGroup>
  <Collapser id="heroku-dyno" title="heroku.use_dyno_names">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `true`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_HEROKU_USE_DYNO_NAMES`
          </td>
        </tr>
      </tbody>
    </table>

    Si c&apos;est vrai, l&apos; agent utilise les noms de dyno Heroku comme nom d&apos;hôte.
  </Collapser>
</CollapserGroup>

## Fils de discussion des travailleurs [#worker-threads]

Dans les versions d&apos;agent antérieures à 11.0.0, l&apos;agent s&apos;exécutait à la fois dans les threads principaux et dans les threads de travail. Dans la version 11.0.0, l&apos; agent a cessé de s&apos;exécuter dans les threads de travail en raison de son incompatibilité avec notre propagation asynchrone du contexte. La possibilité d&apos;exécution dans les threads de travail a été restaurée dans la version 11.3.0, mais vous devez définir `worker_threads.enabled` sur `true`. Le comportement de l&apos;exécution dans les threads de travail varie et nous ne le prenons pas officiellement en charge. Certaines choses comme la génération de métriques et le suivi autonome des transactions peuvent fonctionner, mais il s&apos;agit d&apos;une capacité que vous utilisez à vos propres risques.

<CollapserGroup>
  <Collapser id="worker-threads" title="worker_threads.enabled">
    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>

        <tr>
          <th>
            [Variable d&apos;environnement](#environment)
          </th>

          <td>
            `NEW_RELIC_WORKER_THREADS_ENABLED`
          </td>
        </tr>
      </tbody>
    </table>

    Si vrai, l&apos;agent se chargera lorsqu&apos;il se trouve dans un thread de travail s&apos;il est spécifié.
  </Collapser>
</CollapserGroup>

## Remplacements de variables d&apos;environnement

Cette section définit deux options de configuration disponibles uniquement avec les variables d&apos;environnement. Ces remplacements ne sont pas utilisés dans la plupart des configurations.

<CollapserGroup>
  <Collapser id="home" title="NEW_RELIC_HOME">
    Chemin vers le répertoire contenant `newrelic.js`. Ceci est disponible uniquement en tant que variable d&apos;environnement. Vous ne pouvez pas le définir dans votre fichier de configuration.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="filename" title="NEW_RELIC_CONFIG_FILENAME">
    Utilisé pour définir un nom de fichier de configuration différent de celui par défaut `newrelic.js`. Ceci est disponible uniquement en tant que variable d&apos;environnement. Vous ne pouvez pas le définir dans votre fichier de configuration.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Chaîne
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            (aucun)
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="no_file" title="NEW_RELIC_NO_CONFIG_FILE">
    Si cette option est utilisée, elle empêche l&apos;agent de lire les paramètres de configuration de `newrelic.js`. Les valeurs par défaut et les valeurs des variables d’environnement seront toujours définies.

    Ceci est disponible uniquement en tant que variable d&apos;environnement. Vous ne pouvez pas le définir dans votre fichier de configuration.

    <table>
      <tbody>
        <tr>
          <th>
            Type
          </th>

          <td>
            Booléen
          </td>
        </tr>

        <tr>
          <th>
            Défaut
          </th>

          <td>
            `false`
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

## Guide de référence des types de variables d&apos;environnement

Cette section décrit comment formater correctement les types de données complexes.

<CollapserGroup>
  <Collapser id="array" title="Array">
    Les types d&apos;éventail sont définis comme des chaînes délimitées par des virgules.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_IGNORE_ERROR_CODES=404,500,429
    ```
  </Collapser>

  <Collapser id="object" title="Objet">
    Les types d&apos;objets sont définis sous la forme d&apos;une chaîne JSON.

    ```ini
    NEW_RELIC_ERROR_COLLECTOR_EXPECTED_MESSAGES='{"Error":["Undefined", "No soup for you!"]}'
    ```
  </Collapser>
</CollapserGroup>