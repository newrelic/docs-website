---
subject: Node.js agent
releaseDate: '2025-08-20'
version: 13.2.0
downloadLink: 'https://www.npmjs.com/package/newrelic'
security: []
bugs:
  - Fixed logic around detecting OTEL packages
  - Updated `shimmer.setupSubscribers` to properly setup and skip subscribers that are disabled
features:
  - Added ability to register `Supportability/Features/Instrumentation/OnRequire/<pkg>` metrics for subscriber based instrumentation
  - 'Added instrumentation for `@modelcontextprotocol/sdk` client calls `client.callTool`, `client.readResource`, and `client.getPrompt`'
  - Added esm loader hook and commonjs patch to work with orchestrion-js
translationType: machine
---

## Remarques

#### Caractéristiques

* Ajout de la possibilité d&apos;enregistrer des métriques `Supportability/Features/Instrumentation/OnRequire/<pkg>` pour l&apos;instrumentation basée sur l&apos;abonné ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([87bfa40](https://github.com/newrelic/node-newrelic/commit/87bfa400c216352f12bbbc500e74f8e58285a275))
* Ajout du hook de chargement esm et du patch commonjs pour fonctionner avec orchestrion-js ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([415aeba](https://github.com/newrelic/node-newrelic/commit/415aeba6db04aa54cc1f44e64c0e6d2235d47108))
* Instrumentation ajoutée pour les appels clients `@modelcontextprotocol/sdk` : `client.callTool`, `client.readResource` et `client.getPrompt` ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([5d9790b](https://github.com/newrelic/node-newrelic/commit/5d9790b4bd9ab24db4a38618ef96c3b50fbadae7))

#### Débogage

* Logique fixe autour de la détection du package OTEL ([#3326](https://github.com/newrelic/node-newrelic/pull/3326)) ([4df30e5](https://github.com/newrelic/node-newrelic/commit/4df30e5c2021e0d933e4a77ccd4409405928fa39))
* Mise à jour `shimmer.setupSubscribers` pour configurer correctement et ignorer les abonnés désactivés ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([cf5b3ec](https://github.com/newrelic/node-newrelic/commit/cf5b3ec39e2cad05c46ec7865f5b8b8377cb4710))

#### Refactoring de code

* Ajout de la possibilité de désactiver les abonnés via `config.instrumentation.<pkg-name>.enabled` ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([55f8fe7](https://github.com/newrelic/node-newrelic/commit/55f8fe7bc7035ab1822986eb51a228e266e3d3eb))
* Ajout de la possibilité d&apos;empêcher la création de segments dans l&apos;instrumentation basée sur l&apos;abonné lorsque le parent est marqué comme interne et du même package ([#3322](https://github.com/newrelic/node-newrelic/pull/3322)) ([91f91c2](https://github.com/newrelic/node-newrelic/commit/91f91c2c85f2715bb1c1db5847704623fd65851e))
* Paramètre `id` supprimé de la classe `opensearch` ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([8be00ce](https://github.com/newrelic/node-newrelic/commit/8be00cef67a2637f7d7a3ab33cccb6824ab34478))
* Mise à jour de l&apos;instrumentation `opensearch` pour s&apos;abonner à l&apos;événement provoqué ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([9a27a5d](https://github.com/newrelic/node-newrelic/commit/9a27a5daba8a82c350cf129e3b2548527868ae90))
* Mise à jour de l&apos;instrumentation elasticsearch pour s&apos;abonner à l&apos;événement émis ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([a3e2348](https://github.com/newrelic/node-newrelic/commit/a3e2348d9af62d12cb570c26f557096968d38daa))
* Instrumentation ioredis mise à jour pour s&apos;abonner à l&apos;événement émis ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([90b97d2](https://github.com/newrelic/node-newrelic/commit/90b97d28a9bbf5c1646ce3ca399bb6772c17c07c))
* Instrumentation pino mise à jour pour s&apos;abonner à l&apos;événement généré ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([28bbe9f](https://github.com/newrelic/node-newrelic/commit/28bbe9fee831d57d4fb77d01ef4cd2f6072bf9d8))
* Mise à jour des abonnés pour avoir un createSegment commun qui crée, attribue un attribut et démarre le segment ([#3317](https://github.com/newrelic/node-newrelic/pull/3317)) ([aa3f8d9](https://github.com/newrelic/node-newrelic/commit/aa3f8d936aa9fd7ffdad1f771dc16da8782ad917))
* Instrumentation undici mise à jour pour supprimer sa dépendance à la cale. Mise à jour également du stockage des segments pertinents sur le contexte au lieu des symboles sur l&apos;objet de requête ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([ec17fa7](https://github.com/newrelic/node-newrelic/commit/ec17fa7ef431bf51c527d2c58cdf216fee641884))

#### Documentation

* Rapport de compatibilité mis à jour ([#3313](https://github.com/newrelic/node-newrelic/pull/3313)) ([749ddc9](https://github.com/newrelic/node-newrelic/commit/749ddc9c050ee81f8969e8f173233dcb78826da1)) ([#3304](https://github.com/newrelic/node-newrelic/pull/3304)) ([cc000a7](https://github.com/newrelic/node-newrelic/commit/cc000a72870b508c929449b57a35d289ce093f42))

#### Tâches diverses

* passage du segment de fin au segment de contact pour la parité des fonctionnalités avec la cale ([#3312](https://github.com/newrelic/node-newrelic/pull/3312)) ([4d39fc5](https://github.com/newrelic/node-newrelic/commit/4d39fc564a23798d42105398d0b8ea6c0e9280cc))
* configuration eslint mise à jour ([#3296](https://github.com/newrelic/node-newrelic/pull/3296)) ([5c168a6](https://github.com/newrelic/node-newrelic/commit/5c168a657cddece16c0b1124307526ffb3588953))

#### Tests

* Correction de l&apos;obtention de la version package opensearch pour les anciennes versions que nous instrument ([#3314](https://github.com/newrelic/node-newrelic/pull/3314)) ([e45ab27](https://github.com/newrelic/node-newrelic/commit/e45ab275109dd601945776c0de88ba954a8c57e2))
* Suppression de `prisma.$use` inutiles dans les tests pour détacher ([#3303](https://github.com/newrelic/node-newrelic/pull/3303)) ([db20324](https://github.com/newrelic/node-newrelic/commit/db20324535ebf714237dc716c3f6718fd90cfb36))

#### L&apos;intégration continue

* Autoriser l&apos;utilisateur à exécuter des tests d&apos;évaluation même s&apos;il n&apos;envoie pas de métriques ([#3307](https://github.com/newrelic/node-newrelic/pull/3307)) ([1be1514](https://github.com/newrelic/node-newrelic/commit/1be1514c9d49465a29e6b8fbc09c3bb5ebc1b112))
* Modifier les tests d&apos;évaluation pour utiliser `TEST_LICENSE` ([#3325](https://github.com/newrelic/node-newrelic/pull/3325)) ([1f7f733](https://github.com/newrelic/node-newrelic/commit/1f7f733b2d10a5447662e159038fa32f1c036235))

### Déclaration de soutien :

Nous vous recommandons de mettre à jour vers la dernière version de l&apos;agent dès qu&apos;elle est disponible. Si vous ne pouvez pas effectuer la mise à niveau vers la dernière version, mettez à jour vos agents vers une version datant de moins de 90 jours. En savoir plus sur la façon de tenir les agents informés. ([https://docs.newrelic.com/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/](https://docs.newrelic.com/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/))

Consultez la politique EOL de l&apos;agent New Relic Node.js pour obtenir des informations sur la sortie de l&apos;agent et les dates de support. ([https://docs.newrelic.com/docs/apm/agents/nodejs-agent/getting-started/nodejs-agent-eol-policy/](https://docs.newrelic.com/docs/apm/agents/nodejs-agent/getting-started/nodejs-agent-eol-policy/))