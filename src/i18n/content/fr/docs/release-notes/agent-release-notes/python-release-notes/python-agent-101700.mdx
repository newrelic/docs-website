---
subject: Python agent
releaseDate: '2025-09-04'
version: 10.17.0
downloadLink: 'https://pypi.python.org/pypi/newrelic'
features:
  - Adds support for custom tasks in Celery
  - Adds support for graphene-django
  - Adds support for middleware filtering in Django
  - Adds support for AWS Bedrock Converse API
  - Adds support for W3CTraceParent header sampled flag
bugs:
  - Safeguard for deepest unique path in GraphQL
  - Safeguard for web request parsing
  - Fix crash in GraphQL
  - Fix crash in ElasticSearch
translationType: machine
---

## Remarques

Cette sortie de l&apos;agent Python ajoute la prise en charge des éléments suivants :

* Tâches personnalisées dans [Celery](https://pypi.org/project/celery/)
* Monitoringde [Graphene-Django](https://pypi.org/project/graphene-django/)
* Filtrage middleware dans [Django](https://pypi.org/project/django/)
* API AWS Bedrock [Converse](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-runtime/client/converse.html)
* Indicateur d&apos;échantillon d&apos;en-tête W3CTraceParent

Cette sortie fournit également les correctifs suivants :

* Garanties pour le chemin unique le plus profond dans GraphQL
* Mesures de protection pour l&apos;analyse des requêtes d&apos;URL Web
* Recours à ElasticSearch et GraphQL lorsque `trace.settings==None`
* Supprimer la méthode `options` de la liste des clients ElasticSearch asynchrones

Installez l&apos;agent à l&apos;aide de `easy_install/pip/distribute` via l&apos; [index du packagePython ](https://pypi.python.org/pypi/newrelic)ou téléchargez-le directement depuis le [site de téléchargement de New Relic](https://download.newrelic.com/python_agent/release).

## Nouvelles fonctionnalités

* Ajoute la prise en charge des tâches personnalisées dans Celery

  * Ajoutez la prise en charge monitoring pour les classes de tâches personnalisées dans [Celery](https://pypi.org/project/celery/). Auparavant, seules les tâches utilisant la classe de tâches par défaut pouvaient être monitorées. Remarque : cette version de l&apos;agent Python ne prendra plus en charge les versions de Celery inférieures à [la version 5.2.0](https://github.com/celery/celery/releases/tag/v5.2.0).

* Ajoute la prise en charge de Graphene-Django

  * Ajoutez la prise en charge monitoring pour les schémas synchrones créés avec [Graphene-Django](https://pypi.org/project/graphene-django/). Auparavant, les schémas créés avec Graphene-Django n&apos;étaient que partiellement monitorés, ce qui entraînait l&apos;absence d&apos;attributs liés [GraphQL](https://pypi.org/project/graphql-core/).

* Ajoute la prise en charge du filtrage middleware dans Django

  * Les utilisateurs sont désormais en mesure de filtrer le middleware [Django](https://pypi.org/project/django/) à monitorer. Il existe désormais [trois paramètres supplémentaires](/docs/apm/agents/python-agent/configuration/python-agent-configuration/#middleware-filters):

    * `instrumentation.middleware.django.enabled` (La valeur par défaut est `true`)
    * `instrumentation.middleware.django.exclude`
    * `instrumentation.middleware.django.include`

  Consultez la [page Filtrage du middleware Django](/docs/apm/agents/python-agent/supported-features/django-middleware-filtering/) pour plus d’informations et d’exemples.

* Ajoute la prise en charge de l&apos;API AWS Bedrock Converse

  * Ajoutez la prise en charge monitoring pour l&apos;API [Converse](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/bedrock-runtime/client/converse.html) non diffusée en continu. Cela inclut la prise en charge des appels de fin de discussion `converse` effectués à l&apos;aide des clients `boto3` et `aioboto3`.

* Ajoute la prise en charge de l&apos;indicateur d&apos;échantillonnage de l&apos;en-tête W3CTraceParent

  * Lorsqu&apos;un service en amont envoie l&apos;en-tête W3CTraceParent avec l&apos;indicateur d&apos;échantillonnage défini, New Relic prendra en compte cette décision d&apos;échantillonnage pour décider si la transaction en cours sera échantillonnée.

* Ajout de la prise en charge des décisions d&apos;échantillonnage en fonction de l&apos;échantillonnage du parent distant

  * Ajout de la prise en charge de deux nouvelles options de configuration :

    * `distributed_tracing.sampler.remote_parent_sampled`
    * `distributed_tracing.sampler.remote_parent_not_sampled`

  * `default` est le comportement par défaut et se comporte comme avant ce changement (il transmet la décision d&apos;échantillonnage à l&apos;algorithme d&apos;échantillonnage adaptatif pour déterminer si la transaction sera échantillonnée).

  * `always_on` signifie que la trace qui a un parent distant échantillonné ou un parent distant non échantillonné sera toujours échantillonnée.

  * `always_off` signifie que la trace qui a un parent distant échantillonné ou un parent distant non échantillonné ne sera jamais échantillonnée.

## Débogage

* Ajouter une protection pour le chemin unique le plus profond dans GraphQL

  * Certains utilisateurs rencontraient des problèmes avec le chemin unique le plus profond dans [GraphQL](https://pypi.org/project/graphql-core/) qui n&apos;était pas généré en raison d&apos;un nom de champ renvoyant `None`. Ce problème a été résolu.

* Ajouter une protection pour l&apos;analyse des requêtes Web

  * Certains utilisateurs ont rencontré une erreur d&apos;analyse lorsque `request_uri` était mal formé ou contenait des caractères non valides. Cela peut se produire à ce stade si le `request_uri` dans l&apos;en-tête de la requête n&apos;est pas valide et ne correspond pas à l&apos;URL (valide) fournie à l&apos;origine. Bien que cette protection ait désormais été mise en place dans New Relic, `urllib` a résolu ce problème pour les versions de Python sortie après le 31 janvier 2025.

* Correction du crash dans ElasticSearch et GraphQL lorsque `trace.settings==None`

  * Dans les cas où `trace.settings` est `None`, l&apos;instrumentation pour ElasticSearch a fait planter l&apos;application. Une solution de secours `global_settings` a été mise en place. Cela résout également le même problème rencontré dans GraphQL.

* Supprimer la méthode `options` de la liste des clients ElasticSearch asynchrones

  * L&apos;instrumentation précédente d&apos;ElasticSearch a provoqué un crash car `options` figurait dans la liste des méthodes asynchrones. Cette méthode n&apos;est plus encapsulée dans un `DatastoreTrace` car elle n&apos;effectue aucune opération/requests datastore.

## Déclaration de soutien

Nous vous recommandons de mettre à jour vers la dernière version de l&apos;agent dès qu&apos;elle est disponible. Si vous ne pouvez pas effectuer la mise à niveau vers la dernière version, mettez à jour vos agents vers une version datant de moins de 90 jours. En savoir [plus](/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/) sur la façon de tenir les agents informés.

[Consultez la politique EOL de](/docs/apm/agents/python-agent/getting-started/python-agent-eol-policy/) l&apos;agent Python de New Relic pour obtenir des informations sur la sortie de l&apos;agent et les dates de support.