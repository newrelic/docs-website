---
title: Gérer le moniteur de pas
tags:
  - Synthetics
  - APIs
  - NerdGraph
  - Examples
metaDescription: How to use New Relic NerdGraph API to create and update step monitors for synthetic monitoring.
freshnessValidatedDate: never
translationType: machine
---

New Relic vous permet d&apos;utiliser NerdGraph pour créer [un moniteur de pas](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors). Step Monitor offre monitoring multi-étapes sans code, basée sur un navigateur, qui vous permet de configurer des workflows utilisateur complexes sans écrire une seule ligne de code. Ce tutoriel fournit des exemples d&apos;utilisation de l&apos;API NerdGraph pour automatiser la création d&apos;un moniteur de pas.

## Créer un moniteur de pas [#create-step-monitor]

Vous pouvez créer un moniteur de pas en utilisant la mutation `syntheticsCreateStepMonitor`. Cette mutation vous permet de configurer monitoring en plusieurs étapes des navigateurs avec une série d&apos;actions prédéfinies.

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `accountId`
      </td>

      <td>
        Entier
      </td>

      <td>
        Oui
      </td>

      <td>
        Votre 

        [identifiant de compte](/docs/accounts/accounts-billing/account-structure/account-id)

         New Relic sur lequel le moniteur sera créé.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        Navigateur(s) que le moniteur utilisera pour exécuter des tâches. Navigateurs pris en charge : 

        `CHROME`

        , 

        `FIREFOX`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        Dispositifs que le système de monitoring utilisera pour exécuter les tâches. Appareils pris en charge : 

        `DESKTOP`

        , 

        `MOBILE_LANDSCAPE`

        , 

        `MOBILE_PORTRAIT`

        , 

        `TABLET_LANDSCAPE`

        , 

        `TABLET_PORTRAIT`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        éventail d&apos;identifiants 

        [publics d&apos;emplacement](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

         où le moniteur effectuera des vérifications (par exemple, 

        `["US_EAST_1", "US_WEST_1"]`

        ).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Nom d&apos;affichage de votre podomètre.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Oui
      </td>

      <td>
        Fréquence d&apos;exécution du moniteur. Options : 

        `EVERY_MINUTE`

        , 

        `EVERY_5_MINUTES`

        , 

        `EVERY_10_MINUTES`

        , 

        `EVERY_15_MINUTES`

        , 

        `EVERY_30_MINUTES`

        , 

        `EVERY_HOUR`

        , 

        `EVERY_6_HOURS`

        , 

        `EVERY_12_HOURS`

        , 

        `EVERY_DAY`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Le type d&apos;exécution utilisé par votre moniteur. 

        `CHROME_BROWSER`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        La version du type d&apos;exécution utilisée par votre moniteur. 

        `100`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Oui
      </td>

      <td>
        État du moniteur. Options : 

        `ENABLED`

         (le moniteur est actif et effectue des vérifications), 

        `DISABLED`

         (le moniteur est inactif).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.steps`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        La série d&apos;étapes que le moniteur exécutera. Chaque objet étape contient : 

        `ordinal`

         (position de l&apos;étape, 0-99), 

        `type`

         (type d&apos;étape comme 

        `NAVIGATE`

        , 

        `CLICK_ELEMENT`

        , 

        `DOUBLE_CLICK_ELEMENT`

        , 

        `ASSERT_TEXT`

        , 

        `ASSERT_TITLE`

        , etc.), et 

        `values`

         (éventail de valeurs spécifiques au type d&apos;étape).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Non
      </td>

      <td>
        Capture une capture d&apos;écran pendant l&apos;exécution d&apos;une tâche lorsqu&apos;une panne survient ou qu&apos;un script est exécuté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        Virgule flottante
      </td>

      <td>
        Non
      </td>

      <td>
        L&apos;Apdex cible du moniteur en secondes, utilisé pour alimenter les rapports SLA. Par défaut, 7,0 secondes.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsCreateStepMonitor(
    accountId: ACCOUNT_ID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
      }
      status: STATUS
      steps: [
        {
          ordinal: 0,
          type: NAVIGATE,
          values: ["MONITORED_URI", "USER_AGENT"] }
        {
          ordinal: STEP_NUMBER
          type: STEP_TYPE
          values: ["CONDITIONAL_TYPE", "VALUE"]
        }
      ]
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsCreateStepMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la création du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Mettre à jour un moniteur de pas [#update-step-monitor]

Vous pouvez mettre à jour un moniteur de pas existant en utilisant la mutation `syntheticsUpdateStepMonitor`. Cela vous permet de modifier la configuration d&apos;un moniteur de pas déjà créé.

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `guid`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        L&apos;identifiant unique 

        [GUID](/docs/apis/nerdgraph/examples/synthetics-api/query-synthetics-data#query-monitors)

         de l&apos;entité du moniteur que vous souhaitez mettre à jour.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        Navigateur(s) que le moniteur utilisera pour exécuter des tâches. Navigateurs pris en charge : 

        `CHROME`

        , 

        `FIREFOX`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        Dispositifs que le système de monitoring utilisera pour exécuter les tâches. Appareils pris en charge : 

        `DESKTOP`

        , 

        `MOBILE_LANDSCAPE`

        , 

        `MOBILE_PORTRAIT`

        , 

        `TABLET_LANDSCAPE`

        , 

        `TABLET_PORTRAIT`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        éventail d&apos;identifiants 

        [publics d&apos;emplacement](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

         où le moniteur effectuera des vérifications (par exemple, 

        `["US_EAST_1", "US_WEST_1"]`

        ).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        Le nom d&apos;affichage mis à jour pour votre podomètre.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Non
      </td>

      <td>
        Fréquence d&apos;exécution du moniteur. Options : 

        `EVERY_MINUTE`

        , 

        `EVERY_5_MINUTES`

        , 

        `EVERY_10_MINUTES`

        , 

        `EVERY_15_MINUTES`

        , 

        `EVERY_30_MINUTES`

        , 

        `EVERY_HOUR`

        , 

        `EVERY_6_HOURS`

        , 

        `EVERY_12_HOURS`

        , 

        `EVERY_DAY`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        Le type d&apos;exécution utilisé par votre moniteur. 

        `CHROME_BROWSER`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        La version du type d&apos;exécution utilisée par votre moniteur. 

        `100`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Non
      </td>

      <td>
        État du moniteur. Options : 

        `ENABLED`

         (le moniteur est actif et effectue des vérifications), 

        `DISABLED`

         (le moniteur est inactif).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.steps`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        La série d&apos;étapes que le moniteur exécutera. Chaque objet étape contient : 

        `ordinal`

         (position de l&apos;étape, 0-99), 

        `type`

         (type d&apos;étape comme 

        `NAVIGATE`

        , 

        `CLICK_ELEMENT`

        , 

        `DOUBLE_CLICK_ELEMENT`

        , 

        `ASSERT_TEXT`

        , 

        `ASSERT_TITLE`

        , etc.), et 

        `values`

         (éventail de valeurs spécifiques au type d&apos;étape).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Non
      </td>

      <td>
        Capture une capture d&apos;écran pendant l&apos;exécution d&apos;une tâche lorsqu&apos;une panne survient ou qu&apos;un script est exécuté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        Virgule flottante
      </td>

      <td>
        Non
      </td>

      <td>
        L&apos;Apdex cible du moniteur en secondes, utilisé pour alimenter les rapports SLA. Par défaut, 7,0 secondes.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsUpdateStepMonitor(
    guid: ENTITY_GUID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
      }
      status: STATUS
      steps: [
        {
          ordinal: 0,
          type: NAVIGATE,
          values: ["MONITORED_URI", "USER_AGENT"]
        }
        {
          ordinal: STEP_NUMBER,
          type: STEP_TYPE,
          values: ["VALUE_1", "VALUE_2"]
        }
      ]
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsUpdateStepMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la mise à jour du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Supprimer un moniteur de pas [#delete-monitor]

Lorsqu&apos;un moniteur de pas n&apos;est plus nécessaire, vous pouvez le supprimer définitivement à l&apos;aide de la mutation `syntheticsDeleteMonitor`.

Pour supprimer un moniteur, référez-vous à la section [Supprimer un moniteur Synthétique](/docs/apis/nerdgraph/examples/synthetics-api/ping-monitor/#delete-monitor).