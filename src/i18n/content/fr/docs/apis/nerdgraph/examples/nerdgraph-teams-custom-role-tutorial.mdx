---
title: "Tutoriel NerdGraph\_: créer un rôle personnalisé pour les équipes"
tags:
  - Teams
  - APIs
  - NerdGraph
  - Examples
  - Custom roles
metaDescription: How to use New Relic NerdGraph API to create a custom role to create and manage Teams.
freshnessValidatedDate: never
translationType: machine
---

<Callout title="Aperçu">
  Nous travaillons toujours sur cette fonctionnalité, mais nous aimerions que vous l&apos;essayiez !

  Cette fonctionnalité est actuellement fournie dans le cadre d&apos;un programme d&apos;aperçu conformément à nos [politiques de pré-sortie](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

New Relic Teams vous permet de connecter l&apos;entité que vous monitoring aux équipes qui en sont propriétaires. Lorsque vous pouvez facilement voir à qui appartient une entité, vous pouvez accélérer le dépannage, améliorer la collaboration au sein de l’équipe et améliorer votre efficacité opérationnelle.

## Accès par défaut aux équipes

New Relic fournit un accès par défaut aux équipes via ces rôles standard :

* **Accès en lecture**: tous les utilisateurs ont un accès en lecture aux équipes, y compris aux métadonnées telles que les informations de contact, les membres de l&apos;équipe et d&apos;autres détails pertinents.
* **Modifier les équipes**: l&apos;utilisateur avec le rôle **Organization Product Admin** peut modifier les équipes. Il s&apos;agit d&apos;un nouveau rôle attribué à tous les utilisateurs qui ont actuellement le rôle **All Product Admin**.
* **Créer et supprimer des équipes**: l&apos;utilisateur avec les rôles **Organization Manager** ou **Authentication Manager** peut créer et supprimer des équipes.

Vous pourriez avoir besoin d’un rôle personnalisé si les autorisations par défaut ne répondent pas aux besoins de votre organisation. Ce tutoriel vous montre comment utiliser les mutations NerdGraph GraphQL pour créer un rôle personnalisé pour la gestion des équipes.

### Aperçu du processus

Pour créer un rôle personnalisé d’administrateur Teams, vous devez :

1. [Récupérer toutes les capacités de l&apos;organisation](#retrieve-organization-scoped-capabilities)
2. [Récupérez votre identifiant d&apos;organisation](#retrieve-your-organization-id)
3. [Identifier les identifiants d&apos;autorisation requis pour les équipes](#retrieve-organization-scoped-capabilities)
4. [Créer le rôle personnalisé pour l&apos;administrateur Teams](#create-custom-role)
5. [Ajouter le rôle personnalisé à un groupe d&apos;utilisateurs](#add-custom-role-to-a-user-group)

## Prérequis

Avant de commencer, assurez-vous d’avoir :

* [Exigences générales de NerdGraph](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph/#authentication)
* Autorisations du rôle d&apos;administrateur d&apos;organisation pour créer des rôles personnalisés

## Mutations [#mutations]

New Relic fournit diverses mutations NerdGraph pour créer un rôle personnalisé pour les chefs d&apos;équipe.

<CollapserGroup>
  <Collapser id="retrieve-organization-scoped-capabilities" title="Récupérer les capacités à l'échelle de l'organisation">
    Utilisez la mutation `customerAdministration` pour récupérer une liste de capacités, leurs identifiants d&apos;autorisation et les informations associées.

    #### Paramètres d&apos;entrée

    <table>
      <thead>
        <tr>
          <th>
            paramètres
          </th>

          <th>
            Type de données
          </th>

          <th>
            Est-ce obligatoire ?
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `eq`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            Définissez la valeur sur 

            `organization`

             pour récupérer le rôle pour Teams.
          </td>
        </tr>
      </tbody>
    </table>

    #### Demande d&apos;échantillon

    ```graphql
      {
      customerAdministration {
        permissions(filter: {scope: {eq: "organization"}}) {
            items {
              feature
              category
              id
              product
            }
          }
        }
      }

    ```

    #### Exemple de réponse

    ```graphql
    {
      "data": {
        "customerAdministration": {
          "permissions": {
            "items": [
              {
                "category": "READ",
                "feature": "Teams",
                "id": "xxxxx",
                "product": "New Relic One"
              },
              {
                "category": "OTHER",
                "feature": "Teams",
                "id": "xxxxxx",
                "product": "New Relic One"
              },
              {
                "category": "DELETE",
                "feature": "Teams",
                "id": "xxxxx",
                "product": "New Relic One"
              },
              {
                "category": "MODIFY",
                "feature": "Teams",
                "id": "xxxxxx",
                "product": "New Relic One"
              }
            ]
          }
        }
      }
    }

    ```

    **Étape suivante**: À partir de la réponse, identifiez et copiez les identifiants d’autorisation où :

    * `category: "MANAGE"` (ou la catégorie appropriée à vos besoins)
    * `feature: "Teams"`

    Vous aurez besoin de ces identifiants pour l’étape suivante.
  </Collapser>

  <Collapser id="retrieve-your-organization-id" title="Récupérez votre identifiant d'organisation">
    Récupérez l&apos;ID de votre organisation, que vous utiliserez dans les mutations ultérieures.

    #### Demande d&apos;échantillon

    ```graphql
      {
      actor {
        organization {
          id
          }
        }
      }

    ```

    #### Exemple de réponse

    ```graphql
    {
      "data": {
        "actor": {
          "organization": {
            "id": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"
          }
        }
      }
    }

    ```

    **Étape suivante**: copiez l’ID de votre organisation à partir de la réponse. Vous en aurez besoin pour créer le rôle personnalisé.
  </Collapser>

  <Collapser id="create-custom-role" title="Créer un rôle personnalisé">
    Utilisez la mutation `customRoleCreate` pour créer votre rôle personnalisé pour la gestion des équipes.

    #### Paramètres d&apos;entrée

    <table>
      <thead>
        <tr>
          <th>
            paramètres
          </th>

          <th>
            Type de données
          </th>

          <th>
            Est-ce obligatoire ?
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `id`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            L’ID de l’organisation copié à l’étape précédente.
          </td>
        </tr>

        <tr>
          <td>
            `type`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            Définissez le type sur 

            `organization`

            .
          </td>
        </tr>

        <tr>
          <td>
            `name`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            Le nom du rôle.
          </td>
        </tr>

        <tr>
          <td>
            `permissionId`
          </td>

          <td>
            Éventail d&apos;entiers
          </td>

          <td>
            Oui
          </td>

          <td>
            Les ID d’autorisation pour la fonctionnalité Teams récupérés lors de la première étape.
          </td>
        </tr>

        <tr>
          <td>
            `scope`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            Définissez la portée sur 

            `organization`

            .
          </td>
        </tr>
      </tbody>
    </table>

    #### Demande d&apos;échantillon

    ```graphql

    mutation {
      customRoleCreate(
        container: {id: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX", type: "organization"}
        name: "Teams manager"
        permissionIds: [xxxxx, xxxxx]
        scope: "organization"
      ) {
        id
      }
    }

    ```

    #### Exemple de réponse

    ```graphql

    {
      "data": {
        "customRoleCreate": {
          "id": 9999999
        }
      }
    }

    ```

    **Étape suivante**: enregistrez l’ID de rôle renvoyé. Vous en aurez besoin pour attribuer ce rôle à un groupe d&apos;utilisateurs.
  </Collapser>

  <Collapser id="add-custom-role-to-a-user-group" title="Ajouter un rôle personnalisé à un groupe d'utilisateurs">
    Après avoir créé le rôle personnalisé, vous devez l’attribuer à un groupe d’utilisateurs dans New Relic.

    ### Étape 1 : Récupérer les identifiants de groupe

    Utilisez la mutation `customerAdministration` pour obtenir une liste des groupes d’utilisateurs disponibles.

    #### Paramètres d&apos;entrée

    <table>
      <thead>
        <tr>
          <th>
            paramètres
          </th>

          <th>
            Type de données
          </th>

          <th>
            Est-ce obligatoire ?
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `id`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            L’ID de l’organisation copié à l’étape précédente.
          </td>
        </tr>
      </tbody>
    </table>

    #### Demande d&apos;échantillon

    ```graphql

    {
      customerAdministration {
        groups(filter: {organizationId: {eq: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}}) {
          nextCursor
          items {
            id
            name
            users {
              items {
                id
                email
              }
            }
          }
        }
      }
    }

    ```

    **Étape suivante**: à partir de la réponse, copiez l’ID de groupe du groupe auquel vous souhaitez attribuer le rôle Teams.

    ### Étape 2 : Attribuer le rôle à un groupe d’utilisateurs

    Utilisez la mutation `authorizationManagementGrantAccess` pour attribuer le rôle personnalisé à un groupe d’utilisateurs.

    #### Paramètres d&apos;entrée

    <table>
      <thead>
        <tr>
          <th>
            paramètres
          </th>

          <th>
            Type de données
          </th>

          <th>
            Est-ce obligatoire ?
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `roleId`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            L’ID de rôle personnalisé de l’étape précédente.
          </td>
        </tr>

        <tr>
          <td>
            `groupId`
          </td>

          <td>
            Chaîne
          </td>

          <td>
            Oui
          </td>

          <td>
            L&apos;ID de groupe de l&apos;étape 1.
          </td>
        </tr>
      </tbody>
    </table>

    #### Demande d&apos;échantillon

    ```graphql
    mutation {
      authorizationManagementGrantAccess(
        grantAccessOptions: {organizationAccessGrants: {roleId: "99999999"}, groupId: "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX"}
      ) {
        roles {
          id
          name
          organizationId
          roleId
          groupId
          displayName
        }
      }
    }

    ```

    #### Exemple de réponse

    ```graphql
    {
      "data": {
        "authorizationManagementGrantAccess": {
          "roles": [
            {
              "displayName": "Teams manager",
              "groupId": null,
              "id": "99999999",
              "name": "teams_manager",
              "organizationId": "xxx****xxx-xx**00**-xxx-x*x*-xx**XXX**XX",
              "roleId": 99999
            }
          ]
        }
      }
    }

    ```
  </Collapser>
</CollapserGroup>

## Et ensuite ?

Après avoir créé et attribué avec succès votre rôle Teams personnalisé, l&apos;utilisateur du groupe attribué disposera des autorisations que vous avez configurées. Tu peux:

* Monitorer l&apos;utilisation du rôle via la gestion des utilisateurs de votre organisation
* Modifiez les autorisations de rôle si nécessaire en utilisant des mutations NerdGraph similaires
* Créez des rôles personnalisés supplémentaires pour différents niveaux d&apos;accès aux équipes

Pour plus d&apos;informations sur Teams, consultez notre [documentation Teams](/docs/service-architecture-intelligence/teams/teams/).