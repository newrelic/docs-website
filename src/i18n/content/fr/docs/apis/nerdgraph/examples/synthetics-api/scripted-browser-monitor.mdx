---
title: Manage moniteur de navigateur scripté
tags:
  - Synthetics
  - APIs
  - NerdGraph
  - Examples
metaDescription: How to use New Relic NerdGraph API to create and update scripted browser monitors for synthetic monitoring.
freshnessValidatedDate: never
translationType: machine
---

New Relic vous permet d&apos;utiliser NerdGraph pour créer [un moniteur de navigateur scripté](/docs/synthetics/synthetic-monitoring/scripting-monitors/introduction-scripted-browser-monitors). moniteur de navigateur scripté exécute du code JavaScript personnalisé dans un véritable environnement de navigateur, vous permettant de simuler une interaction utilisateur complexe et des workflows en plusieurs étapes. Ce tutoriel fournit des exemples d&apos;utilisation de l&apos;API NerdGraph pour automatiser la création de moniteurs de navigateur scriptés.

## Créer un moniteur de navigateur scripté [#create-scripted-browser]

Vous pouvez créer un moniteur de navigateur scripté en utilisant la mutation `syntheticsCreateScriptBrowserMonitor`. Cette mutation vous permet de configurer monitoring personnalisée par script qui exécute votre code JavaScript dans un navigateur.

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `accountId`
      </td>

      <td>
        Entier
      </td>

      <td>
        Oui
      </td>

      <td>
        Votre 

        [identifiant de compte](/docs/accounts/accounts-billing/account-structure/account-id)

         New Relic sur lequel le moniteur sera créé.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        Navigateur(s) que le moniteur utilisera pour exécuter des tâches. Navigateurs pris en charge : 

        `CHROME`

        , 

        `FIREFOX`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        Dispositifs que le système de monitoring utilisera pour exécuter les tâches. Appareils pris en charge : 

        `DESKTOP`

        , 

        `MOBILE_LANDSCAPE`

        , 

        `MOBILE_PORTRAIT`

        , 

        `TABLET_LANDSCAPE`

        , 

        `TABLET_PORTRAIT`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        Array
      </td>

      <td>
        Oui
      </td>

      <td>
        éventail d&apos;identifiants 

        [publics d&apos;emplacement](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

         où le moniteur effectuera des vérifications (par exemple, 

        `["US_EAST_1", "US_WEST_1"]`

        ).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Nom d&apos;affichage de votre moniteur de navigateur scripté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Oui
      </td>

      <td>
        Fréquence d&apos;exécution du moniteur. Options : 

        `EVERY_MINUTE`

        , 

        `EVERY_5_MINUTES`

        , 

        `EVERY_10_MINUTES`

        , 

        `EVERY_15_MINUTES`

        , 

        `EVERY_30_MINUTES`

        , 

        `EVERY_HOUR`

        , 

        `EVERY_6_HOURS`

        , 

        `EVERY_12_HOURS`

        , 

        `EVERY_DAY`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Le type d&apos;exécution utilisé par votre moniteur. 

        `CHROME_BROWSER`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        La version du type d&apos;exécution utilisée par votre moniteur. 

        `100`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.scriptLanguage`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        La langue utilisée par votre moniteur. 

        `JAVASCRIPT`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.script`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Le code JavaScript exécuté par le moniteur. Il doit s&apos;agir de texte brut, et non d&apos;un encodage en base64. Le script peut utiliser les API Sélénium WebDriver pour contrôler le navigateur.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Oui
      </td>

      <td>
        État du moniteur. Options : 

        `ENABLED`

         (le moniteur est actif et effectue des vérifications), 

        `DISABLED`

         (le moniteur est inactif).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Non
      </td>

      <td>
        Capture une capture d&apos;écran pendant l&apos;exécution d&apos;une tâche lorsqu&apos;une panne survient ou qu&apos;un script est exécuté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        Virgule flottante
      </td>

      <td>
        Non
      </td>

      <td>
        L&apos;Apdex cible du moniteur en secondes, utilisé pour alimenter les rapports SLA. Par défaut, 7,0 secondes.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsCreateScriptBrowserMonitor(
    accountId: ACCOUNT_ID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
        scriptLanguage: "SCRIPT_LANGUAGE"
      }
      script: "SCRIPT_CONTENT"
      status: STATUS
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsCreateScriptBrowserMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la création du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Mettre à jour un moniteur de navigateur scripté [#update-scripted-browser]

Vous pouvez mettre à jour un moniteur de navigateur scripté existant en utilisant la mutation `syntheticsUpdateScriptBrowserMonitor`. Cela vous permet de modifier la configuration d&apos;un moniteur de navigateur scripté qui a déjà été créé.

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `guid`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        L&apos;identifiant unique 

        [GUID](/docs/apis/nerdgraph/examples/synthetics-api/query-synthetics-data#query-monitors)

         de l&apos;entité du moniteur que vous souhaitez mettre à jour.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.browsers`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        Navigateur(s) que le moniteur utilisera pour exécuter des tâches. Navigateurs pris en charge : 

        `CHROME`

        , 

        `FIREFOX`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.devices`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        Dispositifs que le système de monitoring utilisera pour exécuter les tâches. Appareils pris en charge : 

        `DESKTOP`

        , 

        `MOBILE_LANDSCAPE`

        , 

        `MOBILE_PORTRAIT`

        , 

        `TABLET_LANDSCAPE`

        , 

        `TABLET_PORTRAIT`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.locations.public`
      </td>

      <td>
        Array
      </td>

      <td>
        Non
      </td>

      <td>
        éventail d&apos;identifiants 

        [publics d&apos;emplacement](/docs/synthetics/synthetic-monitoring/using-monitors/add-edit-monitors/#setting-location)

         où le moniteur effectuera des vérifications (par exemple, 

        `["US_EAST_1", "US_WEST_1"]`

        ).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        Le nom d&apos;affichage mis à jour pour votre moniteur de navigateur scripté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.period`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Non
      </td>

      <td>
        Fréquence d&apos;exécution du moniteur. Options : 

        `EVERY_MINUTE`

        , 

        `EVERY_5_MINUTES`

        , 

        `EVERY_10_MINUTES`

        , 

        `EVERY_15_MINUTES`

        , 

        `EVERY_30_MINUTES`

        , 

        `EVERY_HOUR`

        , 

        `EVERY_6_HOURS`

        , 

        `EVERY_12_HOURS`

        , 

        `EVERY_DAY`

        .
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        Le type d&apos;exécution utilisé par votre moniteur. 

        `CHROME_BROWSER`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        La version du type d&apos;exécution utilisée par votre moniteur. 

        `100`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.scriptLanguage`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        La langue utilisée par votre moniteur. 

        `JAVASCRIPT`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.script`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Non
      </td>

      <td>
        Le code JavaScript exécuté par le moniteur. Il doit s&apos;agir de texte brut, et non d&apos;un encodage en base64.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.status`
      </td>

      <td>
        Énumération
      </td>

      <td>
        Non
      </td>

      <td>
        État du moniteur. Options : 

        `ENABLED`

         (le moniteur est actif et effectue des vérifications), 

        `DISABLED`

         (le moniteur est inactif).
      </td>
    </tr>

    <tr>
      <td>
        `monitor.advancedOptions.enableScreenshotOnFailureAndScript`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Non
      </td>

      <td>
        Capture une capture d&apos;écran pendant l&apos;exécution d&apos;une tâche lorsqu&apos;une panne survient ou qu&apos;un script est exécuté.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.apdexTarget`
      </td>

      <td>
        Virgule flottante
      </td>

      <td>
        Non
      </td>

      <td>
        L&apos;Apdex cible du moniteur en secondes, utilisé pour alimenter les rapports SLA. Par défaut, 7,0 secondes.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsUpdateScriptBrowserMonitor(
    guid: ENTITY_GUID
    monitor: {
      browsers: [BROWSERS]
      devices: [DEVICES]
      locations: { public: ["LOCATION_1", "LOCATION_2"] }
      name: "MONITOR_NAME"
      period: PERIOD
      runtime: {
        runtimeType: "RUNTIME_TYPE"
        runtimeTypeVersion: "RUNTIME_TYPE_VERSION"
        scriptLanguage: "SCRIPT_LANGUAGE"
      }
      script: "SCRIPT_CONTENT"
      status: STATUS
      advancedOptions: { enableScreenshotOnFailureAndScript: ENABLE_SCREENSHOT }
      apdexTarget: APDEX_TARGET
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsUpdateScriptBrowserMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la mise à jour du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Mettre à niveau l&apos;exécution d&apos;un moniteur de navigateur scripté [#upgrade-monitor-runtime]

Vous pouvez mettre à niveau un moniteur de navigateur scripté pour utiliser le nouvel environnement d&apos;exécution Chrome 100+. Cela garantit que votre moniteur utilise les dernières fonctionnalités du navigateur et les mises à jour de sécurité.

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `guid`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        L&apos;identifiant unique 

        [GUID](/docs/apis/nerdgraph/examples/synthetics-api/query-synthetics-data#query-monitors)

         de l&apos;entité du moniteur que vous souhaitez mettre à niveau.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Le type d&apos;exécution. 

        `CHROME_BROWSER`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        La version d&apos;exécution. 

        `100`

         est la seule valeur acceptée.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.scriptLanguage`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Le langage de script. 

        `JAVASCRIPT`

         est la seule valeur acceptée.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsUpdateScriptBrowserMonitor(
    guid: "ENTITY_GUID",
    monitor: {
      runtime: {
        runtimeType: "CHROME_BROWSER",
        runtimeTypeVersion: "100",
        scriptLanguage: "JAVASCRIPT"
      }
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsUpdateScriptBrowserMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la mise à niveau de l&apos;environnement d&apos;exécution du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Rétrograder la durée d&apos;exécution d&apos;un moniteur de navigateur scripté [#downgrade-monitor-runtime]

Vous pouvez rétrograder un moniteur de navigateur scripté pour utiliser un runtime legacy. Cela peut s&apos;avérer nécessaire pour des raisons de compatibilité, mais veuillez noter que legacy environnements d&apos;exécution ne seront plus pris en charge le 22 octobre 2024.

<Callout variant="important">
  Les environnements d&apos;exécution hérités sont obsolètes et leur fin de vie est prévue pour le 22 octobre 2024. Le retour à des environnements d&apos; legacy n&apos;est pas recommandé, sauf pour des besoins de compatibilité temporaires.
</Callout>

### Paramètres d&apos;entrée

<table>
  <thead>
    <tr>
      <th>
        paramètres
      </th>

      <th>
        Type de données
      </th>

      <th>
        Est-ce obligatoire ?
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `guid`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        L&apos;identifiant unique 

        [GUID](/docs/apis/nerdgraph/examples/synthetics-api/query-synthetics-data#query-monitors)

         de l&apos;entité du moniteur que vous souhaitez rétrograder.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Définissez la valeur sur une chaîne vide 

        `""`

         pour utiliser l&apos;ancien environnement d&apos; legacy.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.runtimeTypeVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Définissez la valeur sur une chaîne vide 

        `""`

         pour utiliser l&apos;ancien environnement d&apos; legacy.
      </td>
    </tr>

    <tr>
      <td>
        `monitor.runtime.scriptLanguage`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Oui
      </td>

      <td>
        Définissez la valeur sur une chaîne vide 

        `""`

         pour utiliser l&apos;ancien environnement d&apos; legacy.
      </td>
    </tr>
  </tbody>
</table>

### Demande d&apos;échantillon

```graphql
mutation {
  syntheticsUpdateScriptBrowserMonitor(
    guid: "ENTITY_GUID",
    monitor: {
      runtime: {
        runtimeType: "",
        runtimeTypeVersion: "",
        scriptLanguage: ""
      }
    }
  ) {
    errors {
      description
      type
    }
  }
}
```

### Exemple de réponse

Une réponse positive renvoie `null` en cas d&apos;erreur :

```json
{
  "data": {
    "syntheticsUpdateScriptBrowserMonitor": {
      "errors": null
    }
  }
}
```

En cas de problème lors de la rétrogradation de l&apos;environnement d&apos;exécution du moniteur, le éventail `errors` contiendra des objets avec des champs `description` et `type` expliquant ce qui s&apos;est mal passé.

## Supprimer un moniteur de navigateur scripté [#delete-monitor]

Lorsqu&apos;un moniteur de navigateur scripté n&apos;est plus nécessaire, vous pouvez le supprimer définitivement à l&apos;aide de la mutation `syntheticsDeleteMonitor`.

Pour supprimer un moniteur, référez-vous à la section [Supprimer un moniteur Synthétique](/docs/apis/nerdgraph/examples/synthetics-api/ping-monitor/#delete-monitor).