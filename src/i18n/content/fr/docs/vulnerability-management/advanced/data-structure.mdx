---
title: Structure de données de sécurité (référence NRQL)
metaDescription: Learn about the data structure and entity types used to store security data in New Relic.
freshnessValidatedDate: never
translationType: machine
---

Security RX stocke les données de vulnérabilité et de mauvaise configuration dans la base de données (NRDB) de New Relic, ce qui les rend interrogeables à l&apos;aide NRQL. Ce guide de référence explique les types d&apos;entités, les attributs et la structure des données que vous pouvez utiliser pour créer des requêtes, des dashboards et des alertes personnalisés.

## types d&apos;entités et d&apos;événements

Security RX utilise les types d&apos;entités et d&apos;événements suivants pour stocker les données de sécurité :

### Entité SecurityFinding (recommandé)

`SECURITY_FINDING` est un type d&apos;entité spécialisé qui sert de conteneur générique pour tous les problèmes de sécurité détectés par Security RX. Voici la méthode recommandée pour interroger les données de sécurité dans New Relic.

**Important :** SecurityFinding est une requête en tant que type d&apos;entité, et non en tant qu&apos;événement traditionnel :

```sql
FROM Entity
SELECT * WHERE type = 'SECURITY_FINDING'
```

#### Type de découverte

L&apos;attribut `findingType` est le champ clé permettant de distinguer la source de données :

* **`findingType = 'VULNERABILITY'`**: Indique une vulnérabilité détectée par des sources telles que des agents APM, des agents d&apos;infrastructure ou des scanners tiers (Snyk, Trivy, FOSSA).
* **`findingType = 'MISCONFIGURATION'`**: Indique une constatation de gestion de la posture de sécurité du cloud (CSPM) provenant de Security RX Cloud (par exemple, d&apos;AWS Security Hub, GuardDuty ou Config).

Les autres valeurs de findingType incluent : `LIBRARY_VULNERABILITY`, `INFRASTRUCTURE_VULNERABILITY`, `APPLICATION_VULNERABILITY`, `SYSTEM_VULNERABILITY`, `SECURITY_EVENT`, et `OTHER`.

#### Champs d&apos;entité principaux

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Exemple
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `id`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Identifiant unique au monde pour ce SecurityFinding (CVE spécifique au câble et entité impactée)
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `type`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type d&apos;entité - toujours « SECURITY_FINDING »
      </td>

      <td>
        &quot;SECURITY_FINDING&quot;
      </td>
    </tr>

    <tr>
      <td>
        `name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Titre des vulnérabilités ou de la mauvaise configuration
      </td>

      <td>
        &quot;CVE-2024-12345 : Injection SQL dans bibliothèque-name&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.id`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Identifiant du compte où ce problème a été détecté
      </td>

      <td>
        &quot;1234567&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.type`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type de portée - généralement « ACCOUNT »
      </td>

      <td>
        &quot;ACCOUNT&quot;
      </td>
    </tr>

    <tr>
      <td>
        `metadata.createdAt`
      </td>

      <td>
        horodatage
      </td>

      <td>
        Lors de la création de cette entité
      </td>

      <td>
        Horodatage Unix
      </td>
    </tr>

    <tr>
      <td>
        `metadata.updatedAt`
      </td>

      <td>
        horodatage
      </td>

      <td>
        Dernière mise à jour de cette entité
      </td>

      <td>
        Horodatage Unix
      </td>
    </tr>

    <tr>
      <td>
        `tags`
      </td>

      <td>
        Array
      </td>

      <td>
        Liste des étiquettes applicables à l&apos;entité (généralement vide pour SecurityFinding)
      </td>

      <td>
        \[]
      </td>
    </tr>
  </tbody>
</table>

#### Champs de classification

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Exemple
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityIdentifier`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Identifiant permettant d&apos;agréger les SecurityFindings (généralement l&apos;identifiant CVE)
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type de découverte de niveau supérieur
      </td>

      <td>
        &quot;VULNERABILITY&quot;, &quot;MISCONFIGURATION&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingSubType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Sous-type (langage pour les vulnérabilités APM, INFRA_OS_VULNERABILITY ou INFRA_PACKAGE_VULNERABILITY pour l&apos;infrastructure)
      </td>

      <td>
        &quot;java&quot;, &quot;INFRA_PACKAGE_VULNERABILITY&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Source de la découverte
      </td>

      <td>
        « New Relic », « Snyk », « AWS Security Hub »
      </td>
    </tr>
  </tbody>
</table>

#### Champs d&apos;état et de gravité

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Valeurs
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `severity`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Gravité signalée du constat
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;, &quot;UNKNOWN&quot;, &quot;INFO&quot;
      </td>
    </tr>

    <tr>
      <td>
        `status`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        État actuel de la découverte
      </td>

      <td>
        &quot;AFFECTED&quot;, &quot;IGNORED&quot;, &quot;NO_LONGER_DETECTED&quot;, &quot;UNKNOWN&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationExists`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Existe-t-il une solution de remédiation ?
      </td>

      <td>
        true, false
      </td>
    </tr>

    <tr>
      <td>
        `remediation.upgradeAction`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Mise à niveau suggérée par Security RX
      </td>

      <td>
        &quot;Mise à jour vers la version 2.17.1&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationDetails`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Bref texte de correction tiré de la source
      </td>

      <td>
        &quot;Mettre à jour la bibliothèque vers la version corrigée&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.url`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        URL de la documentation provenant de la source
      </td>

      <td>
        &quot;

        [https://example.com/security-advisory](https://example.com/security-advisory)

        &quot;
      </td>
    </tr>
  </tbody>
</table>

#### champs de référence CVE

Pour les résultats de vulnérabilités, l&apos;objet `cve` contient des informations CVE détaillées :

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cve.id`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Identifiant CVE
      </td>
    </tr>

    <tr>
      <td>
        `cve.description`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Description du CVE
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssScore`
      </td>

      <td>
        Nombre
      </td>

      <td>
        score CVSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssVector`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Chaîne vectorielle CVSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssScore`
      </td>

      <td>
        Nombre
      </td>

      <td>
        Score de probabilité d&apos;exploitation EPSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssPercentile`
      </td>

      <td>
        Nombre
      </td>

      <td>
        classement percentile EPSS
      </td>
    </tr>

    <tr>
      <td>
        `cve.exploitKnown`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Existe-t-il une faille connue ?
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosureUrl`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        URL où le CVE a été divulgué
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosedAt`
      </td>

      <td>
        horodatage
      </td>

      <td>
        Lorsque le CVE a été divulgué
      </td>
    </tr>
  </tbody>
</table>

#### Champs de configuration incorrecte (Résultats du cloud)

En cas de résultats de configuration incorrecte, l&apos;objet `misconfiguration` contient des informations spécifiques au cloud :

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `misconfiguration.cloudProvider`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Fournisseur de cloud
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.issueTitle`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Titre de la mauvaise configuration
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.misconfigurationType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type de résultat brut provenant de la source
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.normalizedResourceType`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type de ressource simplifié (par exemple, « S3 », « EC2 », « RDS »)
      </td>
    </tr>
  </tbody>
</table>

#### Champs d&apos;entité concernés

L&apos;objet `impactedEntity` identifie l&apos;entité New Relic concernée :

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `impactedEntity.id`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        GUID de l&apos;entité
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.name`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Nom de l&apos;entité
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.type`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type d&apos;entité (APM-APPLICATION, INFRA-HOST, etc.)
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.id`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        ID de compte
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.type`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Type de portée
      </td>
    </tr>
  </tbody>
</table>

#### Champs d&apos;horodatage

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `firstDetected`
      </td>

      <td>
        horodatage
      </td>

      <td>
        Lorsque cette découverte a été initialement détectée
      </td>
    </tr>

    <tr>
      <td>
        `findingUpdatedAt`
      </td>

      <td>
        horodatage
      </td>

      <td>
        Date de la dernière mise à jour de cette découverte
      </td>
    </tr>

    <tr>
      <td>
        `lastSeen`
      </td>

      <td>
        horodatage
      </td>

      <td>
        La découverte était active pour la dernière fois lorsque la situation s&apos;est améliorée.
      </td>
    </tr>
  </tbody>
</table>

#### Interface utilisateur et champs internes

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityUILinks.detailsUrl`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Lien vers la page de détails dans l&apos;interface utilisateur de Security RX
      </td>
    </tr>

    <tr>
      <td>
        `vulnerabilityUILinks.tabUrl`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Lien vers la vue entité dans l&apos;interface utilisateur Security RX
      </td>
    </tr>

    <tr>
      <td>
        `internalState.status`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Champ d&apos;état interne
      </td>
    </tr>

    <tr>
      <td>
        `internalState.active`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Indicateur actif interne (utilisé dans les requêtes cloud)
      </td>
    </tr>

    <tr>
      <td>
        `entityLookupValue`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Champ interne (sera masqué en production)
      </td>
    </tr>

    <tr>
      <td>
        `issueInstanceKey`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Champ interne (sera masqué en production)
      </td>
    </tr>

    <tr>
      <td>
        `additionalInfo`
      </td>

      <td>
        éventail d&apos;objets
      </td>

      <td>
        Métadonnées supplémentaires avec paires valeur clé (utilisées pour les identifiants de compte cloud, etc.)
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="tip">
  Les champs marqués comme « internes » sont actuellement visibles dans NRDB, mais pourraient être masqués lors du lancement final. Le champ `internalState.active` est couramment utilisé dans les requêtes de mauvaise configuration cloud pour filtrer les résultats actifs.
</Callout>

#### exemples de requêtes pour les vulnérabilités

**Nombre de vulnérabilités critiques actives par entité :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND severity = 'CRITICAL'
FACET impactedEntity.name
```

**Trouver l&apos;entité affectée par une CVE spécifique :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND cve.id = 'CVE-2024-23944'
FACET impactedEntity.name
```

**Identifiez les CVE associées à des campagnes de ransomware actives :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.exploitKnown IS true
FACET impactedEntity.name, cve.id
```

**Identifier les vulnérabilités susceptibles d&apos;être exploitées (score EPSS élevé) :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.epssPercentile > '0.95'
FACET cve.id
```

**Trouvez les sources de vos recherches :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET source
```

**entité à seuil de vulnérabilités élevées :**

```sql
SELECT impactedEntity
FROM (
  SELECT count(*) AS vulnerableCount
  FROM Entity
  WHERE type = 'SECURITY_FINDING'
    AND severity IN ('CRITICAL', 'HIGH')
  FACET impactedEntity.name AS impactedEntity, severity
)
WHERE (severity = 'HIGH' AND vulnerableCount > 10)
   OR (severity = 'CRITICAL' AND vulnerableCount > 5)
```

#### Exemples de requêtes pour les mauvaises configurations cloud

**Nombre de configurations erronées uniques par statut :**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET status
```

**Les 10 types de mauvaises configurations les plus courants :**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.issueTitle
LIMIT 10
```

**Trouvez les comptes AWS les plus risqués :**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity IN ('CRITICAL', 'HIGH')
FACET aparse(additionalInfo, '%"key":"cloudProviderAccountId","values":["*"]%') AS 'AWS Account ID'
LIMIT 10
```

**Nombre d&apos;erreurs de configuration par type de ressource :**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.normalizedResourceType
```

**Trouver des ressources essentielles et accessibles au public :**

```sql
FROM Entity
SELECT name, impactedEntity.name, misconfiguration.misconfigurationType
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity = 'CRITICAL'
  AND misconfiguration.misconfigurationType LIKE 'Effects/Data Exposure'
SINCE 1 day ago
```

### Vulnérabilités (événement personnalisé)

Stocke des métadonnées détaillées sur les vulnérabilités, notamment les informations CVE, les scores de gravité et les recommandations de correction.

**Utilisation principale :** Analyse approfondie des détails et métadonnées des vulnérabilités

**Attribut clé :**

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Type
      </th>

      <th>
        Description
      </th>

      <th>
        Exemple
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cveId`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Identifiant CVE
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `severity`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        gravité basée sur le CVSS
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;
      </td>
    </tr>

    <tr>
      <td>
        `cvssScore`
      </td>

      <td>
        Nombre
      </td>

      <td>
        score numérique CVSS
      </td>

      <td>
        9.8
      </td>
    </tr>

    <tr>
      <td>
        `epssScore`
      </td>

      <td>
        Nombre
      </td>

      <td>
        Probabilité d&apos;exploitation de l&apos;EPSS
      </td>

      <td>
        0,95
      </td>
    </tr>

    <tr>
      <td>
        `epssPercentile`
      </td>

      <td>
        Nombre
      </td>

      <td>
        classement percentile EPSS
      </td>

      <td>
        98,5
      </td>
    </tr>

    <tr>
      <td>
        `activeRansomware`
      </td>

      <td>
        Booléen
      </td>

      <td>
        Utilisé dans des campagnes de ransomware connues
      </td>

      <td>
        `true`, `false`
      </td>
    </tr>

    <tr>
      <td>
        `affectedPackage`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Nom de la bibliothèque/package vulnérable
      </td>

      <td>
        &quot;log4j-core&quot;
      </td>
    </tr>

    <tr>
      <td>
        `affectedVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Version du package vulnérable
      </td>

      <td>
        &quot;2.14.0&quot;
      </td>
    </tr>

    <tr>
      <td>
        `fixedVersion`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Version corrigée
      </td>

      <td>
        &quot;2.17.1&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entityGuid`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        GUID de l&apos;entité concernée
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        Chaîne
      </td>

      <td>
        Source de détection
      </td>

      <td>
        &quot;APM\_AGENT&quot;, &quot;SNYK&quot;, &quot;AWS\_SECURITY\_HUB&quot;
      </td>
    </tr>
  </tbody>
</table>

**Exemple de requête :**

```sql
FROM Vulnerability
SELECT count(*)
WHERE severity = 'CRITICAL'
AND activeRansomware = true
FACET affectedPackage
```

## Attribut commun à tous les types d&apos;événements

Ces attributs apparaissent dans plusieurs types d&apos;événements :

### Identification de l&apos;entité

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        Identifiant unique de l&apos;entité concernée
      </td>
    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        Nom de l&apos;entité lisible par l&apos;humain
      </td>
    </tr>

    <tr>
      <td>
        `entity.type`
      </td>

      <td>
        Type d&apos;entité (APPLICATION, HOST, SERVICE)
      </td>
    </tr>

    <tr>
      <td>
        `accountId`
      </td>

      <td>
        Identifiant de compte New Relic
      </td>
    </tr>
  </tbody>
</table>

### horodatage

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        Lorsque l&apos;événement s&apos;est produit
      </td>
    </tr>

    <tr>
      <td>
        `detectedAt`
      </td>

      <td>
        Lorsque les vulnérabilités ont été détectées pour la première fois
      </td>
    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        Dernière mise à jour horodatage
      </td>
    </tr>

    <tr>
      <td>
        `resolvedAt`
      </td>

      <td>
        Lorsque les vulnérabilités ont été marquées comme résolues
      </td>
    </tr>
  </tbody>
</table>

### Suivi de la source

<table>
  <thead>
    <tr>
      <th>
        Attribut
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `source`
      </td>

      <td>
        Source de données (APM\_AGENT, INFRASTRUCTURE, SNYK, etc.)
      </td>
    </tr>

    <tr>
      <td>
        `sourceId`
      </td>

      <td>
        ID unique du système source
      </td>
    </tr>

    <tr>
      <td>
        `integrationName`
      </td>

      <td>
        intégration qui a fourni des données
      </td>
    </tr>
  </tbody>
</table>

## relations de données

Comprendre les relations entre les types de données :

```
SecurityFinding Entity (type = 'SECURITY_FINDING')
    ↓ contains
    ├─ findingType (VULNERABILITY or MISCONFIGURATION)
    ├─ cve (CVE details for vulnerabilities)
    ├─ misconfiguration (Cloud security details)
    └─ impactedEntity (Affected New Relic entity)
```

## Modèles de requêtes

Pour les modèles de requête utilisant l&apos;entité SecurityFinding, consultez les [sections d&apos;exemples de requête ci-dessus](#query-examples-for-vulnerabilities).

## Types et formats d&apos;attributs

### Valeurs de gravité

```
CRITICAL - CVSS 9.0-10.0
HIGH     - CVSS 7.0-8.9
MEDIUM   - CVSS 4.0-6.9
LOW      - CVSS 0.1-3.9
INFO     - CVSS 0.0
```

### Valeurs d&apos;état

```
OPEN      - Vulnerability currently active
CLOSED    - Vulnerability resolved or fixed
AFFECTED  - Entity is confirmed affected
IGNORED   - Marked as not applicable
NO_LONGER_DETECTED - No longer seen in scans
```

### Valeurs sources

```
APM_AGENT            - Detected by New Relic APM agent
INFRASTRUCTURE       - Detected by Infrastructure agent
SNYK                 - Imported from Snyk
AWS_SECURITY_HUB     - Imported from AWS Security Hub
DEPENDABOT           - Imported from GitHub Dependabot
FOSSA                - Imported from FOSSA
TRIVY                - Imported from Trivy
SECURITY_DATA_API    - Sent via API
```

## Conseils pour les requêtes

### Filtrer par gravité (approche moderne)

Les résultats sont classés par ordre de priorité en fonction de leur gravité :

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND severity IN ('CRITICAL', 'HIGH')
  AND status = 'AFFECTED'
FACET impactedEntity.name
```

### Filtrer par type de recherche

Distinguer les vulnérabilités des erreurs de configuration :

```sql
-- Vulnerabilities only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'VULNERABILITY'
FACET impactedEntity.type

-- Misconfigurations only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET misconfiguration.normalizedResourceType
```

### Filtrer par type d&apos;entité

Distinguer les vulnérabilités de l&apos;application de celles de l&apos;infrastructure :

```sql
-- Application vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%APPLICATION%'
FACET impactedEntity.name

-- Infrastructure vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%HOST%'
FACET impactedEntity.name
```

### Filtrer par source de détection

Résultats de requête issus d&apos;une intégration spécifique :

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND source = 'Snyk'
FACET severity
```

### Filtrage temporel

Trouver les résultats récemment détectés :

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND firstDetected > ago(7 days)
FACET cve.id, severity
```

## Création de dashboards personnalisés

Utilisez l&apos;entité SecurityFinding pour créer des dashboards de sécurité complets :

1. **Dashboard exécutif** - Indicateurs de sécurité de haut niveau pour tous les types de constatations

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET severity, findingType
   ```

2. **Tendances des vulnérabilités** - Suivre la détection des vulnérabilités au fil du temps

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'VULNERABILITY'
   FACET weekOf(firstDetected)
   SINCE 90 days ago
   ```

3. **Posture de sécurité du cloud** - monitoring des erreurs de configuration cloud

   ```sql
   FROM Entity
   SELECT uniqueCount(misconfiguration.issueTitle)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'MISCONFIGURATION'
   FACET misconfiguration.cloudProvider, severity
   ```

4. **Posture de sécurité de l&apos;entité** - Vues de sécurité par entité

   ```sql
   FROM Entity
   SELECT count(*) AS 'Findings'
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET impactedEntity.name, severity
   ```

Pour plus d&apos;exemples de requêtes, consultez [Exemples de requêtes de données de sécurité](/docs/vulnerability-management/advanced/query-examples).

### Approches dashboards héritées

Pour assurer la compatibilité ascendante, vous pouvez toujours utiliser l&apos; legacy type d&apos;événement (`Vulnerability`), mais nous recommandons de migrer vers l&apos;entité SecurityFinding pour les nouveaux dashboards.

## Quelle est la prochaine étape ?

<DocTiles>
  <DocTile title="Exemples de requêtes" path="/docs/vulnerability-management/advanced/query-examples">
    Requête NRQL prête à l&apos;emploi pour les scénarios de sécurité courants
  </DocTile>

  <DocTile title="Configurer des alertes" path="/docs/vulnerability-management/advanced/set-up-alerts">
    Créer des alertes basées sur NRQL pour les vulnérabilités
  </DocTile>

  <DocTile title="Gérer l'état des vulnérabilités" path="/docs/vulnerability-management/advanced/manage-vulnerability-status">
    Modifier l&apos;état des vulnérabilités et suivre les mesures correctives
  </DocTile>
</DocTiles>