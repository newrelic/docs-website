---
title: Installer le gestionnaire de tâches Synthetics
tags:
  - Synthetics
  - Synthetic monitoring
  - Private locations
metaDescription: Install New Relic's container based job manager that accepts and runs jobs assigned to your private locations
freshnessValidatedDate: never
translationType: machine
---

Nos gestionnaires de tâches monitoring Synthétique sont des ressources basées sur [un conteneur Docker ](https://www.docker.com/resources/what-container)qui acceptent et exécutent [le moniteur Synthétique](/docs/synthetics/synthetic-monitoring/using-monitors/intro-synthetic-monitoring/#types-of-synthetic-monitors) affecté au [site privé](/docs/synthetics/synthetic-monitoring/private-locations/private-locations-overview-monitor-internal-sites-add-new-locations).

Le gestionnaire de tâches peut fonctionner dans un environnement de système de conteneur Docker, un environnement de système de conteneur Podman, un environnement de système d&apos;orchestration de conteneur Kubernetes ou un environnement de système de conteneur OpenShift. Le gestionnaire de tâches détecte automatiquement son environnement pour sélectionner le mode de fonctionnement approprié.

## Fonctionnalité du gestionnaire de tâches Synthetics [#enhancements]

Étant donné que le gestionnaire de tâches Synthetics fonctionne comme un conteneur plutôt que comme une machine virtuelle, nous avons simplifié [l&apos;installation](#install), [la prise en main ](#start)et [la mise à jour](#install) de votre gestion et de votre orchestration des tâches. Il est également livré avec quelques fonctionnalités supplémentaires :

* Compatible avec Linux, [macOS](https://docs.docker.com/docker-for-mac/) et [Windows](https://docs.docker.com/docker-for-windows/).
* [Sécurité](#security) et prise en charge améliorées pour l&apos;exécution des utilisateurs [non root](#run-as-non-root) .
* Capacité à exploiter un conteneur Docker comme environnement [sandbox](#docker-dependencies) .

## Fonctionnalité spécifique Kubernetes [#kubernetes-enhancements]

Le gestionnaire de tâches introduit certaines fonctionnalités supplémentaires spécifiques à Kubernetes :

* Utilise les ressources Kubernetes CronJob pour exécuter un moniteur sans ping
* Ne nécessite pas d&apos;accès privilégié au socket Docker
* Prend en charge les clusters Kuberneteshébergés et sur site
* Prend en charge divers moteurs de conteneurs tels que Docker et Containerd
* Déployable via des graphiques Helm ainsi que des fichiers YAML de configuration
* Permet une allocation de ressources configurable en fonction de l&apos;exécution des tâches (ping, API et navigateur) pour une gestion optimale des ressources
* observabilité offerte via cluster Kubernetes l&apos;explorateur New Relic

## exigence système et compatibilité [#system-requirements]

Pour héberger les gestionnaires de tâches Synthetics, votre système doit répondre aux exigences minimales pour l&apos;environnement système choisi.

<Callout variant="caution">
  Ne modifiez aucun fichier du gestionnaire de tâches Synthetics. New Relic n&apos;est pas responsable des modifications que vous apportez. Pour plus d&apos;informations, contactez votre représentant de compte ou un [représentant commercial technique](https://newrelic.com/contact-sales) New Relic.
</Callout>

<CollapserGroup>
  <Collapser
    id="docker-requirements"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Configuration requise pour l'environnement du système conteneur Docker</>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilité pour
          </th>

          <th>
            Exigences
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            système d&apos;exploitation
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou supérieur<br /> <DNT>**macOS:**</DNT> 10.11 ou supérieur<br /> <DNT>**Windows:**</DNT> Windows 10 64 bits ou supérieur

            Vous devez également configurer Docker pour exécuter le conteneur Linux afin que les gestionnaires de tâches Synthetics fonctionnent sur le système Windows .
          </td>
        </tr>

        <tr>
          <td>
            Processeur
          </td>

          <td>
            Un processeur multicœur AMD64 ou x86\_64 moderne
          </td>
        </tr>

        <tr>
          <td>
            mémoire
          </td>

          <td>
            3,256 Gio de RAM par cœur de processeur (dédié)
          </td>
        </tr>

        <tr>
          <td>
            Taille du disque
          </td>

          <td>
            Un minimum de 50 Gio par hôte
          </td>
        </tr>

        <tr>
          <td>
            Système de fichiers sur disque
          </td>

          <td>
            NFSv4.1 ou supérieur (si vous utilisez NFS)
          </td>
        </tr>

        <tr>
          <td>
            [Version de Docker](https://docs.docker.com/engine/release-notes/)
          </td>

          <td>
            Docker [17.12.1-ce](https://docs.docker.com/engine/release-notes/17.12/) ou supérieur
          </td>
        </tr>

        <tr>
          <td>
            clé privée du site
          </td>

          <td>
            Vous devez avoir une [clé privée de site](#private-location-key)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Le gestionnaire de tâches Docker Synthetics n&apos;est pas conçu pour être utilisé avec des orchestrateurs de conteneurs tels que AWS ECS, Docker Swarm, Apache Mesos, l&apos;instance de conteneur Azure , etc. L’exécution du gestionnaire de tâches Docker Synthetics dans un orchestrateur de conteneurs entraîne des problèmes inattendus car il fonctionne lui-même comme un orchestrateur. Si vous utilisez l&apos;orchestration de conteneurs, consultez nos [exigences relatives au gestionnaire de tâches Kubernetes Synthetics](/docs/synthetics/synthetic-monitoring/private-locations/install-job-manager/#kubernetes-requirements).
    </Callout>
  </Collapser>

  <Collapser
    id="podman-requirements"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilité pour
          </th>

          <th>
            Exigences
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            système d&apos;exploitation
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou supérieur<br />
          </td>
        </tr>

        <tr>
          <td>
            Processeur
          </td>

          <td>
            Un processeur multicœur AMD64 ou x86\_64 moderne
          </td>
        </tr>

        <tr>
          <td>
            mémoire
          </td>

          <td>
            3,256 Gio de RAM par cœur de processeur (dédié)
          </td>
        </tr>

        <tr>
          <td>
            Taille du disque
          </td>

          <td>
            Un minimum de 50 Gio par hôte
          </td>
        </tr>

        <tr>
          <td>
            Système de fichiers sur disque
          </td>

          <td>
            NFSv4.1 ou supérieur (si vous utilisez NFS)
          </td>
        </tr>

        <tr>
          <td>
            [Version Podman](https://github.com/containers/podman/releases)
          </td>

          <td>
            Podman [5.0.0-ce](https://github.com/containers/podman/releases/tag/v5.0.0) ou supérieur
          </td>
        </tr>

        <tr>
          <td>
            clé privée du site
          </td>

          <td>
            Vous devez avoir une [clé privée de site](#private-location-key)
          </td>
        </tr>
      </tbody>
    </table>

    <Callout variant="caution">
      Le gestionnaire de tâches Podman Synthetics n&apos;est pas conçu pour être utilisé avec des orchestrateurs de conteneurs tels que AWS ECS, Docker Swarm, Apache Mesos, l&apos;instance de conteneur Azure , etc. L’exécution du gestionnaire de tâches Docker Synthetics dans un orchestrateur de conteneurs entraîne des problèmes inattendus car il fonctionne lui-même comme un orchestrateur. Si vous utilisez l&apos;orchestration de conteneurs, consultez nos [exigences relatives au gestionnaire de tâches Kubernetes Synthetics](/docs/synthetics/synthetic-monitoring/private-locations/install-job-manager/#kubernetes-requirements).
    </Callout>
  </Collapser>

  <Collapser
    id="kubernetes-requirements"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="Kubernetes icon" alt="Kubernetes icon" style={{ height: '35px', width: '40px' }} />Configuration requise pour l'environnement du système d'orchestration de conteneurs Kubernetes</>
    }
  >
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilité pour
          </th>

          <th>
            Exigences
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            système d&apos;exploitation
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> 3.10 ou supérieur<br /> <DNT>**macOS:**</DNT> 10.11 ou supérieur<br />

            Le conteneur Linux, y compris le gestionnaire de tâches, ne fonctionne que sur les nœuds Linux K8.
          </td>
        </tr>

        <tr>
          <td>
            Processeur
          </td>

          <td>
            Un processeur multi-cœur moderne
          </td>
        </tr>

        <tr>
          <td>
            Synthetics de gestion des tâches pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 800Mi jusqu&apos;à 1600Mi

            Les ressources allouées à un pod de gestionnaire de tâches Synthetics sont configurables par l&apos;utilisateur.
          </td>
        </tr>

        <tr>
          <td>
            podd&apos;exécution Ping
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi jusqu&apos;à 1 Gi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d’exécution ping sont configurables par l’utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Node.js d&apos;exécution de l&apos;API pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 1250Mi jusqu&apos;à 2500Mi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d’exécution d’API Node.js sont configurables par l’utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Node.js d&apos;exécution du navigateur pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 1,0 à 1,5<br /> <DNT>**Memory:**</DNT> 2000Mi jusqu&apos;à 3000Mi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d&apos;exécution de navigateur Node.js sont configurables par l&apos;utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Taille du disque
          </td>

          <td>
            <DNT>**Root volume:**</DNT> Un minimum de 50 Gio<br />
          </td>
        </tr>

        <tr>
          <td>
            Système de fichiers sur disque
          </td>

          <td>
            NFSv4.1 ou supérieur (si vous utilisez NFS)
          </td>
        </tr>

        <tr>
          <td>
            Version de Kubernetes
          </td>

          <td>
            [Kubernetes v1.21](https://kubernetes.io/blog/2021/04/08/kubernetes-1-21-release-announcement/) ou plus récent est requis.
          </td>
        </tr>

        <tr>
          <td>
            clé privée du site
          </td>

          <td>
            Vous devez avoir une [clé privée de site](#private-location-key)
          </td>
        </tr>

        <tr>
          <td>
            Helm
          </td>

          <td>
            Suivez [les instructions d&apos;installation de Helm v3](https://helm.sh/docs/intro/install/) pour votre système d&apos;exploitation.
          </td>
        </tr>

        <tr>
          <td>
            Kubectl
          </td>

          <td>
            Suivez [les instructions d&apos;installation de Kubectl](https://kubernetes.io/docs/tasks/tools/install-kubectl/) pour votre système d&apos;exploitation.
          </td>
        </tr>
      </tbody>
    </table>

    Pour afficher les versions, les dépendances, les valeurs par défaut du nombre de pods d&apos;exécution démarrés avec chaque gestionnaire de tâches Synthetics et plus encore, veuillez consulter [Afficher l&apos;aide et les exemples](#help) ci-dessous.
  </Collapser>

  <Collapser id="Openshift-requirements" title="Configuration requise pour l'environnement du système de conteneur OpenShift">
    <table>
      <thead>
        <tr>
          <th style={{ width: "265px" }}>
            Compatibilité pour
          </th>

          <th>
            Exigences
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            système d&apos;exploitation
          </td>

          <td>
            <DNT>**Linux kernel:**</DNT> [3.10 ou supérieur](https://docs.redhat.com/en/documentation/openshift_container_platform/3.11/html/installing_clusters/install-config-install-prerequisites#hardware)<br /> <DNT>**macOS:**</DNT> 10.11 ou supérieur<br />

            Le conteneur Linux, y compris le gestionnaire de tâches, ne fonctionne que sur les nœuds Linux K8.
          </td>
        </tr>

        <tr>
          <td>
            Processeur
          </td>

          <td>
            Un `AMD64` moderne, multi-core ou `x86_64 CPU`
          </td>
        </tr>

        <tr>
          <td>
            podd&apos;exécution Ping
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi jusqu&apos;à 1 Gi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d’exécution ping sont configurables par l’utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Node.js d&apos;exécution de l&apos;API pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 500 Mi jusqu&apos;à 1 Gi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d’exécution ping sont configurables par l’utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Node.js d&apos;exécution de l&apos;API pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 0,5 à 0,75<br /> <DNT>**Memory:**</DNT> 1250Mi jusqu&apos;à 2500Mi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d’exécution d’API Node.js sont configurables par l’utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Node.js d&apos;exécution du navigateur pod
          </td>

          <td>
            <DNT>**CPU (vCPU/Core):**</DNT> 1,0 à 1,5<br /> <DNT>**Memory:**</DNT> 2000Mi jusqu&apos;à 3000Mi

            Considérations supplémentaires :

            * Les ressources allouées à un pod d&apos;exécution de navigateur Node.js sont configurables par l&apos;utilisateur.
            * Le rapport limite/requête de ressources maximal pour le processeur et la mémoire est de 2.
          </td>
        </tr>

        <tr>
          <td>
            Taille du disque
          </td>

          <td>
            <DNT>**Root volume:**</DNT> Un minimum de 50 Gio<br />
          </td>
        </tr>

        <tr>
          <td>
            Système de fichiers sur disque
          </td>

          <td>
            NFSv4.1 ou supérieur (si vous utilisez NFS)
          </td>
        </tr>

        <tr>
          <td>
            Version
          </td>

          <td>
            Version 4.11 et ultérieure.
          </td>
        </tr>

        <tr>
          <td>
            clé privée du site
          </td>

          <td>
            Vous devez avoir une [clé privée de site](#private-location-key)
          </td>
        </tr>

        <tr>
          <td>
            Helm
          </td>

          <td>
            Suivez [les instructions d&apos;installation de Helm v3](https://helm.sh/docs/intro/install/) pour votre système d&apos;exploitation.
          </td>
        </tr>
      </tbody>
    </table>

    Pour afficher les versions, les dépendances, les valeurs par défaut du nombre de pods d&apos;exécution démarrés avec chaque gestionnaire de tâches Synthetics et plus encore, veuillez consulter [Afficher l&apos;aide et les exemples](#help) ci-dessous.
  </Collapser>
</CollapserGroup>

## clé privée du site

Avant de lancer les gestionnaires de tâches Synthetics, vous devez disposer d&apos;une [clé privée de site](/docs/synthetics/synthetic-monitoring/private-locations/private-locations-overview-monitor-internal-sites-add-new-locations#create-location). Votre gestionnaire de tâches Synthetics utilise la clé pour s&apos;authentifier auprès de New Relic et exécuter le moniteur associé à ce site privé.

Pour trouver la clé du site privé existant :

1. Allez à <DNT>**[one.newrelic.com &gt; Synthetic monitoring &gt; Private locations](https://one.newrelic.com/synthetics-nerdlets/private-location-list)**</DNT>.
2. Dans l&apos;index <DNT>**Private locations**</DNT> , recherchez le site privé auquel vous souhaitez que votre gestionnaire de tâches Synthetics soit affecté.
3. Notez la clé associée au site privé avec la clé <Icon name="fe-key" /> icône.

## Installer, mettre à jour et configurer le gestionnaire de tâches Synthetics [#install]

Si vous exécutez plusieurs conteneurs privés de sites Docker ou Podman sur le même hôte, vous aurez des conflits de ports. Pour éviter ce conflit de port, assurez-vous de procéder comme suit lorsque vous commencez à configurer des gestionnaires de tâches :

* Exécutez des gestionnaires de tâches et des CPM sur différents hôtes.
* Exécutez chaque gestionnaire de tâches sur un hôte distinct.
* Exécutez chaque CPM sur un hôte différent.

Les images du gestionnaire de tâches Synthetics sont hébergées sur [Docker Hub](https://hub.docker.com/). Accédez à [hub.docker.com/r/newrelic/synthetics-job-manager/tags](https://hub.docker.com/r/newrelic/synthetics-job-manager/tags) pour une liste de toutes les sorties.

À moins que vous n&apos;hébergiez les images dans un référentiel d&apos;images local, vous devez autoriser les connexions à `docker.io` via votre pare-feu afin que Docker ou Podman puisse extraire le gestionnaire de tâches Synthetics et les images synthétiques d&apos;exécution. Lorsque le gestionnaire de tâches Synthetics démarre, les images d&apos;exécution sont extraites automatiquement. Consultez [Configuration de l’environnement Docker](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#docker-env-config), [Configuration de l’environnement Podman](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#podman-env-config) et [Configuration de l’environnement Kubernetes](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#kubernetes-env-config) pour plus de détails sur la façon de définir un référentiel local et le point de terminaison du registre d’exécution.

Pour plus de détails sur les paramètres de configuration avancés, consultez [la configuration du gestionnaire de tâches Synthetics](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration).

## Démarrer le gestionnaire de tâches Synthetics [#start]

Vous trouverez ci-dessous les instructions Docker, Podman ou Kubernetes applicables pour démarrer le gestionnaire de tâches.

<CollapserGroup>
  <Collapser
    id="docker-update"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    1. Localisez [la clé privée de votre site](#private-location-key).

    2. Assurez-vous d&apos;avoir activé [la dépendance Docker ](#docker-dependencies)pour le sandboxing et [installé](#install-update) le gestionnaire de tâches Synthetics sur votre système.

    3. Exécutez le script approprié pour votre système. Adaptez la valeur par défaut commune `/var/run/docker.sock` dans les exemples suivants pour qu&apos;elle corresponde à votre système.

       * Linux/macOS :

         ```shell
         docker run \
             --name YOUR_CONTAINER_NAME \
             -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" \
             -v /var/run/docker.sock:/var/run/docker.sock:rw \
             -d \
             --restart unless-stopped \
             newrelic/synthetics-job-manager:latest
         ```

       * Windows:

         ```shell
         docker run ^
             --name YOUR_CONTAINER_NAME ^
             -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" ^
             -v /var/run/docker.sock:/var/run/docker.sock:rw ^
             -d ^
             --restart unless-stopped ^
             newrelic/synthetics-job-manager:latest
         ```

       Consultez les logs de votre conteneur minion :

       ```shell
       docker logs --follow YOUR_CONTAINER_NAME
       ```
  </Collapser>

  <Collapser
    id="podman-update"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    1. Localisez [la clé privée de votre site](#private-location-key).
    2. Assurez-vous d&apos;avoir activé [la dépendance Podman](#podman-dependencies) pour le sandboxing et [installé](#install-update) le gestionnaire de tâches Synthetics sur votre système.
    3. Exécutez le script ci-dessous pour votre système.

    Pour créer un pod sous Linux et ajouter l’adresse IP de la machine hôte :

    ```
    podman pod create --network slirp4netns --name YOUR_POD_NAME --add-host=podman.service:HOST_IP_ADDRESS
    ```

    Pour démarrer le gestionnaire de tâches :

    ```
    podman run \
    --name YOUR_CONTAINER_NAME \
    --pod YOUR_POD_NAME \
    -e "PRIVATE_LOCATION_KEY=YOUR_PRIVATE_LOCATION_KEY" \
    -e "CONTAINER_ENGINE=PODMAN" \
    -e "PODMAN_API_SERVICE_PORT=YOUR_PODMAN_API_SERVICE_PORT" \
    -e "PODMAN_POD_NAME=YOUR_POD_NAME" \
    -d \
    --restart unless-stopped \
    newrelic/synthetics-job-manager:latest
    ```

    Pour afficher les logs de votre conteneur minion :

    ```
    podman logs --follow YOUR_CONTAINER_NAME
    ```
  </Collapser>

  <Collapser
    id="kubernetes-install"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="img-integration-k8s@2x.png" alt="img-integration-k8s@2x.png" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    1. Localisez [la clé privée de votre site](#private-location-key).

    2. Configurez l&apos;espace de nommage pour le gestionnaire de tâches Synthetics dans votre cluster Kubernetes:

       ```shell
       kubectl create namespace YOUR_NAMESPACE
       ```

    3. Copiez les cartes Helm du référentiel Helm de New Relic.

       * Si vous copiez les graphiques pour la première fois :

         ```shell
         helm repo add YOUR_REPO_NAME https://helm-charts.newrelic.com
         ```

       * Si vous avez précédemment copié les cartes Helm du référentiel Helm de New Relic, récupérez la dernière version :

         ```shell
         helm repo update
         ```

    4. Installez le gestionnaire de tâches Synthetics avec la commande Helm suivante :

       * Pour une nouvelle installation du gestionnaire de tâches Synthetics :

         ```
         helm install YOUR_JOB_MANAGER_NAME YOUR_REPO_NAME/synthetics-job-manager -n YOUR_NAMESPACE --set synthetics.privateLocationKey=YOUR_PRIVATE_LOCATION_KEY
         ```

       * Pour mettre à jour une installation existante du gestionnaire de tâches Synthetics :

         ```shell
         helm upgrade YOUR_JOB_MANAGER_NAME YOUR_REPO_NAME/synthetics-job-manager -n YOUR_NAMESPACE --set synthetics.privateLocationKey=YOUR_PRIVATE_LOCATION_KEY
         ```

    5. Vérifiez si le pod du gestionnaire de tâches Synthetics est opérationnel :

       ```shell
       kubectl get -n YOUR_NAMESPACE pods
       ```

       Une fois que l&apos;attribut `status` de chaque pod est affiché comme `running`, votre gestionnaire de tâches Synthetics est opérationnel et prêt à exécuter le moniteur attribué à votre site privé.
  </Collapser>

  <Collapser id="-install" title="Procédure de démarrage d'OpenShift">
    Assurez-vous que l&apos; [OpenShift CLI (oc)](https://docs.redhat.com/en/documentation/openshift_container_platform/4.8/html/cli_tools/openshift-cli-oc) est installé pour exécuter des commandes via OpenShift CLI.

    1. Localisez [la clé privée de votre site](#private-location-key).

    2. Connectez-vous à votre projet OpenShift :

       ```shell
       oc project your_namespace
       ```

    3. Créer tag d&apos;image à l&apos;aide de la commande :

       ```shell
       oc create imagestream image_streame_name -n your_namespace
       ```

    4. Créer `buildConfig.yaml`

       ```dockerfile
       apiVersion: build.openshift.io/v1
       kind: BuildConfig
       metadata:
         name: synthetics-node-api-runtime-build
         namespace: <your_namespace> 
       spec:
         output:
           to:
             kind: ImageStreamTag
             name: <your_output_image_name>:<output_tag> 
         source:
           type: Dockerfile
           dockerfile: |-
             FROM newrelic/synthetics-node-api-runtime:latest 
             USER root
             RUN setcap -r /usr/bin/node
             USER 2000
         strategy:
           type: Docker
           dockerStrategy:
             platform:
               architecture: amd64 
         postCommit: {}
         triggers:
           - type: ConfigChange
           - type: ImageChange
             imageChange:
               from:
                 kind: ImageStreamTag
                 name: <image_stream_name>:latest
       ```

    5. Appliquer le `BuildConfig`:

       ```shell
       oc create -f buildConfig.yaml
       ```

    6. (Facultatif) Démarrez la build (si la build ne démarre pas automatiquement, exécutez cette commande) :

       ```shell
       oc start-build synthetics-node-api-runtime-build -n your-namespace
       ```

       <Callout variant="important">
         Surveiller la progression de la construction en utilisant :

         ```shell
         oc logs -f bc/synthetics-node-api-runtime-build -n synthetics
         ```
       </Callout>

    7. avec Helm:

       * Exécutez cette commande pour ajouter le référentiel de graphique New Relic Helm à votre Helm configuration locale, vous permettant d&apos;installer facilement l&apos;intégration Kubernetess.

         ```shell
         helm repo add newrelic https://helm-charts.newrelic.com
         ```

       * Exécutez la commande ci-dessous pour exécuter SJM sur votre site privé sur OpenShift :

         ```shell
         helm install release_name newrelic/synthetics-job-manager -n your_namespace --set synthetics.privateLocationKey=private_location_key --set image_stream_name.image.repository=image_repo --set image_stream_name.appVersionOverride=tag
         ```

         * **release\_name**: n&apos;importe quel nom que vous souhaitez donner à votre image.

         * **your\_namespace**: comme fichier mentionml.

         * **private\_location\_key**: clé unique correspondant à votre site privé.

         * **image\_stream\_name**: comme mentionné dans le fichier yaml buildConfig yaConfig intégré.

         * **tag**: comme mentionné dans le fichier yaml buildConfig.

         * **image\_repo**:

           * exécutez oc registry info dans le terminal pour récupérer l&apos;URL du registre.
           * image\_repo est une combinaison d&apos;URL de registre, `your_namespace`, `your_output_image_name` comme mentionné dans le fichier yaml buildConfig séparé par une barre oblique. registery\_url/votre\_espace\_de\_noms/votre\_nom\_d&apos;image\_de\_sortie

         Considérons l’exemple suivant :

         ```shell
         helm install synthetics-kevin newrelic/synthetics-job-manager -n synthetics --set synthetics.privateLocationKey=<PRIVATE_LOC_KEY>   --set node-api-runtime.image.repository=default-route-openshift-image-registry.apps-crc.testing/synthetics/synthetics-node-api-runtime --set node-api-runtime.appVersionOverride=custom
         ```

    8. Vérifiez que le pod du gestionnaire de tâches Synthetics est opérationnel :

       ```shell
       oc get pods -n your-namespace
       ```
  </Collapser>
</CollapserGroup>

## Arrêter ou supprimer le gestionnaire de tâches Synthetics [#stop]

Dans un environnement système conteneur Docker ou Podman, utilisez la procédure `stop` correspondante pour arrêter le gestionnaire de tâches Synthetics. Dans un environnement de système d’orchestration de conteneur Kubernetes , utilisez la procédure Kubernetes `delete` pour arrêter l’exécution du gestionnaire de tâches Synthetics.

<CollapserGroup>
  <Collapser
    id="docker-stop"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Procédure d'arrêt Docker</>
    }
  >
    Vous pouvez [arrêter un conteneur Docker](https://docs.docker.com/engine/reference/commandline/stop/) soit par le nom du conteneur, soit par l&apos;ID du conteneur.

    * Arrêt du nom du conteneur pour Linux, macOS et Windows :

      ```shell
      docker stop YOUR_CONTAINER_NAME
      docker rm YOUR_CONTAINER_NAME
      ```

    * Arrêt de l&apos;ID de conteneur pour Linux/macOS :

      Dans les exemples, le conteneur est arrêté et retiré. Pour arrêter uniquement le conteneur, omettez `docker rm $CONTAINER_ID`.

      ```shell
      CONTAINER_ID=$(docker ps -aqf name=YOUR_CONTAINER_NAME)
      docker stop $CONTAINER_ID
      docker rm $CONTAINER_ID
      ```

    * Arrêt de l&apos;ID de conteneur pour Windows :

      Dans les exemples, le conteneur est arrêté et retiré. Pour arrêter uniquement le conteneur, omettez `docker rm $CONTAINER_ID`.

      ```shell
      FOR /F "tokens=*" %%CID IN ('docker ps -aqf name=YOUR_CONTAINER_NAME') do (SET CONTAINER_ID=%%CID)
      docker stop %CONTAINER_ID%
      docker rm %CONTAINER_ID%
      ```
  </Collapser>

  <Collapser
    id="podman-stop"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Docker icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    Vous pouvez [arrêter un conteneur Podman](https://docs.podman.io/en/stable/markdown/podman-stop.1.html) soit par le nom du conteneur, soit par l&apos;ID du conteneur.

    * Arrêt du nom du conteneur pour Linux :

    ```
    podman stop YOUR_CONTAINER_NAME
    podman rm YOUR_CONTAINER_NAME
    ```

    * Arrêt de l&apos;ID du conteneur pour Linux :

    Dans les exemples, le conteneur est arrêté et retiré. Pour arrêter uniquement le conteneur, omettez `podman rm $CONTAINER_ID`.

    ```
    CONTAINER_ID=$(podman ps -aqf name=YOUR_CONTAINER_NAME)
    podman stop $CONTAINER_ID
    podman rm $CONTAINER_ID
    ```
  </Collapser>

  <Collapser
    id="kubernetes-delete"
    title={<><img src="/images/synthetic_logo_k8logo.webp" title="img-integration-k8s@2x.png" alt="img-integration-k8s@2x.png" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    1. Récupérez le `JOB_MANAGER_POD_INSTALLATION_NAME` du pod du gestionnaire de tâches Synthetics que vous souhaitez supprimer :

       ```shell
       helm list -n YOUR_NAMESPACE
       ```

    2. Supprimer le pod minion :

       ```shell
       helm uninstall -n YOUR_NAMESPACE JOB_MANAGER_POD_INSTALLATION_NAME
       ```

    3. Supprimez l&apos;espace de nommage mis en place pour le gestionnaire de jobs Synthetics dans votre cluster Kubernetes:

       ```shell
       kubectl delete namespace YOUR_NAMESPACE
       ```
  </Collapser>

  <Collapser id="openshift-delete" title="Procédure de suppression d'OpenShift">
    ```shell
    helm uninstall release_name -n your_namespace
    ```
  </Collapser>
</CollapserGroup>

## Sandboxing et dépendance [#sandboxing-and-deps]

Le sandboxing et la dépendance sont applicables au gestionnaire de tâches Synthetics dans un environnement système conteneurisé Docker ou Podman.

<CollapserGroup>
  <Collapser
    id="docker-dependencies"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} />Dépendances Docker</>
    }
  >
    Le gestionnaire de tâches Synthetics s&apos;exécute dans Docker et est capable d&apos;exploiter Docker comme technologie de sandboxing. Cela garantit une isolation complète de l’exécution du moniteur, ce qui améliore la sécurité, la fiabilité et la répétabilité. Chaque fois qu&apos;un moniteur de script ou de navigateur est exécuté, le gestionnaire de tâches Synthetics crée un tout nouveau conteneur Docker pour l&apos;exécuter à l&apos;aide de l&apos;environnement d&apos;exécution correspondant.

    Le conteneur du gestionnaire de tâches Synthetics doit être configuré pour communiquer avec le moteur Docker afin de générer un conteneur d&apos;exécution supplémentaire. Chaque conteneur généré est ensuite dédié à l&apos;exécution d&apos;une vérification associée au [moniteur Synthétique](/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors) exécuté sur le site privé auquel le conteneur du gestionnaire de tâches Synthetics est associé.

    Il existe une dépendance cruciale au lancement. Pour activer le sandboxing, assurez-vous que :

    * Votre socket Docker UNIX inscriptible est monté sur [la variable d&apos;environnement](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration/#environment-variables) `/var/run/docker.sock` ou `DOCKER_HOST` . Pour plus d&apos;informations, consultez Docker [l&apos;option de socket daemon](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option).

      <Callout variant="caution">
        Le nombre de cœurs sur l&apos;hôte détermine le nombre de conteneurs d&apos;exécution que le gestionnaire de tâches Synthetics peut exécuter simultanément sur l&apos;hôte. Étant donné que les besoins en mémoire sont adaptés au nombre attendu de conteneurs d&apos;exécution, nous recommandons <DNT>**not running multiple synthetics job managers on the same host**</DNT> pour éviter les conflits de ressources.
      </Callout>

      Pour plus d&apos;informations sur le sandboxing et l&apos;exécution en tant qu&apos;utilisateur root ou non root, consultez [Sécurité, sandboxing et exécution en tant qu&apos;utilisateur non root](#run-non-root).
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser
    id="podman-dependencies"
    title={<><img src="/images/synthetic_logo_podman.webp" title="Podman icon" alt="Podman icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    Le gestionnaire de tâches Synthetics s&apos;exécute dans Podman et est capable d&apos;exploiter Podman comme technologie de sandboxing. Cela garantit une isolation complète de l’exécution du moniteur, ce qui améliore la sécurité, la fiabilité et la répétabilité. Chaque fois qu&apos;un moniteur de script ou de navigateur est exécuté, le gestionnaire de tâches Synthetics crée un tout nouveau conteneur Podman pour l&apos;exécuter à l&apos;aide de l&apos;environnement d&apos;exécution correspondant.

    Le conteneur du gestionnaire de tâches Synthetics doit être configuré pour communiquer avec le moteur Podman afin de générer un conteneur d&apos;exécution supplémentaire. Chaque conteneur généré est ensuite dédié à l&apos;exécution d&apos;une vérification associée au [moniteur Synthétique](/docs/synthetics/new-relic-synthetics/using-monitors/add-edit-monitors) exécuté sur le site privé auquel le conteneur du gestionnaire de tâches Synthetics est associé.

    Il existe une dépendance cruciale au lancement. Pour activer le sandboxing, assurez-vous que vous disposez des éléments suivants :

    1. Installez Podman [5.0.0-ce](https://github.com/containers/podman/releases/tag/v5.0.0) ou supérieur.

    2. Activation de l&apos;exécution sans racine :

       * Configurez Podman pour exécuter conteneur sans nécessiter de privilèges root.
         ```
         mkdir -p ~/.config/containers
         touch ~/.config/containers/containers.conf
         vi ~/.config/containers/containers.conf
         ```
       * Modifiez le fichier `containers.conf` pour configurer Podman afin qu&apos;il utilise `crun` et `systemd`:
         ```
         [engine]
         runtime = "crun"
         cgroup_manager = "systemd"
         ```

    3. Activation des cgroups v2 (RHEL uniquement) :
       * Modifiez le GRUB pour activer les cgroups v2, cela garantit la compatibilité avec les runtimes de conteneurs modernes dans RHEL.
         ```
         sudo sed -i 's/GRUB_CMDLINE_LINUX="/&systemd.unified_cgroup_hierarchy=1 /' /etc/default/grub
         sudo grub2-mkconfig -o /boot/grub2/grub.cfg
         sudo reboot
         ```

    4. Activation de la délégation à l&apos;échelle du système pour autoriser la délégation `cgroups` pour les services Podman.
       ```
       sudo mkdir -p /etc/systemd/system/user@.service.d/
       echo -e "[Service]\nDelegate=yes" | sudo tee /etc/systemd/system/user@.service.d/delegate.conf > /dev/null
       ```

    5. Configurer le service `systemd` au niveau utilisateur :

       * Créez des répertoires pour les services `systemd` au niveau utilisateur.
         ```
         mkdir -p ~/.config/systemd/user/podman.service.d
         ```
       * Ajoutez une configuration déléguée au service `systemd` au niveau utilisateur.
         ```
         echo -e "[Service]\nDelegate=yes" > ~/.config/systemd/user/podman.service.d/override.conf
         ```

    6. Activé et démarré le socket Podman.
       ```
       systemctl --user enable podman.socket
       systemctl --user start podman.socket
       systemctl --user status podman.socket
       ```

    7. Création et configuration du service API Podman :

       * Créez un service API Podman et configurez Podman pour fournir un accès API HTTP.
         ```
         mkdir -p ~/.config/systemd/user
         touch ~/.config/systemd/user/podman-api.service
         vi ~/.config/systemd/user/podman-api.service
         ```
       * Définissez le service pour exposer l’API de Podman sur le port 8000.
         ```
         [Unit]
         Description=Podman API Service
         After=default.target

         [Service]
         Type=simple
         ExecStart=/usr/bin/podman system service -t 0 tcp:0.0.0.0:8000
         Restart=on-failure

         [Install]
         WantedBy=default.target
         ```

    8. Activation et démarrage du service API Podman.
       ```
       systemctl --user daemon-reload
       systemctl --user enable podman-api.service
       systemctl --user start podman-api.service
       systemctl --user status podman-api.service
       ```

    <Callout variant="caution">
      Le nombre de cœurs sur l&apos;hôte détermine le nombre de conteneurs d&apos;exécution que le gestionnaire de tâches Synthetics peut exécuter simultanément sur l&apos;hôte. Étant donné que les besoins en mémoire sont adaptés au nombre attendu de conteneurs d&apos;exécution, nous recommandons <DNT>**not running multiple synthetics job managers on the same host**</DNT> pour éviter les conflits de ressources.
    </Callout>
  </Collapser>
</CollapserGroup>

## Sécurité, sandboxing et exécution en tant que non-root [#security]

Par défaut, le logiciel exécuté dans un gestionnaire de tâches Synthetics est exécuté avec les privilèges utilisateur `root` . Cela convient à la plupart des scénarios, car l’exécution est en sandbox.

Pour exécuter le gestionnaire de tâches Synthetics en tant qu&apos;utilisateur non root, des étapes supplémentaires sont requises :

<CollapserGroup>
  <Collapser
    id="run-non-root"
    title={<><img src="/images/synthetic_logo_docker.webp" title="Docker icon" alt="Docker icon" style={{ height: '35px', width: '40px' }} /></>
    }
  >
    Pour plus d&apos;informations, consultez la documentation officielle de Docker sur [la sécurité](https://docs.docker.com/engine/security/security/) et [les profils de sécurité AppArmor](https://docs.docker.com/engine/security/apparmor/).

    Si votre environnement nécessite que vous exécutiez le gestionnaire de tâches Synthetics en tant qu&apos;utilisateur non root, suivez cette procédure. Dans l&apos;exemple suivant, l&apos;utilisateur non root est `my_user`.

    1. Assurez-vous que `my_user` peut utiliser le moteur Docker sur l&apos;hôte :

       Vérifiez que `my_user` [appartient au groupe système `"docker"` ](https://docs.docker.com/engine/install/linux-postinstall/). L&apos;accès root limité au `docker.sock` est toujours nécessaire pour créer des réseaux de ponts.

       OU

       Activez l’ [option de socket TCP Docker](https://docs.docker.com/engine/reference/commandline/dockerd/#examples) et transmettez la [variable d’environnement](#environemnt-variables) `DOCKER_HOST` au gestionnaire de tâches Synthetics.

    2. Vérifiez que `my_user` dispose des autorisations de lecture/écriture sur tous les répertoires et volumes transmis au gestionnaire de tâches Synthetics. Pour définir ces autorisations, utilisez la commande `chmod` .

    3. Obtenez le `uid` de `my_user` à utiliser dans la commande d&apos;exécution : `id -u my_user`.

       Une fois ces conditions remplies, utilisez l&apos;option `"-u <uid>:<gid>"` lors du lancement du gestionnaire de tâches Synthetics :

       ```shell
       docker run ... -u 1002 ...
       ```

       OU

       ```shell
       docker run ... -u 1002 -e DOCKER_HOST=http://localhost:2375 ...
       ```
  </Collapser>
</CollapserGroup>

## Comprendre vos environnements Docker, Podman, Kubernetes ou OpenShift [#understand]

Vous trouverez ci-dessous des informations supplémentaires sur la maintenance et la compréhension de l&apos;environnement de conteneur du gestionnaire de tâches. Consultez les informations de licence, comprenez les paramètres réseau du gestionnaire de tâches et consultez le référentiel d&apos;images Docker.

<CollapserGroup>
  <Collapser id="help" title="Maintenir le gestionnaire de tâches">
    Utilisez ces options selon le cas :

    * Pour suivre les logs Docker ou Podman et vérifier l&apos;état de votre moniteur, consultez [Maintenance et monitoring du gestionnaire de tâches Synthetics](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-maintenance-monitoring).

    * Pour un gestionnaire de tâches Synthetics dans l&apos;environnement système d&apos;orchestration de conteneurs **OpenShift** et **Kubernetes** , les commandes Helm `show` suivantes peuvent être utilisées pour afficher respectivement `chart.yaml` et `values.yaml`:

      ```shell
      helm show chart YOUR_REPO_NAME/synthetics-job-manager
      ```

      ```shell
      helm show values YOUR_REPO_NAME/synthetics-job-manager
      ```
  </Collapser>

  <Collapser id="license" title="Afficher les informations de licence">
    Certains de nos logiciels open source sont répertoriés sous plusieurs licences logicielles, et dans ce cas, nous avons répertorié la licence que nous avons choisi d&apos;utiliser. Nos informations de licence sont également disponibles dans [notre documentation de licences](/docs/licenses/new-relic-products/new-relic-synthetics/new-relic-synthetics-licenses).
  </Collapser>

  <Collapser id="network" title="Paramètres réseau">
    Pour Docker et Kubernetes, le gestionnaire de tâches Synthetics et son conteneur d&apos;exécution hériteront des paramètres réseau de l&apos;hôte. Pour un exemple de ceci sur un environnement système de conteneur Docker , consultez le [site Docker ](https://docs.docker.com/config/containers/container-networking/).

    Un réseau de pont est créé pour la communication entre le gestionnaire de tâches Synthetics et le conteneur d&apos;exécution. Cela signifie que les options de commande réseau telles que `--network` et `--dns` transmises au conteneur du gestionnaire de tâches Synthetics au lancement (comme via les commandes d&apos;exécution Docker sur un environnement système de conteneur Docker ) ne sont pas héritées ou utilisées par le conteneur d&apos;exécution.

    Lorsque ces réseaux sont créés, ils proviennent du pool d’adresses IP par défaut configuré pour le daemon. Pour un exemple de ceci sur un environnement système de conteneur Docker , consultez le [site Docker](https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file).

    Dans le cas de Podman, nous n&apos;utilisons pas de réseau pont pour la communication entre le gestionnaire de tâches Synthetics et le conteneur d&apos;exécution, mais nous utilisons plutôt un pod Podman. Tous les conteneurs d&apos;un pod Podman partagent le même espace de nommage réseau. Cela signifie qu&apos;ils partagent la même adresse IP au sein de ce pod. Dans ce cas, bien que les conteneurs partagent la même IP, leurs services sont exposés sur des ports différents.
  </Collapser>

  <Collapser id="image" title="Référence d'image Docker">
    Une seule image Docker du gestionnaire de tâches Synthetics sert l&apos;environnement du système d&apos;orchestration de conteneurs **Docker**, **Podman**, **OpenShift** et **Kubernetes** . L&apos;image Docker est hébergée sur Docker Hub. Pour vous assurer que votre image Docker est à jour, consultez le [référentiel Docker Hub newrelic/synthetics-job-manager](https://hub.docker.com/r/newrelic/synthetics-job-manager/tags).
  </Collapser>
</CollapserGroup>

## Considérations supplémentaires pour la connexion au gestionnaire de tâches Synthetics [#FAQ]

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Connexion
      </th>

      <th>
        Description
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Gestionnaires de tâches Synthetics sans accès Internet
      </td>

      <td>
        Un gestionnaire de tâches Synthetics peut fonctionner sans accès à Internet, mais avec quelques exceptions. Le gestionnaire de tâches Synthetics doit pouvoir contacter le domaine `"synthetics-horde.nr-data.net"` . Cela est nécessaire pour qu&apos;il puisse signaler les données à New Relic et recevoir le moniteur à exécuter. Demandez à votre administrateur réseau si cela constitue un problème et comment configurer des exceptions.
      </td>
    </tr>

    <tr>
      <td>
        Communiquer avec les synthétiques via un proxy
      </td>

      <td>
        Pour configurer la communication avec New Relic par proxy, utilisez les [variables d&apos;environnement](/docs/synthetics/synthetic-monitoring/private-locations/job-manager-configuration#environment-variables) nommées `HORDE_API_PROXY*.`
      </td>
    </tr>

    <tr>
      <td>
        Arguments avancés au lancement
      </td>

      <td>
        Ceci s&apos;applique uniquement aux environnements de conteneurs Docker et Podman. Les arguments passés au conteneur du gestionnaire de tâches Synthetics au lancement ne sont pas transmis au conteneur d&apos;exécution généré par le gestionnaire de tâches Synthetics. Docker et Podman n&apos;ont pas de concept d&apos;« héritage » ou de « hiérarchie » de conteneur, et nous ne copions pas la configuration transmise du gestionnaire de tâches Synthetics au conteneur d&apos;exécution. Cependant, dans le cas de Podman, les arguments transmis au niveau du pod sont partagés entre le gestionnaire de tâches Synthetics et le conteneur d&apos;exécution dans le pod. La seule configuration partagée entre eux est celle définie au niveau du [daemon Docker](https://docs.docker.com/config/daemon/) .
      </td>
    </tr>
  </tbody>
</table>