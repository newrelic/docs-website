---
title: Planifier des travaux
metaDescription: 'Efficiently schedule critical jobs for New Relic SAP monitoring with our guide. Ensure optimal data flow with tailored frequencies for RFC checks, data collection, and error handling to maintain continuous system insights.'
freshnessValidatedDate: never
translationType: machine
---

Il y a trois programmes à planifier, planifiez-les en utilisant la transaction `SM36`:

<table>
  <thead>
    <tr>
      <th style={{ width: "400px" }}>
        **Programme ABAP**
      </th>

      <th>
        **Fonctionnalité**
      </th>

      <th>
        **Fréquence recommandée**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        [`/NEWR/REGISTRY_RFC_CHECK`](#rfc-check)
      </td>

      <td>
        Vérifier les connexions RFC au système de monitoring et les NR points de terminaison d&apos;API
      </td>

      <td>
        Toutes les 3 minutes
      </td>
    </tr>

    <tr>
      <td>
        [`/NEWR/ABAP_COLLECTION_MANAGERN`](#abap-collection-manager)
      </td>

      <td>
        Collecte de données, plusieurs tâches doivent être planifiées en fonction du système connecté et des fournisseurs de données
      </td>

      <td>
        Toutes les 5 minutes
      </td>
    </tr>

    <tr>
      <td>
        [`/NEWR/RESEND_FAILED_API_TRANS`](#resubmit-program)
      </td>

      <td>
        Renvoyer les transmissions ayant échoué
      </td>

      <td>
        Toutes les 15 minutes
      </td>
    </tr>
  </tbody>
</table>

## Programme de vérification RFC [#rfc-check]

Planifiez `/NEWR/REGISTRY_RFC_CHECK` toutes les 1 à 3 minutes, en veillant à ce qu&apos;il s&apos;exécute plus fréquemment que la tâche de collecte de données. Utilisez le nom du travail `NR_RFC_CHECK`.

## Planifier le gestionnaire de collecte de données ABAP [#abap-collection-manager]

Planifiez trois tâches de collecte de données avec des variantes axées sur les groupes de fournisseurs de données suivants. Pour obtenir des instructions sur la planification des tâches du gestionnaire de collecte avant `SP03`, consultez [Variantes et tâches avant SP03](/docs/sap-solutions/additional-resources/variants-and-jobs-before-sp03). Séparez les fournisseurs de données en trois groupes pour la planification. Pour une liste complète de tous les fournisseurs de données, consultez le [Référence des fournisseurs de données](/docs/sap-solutions/additional-resources/data-providers-reference).

* **TRACE** : Dans ce groupe se trouvent les fournisseurs de données liés à la base de données de performance (STAD) :

  * Inclut les fournisseurs liés à la base de données de performance tels que [`NR.SAP.TRANSACTION`](/docs/sap-solutions/additional-resources/data-providers-reference/#sap-appl-metrics) (fournisseur de données de trace), [`NR.SAP.TRANSACTION.COMPLETE`](/docs/sap-solutions/additional-resources/data-providers-reference/#sap-appl-metrics) (collecte complète de la base de données de performance avec processus RFC parallèle en arrière-plan), `NR.SAP.SYSTEM.PROCESS`, `NR_SAP_PROGRAM`, `NR_SAP_WORKLOAD_COMPLETE` et `NR.SAP.WORKLOAD.COMPLETE`.
  * `NR.SAP.SYSTEM.PROCESS` et `NR_SAP_PROGRAM` sont suspendus après `SP02`.

* **IDOC** : Dans le système de production, la collecte des IDOC peut prendre un temps important :
  * Inclut les fournisseurs liés à IDOC tels que [`NR_SAP_IDOC`](/docs/sap-solutions/additional-resources/data-providers-reference/#idoc-all) (fournisseur de données d’événement d’état IDOC principal), [`NR_SAP_IDOC_COMPLETE`](/docs/sap-solutions/additional-resources/data-providers-reference/#idoc-all) (récupération IDOC complète avec collecte BG RFC) et `NR_SAP_IDOC_Configuration` (téléchargement des données de base IDOC pour améliorer les performances du fournisseur de données IDOC).

* **SYSTÈME**: Le reste des fournisseurs de données. Consultez la [liste complète par groupe de monitoring](/docs/sap-solutions/additional-resources/data-providers-reference).

### Créer des variantes pour /NEWR/ONE\_COLLECTION

À partir de SP03, `/NEWR/ABAP_COLLECTION_MANAGERN` et `RSBTONEJOB2` sont combinés en `/NEWR/ONE_COLLECTION`. Ce programme inclut tous les paramètres de `/NEWR/ABAP_COLLECTION_MANAGERN` et les noms de tâches de `RSBTONEJOB2`, fonctionnant de manière similaire. Pour planifier des tâches, créez des variantes pour `/NEWR/ONE_COLLECTION` en utilisant les valeurs suivantes :

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **Nom de la variante**
      </th>

      <th>
        **tracer**
      </th>

      <th>
        **IDOC**
      </th>

      <th>
        **SYSTEM**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        **Nom du poste**
      </td>

      <td>
        `NR_COLLECTION_TRACE`
      </td>

      <td>
        `NR_COLLECTION_IDOC`
      </td>

      <td>
        `NR_COLLECTION_SYSTEM`
      </td>
    </tr>

    <tr>
      <td>
        **ID de compte New Relic**
      </td>

      <td>
        Compte SAP utilisé pour recevoir des données
      </td>

      <td>
        Compte SAP utilisé pour recevoir des données
      </td>

      <td>
        Compte SAP utilisé pour recevoir des données
      </td>
    </tr>

    <tr>
      <td>
        **Enregistrements par transaction**
      </td>

      <td>
        Par défaut à 10 000
      </td>

      <td>
        Par défaut à 10 000
      </td>

      <td>
        Par défaut à 10 000
      </td>
    </tr>

    <tr>
      <td>
        **Nom du fournisseur de données**
      </td>

      <td>
        Sélectionner des valeurs uniques :

        * `NR.SAP.TRANSACTION`
        * `NR.SAP.TRANSACTION.COMPLETE`
        * `NR.SAP.SYSTEM.PROCESS`
        * `NR_SAP_PROGRAM`
        * `NR_SAP_WORKLOAD_COMPLETE`
        * `NR.SAP.WORKLOAD.COMPLETE`
      </td>

      <td>
        Sélectionner des valeurs uniques :

        * `NR_SAP_IDOC`
        * `NR_SAP_IDOC_COMPLETE`
        * `NR_SAP_IDOC_Configuration`
      </td>

      <td>
        Exclure les valeurs uniques :

        * `NR.SAP.TRANSACTION`
        * `NR.SAP.TRANSACTION.COMPLETE`
        * `NR.SAP.SYSTEM.PROCESS`
        * `NR_SAP_PROGRAM`
        * `NR_SAP_WORKLOAD_COMPLETE`
        * `NR.SAP.WORKLOAD.COMPLETE`
        * `NR_SAP_IDOC`
        * `NR_SAP_IDOC_COMPLETE`
        * `NR_SAP_IDOC_Configuration`
      </td>
    </tr>

    <tr>
      <td>
        **Mode d&apos;exécution**
      </td>

      <td>
        Traitement séquentiel
      </td>

      <td>
        Traitement séquentiel
      </td>

      <td>
        Traitement parallèle
      </td>
    </tr>

    <tr>
      <td>
        **WP minimum requis**
      </td>

      <td>
        Si le système DIA WP &gt;= 30, définissez sur 6 ; sinon définissez sur 3.
      </td>

      <td>
        N/A
      </td>

      <td>
        Si le système DIA WP &gt;= 30, définissez sur 6 ; sinon définissez sur 3.
      </td>
    </tr>
  </tbody>
</table>

<img title="SAP ABAP Collection Manager" alt="A screenshot displaying the SAP ABAP Collection Manager" src="/images/abap-collection-manager.webp" width="" />

### Planifier des tâches de collecte

1. Démarrer la transaction `SM36`.
2. Saisissez le **Job Name** pour chaque travail et définissez la **Job Class** sur **C**.

<CollapserGroup>
  <Collapser id="job-names" title="Noms de poste">
    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            **Nom du poste**
          </th>

          <th>
            `NR_COLLECTION_TRACE`
          </th>

          <th>
            `NR_COLLECTION_IDOC`
          </th>

          <th>
            `NR_COLLECTION_SYSTEM`
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            **Programme**
          </td>

          <td>
            `/NEWR/ONE_COLLECTION`
          </td>

          <td>
            `/NEWR/ONE_COLLECTION`
          </td>

          <td>
            `/NEWR/ONE_COLLECTION`
          </td>
        </tr>

        <tr>
          <td>
            **Variante**
          </td>

          <td>
            tracer
          </td>

          <td>
            IDOC
          </td>

          <td>
            SYSTEM
          </td>
        </tr>

        <tr>
          <td>
            **Fréquence de fonctionnement**
          </td>

          <td>
            Toutes les 5 minutes
          </td>

          <td>
            Toutes les 5 minutes
          </td>

          <td>
            Toutes les 5 minutes
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

3. Cliquez sur **Step**, entrez le **Program Name** `/NEWR/ONE_COLLECTION` et sélectionnez la **Variant**.
4. Cliquez sur **Start Condition**, définissez la **Start Date** et **Time** de début et cochez la case **Periodic Job**.
5. Accédez à **Period Values**, cliquez sur **Other Period** et saisissez **5** pour les minutes.

## Planifier une nouvelle soumission du programme [#resubmit-program]

1. Créez une variante nommée **DEFAULT** pour le programme `/NEWR/RESEND_FAILED_API_TRANS` afin de soumettre à nouveau les transmissions ayant échoué pour le compte New Relic en cas d&apos;erreur de transmission.

2. Spécifiez les valeurs suivantes :

   * [**ID de compte New Relic**](/docs/accounts/accounts-billing/account-setup/account-id)
   * **Codes de réponse HTTP**: excluez `000` et `413`, ainsi que la plage `200` à `299`.

   <img title="Resend failed API transactions" alt="A screenshot displaying the resend failed API transactions" src="/images/resend-failed-api-transaction.webp" width="700" />

3. Planifiez cette tâche pour qu&apos;elle s&apos;exécute toutes les 15 minutes afin de soumettre à nouveau les transmissions ayant échoué, telles que celles avec le code de réponse HTTP `500`, et purger périodiquement les entrées log de transmission.