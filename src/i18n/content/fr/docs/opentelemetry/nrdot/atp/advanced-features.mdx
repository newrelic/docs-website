---
title: Fonctionnalités avancées et couches d'intelligence ATP
metaDescription: 'Learn about ATP intelligent features including dynamic thresholds, multi-metric composite scoring, and anomaly detection.'
tags:
  - Open source telemetry integrations
  - OpenTelemetry
  - NRDOT
  - Adaptive Telemetry Processor
  - ATP
  - Dynamic thresholds
  - Anomaly detection
  - Multi-metric scoring
  - Intelligence
freshnessValidatedDate: never
translationType: machine
---

<Callout title="Aperçu">
  Nous travaillons toujours sur cette fonctionnalité, mais nous aimerions que vous l&apos;essayiez !

  Cette fonctionnalité est actuellement fournie dans le cadre d&apos;un aperçu conformément à nos [politiques de pré-sortie](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/).
</Callout>

ATP comprend des couches d&apos;intelligence avancées qui vous offrent un traitement de la télémétrie sophistiqué et adaptatif, allant au-delà du simple filtrage basé sur des seuils.

## Options de configuration avancées [#advanced-config]

Vous pouvez ajouter ces **paramètres facultatifs** à la configuration de votre processeur ATP pour activer des fonctionnalités avancées.

<CollapserGroup>
  <Collapser id="dynamic" title="Seuils dynamiques">
    ### Seuils dynamiques [#dynamic-thresholds]

    Cette fonctionnalité ajuste automatiquement les seuils en fonction du comportement historique de votre système, ce qui vous aide à détecter les anomalies tout en réduisant les faux positifs.

    ```yaml
    processors:
      adaptivetelemetry:
        # ... existing config ...
        # Dynamic threshold configuration
        enable_dynamic_thresholds: true
        dynamic_smoothing_factor: 0.2
        min_thresholds:
          process.cpu.utilization: 0.04  # Can't go below 4%
          process.memory.utilization: 0.04  # Can't go below 4%
        max_thresholds:
          process.cpu.utilization: 0.30  # Can't exceed 30%
          process.memory.utilization: 0.30  # Can't exceed 30%
    ```
  </Collapser>

  <Collapser id="multi-metric" title="Notation composite multi-métrique">
    ### Notation composite multi-métrique [#multi-metric-scoring]

    Cela évalue plusieurs métriques ensemble pour vous donner une vue d&apos;ensemble de la santé des processus, en détectant les processus problématiques sur plusieurs dimensions.

    ```yaml
    processors:
      adaptivetelemetry:
        # ... existing config ...
        # Multi-metric configuration
        enable_multi_metric: true
        composite_threshold: 1.2
        weights:
          process.cpu.utilization: 0.5
          process.memory.utilization: 0.5
    ```
  </Collapser>

  <Collapser id="anomaly-detection" title="Détection des anomalies">
    ### Détection des anomalies [#anomaly-detection]

    Cela détecte les pics soudains de métriques au-dessus des moyennes historiques, vous aidant à repérer les processus devenus incontrôlables ou ayant subi des changements de comportement inattendus.

    ```yaml
    processors:
      adaptivetelemetry:
        # ... existing config ...
        # Anomaly detection configuration
        enable_anomaly_detection: true
        anomaly_history_size: 15
        anomaly_change_threshold: 50.0  # 50% spike triggers anomaly
        anomaly_min_data_points: 3
    ```
  </Collapser>
</CollapserGroup>

## Exemple complet de configuration avancée [#complete-example]

Voici un exemple complet avec toutes les fonctionnalités avancées activées :

```yaml
processors:
  adaptivetelemetry:
    enable_storage: true
    retention_minutes: 30
    include_process_list:
      - "/usr/bin/postgres"
      - "/usr/sbin/nginx"
    metric_thresholds:
      process.cpu.utilization: 0.05
      process.memory.utilization: 0.05
    
    # All advanced features enabled
    enable_dynamic_thresholds: true
    dynamic_smoothing_factor: 0.2
    min_thresholds:
      process.cpu.utilization: 0.04
      process.memory.utilization: 0.04
    max_thresholds:
      process.cpu.utilization: 0.30
      process.memory.utilization: 0.30
    
    enable_multi_metric: true
    composite_threshold: 1.5
    weights:
      process.cpu.utilization: 0.5
      process.memory.utilization: 0.5
    
    enable_anomaly_detection: true
    anomaly_history_size: 15
    anomaly_change_threshold: 50.0
    anomaly_min_data_points: 3
```

## Guide de réglage de la configuration [#tuning-guide]

Les sections suivantes expliquent en détail chaque option de configuration avancée et fournissent des conseils pour les adapter à votre environnement.

<CollapserGroup>
  <Collapser id="basic" title="Paramètres de base">
    ### Paramètres de base

    * `enable_storage`: Activer le stockage persistant pour les données de métriques historiques. Ceci est nécessaire pour la persistance entre les redémarrages.

      * Défaut: `true`

      * Les chemins de stockage sont déterminés automatiquement par la plateforme :

        * **Linux**: `/var/lib/nrdot-collector/adaptiveprocess.db`
        * **Windows**: `%LOCALAPPDATA%\nrdot-collector\adaptiveprocess.db`

    * `retention_minutes`: Durée (en minutes) pendant laquelle continuer à suivre un processus après le dernier dépassement d&apos;un seuil.

      * Défaut : 30 (max : 30)
      * Réglage : Utilisez des valeurs plus faibles (5-10) pour les processus à courte durée de vie ; maintenez à 30 pour les charges de travail stables
  </Collapser>

  <Collapser id="thresholds" title="Paramètres de seuil">
    ### Inclure la liste des processus

    Le `include_process_list` est une liste de processus qui contournent toujours tous les filtres et sont signalés indépendamment des seuils.

    * Cas d&apos;usage : Processus critiques que vous souhaitez toujours monitorer (par exemple, base de données, serveur web)
    * Sécurité : Utilisez des chemins complets (`/usr/bin/postgres`) avec des séparateurs tels que `/usr/bin/postgres`. Les entrées sans séparateur de chemin telles que `"postgres"` ne correspondront à aucun processus.

    **Exemple:**

    ```yaml
    include_process_list:
      - "/usr/bin/postgres"  # Always include PostgreSQL
      - "/usr/sbin/nginx"    # Always include Nginx
    ```
  </Collapser>

  <Collapser id="metric-thresholds" title="Seuils de métrique">
    ### Seuils de métrique

    Les `metric_thresholds` sont des valeurs de seuil statiques pour chaque métrique. Un processus est signalé lorsqu&apos;il **dépasse** cette valeur.

    **Comment optimiser :**

    * Commencez par des valeurs de référence issues de votre charge de travail moyenne
    * Augmentez les seuils pour réduire le bruit et générer moins d&apos;alertes
    * Réduisez les seuils pour détecter les anomalies plus petites
    * Pour les métriques d&apos;utilisation (CPU/mémoire) : utilisez des pourcentages (0,0-1,0 = 0 %-100 %)
    * Pour les métriques de comptage (threads, descripteurs de fichiers) : utilisez des nombres absolus

    **Explication des valeurs d&apos;exemple :**

    ```yaml
    metric_thresholds:
      process.cpu.utilization: 0.0005      # 0.05% CPU - very sensitive
      process.memory.utilization: 0.0005   # 0.05% memory - very sensitive
      process.memory.virtual: 20971520     # 20 MB virtual memory
      process.threads: 16                  # 16 threads
      process.open_file_descriptors: 30    # 30 open files
      process.disk.io: 204800              # 200 KB disk I/O
      process.cpu.time: 0.01               # 0.01 seconds CPU time
    ```
  </Collapser>

  <Collapser id="dynamic-thresholds" title="Seuils dynamiques">
    ### Seuils dynamiques

    Ajuste automatiquement les seuils en fonction du comportement historique. Utile pour les processus avec des modèles de charge de travail variables.

    * `enable_dynamic_thresholds`: Active l&apos;ajustement adaptatif du seuil.

      * Quand l&apos;activer : Processus au comportement fluctuant, tels que les traitements par lots, les serveurs d&apos;API
      * Quand désactiver : Processus au comportement stable et prévisible

    * `dynamic_smoothing_factor`: Vitesse d&apos;adaptation des seuils (0,0-1,0).

      * Plus faible (0,1) : Adaptation lente, plus stable (adapté aux changements progressifs)
      * Plus élevé (0,5) : Adaptation rapide, plus réactif (adapté aux charges de travail volatiles)
      * Par défaut : 0,2 (équilibré)

    * `min_thresholds`: Valeurs plancher - les seuils ne descendront pas en dessous de ces valeurs. Ceci est utilisé pour éviter que les seuils ne deviennent trop sensibles.

    * `max_thresholds`: Valeurs plafonds - les seuils ne dépasseront pas ces valeurs. Ceci est utilisé pour empêcher les seuils de devenir trop indulgents.
  </Collapser>

  <Collapser id="multi-metric-scoring" title="Notation multimétrique">
    ### Scoring multi-métrique (scoring composite)

    Évalue plusieurs métriques ensemble plutôt qu&apos;individuellement. Utile pour détecter les processus qui sont des &quot;acteurs malveillants&quot; sur plusieurs dimensions.

    * `enable_multi_metric`: Active la notation composite.

      * Quand l&apos;activer : vous souhaitez détecter les processus problématiques de plusieurs manières (CPU élevé + mémoire élevée)
      * Quand désactiver : vous souhaitez alerter sur des violations de métriques individuelles

    * `composite_threshold`: Le seuil de score combiné. Un processus est signalé lorsque : (somme pondérée des métriques) &gt; composite\_threshold.

      * Inférieur (0,5) : Plus sensible, détecte les cas marginaux
      * Plus élevé (2.0) : Moins sensible, ne détecte que les problèmes importants
      * Par défaut : 1,5

    * `weights`: Importance de chaque métrique dans le score composite. Plus le poids est élevé, plus la métrique a d&apos;influence.
  </Collapser>

  <Collapser id="anomaly-detection" title="Détection des anomalies">
    ### Détection des anomalies

    Cela détecte les pics soudains ou les comportements inhabituels en comparant les valeurs actuelles aux modèles historiques.

    * `enable_anomaly_detection`: Active la détection de pics.

      * Quand l&apos;activer : Pour détecter les changements soudains (processus devenu incontrôlable)
      * Quand désactiver : Pour les seuils absolus

    * `anomaly_history_size`: Nombre de points de données récents à conserver pour calculer la moyenne de référence.

      * Plus grand (50-100) : Ligne de base plus lisse, détecte les anomalies plus importantes
      * Plus petit (5-15) : Plus réactif, détecte les pics plus petits
      * Défaut : 10 (max : 100)

    * `anomaly_change_threshold`: Pic en pourcentage au-dessus de la moyenne historique pour déclencher une alerte.

      * Exemple : 50.0 = signaler si la valeur actuelle est supérieure de 50 % à la moyenne
      * Plus bas (20-50) : Plus sensible aux changements
      * Plus élevé (100-200) : Capturer uniquement les pics importants
      * Par défaut : 200.0

    * `anomaly_min_data_points`: Nombre minimum de points de données historiques avant l&apos;activation de la détection d&apos;anomalies.

      * Cela évite les faux positifs au démarrage
      * Recommandé : maintenir à 3 (par défaut)
      * Doit être ≤ `anomaly_history_size`
  </Collapser>
</CollapserGroup>

## Stratégie d&apos;optimisation [#tuning-strategy]

**Pour commencer :**

1. Commencer avec `metric_thresholds` uniquement (désactiver dynamique/multi-métrique/anomalie)
2. Observez pendant 1 à 2 jours, puis ajustez les seuils pour réduire les faux positifs
3. Activer `enable_dynamic_thresholds` pour les charges de travail variables
4. Ajouter `enable_anomaly_detection` pour détecter les pics soudains
5. Utilisez `enable_multi_metric` si les processus présentent des problèmes de ressources corrélés

**Modèles courants :**

* **Services de production stables**: utilisez uniquement des seuils statiques
* **Traitements par lots**: utilisez des seuils dynamiques + la détection d&apos;anomalies
* **Applications gourmandes en ressources**: utilisez le score multi-métrique
* **Processus critiques**: ajouter à `include_process_list`

## Ressources connexes [#related-resources]

<DocTiles>
  <DocTile title="Dépannage" path="/docs/opentelemetry/nrdot/atp/troubleshooting">
    Apprenez à résoudre les problèmes ATP dans votre environnement.
  </DocTile>

  <DocTile title="Interrogez vos données" path="/docs/opentelemetry/nrdot/atp/query">
    Apprenez à interroger les données ATP dans New Relic à l&apos;aide de NRQL.
  </DocTile>

  <DocTile title="Visualisez vos données" path="/docs/opentelemetry/nrdot/atp/view-data">
    Apprenez à visualiser les données collectées par ATP dans New Relic.
  </DocTile>
</DocTiles>