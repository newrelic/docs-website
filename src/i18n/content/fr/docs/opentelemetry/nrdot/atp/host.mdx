---
title: Configurer ATP pour l'hôte
metaDescription: Step-by-step guide to install and configure the Adaptive Telemetry Processor (ATP) with NRDOT Collector Host distribution.
tags:
  - Open source telemetry integrations
  - OpenTelemetry
  - NRDOT
  - Adaptive Telemetry Processor
  - ATP
  - Configuration
  - Setup
  - Installation
freshnessValidatedDate: never
translationType: machine
---

<Callout title="Aperçu">
  Nous travaillons toujours sur cette fonctionnalité, mais nous aimerions que vous l&apos;essayiez !

  Cette fonctionnalité est actuellement fournie dans le cadre d&apos;un aperçu conformément à nos [politiques de pré-sortie](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy/).
</Callout>

Apprenez à installer et configurer l&apos;Adaptive Telemetry Processor (ATP) avec le NRDOT Collector. ATP est inclus dans la distribution NRDOT standard pour réduire le volume de données de télémétrie tout en conservant une visibilité critique.

## Options d&apos;installation [#installation-options]

Choisissez la méthode d&apos;installation qui correspond à votre configuration actuelle :

<Tabs>
  <TabsBar>
    <TabsBarItem id="new">Nouvelle installation</TabsBarItem> <TabsBarItem id="upgrade">Mise à niveau depuis NRDOT</TabsBarItem> <TabsBarItem id="native">Migration depuis l&apos;agent natif</TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="new">
      <Steps>
        <Step>
          ### Avant de commencer [#prereq]

          Assurez-vous d&apos;avoir :

          * Votre clé de licence New Relic
          * Privilèges root ou sudo.
          * Accès réseau aux releases GitHub
        </Step>

        <Step>
          ### Installer l&apos;hôte du collecteur NRDOT [#install-nrdot]

          ATP est pré-intégré à la distribution du collecteur NRDOT. Selon votre système d&apos;exploitation, choisissez votre méthode d&apos;installation :

          <CollapserGroup>
            <Collapser id="deb" title="Pour Debian/Ubuntu">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le paquet NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Installez le paquet téléchargé :

                 ```bash
                 sudo dpkg -i collector.deb
                 ```

              4. Configurer le collecteur NRDOT pour utiliser les variables d&apos;environnement définies :

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Démarrer le service de collecte NRDOT :

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="rhel" title="Pour RHEL/CentOS">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le paquet NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Installez le paquet téléchargé :

                 ```bash
                 sudo rpm -i collector.rpm
                 ```

              4. Configurer le collecteur NRDOT pour utiliser les variables d&apos;environnement définies :

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Démarrer le service de collecte NRDOT :

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="binary" title="Pour le binaire manuel">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le collecteur NRDOT :

                 ```bash
                 # Download the tarball
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.tar.gz" \
                   --location \
                   --output collector.tar.gz
                 ```

              3. Extraire le collecteur NRDOT :

                 ```bash
                 # Extract contents
                 tar -xzf collector.tar.gz
                 ```

              4. Exécutez le collecteur :

                 ```bash
                 # Run collector in foreground
                 NEW_RELIC_LICENSE_KEY="${license_key}" ./nrdot-collector --config ./config.yaml
                 ```
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurer ATP [#configure-atp]

          Une fois le collecteur NRDOT installé, modifiez le fichier de configuration du collecteur pour activer et personnaliser ATP. Les chemins des fichiers de configuration varient en fonction de votre méthode d&apos;installation :

          * Pour les installations DEB/RPM, le fichier de configuration se trouve à `/etc/nrdot-collector/config.yaml`.
          * Pour les installations manuelles de binaires, le fichier de configuration se trouve dans le dossier extrait.

          Pour modifier le fichier de configuration :

          1. Ouvrez le fichier de configuration (`config.yaml`) avec un éditeur de texte :

             * Pour les installations DEB/RPM :

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Pour les installations manuelles de binaires :

             ```bash
             nano config.yaml
             ```

          2. Pour collecter les métriques de processus, dans la section `scrapers` du récepteur `hostmetrics`, ajoutez la configuration `process` suivante :

             ```yaml
             receivers:
               hostmetrics:
                 scrapers:
                   # Your existing scrapers...
                   process:
                     metrics:
                       process.cpu.utilization:
                         enabled: true
                       process.memory.utilization:
                         enabled: true
                     mute_process_name_error: true
                     mute_process_exe_error: true
                     mute_process_io_error: true
                     mute_process_user_error: true
             ```

          3. Pour activer ATP, localisez la section `processors` existante et ajoutez la configuration `adaptivetelemetry` en dessous :

             ```yaml
             processors:
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Ajoutez le processeur ATP à votre pipeline de métriques dans la section `service` :

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Facultatif)* Mettez à jour la configuration ATP, comme les seuils de métriques, si nécessaire. Pour plus de détails sur les options de configuration, consultez les [Paramètres de configuration](#config-parameters).

          6. Enregistrez le fichier de configuration.

          7. Redémarrez le collecteur NRDOT pour appliquer les modifications :

          ```bash
          sudo systemctl restart nrdot-collector
          ```
        </Step>

        <Step>
          ### Accédez aux données ATP dans New Relic [#access-data]

          Une fois l&apos;ATP configuré, il commence à collecter des données depuis votre hôte Linux. Vous pouvez accéder à ces données dans l&apos;interface utilisateur New Relic OpenTelemetry. Pour plus d&apos;informations sur l&apos;interface utilisateur New Relic OpenTelemetry, consultez [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Pour afficher les données de métriques du processus ATP dans New Relic :**

          1. Allez à **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Allez à <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Recherchez l&apos;entité sur laquelle vous avez installé le collecteur NRDOT avec ATP.

          3. Sélectionnez l&apos;entité, puis cliquez sur **<DNT>Process</DNT>** dans le volet de gauche.

             Sur la page <DNT>Process</DNT>, vous pouvez consulter tous les processus s&apos;exécutant sur votre hôte, ainsi que leurs ID et les métriques d&apos;utilisation du CPU et de la mémoire. Il affiche également la relation parent-enfant entre les processus si un processus génère d&apos;autres processus.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>

      /* ### Configurer ATP [#atp-configuration] Ajoutez la configuration du processeur ATP à votre `config.yaml` fichier. Voici un exemple complet de configuration : ```yaml processors: adaptivetelemetry: enable_storage: true retention_minutes: 30 include_process_list: - &quot;stress-ng&quot; metric_thresholds: process.cpu.utilization: 0.05 process.memory.utilization : 0.05 process.memory.virtual: 20971520 # 20 Mo process.threads: 16 process.open_file_descriptors : 30 process.disk.io : 204800 # 200 Ko process.disk.operations: 300 process.context_switches : 8 process.paging.faults : 50 process.cpu.time : 0.01 # Activer les couches d&apos;intelligence enable_dynamic_thresholds: true dynamic_smoothing_factor: 0.1 min_thresholds: process.cpu.utilization: 0,0005 process.memory.utilization : 0.0005 max_thresholds: process.cpu.utilization: 0.30 process.memory.utilization: 0.30 # Score composite multi-métrique enable_multi_metric: true composite_threshold: 1.5 weights: process.cpu.utilization: 0.5 process.memory.utilization : 0.5 # Détection d&apos;anomalies enable_anomaly_detection: true anomaly_history_size: 15 anomaly_change_threshold: 50.0 anomaly_min_data_points: 3 service: pipelines: metrics: receivers: [hostmetrics] processors: [adaptivetelemetry, batch] exporters: [otlp] ``` */
    </TabsPageItem>

    <TabsPageItem id="upgrade">
      <Steps>
        <Step>
          ### Avant de commencer [#upgrade-prereq]

          Assurez-vous d&apos;avoir :

          * NRDOT Collector existant version `1.11.0` ou ultérieure
          * Votre clé de licence New Relic
          * Privilèges root ou sudo
          * Sauvegarde de la configuration actuelle
        </Step>

        <Step>
          ### Sauvegarder la configuration actuelle [#backup-config]

          Sauvegardez vos paramètres actuels avant de continuer :

          ```bash
          sudo cp /etc/nrdot-collector/config.yaml /etc/nrdot-collector/config.yaml.bak
          ```
        </Step>

        <Step>
          ### Mettre à jour le collecteur NRDOT [#upgrade-collector]

          Pour mettre à jour le collecteur NRDOT vers la dernière version avec la prise en charge d&apos;ATP, réexécutez les commandes d&apos;installation pour la dernière version. Cela écrasera l&apos;ancien binaire tout en conservant votre fichier de configuration existant.

          <CollapserGroup>
            <Collapser id="upgrade-deb" title="Pour Debian/Ubuntu">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 ```

              2. Téléchargez la dernière version du collecteur NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Installez le package du collecteur NRDOT téléchargé :

                 ```bash
                 sudo dpkg -i collector.deb
                 ```
            </Collapser>

            <Collapser id="upgrade-rpm" title="Pour RHEL/CentOS">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>"
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 ```

              2. Téléchargez la dernière version du collecteur NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Installez le package du collecteur NRDOT téléchargé :

                 ```bash
                 sudo rpm -U collector.rpm
                 ```
            </Collapser>

            <Collapser id="upgrade-manual" title="Pour le binaire manuel">
              1. Arrêtez le collecteur en cours d&apos;exécution et sauvegardez votre configuration :

                 ```bash
                 pkill -f nrdot-collector
                 cp config.yaml config.yaml.bak
                 ```

              2. Suivez les étapes d&apos;installation dans l&apos;onglet **New Installation** → section **For manual binary** pour terminer les étapes restantes.

                 <Callout variant="caution">
                   Cela écrasera votre config.yaml actuel, c&apos;est pourquoi la sauvegarde de l&apos;étape 1 était nécessaire.
                 </Callout>
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurer ATP [#configure-atp-upgrade]

          La mise à niveau a conservé vos paramètres précédents, donc votre `config.yaml` ne contient pas encore les nouveaux paramètres ATP. Vous devez les ajouter manuellement.

          Pour modifier le fichier de configuration :

          1. Ouvrez le fichier de configuration (`config.yaml`) avec un éditeur de texte en utilisant les privilèges root ou sudo :

             * Pour les installations DEB/RPM :

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Pour les installations manuelles de binaires :

             ```bash
             nano config.yaml
             ```

          2. Pour collecter les métriques de processus, dans la section `scrapers` du récepteur `hostmetrics`, ajoutez la configuration `process` suivante :

             ```yaml
             processes:
             process:
               metrics:
                 process.cpu.utilization:
                   enabled: true
                 process.memory.utilization:
                   enabled: true
               mute_process_name_error: true
               mute_process_exe_error: true
               mute_process_io_error: true
               mute_process_user_error: true
             ```

          3. Pour activer ATP, localisez la section `processors` existante et ajoutez la configuration `adaptivetelemetry` en dessous :

             ```yaml
             processors:
               # Your existing processors...
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Ajoutez le processeur ATP à votre pipeline de métriques dans la section `service` :

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Facultatif)* Mettez à jour la configuration ATP, comme les seuils de métriques, si nécessaire. Pour plus de détails sur les options de configuration, consultez les [Paramètres de configuration](#config-parameters).

          6. Enregistrez le fichier de configuration.

          7. Redémarrez le collecteur NRDOT pour appliquer les modifications :

             ```bash
             sudo systemctl restart nrdot-collector
             ```
        </Step>

        <Step>
          ### Accédez aux données ATP dans New Relic [#access-data]

          Une fois l&apos;ATP configuré, il commence à collecter des données depuis votre hôte Linux. Vous pouvez accéder à ces données dans l&apos;interface utilisateur New Relic OpenTelemetry. Pour plus d&apos;informations sur l&apos;interface utilisateur New Relic OpenTelemetry, consultez [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Pour afficher les données de métriques du processus ATP dans New Relic :**

          1. Allez à **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Allez à <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Recherchez l&apos;entité sur laquelle vous avez installé le collecteur NRDOT avec ATP.

          3. Sélectionnez l&apos;entité, puis cliquez sur **<DNT>Process</DNT>** dans le volet de gauche.

             Sur la page <DNT>Process</DNT>, vous pouvez consulter tous les processus s&apos;exécutant sur votre hôte, ainsi que leurs ID et les métriques d&apos;utilisation du CPU et de la mémoire. Il affiche également la relation parent-enfant entre les processus si un processus génère d&apos;autres processus.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>
    </TabsPageItem>

    <TabsPageItem id="native">
      Pour installer ATP en migrant de l&apos;agent d&apos;infrastructure natif New Relic vers la distribution hôte du collecteur NRDOT, vous devez désinstaller l&apos;agent natif et configurer NRDOT avec ATP.

      <Steps>
        <Step>
          ### Avant de commencer [#prereq-native]

          Assurez-vous d&apos;avoir :

          * Votre clé de licence New Relic
          * Privilèges root ou sudo
          * Planifier une interruption de service minimale
        </Step>

        <Step>
          ### Arrêter et désactiver l&apos;agent natif [#stop-native-agent]

          1. Pour arrêter l&apos;agent d&apos;infrastructure existant afin d&apos;éviter tout conflit de données, exécutez :

             ```bash
             # Stop the service
             sudo systemctl stop newrelic-infra
             ```

          2. Pour désactiver le lancement de l&apos;agent d&apos;infrastructure au démarrage, exécutez :

             ```bash
             # Disable from starting on boot
             sudo systemctl disable newrelic-infra
             ```
        </Step>

        <Step>
          ### Installer l&apos;hôte du collecteur NRDOT [#install-nrdot-native]

          ATP est pré-intégré à la distribution du collecteur NRDOT. Selon votre système d&apos;exploitation, choisissez votre méthode d&apos;installation :

          <CollapserGroup>
            <Collapser id="deb-native" title="Pour Debian/Ubuntu">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le paquet NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.deb" \
                   --location \
                   --output collector.deb
                 ```

              3. Installez le paquet téléchargé :

                 ```bash
                 sudo dpkg -i collector.deb
                 ```

              4. Configurer le collecteur NRDOT pour utiliser les variables d&apos;environnement définies :

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Démarrer le service de collecte NRDOT :

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="rhel-native" title="Pour RHEL/CentOS">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="x86_64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le paquet NRDOT :

                 ```bash
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.rpm" \
                   --location \
                   --output collector.rpm
                 ```

              3. Installez le paquet téléchargé :

                 ```bash
                 sudo rpm -i collector.rpm
                 ```

              4. Configurer le collecteur NRDOT pour utiliser les variables d&apos;environnement définies :

                 ```bash
                 echo "NEW_RELIC_LICENSE_KEY=${license_key}" | sudo tee -a /etc/${collector_distro}/${collector_distro}.conf > /dev/null
                 ```

              5. Démarrer le service de collecte NRDOT :

                 ```bash
                 sudo systemctl reload-or-restart "${collector_distro}.service"
                 ```
            </Collapser>

            <Collapser id="binary-native" title="Pour le binaire manuel">
              1. Définissez les variables d&apos;environnement :

                 ```bash
                 export collector_distro="nrdot-collector"
                 export collector_version="<NRDOT_COLLECTOR_LATEST_VERSION>" #Fetch the latest version from GitHub releases available at https://github.com/newrelic/nrdot-collector-releases/releases
                 export collector_arch="amd64"  # Use 'arm64' for ARM processors
                 export license_key="<YOUR_NEW_RELIC_LICENSE_KEY>"
                 ```

              2. Téléchargez le collecteur NRDOT :

                 ```bash
                 # Download the tarball
                 curl "https://github.com/newrelic/nrdot-collector-releases/releases/download/${collector_version}/${collector_distro}_${collector_version}_linux_${collector_arch}.tar.gz" \
                   --location \
                   --output collector.tar.gz
                 ```

              3. Extraire le collecteur NRDOT :

                 ```bash
                 # Extract contents
                 tar -xzf collector.tar.gz
                 ```

              4. Exécutez le collecteur :

                 ```bash
                 # Run collector in foreground
                 NEW_RELIC_LICENSE_KEY="${license_key}" ./nrdot-collector --config ./config.yaml
                 ```
            </Collapser>
          </CollapserGroup>
        </Step>

        <Step>
          ### Configurer ATP [#configure-atp-native]

          Une fois le collecteur NRDOT installé, modifiez le fichier de configuration du collecteur pour activer et personnaliser ATP. Les chemins des fichiers de configuration varient en fonction de votre méthode d&apos;installation :

          * Pour les installations DEB/RPM, le fichier de configuration se trouve à `/etc/nrdot-collector/config.yaml`.
          * Pour les installations manuelles de binaires, le fichier de configuration se trouve dans le dossier extrait.

          Pour modifier le fichier de configuration :

          1. Ouvrez le fichier de configuration (`config.yaml`) avec un éditeur de texte :

             * Pour les installations DEB/RPM :

             ```bash
             sudo nano /etc/nrdot-collector/config.yaml
             ```

             * Pour les installations manuelles de binaires :

             ```bash
             nano config.yaml
             ```

          2. Pour collecter les métriques de processus, dans la section `scrapers` du récepteur `hostmetrics`, ajoutez la configuration `process` suivante :

             ```yaml
             receivers:
               hostmetrics:
                 scrapers:
                   # Your existing scrapers...
                   process:
                     metrics:
                       process.cpu.utilization:
                         enabled: true
                       process.memory.utilization:
                         enabled: true
                     mute_process_name_error: true
                     mute_process_exe_error: true
                     mute_process_io_error: true
                     mute_process_user_error: true
             ```

          3. Pour activer ATP, localisez la section `processors` existante et ajoutez la configuration `adaptivetelemetry` en dessous :

             ```yaml
             processors:
               adaptivetelemetry:
                 enable_storage: true
                 retention_minutes: 30
                 include_process_list:
                   - "/usr/bin/postgres"
                   - "/usr/sbin/nginx" # Replace with your target processes
                 metric_thresholds:
                   process.cpu.utilization: 0.05     # 5% CPU
                   process.memory.utilization: 0.05  # 5% memory
             ```

          4. Ajoutez le processeur ATP à votre pipeline de métriques dans la section `service` :

             ```yaml
             service:
               pipelines:
                 metrics/host:
                   receivers: [hostmetrics]
                   processors:
                     - memory_limiter
                     - adaptivetelemetry  # ADD THIS LINE
                     - metricstransform
                     - filter/exclude_cpu_utilization
                     - filter/exclude_memory_utilization
             ```

          5. *(Facultatif)* Mettez à jour la configuration ATP, comme les seuils de métriques, si nécessaire. Pour plus de détails sur les options de configuration, consultez les [Paramètres de configuration](#config-parameters).

          6. Enregistrez le fichier de configuration.

          7. Redémarrez le collecteur NRDOT pour appliquer les modifications :

          ```bash
          sudo systemctl restart nrdot-collector
          ```
        </Step>

        <Step>
          ### Vérifier la migration [#verify-migration]

          Une fois l&apos;installation réussie, vérifiez que les données sont transmises à New Relic :

          1. Pour vérifier l&apos;état du service, exécutez :

             ```bash
             sudo systemctl status nrdot-collector
             ```

          2. Pour vérifier les logs, exécutez :

             ```bash
             sudo journalctl -u nrdot-collector -f
             ```
        </Step>

        <Step>
          ### Accédez aux données ATP dans New Relic [#access-data]

          Une fois l&apos;ATP configuré, il commence à collecter des données depuis votre hôte Linux. Vous pouvez accéder à ces données dans l&apos;interface utilisateur New Relic OpenTelemetry. Pour plus d&apos;informations sur l&apos;interface utilisateur New Relic OpenTelemetry, consultez [OpenTelemetry APM UI](/docs/opentelemetry/get-started/apm-monitoring/opentelemetry-apm-ui).

          **Pour afficher les données de métriques du processus ATP dans New Relic :**

          1. Allez à **<DNT>[one.newrelic.com](https://one.newrelic.com) &gt; All Entities</DNT>**.

             OU

             Allez à <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Catalogs &gt; Infrastructure**</DNT>.

          2. Recherchez l&apos;entité sur laquelle vous avez installé le collecteur NRDOT avec ATP.

          3. Sélectionnez l&apos;entité, puis cliquez sur **<DNT>Process</DNT>** dans le volet de gauche.

             Sur la page <DNT>Process</DNT>, vous pouvez consulter tous les processus s&apos;exécutant sur votre hôte, ainsi que leurs ID et les métriques d&apos;utilisation du CPU et de la mémoire. Il affiche également la relation parent-enfant entre les processus si un processus génère d&apos;autres processus.

             <img style={{ align: 'left' }} title="ATP process metrics in New Relic OpenTelemetry UI" alt="ATP process metrics in New Relic OpenTelemetry UI" src="/images/atp-process-metrics.webp" />
        </Step>
      </Steps>
    </TabsPageItem>
  </TabsPages>
</Tabs>

## Paramètres de configuration [#config-parameters]

<CollapserGroup>
  <Collapser id="core-settings" title="Paramètres principaux">
    <table>
      <thead>
        <tr>
          <th>
            **paramètres**
          </th>

          <th>
            **Type**
          </th>

          <th>
            **Défaut**
          </th>

          <th>
            **Description**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_storage`
          </td>

          <td>
            booléen
          </td>

          <td>
            `true`
          </td>

          <td>
            Activer le stockage persistant. Les chemins de stockage sont déterminés automatiquement : Linux : `/var/lib/nrdot-collector/adaptiveprocess.db`, Windows : `%LOCALAPPDATA%\nrdot-collector\adaptiveprocess.db`
          </td>
        </tr>

        <tr>
          <td>
            `retention_minutes`
          </td>

          <td>
            entier
          </td>

          <td>
            `30`
          </td>

          <td>
            Durée de conservation de l&apos;état du processus en minutes
          </td>
        </tr>

        <tr>
          <td>
            `include_process_list`
          </td>

          <td>
            éventail
          </td>

          <td>
            `[]`
          </td>

          <td>
            Noms de processus à toujours inclure (contourne le filtrage)
          </td>
        </tr>

        <tr>
          <td>
            `metric_thresholds`
          </td>

          <td>
            carte
          </td>

          <td>
            `{}`
          </td>

          <td>
            Seuils statiques par type de métrique
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="dynamic-thresholds" title="Seuils dynamiques">
    <table>
      <thead>
        <tr>
          <th>
            **paramètres**
          </th>

          <th>
            **Type**
          </th>

          <th>
            **Défaut**
          </th>

          <th>
            **Description**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_dynamic_thresholds`
          </td>

          <td>
            booléen
          </td>

          <td>
            `false`
          </td>

          <td>
            Activer l&apos;ajustement adaptatif du seuil
          </td>
        </tr>

        <tr>
          <td>
            `dynamic_smoothing_factor`
          </td>

          <td>
            virgule flottante
          </td>

          <td>
            `0.1`
          </td>

          <td>
            Facteur de lissage pour l&apos;adaptation du seuil (0.0-1.0)
          </td>
        </tr>

        <tr>
          <td>
            `min_thresholds`
          </td>

          <td>
            carte
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valeurs de seuil minimales par métrique
          </td>
        </tr>

        <tr>
          <td>
            `max_thresholds`
          </td>

          <td>
            carte
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valeurs de seuil maximales par métrique
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="multi-metric-scoring" title="Notation composite multi-métrique">
    <table>
      <thead>
        <tr>
          <th>
            **paramètres**
          </th>

          <th>
            **Type**
          </th>

          <th>
            **Défaut**
          </th>

          <th>
            **Description**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_multi_metric`
          </td>

          <td>
            booléen
          </td>

          <td>
            `false`
          </td>

          <td>
            Activer le scoring composite sur les métriques
          </td>
        </tr>

        <tr>
          <td>
            `composite_threshold`
          </td>

          <td>
            virgule flottante
          </td>

          <td>
            `1.5`
          </td>

          <td>
            Seuil pour l&apos;évaluation du score composite. Ce score doit être supérieur à `0.0`
          </td>
        </tr>

        <tr>
          <td>
            `weights`
          </td>

          <td>
            carte
          </td>

          <td>
            `{}`
          </td>

          <td>
            Valeurs de pondération par métrique pour la notation composite
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="anomaly-detection" title="Détection des anomalies">
    <table>
      <thead>
        <tr>
          <th>
            **paramètres**
          </th>

          <th>
            **Type**
          </th>

          <th>
            **Défaut**
          </th>

          <th>
            **Description**
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `enable_anomaly_detection`
          </td>

          <td>
            booléen
          </td>

          <td>
            `false`
          </td>

          <td>
            Activer la couche de détection d&apos;anomalies
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_history_size`
          </td>

          <td>
            entier
          </td>

          <td>
            `15`
          </td>

          <td>
            Nombre de points de données historiques à suivre
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_change_threshold`
          </td>

          <td>
            virgule flottante
          </td>

          <td>
            `50.0`
          </td>

          <td>
            Seuil de variation en pourcentage pour les anomalies
          </td>
        </tr>

        <tr>
          <td>
            `anomaly_min_data_points`
          </td>

          <td>
            entier
          </td>

          <td>
            `3`
          </td>

          <td>
            Points de données minimum requis avant la détection d&apos;anomalies
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>
</CollapserGroup>

/\* ## Directives relatives aux seuils de métriques ### Utilisation du CPU (échelle 0.0-1.0) - \*\*Filtrage léger\*\* : \`0.10\` (10 % CPU) - \*\*Filtrage standard\*\* : \`0.05\` (5 % CPU) - \*\*Filtrage agressif\*\* : \`0.02\` (2 % CPU) ### Utilisation de la mémoire (échelle 0.0-1.0) - \*\*Filtrage léger\*\* : \`0.10\` (10 % mémoire) - \*\*Filtrage standard\*\* : \`0.05\` (5 % mémoire) - \*\*Filtrage agressif\*\* : \`0.02\` (2 % mémoire) ### Utilisation de la mémoire (octets) - \*\*Petits processus\*\* : \`52428800\` (50 Mo) - \*\*Processus moyens\*\* : \`104857600\` (100 Mo) - \*\*Processus volumineux\*\* : \`209715200\` (200 Mo) ### Seuils d&apos;E/S (octets) - \*\*E/S légères\*\* : \`1048576\` (1 Mo) - \*\*E/S moyennes\*\* : \`5242880\` (5 Mo) - \*\*E/S intensives\*\* : \`10485760\` (10 Mo) ## Correspondance des noms de processus ATP fait correspondre les noms de processus en utilisant le chemin complet : ### Exemples - ✅ \*\*Correct\*\* : \`/usr/sbin/nginx\` - ✅ \*\*Correct\*\* : \`/usr/bin/java\` - ❌ \*\*Incorrect\*\* : \`&quot;nginx&quot;\` ne correspondra pas ### Noms de processus courants \`\`\`yaml include\_process\_list: # Serveurs Web - &quot;nginx&quot; - &quot;apache2&quot; - &quot;httpd&quot; # Bases de données - &quot;postgres&quot; - &quot;mysql&quot; - &quot;redis&quot; - &quot;mongodb&quot; # Applications - &quot;java&quot; - &quot;python&quot; - &quot;node&quot; - &quot;php-fpm&quot; \`\`\` \*/

## Ressources connexes [#related-resources]

<DocTiles>
  <DocTile title="Dépannage" path="/docs/opentelemetry/nrdot/atp/troubleshooting">
    Apprenez à résoudre les problèmes ATP dans votre environnement.
  </DocTile>

  <DocTile title="Interrogez vos données" path="/docs/opentelemetry/nrdot/atp/query">
    Apprenez à interroger les données ATP dans New Relic à l&apos;aide de NRQL.
  </DocTile>

  <DocTile title="Fonctionnalités-avancées" path="/docs/opentelemetry/nrdot/atp/advanced-features">
    Découvrez comment activer les fonctionnalités avancées de votre déploiement ATP.
  </DocTile>
</DocTiles>