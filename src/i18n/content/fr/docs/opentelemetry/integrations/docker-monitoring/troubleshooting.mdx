---
title: Dépanner le monitoring des conteneurs Docker
tags:
  - Integrations
  - OpenTelemetry
  - Docker
  - Troubleshooting
metaDescription: 'Troubleshoot common issues with Docker container monitoring using OpenTelemetry Collector, including collector problems, missing metrics, and configuration issues.'
freshnessValidatedDate: never
translationType: machine
---

Si vous rencontrez des problèmes avec votre configuration de monitoring Docker, consultez ces problèmes courants et leurs solutions.

<Tabs>
  <TabsBar>
    <TabsBarItem id="nrdot-troubleshooting">
      Collecteur NRDOT
    </TabsBarItem>

    <TabsBarItem id="otelcol-troubleshooting">
      OpenTelemetry Collector Contrib
    </TabsBarItem>
  </TabsBar>

  <TabsPages>
    <TabsPageItem id="nrdot-troubleshooting">
      <Callout variant="tip">
        **Dépannage général de NRDOT**: Pour les problèmes de démarrage du collecteur, la validation de la configuration, la connectivité réseau et les diagnostics NrIntegrationError, consultez le [Guide de dépannage NRDOT](https://github.com/newrelic/nrdot-collector-releases/blob/main/distributions/TROUBLESHOOTING.md). Les problèmes ci-dessous sont spécifiques à le monitoring des conteneurs Docker.
      </Callout>

      <CollapserGroup>
        <Collapser id="nrdot-no-metrics" title="Aucune métrique Docker n'apparaît dans New Relic">
          **Problème**: Les conteneurs Docker sont en cours d&apos;exécution, mais aucune métrique Docker n&apos;apparaît dans New Relic après plus de 10 minutes.

          **Diagnostics**:

          ```bash
          # Check Docker daemon accessibility
          docker info

          # Test Docker socket permissions
          ls -l /var/run/docker.sock

          # Verify containers are running
          docker ps

          # Check collector logs for Docker-specific errors
          journalctl -u nrdot-collector | grep -i "docker"
          ```

          **Solutions**:

          1. **Accès au socket Docker**: Ajouter l&apos;utilisateur nrdot-collector au groupe docker :

             ```bash
             sudo usermod -aG docker nrdot-collector
             sudo systemctl restart nrdot-collector
             ```

          2. **Version de l&apos;API Docker**: Assurez-vous que la version de l&apos;API Docker est 1.25+ :

             ```bash
             docker version --format '{{.Client.APIVersion}}'
             ```
        </Collapser>

        <Collapser id="nrdot-permission-errors" title="Erreurs de permission refusée">
          **Problème**: Les logs du Collector affichent « permission denied » lors de l&apos;accès au socket Docker.

          **Diagnostics**:

          ```bash
          # Check socket ownership and permissions
          ls -la /var/run/docker.sock

          # Check collector user membership
          groups nrdot-collector

          # Check collector logs for permission errors
          journalctl -u nrdot-collector | grep -i "permission denied"
          ```

          **Solutions**:

          ```bash
          # Option 1: Add collector user to docker group (recommended)
          sudo usermod -aG docker nrdot-collector
          sudo systemctl restart nrdot-collector

          # Option 2: Adjust socket permissions (less secure)
          sudo chmod 666 /var/run/docker.sock

          # Option 3: Run collector as root (not recommended for production)
          # Modify systemd service file User= setting
          ```
        </Collapser>

        <Collapser id="nrdot-incomplete-metrics" title="Métriques de conteneur incomplètes ou manquantes">
          **Problème**: Certains conteneurs affichent des métriques tandis que d&apos;autres non, ou les métriques sont sporadiques.

          **Diagnostics**:

          ```bash
          # Check for containers with networking issues
          docker inspect $(docker ps -q) | grep -A5 "NetworkSettings"

          # Review collector configuration
          cat /etc/nrdot-collector/docker-stats-config.yaml | grep -A10 "docker_stats:"

          # Check for resource constraints
          docker stats --no-stream

          # Check collector logs for specific errors
          journalctl -u nrdot-collector | grep -i "docker_stats"
          ```

          **Solutions**:

          * **Visibilité des conteneurs**: Assurez-vous que tous les conteneurs sont accessibles via le chemin du socket Docker configuré dans le collecteur
          * **Limites de ressources**: Augmentez les valeurs de délai d&apos;attente du collecteur si les conteneurs sont lents à répondre. Modifier votre `/etc/nrdot-collector/docker-stats-config.yaml`:
            ```yaml
            receivers:
              docker_stats:
                timeout: 10s  # Increase from default 5s
                collection_interval: 30s  # Reduce frequency if needed
            ```
          * **Espaces de noms réseau**: Certains conteneurs dans des espaces de noms réseau restreints peuvent ne pas être accessibles
        </Collapser>

        <Collapser id="nrdot-no-logs" title="La collecte de logs ne fonctionne pas">
          **Problème**: Collecte de logs configurée mais les logs de conteneurs n&apos;apparaissent pas dans New Relic.

          **Diagnostics**:

          ```bash
          # Check log directory permissions
          ls -la /var/lib/docker/containers/

          # Verify receiver creator is discovering containers
          journalctl -u nrdot-collector | grep -i "receiver.*creator\|docker.*observer"

          # Check if containers have exposed ports (required for discovery)
          docker ps --format 'table {{.Names}}\t{{.Ports}}'

          # Verify logs pipeline is configured
          journalctl -u nrdot-collector | grep -i "logs"
          ```

          **Solutions**:

          1. **Permissions de fichier**: accordez l&apos;accès au répertoire des logs :

             ```bash
             sudo chmod -R 755 /var/lib/docker/containers/
             # Or add collector to docker group
             sudo usermod -aG docker nrdot-collector
             sudo systemctl restart nrdot-collector
             ```

          2. **Exposition des ports de conteneurs**: exposez les ports pour la découverte des conteneurs :

             ```bash
             # When running containers, expose at least one port
             docker run -p 8080:8080 my-app:latest
             # Or use --expose flag
             docker run --expose 80 my-app:latest
             ```

          3. **Vérifier la configuration des logs**: Assurez-vous que votre configuration de collecte de logs est incluse :

             ```bash
             # Check systemd override
             sudo systemctl cat nrdot-collector | grep -A2 "ExecStart="
             # Should point to: --config=/etc/nrdot-collector/docker-stats-config.yaml (or combined config with logs)
             ```

          4. **Interroger les logs dans New Relic**:

             ```sql
             FROM Log SELECT * WHERE newrelic.source='api.logs.otlp' SINCE 1 hour ago
             ```
        </Collapser>
      </CollapserGroup>
    </TabsPageItem>

    <TabsPageItem id="otelcol-troubleshooting">
      <CollapserGroup>
        <Collapser id="collector-issues" title="Le Collecteur ne démarre pas ou plante">
          **Problème**: OpenTelemetry Collector ne démarre pas ou plante immédiatement.

          **Diagnostics**:

          ```bash
          # Check collector status
          sudo systemctl status otelcol-contrib

          # View recent logs
          journalctl -u otelcol-contrib --since "1 hour ago" -f

          # Test configuration syntax
          otelcol-contrib --config-validate --config=/etc/otelcol-contrib/config.yaml
          ```

          **Solutions**:

          * **Erreurs de configuration**: Corrigez les erreurs de syntaxe YAML et assurez-vous que tous les champs obligatoires sont présents
          * **Permissions manquantes**: Assurez-vous que l&apos;utilisateur du collecteur dispose d&apos;un accès en lecture au fichier de configuration
          * **Variables d&apos;environnement**: Vérifiez que `NEWRELIC_LICENSE_KEY` et `NEWRELIC_OTLP_ENDPOINT` sont correctement définies
        </Collapser>

        <Collapser id="no-metrics" title="Aucune métrique n'apparaît dans New Relic">
          **Problème**: Les conteneurs Docker sont en cours d&apos;exécution, mais aucune métrique n&apos;apparaît dans New Relic après plus de 10 minutes.

          **Diagnostics**:

          ```bash
          # Verify collector is running and processing data
          journalctl -u otelcol-contrib | grep -i "docker\|error\|export"

          # Check Docker daemon accessibility
          docker info

          # Test Docker socket permissions
          ls -l /var/run/docker.sock

          # Verify containers are running
          docker ps
          ```

          **Solutions**:

          1. **Accès au socket Docker**: Ajoutez l&apos;utilisateur du collecteur au groupe docker :

             ```bash
             sudo usermod -aG docker otelcol-contrib
             sudo systemctl restart otelcol-contrib
             ```

          2. **Problèmes de clé de licence**: vérifiez que votre clé de licence est correcte et dispose des autorisations appropriées :

             ```bash
             echo $NEWRELIC_LICENSE_KEY
             # Should be 40-character NRAK-prefixed key for US, or EU equivalent
             ```

          3. **Connectivité réseau**: Tester l&apos;accessibilité du point de terminaison OTLP :

             ```bash
             # For US region
             curl -v -H "api-key: $NEWRELIC_LICENSE_KEY" https://otlp.nr-data.net/v1/metrics

             # For EU region
             curl -v -H "api-key: $NEWRELIC_LICENSE_KEY" https://otlp.eu01.nr-data.net/v1/metrics
             ```

          4. **Version de l&apos;API Docker**: Assurez-vous que la version de l&apos;API Docker est 1.25+ :

             ```bash
             docker version --format '{{.Client.APIVersion}}'
             ```
        </Collapser>

        <Collapser id="permission-errors" title="Erreurs de permission refusée">
          **Problème**: Les logs du Collector affichent « permission denied » lors de l&apos;accès au socket Docker.

          **Diagnostics**:

          ```bash
          # Check socket ownership and permissions
          ls -la /var/run/docker.sock

          # Check collector user membership
          groups otelcol-contrib
          ```

          **Solutions**:

          ```bash
          # Option 1: Add collector user to docker group (recommended)
          sudo usermod -aG docker otelcol-contrib
          sudo systemctl restart otelcol-contrib

          # Option 2: Adjust socket permissions (less secure)
          sudo chmod 666 /var/run/docker.sock

          # Option 3: Run collector as root (not recommended for production)
          # Modify systemd service file User= setting
          ```
        </Collapser>

        <Collapser id="incomplete-metrics" title="Métriques de conteneur incomplètes ou manquantes">
          **Problème**: Certains conteneurs affichent des métriques tandis que d&apos;autres non, ou les métriques sont sporadiques.

          **Diagnostics**:

          ```bash
          # Check for containers with networking issues
          docker inspect $(docker ps -q) | grep -A5 "NetworkSettings"

          # Review collector configuration
          grep -A20 "docker_stats:" /etc/otelcol-contrib/config.yaml

          # Check for resource constraints
          docker stats --no-stream
          ```

          **Solutions**:

          * **Visibilité des conteneurs**: Assurez-vous que tous les conteneurs sont accessibles via le chemin du socket Docker configuré dans le collecteur

          * **Limites de ressources**: Augmentez les valeurs de délai d&apos;attente du collecteur si les conteneurs sont lents à répondre :

            ```yaml
            docker_stats:
              timeout: 10s  # Increase from default 5s
              collection_interval: 30s  # Reduce frequency if needed
            ```

          * **Espaces de noms réseau**: Certains conteneurs dans des espaces de noms réseau restreints peuvent ne pas être accessibles
        </Collapser>

        <Collapser id="performance-issues" title="Utilisation élevée de la mémoire ou du CPU par le collecteur">
          **Problème**: Le collecteur OpenTelemetry consomme des ressources système excessives.

          **Diagnostics**:

          ```bash
          # Monitor collector resource usage
          top -p $(pgrep otelcol-contrib)

          # Check metric collection frequency
          grep -A10 "docker_stats:" /etc/otelcol-contrib/config.yaml

          # Count active containers
          docker ps --format 'table {{.Names}}\t{{.Status}}' | wc -l
          ```

          **Solutions**:

          * **Ajuster l&apos;intervalle de collecte**: Réduisez la fréquence de monitoring pour les environnements comptant un grand nombre de conteneurs :

            ```yaml
            docker_stats:
              collection_interval: 30s  # Increase from 15s
            ```

          * **Désactiver les métriques coûteuses**: désactivez les métriques par CPU si elles ne sont pas nécessaires :

            ```yaml
            docker_stats:
              metrics:
                container.cpu.usage.percpu:
                  enabled: false
            ```

          * **Configurer le traitement par lots**: Optimisez la mise en lots pour votre environnement :

            ```yaml
            batch:
              timeout: 60s
              send_batch_size: 1024
            ```
        </Collapser>

        <Collapser id="no-logs" title="La collecte de logs ne fonctionne pas">
          **Problème**: Collecte de logs configurée mais les logs de conteneurs n&apos;apparaissent pas dans New Relic.

          **Diagnostics**:

          ```bash
          # Check log directory permissions
          ls -la /var/lib/docker/containers/

          # Verify receiver creator is discovering containers
          journalctl -u otelcol-contrib | grep -i "receiver.*creator\|docker.*observer"

          # Check if containers have exposed ports (required for discovery)
          docker ps --format 'table {{.Names}}\t{{.Ports}}'
          ```

          **Solutions**:

          1. **Permissions de fichier**: accordez l&apos;accès au répertoire des logs :

             ```bash
             sudo chmod -R 755 /var/lib/docker/containers/
             # Or add collector to docker group
             sudo usermod -aG docker otelcol-contrib
             ```

          2. **Exposition des ports de conteneurs**: exposez les ports pour la découverte des conteneurs :

             ```bash
             # When running containers, expose at least one port
             docker run -p 8080:8080 my-app:latest
             # Or use --expose flag
             docker run --expose 80 my-app:latest
             ```

          3. **Configuration de l&apos;observateur**: Vérifiez les paramètres de l&apos;observateur Docker :

             ```yaml
             docker_observer:
               endpoint: unix:///var/run/docker.sock
               use_hostname_if_present: true
               use_container_labels: true
             ```
        </Collapser>

        <Collapser id="wrong-account" title="Les données n'apparaissent pas dans le bon compte New Relic">
          **Problème**: Les métriques apparaissent dans le mauvais compte ou la mauvaise organisation New Relic.

          **Diagnostics**:

          ```bash
          # Verify license key format and region
          echo $NEWRELIC_LICENSE_KEY | cut -c1-4
          # Should show "NRAK" for US accounts

          # Check configured endpoint
          echo $NEWRELIC_OTLP_ENDPOINT
          ```

          **Solutions**:

          * **Comptes US**: Utilisez `https://otlp.nr-data.net`
          * **Comptes UE**: Utilisez `https://otlp.eu01.nr-data.net`
          * **Vérifiez la clé de licence**: Assurez-vous d&apos;utiliser la clé de licence du bon compte
        </Collapser>
      </CollapserGroup>

      En cas de problèmes persistants, consultez le [guide de dépannage du collecteur OpenTelemetry](https://opentelemetry.io/docs/collector/troubleshooting/) et la [documentation OpenTelemetry de New Relic](/docs/opentelemetry/opentelemetry-introduction/).
    </TabsPageItem>
  </TabsPages>
</Tabs>

## Prochaines étapes [#next-steps]

Si vous avez résolu vos problèmes :

* **Retour à la configuration**: Retournez au [guide de configuration du monitoring Docker](/docs/opentelemetry/integrations/docker-monitoring/self-hosted) pour terminer votre configuration
* **Explorez vos données**: Apprenez à interroger et visualiser vos métriques Docker avec le [guide de référence des métriques](/docs/opentelemetry/integrations/docker-monitoring/metrics-reference)
* **Configurer des alertes**: Créez un monitoring proactif avec des [conditions d&apos;alerte](/docs/alerts/create-alert/create-alert-condition/create-nrql-alert-conditions/) pour les métriques critiques des conteneurs