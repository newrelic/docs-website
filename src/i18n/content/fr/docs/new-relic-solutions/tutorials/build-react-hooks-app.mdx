---
title: CrÃ©ez une application New Relic avec des hooks React
tags:
  - New Relic solutions
  - Build with New Relic
metaDescription: Build a simple New Relic app with React hooks
freshnessValidatedDate: never
translationType: machine
---

<br />

Ã€ partir de la version 2.49.1 de notre `nr1` CLI, vous pouvez crÃ©er des applications New Relic et des visualisations personnalisÃ©es avec [des hooks React](https://reactjs.org/docs/hooks-intro.html). Ce guide donne quelques exemples de hooks React en action dans NerdletÂ !

## Avant de commencer

Le dÃ©veloppement de Nerdpacks nÃ©cessite un compte New Relic et la CLI New Relic, `nr1`.

Si vous ne l&apos;avez pas dÃ©jÃ  faitÂ :

* [Inscrivez-vous](https://newrelic.com/signup/) pour un compte New Relic
* Installer [Node.js](https://nodejs.org/en/download/)
* ComplÃ©tez le [dÃ©marrage rapide de la CLI](https://one.newrelic.com/launcher/developer-center.launcher?pane=eyJuZXJkbGV0SWQiOiJkZXZlbG9wZXItY2VudGVyLmRldmVsb3Blci1jZW50ZXIifQ==)

Vous disposez dÃ©sormais d&apos;un Nerdpack, appelÃ© `my-awesome-nerdpack`. Ce Nerdpack contient un Nerdlet et un lanceur que vous avez nommÃ© (cependant, ce guide utilise le nom du lanceur par dÃ©faut, Â«Â lanceurÂ Â», et le nom du Nerdlet, Â«Â homeÂ Â»). Vous utilisez ce Nerdpack tout au long de ce guide.

Enfin, assurez-vous que votre `nr1` est Ã  jour. Ce guide nÃ©cessite une version minimale de 2.49.1Â :

```sh
nr1 update
nr1 version
[output] @datanerd/nr1/{purple}2.49.1{normal} darwin-x64 node-v14.15.1
```

<Callout variant="tip">
  Si vous utilisez VSCode, nous avons une [extension](https://marketplace.visualstudio.com/items?itemName=new-relic.nr1) et un [pack d&apos;extension](https://marketplace.visualstudio.com/items?itemName=new-relic.new-relic-extension-pack) que vous pouvez utiliser pour crÃ©er votre application.
</Callout>

```jsx fileName=index.js
import React from 'react';

export default class HomeNerdlet extends React.Component {
  render() {
    return <h1>Hello, home Nerdlet!</h1>;
  }
}
```

## Mettez Ã  jour et diffusez votre application localement

Avec `nr1`, vous pouvez proposer une version locale de votre Nerdpack Ã  New Relic. Cela vous aide Ã  dÃ©velopper votre application dans un environnement de type production avant de la publier.

Avant de modifier un code, familiarisez-vous avec la structure du rÃ©pertoire NerdpackÂ :

```txt lineHighlight=3-10,12
my-awesome-nerdpack/
â”œâ”€â”€â”€README.md
â”œâ”€â”€â”€launchers/
â”‚   â””â”€â”€â”€launcher/
â”‚       â””â”€â”€â”€nr1.json
â”œâ”€â”€â”€nerdlets/
â”‚   â””â”€â”€â”€home
â”‚       â”œâ”€â”€â”€index.js
â”‚       â”œâ”€â”€â”€nr1.json
â”‚       â””â”€â”€â”€styles.scss
â”œâ”€â”€â”€node_modules/
â”œâ”€â”€â”€nr1.json
â”œâ”€â”€â”€package-lock.json
â””â”€â”€â”€package.json
```

Les rÃ©pertoires *launchers* et *nerdlets* contiennent la logique de votre application. C&apos;est dans ces rÃ©pertoires que vous mettez Ã  jour la plupart de votre code. Les fichiers *nr1.json* du Nerdpack contiennent des mÃ©tadonnÃ©es sur votre Nerdpack, vos Nerdlets et vos lanceurs.

<Callout variant="tip">
  Lisez [notre documentation](/docs/new-relic-solutions/build-nr-ui/nerdpack-file-structure/) pour en savoir plus sur la structure du fichier Nerdpack.
</Callout>

<Steps>
  <Step>
    Dans *my-awesome-nerdpack/nerdlets/home/index.js*, remplacez la classe *HomeNerdlet* par une fonctionÂ :

    ```jsx fileName=index.js
    import React from 'react';

    function HomeNerdlet () {
        return <h1>Hello, home Nerdlet!</h1>;
    }

    export default HomeNerdlet
    ```
  </Step>

  <Step>
    Ensuite, renvoyez un graphique Billboard au lieu d&apos;un en-tÃªteÂ :

    ```jsx fileName=index.js
    import React from 'react';
    import { BillboardChart} from 'nr1'

    function HomeNerdlet () {

      const clickCount = {
        metadata: {
            id: '1',
            name: 'Count',
            viz: 'main',
        },
        data: [
          { "y": 10 }
        ]
      }
      return <BillboardChart data={[clickCount]}/>
    }

    export default HomeNerdlet
    ```

    <br />

    Pour l&apos;instant, vous affichez une valeur statique dans votre graphique Billboard, mais dans les Ã©tapes ultÃ©rieures, vous fournissez une valeur dynamique Ã  l&apos;aide de l&apos;Ã©tat local de la fonction.
  </Step>

  <Step>
    Si ce n&apos;est pas dÃ©jÃ  fait, diffusez votre application depuis le rÃ©pertoire racine de votre NerdpackÂ :

    ```bash
    nr1 nerdpack:serve
    [output] Found and loaded {success}2 {plain}nr1.json files on MyAwesomeNerdpack ({purple}aad7ebb6-8901-43d0-a681-0719b2c60a11{plain}) Nerdpack.
    [output]
    [output] {purple}Nerdpack:
    [output]  {success}âœ”  MyAwesomeNerdpack {plain}({purple}aad7ebb6-8901-43d0-a681-0719b2c60a11{plain}) {blue}nr1.json
    [output]
    [output] {purple}Launchers:
    [output]  {success}âœ”  launcher {blue}launchers/launcher/nr1.json
    [output]
    [output] {purple}Nerdlets:
    [output]  {success}âœ”  home {blue}nerdlets/home/nr1.json
    [output]
    [output] There is no certificate created yet.
    [output]  {success}âœ”  {plain}New certificate created.
    [output]
    [output] Webpack bundle analyzer is enabled (you need to wait for the first build to finish)
    [output]  â””  You can head to {blue}http://127.0.0.1:27888
    [output]
    [output] {blue}NOTE: {plain}To verify how your assets will look in production, you need to
    [output]       add "--mode=prod" when starting the development server.
    [output]
    [output] ğŸ›   Built artifact files for:ex.js...
    [output]  â  {purple}aad7ebb6-8901-43d0-a681-0719b2c60a11--home {plain}built {success}âœ”
    [output]
    [output]  {success}âœ”  {plain}Nerdpack built successfully!
    [output]  {yellow}â˜…  {plain}Starting as orchestrator...
    [output]
    [output]  {success}âœ”  {plain}Server ready! Test it at: {blue}https://one.newrelic.com/?nerdpacks=local
    [output]  {blue}â†©  {plain}Server will reload automatically if you modify any file!
    [output]
    [output]  {blue}â„¹  {plain}Additionally, you can test the following artifacts at:
    [output]
    [output] {purple}Launchers:
    [output]  â  {success}launcher {blue}https://onenr.io/0z7wkEkMnjL
    [output]  {blue}â„¹  {plain}You can use "npm start -- --mode=prod" to run the development server in prod mode.
    ```
  </Step>

  <Step>
    Utilisez l&apos;URL en bas de la sortie pour ouvrir votre lanceurÂ :

    ```bash
    [output] {purple}Launchers:
    [output]  *  {success}launcher {blue}https://onenr.io/0z7wkEkMnjL
    [output]  {blue}â„¹  {plain}You can use "npm start -- --mode=prod" to run the development server in prod mode.
    ```
  </Step>

  <Step>
    Ici, vous voyez votre Nerdlet avec votre tableau d&apos;affichage affichant le numÃ©ro Â«Â 10Â Â»Â :

    <img title="Static billboard chart in the browser" alt="Static billboard chart in the browser" src="/images/react-hooks-screenshot-static-billboard-local.webp" />
  </Step>
</Steps>

Laissez votre serveur en marche, car il rechargera automatiquement votre Nerdlet lorsque vous modifierez ses fichiers.

## Utilisez le hook `useState()` dans votre Nerdlet

Auparavant, vous utilisiez une valeur statique pour votre graphique Billboard. Maintenant, vous utilisez lâ€™Ã©tat local de votre fonction pour stocker une valeur dynamique et afficher cette valeur dans le graphique.

<Steps>
  <Step>
    Dans *my-awesome-nerdpack/nerdlets/home/index.js*, appelez `useState()` dans votre composant de fonctionÂ :

    ```jsx fileName=index.js
    import React, {useState} from 'react';
    import { BillboardChart} from 'nr1'

    function HomeNerdlet () {
      const [count, setCount] = useState(0);

      const clickCount = {
        metadata: {
            id: '1',
            name: 'Count',
            viz: 'main',
        },
        data: [
          { "y": 10 }
        ]
      }
      return <BillboardChart data={[clickCount]}/>
    }

    export default HomeNerdlet
    ```

    <br />

    Ici, vous appelez `useState()`. Ce hook renvoie deux valeurs, que vous capturez dans un Ã©ventailÂ :

    * `count`:La valeur actuelle dans l&apos;Ã©tat local. Sa valeur par dÃ©faut est 0, l&apos;argument que vous avez passÃ© Ã  `useState()`.
    * `setCount`:Une fonction que vous utilisez pour mettre Ã  jour `count`
  </Step>

  <Step>
    Modifiez les donnÃ©es de votre graphique Billboard pour utiliser `count`:

    ```jsx fileName=index.js
    import React, {useState} from 'react';
    import { BillboardChart} from 'nr1'

    function HomeNerdlet () {
      const [count, setCount] = useState(0);

      const clickCount = {
        metadata: {
          id: '1',
          name: 'Count',
          viz: 'main',
        },
        data: [
          { "y": count }
        ]
      }
      return <BillboardChart data={[clickCount]}/>
    }

    export default HomeNerdlet
    ```

    <br />

    Ã€ lâ€™heure actuelle, la valeur de count sera `0` Ã  chaque rendu car vous ne mettez jamais Ã  jour lâ€™Ã©tat. Il vous faut un moyen de faire Ã§a.
  </Step>

  <Step>
    Ã€ cÃ´tÃ© de votre graphique, affichez un bouton pour incrÃ©menter `count`:

    ```jsx fileName=index.js
    import React, {useState} from 'react';
    import { BillboardChart} from 'nr1'

    function HomeNerdlet () {
      const [count, setCount] = useState(0);

      const clickCount = {
        metadata: {
            id: '1',
            name: 'Count',
            viz: 'main',
        },
        data: [
          { "y": count }
        ]
      }
      return (
        <div>
          <BillboardChart data={[clickCount]}/>
          <button onClick={() => setCount(count + 1)}>
            Increment count
          </button>
        </div>
      );
    }

    export default HomeNerdlet
    ```

    <br />

    Ici, vous avez ajoutÃ© un bouton Ã  votre Nerdlet qui incrÃ©mente le compte de 1 Ã  chaque fois que vous cliquez dessus.
  </Step>

  <Step>
    AccÃ©dez Ã  votre navigateur qui exÃ©cute le Nerdlet pour voir vos modificationsÂ :

    <img title="Increment count with button click" alt="Increment count with button click" src="/images/react-hooks-screenshot-button-increment.webp" />

    Cliquez sur le bouton plusieurs fois pour augmenter le nombre.
  </Step>
</Steps>

## Utilisez le hook `useEffect()` dans votre Nerdlet

Votre Nerdlet dispose dÃ©sormais d&apos;un graphique Billboard et d&apos;un bouton. Le graphique montre le nombre de fois que vous avez cliquÃ© sur le bouton. Utilisez `useEffect()` pour incrÃ©menter automatiquement `count`.

<Steps>
  <Step>
    Dans *my-awesome-nerdpack/nerdlets/home/index.js*, crÃ©ez un effetÂ :

    ```jsx fileName=index.js
    import React, {useState, useEffect} from 'react';
    import { BillboardChart} from 'nr1'

    function HomeNerdlet () {
      const [count, setCount] = useState(0);

      useEffect(() => {
        setTimeout(() => {
          setCount(() => count + 1);
        }, 1000);
      });

      const clickCount = {
        metadata: {
            id: '1',
            name: 'Count',
            viz: 'main',
        },
        data: [
          { "y": count }
        ]
      }
      return (
        <div>
          <BillboardChart data={[clickCount]}/>
        </div>
      );
    }

    export default HomeNerdlet
    ```

    <br />

    `useEffect()` incrÃ©mente automatiquement la valeur `count` toutes les 1 seconde. Puisque vous avez automatisÃ© le comptage, vous avez Ã©galement supprimÃ© le bouton d&apos;incrÃ©mentation.
  </Step>

  <Step>
    AccÃ©dez Ã  votre navigateur pour voir les mises Ã  jourÂ :

    <img title="Auto increment with Effect Hook" alt="Auto increment with Effect Hook" src="/images/react-hooks-screenshot-auto-increment.webp" />
  </Step>
</Steps>

## RÃ©sumÃ©

Dans ce guide, vous avez appris Ã  :

* CrÃ©er un Nerdpack New Relic local
* Utilisez des crochets dans votre Nerdpack