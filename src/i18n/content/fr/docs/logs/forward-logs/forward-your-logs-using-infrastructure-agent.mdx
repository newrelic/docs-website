---
title: Transférez votre log à l'aide de l'agent infrastructure
tags:
  - Logs
  - Enable log management in New Relic
  - Enable log monitoring in New Relic
metaDescription: 'How to forward your logs to New Relic using our infrastructure agent, so you can use enhanced log management capabilities.'
freshnessValidatedDate: never
translationType: machine
---

La transmission de votre log à New Relic rend toutes vos données de logging disponibles en un seul emplacement, offrant une visibilité plus approfondie sur les données de performances de votre application et de votre plateforme. Avec votre log en un seul endroit, vous pouvez collecter, traiter, explorer, interroger et alerter sur les erreurs ou les anomalies détectées dans vos données log .

<img title="Logs in context for a host" alt="Screenshot of logs in context for a host" src="/images/logs_full_host_logs_ui.webp" />

<figcaption>
  Depuis l&apos;interface de votre hôte, vos logs sont placés dans le contexte de l&apos;événement pour la période sélectionnée. Vous pouvez accéder aux données détaillées pour n’importe lequel des attributs mis en surbrillance.
</figcaption>

La manière dont vous transférez votre log dépend de la manière dont vous avez installé l&apos;agent infrastructure , puisque l&apos;agent infrastructure active la fonctionnalité de transfert de log . Vous pouvez installer l&apos;agent d&apos;infrastructure via :

* installation guidée (recommandé pour la plupart des utilisateurs)
* Installation manuelle
* tarballLinux

<Callout variant="important">
  La version Linux de l&apos;agent d&apos;infrastructure, en particulier la version 1.42.0, est passée de l&apos;utilisation du package td-agent-bit au package fluent-bit. Ce changement a été rendu nécessaire par le fait que fluent-bit n&apos;est plus distribué dans la version td-agent-bit après la mise à jour majeure de la version 2.x.

  Pour garantir un fonctionnement fluide et offrir la possibilité de revenir à td-agent-bit en cas de problème avec le package fluent-bit, l&apos;agent infrastructure installe désormais les deux packages (td-agent-bit et fluent-bit). Par défaut, l&apos;agent est configuré pour utiliser fluent-bit.

  Consultez [Retour à Fluent Bit 1.9](#rollback-after-fluent-bit-2) pour plus d&apos;informations sur la procédure de restauration.
</Callout>

<Callout variant="tip">
  Vous avez beaucoup de logs ? Consultez notre [tutoriel pour savoir comment les optimiser et les gérer](/docs/tutorial-large-logs/get-started-managing-large-logs/).
</Callout>

## exigences système [#system]

* Agent d&apos;infrastructure version 1.11.4 ou supérieure
* [Fluent Bit](https://fluentbit.io/). L&apos;agent d&apos;infrastructure installe déjà la dernière version pour vous. Pour le mettre à jour ou le rétrograder vers une version spécifique, reportez-vous aux procédures [d&apos;installation de Fluent Bit](#install-fb-version) .
* Bibliothèque OpenSSL 1.1.0 ou supérieur
* Prise en charge intégrée de l&apos;architecture ARM64 sur le système Linux (par exemple, l&apos;architecture AWS Graviton ) ajoutée dans l&apos;agent infrastructure [1.20.6](https://github.com/newrelic/infrastructure-agent/releases/tag/1.20.6).
* Amazon Linux 2 et 2023
* CentOS version 8 et 9 Stream (Rocky Linux et AlmaLinux sont également pris en charge)
* RedHat versions 8 et 9
* Version Debian 11 (Bullseye) et 12 (Bookworm).
* SUSE Linux Enterprise Server (SLES) version 12 et 15 (ARM64 non pris en charge).
* Versions Ubuntu 16.04.x, 18.04.x, 20.04.x, 22.04.x, 24.04.x (versions LTS).
* Windows Server 2016, 2019 et 2022, ainsi que leurs Service Packs.
* Windows 10, Windows 11.

## Transférer automatiquement le log avec l&apos;installation guidée [#infra]

Lorsque vous utilisez notre guide d&apos;installation pour installer l&apos;agent infrastructure , la fonctionnalité de transfert de logest automatiquement configurée pendant le processus d&apos;installation.

Pour lancer votre installation, choisissez votre méthode de déploiement :

<TechTileGrid>
  <TechTile name="Amazon Linux" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_Amazon-linux.webp" alt="Amazon Linux" variant="TechTile"/>} />

  <TechTile name="Ansible" to="/docs/infrastructure/new-relic-infrastructure/config-management-tools/configure-new-relic-infrastructure-using-ansible" icon={<img src="/images/os_icon_ansible-red.webp" alt="Ansible" variant="TechTile"/>} />

  <TechTile name="CentOS" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_centos.webp" alt="CentOS" variant="TechTile"/>} />

  <TechTile name="Debian" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_debian.webp" alt="Debian" variant="TechTile"/>} />

  <TechTile name="RHEL" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_redhat.webp" alt="Red Hat" variant="TechTile"/>} />

  <TechTile name="SLES" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_suse.webp" alt="SLES" variant="TechTile"/>} />

  <TechTile name="Ubuntu" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_ubuntu.webp" alt="Ubuntu" variant="TechTile"/>} />

  <TechTile name="Windows" to="https://one.newrelic.com/marketplace?state=a792b092-300f-a5a4-ff62-510f4e0c52a5" icon={<img src="/images/infrastructure_logo_windows.webp" alt="Windows" variant="TechTile"/>} />
</TechTileGrid>

<Callout variant="important">
  Pour transférer le log d&apos;un conteneur Docker , utilisez cette [imageDocker ](https://hub.docker.com/r/newrelic/newrelic-fluentbit-output)comme image de base à utiliser avec l&apos;intégration du log Kubernetes , ou vous pouvez créer votre propre conteneur avec une configuration personnalisée pour différents environnements.
</Callout>

## Activer le transfert de logsur l&apos;agent installé manuellement [#manual]

Pour installer l&apos;agent infrastructure manuellement, suivez notre [tutoriel pour installer le gestionnaire de paquets](/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-agent-linux-using-package-manager), ou consultez notre [programme d&apos;installation MSI](/docs/infrastructure/install-configure-manage-infrastructure/windows-installation/install-infrastructure-windows-server-using-msi-installer) (Windows).

### Étape 1. Configurer l’agent d’infrastructure

les fichiers de configuration dirigent votre système pour transmettre les sources log que vous souhaitez voir apparaître dans New Relic. Vous pouvez ajouter autant de fichiers de configuration que vous le souhaitez. Notre agent d&apos;infrastructure utilise des fichiers `.yml` pour configurer le logging. Si vous installez l&apos;agent infrastructure via [l&apos;intégration et les agents](https://one.newrelic.com/marketplace?state=78678a7f-91c5-ca40-ac55-e6b74a50085c) dans l&apos;interface utilisateur, le fichier `logging.yml` est créé automatiquement.

Pour ajouter un nouveau fichier configuration pour la fonctionnalité de transfert de log :

1. Accédez au dossier du redirecteur de log configuration:

   * Linux: `/etc/newrelic-infra/logging.d/`
   * Windows: `C:\Program Files\New Relic\newrelic-infra\logging.d\`

2. Créez un fichier de configuration `logging.yml` et ajoutez les paramètres dont vous avez besoin. Le répertoire `logging.d` contient divers fichiers `.yml.example` que vous pouvez utiliser comme référence ou point de départ. Pour des exemples Windows , consultez [notre référentiel Github (dépôt)](https://github.com/newrelic/infrastructure-agent/tree/master/assets/examples/logging/windows).

   ```yml
   # Log forwarder configuration file example
   # Source: file
   # Available customization parameters: attributes, max_line_kb, pattern
   logs:
     # Basic tailing of a single file
     - name: basic-file
       file: /var/log/logFile.log

     # File with spaces in its path. No need to use quotes.
     - name: file-with-spaces-in-path
       file: /var/log/folder with spaces/logFile.log

     # Specify a list of custom attributes, as key-value pairs, to be included
     # in each log record
     - name: file-with-attributes
       file: /var/log/logFile.log
       attributes:
         application: tomcat
         department: sales
         maintainer: example@mailprovider.com

     # Use wildcards to refer to multiple files having a common extension or
     # prefix. Newly generated files will be automatically detected every 60
     # seconds.
     #
     # WARNING: avoid using wildcards that include the file extension, since
     # it'll cause logs to be forwarded repeatedly if log rotation is enabled.
     - name: log-files-in-folder
       file: /var/log/logF*.log

     # Lines longer than 128 KB will be automatically skipped. Use 'max_line_kb'
     # to increase this limit.
     - name: log-file-with-long-lines
       file: /var/log/logFile.log
       max_line_kb: 256

     # Use 'pattern' to filter records using a regular expression
     - name: only-records-with-warn-and-error
       file: /var/log/logFile.log
       pattern: WARN|ERROR
   ```

L&apos;agent traite automatiquement les nouveaux fichiers configuration sans avoir à redémarrer le service de monitoring d&apos;infrastructure . La seule exception à cette règle concerne la configuration d’une configuration Fluent Bit personnalisée.

### Étape 2. Définir les paramètres de transfert de log [#parameters]

Vous devez configurer un `name` et un paramètre de source log dans le fichier de configuration de transfert de log `.yml`. Pour commencer, définissez un `name` du log ou du log que vous souhaitez transmettre à New Relic.

Ce que vous utilisez comme source log dépend de l&apos;emplacement d&apos;où provient votre log. Les options disponibles pour la source log incluent :

<CollapserGroup>
  <Collapser id="file" title="fichier">
    Chemin vers le fichier de log ou les fichiers. L&apos;agent suit les modifications sur le fichier de log d&apos;une manière similaire au shell `tail -f`.

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: example-log
        file: /var/log/example.log     # Path to a single log file
      - name: example-log-two
        file: /var/log/example-two.log # Path to another single log file
    ```

    Le paramètre `file` peut pointer vers un fichier log spécifique ou vers plusieurs fichiers en utilisant des caractères génériques appliqués aux noms et aux extensions ; par exemple, `/logs/*.log`. Vous pouvez utiliser des caractères génériques à la place des répertoires dans un chemin de fichier, ce qui peut être utilisé pour suivre des fichiers situés dans différents répertoires.

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: docker-logs
        file: /var/lib/docker/containers/*/*.log # Path to multiple folders and files
    ```

    <Callout variant="important">
      L&apos;utilisation de caractères génériques peut augmenter considérablement le nombre de descripteurs de fichiers et de surveillances inotify que le processus Fluent Bit maintient ouverts, ce qui peut interférer avec la collecte log si la limite de descripteur de fichier de l&apos;hôte est atteinte. Le suivi d&apos;un grand nombre de fichiers peut nécessiter d&apos;augmenter le nombre maximum de descripteurs de fichiers et d&apos;ignorer les observateurs autorisés par le système d&apos;exploitation. Veuillez vous référer aux [Erreurs lors du suivi d&apos;une grande quantité de fichier log](#too-many-files) pour plus de détails sur la façon de les augmenter.
    </Callout>
  </Collapser>

  <Collapser id="systemd" title="systemd">
    Utilisez le paramètre `systemd` pour transférer les messages de log collectés par le daemon `journald` dans les environnements Linux. Ce type d&apos;entrée nécessite que l&apos;agent s&apos;exécute en [mode racine](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes).

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: systemd-example
        systemd: cupsd
    ```
  </Collapser>

  <Collapser id="syslog" title="syslog">
    Source de données Syslog.

    <DNT>
      **Parameters:**
    </DNT>

    * `uri:` Prise Syslog. Le format varie selon le protocole :

      * Sockets réseau TCP/UDP : `[tcp/udp]://LISTEN_ADDRESS:PORT`
      * Sockets de domaine Unix : `unix_[tcp/udp]:// + /socket/path`

    * `parser:` Analyseur Syslog. La valeur par défaut est `rfc3164`. Utilisez `rfc5424` si vos messages incluent des secondes fractionnaires. Remarque : `rfc3164` ne fonctionne actuellement pas sur SuSE.

    * `unix_permissions:` La valeur par défaut est `0644` pour les sockets de domaine. Cela limite les entrées aux processus exécutés en tant que root. Vous pouvez utiliser `0666` pour écouter les processus non root (à vos risques et périls).

      Lors de l&apos;exécution de l&apos;agent en [mode privilégié](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes), les ports et les sockets doivent être disponibles ou détenus par `nri-agent` et avec des autorisations de fichier `0666` afin que d&apos;autres processus puissent écrire le log sur les sockets.

      ```yml
      logs:
        # TCP network socket
        - name: syslog-tcp-test
          syslog:
            uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
            parser: rfc5424 # Default syslog parser is rfc3164

        # UDP network socket
        - name: syslog-udp-test
          syslog:
            uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
          max_line_kb: 35

        # Unix TCP domain socket
        - name: syslog-unix-tcp-test
          syslog:
            uri: unix_tcp:///var/unix-tcp-socket-test
            unix_permissions: 0666 # Default is 0644. Change at your own risk

        # Unix UDP domain socket
        - name: syslog-unix-udp-test
          syslog:
            uri: unix_udp:///var/unix-udp-socket-test
            parser: rfc5424
      ```
  </Collapser>

  <Collapser id="tcp" title="tcp">
    Logs récupérés via des connexions TCP.

    <DNT>
      **Parameters:**
    </DNT>

    * `uri:` Socket TCP/IP pour écouter les données entrantes. Le format de l&apos;URI est `tcp://LISTEN_ADDRESS:PORT`.

    * `format:` Format des données. Cela peut être `json` ou `none`.

    * `separator:` Si `format: none` est utilisé, vous pouvez définir une chaîne de séparation pour diviser les enregistrements (par défaut : `\n`).

      ```yml
      logs:
        - name: tcp-simple-test
          tcp:
            uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: none            # Raw text - this is default for 'tcp'
            separator: \t           # String for separating raw text entries
          max_line_kb: 32
        - name: tcp-json-test
          tcp:
            uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: json
      ```
  </Collapser>

  <Collapser id="winevtlog" title="winevtlog">
    <Callout variant="important">
      Disponible depuis l&apos;agent d&apos;infrastructure v.1.24.3 Compatible uniquement avec Windows Server 2019 et versions ultérieures. Utilisez plutôt [`winlog`](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/#winlog) pour les versions antérieures.
    </Callout>

    Collectez les événements à partir des Windows log canaux à Windows l&apos;aide de la nouvelle API de Log des événements à l&apos;aide [winevtlog Fluent Bit du plugin .](https://docs.fluentbit.io/manual/pipeline/inputs/windows-event-log-winevtlog)

    <DNT>
      **Parameters:**
    </DNT>

    * `channel`: Le nom du log de canal sera collecté.

    * `collect-eventids`:Liste des identifiants d&apos;événements Windows à collecter et à transmettre à New Relic. Les plages d’ID d’événement sont prises en charge.

    * `exclude-eventids`:Liste des ID d&apos;événements Windows à exclure de la collection. Les plages d’ID d’événement sont prises en charge.

    * `use-ansi`:Utilisez le codage ANSI sur `winlog` messages. Nous utilisons le codage ANSI par défaut sur Windows Server 2016 et les versions antérieures, et UTF-8 sur les versions plus récentes. Vous pouvez remplacer ce comportement avec ce paramètre de configuration si ces valeurs par défaut ne conviennent pas à votre cas d&apos;utilisation. Cela résout le problème du log des codes de caractères ANSI qui sont des chaînes vides. Ce n&apos;est pas une fonction permettant de convertir un code de caractères multi-octets en code de caractères ANSI en UTF-8.

      Tous les événements sont collectés à partir du canal spécifié par défaut. Configurez les sections `collect-eventids` et `exclude-eventids` pour éviter d&apos;envoyer des logs indésirables à votre compte New Relic.

      Ajoutez des identifiants ou des plages d&apos;événements à `collect-eventids` ou `exclude-eventids` pour transférer ou supprimer un événement spécifique. `exclude-eventids` a priorité sur `collect-eventids` si le même ID d&apos;événement est présent dans les deux sections.

      <DNT>
        **Example:**
      </DNT>

      ```yml
      logs:
        # Example winevtlog security log ingestion with eventId filters.
        - name: windows-security
          winevtlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735
          attributes:
            logtype: windows_security

        # Example entries for the application and system channels
        - name: windows-application
          winevtlog:
            channel: Application
            attributes:
              logtype: windows_application

        # Example entries for the application use-ansi
        - name: windows-application
          winevtlog:
            channel: Application
            attributes:
              logtype: windows_application
            use-ansi: true

        - name: windows-system
          winevtlog:
            channel: System
            attributes:
              logtype: windows_system

        # Example/Optional entry for Windows Defender Logs
        - name: windows-defender
          winevtlog:
            channel: Microsoft-Windows-Windows Defender/Operational

        # Example/Optional entry for Windows Clustering Logs
        - name: windows-clustering
          winevtlog:
            channel: Microsoft-Windows-FailoverClustering/Operational
      ```
  </Collapser>

  <Collapser id="winlog" title="winlog">
    <Callout variant="important">
      `Winlog` ne peut collecter que le log des événements classiques. Tenter de capturer d&apos;autres personnes collectera silencieusement le log d&apos;application.
    </Callout>

    Collectez les événements à partir des Windows log canaux .

    <DNT>
      **Parameters:**
    </DNT>

    * `channel`: Le nom du log de canal sera collecté. Cela ne fonctionne pas pour les chaînes personnalisées.

    * `collect-eventids`:Liste des identifiants d&apos;événements Windows à collecter et à transmettre à New Relic. Les plages d’ID d’événement sont prises en charge.

    * `exclude-eventids`:Liste des ID d&apos;événements Windows à exclure de la collection. Les plages d’ID d’événement sont prises en charge.

    * `use-ansi`:Utilisez le codage ANSI sur `winlog` messages. Nous utilisons le codage ANSI par défaut sur Windows Server 2016 et les versions antérieures, et UTF-8 sur les versions plus récentes. Vous pouvez remplacer ce comportement avec ce paramètre de configuration si ces valeurs par défaut ne conviennent pas à votre cas d&apos;utilisation. Cela résout le problème du log des codes de caractères ANSI qui sont des chaînes vides. Ce n&apos;est pas une fonction permettant de convertir un code de caractères multi-octets en code de caractères ANSI en UTF-8.

      Tous les événements sont collectés à partir du canal spécifié par défaut. Configurez les sections `collect-eventids` et `exclude-eventids` pour éviter d&apos;envoyer des logs indésirables à votre compte New Relic.

      Ajoutez des identifiants ou des plages d&apos;événements à `collect-eventids` ou `exclude-eventids` pour transférer ou supprimer un événement spécifique. `exclude-eventids` a priorité sur `collect-eventids` si le même ID d&apos;événement est présent dans les deux sections.

      <DNT>
        **Example:**
      </DNT>

      ```yml
      logs:
        # Example winlog security log ingestion with eventId filters.
        - name: windows-security
          winlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735
          attributes:
            logtype: windows_security

        # Example entries for the application and system channels
        - name: windows-application
          winlog:
            channel: Application
            attributes:
              logtype: windows_application
        - name: windows-system
          winlog:
            channel: System
            attributes:
              logtype: windows_system

        # Example entries for the application use-ansi
        - name: windows-application
          winlog:
            channel: Application
            attributes:
              logtype: windows_application
            use-ansi: true

        # Example/Optional entry for Windows Defender Logs
        - name: windows-defender
          winlog:
            channel: Microsoft-Windows-Windows Defender/Operational

        # Example/Optional entry for Windows Clustering Logs
        - name: windows-clustering
          winlog:
            channel: Microsoft-Windows-FailoverClustering/Operational
      ```
  </Collapser>
</CollapserGroup>

### Étape 3. Définir l’attribut clé [#optional-config]

Bien que ces paramètres configuration ne soient pas obligatoires, nous vous recommandons tout de même d&apos;appliquer ces configurations à votre fichier `logging.yml` afin de tirer le meilleur parti du transfert de log .

<CollapserGroup>
  <Collapser id="attributes" title="attributes">
    Liste d&apos;attributs personnalisés spécifiés comme paires valeur-clé qui peuvent être utilisés pour envoyer des données supplémentaires avec le log que vous pouvez ensuite interroger. Le paramètre configuration `attributes` peut être utilisé avec n&apos;importe quelle source log .

    <Callout variant="important">
      Le `attributes` configuration paramètre n&apos;ajoute pas d&apos;attribut personnalisé au log transmis via externe Fluent Bit configuration (par exemple, à l&apos;aide du `fluentbit` configuration paramètre). Dans ce scénario, vous devez vous référer à l&apos;option `record_modifier` dans la [documentation Fluent Bit](https://docs.fluentbit.io/manual/).
    </Callout>

    Une utilisation courante du paramètre de configuration `attributes` consiste à spécifier l’attribut `logtype` . Cet attribut permet d&apos;exploiter l&apos;une des [règles d&apos;analyse intégrées](/docs/logs/log-management/ui-data/parsing/#built-in-rules) prises en charge par les fonctionnalités <InlinePopover type="logs" />de New Relic.

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: example-file-attributes
        file: /var/log/example.log
        attributes:
          logtype: nginx
          region: example-us-02
          team: A-team
      - name: example-tcp-attributes
        tcp:
          uri: tcp://0.0.0.0:2345
          format: json
        attributes:
          logtype: nginx
          region: example-us-02
          team: B-team
    ```
  </Collapser>

  <Collapser id="automatically-inserted-attributess" title="attribut inséré automatiquement par l'agent infrastructure">
    L&apos;agent infrastructure insère automatiquement l&apos;attribut log pour votre commodité. Certains d&apos;entre eux sont insérés pour n&apos;importe quel enregistrement log , tandis que d&apos;autres dépendent des paramètres configuration que vous avez utilisés lors de la configuration du redirecteur de log .

    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            Nom de l&apos;attribut
          </th>

          <th>
            Description
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `entity.guids`
          </td>

          <td>
            Toujours inséré.

            L&apos;agent d&apos;infrastructure insère le [GUID d&apos;entité](/attribute-dictionary/?event=Span&attribute=entityGuid) attribué par New Relic pour identifier l&apos;hôte sur lequel il s&apos;exécute. Il est disponible dans le champ `entity.guids` .

            Remarque : si le log capturé appartient à une application instrumentée utilisant APM, le champ `entity.guids` contient à la fois le GUID entité de infrastructure, ainsi que le GUID d&apos;APM, séparés par un délimiteur de barre verticale ( | ).
          </td>
        </tr>

        <tr>
          <td>
            `fb.input`
          </td>

          <td>
            Toujours inséré.

            Le [type de plug-in d’entréeFluent Bit ](https://docs.fluentbit.io/manual/pipeline/inputs)sous-jacent utilisé pour capturer le log. Actuellement, ses valeurs sont `tail`, `systemd`, `winlog`, `syslog` et `tcp`.
          </td>
        </tr>

        <tr>
          <td>
            `filePath`
          </td>

          <td>
            Inséré lors de l&apos;utilisation du type d&apos;entrée `file` .

            Chemin absolu du fichier monitoré.
          </td>
        </tr>

        <tr>
          <td>
            `hostname`
          </td>

          <td>
            Toujours inséré.

            Le nom d’hôte de la machine/VM/conteneur exécutant l’agent d’infrastructure.
          </td>
        </tr>

        <tr>
          <td>
            `plugin.type`
          </td>

          <td>
            Toujours inséré.

            Indique l&apos;utilitaire utilisé pour capturer le log. Dans ce cas, il s’agit de l’agent d’infrastructure lui-même, donc cet attribut a toujours la valeur `nri-agent`.
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="pattern" title="modèle">
    expressions régulières pour filtrer les enregistrements. Uniquement pris en charge pour les sources `file`, `systemd`, `syslog` et `tcp` (uniquement avec le format `none`).

    Ce champ fonctionne de manière similaire à `grep -E` dans le système Unix. Par exemple, pour un fichier donné en cours de capture, vous pouvez filtrer les enregistrements contenant soit `WARN` soit `ERROR` en utilisant :

    ```yml
    - name: only-records-with-warn-and-error
      file: /var/log/logFile.log
      pattern: WARN|ERROR
    ```

    Aucun filtrage n&apos;est appliqué par défaut.
  </Collapser>

  <Collapser id="max_line_kb" title="max_line_kb">
    Taille maximale des entrées/lignes log en Ko. Si les entrées log dépassent la limite, elles sont ignorées. La valeur par défaut est `128`, la valeur minimale autorisée est `33`.
  </Collapser>

  <Collapser id="fluentbit" title="fluentbit">
    Fichiers de configuration et d&apos;analyse externes [Fluent Bit](https://fluentbit.io/) . S&apos;ils sont définis, ils sont fusionnés avec les fichiers de configuration et d&apos;analyse existants générés par l&apos;agent d&apos;infrastructure.

    infrastructure L&apos;agent traite les configuration fichiers situés dans le `logging.d` répertoire et génère un fichier de temps d&apos;exécution Fluent Bit configuration contenant les `[INPUT]` `[FILTER]` `[OUTPUT]` sections, et appropriées. En option, il déclarera également un `@INCLUDE` au cas où vous auriez fourni un fichier de configuration Fluent Bit externe via l&apos;option `fluentbit` .

    Le fichier d&apos;exécution ne définit pas de [section`[SERVICE]` ](https://docs.fluentbit.io/manual/administration/configuring-fluent-bit/classic-mode/configuration-file), laissant toutes les valeurs de configuration Fluent Bit par défaut. Vous pouvez toujours remplacer les paramètres par défaut de Fluent Bit en définissant votre propre section `[SERVICE]` dans votre fichier de configuration Fluent Bit externe et en l&apos;incluant via l&apos;option `fluentbit` .

    <DNT>
      **Parameters:**
    </DNT>

    `config_file:` chemin vers un fichier de configuration Fluent Bit existant. Notez que toute source qui se chevauche entraîne des messages en double dans notre interface utilisateur de log.

    `parsers_file:` chemin vers un fichier d&apos;analyse Fluent Bit existant. Les noms d&apos;analyseurs suivants sont réservés : `rfc3164`, `rfc3164-local` et `rfc5424`.

    <Callout variant="important">
      L&apos;agent infrastructure permet de transférer les logs pour les cas d&apos;utilisation les plus courants en définissant une configuration simple de transfert de logdans les fichiers YAML du répertoire `logging.d/`, comme décrit dans ce document. Ces fichiers sont traduits en interne en fichiers de configuration Fluent Bit avec le format correct et des valeurs de configuration par défaut saines. New Relic fournit un support officiel pour ces options de configuration puisque nous garantissons que les fichiers de configuration générés sont corrects et opérationnels.

      Néanmoins, pour les cas d&apos;utilisation non couverts par nos options de configuration prises en charge, nous offrons la possibilité d&apos;utiliser un fichier de configuration et d&apos;analyse Fluent Bit généré en externe à l&apos;aide des options `fluentbit`, `config_file` et `parsers_file` .

      Remarque : nous ne pouvons pas garantir le bon fonctionnement du log transmis dans ce cas, étant donné que la configuration fournie est complètement arbitraire et n&apos;est pas générée/validée par l&apos;agent. Par conséquent, New Relic ne fournit pas de support officiel pour la configuration externe spécifiée via ces options.
    </Callout>
  </Collapser>
</CollapserGroup>

### Exemple de fichier de configuration [#running-modes]

Voici un exemple de fichier de configuration `logging.d` au format YAML. Pour plus d’exemples de configuration, [consultez le référentiel de l’agent d’infrastructure](https://github.com/newrelic/infrastructure-agent/tree/master/assets/examples/logging).

<CollapserGroup>
  <Collapser id="configuration-file" title="logging.d/sample.yaml">
    ```yml
    # Remember to only use spaces for indentation

    logs:
      # Example of 'file' source
      - name: file-with-attributes
        file: /var/log/test.log # Path to a single file or pattern
        attributes:             # You can use custom attributes to enrich your data
          logtype: nginx
          team: The A Team
        pattern: Error          # Regular expression to filter log entries

      # Example of 'systemd' source (Linux only)
      - name: systemd-example
        systemd: cupsd

      # Examples of 'syslog' source, one per protocol
      # TCP network socket
      - name: syslog-tcp-test
        syslog:
          uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
          parser: rfc5424         # Default syslog parser is rfc3164

      # UDP network socket
      - name: syslog-udp-test
        syslog:
          uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
        max_line_kb: 35

      # Paths for Unix sockets are defined by combining protocol and path:
      # unix_udp:// + /path/socket - for example, unix_udp:///tmp/socket
      # Unix TCP domain socket
      - name: syslog-unix-tcp-test
        syslog:
          uri: unix_tcp:///var/unix-tcp-socket-test
          unix_permissions: 0666 # Default is 0644. Change at your own risk

      # Unix UDP domain socket
      - name: syslog-unix-udp-test
        syslog:
          uri: unix_udp:///var/unix-udp-socket-test
          parser: rfc5424

      # Examples of 'tcp' source for formats 'none' and 'json'
      - name: tcp-simple-test
        tcp:
          uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: none            # Raw text - this is default for 'tcp'
          separator: \t           # String for separating raw text entries
        attributes:               # You can add custom attributes to any source of logs
          tcpFormat: none
          someOtherAttribute: associatedValue
        max_line_kb: 32
      - name: tcp-json-test
        tcp:
          uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: json
        attributes:
          tcpFormat: json
          yetAnotherAttribute: 12345

      # Example of Fluent Bit configuration import
      - name: fluentbit-import
        fluentbit:
          config_file: /path/to/fluentbit.config
          parsers_file: /path/to/fluentbit/parsers.conf
    ```
  </Collapser>
</CollapserGroup>

### Étape 4. Affichez vos données log [#find-data]

Si tout est configuré correctement et que vos données sont collectées, vous devriez voir le log et les données télémétriques associées à ces endroits :

* Notre [UI de logs](https://one.newrelic.com/launcher/logger.log-launcher)
* Dans l&apos;interface utilisateur infrastructure , à partir de la table des hôtes, cliquez sur l&apos;icône <Icon name="fe-more-horizontal" /> icône pour un hôte spécifique, puis cliquez sur <DNT>**View logs**</DNT>.
* Nos outils pour exécuter [des requêtes NRQL ](/docs/chart-builder/use-chart-builder/choose-data/use-advanced-nrql-mode-specify-data). Par exemple, vous pouvez exécuter une requête comme celle-ci :

```sql
SELECT * FROM Log
```

## Activer le logging pour votre intégration sur hôte [#on-host]

Avec l&apos;agent infrastructure installé, vous pouvez activer l&apos;analyse automatique des loget leur transfert pour notre intégration sur hôte la plus populaire en une seule étape. Pour activer cette fonctionnalité, renommez le fichier `on-host-log.yml.example` en `on-host-log.yml`. Une fois terminé, le log de votre intégration est automatiquement analysé et envoyé à New Relic.

Cette option est disponible pour notre [plateforme Linux prise en charge](#requirements).

Pour activer la fonctionnalité d&apos;intégration sur hôte transfert de log :

<CollapserGroup>
  <Collapser id="elastic-search-logs" title="Log Elasticsearch">
    Copiez ou renommez le `elasticsearch-log.yml.example` fichier en `elasticsearch-log.yml` pour activer Elasticsearch l&apos;analyse automatique des au format JSON loget leur transmission vers New Relic. Pas besoin de redémarrer l&apos;agent.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/elasticsearch-log.yml.example /etc/newrelic-infra/logging.d/elasticsearch-log.yml
    ```
  </Collapser>

  <Collapser id="mysql-logs" title="Log MySQL">
    Copiez ou renommez le `mysql-log.yml.example` fichier en pour `mysql-log.yml` MySQL logactiver l&apos;analyse automatique des et la transmission à New Relic. Pas besoin de redémarrer l&apos;agent.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/mysql-log.yml.example /etc/newrelic-infra/logging.d/mysql-log.yml
    ```
  </Collapser>

  <Collapser id="nginx-logs" title="Log NGINX">
    Copiez ou renommez le fichier `nginx-log.yml.example` en `nginx-log.yml` pour activer l&apos;accès automatique à NGINX et l&apos;analyse des erreurs des loget leur transmission à New Relic. Pas besoin de redémarrer l&apos;agent.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/nginx-log.yml.example /etc/newrelic-infra/logging.d/nginx-log.yml
    ```
  </Collapser>

  <Collapser id="rabbitmq-logs" title="Log de Rabbitmq">
    Copiez ou renommez le fichier `rabbitmq-log.yml.example` en `rabbitmq-log.yml` pour activer l&apos;analyse automatique des erreurs Rabbitmq et la logà New Relic. Pas besoin de redémarrer l&apos;agent.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/rabbitmq-log.yml.example /etc/newrelic-infra/logging.d/rabbitmq-log.yml
    ```
  </Collapser>

  <Collapser id="redis-logs" title="Log Redis">
    Copiez ou renommez le fichier `redis-log.yml.example` en `redis-log.yml` pour activer l&apos;analyse automatique des erreurs Redis et logtransmission à New Relic. Pas besoin de redémarrer l&apos;agent.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/redis-log.yml.example /etc/newrelic-infra/logging.d/redis-log.yml
    ```
  </Collapser>
</CollapserGroup>

## Activer le transfert de logsur l&apos;agent installé à l&apos;aide tarballLinux [#tarball-install]

Notre processus d&apos;installation Linux personnalisé pour monitoring d&apos;infrastructure vous permet de personnaliser tous les aspects du processus d&apos;installation et de placer des fichiers et des dossiers sur votre machine. Si vous choisissez le [processus d&apos;installation assisté](/docs/infrastructure/install-infrastructure-agent/linux-installation/tarball-assisted-install-infrastructure-agent-linux) ou [manuel](/docs/infrastructure/install-infrastructure-agent/linux-installation/tarball-manual-install-infrastructure-agent-linux) tarball , suivez ces étapes pour implémenter la fonctionnalité de redirecteur logde :

1. Créez les répertoires suivants :

   * `/var/db/newrelic-infra/newrelic-integrations/logging`
   * `/etc/newrelic-infra/logging.d`

2. Téléchargez et installez [le package fluent-bit (RPM)](https://github.com/newrelic/fluent-bit-package/releases) de New Relic en exécutant une commande similaire à :

   ```shell
   yum localinstall fluent-bit-<some-version>.rpm
   ```

3. Téléchargez [le plugin fluentbit](https://github.com/newrelic/newrelic-fluent-bit-output/releases) de New Relic et enregistrez-le sous `/var/db/newrelic-infra/newrelic-integrations/logging/out_newrelic.so`.

4. Téléchargez ou copiez le fichier `parsers.conf` depuis [ce référentiel Github](https://github.com/newrelic/fluent-bit-package/blob/main/parsers.conf) et enregistrez-le sous `/var/db/newrelic-infra/newrelic-integrations/logging/parsers.conf`.

<InstallFeedback />

## Dépannage [#troubleshoot]

Si vous rencontrez des problèmes avec la configuration de votre redirecteur de log , essayez ces conseils de dépannage.

<CollapserGroup>
  <Collapser className="freq-link" id="log-data" title="Aucune donnée log">
    Si aucune donnée n&apos;apparaît après avoir activé nos fonctionnalités de gestion des log , suivez nos [procédures standard de dépannage log ](/docs/logs/log-management/troubleshooting/no-log-data-appears-ui/).
  </Collapser>

  <Collapser className="freq-link" id="no-data" title="Aucune donnée n'apparaît lors du suivi d'un fichier">
    La fonctionnalité de transfert de lognécessite que l&apos;agent ait l&apos;autorisation de lire les sources de données. Lorsque vous exécutez l&apos;agent infrastructure en [mode privilégié ou non privilégié](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes), assurez-vous que le fichier de log que vous souhaitez transférer (et tout répertoire intermédiaire sur son chemin) est lisible par l&apos;utilisateur exécutant `nri-agent`.

    <DNT>
      **Example: Check file access under Linux**
    </DNT>

    Vérifions si le fichier `/var/log/restrictedLogs/logFile.log` peut être monitoré par l&apos;utilisateur `nri-agent` . Sous Linux, vous pouvez effectuer une vérification rapide avec la commande `namei` :

    ```bash
    sudo -u nri-agent namei -ml /var/log/restrictedLogs/logFile.log
    [output] f: /var/log/restrictedLogs/logFile.log
    [output] drwxr-xr-x root root /
    [output] drwxr-xr-x root root var
    [output] drwxrwxr-x root syslog log
    [output] drwxr--r-- root root restrictedLogs
    [output] logFile.log - No such file or directory
    ```

    Cette commande a échoué car le fichier n&apos;est pas visible pour l&apos;utilisateur `nri-agent` . En inspectant la sortie précédente, nous pouvons détecter que le répertoire `restrictedLogs` ne possède pas l&apos;indicateur d&apos;exécution pour `others`.

    Pour résoudre ce problème, exécutez :

    ```bash
    sudo chmod 755 /var/log/restrictedLogs
    ```

    Et puis vérifiez à nouveau l&apos;accès au fichier :

    ```bash
    sudo -u nri-agent namei -ml /var/log/restrictedLogs/logFile.log
    [output] f: /var/log/restrictedLogs/logFile.log
    [output] drwxr-xr-x root root /
    [output] drwxr-xr-x root root var
    [output] drwxrwxr-x root syslog log
    [output] drwxr-xr-x root root restrictedLogs
    [output] -rw-r----- vagrant vagrant logFile.log
    ```

    Le fichier est désormais visible pour l&apos;utilisateur `nri-agent` . Vous devez vous assurer que le fichier est également lisible par l&apos;utilisateur `nri-agent` . Pour vérifier cela, utilisez :

    ```bash
    sudo -u nri-agent head /var/log/restrictedLogs/logFile.log
    [output] head: cannot open '/var/log/restrictedLogs/logFile.log' for reading: Permission denied
    ```

    Dans cet exemple, le fichier ne dispose pas des droits de lecture pour le groupe `others` (utilisateur autre que `vagrant` et le groupe utilisateur `vagrant` ). Vous pouvez résoudre ce problème en accordant des autorisations de lecture à `others`, mais l&apos;application pourrait modifier ces autorisations au redémarrage.

    Pour éviter cela, une meilleure approche consiste à ajouter l’utilisateur `nri-agent` au groupe d’utilisateurs `vagrant` .
  </Collapser>

  <Collapser className="freq-link" id="syslog" title="Aucune donnée n'apparaît lors de la capture via un socket Syslog">
    La fonctionnalité de transfert de lognécessite que l&apos;agent ait l&apos;autorisation de lire les sources de données. Lors de l&apos;exécution de l&apos;agent d&apos;infrastructure en [mode privilégié ou non privilégié](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes):

    * Si vous utilisez des fichiers de socket de domaine Unix, assurez-vous que l&apos;utilisateur `nri-agent` peut accéder à ces fichiers (veuillez vous référer à la section précédente) et qu&apos;il dispose des autorisations de lecture et d&apos;écriture (`666`) afin que d&apos;autres utilisateurs que `nri-agent` puissent y écrire.

    * Si vous utilisez des sockets IP, assurez-vous que le port que vous utilisez n&apos;est pas un port réservé au système (comme le port `80`, par exemple).

      Si aucune donnée n&apos;apparaît après avoir activé la gestion des log , suivez [les procédures de dépannage standard de la gestion des log](/docs/logs/new-relic-logs/troubleshooting/no-data-appears-logs).
  </Collapser>

  <Collapser className="freq-link" id="proxy" title="Aucune donnée n'apparaît à l'aide du proxy de l'agent d'infrastructure">
    Comme expliqué dans les [directivesinfrastructure de configuration ](/docs/infrastructure/install-infrastructure-agent/configuration/infrastructure-agent-configuration-settings#proxy)l&apos;agent , le `proxy` paramètre doit utiliser HTTP ou HTTPS et être sous la forme.`https://user:password@hostname:port` L&apos;agent peut analyser le paramètre sans HTTP ou HTTPS, mais le redirecteur de logne le peut pas. Vous verrez une erreur comme celle-ci dans le log détaillé de l&apos;agent :

    ```
    [ERROR] building HTTP transport: parse \"hostname:port\":
    first path segment in URL cannot contain colon
    ```

    Pour résoudre ce problème, vérifiez votre fichier `newrelic-infra.yml` et assurez-vous que le paramètre `proxy` adhère à ce formulaire.

    Si vous utilisez `caBundleFile` ou `caBundleDir` pour spécifier un certificat, nous vous recommandons de suivre les règles ci-dessous pour chaque système d&apos;exploitation :

    <DNT>
      **Linux**
    </DNT>

    Pour les proxys `HTTP` vous n&apos;avez pas besoin de configurer de certificats. Le plugin charge les certificats système et New Relic envoie le log au point de terminaison de logging. Cependant, vous pouvez spécifier le certificat auto-signé proxy (fichier PEM) à l&apos;aide des paramètres `caBundleFile` ou `caBundleDir` .

    <DNT>
      **Windows**
    </DNT>

    * Pour les proxys `HTTP` vous n&apos;avez pas besoin de configurer de certificats. Le plugin charge les certificats système.

    * Pour `HTTPS`, vous pouvez le configurer de l&apos;une des manières suivantes :

      * (Recommandé) Importez le certificat proxy dans le pool système. Importez le certificat auto-signé proxy (fichier PEM) à l&apos;aide de l&apos;outil MMC. Reportez-vous à [ce lien](https://www.ssls.com/knowledgebase/how-to-import-intermediate-and-root-certificates-via-mmc/) et dans <DNT>**Step 2**</DNT> assurez-vous de l&apos;importer dans votre `Trusted Root Certification Authorities` plutôt que dans le `Intermediate Certification Authorities`.

      * Utiliser les paramètres `caBundleFile` et `caBundleDir` Sous Windows, nous ne pouvons pas charger à la fois les certificats du pool de certificats système et ceux spécifiés avec les paramètres `caBundleFile` `caBundleDir` . Ainsi, si vous utilisez `caBundleFile` ou `caBundleDir`, assurez-vous que les certificats suivants sont placés dans le même fichier PEM (lorsque vous utilisez `caBundleFile`) ou dans le même répertoire (lorsque vous utilisez `caBundleDir`) :

    * Le certificat proxy (car c&apos;est un proxy `HTTPS` ).

    * Le certificat du point de terminaison de logging (par exemple. `https://log-api.newrelic.com/log/v1`).

    * Le certificat de l&apos;agent d&apos;infrastructure (par exemple. `https://infra-api.newrelic.com`).

      Vous pouvez vérifier les certificats en exécutant :

      ```bash
      openssl s_client -connect log-api.newrelic.com:443 -servername log-api.newrelic.com
      ```
  </Collapser>

  <Collapser className="freq-link" id="agent-logs" title="Envoi du log de l'agent infrastructure à New Relic">
    Vous pouvez configurer l&apos;agent infrastructure pour envoyer son propre log à New Relic. Ceci est utile pour les problèmes de dépannage avec le transfert de log , l&apos;agent ou lors de la prise de contact avec [le support](https://support.newrelic.com/).

    <Callout variant="important">
      Le logging des traces génère beaucoup de données très rapidement. Pour réduire la consommation d&apos;espace disque et l&apos;ingestion de données, une fois la génération du log terminée, assurez-vous de définir `level: info` (ou moins).
    </Callout>

    Pour transférer le log de l&apos;agent infrastructure vers New Relic :

    1. Modifiez votre fichier `newrelic-infra.yml` .

    2. Activez le transfert des logs vers New Relic en ajoutant le snippet de configuration suivant :

       ```yml
       log:
         level: trace  # Recommended: Helps with troubleshooting
         forward: true # Enables sending logs to New Relic
         format: json  # Recommended: Enable agent logging in JSON format
         stdout: false # On Windows and systems that don't use `systemd` or where `journald` is inaccessible
       ```

    3. [Redémarrez l&apos;agent](/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status) pour charger les nouveaux paramètres.

       Cette configuration met en place l&apos;agent en mode dépannage, mais le redirecteur de log (basé sur [Fluent Bit](https://fluentbit.io/)) continuera en mode non verbeux.
  </Collapser>

  <Collapser className="freq-link" id="fluentbit-logs" title="Activation du mode verbeux dans le redirecteur de log (Fluent Bit)">
    Parfois, vous pouvez avoir des problèmes avec le redirecteur de loglui-même. Par exemple, il peut y avoir des problèmes d&apos;accès à un canal spécifique lors de l&apos;envoi Windows d&apos;un log événement de ou lors de l&apos;accès à un fichier de log particulier. Dans ces situations, vous pouvez également activer le mode verbeux pour le redirecteur de log .

    <Callout variant="important">
      Le logging des traces génère beaucoup de données très rapidement. Pour réduire la consommation d&apos;espace disque et l&apos;ingestion de données, une fois la génération du log terminée, assurez-vous de définir `level: info` (ou moins).
    </Callout>

    1. Modifiez votre fichier `newrelic-infra.yml` .
    2. Activez le log détaillé de Fluent Bit en ajoutant le snippet de configuration suivant :
       ```yml
       log:
         level: trace
         forward: true # Enables sending logs to New Relic
         format: json  # Recommended: Enable agent logging in JSON format
         stdout: false # On Windows and systems that don't use `systemd` or where `journald` is inaccessible
         include_filters:
           traces:
             - supervisor # Required to see verbose logs from Fluent Bit
       ```
    3. [Redémarrez l&apos;agent](/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status) pour charger les nouveaux paramètres.
  </Collapser>

  <Collapser className="freq-link" id="no-fb" title="Fluent Bit ne démarre pas avec l'agent d'infrastructure">
    <Callout variant="important">
      Le plugin tail de Fluent Bit ne prend pas en charge les lecteurs réseau.
    </Callout>

    Pour les versions Linux antérieures à 2016, vous devrez peut-être mettre à jour la bibliothèque OpenSSL vers la version 1.1.0 (ou supérieur). Pour vérifier si vous avez ce problème :

    1. Vérifiez si `infra-agent` a démarré Fluent Bit en exécutant :

       ```bash
       ps -aux | grep fluent-bit
       ```

    2. S&apos;il ne fonctionne pas, accédez à `/var/db/newrelic-infra/newrelic-integrations/logging` et exécutez :

       ```bash
       ./fluent-bit -i systemd -o stdout
       ```

    3. Si vous obtenez l’erreur suivante :

       ```
       error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory
       ```

       Assurez-vous de mettre à jour OpenSSL vers la version 1.1.0 ou supérieur.
  </Collapser>

  <Collapser className="freq-link" id="windows-runtime-error" title="Erreur d'exécution sous Windows">
    L&apos;un des messages d&apos;erreur suivants peut apparaître lors de l&apos;activation du transfert de logsous Windows:

    ```
    The code execution cannot proceed because VCRUNTIME140.dll was not found.
    ```

    OU

    ```
    error="exit status 3221225781" process=log-forwarder
    ```

    Ceci est dû à une DLL manquante.

    Pour résoudre le problème, installez le [redistribuable Microsoft Visual C++](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads) selon le cas :

    * [x64](https://aka.ms/vs/16/release/vc_redist.x64.exe)
    * [x86](https://aka.ms/vs/16/release/vc_redist.x86.exe)
  </Collapser>

  <Collapser className="freq-link" id="too-many-files" title="Erreurs lors de la recherche d'une grande quantité de fichiers log (Linux)">
    Il est courant de rencontrer l&apos;un des messages d&apos;erreur suivants lorsque vous tentez de suivre une grande quantité de fichiers :

    * `Too many open files`
    * `The user limit on the total number of inotify watches was reached or the kernel failed to allocate a needed resource`

    Le système d&apos;exploitation définit un nombre maximal de descripteurs de fichiers allouables (généralement 1024 par défaut) et un nombre maximal de surveillances inotify allouables (généralement 8192 par défaut). Tout processus tentant de dépasser ces limites échouera et renverra l’une des erreurs ci-dessus.

    La technologie sous-jacente que nous utilisons pour transférer les logs, [Fluent Bit](https://fluentbit.io/), ouvre un descripteur de fichier et définit une surveillance inotify pour chaque fichier que vous configurez pour être transféré. De plus, au moment de la rédaction de cette section, Fluent Bit utilise un ensemble supplémentaire de 32 descripteurs de fichiers pour son fonctionnement normal, avec un autre descripteur de fichier supplémentaire lorsqu&apos;il s&apos;arrête. Par conséquent, <DNT>**to capture a large amount of files you need to ensure that both the file descriptor and inotify watch limits are slightly greater than the amount of log files you wish to tail**</DNT>.

    Les instructions suivantes résument comment augmenter ces limites si vous souhaitez limiter à 10 000 le fichier de log. En outre, il suppose que l&apos;agent d&apos;infrastructure est installé en [mode d&apos;exécution](/docs/infrastructure/install-infrastructure-agent/linux-installation/linux-agent-running-modes/) `root` et doit donc être exécuté à l&apos;aide de l&apos;utilisateur `root` .

    1. Vérifiez quelle est la limite stricte actuelle pour la quantité de descripteurs de fichiers par processus. En règle générale, cette limite devrait être assez élevée et ne devrait pas avoir besoin d’être modifiée.

       ```bash
       ulimit -Hn
       ```

    2. Ajoutez la ligne suivante à `/etc/security/limits.conf`. Nous avons spécifié ici une limite de `10100` au lieu de seulement `10000` pour permettre à Fluent Bit d&apos;allouer les descripteurs de fichiers supplémentaires dont il pourrait avoir besoin pour fonctionner.

       ```bash
       root soft nofile 10100 # replace root by nri-agent for non-root (privileged and unprivileged) installations
       ```

    3. Ajoutez la ligne suivante à `/etc/pam.d/common-session` afin que la limite précédente soit appliquée au redémarrage :

       ```bash
       session required pam_limits.so
       ```

    4. Ajoutez la ligne suivante à `/etc/sysctl.conf` pour augmenter le nombre d’observateurs inotify autorisés par utilisateur. Nous avons spécifié ici une limite de `18192` au lieu de seulement `10000` afin que l&apos;utilisateur `root` ait toujours `8192` montres inotify disponibles (la valeur par défaut).

       ```bash
       fs.inotify.max_user_watches=18192
       ```

    5. Redémarrez votre système.

    6. Assurez-vous que les nouvelles limites ont été appliquées en exécutant :

       ```bash
       ulimit -Sn                                 # Should return 10100
       cat /proc/sys/fs/inotify/max_user_watches  # Should return 18192
       ```

       [Apprenez-en davantage sur la façon d&apos;augmenter les limites de fichiers ouverts](https://tecadmin.net/increase-open-files-limit-ubuntu/) ou sur [la façon d&apos;augmenter les surveillances inotify](https://dev.to/rubiin/ubuntu-increase-inotify-watcher-file-watch-limit-kf4).
  </Collapser>

  <Collapser className="freq-link" id="install-fb-version" title="Installer la dernière version de Fluent Bit (Linux)">
    Avant la version [1.19.0](/docs/release-notes/infrastructure-release-notes/infrastructure-agent-release-notes/new-relic-infrastructure-agent-1190) (ou la version [1.20.3](/docs/release-notes/infrastructure-release-notes/infrastructure-agent-release-notes/new-relic-infrastructure-agent-1203) pour SLES 12.5), l&apos;agent d&apos;infrastructure Linux était fourni avec un binaire Fluent Bit. À partir de cette version, Fluent Bit est désormais inclus en tant que dépendance de package `recommended` distincte.

    Cela signifie que vous pouvez installer, mettre à jour ou rétrograder Fluent Bit séparément de l&apos;agent. Pour votre commodité, nous avons inclus plusieurs packages Fluent Bit dans le même référentiel où réside l&apos; infrastructure , vous n&apos;avez donc pas besoin d&apos;installer de référentiel supplémentaire pour mettre à niveau Fluent Bit.

    Notez que l&apos;agent installe automatiquement Fluent Bit lors de la première installation, en utilisant la dernière version disponible. Après la première installation, vous pouvez mettre à niveau Fluent Bit comme vous le feriez normalement avec n&apos;importe quel package Linux.

    Vous pouvez lister les versions de Fluent Bit disponibles en exécutant :

    TR/MIN :

    ```bash
    sudo yum check-update
    yum list fluent-bit --showduplicates
    ```

    DÉB:

    ```bash
    sudo apt update
    apt-cache showpkg fluent-bit
    ```

    Pour mettre à niveau vers la dernière version de Fluent Bit, exécutez ces commandes :

    TR/MIN :

    ```bash
    # Remove command only required when downgrading to a previous version
    # sudo yum remove fluent-bit
    sudo yum install fluent-bit
    ```

    DÉB:

    ```bash
    sudo apt install fluent-bit
    ```
  </Collapser>

  <Collapser className="freq-link" id="rollback-after-fluent-bit-2" title="Retour à Fluent-bit 1.x après l'agent d'infrastructure 1.42.0 sur Linux">
    Veuillez noter que td-agent-bit n&apos;est pas disponible pour les distributions suivantes, les restaurations sur celles-ci ne sont donc pas possibles :

    * Flux CentOS 9 (y compris Rocky Linux et AlmaLinux)
    * RedHat 9
    * Ubuntu 22.04.x
    * Open Suse (SLES) 15.4
    * Amazon Linux 2023

    Si vous souhaitez revenir à td-agent-bit, vous pouvez suivre les étapes décrites ci-dessous :

    1. Ouvrez le fichier `/etc/newrelic-infra.yml` en utilisant votre éditeur de texte préféré.
    2. Ajoutez la ligne suivante à la fin du fichier : `fluent_bit_exe_path: /opt/td-agent-bit/bin/td-agent-bit`.
    3. Enregistrez les modifications.
    4. Redémarrez l’agent d’infrastructure en exécutant la commande suivante : `sudo systemctl restart newrelic-infra`.

    En effectuant ces étapes, l’agent d’infrastructure sera configuré pour utiliser td-agent-bit au lieu de fluent-bit.
  </Collapser>
</CollapserGroup>

## Quelle est la prochaine étape ? [#what-next]

Explorez les données de logging sur votre plateforme avec notre [interface utilisateur de logs](/docs/logs/log-management/ui-data/use-logs-ui/).

* Obtenez une visibilité plus approfondie sur les données de performances de votre application et de votre plateforme en transmettant votre log avec nos capacités [de logs en contexte](/docs/logs/enable-log-management-new-relic/configure-logs-context/configure-logs-context-apm-agents/) .
* Configurer [des alertes](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-alert-conditions/).
* [interrogez vos données](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) et [créez un dashboard](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/).

## Désactiver le transfert de log [#uninstall]

Pour désactiver les fonctionnalités de transfert de log , accédez à votre répertoire `logging.d` et supprimez les fichiers avec l&apos;extension `.yml` qui ont été ajoutés à l&apos;origine lors du processus [configuration](#step-1-configure-the-infrastructure-agent) .

* Linux: `/etc/newrelic-infra/logging.d/`
* Windows: `C:\Program Files\New Relic\newrelic-infra\logging.d\`