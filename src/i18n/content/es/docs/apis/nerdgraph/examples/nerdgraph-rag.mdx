---
title: 'Tutorial de NerdGraph: Configurar herramientas y documentos de RAG'
metaDescription: Enhance New Relic AI with RAG (Retrieval Augmented Generation)
freshnessValidatedDate: never
translationType: machine
---

With New Relic, you can enhance New Relic AI agents with RAG. This means that you can associate documentation, runbooks, incident retros and even source code with your services, giving New Relic AI better insight into issues with your system.

## Comience a usar RAG [#get-started]

### Obtenga el ID de su organización [#get-org-id]

```graphql
{
  actor {
    organization {
      id
    }
  }
}
```

### Crear una herramienta RAG [#create-rag-tool]

¡Cabe señalar que el nombre y la descripción de su herramienta RAG son extremadamente importantes! El LLM elegirá aprovechar una herramienta al responder a un símbolo en función de la precisión del nombre y la descripción de la herramienta.

```graphql
mutation {
  entityManagementCreateRagTool(
    ragToolEntity: {
      description: "Runbooks for resolving incidents with APIs",
      name: "API Runbooks",
      scope: {id: `${ORGANIZATION_ID}`, type: ORGANIZATION}
    }
  ) {
    entity {
      id
    }
  }
}
```

### Subir un documento a la API de Blob [#upload-document]

<Callout variant="important">
  Todos los documentos indexados son visibles para todos los usuarios dentro de su organización. Cerciorar de que los documentos que indexe cumplan con sus políticas internas para el uso de los servicios.
</Callout>

* Tenga en cuenta que este paso específico no se realiza a través de NerdGraph. Esto se debe a que NerdGraph admite la carga de archivos a través de sus API.

```shell
curl -X POST https://blob-api.one-service.newrelic.com/v1/e/organizations/$ORGANIZATION_ID/RagDocuments \
     -H 'Api-Key: NRAK-XXXXXXXXXX' \
     -H 'NewRelic-Entity: {"name": "Runbooks for API service" }' \
     -H 'Content-Type: application/json' \
     -d @incidents.json
```

La respuesta se verá así:

```json
{
  "entityGuid": "MTIyODU0NTN8TkdFUHxSQUdfRE9DVU1FTlR8MDE5NGUyOTgtYmQzMS03NzA4LWI3NzItYzQ4MTZlYjNhYThk",
  "blobVersionEntity": null
}
```

### Ver la entidad del documento RAG representada en NerdGraph

```graphql
{
  actor {
    entityManagement {
      entity(
        id: `${RAG_DOCUMENT_GUID}`
      ) {
        ... on EntityManagementRagDocumentEntity {
          id
          name
          blob {
            url
          }
          type
        }
      }
    }
  }
}
```

Ahora que tenemos una herramienta RAG y un documento RAG, necesitamos asociarlos entre sí. Esto se hace a través de las API de gestión de entidades en NerdGraph.

### Crear una relación entre el documento RAG y la herramienta RAG

```graphql
mutation {
  entityManagementCreateRelationship(
    relationship: {
      source: {
        scope: ORGANIZATION,
        id: `${RAG_DOCUMENT_GUID}`
      },
      target: {
        scope: ORGANIZATION,
        id: `${RAG_TOOL_GUID}`
      },
      type: "INDEXED_FOR"
    }
  ) {
    relationship {
      type
      target {
        id
        type
      }
      source {
        id
        type
      }
    }
  }
}
```

### Consulta para ver las relaciones entre los Documentos RAG y las Herramientas RAG

```graphql
{
  actor {
    entityManagement {
      relationships(
        filter: {sourceId: {eq: `${RAG_DOCUMENT_ID}`}}
      ) {
        items {
          type
          target {
            id
            type
          }
        }
      }
    }
  }
}
```

### Consulta la herramienta RAG

You can query your RAG Tool and receive chunked matches based on the documents indexed for a given tool. You may use New Relic AI to summarize the returned chunk matches, or you may use the NerdGraph APIs to retrieve the match and use your own AI on your own systems.

```graphql
{
  actor {
    machineLearning {
      ragQueryData(
        prompt: "tell me about the incident", 
        toolId: `${RAG_TOOL_GUID}`
      ) {
        blobId
        chunk
        documentId
        score
        toolId
      }
    }
  }
}
```