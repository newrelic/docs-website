---
title: Reenvíe su log utilizando el agente de infraestructura
tags:
  - Logs
  - Enable log management in New Relic
  - Enable log monitoring in New Relic
metaDescription: 'How to forward your logs to New Relic using our infrastructure agent, so you can use enhanced log management capabilities.'
freshnessValidatedDate: never
translationType: machine
---

Reenviar su log a New Relic hace que todos sus datos de logging estén disponibles en una ubicación, lo que brinda una visibilidad más profunda tanto de su aplicación como de los datos de rendimiento de su plataforma. Con su log en un solo lugar, puede recopilar, procesar, explorar, consultar y alertar sobre errores o anomalías encontradas en sus datos log .

<img title="Logs in context for a host" alt="Screenshot of logs in context for a host" src="/images/logs_full_host_logs_ui.webp" />

<figcaption>
  Desde UI de su anfitrión, su log se coloca en el contexto del evento durante el período de tiempo seleccionado. Puede profundizar en datos detallados para cualquiera de los atributos resaltados.
</figcaption>

La forma de reenviar su log depende de cómo instaló el agente de infraestructura, ya que el agente de infraestructura habilita la característica de reenvío de logs. Puede instalar el agente de infraestructura a través de:

* Instalación guiada (recomendada para la mayoría de usuarios)
* Instalación manual
* Archivo tar de Linux

<Callout variant="important">
  La versión Linux del agente de infraestructura, específicamente la versión 1.42.0, ha pasado del uso del paquete td-agente-bit al paquete fluent-bit. Este cambio fue necesario por el hecho de que fluent-bit ya no se distribuye en la versión td-agente-bit después de la actualización principal de la versión 2.x.

  Para garantizar operaciones fluidas y brindar la opción de volver a td-agente-bit en caso de cualquier problema con el paquete fluent-bit, el agente de infraestructura ahora instala ambos paquetes (td-agente-bit y fluent-bit). De forma predeterminada, el agente está configurado para utilizar fluent-bit.

  Consulte [Revertir a Fluent Bit 1.9](#rollback-after-fluent-bit-2) para obtener más información sobre cómo revertir.
</Callout>

<Callout variant="tip">
  ¿Tienes muchos logs? Consulte nuestro [tutorial sobre cómo optimizarlos y administrarlos](/docs/tutorial-large-logs/get-started-managing-large-logs/).
</Callout>

## Requisito del sistema [#system]

* Agente de infraestructura versión 1.11.4 o superior
* [Fluent Bit](https://fluentbit.io/). El agente de infraestructura ya instala la última versión. Para actualizarlo o degradarlo a una versión específica, consulte los procedimientos [de instalación de Fluent Bit](#install-fb-version) .
* Biblioteca OpenSSL 1.1.0 o más alto
* Se agregó soporte integrado para la arquitectura ARM64 en sistemas Linux (por ejemplo, la arquitectura AWS Graviton) en el agente de infraestructura [1.20.6](https://github.com/newrelic/infrastructure-agent/releases/tag/1.20.6).
* Amazon Linux 2 y 2023
* CentOS versión 8 y 9 Stream (Rocky Linux y AlmaLinux también son compatibles)
* RedHat versión 8 y 9
* Debian versión 11 (Bullseye) y 12 (Bookworm).
* SUSE Linux Enterprise Server (SLES) versión 12 y 15 (no se admite ARM64).
* Versiones de Ubuntu 16.04.x, 18.04.x, 20.04.x, 22.04.x, 24.04.x (Versiones LTS).
* Windows Server 2016, 2019 y 2022 y sus service packs.
* Ventanas 10, Ventanas 11.

## Reenviar log automáticamente con instalación guiada [#infra]

Cuando emplea nuestra instalación guiada para instalar el agente de infraestructura, la característica del reenvío de logse configura automáticamente durante el proceso de instalación.

Para iniciar su instalación, elija su método de implementación:

<TechTileGrid>
  <TechTile name="Amazon Linux" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_Amazon-linux.webp" alt="Amazon Linux" variant="TechTile"/>} />

  <TechTile name="Ansible" to="/docs/infrastructure/new-relic-infrastructure/config-management-tools/configure-new-relic-infrastructure-using-ansible" icon={<img src="/images/os_icon_ansible-red.webp" alt="Ansible" variant="TechTile"/>} />

  <TechTile name="CentOS" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_centos.webp" alt="CentOS" variant="TechTile"/>} />

  <TechTile name="Debian" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_debian.webp" alt="Debian" variant="TechTile"/>} />

  <TechTile name="RHEL" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_redhat.webp" alt="Red Hat" variant="TechTile"/>} />

  <TechTile name="SLES" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_suse.webp" alt="SLES" variant="TechTile"/>} />

  <TechTile name="Ubuntu" to="https://one.newrelic.com/marketplace?state=8f14e646-461e-b010-4675-3a0658bb3d20" icon={<img src="/images/infrastructure_logo_ubuntu.webp" alt="Ubuntu" variant="TechTile"/>} />

  <TechTile name="Windows" to="https://one.newrelic.com/marketplace?state=a792b092-300f-a5a4-ff62-510f4e0c52a5" icon={<img src="/images/infrastructure_logo_windows.webp" alt="Windows" variant="TechTile"/>} />
</TechTileGrid>

<Callout variant="important">
  Para reenviar el registro desde un contenedor Docker, use esta [imagen de Docker](https://hub.docker.com/r/newrelic/newrelic-fluentbit-output) como imagen base que se usará con la integración del registro Kubernetes , o puede crear su propio contenedor con una configuración personalizada para diferentes entornos.
</Callout>

## Habilitar el reenvío de logs en el agente instalado manualmente [#manual]

Para instalar el agente de infraestructura manualmente, siga nuestro [tutorial para instalar el administrador de paquetes](/docs/infrastructure/install-infrastructure-agent/linux-installation/install-infrastructure-agent-linux-using-package-manager) o consulte nuestro [instalador MSI](/docs/infrastructure/install-configure-manage-infrastructure/windows-installation/install-infrastructure-windows-server-using-msi-installer) (Windows).

### Paso 1. Configurar el agente de infraestructura

Los archivos de configuración dirigen a su sistema para reenviar las fuentes log que desea que aparezcan en New Relic. Puede agregar tantos archivos de configuración como desee. Nuestro agente de infraestructura emplea `.yml` archivos para configurar el registro. Si instala el agente de infraestructura vía [integración &amp; agente](https://one.newrelic.com/marketplace?state=78678a7f-91c5-ca40-ac55-e6b74a50085c) en la UI, el archivo `logging.yml` se crea automáticamente.

Para agregar un nuevo archivo de configuración para la característica de reenvío de logs:

1. Navegue a la carpeta de configuración del reenviador de logs:

   * Linux: `/etc/newrelic-infra/logging.d/`
   * Ventanas: `C:\Program Files\New Relic\newrelic-infra\logging.d\`

2. Cree un archivo de configuración `logging.yml` y agregue el parámetro que necesite. El directorio `logging.d` tiene varios archivos `.yml.example` que puede utilizar como referencia o punto de partida. Para ver ejemplos de Windows, consulte [nuestro repositorio de Github](https://github.com/newrelic/infrastructure-agent/tree/master/assets/examples/logging/windows).

   ```yml
   # Log forwarder configuration file example
   # Source: file
   # Available customization parameters: attributes, max_line_kb, pattern
   logs:
     # Basic tailing of a single file
     - name: basic-file
       file: /var/log/logFile.log

     # File with spaces in its path. No need to use quotes.
     - name: file-with-spaces-in-path
       file: /var/log/folder with spaces/logFile.log

     # Specify a list of custom attributes, as key-value pairs, to be included
     # in each log record
     - name: file-with-attributes
       file: /var/log/logFile.log
       attributes:
         application: tomcat
         department: sales
         maintainer: example@mailprovider.com

     # Use wildcards to refer to multiple files having a common extension or
     # prefix. Newly generated files will be automatically detected every 60
     # seconds.
     #
     # WARNING: avoid using wildcards that include the file extension, since
     # it'll cause logs to be forwarded repeatedly if log rotation is enabled.
     - name: log-files-in-folder
       file: /var/log/logF*.log

     # Lines longer than 128 KB will be automatically skipped. Use 'max_line_kb'
     # to increase this limit.
     - name: log-file-with-long-lines
       file: /var/log/logFile.log
       max_line_kb: 256

     # Use 'pattern' to filter records using a regular expression
     - name: only-records-with-warn-and-error
       file: /var/log/logFile.log
       pattern: WARN|ERROR
   ```

El agente procesa automáticamente nuevos archivos de configuración sin tener que reiniciar el servicio de monitoreo de infraestructura. La única excepción a esto es cuando se configura una configuración personalizada de Fluent Bit.

### Paso 2. Establecer el parámetro de reenvío de logs [#parameters]

Debe configurar un `name` y un parámetro de origen log en el archivo de configuración de reenvío de logs `.yml`. Para comenzar, define un `name` del log o logs que deseas reenviar a New Relic.

Lo que utilice para la fuente log depende de la ubicación de donde proviene su log. Las opciones disponibles para el origen log incluyen:

<CollapserGroup>
  <Collapser id="file" title="archivo">
    Ruta al archivo de log o archivos. El agente realiza un seguimiento de los cambios en el archivo de log de forma similar al shell `tail -f` .

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: example-log
        file: /var/log/example.log     # Path to a single log file
      - name: example-log-two
        file: /var/log/example-two.log # Path to another single log file
    ```

    El parámetro `file` puede apuntar a un archivo de log específico o a varios archivos mediante el uso de comodines aplicados a nombres y extensiones; por ejemplo, `/logs/*.log`. Puede utilizar comodines en lugar de directorios en una ruta de archivo, que se pueden utilizar para seguir archivos ubicados en diferentes directorios.

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: docker-logs
        file: /var/lib/docker/containers/*/*.log # Path to multiple folders and files
    ```

    <Callout variant="important">
      El uso de comodines puede aumentar significativamente la cantidad de descriptores de archivos e inotificar las vigilancias que el proceso Fluent Bit mantiene abierto, lo que puede interferir con la recopilación log si se alcanza el límite de descriptores de archivos del host. Seguir una gran cantidad de archivos puede requerir que aumente la cantidad máxima de descriptores de archivos y notifique a los observadores permitidos por el sistema operativo. Consulte [Errores al seguir una gran cantidad de archivos de log](#too-many-files) para obtener más detalles sobre cómo aumentarlos.
    </Callout>
  </Collapser>

  <Collapser id="systemd" title="systemd">
    Utilice el parámetro `systemd` para reenviar mensajes de log recopilados por el daemon `journald` en entornos Linux. Este tipo de entrada requiere que el agente se ejecute en [modo raíz](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes).

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: systemd-example
        systemd: cupsd
    ```
  </Collapser>

  <Collapser id="syslog" title="syslog">
    Fuente de datos de Syslog.

    <DNT>
      **Parameters:**
    </DNT>

    * `uri:` Conector syslog. El formato varía según el protocolo:

      * Conectores de red TCP/UDP: `[tcp/udp]://LISTEN_ADDRESS:PORT`
      * Conectores de dominio Unix: `unix_[tcp/udp]:// + /socket/path`

    * `parser:` Analizador de syslog. El valor predeterminado es `rfc3164`. Utilice `rfc5424` si sus mensajes incluyen fracciones de segundo. Nota: `rfc3164` actualmente no funciona en SuSE.

    * `unix_permissions:` El valor predeterminado es `0644` para sockets de dominio. Esto limita las entradas a procesos que se ejecutan como root. Puede utilizar `0666` para escuchar procesos que no sean raíz (bajo su propia responsabilidad).

      Cuando se ejecuta el agente en [modo privilegiado](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes), los puertos y sockets deben estar disponibles o ser propiedad de `nri-agent` y con `0666` permisos de archivo para que otros procesos puedan escribir logs en los sockets.

      ```yml
      logs:
        # TCP network socket
        - name: syslog-tcp-test
          syslog:
            uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
            parser: rfc5424 # Default syslog parser is rfc3164

        # UDP network socket
        - name: syslog-udp-test
          syslog:
            uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
          max_line_kb: 35

        # Unix TCP domain socket
        - name: syslog-unix-tcp-test
          syslog:
            uri: unix_tcp:///var/unix-tcp-socket-test
            unix_permissions: 0666 # Default is 0644. Change at your own risk

        # Unix UDP domain socket
        - name: syslog-unix-udp-test
          syslog:
            uri: unix_udp:///var/unix-udp-socket-test
            parser: rfc5424
      ```
  </Collapser>

  <Collapser id="tcp" title="TCP">
    Log recuperado a través de conexiones TCP.

    <DNT>
      **Parameters:**
    </DNT>

    * `uri:` Socket TCP/IP para escuchar los datos entrantes. El formato URI es `tcp://LISTEN_ADDRESS:PORT`.

    * `format:` Formato de los datos. Puede ser `json` o `none`.

    * `separator:` Si se utiliza `format: none` , puede definir una cadena separadora para dividir registros (predeterminado: `\n`).

      ```yml
      logs:
        - name: tcp-simple-test
          tcp:
            uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: none            # Raw text - this is default for 'tcp'
            separator: \t           # String for separating raw text entries
          max_line_kb: 32
        - name: tcp-json-test
          tcp:
            uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
            format: json
      ```
  </Collapser>

  <Collapser id="winevtlog" title="winevtlog">
    <Callout variant="important">
      Disponible desde el agente de infraestructura v.1.24.3 Solo compatible con Windows Server 2019 y posteriores. Emplee [`winlog`](/docs/logs/forward-logs/forward-your-logs-using-infrastructure-agent/#winlog) en su lugar para versiones anteriores.
    </Callout>

    Recopile eventos de los canales log de Windows utilizando la nueva API de log de eventos de Windows mediante el [complemento Winevtlog Fluent Bit](https://docs.fluentbit.io/manual/pipeline/inputs/windows-event-log-winevtlog).

    <DNT>
      **Parameters:**
    </DNT>

    * `channel`: Nombre del log del canal del que se recopilará.

    * `collect-eventids`: Lista de ID de eventos de Windows que se recopilarán y reenviarán a New Relic. Se admiten rangos de ID de eventos.

    * `exclude-eventids`: Lista de ID de eventos de Windows que se excluirán de la colección. Se admiten rangos de ID de eventos.

    * `use-ansi`: Emplee codificación ANSI en mensajes `winlog`. Usamos codificación ANSI de forma predeterminada en Windows Server 2016 y versiones anteriores, y UTF-8 en las más nuevas. Puede anular este comportamiento con este parámetro de configuración si estos valores predeterminados no se adaptan a su caso de uso. Esto resuelve el problema de que el log de códigos de caracteres ANSI sea cadenas vacías. No es una función para convertir el log de códigos de caracteres multibyte en código de caracteres ANSI a UTF-8.

      Todos los eventos se recopilan del canal especificado de forma predeterminada. Configure las secciones `collect-eventids` y `exclude-eventids` para evitar enviar logs no deseados a su cuenta de New Relic.

      Agregue ID o rangos de eventos a `collect-eventids` o `exclude-eventids` para reenviar o descartar un evento específico. `exclude-eventids` tiene prioridad sobre `collect-eventids` si el mismo ID de evento está presente en ambas secciones.

      <DNT>
        **Example:**
      </DNT>

      ```yml
      logs:
        # Example winevtlog security log ingestion with eventId filters.
        - name: windows-security
          winevtlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735
          attributes:
            logtype: windows_security

        # Example entries for the application and system channels
        - name: windows-application
          winevtlog:
            channel: Application
            attributes:
              logtype: windows_application

        # Example entries for the application use-ansi
        - name: windows-application
          winevtlog:
            channel: Application
            attributes:
              logtype: windows_application
            use-ansi: true

        - name: windows-system
          winevtlog:
            channel: System
            attributes:
              logtype: windows_system

        # Example/Optional entry for Windows Defender Logs
        - name: windows-defender
          winevtlog:
            channel: Microsoft-Windows-Windows Defender/Operational

        # Example/Optional entry for Windows Clustering Logs
        - name: windows-clustering
          winevtlog:
            channel: Microsoft-Windows-FailoverClustering/Operational
      ```
  </Collapser>

  <Collapser id="winlog" title="winlog">
    <Callout variant="important">
      `Winlog` solo puede recopilar el log de eventos tradicional. Al intentar capturar a otros, se recopilará silenciosamente el log de la aplicación.
    </Callout>

    Recopile eventos de los canales log de Windows.

    <DNT>
      **Parameters:**
    </DNT>

    * `channel`: Nombre del log del canal del que se recopilará. No funciona para canales personalizados.

    * `collect-eventids`: Lista de ID de eventos de Windows que se recopilarán y reenviarán a New Relic. Se admiten rangos de ID de eventos.

    * `exclude-eventids`: Lista de ID de eventos de Windows que se excluirán de la colección. Se admiten rangos de ID de eventos.

    * `use-ansi`: Emplee codificación ANSI en mensajes `winlog`. Usamos codificación ANSI de forma predeterminada en Windows Server 2016 y versiones anteriores, y UTF-8 en las más nuevas. Puede anular este comportamiento con este parámetro de configuración si estos valores predeterminados no se adaptan a su caso de uso. Esto resuelve el problema de que el log de códigos de caracteres ANSI sea cadenas vacías. No es una función para convertir el log de códigos de caracteres multibyte en código de caracteres ANSI a UTF-8.

      Todos los eventos se recopilan del canal especificado de forma predeterminada. Configure las secciones `collect-eventids` y `exclude-eventids` para evitar enviar logs no deseados a su cuenta de New Relic.

      Agregue ID o rangos de eventos a `collect-eventids` o `exclude-eventids` para reenviar o descartar un evento específico. `exclude-eventids` tiene prioridad sobre `collect-eventids` si el mismo ID de evento está presente en ambas secciones.

      <DNT>
        **Example:**
      </DNT>

      ```yml
      logs:
        # Example winlog security log ingestion with eventId filters.
        - name: windows-security
          winlog:
            channel: Security
            collect-eventids:
              - 4624
              - 4265
              - 4700-4800
            exclude-eventids:
              - 4735
          attributes:
            logtype: windows_security

        # Example entries for the application and system channels
        - name: windows-application
          winlog:
            channel: Application
            attributes:
              logtype: windows_application
        - name: windows-system
          winlog:
            channel: System
            attributes:
              logtype: windows_system

        # Example entries for the application use-ansi
        - name: windows-application
          winlog:
            channel: Application
            attributes:
              logtype: windows_application
            use-ansi: true

        # Example/Optional entry for Windows Defender Logs
        - name: windows-defender
          winlog:
            channel: Microsoft-Windows-Windows Defender/Operational

        # Example/Optional entry for Windows Clustering Logs
        - name: windows-clustering
          winlog:
            channel: Microsoft-Windows-FailoverClustering/Operational
      ```
  </Collapser>
</CollapserGroup>

### Paso 3. Definir atributo clave [#optional-config]

Aunque estos parámetros de configuración no son obligatorios, le recomendamos que aplique estas configuraciones a su archivo `logging.yml` para aprovechar al máximo el reenvío de logs.

<CollapserGroup>
  <Collapser id="attributes" title="Atributo">
    Lista de atributos personalizados especificados como pares de valores principales que se pueden utilizar para enviar datos adicionales con el log que luego puede consultar. El parámetro de configuración `attributes` se puede utilizar con cualquier origen log .

    <Callout variant="important">
      El parámetro de configuración `attributes` no agrega un atributo personalizado para el log reenviado mediante la configuración externa de Fluent Bit (por ejemplo, usando el parámetro de configuración `fluentbit` . En este escenario, debes consultar la opción `record_modifier` en la [documentación de Fluent Bit](https://docs.fluentbit.io/manual/).
    </Callout>

    Un uso común del parámetro de configuración `attributes` es especificar el atributo `logtype` . Este atributo permite aprovechar una de las [reglas de análisis integradas](/docs/logs/log-management/ui-data/parsing/#built-in-rules) compatibles con las capacidades <InlinePopover type="logs" />de New Relic.

    <DNT>
      **Example:**
    </DNT>

    ```yml
    logs:
      - name: example-file-attributes
        file: /var/log/example.log
        attributes:
          logtype: nginx
          region: example-us-02
          team: A-team
      - name: example-tcp-attributes
        tcp:
          uri: tcp://0.0.0.0:2345
          format: json
        attributes:
          logtype: nginx
          region: example-us-02
          team: B-team
    ```
  </Collapser>

  <Collapser id="automatically-inserted-attributess" title="atributo insertado automáticamente por el agente de infraestructura">
    El agente de infraestructura inserta automáticamente el atributo log para su conveniencia. Algunos de ellos se insertan para cualquier log , mientras que otros dependen del parámetro de configuración que utilizó al configurar el reenviador de logs.

    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            Nombre del atributo
          </th>

          <th>
            Descripción
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `entity.guids`
          </td>

          <td>
            Siempre insertado.

            El agente de infraestructura inserta el [GUID de entidad](/attribute-dictionary/?event=Span&attribute=entityGuid) asignado por New Relic para identificar el host donde se está ejecutando. Está disponible en el campo `entity.guids` .

            Nota: Si el log capturado pertenece a una aplicación instrumentada usando APM, el campo `entity.guids` contiene tanto el GUID de la entidad de infraestructura, como el GUID de APM, separados por un delimitador de barra vertical ( | ).
          </td>
        </tr>

        <tr>
          <td>
            `fb.input`
          </td>

          <td>
            Siempre insertado.

            El [tipo de complemento de entrada de Fluent Bit](https://docs.fluentbit.io/manual/pipeline/inputs) subyacente utilizado para capturar el log. Actualmente sus valores son `tail`, `systemd`, `winlog`, `syslog` y `tcp`.
          </td>
        </tr>

        <tr>
          <td>
            `filePath`
          </td>

          <td>
            Se inserta cuando se utiliza el tipo de entrada `file` .

            Ruta de acceso absoluta del archivo que se está supervisando.
          </td>
        </tr>

        <tr>
          <td>
            `hostname`
          </td>

          <td>
            Siempre insertado.

            El nombre de host de la máquina/máquina virtual (VM)/contenedor que ejecuta el agente de infraestructura.
          </td>
        </tr>

        <tr>
          <td>
            `plugin.type`
          </td>

          <td>
            Siempre insertado.

            Indica la utilidad utilizada para capturar el log. En este caso es el propio agente de infraestructura, por lo que este atributo siempre tiene el valor `nri-agent`.
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser id="pattern" title="patrón">
    Expresión regular para filtrar registros. Solo se admite para las fuentes `file`, `systemd`, `syslog` y `tcp` (solo con formato `none`).

    Este campo funciona de forma similar a `grep -E` en sistemas Unix. Por ejemplo, para un archivo determinado que se está capturando, puede filtrar los registros que contengan `WARN` o `ERROR` usando:

    ```yml
    - name: only-records-with-warn-and-error
      file: /var/log/logFile.log
      pattern: WARN|ERROR
    ```

    No se aplica ningún filtrado de forma predeterminada.
  </Collapser>

  <Collapser id="max_line_kb" title="max_line_kb">
    Tamaño máximo de entradas/líneas log en KB. Si las entradas log exceden el límite, se omiten. El valor predeterminado es `128`, el valor mínimo permitido es `33`.
  </Collapser>

  <Collapser id="fluentbit" title="fluentbit">
    Archivos de configuración y analizador externos [de Fluent Bit](https://fluentbit.io/) . Si se definen, se fusionan con los archivos de configuración y analizador existentes generados por el agente de infraestructura.

    El agente de infraestructura procesa los archivos de configuración ubicados en el directorio `logging.d` y generará un archivo de configuración de Fluent Bit en tiempo de ejecución que contiene las secciones `[INPUT]`, `[FILTER]` y `[OUTPUT]` apropiadas. Opcionalmente, también declarará un `@INCLUDE` en caso de que haya proporcionado un archivo de configuración externo de Fluent Bit a través de la opción `fluentbit` .

    El archivo de tiempo de ejecución no define una [sección`[SERVICE]` ](https://docs.fluentbit.io/manual/administration/configuring-fluent-bit/classic-mode/configuration-file), dejando todos los valores de configuración predeterminados de Fluent Bit. Aún puedes anular la configuración predeterminada de Fluent Bit definiendo tu propia sección `[SERVICE]` en tu archivo de configuración externo de Fluent Bit e incluyéndola a través de la opción `fluentbit` .

    <DNT>
      **Parameters:**
    </DNT>

    `config_file:` ruta a un archivo de configuración de Fluent Bit existente. Tenga en cuenta que cualquier fuente superpuesta genera mensajes duplicados en nuestra UI de log.

    `parsers_file:` ruta a un archivo de analizadores Fluent Bit existente. Los siguientes nombres de analizadores están reservados: `rfc3164`, `rfc3164-local` y `rfc5424`.

    <Callout variant="important">
      El agente de infraestructura permite el reenvío de logs para los casos de uso más comunes definiendo una configuración simple de reenvío de logs en los archivos YAML en el directorio `logging.d/` , como se describe en este documento. Estos archivos se traducen internamente a archivos de configuración de Fluent Bit con el formato correcto y valores predeterminados de configuración sensatos. New Relic brinda soporte oficial para estas opciones de configuración ya que nos aseguramos de que los archivos de configuración generados sean correctos y operativos.

      Sin embargo, para aquellos casos de uso que no están cubiertos por nuestras opciones de configuración admitidas, brindamos la posibilidad de utilizar una configuración de Fluent Bit y un archivo de analizadores generado externamente usando las opciones `fluentbit`, `config_file` y `parsers_file` .

      Nota: No podemos garantizar el correcto funcionamiento del log reenviado en este caso, dado que la configuración proporcionada es completamente arbitraria y no está siendo generada/validada por el agente. Por lo tanto, New Relic no brinda soporte oficial para la configuración externa especificada a través de estas opciones.
    </Callout>
  </Collapser>
</CollapserGroup>

### Archivo de configuración de muestra [#running-modes]

A continuación se muestra un ejemplo de un archivo de configuración `logging.d` en formato YAML. Para obtener más ejemplos de configuración, [consulte el repositorio del agente de infraestructura](https://github.com/newrelic/infrastructure-agent/tree/master/assets/examples/logging).

<CollapserGroup>
  <Collapser id="configuration-file" title="logging.d/sample.yaml">
    ```yml
    # Remember to only use spaces for indentation

    logs:
      # Example of 'file' source
      - name: file-with-attributes
        file: /var/log/test.log # Path to a single file or pattern
        attributes:             # You can use custom attributes to enrich your data
          logtype: nginx
          team: The A Team
        pattern: Error          # Regular expression to filter log entries

      # Example of 'systemd' source (Linux only)
      - name: systemd-example
        systemd: cupsd

      # Examples of 'syslog' source, one per protocol
      # TCP network socket
      - name: syslog-tcp-test
        syslog:
          uri: tcp://0.0.0.0:5140 # Use the tcp://LISTEN_ADDRESS:PORT format
          parser: rfc5424         # Default syslog parser is rfc3164

      # UDP network socket
      - name: syslog-udp-test
        syslog:
          uri: udp://0.0.0.0:6140 # Use the udp://LISTEN_ADDRESS:PORT format
        max_line_kb: 35

      # Paths for Unix sockets are defined by combining protocol and path:
      # unix_udp:// + /path/socket - for example, unix_udp:///tmp/socket
      # Unix TCP domain socket
      - name: syslog-unix-tcp-test
        syslog:
          uri: unix_tcp:///var/unix-tcp-socket-test
          unix_permissions: 0666 # Default is 0644. Change at your own risk

      # Unix UDP domain socket
      - name: syslog-unix-udp-test
        syslog:
          uri: unix_udp:///var/unix-udp-socket-test
          parser: rfc5424

      # Examples of 'tcp' source for formats 'none' and 'json'
      - name: tcp-simple-test
        tcp:
          uri: tcp://0.0.0.0:1234 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: none            # Raw text - this is default for 'tcp'
          separator: \t           # String for separating raw text entries
        attributes:               # You can add custom attributes to any source of logs
          tcpFormat: none
          someOtherAttribute: associatedValue
        max_line_kb: 32
      - name: tcp-json-test
        tcp:
          uri: tcp://0.0.0.0:2345 # Use the tcp://LISTEN_ADDRESS:PORT format
          format: json
        attributes:
          tcpFormat: json
          yetAnotherAttribute: 12345

      # Example of Fluent Bit configuration import
      - name: fluentbit-import
        fluentbit:
          config_file: /path/to/fluentbit.config
          parsers_file: /path/to/fluentbit/parsers.conf
    ```
  </Collapser>
</CollapserGroup>

### Paso 4. Vea sus datos log [#find-data]

Si todo está configurado correctamente y sus datos se están recopilando, debería ver el log y telemetry data relacionados en estos lugares:

* Nuestra [UI de logs](https://one.newrelic.com/launcher/logger.log-launcher)
* En la UI de infraestructura, desde la tabla de hosts, haga clic en el botón <Icon name="fe-more-horizontal" /> icono para un host específico y luego haga clic en <DNT>**View logs**</DNT>.
* Nuestras herramientas para ejecutar [NRQL consulta](/docs/chart-builder/use-chart-builder/choose-data/use-advanced-nrql-mode-specify-data). Por ejemplo, puedes ejecutar una consulta como esta:

```sql
SELECT * FROM Log
```

## Habilite el logging para su integración en el host [#on-host]

Con el agente de infraestructura instalado, puede habilitar el análisis automático de logs y el reenvío para nuestra integración más popular en el host con un solo paso. Para habilitar esta característica, cambie el nombre del archivo `on-host-log.yml.example` a `on-host-log.yml`. Una vez hecho esto, el log de su integración se analiza automáticamente y se envía a New Relic.

Esta opción está disponible para nuestra [plataforma Linux compatible](#requirements).

Para habilitar la característica de reenvío de logs de integración en el host:

<CollapserGroup>
  <Collapser id="elastic-search-logs" title="Log de búsqueda elástica">
    Copie o cambie el nombre del archivo `elasticsearch-log.yml.example` a `elasticsearch-log.yml` para habilitar el análisis automático de logs con formato JSON de Elasticsearch y el reenvío a New Relic. No es necesario reiniciar el agente.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/elasticsearch-log.yml.example /etc/newrelic-infra/logging.d/elasticsearch-log.yml
    ```
  </Collapser>

  <Collapser id="mysql-logs" title="Log de MySQL">
    Copie o cambie el nombre del archivo `mysql-log.yml.example` a `mysql-log.yml` para habilitar el análisis automático de errores de MySQL y el reenvío a New Relic. No es necesario reiniciar el agente.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/mysql-log.yml.example /etc/newrelic-infra/logging.d/mysql-log.yml
    ```
  </Collapser>

  <Collapser id="nginx-logs" title="Log NGINX">
    Copie o cambie el nombre del archivo `nginx-log.yml.example` a `nginx-log.yml` para habilitar el acceso automático a NGINX y el análisis de errores de logs y el reenvío a New Relic. No es necesario reiniciar el agente.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/nginx-log.yml.example /etc/newrelic-infra/logging.d/nginx-log.yml
    ```
  </Collapser>

  <Collapser id="rabbitmq-logs" title="Log de Rabbitmq">
    Copie o cambie el nombre del archivo `rabbitmq-log.yml.example` a `rabbitmq-log.yml` para habilitar el análisis de logs de errores automático de Rabbitmq y el reenvío a New Relic. No es necesario reiniciar el agente.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/rabbitmq-log.yml.example /etc/newrelic-infra/logging.d/rabbitmq-log.yml
    ```
  </Collapser>

  <Collapser id="redis-logs" title="Log de Redis">
    Copie o cambie el nombre del archivo `redis-log.yml.example` a `redis-log.yml` para habilitar el análisis de logs de errores de Redis automático y el reenvío a New Relic. No es necesario reiniciar el agente.

    <DNT>
      **Example:**
    </DNT>

    ```bash
    sudo cp /etc/newrelic-infra/logging.d/redis-log.yml.example /etc/newrelic-infra/logging.d/redis-log.yml
    ```
  </Collapser>
</CollapserGroup>

## Habilite el reenvío de logs en el agente instalado usando el tarball de Linux [#tarball-install]

Nuestro proceso de instalación personalizado de Linux para monitoreo de infraestructura le permite personalizar todos los aspectos del proceso de instalación y colocar archivos y carpetas en su máquina. Si elige el proceso de instalación [asistida](/docs/infrastructure/install-infrastructure-agent/linux-installation/tarball-assisted-install-infrastructure-agent-linux) o [manual](/docs/infrastructure/install-infrastructure-agent/linux-installation/tarball-manual-install-infrastructure-agent-linux) de tarball, siga estos pasos para implementar la característica reenviador de logs:

1. Cree los siguientes directorios:

   * `/var/db/newrelic-infra/newrelic-integrations/logging`
   * `/etc/newrelic-infra/logging.d`

2. Descargue e instale [el paquete de Fluent Bit (RPM)](https://github.com/newrelic/fluent-bit-package/releases) de New Relic ejecutando un comando similar a:

   ```shell
   yum localinstall fluent-bit-<some-version>.rpm
   ```

3. Descargue [el complemento fluentbit](https://github.com/newrelic/newrelic-fluent-bit-output/releases) de New Relic y guárdelo como `/var/db/newrelic-infra/newrelic-integrations/logging/out_newrelic.so`.

4. Descargue o copie el archivo `parsers.conf` de [este repositorio de Github](https://github.com/newrelic/fluent-bit-package/blob/main/parsers.conf) y guárdelo como `/var/db/newrelic-infra/newrelic-integrations/logging/parsers.conf`.

<InstallFeedback />

## Resolución de problemas [#troubleshoot]

Si tiene problemas al configurar su reenviador de logs, pruebe estos consejos de resolución de problemas.

<CollapserGroup>
  <Collapser className="freq-link" id="log-data" title="Sin datos log">
    Si no aparecen datos después de habilitar nuestras capacidades de administración de logs, siga nuestros [procedimientos estándar de resolución de problemas de logs](/docs/logs/log-management/troubleshooting/no-log-data-appears-ui/).
  </Collapser>

  <Collapser className="freq-link" id="no-data" title="No aparecen datos al seguir un archivo">
    La característica de reenvío de logs requiere que el agente tenga permiso para leer las fuentes de datos. Al ejecutar el agente de infraestructura en [modos privilegiados o no privilegiados](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes), asegúrese de que el usuario que ejecuta `nri-agent` pueda leer el archivo de log que desea reenviar (y cualquier directorio intermediario en su ruta).

    <DNT>
      **Example: Check file access under Linux**
    </DNT>

    Comprobemos si el archivo `/var/log/restrictedLogs/logFile.log` puede ser monitoreado por el usuario `nri-agent` . En Linux, puedes hacer una comprobación rápida con el comando `namei` :

    ```bash
    sudo -u nri-agent namei -ml /var/log/restrictedLogs/logFile.log
    [output] f: /var/log/restrictedLogs/logFile.log
    [output] drwxr-xr-x root root /
    [output] drwxr-xr-x root root var
    [output] drwxrwxr-x root syslog log
    [output] drwxr--r-- root root restrictedLogs
    [output] logFile.log - No such file or directory
    ```

    Este comando falló porque el archivo no es visible para el usuario `nri-agent` . Al inspeccionar el resultado anterior, podemos detectar que al directorio `restrictedLogs` le falta el indicador de ejecución para `others`.

    Para solucionar este problema, ejecute:

    ```bash
    sudo chmod 755 /var/log/restrictedLogs
    ```

    Y luego verifique nuevamente el acceso al archivo:

    ```bash
    sudo -u nri-agent namei -ml /var/log/restrictedLogs/logFile.log
    [output] f: /var/log/restrictedLogs/logFile.log
    [output] drwxr-xr-x root root /
    [output] drwxr-xr-x root root var
    [output] drwxrwxr-x root syslog log
    [output] drwxr-xr-x root root restrictedLogs
    [output] -rw-r----- vagrant vagrant logFile.log
    ```

    El archivo ahora es visible para el usuario `nri-agent` . Debe asegurarse de que el archivo también sea legible por el usuario `nri-agent` . Para comprobar esto, utilice:

    ```bash
    sudo -u nri-agent head /var/log/restrictedLogs/logFile.log
    [output] head: cannot open '/var/log/restrictedLogs/logFile.log' for reading: Permission denied
    ```

    En este ejemplo, al archivo le faltan los derechos de lectura para el grupo `others` (usuario distinto de `vagrant` y el grupo de usuarios `vagrant` ). Puede solucionar este problema otorgando permisos de lectura a `others`, pero la aplicación podría cambiar estos permisos al reiniciar.

    Para evitar esto, un mejor enfoque es agregar el usuario `nri-agent` al grupo de usuarios `vagrant` .
  </Collapser>

  <Collapser className="freq-link" id="syslog" title="No aparecen datos al capturar a través de un socket Syslog">
    La característica de reenvío de logs requiere que el agente tenga permiso para leer las fuentes de datos. Al ejecutar el agente de infraestructura en [modos privilegiados o no privilegiados](/docs/infrastructure/install-configure-infrastructure/linux-installation/linux-agent-running-modes):

    * Si está utilizando archivos de socket de dominio Unix, asegúrese de que el usuario `nri-agent` pueda acceder a estos archivos (consulte la sección anterior) y que tenga permisos de lectura y escritura (`666`) para que otros usuarios además de `nri-agent` puede escribirles.

    * Si está utilizando sockets IP, asegúrese de que el puerto que está utilizando no sea uno reservado para el sistema (como el puerto `80`, por ejemplo).

      Si no aparecen datos después de habilitar la administración de logs, siga [los procedimientos estándar de administración de logs y resolución de problemas](/docs/logs/new-relic-logs/troubleshooting/no-data-appears-logs).
  </Collapser>

  <Collapser className="freq-link" id="proxy" title="No aparecen datos usando el proxy del agente de infraestructura">
    Como se explica en las [pautas de configuración del agente de infraestructura](/docs/infrastructure/install-infrastructure-agent/configuration/infrastructure-agent-configuration-settings#proxy), el parámetro `proxy` debe usar HTTP o HTTPS y tener el formato `https://user:password@hostname:port`. El agente puede analizar el parámetro sin HTTP o HTTPS, pero el reenviador de logs no puede. Verá un error como el siguiente en el log detallado del agente:

    ```
    [ERROR] building HTTP transport: parse \"hostname:port\":
    first path segment in URL cannot contain colon
    ```

    Para resolver este problema, verifique su archivo `newrelic-infra.yml` y asegúrese de que el parámetro `proxy` se ajuste a este formulario.

    Si está utilizando `caBundleFile` o `caBundleDir` para especificar cualquier certificado, le recomendamos seguir las siguientes reglas para cada sistema operativo:

    <DNT>
      **Linux**
    </DNT>

    Para `HTTP` servidores proxy no es necesario configurar ningún certificado. El complemento carga los certificados del sistema y New Relic envía el log al extremo de logging. Sin embargo, puede especificar el certificado autofirmado del proxy (archivo PEM) utilizando el parámetro `caBundleFile` o `caBundleDir` .

    <DNT>
      **Windows**
    </DNT>

    * Para `HTTP` servidores proxy no es necesario configurar ningún certificado. El complemento carga los certificados del sistema.

    * Para `HTTPS`, puede configurarlo de una de las siguientes maneras:

      * (Recomendado) Importe el certificado de proxy al grupo del sistema. Importe el certificado autofirmado del proxy (archivo PEM) mediante la herramienta MMC. Consulte [este enlace](https://www.ssls.com/knowledgebase/how-to-import-intermediate-and-root-certificates-via-mmc/) y en <DNT>**Step 2**</DNT> asegúrese de importarlo en su `Trusted Root Certification Authorities` en lugar de en el `Intermediate Certification Authorities`.

      * Utilice el parámetro `caBundleFile` y `caBundleDir` En Windows, no podemos cargar tanto los certificados del grupo de certificados del sistema como los especificados con el parámetro `caBundleFile` `caBundleDir` . Por lo tanto, si está utilizando `caBundleFile` o `caBundleDir`, asegúrese de que los siguientes certificados estén ubicados en el mismo archivo PEM (cuando use `caBundleFile`) o en el mismo directorio (cuando use `caBundleDir`):

    * El certificado de proxy (porque es un proxy `HTTPS` .

    * El certificado de extremo maderero (ej. `https://log-api.newrelic.com/log/v1`).

    * El certificado de agente de infraestructura (p. ej. `https://infra-api.newrelic.com`).

      Puede verificar los certificados ejecutando:

      ```bash
      openssl s_client -connect log-api.newrelic.com:443 -servername log-api.newrelic.com
      ```
  </Collapser>

  <Collapser className="freq-link" id="agent-logs" title="Envío del log del agente de infraestructura a New Relic">
    Puede configurar el agente de infraestructura para que envíe su propio log a New Relic. Esto es útil para resolver problemas con el reenvío de logs, el agente o al contactar [al soporte](https://support.newrelic.com/).

    <Callout variant="important">
      El logging de trazas genera una gran cantidad de datos muy rápidamente. Para reducir el consumo de espacio en disco y la ingesta de datos, cuando termine de generar el log, asegúrese de configurar `level: info` (o menos).
    </Callout>

    Para reenviar el log del agente de infraestructura a New Relic:

    1. Edite su archivo `newrelic-infra.yml` .

    2. Habilite el reenvío de logs a New Relic agregando el siguiente fragmento de configuración:

       ```yml
       log:
         level: trace  # Recommended: Helps with troubleshooting
         forward: true # Enables sending logs to New Relic
         format: json  # Recommended: Enable agent logging in JSON format
         stdout: false # On Windows and systems that don't use `systemd` or where `journald` is inaccessible
       ```

    3. [Reinicie el agente](/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status) para cargar la nueva configuración.

       Esta configuración configura el agente en modo de resolución de problemas, pero el reenviador de logs (basado en [Fluent Bit](https://fluentbit.io/)) continuará en un modo no detallado.
  </Collapser>

  <Collapser className="freq-link" id="fluentbit-logs" title="Habilitar el modo detallado en el reenviador de logs (Fluent Bit)">
    A veces puedes tener problemas con el propio reenviador de logs. Por ejemplo, puede haber problemas para acceder a un canal específico al enviar el log de eventos de Windows o al acceder a un archivo de log en particular. En estas situaciones, también puede habilitar el modo detallado para el reenviador de logs.

    <Callout variant="important">
      El logging de trazas genera una gran cantidad de datos muy rápidamente. Para reducir el consumo de espacio en disco y la ingesta de datos, cuando termine de generar el log, asegúrese de configurar `level: info` (o menos).
    </Callout>

    1. Edite su archivo `newrelic-infra.yml` .
    2. Habilite el log detallado de Fluent Bit agregando el siguiente fragmento de configuración:
       ```yml
       log:
         level: trace
         forward: true # Enables sending logs to New Relic
         format: json  # Recommended: Enable agent logging in JSON format
         stdout: false # On Windows and systems that don't use `systemd` or where `journald` is inaccessible
         include_filters:
           traces:
             - supervisor # Required to see verbose logs from Fluent Bit
       ```
    3. [Reinicie el agente](/docs/infrastructure/new-relic-infrastructure/configuration/start-stop-restart-check-infrastructure-agent-status) para cargar la nueva configuración.
  </Collapser>

  <Collapser className="freq-link" id="no-fb" title="Fluent Bit no comienza con el agente de infraestructura">
    <Callout variant="important">
      El complemento final de Fluent Bit no admite unidades de red.
    </Callout>

    Para versiones de Linux anteriores a 2016, es posible que deba actualizar la biblioteca OpenSSL a 1.1.0 (o mas alto). Para comprobar si tienes este problema:

    1. Vea si `infra-agent` ha iniciado Fluent Bit ejecutando:

       ```bash
       ps -aux | grep fluent-bit
       ```

    2. Si no se está ejecutando, vaya a `/var/db/newrelic-infra/newrelic-integrations/logging` y ejecute:

       ```bash
       ./fluent-bit -i systemd -o stdout
       ```

    3. Si recibe el siguiente error:

       ```
       error while loading shared libraries: libssl.so.1.1: cannot open shared object file: No such file or directory
       ```

       Asegúrese de actualizar OpenSSL a 1.1.0 o mas alto.
  </Collapser>

  <Collapser className="freq-link" id="windows-runtime-error" title="Error de tiempo de ejecución en Windows">
    Puede aparecer uno de los siguientes mensajes de error al habilitar el reenvío de logs en Windows:

    ```
    The code execution cannot proceed because VCRUNTIME140.dll was not found.
    ```

    O

    ```
    error="exit status 3221225781" process=log-forwarder
    ```

    Esto se debe a que falta una DLL.

    Para resolver el problema, instale [Microsoft Visual C++ Redistributable](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads) según corresponda:

    * [x64](https://aka.ms/vs/16/release/vc_redist.x64.exe)
    * [x86](https://aka.ms/vs/16/release/vc_redist.x86.exe)
  </Collapser>

  <Collapser className="freq-link" id="too-many-files" title="Errores al seguir una gran cantidad de archivo de log (Linux)">
    Es común encontrarse con uno de los siguientes mensajes de error al intentar rastrear una gran cantidad de archivos:

    * `Too many open files`
    * `The user limit on the total number of inotify watches was reached or the kernel failed to allocate a needed resource`

    El sistema operativo define una cantidad máxima de descriptores de archivos asignables (normalmente 1024 de forma predeterminada) y una cantidad máxima de relojes inotify asignables (normalmente 8192 de forma predeterminada). Cualquier proceso que intente superar estos límites fallará y devolverá uno de los errores anteriores.

    La tecnología subyacente que utilizamos para reenviar logs, [Fluent Bit](https://fluentbit.io/), abre un descriptor de archivo y establece una vigilancia de notificación para cada archivo que configure para ser reenviado. Además, al momento de escribir esta sección, Fluent Bit utiliza un conjunto adicional de 32 descriptores de archivos para su funcionamiento normal, con otro descriptor de archivos adicional cuando se apaga. Por lo tanto, <DNT>**to capture a large amount of files you need to ensure that both the file descriptor and inotify watch limits are slightly greater than the amount of log files you wish to tail**</DNT>.

    Las siguientes instrucciones resumen cómo aumentar estos límites si desea seguir 10,000 archivos de log. Además, se supone que el agente de infraestructura está instalado en [modo de ejecución](/docs/infrastructure/install-infrastructure-agent/linux-installation/linux-agent-running-modes/) `root` y, por lo tanto, debe ejecutarse con el usuario `root` .

    1. Compruebe cuál es el límite estricto actual para la cantidad de descriptores de archivos por proceso. Normalmente, este límite debería ser bastante alto y no debería ser necesario modificarlo.

       ```bash
       ulimit -Hn
       ```

    2. Agregue la siguiente línea a `/etc/security/limits.conf`. Aquí especificamos un límite de `10100` en lugar de solo `10000` para permitir que Fluent Bit asigne los descriptores de archivos adicionales que pueda necesitar para funcionar.

       ```bash
       root soft nofile 10100 # replace root by nri-agent for non-root (privileged and unprivileged) installations
       ```

    3. Agregue la siguiente línea a `/etc/pam.d/common-session` para que el límite anterior se aplique al reiniciar:

       ```bash
       session required pam_limits.so
       ```

    4. Agregue la siguiente línea a `/etc/sysctl.conf` para aumentar la cantidad de observadores de inotify permitidos por usuario. Aquí especificamos un límite de `18192` en lugar de solo `10000` para que el usuario `root` aún tenga `8192` relojes inotify disponibles (el valor predeterminado).

       ```bash
       fs.inotify.max_user_watches=18192
       ```

    5. Reinicie su sistema.

    6. Asegúrese de que los nuevos límites se hayan aplicado ejecutando:

       ```bash
       ulimit -Sn                                 # Should return 10100
       cat /proc/sys/fs/inotify/max_user_watches  # Should return 18192
       ```

       [Obtenga más información sobre cómo aumentar los límites de archivos abiertos](https://tecadmin.net/increase-open-files-limit-ubuntu/) o [cómo aumentar los relojes inotify](https://dev.to/rubiin/ubuntu-increase-inotify-watcher-file-watch-limit-kf4).
  </Collapser>

  <Collapser className="freq-link" id="install-fb-version" title="Instale la última versión de Fluent Bit (Linux)">
    Antes de la versión [1.19.0](/docs/release-notes/infrastructure-release-notes/infrastructure-agent-release-notes/new-relic-infrastructure-agent-1190) (o la versión [1.20.3](/docs/release-notes/infrastructure-release-notes/infrastructure-agent-release-notes/new-relic-infrastructure-agent-1203) para SLES 12.5), el agente de infraestructura de Linux venía incluido con un binario Fluent Bit. A partir de esta versión, Fluent Bit ahora se incluye como una dependencia de paquete `recommended` separada.

    Esto significa que puede instalar, actualizar o degradar Fluent Bit por separado del agente. Para tu comodidad, hemos incluido varios paquetes de Fluent Bit en el mismo repositorio donde reside la infraestructura, por lo que no necesitas instalar ningún repositorio adicional para actualizar Fluent Bit.

    Tenga en cuenta que el agente instala Fluent Bit automáticamente cuando lo instala por primera vez, utilizando la última versión disponible. Después de la primera instalación, puedes actualizar Fluent Bit como lo harías normalmente con cualquier paquete de Linux.

    Puede enumerar las versiones de Fluent Bit disponibles ejecutando:

    RPM:

    ```bash
    sudo yum check-update
    yum list fluent-bit --showduplicates
    ```

    DEBUTANTE:

    ```bash
    sudo apt update
    apt-cache showpkg fluent-bit
    ```

    Para actualizar a la última versión de Fluent Bit, ejecute estos comandos:

    RPM:

    ```bash
    # Remove command only required when downgrading to a previous version
    # sudo yum remove fluent-bit
    sudo yum install fluent-bit
    ```

    DEBUTANTE:

    ```bash
    sudo apt install fluent-bit
    ```
  </Collapser>

  <Collapser className="freq-link" id="rollback-after-fluent-bit-2" title="Revertir a fluent-bit 1.x después del agente de infraestructura 1.42.0 en Linux">
    Tenga en cuenta que td-agente-bit no está disponible para las siguientes distribuciones, por lo que no es posible realizar reversiones en ellas:

    * CentOS 9 Stream (incluidos Rocky Linux y AlmaLinux)
    * RedHat 9
    * Ubuntu 22.04.x
    * Uso abierto (SLES) 15.4
    * Amazon Linux 2023

    Si desea volver a td-agente-bit, puede seguir los pasos que se describen a continuación:

    1. Abra el archivo `/etc/newrelic-infra.yml` usando su editor de texto preferido.
    2. Agregue la siguiente línea al final del archivo: `fluent_bit_exe_path: /opt/td-agent-bit/bin/td-agent-bit`.
    3. Guarde los cambios.
    4. Reinicie el agente de infraestructura ejecutando el siguiente comando: `sudo systemctl restart newrelic-infra`.

    Al completar estos pasos, el agente de infraestructura se configurará para usar td-agente-bit en lugar de fluent-bit.
  </Collapser>
</CollapserGroup>

## ¿Que sigue? [#what-next]

Explore los datos de logging en su plataforma con nuestra [UI de logs](/docs/logs/log-management/ui-data/use-logs-ui/).

* Obtenga una visibilidad más profunda de los datos de rendimiento de su aplicación y de su plataforma reenviando su log con nuestras capacidades [de logs en el contexto](/docs/logs/enable-log-management-new-relic/configure-logs-context/configure-logs-context-apm-agents/) .
* Configurar [alerta](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-alert-conditions/).
* [Consulta tus datos](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) y [crea un dashboard](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/).

## Desactivar reenvío de logs [#uninstall]

Para deshabilitar las capacidades de reenvío de log , vaya a su directorio `logging.d` y elimine los archivos con la extensión `.yml` que se agregaron originalmente durante el proceso [de configuración](#step-1-configure-the-infrastructure-agent) .

* Linux: `/etc/newrelic-infra/logging.d/`
* Ventanas: `C:\Program Files\New Relic\newrelic-infra\logging.d\`
