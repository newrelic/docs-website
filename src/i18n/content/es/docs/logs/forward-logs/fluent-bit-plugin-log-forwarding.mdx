---
title: Complemento Fluent Bit para reenvío de logs
tags:
  - Logs
  - Enable log management in New Relic
  - Enable log monitoring in New Relic
metaDescription: 'Install and configure the New Relic logging plugin for Fluent Bit, so you can use enhanced log management capabilities.'
freshnessValidatedDate: never
translationType: machine
---

Si log [Fluent Bit](https://fluentbit.io/) ya está monitoreando sus datos , puede usar nuestro complemento de salida Fluent Bit para reenviar y enriquecer sus log datos en New Relic.

Reenviar su log de Fluent Bit a New Relic le brindará <InlinePopover type="logs"/>capacidades mejoradas para recopilar, procesar, explorar, consultar y alertar sobre sus datos log .

## Proceso básico [#compatibility-requirements]

Hemos publicado un contenedor con el complemento instalado. Sirve como imagen base para nuestra integración de Kubernetes. Le recomendamos que utilice esta imagen base y superponga sus propios archivos de configuración personalizados.

Para reenviar su log de Fluent Bit a New Relic:

1. Asegúrate de tener:

   * Una New Relic

     <InlinePopover type="licenseKey"/>

   * Fluent Bit 1.0 o superior (recomendado), aunque se admite v0.12 o superior

   * Las instrucciones de instalación de Fluent Bit Windows se pueden encontrar [aquí](https://docs.fluentbit.io/manual/installation/windows)

   * Las instrucciones de instalación de Fluent Bit Linux se pueden encontrar [aquí](https://docs.fluentbit.io/manual/installation/linux)

2. [Instale](#fluentbit-plugin) el complemento Fluent Bit.

3. [Configure](#configure-plugin) el complemento Fluent Bit.

4. [Pruebe](#test-plugin) el complemento Fluent Bit.

5. Genere algo de tráfico y espere unos minutos, luego [verifique los datos de su cuenta](#find-data) .

## Instale el complemento Fluent Bit [#fluentbit-plugin]

Para instalar el complemento Fluent Bit:

1. Navegue hasta New Relic el [repositorio del complemento Fluent Bit de en GitHub.](https://github.com/newrelic/newrelic-fluent-bit-output) 2. Desde la página del repositorio, [clone o descargue el repositorio](https://help.github.com/en/articles/cloning-a-repository). 3. Ejecute el siguiente comando para crear su complemento:

   ```sh
   cd newrelic-fluent-bit-output && make all
   ```

2. Almacene `out_newrelic.so` o `out_newrelic_winXX.dll` en una ubicación a la que pueda acceder el daemon `fluent-bit`.

<Callout variant="tip">
  Si prefiere no compilar el complemento usted mismo, puede descargar versiones precompiladas desde [la página de lanzamientos de nuestro repositorio de GitHub](https://github.com/newrelic/newrelic-fluent-bit-output/releases).
</Callout>

## Actualice el complemento Fluent Bit [#upgrade-plugin]

Antes de actualizar su complemento Fluent Bit, ejecute la siguiente consulta NRQL para encontrar las versiones actuales del complemento de salida que se emplea en su sistema:

```sql
    FROM K8sContainerSample 
    SELECT latest(containerImage) 
    WHERE podName like '%newrelic-logging%' 
    FACET clusterName
```

<Callout variant="caution">
  Las versiones 1.16.0 a 1.19.2 del complemento de salida Fluent Bit se ven afectadas por una [vulnerabilidad de seguridad (CVE-2024-4323)](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4323). Si está empleando una de estas versiones, actualice a la versión 2.0.0 o superior. Para obtener más información al respecto, consulte nuestro [boletín de seguridad NR24-01 - Fluent Bit](/docs/security/new-relic-security/security-bulletins/security-bulletin-nr24-01/).
</Callout>

Para actualizar, siga las [instrucciones de instalación](#fluentbit-plugin) u obtenga la última versión precompilada de nuestro [repositorio de GitHub](https://github.com/newrelic/newrelic-fluent-bit-output/releases).

## Instalar el complemento de salida Fluent Bit [#fluent-bit]

New Relic tiene un [complemento de](https://fluentbit.io/) [salida Fluent](https://github.com/newrelic/newrelic-fluent-bit-output) Bit para reenviar su registro a New Relic la administración de logde . Este complemento también se proporciona en una imagen docker independiente que se puede instalar en un clúster de Kubernetes en forma de DaemonSet, también conocido como complemento Kubernetes .

Puede instalarlo en su clúster empleando nuestro gráfico Helm de dos maneras.

### Emplee nuestra instalación guiada [#helm-guided-install]

Aunque el gráfico [de registro de nuevas reliquias](https://github.com/newrelic/helm-charts/tree/master/charts/newrelic-logging) funciona de forma independiente, recomendamos instalarlo como parte del gráfico [del paquete nri](https://github.com/newrelic/helm-charts/tree/master/charts/nri-bundle) .

La mejor manera de instalarlo es a través de nuestro proceso [de instalación guiado](/docs/kubernetes-pixie/kubernetes-integration/installation/kubernetes-integration-install-configure/) . Esta instalación guiada puede generar los comandos de Helm 3 necesarios para instalarlo ([consulte "Helm 3"](/docs/kubernetes-pixie/kubernetes-integration/installation/kubernetes-integration-install-configure/#finish-your-install)).

### Instalación manual [#manual-helm-install]

Alternativamente, puedes instalarlo manualmente usando Helm, ejecutando este comando para instalar el repositorio:

```bash
    helm repo add newrelic https://helm-charts.newrelic.com
```

Para actualizar el repositorio puedes ejecutar:

```bash
    helm repo update newrelic
```

Vaya aquí para obtener [instrucciones de desinstalación](/docs/kubernetes-pixie/kubernetes-integration/uninstall-kubernetes/).

## Configurar el complemento Fluent Bit [#configure-plugin]

Fluent Bit necesita conocer la ubicación del complemento New Relic y New Relic <InlinePopover type="licenseKey"/>para enviar datos a New Relic. Para configurar su complemento Fluent Bit:

<Callout variant="important">
  Preste atención a los espacios en blanco al editar sus archivos de configuración. Asegúrese de utilizar cuatro espacios para sangrar y un espacio entre claves y valores.
</Callout>

1. Localice o cree un archivo `plugins.conf` en su directorio de complementos.

2. En el archivo `plugins.conf` , agregue una referencia a `out_newrelic.so`, junto a su archivo `fluent-bit.conf` :

   ```ini
   [PLUGINS]
       Path /PATH/TO/newrelic-fluent-bit-output/out_newrelic.so
   ```

3. En el archivo `fluent-bit.conf` , agregue la siguiente línea debajo del bloque `service` :

   ```ini
   [SERVICE]
       # This is the main configuration block for fluent bit.
       # Ensure the follow line exists somewhere in the SERVICE block
       Plugins_File plugins.conf
   ```

4. En la parte inferior del archivo `fluent-bit.conf` , agregue lo siguiente para configurar las secciones de entrada, filtro y salida. Reemplace el texto del marcador de posición con su <InlinePopover type="licenseKey"/>:

   ```ini
   [INPUT]
       Name tail
       Tag  my.tag
       Path /PATH/TO/YOUR/LOG/FILE
       
   # If you have multiple sources, just add another [INPUT] section like this:
   [INPUT] 
       Name tail 
       Tag  my.other.tag 
       Path /PATH/TO/SOME/OTHER/LOG/FILE 

   # Having multiple [FILTER] blocks allows you to control the flow of changes as they read top down. 
   [FILTER]
       Name modify
       # Here we only match on one tag, my.tag, defined in the [INPUT] section earlier
       Match  my.tag
       # Below, we're renaming the host.cpu attribute to CPU
       Rename host.cpu CPU

   [FILTER]
       Name   record_modifier
       # Match on all tags, *, so all logs get decorated per the Record clauses below. Record adds attributes + their values to each record.
       Match  *
       # Adding a logtype attribute ensures your logs will be automatically parsed by our built-in parsing rules
       Record logtype nginx
       # Add the server's hostname to all logs generated
       Record hostname ${HOSTNAME}

   [OUTPUT]
       Name       newrelic
       Match      *
       licenseKey YOUR_LICENSE_KEY
   ```

5. Reinicie su instancia de Fluent Bit con el siguiente comando:

   ```sh
   fluent-bit -c /PATH/TO/fluent-bit.conf
   ```

<InstallFeedback/>

## Pruebe el complemento Fluent Bit [#test-plugin]

Para probar si su complemento Fluent Bit está recibiendo información de un archivo de log:

1. Ejecute el siguiente comando para agregar un mensaje de log de prueba a su archivo de log:

   ```sh
   echo "test message" >> /PATH/TO/YOUR/LOG/FILE
   ```

2. Busque en nuestra [UI de logs](https://one.newrelic.com/launcher/logger.log-launcher) `test message`.

Para obtener más opciones, consulte la [documentación del filtro de modificación de Fluent Bit](https://docs.fluentbit.io/manual/pipeline/filters/modify) y nuestra documentación para [reenviar sus logs utilizando el agente de infraestructura](/docs/logs/enable-log-management-new-relic/enable-log-monitoring-new-relic/forward-your-logs-using-infrastructure-agent/#automatically-inserted-attributes).

## Opcional: configurar el atributo del complemento [#instrument-plugin]

Una vez que haya [instalado](#fluentbit-plugin) y [configurado](#configure-plugin) el complemento Fluent Bit, puede usar el siguiente atributo para configurar cómo el complemento envía datos a New Relic:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Llave
      </th>

      <th>
        Descripción
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `licenseKey`
      </td>

      <td>
        El <InlinePopover type="licenseKey"/>. Utilice `licenseKey` (<DNT>**recommended**</DNT>) o `apiKey`, no ambos. Por defecto: `none`
      </td>
    </tr>

    <tr>
      <td>
        `maxBufferSize`
      </td>

      <td>
        El tamaño máximo que envió la carga, en bytes. Por defecto: `256000`
      </td>
    </tr>

    <tr>
      <td>
        `maxRecords`
      </td>

      <td>
        El número máximo de registros para enviar a la vez. Por defecto: `1024`
      </td>
    </tr>

    <tr>
      <td>
        `apiKey`
      </td>

      <td>
        <DNT>**Deprecated.**</DNT> Se necesita una [clave de inserción de Insights](/docs/insights/insights-data-sources/custom-data/send-custom-events-event-api#register) de New Relic, pero se prefiere usar el atributo `licenseKey` . Utilice `licenseKey` o `apiKey`, no ambos.
      </td>
    </tr>

    <tr>
      <td>
        `endpoint`
      </td>

      <td>
        El valor predeterminado es `https://log-api.newrelic.com/log/v1` : si el uso de una clave UE debe configurar en `https://log-api.eu.newrelic.com/log/v1`
      </td>
    </tr>
  </tbody>
</table>

## Ver datos log [#find-data]

Si todo está configurado correctamente y se están recopilando sus datos, debería ver los datos log en ambos lugares:

* Nuestra [UI de logs](https://one.newrelic.com/launcher/logger.log-launcher)
* Nuestras herramientas para ejecutar [NRQL consulta](/docs/chart-builder/use-chart-builder/choose-data/use-advanced-nrql-mode-specify-data). Por ejemplo, puedes ejecutar una consulta como esta:

```sql
SELECT * FROM Log
```

Si no aparecen datos después de habilitar nuestras capacidades de administración de logs, siga nuestros [procedimientos estándar de resolución de problemas de logs](/docs/logs/log-management/troubleshooting/no-log-data-appears-ui/).

## ¿Que sigue? [#what-next]

Explore los datos de logging en su plataforma con nuestra [UI de logs](/docs/logs/log-management/ui-data/use-logs-ui).

* Obtenga una visibilidad más profunda de los datos de rendimiento de su aplicación y de su plataforma reenviando su log con nuestras capacidades [de logs en el contexto](/docs/logs/enable-log-management-new-relic/configure-logs-context/configure-logs-context-apm-agents/) .
* Configurar [alerta](/docs/alerts-applied-intelligence/new-relic-alerts/alert-conditions/create-alert-conditions/).
* [Consulta tus datos](/docs/query-your-data/explore-query-data/get-started/introduction-querying-new-relic-data/) y [crea un panel](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/).

## Desactivar reenvío de logs [#disable]

Para deshabilitar las capacidades de reenvío de logs, siga los procedimientos estándar en [la documentación de Fluent Bit](https://fluentbit.io/). No necesitas hacer nada más en New Relic.
