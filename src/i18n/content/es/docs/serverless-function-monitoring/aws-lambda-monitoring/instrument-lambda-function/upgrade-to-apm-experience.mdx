---
title: Actualice a la experiencia APM
metaDescription: Learn how to upgrade your Lambda monitoring to the New Relic APM experience.
freshnessValidatedDate: never
translationType: machine
---

Puede actualizar sus funciones Lambda existentes a la nueva experiencia de monitoreo unificada con el mínimo esfuerzo. Esta transición le permite monitorear sus funciones Lambda con capacidades de observabilidad mejoradas de New Relic. Puede instrumentar todas sus funciones Lambda existentes de forma masiva, o puede optar por actualizarlas de una en una. El proceso de actualización no es intrusivo y no requiere ningún cambio de código en sus funciones existentes.

**Requisitos previos**

* Sus funciones Lambda ya están instrumentadas en New Relic.
* Sus funciones Lambda se ejecutan en el entorno de ejecución `python`, `nodejs`, `ruby`, `go` o `.NET`. Para ver la lista de versiones compatibles de estos entornos de ejecución, consulte los [documentos de compatibilidad y requisitos](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/compatibility-requirement-lambda-monitoring/).

## Métodos de instrumentación

Puede actualizar sus funciones Lambda existentes utilizando uno de los siguientes métodos:

* [New Relic UI](#ui)
* [Actualizar usando CLIs](#cli)

<Callout variant="tip">
  New Relic recomienda integrar su cuenta AWS con New Relic usando la [integraciónAWS ](/docs/infrastructure/amazon-integrations/get-started/introduction-aws-integrations/)para descubrir y monitorear automáticamente su función Lambda. Esto le permite aprovechar todo el poder de New Relic APM para su función sin servidor.
</Callout>

#### New Relic UI [#ui]

Puede actualizar sus funciones Lambda existentes utilizando la interfaz de usuario de New Relic.

**Para actualizar sus funciones Lambda existentes desde la plataforma New Relic, siga estos pasos:**

1. Vaya a [one.newrelic.com &gt; All capabilities &gt; Serverless Functions](https://one.newrelic.com/nr1-core?state=23b04845-da13-2b11-5826-9c20326276d9) &gt; seleccione su entidad de función Lambda.
2. En la página Summary, haga clic en **Instrument for APM**.
3. En la página Función Lambda para APM, proporcione la clave de API y luego haga clic en **Continue**.
4. De forma predeterminada, la entidad Lambda actual está seleccionada para la actualización. También puede seleccionar otras funciones Lambda para actualizar. Haga clic en **Generate New Relic CLI command**.
5. Copie el comando y ejecútelo en su terminal o en su terminal de AWS. El comando instalará la capa Lambda de New Relic en las funciones seleccionadas.
6. Haga clic en **Continue** para probar la instalación. La prueba verificará si la capa Lambda de New Relic está instalada correctamente y si la función está enviando datos a New Relic.
7. Si la prueba es exitosa, verá un mensaje de éxito. Para ver su función Lambda en la interfaz APM de New Relic, haga clic en **See your data in APM**.

#### Actualizar usando CLIs [#cli]

<CollapserGroup>
  <Collapser id="nr-cli" title="New Relic">
    <Callout variant="important">
      Asegúrese de que su versión de la CLI de New Relic sea `0.9.8` o posterior. Puede verificar la versión de su CLI ejecutando `newrelic-lambda --version`. Si necesita actualizar su CLI, actualice la CLI. Por ejemplo, si instaló la CLI usando `pip3`, puede actualizarla con el siguiente comando:

      ```bash
          pip3 install --upgrade newrelic-lambda
      ```
    </Callout>

    1. Para actualizar su función Lambda, use la guía de inicio rápido de la CLI `newrelic-lambda` como se muestra aquí.

       ```bash
       newrelic-lambda layers install --nr-account-id YOUR_NEW_RELIC_ACCOUNT_ID --function my-function --upgrade --apm
       ```

       <Callout variant="tip">
         Este comando encuentra automáticamente la capa más nueva disponible para la región y el tiempo de ejecución de Lambda.
       </Callout>

    2. Para migrar alertas de sus funciones Lambda existentes a APM, ejecute el siguiente comando:

       ```bash
       newrelic-lambda apm alerts-migrate \
           --nr-account-id <YOUR_NEW_RELIC_ACCOUNT_ID> \
           --nr-api-key <YOUR_NEW_RELIC_API_KEY>
           --function <YOUR_LAMBDA_FUNCTION_NAME>
       ```
  </Collapser>

  <Collapser id="cdk" title="Para AWS CDK, AWS SAM o Terraform">
    1. Actualice a la [última capa de New Relic Lambda](https://layers.newrelic-external.com/) para su proyecto usando [AWS CDK](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cdk), [AWS SAM](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#cloudformation) o [Terraform](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/instrument-your-own/#terraform).
    2. Establezca la `NEW_RELIC_APM_LAMBDA_MODE` [variable de entorno](/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/env-variables-lambda/) en `true` en la configuración de su función Lambda. Esto habilita el modo APM para la capa Lambda de New Relic.
    3. Despliega tu función Lambda con la configuración actualizada.
    4. En la pestaña <DNT>Configuration</DNT> de su <DNT>AWS Management Console</DNT>, agregue la etiqueta `NR.Apm.Lambda.Mode: true` a su función Lambda.
    5. Si no está utilizando una [integración de nube de AWS](/docs/infrastructure/amazon-integrations/get-started/introduction-aws-integrations/) (Metric Stream o sondeo de API) para sincronizar etiquetas de CloudWatch, establezca la variable de entorno `NR_TAGS` en `NR.Apm.Lambda.Mode:true`. Esto permite a la extensión Lambda de New Relic enviar los metadatos requeridos directamente a New Relic.
  </Collapser>
</CollapserGroup>

## Actualizar alertas y paneles existentes de Lambda [#alerts-dashboards]

Después de actualizar sus funciones Lambda existentes a `APM + Serverless Convergence`, es crucial actualizar las consultas NRQL en las condiciones de alerta y los widgets del panel. Esta nueva actualización cambia las rutas de métricas para sus datos de Lambda. Modificar sus consultas es necesario para garantizar que sus alertas y paneles usen estas nuevas rutas y continúen proporcionando monitoreo y notificaciones precisas. Esto es necesario para cualquier función Lambda existente que haya migrado a `APM + Serverless Convergence`.

* Para las alertas, revise las condiciones de alerta de Lambda existentes. Actualice cualquier consulta NRQL que use métricas provenientes de capas con las nuevas métricas. Para obtener más información sobre cómo actualizar las condiciones de alerta, consulte la [Actualización de una alerta](https://docs.newrelic.com/docs/alerts/create-alert/create-alert-condition/alert-conditions/#edit-existing-alert-condition).

* Para los paneles, revise los widgets de su panel de Lambda existentes. Actualice cualquier consulta NRQL que use métricas provenientes de capas con las nuevas métricas. Para obtener más información sobre cómo actualizar los widgets de su panel, consulte la [administrar el panel](https://docs.newrelic.com/docs/query-your-data/explore-query-data/dashboards/manage-your-dashboard/).

## Buscar y utilizar datos [#find-data]

Luego de instrumentar su función Lambda AWS, puede buscar y usar los datos en la interfaz New Relic APM. Los datos están organizados en varias áreas clave, cada una de las cuales proporciona información valiosa sobre el rendimiento y el estado de su función Lambda.

En la interfaz APM, puede explorar varios aspectos de su función Lambda, incluido [el rastreo distribuido](/docs/distributed-tracing/concepts/introduction-distributed-tracing/), [los mapas de servicios](/docs/new-relic-solutions/new-relic-one/ui-data/service-maps/service-maps/), [las transacciones](/docs/apm/transactions/intro-transactions/transactions-new-relic-apm/) y [el análisis de errores](/docs/errors-inbox/getting-started/), y muchos más. Cada una de estas áreas proporciona información detallada y valiosa sobre el rendimiento, la latencia y la tasa de errores de su función Lambda, lo que le permite identificar y resolver problemas rápidamente.

<Callout variant="tip">
  La experiencia de Invocación ahora está integrada con APM traza de la transacción. Esto le permite emplear un `AWS RequestId` específico para explorar en profundidad una traza de la transacción de APM para obtener información detallada sobre esa ejecución Lambda en individuo.
</Callout>

Para ver su función Lambda en la interfaz New Relic APM :

1. Vaya a <DNT>[https://one.newrelic.com](https://one.newrelic.com) &gt; APM &amp; Services</DNT>.
2. Establezca los criterios de búsqueda como `isLambdaFunction = true`.
3. De la lista mostrada, seleccione su función Lambda para ver los datos.

<Callout variant="tip">
  La interfaz de usuario de New Relic APM no muestra datos históricos para las funciones Lambda que se instrumentaron antes de la actualización `APM + Serverless Convergence`. Para ver los datos históricos, haga clic en la opción **see serverless functions** en la página <DNT>APM Summary</DNT>.
</Callout>

### Reversión [#rollback]

Si necesita revertir sus funciones Lambda a la experiencia de monitoreo sin servidor anterior, puede hacerlo configurando la variable de entorno `NEW_RELIC_APM_LAMBDA_MODE` en `false`.

## Artículos relacionados [#related-docs]

<DocTiles>
  <DocTile title="Compatibilidad y requisitos" path="/docs/serverless-function-monitoring/aws-lambda-monitoring/instrument-lambda-function/compatibility-requirement-lambda-monitoring">
    Obtenga más información sobre los entornos de ejecución compatibles y los requisitos previos
  </DocTile>

  <DocTile title="Resolución de problemas" path="/docs/serverless-function-monitoring/aws-lambda-monitoring/troubleshooting/troubleshoot-enabling-serverless-monitoring-aws-lambda">
    Aprenda a solucionar problemas relacionados con la instalación
  </DocTile>
</DocTiles>