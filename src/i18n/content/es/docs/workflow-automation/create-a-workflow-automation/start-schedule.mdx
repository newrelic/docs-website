---
title: Inicio y programación flujo de trabajo
tags:
  - workflow automation
  - workflow
  - start a workflow automation
  - start workflow automation on demand
  - schedule workflows
metaDescription: Trigger workflows manually or schedule them to run automatically at specified times using NerdGraph APIs.
freshnessValidatedDate: never
translationType: machine
---

<Callout title="avance">
  Todavía estamos trabajando en esta característica, ¡pero nos encantaría que la probaras!

  Esta característica se proporciona actualmente como parte de un programa de vista previa de conformidad con nuestras [políticas de prelanzamiento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Una vez que creó un flujo de trabajo, puede activarlo de tres maneras: mediante alertas, manualmente a pedido o según un cronograma.

## Elige tu método de activación

Seleccione el enfoque adecuado para su caso de uso:

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        **Desencadenante de alertas**
      </th>

      <th>
        **Desencadenante de alertas**
      </th>

      <th>
        **Ejecutar según lo previsto**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        Respuesta automatizada a incidencias
      </td>

      <td>
        Probando nuevo flujo de trabajo
      </td>

      <td>
        revisiones médicas periódicas
      </td>
    </tr>

    <tr>
      <td>
        Corrección automática (cambio de tamaño de EC2, reversión)
      </td>

      <td>
        Operaciones manuales
      </td>

      <td>
        Procesamiento periódico de datos
      </td>
    </tr>

    <tr>
      <td>
        Notificación de alerta enriquecida
      </td>

      <td>
        Mantenimiento ad hoc
      </td>

      <td>
        Reportes diarios o semanales
      </td>
    </tr>

    <tr>
      <td>
        **Configuración**: [Configurar como destino de alerta](/docs/workflow-automation/setup-and-configuration/create-destinations#trigger-from-alerts)
      </td>

      <td>
        **API**: [Iniciar flujo de trabajo Ejecutar](/docs/workflow-automation/workflow-automation-apis/start-workflow-run)
      </td>

      <td>
        **API**: [CreateSchedule](/docs/workflow-automation/workflow-automation-apis/create-schedule)
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="tip">
  Cuando se incumple la condición de alerta, New Relic puede activar automáticamente el flujo de trabajo configurando la automatización del flujo de trabajo como destino. Los `issueId` y `accountId` se pasan automáticamente. Consulte [Enviar notificación desde flujo de trabajo](/docs/workflow-automation/setup-and-configuration/create-destinations#trigger-from-alerts) para obtener instrucciones de configuración.
</Callout>

## Antes de que empieces

Antes de activar el flujo de trabajo, cerciorar de tener:

* **flujo de trabajo creado**: una definición de flujo de trabajo ya se implementa en su cuenta a partir de [una plantilla](/docs/workflow-automation/create-a-workflow-automation/use-a-template) o [personalizada](/docs/workflow-automation/create-a-workflow-automation/create-your-own).
* **ID de cuenta**: Su ID de cuenta de New Relic se puede encontrar en [Configuración de la cuenta](/docs/accounts/accounts-billing/account-structure/account-id).
* **Nombre de flujo de trabajo**: El nombre exacto de su definición de flujo de trabajo.
* **Datos de entrada requeridos**: Valores para cualquier parámetro que espere su flujo de trabajo.
* **Secretos configurados**: credenciales AWS, token de Slack u otros secretos almacenados en [el administrador de secretos](/docs/workflow-automation/limitations-and-faq/workflow-best-practices/#secure-credentials).

<Callout variant="tip">
  **¿Eres nuevo en el flujo de trabajo?** Crea tu primer flujo de trabajo antes de intentar activarlo. Comience con [Emplee una plantilla](/docs/workflow-automation/create-a-workflow-automation/use-a-template) para flujo de trabajo prediseñado.
</Callout>

## Ejecutar flujo de trabajo bajo demanda [#on-demand]

Activa el flujo de trabajo manualmente usando la [APIStartWorkflowRun](/docs/workflow-automation/workflow-automation-apis/start-workflow-run). Esto ejecuta el flujo de trabajo inmediatamente con los datos de entrada que proporcione.

### Ejemplo: invocar una función Lambda AWS

La siguiente definición de flujo de trabajo invoca una función Lambda AWS y registra la salida. Reemplace `12345678` con su ID de cuenta de New Relic.

```yaml
  name: lambda1

  workflowInputs:
    username:
      type: String
      defaultValue: "User"
    key:
      type: String
      defaultValue: "${{ :secrets:12345678:USERNAME_AWS_ACCESS_KEY_ID }}"
    access:
      type: String
      defaultValue: "${{ :secrets:12345678:USERNAME_AWS_SECRET_ACCESS_KEY }}"
    token:
      type: String
      defaultValue: "${{ :secrets:12345678:USERNAME_AWS_SESSION_TOKEN }}"
    region:
      type: String
      defaultValue: us-east-1

  steps:
    - name: invoke1
      type: action
      action: aws.lambda.invoke
      version: 1
      inputs:
        awsAccessKeyId: ${{ .workflowInputs.key }}
        awsSecretAccessKey: ${{ .workflowInputs.access }}
        awsSessionToken: ${{ .workflowInputs.token }}
        region: ${{ .workflowInputs.region }}
        functionName: hello-you
        payload:
          user: ${{ .workflowInputs.username }}

    - name: logOutput
      type: action
      action: newrelic.ingest.sendLogs
      version: 1
      inputs:
        logs:
          - message: 'The lambda function message output is:${{ .steps.invoke1.outputs.payload.body }}'
```

Para iniciar este flujo de trabajo, emplee la siguiente mutación de NerdGraph. Antes de ejecutar esta mutación, cerciorar de almacenar sus credenciales de AWS empleando la mutación `secretsManagementCreateSecret`. Para obtener más información, consulte [administrador de secretos](/docs/workflow-automation/limitations-and-faq/workflow-best-practices/#secure-credentials).

```yaml
  mutation {
    workflowAutomationStartWorkflowRun(
      # Specify the account where the workflow is defined
      scope: { type: ACCOUNT id: "12345678" }

      # Reference the workflow definition by name
      definition: { name: "lambda1" }

      # Provide input values for the workflow
      workflowInputs: [
        {key: "key" value: "${{ :secrets:testUser123_AWS_ACCESS_KEY_ID }}"}
        {key: "access" value: "${{ :secrets:testUser123_AWS_SECRET_ACCESS_KEY }}"}
        {key: "token" value: "${{ :secrets:testUser123_AWS_SESSION_TOKEN }}"}
        {key: "region" value:"us-east-2"}
        {key: "username" value: "Julien"}
      ]
    ) {
      runId
    }
  }
```

**Explicación del parámetro:**

* `scope`: El ID de la cuenta donde se almacena la definición de su flujo de trabajo
* `definition`: El nombre del flujo de trabajo a ejecutar (debe coincidir con el campo `name` de la definición de su flujo de trabajo).
* `workflowInputs`: pares de valores principales que anulan los valores predeterminados en la sección `workflowInputs` de su definición de flujo de trabajo

La mutación devuelve un `runId` (por ejemplo, `7bd25287-2af8-42e1-b783-80f4e760a40b`). Emplee este ID para consultar los logs y ver la salida:

<img title="Workflow automation logs" alt="Workflow automation logs showing the Lambda function output" src="/images/autoflow-all-logs-2.webp" />

## Horario de trabajo [#scheduled]

Programe flujos de trabajo para que se ejecuten automáticamente en momentos específicos utilizando la [API CreateSchedule](/docs/workflow-automation/workflow-automation-apis/create-schedule). Los flujos de trabajo programados ejecutan tareas recurrentes sin intervención manual.

**Cuándo programar el flujo de trabajo:**

* revisiones médicas periódicas
* Procesamiento periódico de datos
* Reportes diarios/semanales
* ventanas de mantenimiento programado
* Copias de seguridad o limpiezas recurrentes

### Referencia de expresión Cron

Los horarios usan expresiones cron para definir cuándo se ejecuta el flujo de trabajo. Formato: `minute hour day month weekday`

<table>
  <thead>
    <tr>
      <th style={{ width: "200px" }}>
        Patrón
      </th>

      <th>
        Descripción
      </th>

      <th>
        Ejemplo de caso de uso
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `0 9 * * *`
      </td>

      <td>
        Todos los días a las 9:00 AM
      </td>

      <td>
        controles de salud matutinos diarios
      </td>
    </tr>

    <tr>
      <td>
        `0 9 * * 1-5`
      </td>

      <td>
        Todos los días laborables a las 9:00 AM
      </td>

      <td>
        Operaciones del día comercial
      </td>
    </tr>

    <tr>
      <td>
        `0 */6 * * *`
      </td>

      <td>
        Cada 6 horas
      </td>

      <td>
        Operaciones de sincronización regulares
      </td>
    </tr>

    <tr>
      <td>
        `0 0 1 * *`
      </td>

      <td>
        Primer día del mes a medianoche
      </td>

      <td>
        Reportes mensuales
      </td>
    </tr>

    <tr>
      <td>
        `*/10 * * * *`
      </td>

      <td>
        Cada 10 minutos (intervalo mínimo)
      </td>

      <td>
        Encuestas frecuentes, controles de salud
      </td>
    </tr>

    <tr>
      <td>
        `0 0 * * 0`
      </td>

      <td>
        Todos los domingos a medianoche
      </td>

      <td>
        Tareas de limpieza semanales
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="important">
  **Intervalo mínimo de programación:** Los horarios deben estar separados por al menos 10 minutos. No puede programar el flujo de trabajo para que se ejecute con una frecuencia mayor a cada 10 minutos. Para intervalos de menos de 10 minutos, considere programar cada 10 minutos y emplear un [paso de espera](/docs/workflow-automation/workflow-automation-apis/definition-schema#wait) dentro de su flujo de trabajo. Consulte [los límites del flujo de trabajo](/docs/workflow-automation/limitations-and-faq/workflow-limits) para conocer todas las restricciones de programación.
</Callout>

<Callout variant="tip">
  **Sintaxis cron:** `*` significa `every`, `/` significa `every nth`, `-` significa `range`. Ejemplo: `0 9 * * 1-5 = At minute 0, hour 9, every day, every month, Monday through Friday`.
</Callout>

### Ejemplo: Programar un chequeo médico diario

El siguiente ejemplo programa el flujo de trabajo `lambda1` para que se ejecute todos los días a las 9 AM, hora del este:

```yaml
  mutation {
    workflowAutomationCreateSchedule(
      # Specify the account where the workflow is defined
      scope: { type: ACCOUNT id: "12345678" }

      # Reference the workflow definition by name
      definition: { name: "lambda1" }

      # Configure the schedule
      schedule: {
        # Cron expression: minute hour day month weekday
        # "0 9 * * *" = every day at 9:00 AM
        cronExpression: "0 9 * * *"

        # Timezone for the schedule
        timezone: "America/New_York"

        # Optional: Schedule name for identification
        name: "daily-lambda-health-check"

        # Optional: Add a description
        description: "Runs Lambda health check every morning at 9 AM"
      }

      # Provide input values for the workflow
      workflowInputs: [
        {key: "key" value: "${{ :secrets:testUser123_AWS_ACCESS_KEY_ID }}"}
        {key: "access" value: "${{ :secrets:testUser123_AWS_SECRET_ACCESS_KEY }}"}
        {key: "token" value: "${{ :secrets:testUser123_AWS_SESSION_TOKEN }}"}
        {key: "region" value:"us-east-2"}
        {key: "username" value: "HealthCheckBot"}
      ]
    ) {
      scheduleId
    }
  }
```

**Lo que obtienes a cambio:** `scheduleId`, identificador único para la programación (úsalo para actualizar o eliminar la programación más tarde)

### Solución alternativa: intervalos de menos de 10 minutos

Si necesita verificar algo con más frecuencia que cada 10 minutos, programe su flujo de trabajo en el intervalo mínimo de 10 minutos y use un paso de espera dentro de la definición del flujo de trabajo para crear un intervalo de sondeo adicional.

**Ejemplo de flujo de trabajo con votación de 5 minutos:**

```yaml
  name: frequent-health-check

  steps:
    # First check happens immediately when scheduled
    - name: firstCheck
      type: action
      action: newrelic.nrdb.query
      version: 1
      inputs:
        query: "FROM Transaction SELECT count(*) WHERE appName = 'MyApp' SINCE 5 minutes ago"

    # Wait 5 minutes
    - name: waitStep
      type: wait
      seconds: 300

    # Second check happens 5 minutes after the workflow started
    - name: secondCheck
      type: action
      action: newrelic.nrdb.query
      version: 1
      inputs:
        query: "FROM Transaction SELECT count(*) WHERE appName = 'MyApp' SINCE 5 minutes ago"
```

Programe este flujo de trabajo para que se ejecute cada 10 minutos usando `*/10 * * * *`. Esto le proporciona una votación efectiva de 5 minutos:

* 0:00 - El flujo de trabajo se inicia y se ejecuta primero. Verificar
* 0:05 - segundoLa comprobación se ejecuta (luego del paso de espera)
* 0:10 - Se inicia el siguiente flujo de trabajo programado y se ejecuta primero. Verificar
* 0:15 segundos - Se ejecuta la verificación (luego del paso de espera)

<Callout variant="tip">
  **Límite de duración del flujo de trabajo:** Recuerde que los flujos de trabajo tienen una duración máxima de 7 días. Diseñe sus pasos de espera y frecuencia de sondeo en consecuencia. Consulte [los límites del flujo de trabajo](/docs/workflow-automation/limitations-and-faq/workflow-limits) para obtener más detalles.
</Callout>

### Gestionar horarios

Luego de crear un horario:

* **Ver programaciones activas**: Consulte todas las ejecuciones programadas en el [dashboardflujo de trabajo.](/docs/workflow-automation/create-a-workflow-automation/managing-workflow#monitor-runs)
* **Programación de actualizaciones**: Emplee la API UpdateSchedule para cambiar la frecuencia o las entradas.
* **Eliminar programación**: Emplee la API DeleteSchedule para detener las ejecuciones recurrentes.

Para obtener la documentación completa de la API, consulte [API de automatización de flujo de trabajo](/docs/workflow-automation/workflow-automation-apis/using-workflow-automation-api).

## Que sigue

* **[Gestionar workflows](/docs/workflow-automation/create-a-workflow-automation/managing-workflow)**: Editar, duplicar y monitorear el historial de ejecución.