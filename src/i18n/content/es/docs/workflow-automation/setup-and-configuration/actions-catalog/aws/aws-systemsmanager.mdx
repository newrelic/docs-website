---
title: Acciones de AWS Systems Manager
tags:
  - workflow automation
  - workflow
  - workflow automation actions
  - AWS actions
  - AWS Systems Manager actions
metaDescription: A list of available aws systems manager actions in the actions catalog for workflow definitions
freshnessValidatedDate: never
translationType: machine
---

<Callout title="avance">
  Todavía estamos trabajando en esta característica, ¡pero nos encantaría que la probaras!

  Esta característica se proporciona actualmente como parte de un programa de vista previa de conformidad con nuestras [políticas de prelanzamiento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Esta página proporciona una referencia completa de las acciones de AWS Systems Manager disponibles en el catálogo de acciones de automatización del flujo de trabajo. Estas acciones le permiten gestionar sistemas de automatización y documentar operaciones.

## Requisitos previos

Antes de emplear las acciones AWS en la automatización del flujo de trabajo, cerciorar de tener lo siguiente:

* Una cuenta de AWS con las licencias adecuadas.
* Credenciales de AWS configuradas (credenciales de usuario de IAM, ARN de rol de IAM o credenciales de sesión).
* Las licencias IAM necesarios para los servicios específicos de AWS que planea emplear.

Consulte [Configurar credenciales AWS ](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/)para obtener información sobre cómo crear usuarios y roles de IAM, y configurar credenciales AWS estáticas y de sesión para la integración con acciones de automatización de flujo de trabajo AWS.

<CollapserGroup>
  <Collapser id="aws-systemsmanager.writedocument" title="Escribir documento SSM en AWS">
    Escriba un documento SSM en la cuenta AWS según las credenciales de AWS pasadas en la entrada de acción. Consulte [la documentación de AWS Systems Manager](https://docs.aws.amazon.com/systems-manager/?id=docs_gateway)

    <Tabs>
      <TabsBar>
        <TabsBarItem id="writedocumentinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="writedocumentoutputs">
          Salidas
        </TabsBarItem>

        <TabsBarItem id="writedocumentexample">
          Ejemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="writedocumentinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidad
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **awsRoleArn**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `arn:aws:iam::123456789012:role/my-workflow-role`
                </td>
              </tr>

              <tr>
                <td>
                  **awsAccessKeyId**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsAccessKeyId> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSecretAccessKey**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSecretAccessKey> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSessionToken**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSessionToken> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **región**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `region: "us-east-2"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentName**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentName: "my-ssm-document"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentType**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentType: "Command"`

                  Compruebe los valores válidos desde [aquí](https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_DocumentDescription.html#systemsmanager-Type-DocumentDescription-Status:text=Required%3A%20No-,Status,-The%20status%20of).
                </td>
              </tr>

              <tr>
                <td>
                  **documentFormat**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentFormat: "YAML"`

                  Compruebe los valores válidos desde [aquí](https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_DocumentDescription.html#systemsmanager-Type-DocumentDescription-Status:text=Required%3A%20No-,Status,-The%20status%20of).
                </td>
              </tr>

              <tr>
                <td>
                  **documentContent**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  Ver ejemplo
                </td>
              </tr>

              <tr>
                <td>
                  **override**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Booleano
                </td>

                <td>
                  `override: true (default)`.

                  Cuando `true`, siempre escribe el documento con el nombre proporcionado incluso si ya existe uno.

                  Cuando `false`, si ya existe un documento con el `documentName` proporcionado, la acción devuelve `success: false` y `errorMessage: Document already exists. Please enable override if you want to update the existing document.`
                </td>
              </tr>

              <tr>
                <td>
                  **selectores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  lista
                </td>

                <td>
                  `[{\"name\": \"documentName\", \"expression\": \".documentName\"}, {\"name\": \"documentType\", \"expression\": \".documentType\"}, {\"name\": \"documentStatus\", \"expression\": \".documentStatus\"}, {\"name\": \"success\", \"expression\": \".success\"}]`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="writedocumentoutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de salida
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Descripción y ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **documentName**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentName: "my-ssm-document"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentVersion**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentVersion: 1`
                </td>
              </tr>

              <tr>
                <td>
                  **documentType**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentType: "Command"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentStatus**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentStatus: "Active"`

                  El valor será uno de los estados desde [aquí](https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_DocumentDescription.html#systemsmanager-Type-DocumentDescription-Status:text=Required%3A%20No-,Status,-The%20status%20of).
                </td>
              </tr>

              <tr>
                <td>
                  **éxito**
                </td>

                <td>
                  Booleano
                </td>

                <td>
                  `success: true`
                </td>
              </tr>

              <tr>
                <td>
                  **mensaje de error**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `errorMessage: "Some error message from ssm"`
                </td>
              </tr>
            </tbody>
          </table>

          <Callout variant="important">
            * En la entrada de acción, solo se pueden proporcionar `awsAccessKeyId` y `awsSecretAccessKey`, pero deben ser credenciales estáticas de un usuario de IAM.
            * Si se van a emplear las credenciales de sesión, se deben pasar `awsAccessKeyId`, `awsSecretAccessKey` y `awsSessionToken` a la entrada de acción.
            * Los selectores para obtener como resultado el único parámetro especificado.
            * Consulte [las credenciales de AWS](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials) para obtener instrucciones.
          </Callout>
        </TabsPageItem>

        <TabsPageItem id="writedocumentexample">
          **Ejemplo 1**: Un documento SSM simple para enumerar todas las funciones Lambda

          ```yaml
          schemaVersion: '0.3'
          description: List all Lambda function names.
          mainSteps:
            - name: ExecuteAwsApi
              action: aws:executeAwsApi
              isEnd: true
              inputs:
                Service: lambda
                Api: ListFunctions
              outputs:
                - Name: resultFunctionName
                  Selector: $..FunctionName
                  Type: StringList
          outputs:
            - ExecuteAwsApi.resultFunctionName
          ```

          **Definición completa de flujos automáticos con la función de listado SSM Lambda**

          ```yaml
          name: aws-api

          workflowInputs:
            key:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_ACCESS_KEY_ID }}"
            access:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SECRET_ACCESS_KEY }}"
            token:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SESSION_TOKEN }}"
            region:
              type: String
              defaultValue: us-east-2

          steps:
            - name: createSsmDocument
              type: action
              action: aws.systemsManager.writeDocument
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                selectors:
                  - name: documentName
                    expression: '.documentName'
                  - name: documentType
                    expression: '.documentType'
                  - name: documentStatus
                    expression: '.documentStatus'
                  - name: success
                    expression: '.success'
                documentName: "LambdaListFunctionNames"
                documentContent: |
                  schemaVersion: '0.3'
                  description: List all Lambda function names.
                  mainSteps:
                    - name: ExecuteAwsApi
                      action: aws:executeAwsApi
                      isEnd: true
                      inputs:
                        Service: lambda
                        Api: ListFunctions
                      outputs:
                        - Name: resultFunctionName
                          Selector: $..FunctionName
                          Type: StringList
                  outputs:
                    - ExecuteAwsApi.resultFunctionName

            - name: generateIdempotencyToken
              type: action
              action: utils.uuid.generate
              version: 1

            - name: start1
              type: action
              action: aws.systemsManager.startAutomation
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                documentName: "${{ .steps.createSsmDocument.outputs.documentName }}"
                idempotencyToken: ${{ .steps.generateIdempotencyToken.outputs.uuid }}

            - name: waitForCompletion
              type: action
              action: aws.systemsManager.waitForAutomationStatus
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                automationExecutionId: ${{ .steps.start1.outputs.automationExecutionId }}
                # Optional, default is Success and Failed
                automationExecutionStatuses:
                  - "Success"
                  - "Failed"
                timeout: 60

            - name: hasCompleted
              type: switch
              switch:
                - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Failed" }}
                  next: displayError
                - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Success" }}
                  next: displaySuccess
              next: displayUnexpected

            - name: displayUnexpected
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "Unexpected status ${{ .steps.waitForCompletion.outputs.automationExecutionStatus | tojson }}"
              next: cleanupSsmDocument

            - name: displaySuccess
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "This is all the lambda function names on the region ${{ .workflowInputs.region }}:${{ .steps.waitForCompletion.outputs.automationExecutionOutputs.ExecuteAwsApi.resultFunctionName | join(\",\") }}"
              next: cleanupSsmDocument

            - name: displayError
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "Error while executing document ${{ .steps.createSsmDocument.outputs.documentName }}, detail: ${{ .steps.waitForCompletion.outputs.errorMessage }}"
              next: cleanupSsmDocument

            - name: cleanupSsmDocument
              type: action
              action: aws.systemsManager.deleteDocument
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                documentName: ${{ .steps.createSsmDocument.outputs.documentName }}
          ```

          **Ejemplo 2: Ejecutar un script de Python**

          <Collapser id="execute.python.script" title="Ejecutar script de Python">
            Al emplear la automatización y la acción de documento de AWS `SystemsManager`, podemos definir una definición de flujo de trabajo que ejecute un script de Python.

            A continuación se muestra un breve ejemplo que ilustra con una sencilla aplicación Hola Mundo.

            <Collapser id="system.manager.document" title="Documento de SystemsManager">
              ```yaml
              schemaVersion: '0.3'
              description: "Run a Python script that says 'Hello' to the username passed as input and capture the output."
              parameters:
                Username:
                  type: String
                  description: "The username to greet."
                  default: "User"
              mainSteps:
                - action: aws:executeScript
                  name: pythonStep
                  inputs:
                    Runtime: python3.8
                    Handler: script_handler
                    Script: |
                      def script_handler(event, context):
                          username = event['username']
                          return f'Hello {username}'
                    InputPayload:
                      username: "{{ Username }}"
                  outputs:
                    - Name: scriptOutput
                      Type: String
                      Selector: $.Payload
              outputs:
                - pythonStep.scriptOutput
              ```

              Esto luego se puede emplear en el flujo de trabajo siguiente:

              <Collapser id="workflow.definition.1" title="Definición de flujo de trabajo">
                ```yaml
                name: aws-python-script

                workflowInputs:
                  key:
                    type: String
                    defaultValue: "${{ :secrets:11933347:USERNAME_AWS_ACCESS_KEY_ID }}"
                  access:
                    type: String
                    defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SECRET_ACCESS_KEY }}"
                  token:
                    type: String
                    defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SESSION_TOKEN }}"
                  region:
                    type: String
                    defaultValue: us-west-2
                  name:
                    type: String
                    defaultValue: ExecuteHelloPythonScript
                  username:
                    type: String
                    defaultValue: World!

                steps:
                  - name: generateIdempotencyToken
                    type: action
                    action: utils.uuid.generate
                    version: 1

                  - name: createSsmDocument
                    type: action
                    action: aws.systemsManager.writeDocument
                    version: 1
                    inputs:
                      awsAccessKeyId: ${{ .workflowInputs.key }}
                      awsSecretAccessKey: ${{ .workflowInputs.access }}
                      awsSessionToken: ${{ .workflowInputs.token }}
                      region: ${{ .workflowInputs.region }}
                      documentName: ${{ .workflowInputs.name }}
                      documentContent: |
                        schemaVersion: '0.3'
                        description: "Run a Python script that says 'Hello' to the username passed as input and capture the output."
                        parameters:
                          Username:
                            type: String
                            description: "The username to greet."
                            default: "User"
                        mainSteps:
                          - action: aws:executeScript
                            name: pythonStep
                            inputs:
                              Runtime: python3.8
                              Handler: script_handler
                              Script: |
                                def script_handler(event, context):
                                    username = event['username']
                                    return f'Hello {username}'
                              InputPayload:
                                username: "{{ Username }}"
                            outputs:
                              - Name: scriptOutput
                                Type: String
                                Selector: $.Payload
                        outputs:
                          - pythonStep.scriptOutput

                  - name: start1
                    type: action
                    action: aws.systemsManager.startAutomation
                    version: 1
                    inputs:
                      awsAccessKeyId: ${{ .workflowInputs.key }}
                      awsSecretAccessKey: ${{ .workflowInputs.access }}
                      awsSessionToken: ${{ .workflowInputs.token }}
                      region: ${{ .workflowInputs.region }}
                      documentName: "${{ .steps.createSsmDocument.outputs.documentName }}"
                      idempotencyToken: ${{ .steps.generateIdempotencyToken.outputs.uuid }}
                      parameters:
                        Username: ${{ .workflowInputs.username }}

                  - name: waitForCompletion
                    type: action
                    action: aws.systemsManager.waitForAutomationStatus
                    version: 1
                    inputs:
                      awsAccessKeyId: ${{ .workflowInputs.key }}
                      awsSecretAccessKey: ${{ .workflowInputs.access }}
                      awsSessionToken: ${{ .workflowInputs.token }}
                      region: ${{ .workflowInputs.region }}
                      automationExecutionId: ${{ .steps.start1.outputs.automationExecutionId }}
                      # Optional, default is Success and Failed
                      automationExecutionStatuses:
                        - "Success"
                        - "Failed"
                      timeout: 300

                  - name: hasCompleted
                    type: switch
                    switch:
                      - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Failed" }}
                        next: displayError
                      - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Success" }}
                        next: displaySuccess
                    next: displayUnexpected

                  - name: displayUnexpected
                    type: action
                    action: newrelic.instrumentation.log
                    version: 1
                    inputs:
                      message: "Unexpected status ${{ .steps.waitForCompletion.outputs.automationExecutionStatus | tojson }}"
                    next: cleanupSsmDocument

                  - name: displaySuccess
                    type: action
                    action: newrelic.instrumentation.log
                    version: 1
                    inputs:
                      message: "This is the results of the automation that was run on the region ${{ .workflowInputs.region }}:${{ .steps.waitForCompletion.outputs.automationExecutionOutputs.pythonStep.scriptOutput | tojson }}"
                    next: cleanupSsmDocument

                  - name: displayError
                    type: action
                    action: newrelic.instrumentation.log
                    version: 1
                    inputs:
                      message: "Error while executing document ${{ .steps.createSsmDocument.outputs.documentName }}, detail: ${{ .steps.waitForCompletion.outputs | tojson }}"
                    next: cleanupSsmDocument

                  - name: cleanupSsmDocument
                    type: action
                    action: aws.systemsManager.deleteDocument
                    version: 1
                    inputs:
                      awsAccessKeyId: ${{ .workflowInputs.key }}
                      awsSecretAccessKey: ${{ .workflowInputs.access }}
                      awsSessionToken: ${{ .workflowInputs.token }}
                      region: ${{ .workflowInputs.region }}
                      documentName: ${{ .steps.createSsmDocument.outputs.documentName }}
                ```

                Esto se puede iniciar con la siguiente mutación de NerdGraph, asumiendo que los secretos temporales de AWS se almacenaron previamente con las mutaciones `secretsManagementCreateSecretNerdGraph`.

                ```yaml
                mutation { 
                    autoflowsStartWorkflowRun(accountId: 11933347,
                    definition: {
                        name: "aws-python-script",
                    }, workflowInputs: [
                        {key: "key" value: "${{ :secrets:testUser123_AWS_ACCESS_KEY_ID }}"}
                        {key: "access" value: "${{ :secrets:testUser123_AWS_SECRET_ACCESS_KEY }}"}
                        {key: "token" value: "${{ :secrets:testUser123_AWS_SESSION_TOKEN }}"}
                        {key: "region" value:"us-west-2"}
                        {key: "username" value: "Julien"}
                    ]) 
                    { runId }
                } 
                ```

                Al ejecutar la mutación anterior, se devuelve un runId, por ejemplo `207e8c23-2c89-4af2-a74f-3c9ea2ffd543`. Luego, este runId se puede emplear para consultar los logs y ver el siguiente resultado:

                <img title="Image of a python script execution output" alt="Image of a python script execution output" src="/images/python-script.webp" />
              </Collapser>
            </Collapser>
          </Collapser>

          **Ejemplo 3: Un documento SSM más complejo**

          <Collapser id="example3.complex.document" title="Ejemplo de documento SSM complejo">
            **Documento de SSM que realiza la reversión de API Gateway:**

            1. Obtenga la lista de API de descanso de API Gateway. Filtra mi API (`Test API`) y obtén el ID de API restante.
            2. Obtenga la lista de todos los recursos dentro de mi API (`Test API`). Filtrar mi recurso específico en función de pathPart(`/test`) y obtener el resourceID
            3. Obtener la lista de versiones para mi función Lambda (`ApiGwTestFn`). Filtrar la versión específica a la que quiero volver (versión: 1) y obtener el functionArn de esa versión.
            4. Actualice la integración del gateway API con la función lambda Arn adquirida en el paso anterior.
            5. Crear una nueva implementación para mi API rest (`Test API`).

            ```yaml
            schemaVersion: '0.3'
            description: Test SSM for API gateway rollback
            mainSteps:
              - name: ExecuteAwsApi
                action: aws:executeAwsApi
                nextStep: ExecuteGetApiResources
                inputs:
                  Service: apigateway
                  Api: GetRestApis
                outputs:
                  - Name: resultApiId
                    Selector: $.items[?(@.name=='Test API')].id
                    Type: String
              - name: ExecuteGetApiResources
                action: aws:executeAwsApi
                nextStep: ExecuteListVersionsByFunction
                inputs:
                  Service: apigateway
                  Api: GetResources
                  restApiId: '{{ ExecuteAwsApi.resultApiId }}'
                outputs:
                  - Name: resultResourceId
                    Selector: $.items[?(@.pathPart=='test')].id
                    Type: String
              - name: ExecuteListVersionsByFunction
                action: aws:executeAwsApi
                nextStep: ExecuteApiGwUpdateIntg
                inputs:
                  Service: lambda
                  Api: ListVersionsByFunction
                  FunctionName: ApiGwTestFn
                outputs:
                  - Name: resultLambdaVersionArn
                    Selector: $.Versions[?(@.Version=='1')].FunctionArn
                    Type: String
              - name: ExecuteApiGwUpdateIntg
                action: aws:executeAwsApi
                nextStep: ExecuteApiGwCreateDeployment
                inputs:
                  Service: apigateway
                  Api: UpdateIntegration
                  restApiId: '{{ ExecuteAwsApi.resultApiId }}'
                  resourceId: '{{ ExecuteGetApiResources.resultResourceId }}'
                  httpMethod: GET
                  patchOperations:
                    - op: replace
                      path: /uri
                      value: arn:aws:apigateway:us-east-2:lambda:path/2015-03-31/functions/{{ ExecuteListVersionsByFunction.resultLambdaVersionArn }}/invocations
              - name: ExecuteApiGwCreateDeployment
                action: aws:executeAwsApi
                inputs:
                  Service: apigateway
                  Api: CreateDeployment
                  restApiId: '{{ ExecuteAwsApi.resultApiId }}'
            outputs:
              - ExecuteGetApiResources.resultResourceId
              - ExecuteListVersionsByFunction.resultLambdaVersionArn
            ```

            El ejemplo SSM genera `ExecuteGetApiResources.resultResourceId` y `ExecuteListVersionsByFunction.resultLambdaVersionArn`. Estos resultados se pueden emplear en pasos posteriores en la definición del flujo de trabajo.
          </Collapser>
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="aws-systemsmanager.deletedocument" title="Eliminar un documento de AWS SSM">
    Esta acción sirve para eliminar un documento AWS SSM en la cuenta de AWS según las credenciales pasadas en la entrada de la acción. Consulte [la documentación de AWS Systems Manager](https://docs.aws.amazon.com/systems-manager/latest/userguide/documents.html)

    <Tabs>
      <TabsBar>
        <TabsBarItem id="systemsmanagerinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="systemsmanageroutputs">
          Salidas
        </TabsBarItem>

        <TabsBarItem id="systemsmanagerexample">
          Ejemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="systemsmanagerinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidad
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **awsRoleArn**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `arn:aws:iam::123456789012:role/my-workflow-role`
                </td>
              </tr>

              <tr>
                <td>
                  **awsAccessKeyId**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsAccessKeyId> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSecretAccessKey**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSecretAccessKey> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSessionToken**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSessionToken> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **región**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `region: "us-east-2"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentName**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentName: "my-ssm-document"`
                </td>
              </tr>

              <tr>
                <td>
                  **selectores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  `[{\"name\": \"success\", \"expression\": \".success\"}, {\"name\": \"documentName\", \"expression\": \".documentName\"}]`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="systemsmanageroutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de salida
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **documentName**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentName: "my-ssm-document"`
                </td>
              </tr>

              <tr>
                <td>
                  **éxito**
                </td>

                <td>
                  Booleano
                </td>

                <td>
                  `success: true`
                </td>
              </tr>

              <tr>
                <td>
                  **mensaje de error**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `errorMessage: "Some error message from ssm"`
                </td>
              </tr>
            </tbody>
          </table>

          <Callout variant="important">
            * En la entrada de acción, solo se pueden proporcionar `awsAccessKeyId` y `awsSecretAccessKey`, pero deben ser credenciales estáticas de un usuario de IAM.
            * Si se van a emplear las credenciales de sesión, se deben pasar `awsAccessKeyId`, `awsSecretAccessKey` y `awsSessionToken` a la entrada de acción.
            * Los selectores para obtener como resultado el único parámetro especificado.
          </Callout>
        </TabsPageItem>

        <TabsPageItem id="systemsmanagerexample">
          Un documento SSM simple para enumerar todas las funciones Lambda

          ```yaml
          schemaVersion: '0.3'
          description: List all Lambda function names.
          mainSteps:
            - name: ExecuteAwsApi
              action: aws:executeAwsApi
              isEnd: true
              inputs:
                Service: lambda
                Api: ListFunctions
              outputs:
                - Name: resultFunctionName
                  Selector: $..FunctionName
                  Type: StringList
          outputs:
            - ExecuteAwsApi.resultFunctionName
          ```

          **La definición completa del flujo de trabajo con SSM**:

          ```yaml
          name: aws-api

          workflowInputs:
            key:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_ACCESS_KEY_ID }}"
            access:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SECRET_ACCESS_KEY }}"
            token:
              type: String
              defaultValue: "${{ :secrets:11933347:USERNAME_AWS_SESSION_TOKEN }}"
            region:
              type: String
              defaultValue: us-east-2

          steps:
            - name: createSsmDocument
              type: action
              action: aws.systemsManager.writeDocument
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                selectors:
                  - name: documentName
                    expression: '.documentName'
                  - name: documentType
                    expression: '.documentType'
                  - name: documentStatus
                    expression: '.documentStatus'
                  - name: success
                    expression: '.success'
                documentName: "LambdaListFunctionNames"
                documentContent: |
                  schemaVersion: '0.3'
                  description: List all Lambda function names.
                  mainSteps:
                    - name: ExecuteAwsApi
                      action: aws:executeAwsApi
                      isEnd: true
                      inputs:
                        Service: lambda
                        Api: ListFunctions
                      outputs:
                        - Name: resultFunctionName
                          Selector: $..FunctionName
                          Type: StringList
                  outputs:
                    - ExecuteAwsApi.resultFunctionName

            - name: generateIdempotencyToken
              type: action
              action: utils.uuid.generate
              version: 1

            - name: start1
              type: action
              action: aws.systemsManager.startAutomation
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                documentName: "${{ .steps.createSsmDocument.outputs.documentName }}"
                idempotencyToken: ${{ .steps.generateIdempotencyToken.outputs.uuid }}

            - name: waitForCompletion
              type: action
              action: aws.systemsManager.waitForAutomationStatus
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                automationExecutionId: ${{ .steps.start1.outputs.automationExecutionId }}
                # Optional, default is Success and Failed
                automationExecutionStatuses:
                  - "Success"
                  - "Failed"
                timeout: 60

            - name: hasCompleted
              type: switch
              switch:
                - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Failed" }}
                  next: displayError
                - condition: ${{ .steps.waitForCompletion.outputs.automationExecutionStatus == "Success" }}
                  next: displaySuccess
              next: displayUnexpected

            - name: displayUnexpected
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "Unexpected status ${{ .steps.waitForCompletion.outputs.automationExecutionStatus | tojson }}"
              next: cleanupSsmDocument

            - name: displaySuccess
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "This is all the lambda function names on the region ${{ .workflowInputs.region }}:${{ .steps.waitForCompletion.outputs.automationExecutionOutputs.ExecuteAwsApi.resultFunctionName | join(\",\") }}"
              next: cleanupSsmDocument

            - name: displayError
              type: action
              action: newrelic.instrumentation.log
              version: 1
              inputs:
                message: "Error while executing document ${{ .steps.createSsmDocument.outputs.documentName }}, detail: ${{ .steps.waitForCompletion.outputs.errorMessage }}"
              next: cleanupSsmDocument

            - name: cleanupSsmDocument
              type: action
              action: aws.systemsManager.deleteDocument
              version: 1
              inputs:
                awsAccessKeyId: ${{ .workflowInputs.key }}
                awsSecretAccessKey: ${{ .workflowInputs.access }}
                awsSessionToken: ${{ .workflowInputs.token }}
                region: ${{ .workflowInputs.region }}
                documentName: ${{ .steps.createSsmDocument.outputs.documentName }}
          ```
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="aws-systemsmanager.startautomation" title="Iniciar la automatización con SSM doc">
    Inicia una automatización empleando un documento de AWS SSM. Consulte [la documentación de AWS Systems Manager](https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_StartAutomationExecution.html)

    <Tabs>
      <TabsBar>
        <TabsBarItem id="startautomationinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="startautomationoutputs">
          Salidas
        </TabsBarItem>

        <TabsBarItem id="startautomationexample">
          Ejemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="startautomationinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidad
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **awsRoleArn**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `arn:aws:iam::123456789012:role/my-workflow-role`
                </td>
              </tr>

              <tr>
                <td>
                  **awsAccessKeyId**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsAccessKeyId> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSecretAccessKey**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSecretAccessKey> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSessionToken**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSessionToken> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **región**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `region: "us-east-2"`
                </td>
              </tr>

              <tr>
                <td>
                  **documentName**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `documentName: "my-ssm-document"`
                </td>
              </tr>

              <tr>
                <td>
                  **parámetro**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Mapa
                </td>

                <td>
                  ```yaml
                  parameters:
                        myKey: myValue
                  ```
                </td>
              </tr>

              <tr>
                <td>
                  **idempotencyToken**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  UUID
                </td>

                <td>
                  `idempotencyToken: "any token"`

                  Esto se pasará como token de cliente para la idempotencia para iniciar la automatización de AWS SSM.
                </td>
              </tr>

              <tr>
                <td>
                  **selectores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  `[{\"name\": \"automationExecutionId\", \"expression\": \".automationExecutionId\"}, {\"name\": \"success\", \"expression\": \".success\"}]`
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="startautomationoutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de salida
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **automationExecutionId**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `automationExecutionId: "3143a28d-241c-4abd-a3ca-9c0ff3890241"`
                </td>
              </tr>

              <tr>
                <td>
                  **éxito**
                </td>

                <td>
                  Booleano
                </td>

                <td>
                  `success: true`
                </td>
              </tr>

              <tr>
                <td>
                  **mensaje de error**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `errorMessage: "Some error message from ssm"`
                </td>
              </tr>
            </tbody>
          </table>

          <Callout variant="important">
            * En la entrada de acción, si se van a proporcionar `awsAccessKeyId` y `awsSecretAccessKey`, cerciorar de que sean credenciales estáticas de un usuario de IAM.
            * Si se van a emplear credenciales de sesión, `awsAccessKeyId`, `awsSecretAccessKey` y `awsSessionToken` deben pasar a la entrada de acción.
            * Consulte [las credenciales de AWS](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials/) para obtener instrucciones.
            * Emplee selectores para obtener únicamente el parámetro especificado como resultado.
          </Callout>
        </TabsPageItem>

        <TabsPageItem id="startautomationexample">
          <table>
            <thead>
              <tr>
                <th>
                  Definición de flujo de trabajo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  ```yaml
                  schemaVersion: '0.3'
                  description: List all Lambda function names.
                  mainSteps:
                    - name: ExecuteAwsApi
                      action: aws:executeAwsApi
                      isEnd: true
                      inputs:
                        Service: lambda
                        Api: ListFunctions
                      outputs:
                        - Name: resultFunctionName
                          Selector: $..FunctionName
                          Type: StringList
                  outputs:
                    - ExecuteAwsApi.resultFunctionName
                  ```
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>

<CollapserGroup>
  <Collapser id="aws-systemsmanager.waitforautomationstatus" title="Espere el estado de automatización">
    Espera a que se complete una automatización empleando un documento de AWS. Consulte [la documentación de AWS Systems Manager](https://docs.aws.amazon.com/systems-manager/?id=docs_gateway) para obtener más información.

    <Tabs>
      <TabsBar>
        <TabsBarItem id="automationstatusinputs">
          Entradas
        </TabsBarItem>

        <TabsBarItem id="automationstatusoutputs">
          Salidas
        </TabsBarItem>

        <TabsBarItem id="automationstatusexample">
          Ejemplo
        </TabsBarItem>
      </TabsBar>

      <TabsPages>
        <TabsPageItem id="automationstatusinputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de entrada
                </th>

                <th>
                  Opcionalidad
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **awsRoleArn**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `arn:aws:iam::123456789012:role/my-workflow-role`
                </td>
              </tr>

              <tr>
                <td>
                  **awsAccessKeyId**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsAccessKeyId> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSecretAccessKey**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSecretAccessKey> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **awsSessionToken**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `${{ :secrets:<awsSessionToken> }}`
                </td>
              </tr>

              <tr>
                <td>
                  **región**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `region: "us-east-2"`
                </td>
              </tr>

              <tr>
                <td>
                  **automationExecutionId**
                </td>

                <td>
                  Requerido
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `automationExecutionId: "3143a28d-241c-4abd-a3ca-9c0ff3890241"`

                  . La automatización 

                  `executionId`

                   cuya finalización debemos esperar.
                </td>
              </tr>

              <tr>
                <td>
                  **automationExecutionStatuses**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  `automationExecutionStatuses: ["status1", "status2"]`

                  Lista de estados de ejecución de automatización de [AutomationExecution](https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_AutomationExecution.html#AutomationExecutionStatus) que pueden detener la espera.

                  Por defecto: `["Success", "Failed"]`
                </td>
              </tr>

              <tr>
                <td>
                  **se acabó el tiempo**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  En t
                </td>

                <td>
                  `timeout: 180`(predeterminado), máximo 600.

                  La duración en segundos que podemos esperar para que el estado de automatización sea uno de los esperados `automationExecutionStatuses`.

                  Si se agotó el tiempo de espera, la salida contiene `success: false` y `errorMessag: Timeout waiting for automation status`.
                </td>
              </tr>

              <tr>
                <td>
                  **selectores**
                </td>

                <td>
                  Opcional
                </td>

                <td>
                  Lista
                </td>

                <td>
                  `[{\"name\": \"automationExecutionStatus\", \"expression\": \".automationExecutionStatus\"}, {\"name\": \"scriptOutput\", \"expression\": \".automationExecutionOutputs.pythonStep.scriptOutput | tojson\"}]`

                  .
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>

        <TabsPageItem id="automationstatusoutputs">
          <table>
            <thead>
              <tr>
                <th>
                  Campo de salida
                </th>

                <th>
                  Tipo
                </th>

                <th>
                  Ejemplo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  **automationExecutionId**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `automationExecutionId: "3143a28d-241c-4abd-a3ca-9c0ff3890241"`
                </td>
              </tr>

              <tr>
                <td>
                  **automationExecutionStatus**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `automationExecutionStatus: "Success"`

                  Si la acción es exitosa, se empleará cualquiera de los valores pasados en el campo de entrada `automationExecutionStatuses`.

                  De lo contrario, será nulo.
                </td>
              </tr>

              <tr>
                <td>
                  **automationExecutionOutputs**
                </td>

                <td>
                  Mapa
                </td>

                <td>
                  ```yaml
                  "automationExecutionOutputs": {
                        "ExecuteGetApiResources": {
                          "resultResourceId": [
                            "pky3cb"
                          ]
                        },
                        "ExecuteListVersionsByFunction": {
                          "resultLambdaVersionArn": [
                            "arn:aws:lambda:us-east-2:661945836867:function:ApiGwTestFn:1"
                          ]
                        }
                  } 
                  ```

                  El resultado será un mapa de los valores de salida del documento. Cualquier dato que aparezca en el documento se puede recopilar empleando este campo de salida y se puede emplear en los pasos posteriores de la definición de la automatización del flujo de trabajo.
                </td>
              </tr>

              <tr>
                <td>
                  **éxito**
                </td>

                <td>
                  Booleano
                </td>

                <td>
                  `success: true`
                </td>
              </tr>

              <tr>
                <td>
                  **mensaje de error**
                </td>

                <td>
                  Cadena
                </td>

                <td>
                  `errorMessage: "Some error message from ssm"`
                </td>
              </tr>
            </tbody>
          </table>

          <Callout variant="important">
            1. En la entrada de acción, solo se pueden proporcionar `awsAccessKeyId` y `awsSecretAccessKey`, pero deben ser credenciales estáticas de un usuario de IAM.
            2. Si se van a emplear credenciales de sesión, `awsAccessKeyId`, `awsSecretAccessKey` y `awsSessionToken` deben pasar a la entrada de acción.
            3. Consulte las instrucciones para configurar [las credenciales de AWS](/docs/workflow-automation/setup-and-configuration/set-up-aws-credentials).
            4. Emplee selectores para obtener únicamente el parámetro especificado como resultado.
          </Callout>
        </TabsPageItem>

        <TabsPageItem id="automationstatusexample">
          <table>
            <thead>
              <tr>
                <th>
                  Definición de flujo de trabajo
                </th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  ```yaml
                  schemaVersion: '0.3'
                  description: List all Lambda function names.
                  mainSteps:
                    - name: ExecuteAwsApi
                      action: aws:executeAwsApi
                      isEnd: true
                      inputs:
                        Service: lambda
                        Api: ListFunctions
                      outputs:
                        - Name: resultFunctionName
                          Selector: $..FunctionName
                          Type: StringList
                  outputs:
                    - ExecuteAwsApi.resultFunctionName
                  ```
                </td>
              </tr>
            </tbody>
          </table>
        </TabsPageItem>
      </TabsPages>
    </Tabs>
  </Collapser>
</CollapserGroup>