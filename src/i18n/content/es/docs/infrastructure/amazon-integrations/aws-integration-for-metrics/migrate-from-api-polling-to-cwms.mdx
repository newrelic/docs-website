---
title: Migrar del sondeo API a CloudWatch Metric Streams
tags:
  - API polling to CWMS migration
metaDescription: Migrate your New Relic and AWS services integration type from API Polling to CloudWatch Metric Streams.
freshnessValidatedDate: never
translationType: machine
---

Para una integración perfecta de su cuenta AWS con New Relic, [la integración a través de CloudFormation y CloudWatch Metric Streams](/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/via-cloudformation) es el enfoque más recomendado. Sin embargo, si ya integró su cuenta de AWS con New Relic mediante API Polling, consulte el siguiente procedimiento para migrar de API Polling a CloudWatch Metric Streams.

## Requisitos previos [#prerequisites]

Antes de comenzar a integrar su cuenta de AWS con New Relic, cerciorar de cumplir con los siguientes requisitos previos:

* **Una [clave de licencia de New Relic Ingest y una clave de usuario](https://one.newrelic.com/api-keys)**: necesitará estas claves para conectar sus servicios de AWS a su cuenta de New Relic.
* **[Licencias](https://docs.aws.amazon.com/ARG/latest/userguide/gettingstarted-prereqs-permissions.html)** para implementar nuevos recursos AWS y **[roles de IAM](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html)**: necesitará esta licencia para su cuenta AWS.
* **[Licencias](/docs/accounts/accounts-billing/new-relic-one-user-management/user-permissions/#infrastructure)** para la integración en la nube: Necesitarás estas licencias para tu cuenta New Relic.
* Para los usuarios que gestionan varias cuentas AWS, [conecte cada cuenta a una sola cuenta New Relic ](/docs/infrastructure/amazon-integrations/manage-aws-data/aws-multi-account).
* Para los usuarios que gestionan varias regiones dentro de esas cuentas, deben crear un Kinesis Data Firehose separado que apunte a New Relic para cada región.

<Steps>
  <Step>
    ## Migrar a la integración de CloudWatch Metric Streams [#migrate]

    Puede migrar desde el sondeo API creando una plantilla de CloudFormation o volviendo a agregar su cuenta AWS y siguiendo nuestros procedimientos de instalación guiada en la aplicación. Le recomendamos que emplee el método de plantilla CloudFormation, ya que es la forma más eficiente de migrar. Estas integraciones no son compatibles con CloudWatch Metric Streams y no se pueden migrar a nuestra integración:

    * AWS CloudTrail
    * AWS Health
    * AWS Trusted Advisor
    * AWS X-Ray

    Si emplea estas integraciones, aún deberá emplear el método de sondeo API.

    <CollapserGroup>
      <Collapser id="with-template" title="Migrar con la plantilla CloudFormation (recomendado)">
        La plantilla CloudFormation le permite actualizar una plantilla con un espacio de nombres preconfigurado en función de su configuración de sondeo.

        1. Vaya a **[one.newrelic.com &gt; Infrastructure &gt; AWS](https://one.newrelic.com/infra/infrastructure/cloud-aws)** y luego haga clic en **<DNT>Migrate to CloudWatch Metric stream</DNT>**.
        2. Siga los procedimientos. Descargará la plantilla y luego replicará el espacio de nombres desde el sondeo API. Cerciorar de agregar los detalles de su cuenta a la plantilla descargada.
        3. Desde AWS Console, vaya a <DNT>**Cloud Formation &gt; Create Stack &gt; Upload a template file**</DNT>. Sube tu plantilla de CloudFormation actualizada.
      </Collapser>

      <Collapser id="without-template" title="Migrar sin plantilla de CloudFormation">
        Si no desea emplear el método CloudFormation, deberá volver a agregar su cuenta AWS incluso si ya vinculó su cuenta AWS con la integración de sondeo. Estos procedimientos pueden hacer que abandones este documento, pero recuerda regresar para deshabilitar la integración de tu sondeo.

        1. Vaya a <DNT>**[one.newrelic.com &gt; All capabilities &gt;Infrastructure &gt; AWS](https://one.newrelic.com/infra/infrastructure/cloud-aws)**</DNT> y luego haga clic en <DNT>**Add AWS account**</DNT>. Elige tu método.
        2. Siga los pasos de la AWS Console desde el [flujoAWS Console ](/install/aws-cloudwatch/?task=console)en este documento.
        3. [Deshabilite toda integración de sondeo innecesaria](/docs/infrastructure/amazon-integrations/connect/uninstall-aws/) en la cuenta de proveedor de AWS anterior.

        Al deshabilitar, tenga en cuenta que [algunas integraciones no son compatibles con CloudWatch Metric Streams](/docs/infrastructure/amazon-integrations/connect/connect-aws-new-relic-infrastructure-monitoring/).
      </Collapser>
    </CollapserGroup>

    Nuestra integración CloudWatch Metric Streams emplea la API métrica para impulsar métrica en el formato [métrico dimensional](/docs/data-apis/understand-data/new-relic-data-types/#dimensional-metrics). Nuestro método de sondeo API, por otro lado, impulsa la métrica en función del [evento](/docs/data-apis/understand-data/new-relic-data-types/#events-new-relic).

    * Para ayudar en la transición, ofrecemos un mecanismo de calce que le permite escribir consultas en cualquier formato de manera transparente. Estas consultas se procesan como se espera en función de la fuente disponible, ya sea de evento a métrica o de métrica a evento.
    * Recomendamos revisar [algunas limitaciones](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/query-infrastructure-dimensional-metrics-nrql/#known-limitations) sobre el mecanismo de shimming que le permite usar consulta basada en eventos con la integración de CloudWatch Metric Streams.

    Luego de migrar, algunas de las características New Relic que dependen de los datos de sondeo de su API pueden comportar de manera diferente:

    * <DNT>**Dashboards**</DNT>: el panel personalizado que emplea el evento de integración AWS basado en encuestas seguirá funcionando como se esperaba.
    * <DNT>**Alerts**</DNT>: condición de alerta de que el uso de eventos AWS basados en encuestas seguirá funcionando. Recomendamos adaptarlos al formato de métrica dimensional que emplea NRQL como fuente.
    * <DNT>**Entities**</DNT>: Su lista de entidades monitoras puede mostrar entidades duplicadas por hasta 24 horas.
    * <DNT>**Attributes**</DNT>: Las integraciones de AWS basadas en encuestas recopilan el prefijo de la etiqueta de recurso con `label.`, mientras que los prefijos de integración de AWS CloudWatch Metric Streams recopilan la etiqueta de recurso con `tags.`. Si ambas integraciones están habilitadas para la misma cuenta de AWS, la etiqueta de recurso aparecerá debajo de ambos prefijos cuando se use el formato de evento.
  </Step>

  <Step>
    ## Validar que sus datos [#validate-data]

    Para confirmar que estás recibiendo datos de métrica Streams, sigue estos pasos:

    1. Vaya a <DNT>**[one.newrelic.com &gt; All capabilities &gt; Infrastructure &gt; AWS](https://one.newrelic.com/infra/infrastructure/cloud-aws)**</DNT>. Busque la cuenta de AWS que conectó a New Relic. <DNT>**Stream**</DNT> cuentas.
    2. Verifique el dashboard de estado de la cuenta y confirme que New Relic recibe los datos de métrica. Esto puede incluir errores y cantidad de espacios de nombres y métricas ingeridas.
    3. Explore sus datos escribiendo consultas para conjuntos específicos de métricas.

    Es posible que New Relic tarde unos minutos en detectar nuevos recursos y sintetizarlos como entidad.

    <Callout variant="tip">
      Las métricas de AWS de CloudWatch para servicios globales, como AWS Billing, solo están disponibles en la región <DNT>**us-east-1**</DNT>. Cerciorar de que haya un CloudWatch Metric Streams activo configurado en esa región.
    </Callout>
  </Step>
</Steps>

## Temas relacionados [#related-topics]

<DocTiles>
  <DocTile title="Recopilar datos de varias cuentas de AWS" path="/docs/infrastructure/amazon-integrations/manage-aws-data/aws-multi-account/">
    Aprenda a recopilar datos de varias cuentas de AWS.
  </DocTile>

  <DocTile title="AWS integración métrica" path="/docs/infrastructure/amazon-integrations/manage-aws-data/aws-integrations-metrics/">
    Explore y emplee métrica de CloudWatch Metric Streams.
  </DocTile>

  <DocTile title="Integración AWS a través de CloudFormation y CWMS" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/via-cloudformation-cwms">
    Integre los servicios de AWS con New Relic empleando CloudFormation y CloudWatch Metric Streams.
  </DocTile>

  <DocTile title="Integración AWS a través de CloudFormation y API Polling" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/via-cloudformation-and-api-polling">
    Integre los servicios de AWS con New Relic empleando CloudFormation y API Polling.
  </DocTile>

  <DocTile title="Integración AWS a través de Terraform" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/terraform">
    Integre los servicios de AWS con New Relic usando Terraform.
  </DocTile>

  <DocTile title="Integración manual desde la consola AWS" path="/docs/infrastructure/amazon-integrations/aws-integration-for-metrics/manual">
    Integre manualmente los servicios de AWS con New Relic desde la consola de AWS.
  </DocTile>
</DocTiles>