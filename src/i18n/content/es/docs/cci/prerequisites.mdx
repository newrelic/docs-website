---
title: Requisitos previos para AWS CCI
metaDescription: 'Set up AWS for CCI with consolidated billing, CUR, IAM roles, and region activation to optimize cost analysis in New Relic.'
redirect:
  - /docs/cci/getting-started/prerequisites
freshnessValidatedDate: never
translationType: machine
---

<Callout title="avance">
  Todavía estamos trabajando en esta característica, ¡pero nos encantaría que la probaras!

  Esta característica se proporciona actualmente como parte de un programa de vista previa de conformidad con nuestras [políticas de prelanzamiento](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy).
</Callout>

Prepare su entorno AWS para la integración de Inteligencia para costos en la nube (CCI) siguiendo estos requisitos previos, incluyendo la configuración de la facturación del consolidador, la habilitación de reportes de costos y uso, la configuración de roles y políticas de IAM para un acceso seguro y la activación de las regiones AWS necesarias. Cerciorar de que su configuración permita un análisis y una gestión de costos eficaces dentro de la plataforma New Relic.

## Requisitos previos

<CollapserGroup>
  <Collapser id="aws-account-permissions" title="Cuenta de AWS con las licencias adecuadas">
    Cerciorar de que la [facturación de consolidación esté configurada para la organización AWS ](https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/consolidated-billing.html). Esta herramienta consolida la facturación de todas las cuentas de su organización para una gestión de costos unificada.
  </Collapser>

  <Collapser id="s3-bucket-creation" title="Bucket S3 para reportes de costos y uso">
    Los reportes de costos y uso de AWS (CUR) se almacenarán en un bucket de S3. Recomendamos crear el bucket S3 en la región `us-east-2`. Siga estos pasos para crear un bucket dedicado:

    1. Inicie sesión en la **consola de administración de AWS 9AWS Management Console)**.

    2. Navegue al servicio S3.

    3. Haz clic en **Create bucket**.

    4. Ingrese un nombre de bucket único (por ejemplo, `<your-company-name>-billing`).

    5. Configurar los ajustes del bucket:

       * Habilitar el control de versiones
       * Deshabilitar el acceso público (recomendado)
       * Habilitar el cifrado predeterminado (recomendado)

    6. **Etiqueta (opcional)**: Agregue cualquier etiqueta si es necesario para la gestión de recursos de su organización.

    7. Haz clic en **Create bucket**.

    <Callout variant="important">
      Recuerde el nombre del bucket, ya que lo necesitará en los siguientes pasos y en los pasos de instalación en CCI.
    </Callout>
  </Collapser>

  <Collapser id="s3-bucket-creation" title="Configuración de reportes de uso y costos AWS">
    Crea un reporte de costos y uso que se entregará a tu bucket de S3:

    1. Inicie sesión en la **consola de administración de AWS 9AWS Management Console)**.

    2. Navegue al **Billing Dashboard**.

    3. En el panel de navegación izquierdo, haga clic en **Cost &amp; Usage Analysis**.

    4. Haz clic en **Data Exports** y luego en **Create**.

    5. Configurar los ajustes del reporte:

       <table>
         <thead>
           <tr>
             <th width={250}>
               **Configuración**
             </th>

             <th>
               **Valor**
             </th>

             <th>
               **Descripción**
             </th>
           </tr>
         </thead>

         <tbody>
           <tr>
             <td>
               Tipo de exportación
             </td>

             <td>
               `Standard Data Export`
             </td>

             <td>
               Proporciona información detallada sobre el uso y los costos, adecuada para la mayoría de los casos de uso de facturación y análisis de costos.
             </td>
           </tr>

           <tr>
             <td>
               Nombre de exportación
             </td>

             <td>
               `Name`
             </td>

             <td>
               Nombre de exportación que proporciona contexto al reporte CUR. (`eg-<company name-billing-cci>`)&gt;
             </td>
           </tr>

           <tr>
             <td>
               Tabla de datos
             </td>

             <td>
               `CUR 2.0`
             </td>

             <td>
               CUR 2.0 admite la estructura de tabla del formato FOCUS más reciente.
             </td>
           </tr>

           <tr>
             <td>
               Incluir identificadores de recursos
             </td>

             <td>
               `ON`
             </td>

             <td>
               Permite un seguimiento detallado de los costos asociados a los recursos individuales de AWS, lo que facilita un análisis y una facturación precisos.
             </td>
           </tr>

           <tr>
             <td>
               Datos de asignación de costos divididos
             </td>

             <td>
               `OFF`
             </td>

             <td>
               Si no es específicamente necesario, mantener esta opción desactivada simplifica la estructura de datos. Evita separar los datos en función de categorías o divisiones de costos personalizadas. Esto podría omitir a menos que se necesiten desgloses detallados de la asignación de costos para su análisis.
             </td>
           </tr>

           <tr>
             <td>
               detalle temporal
             </td>

             <td>
               `Hourly`
             </td>

             <td>
               Establece el detalle horario. Esta configuración es esencial para habilitar un análisis detallado de costos y uso, lo que respalda la funcionalidad de la plataforma.
             </td>
           </tr>

           <tr>
             <td>
               Tipo de compresión
             </td>

             <td>
               `Parquet`
             </td>

             <td>
               Un formato de archivo de almacenamiento columnar que mejora el rendimiento de las consultas y reduce el espacio de almacenamiento, lo que resulta beneficioso para procesar grandes volúmenes de datos de manera eficiente.
             </td>
           </tr>

           <tr>
             <td>
               Control de versiones de archivos
             </td>

             <td>
               `Create New Report Version`
             </td>

             <td>
               Cada actualización de CUR crea una nueva versión. Esto permite conservar los reportes históricos, que son útiles para auditar y realizar un seguimiento de los cambios de costos a lo largo del tiempo.
             </td>
           </tr>

           <tr>
             <td>
               Configuración de actualización de datos
             </td>

             <td>
               `AUTOMATIC`
             </td>

             <td>
               Garantiza que los datos de CUR se mantengan actualizados con la información más reciente sobre uso y costos sin intervención manual.
             </td>
           </tr>

           <tr>
             <td>
               Configuración de exportación de datos en el bucket S3
             </td>

             <td>
               `Existing (Select the bucket created in Step 1)`
             </td>

             <td>
               El archivo CUR creado se almacenaría en el bucket S3 con una ruta definida que se describe a continuación. Aceptamos sobreescribir la política (en el siguiente paso la asignaremos a una nueva).
             </td>
           </tr>

           <tr>
             <td>
               prefijo de ruta S3
             </td>

             <td>
               `cost-and-usage-reports`
             </td>

             <td>
               Garantiza que sus reportes de costos y uso (CUR) estén organizados y almacenados correctamente dentro del bucket S3, lo que facilita un acceso y una gestión eficientes.
             </td>
           </tr>
         </tbody>
       </table>

    6. Haz clic en **Next** y luego en **Create report**.

    <Callout variant="important">
      Recuerde el nombre de exportación, ya que lo necesitará en el paso de integración en CCI. Además, valide que el prefijo de ruta S3 sea para reportes de costos y uso.
    </Callout>

    <Callout variant="caution" title="Nota">
      El primer reporte CUR se entregará en un plazo de 24 horas. Los reportes posteriores se entregan periódicamente.
    </Callout>
  </Collapser>

  <Collapser id="iam-policy-cci-access" title="Política de IAM para el acceso a CCI">
    Cree una política de IAM que otorgue a CCI las licencias necesarias para acceder a sus datos CUR:

    1. Inicie sesión en **la consola de administración de AWS (AWS Management Console)**.
    2. Navegue al **IAM service**.
    3. Haz clic en **Policies** en el panel de navegación izquierdo.
    4. Haz clic en **Create policy**.
    5. Cambie al **editor JSON (JSON editor)** y pegue la siguiente política:

    ```json
    {
    "Version": "2012-10-17",
    "Statement": [
        {
        "Action": ["s3:Get*", "s3:List*"],
        "Effect": "Allow",
        "Resource": [
            "arn:aws:s3:::<bucket-name>/*",
            "arn:aws:s3:::<bucket-name>"
        ],
        "Sid": "AccessMasterPayerBillingBucket"
        },
        {
        "Effect": "Allow",
        "Action": [
            "pricing:DescribeServices",
            "pricing:GetAttributeValues",
            "pricing:GetProducts",
            "pricing:GetPriceListFileUrl",
            "pricing:ListPriceLists"
        ],
        "Resource": ["*"]
        }
    ]
    }
    ```

    <Callout variant="important">
      Reemplace bucket-name con el nombre real del bucket de S3 que creó en el paso **S3 bucket for Cost and Usage reports**.
    </Callout>

    6. Haga clic en **Next**.
    7. Asigne un nombre a la póliza `CCI-Access-Policy` (o el nombre que prefiera).
    8. Agrega una descripción.
    9. Haz clic en **Create policy**.
  </Collapser>

  <Collapser id="iam-role-cci-access" title="El rol de IAM que CCI debe asumir">
    Crea un rol de IAM que CCI asumirá para acceder a tus datos CUR:

    1. Inicie sesión en **la consola de administración de AWS (AWS Management Console)**.
    2. Navegue al servicio IAM.
    3. Haz clic en **Roles** en el panel de navegación izquierdo.
    4. Haz clic en **Create role**.
    5. Seleccione **Custom Trust Policy** en la sección de tipo de entidad de confianza.
    6. Pegue la siguiente definición de rol en el editor:
       ```json
       {
       "Version": "2012-10-17",
       "Statement": [
           {
           "Effect": "Allow",
           "Principal": {
               "AWS": "arn:aws:iam::207192125115:user/cci_global_user"
           },
           "Action": "sts:AssumeRole",
           "Condition": {
               "StringEquals": {
               "sts:ExternalId": "<externalID>"
               }
           }
           }
       ]
       }
       ```

    <Callout variant="caution" title="Nota">
      El externalId es un identificador único y dinámico del servicio de integración de CCI; se genera una vez que volvemos a CCI para iniciar la integración.
    </Callout>

    7. Haga clic en **Next**.
    8. Anexe la política creada en el paso [de acceso a CCI de la política de IAM](#iam-policy-cci-access).
    9. Haga clic en **Next**.
    10. Nombre del rol: `CCI-Access-Role` (o el nombre que prefiera).
    11. Agrega una descripción (opcional).
    12. Haz clic en **Create role**.
    13. Tras la creación del rol, anote el ARN del rol (que se muestra en la página de resumen del rol).

    <Callout variant="important">
      Deberá proporcionar el ARN del rol a CCI durante el proceso de integración.
    </Callout>
  </Collapser>
</CollapserGroup>

## Requisitos previos para la estimación de costos en tiempo real

Para habilitar la visualización de costos estimados en tiempo real en CCI, cerciorar de cumplir con los requisitos previos específicos asociados con su método de instrumentación:

<table>
  <thead>
    <tr>
      <th>
        Método
      </th>

      <th>
        Descripción
      </th>

      <th>
        Cuándo elegir
      </th>

      <th>
        Requisitos previos
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        agente de infraestructura e integración
      </td>

      <td>
        Emplea el agente New Relic Infrastructure para una monitorización detallada.
      </td>

      <td>
        Selecciónelo para una visibilidad/control profundo, ideal para configuraciones EC2, EKS/EC2 o ECS/EC2 independientes.
      </td>

      <td>
        * Si tiene una instancia EC2 independiente, instale el agente de infraestructura New Relic.
        * Si tiene EKS/EC2, instale la integración de Kubernetes.
        * Si tiene ECS/EC2, instale la integración de ECS. Este método no es compatible con AWS Fargate.
      </td>
    </tr>

    <tr>
      <td>
        integración en la nube (métrica)
      </td>

      <td>
        Emplea métricas de CloudWatch AWS para monitoreo casi en tiempo real.
      </td>

      <td>
        Opte por esta opción cuando los datos en tiempo real sean esenciales. Adecuado para entornos dinámicos que necesitan información actualizada.
      </td>

      <td>
        Configurar 

        [Amazon CloudWatch Metric Streams](/install/aws-cloudwatch/)

        .
      </td>
    </tr>

    <tr>
      <td>
        integración en la nube (sondeo) - legacy
      </td>

      <td>
        Recopila datos mediante consultas periódicas a los servicios de AWS.
      </td>

      <td>
        Adecuado para entornos que toleran actualizaciones menos frecuentes. Opción heredada empleada cuando el enfoque basado en métricas es menos factible.
      </td>

      <td>
        Configure 

        [la integración de encuestasAWS ](/docs/infrastructure/amazon-integrations/connect/set-up-aws-api-polling/)

        .
      </td>
    </tr>
  </tbody>
</table>

## Requisitos previos para la asignación de costos de Kubernetes

* [Instala la integración de Kubernetes](https://docs.newrelic.com/install/kubernetes/). La integración AWS Fargate no es compatible con esta característica.
* Además de las etiquetas estándar Kubernetes (`app.kubernetes.io/name`, `app.kubernetes.io/instance`, `app.kubernetes.io/component` y `app.kubernetes.io/part-of`), considere agregar dos etiquetas personalizadas como `environment` y `team` para indicar el entorno de implementación y el equipo responsable. Además, considere agregar dos etiquetas de recursos personalizadas como `project` y `costCenter`. Estas etiquetas y etiquetas de recursos lo ayudarán a segmentar y analizar mejor sus datos de asignación de costos Kubernetes.

## Recomendaciones

* Configure [la etiqueta de asignación de costos](https://docs.aws.amazon.com/tag-editor/latest/userguide/tagging.html) en su cuenta AWS. Etiqueta facilita una categorización de costos detallada y significativa. Cerciorar de que al menos dos etiquetas de recursos personalizadas se apliquen de manera consistente en todos sus recursos AWS para un filtrado y agrupamiento de costos efectivos.
* Emplee un bucket S3 ubicado en la región `us-east-2` para obtener un rendimiento óptimo y una mayor eficiencia en costos.

## Aviso sobre control de acceso

Todos los usuarios con acceso a la cuenta/organización designada New Relic pueden ver sus datos de costos en AWS cloud dentro de Inteligencia para costos en la nube. Le recomendamos que seleccione cuidadosamente la cuenta/organización New Relic adecuada que se ajuste a sus políticas internas de control de acceso para garantizar una gestión segura y conforme a las normas de los datos de costos cloud.

<Callout variant="important">
  **Acceso al bucket S3**

  New Relic solo requiere acceso de lectura a su bucket de S3, y este acceso está limitado a un único rol de IAM del lado de New Relic. Cerciorar de que este nivel de acceso se mantenga para proteger sus datos al tiempo que facilita las operaciones necesarias.
</Callout>