---
subject: Node.js agent
releaseDate: '2025-12-08'
version: 13.7.0
downloadLink: 'https://www.npmjs.com/package/newrelic'
security: []
bugs:
  - Fixed normalization of OTEL hrtime
features:
  - Updated `koa` instrumentation to properly wrap `Router` when using `@koa/router@15.0.0`+
  - Added ability to configure a ratio based sampler
  - 'Updated configuration to allow `adaptive.sampling_target` to be set for `config.distributed_tracing.sampler.root`, `config.distributed_tracing.sampler.remote_parent_sampled`, and `config.distributed_tracing.sampler.remote_parent_not_sampled`'
  - Added support for OTEL span links
  - Replaced `default` with `adaptive` as the default for samplers
  - Preliminary support for partial granularity traces (Not available for production use)
translationType: machine
---

## Notas

#### Característica

* Se actualizó la instrumentación `koa` para ajustar correctamente `Router` al usar `@koa/router@15.0.0`+ ([#3550](https://github.com/newrelic/node-newrelic/pull/3550)) ([f1e08ad](https://github.com/newrelic/node-newrelic/commit/f1e08ad9fe200138ab9ed32e423517f64e41af49))

* Se agregó la capacidad de configurar un muestreador basado en proporción ([#3501](https://github.com/newrelic/node-newrelic/pull/3501)) ([f300bd5](https://github.com/newrelic/node-newrelic/commit/f300bd5eacf9d6509b56484e7ad36d5c0725b497))

  * Para asignar un muestreador basado en proporción, configure `config.distributed_tracing.sampler.root`, `config.distributed_tracing.sampler.remote_parent_sampled` o `config.distributed_tracing.sampler.remote_parent_not_sampled` en `{ trace_id_ratio_based: { ratio: <float between 0 and 1> }}`
  * Para asignar mediante variables de entorno, establezca `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_<TYPE>='trace_id_ratio_based'` y `NEW_RELIC_DISTRIBUTED_TRACING_SAMPLER_<TYPE>_RATIO=<float between 0 and 1>` donde `<TYPE>` es uno de `ROOT`, `REMOTE_PARENT_SAMPLED` o `REMOTE_PARENT_NOT_SAMPLED`

* Configuración actualizada para permitir que `adaptive.sampling_target` se establezca para `config.distributed_tracing.sampler.root`, `config.distributed_tracing.sampler.remote_parent_sampled` y `config.distributed_tracing.sampler.remote_parent_not_sampled` ([#3532](https://github.com/newrelic/node-newrelic/pull/3532)) ([44f51dd](https://github.com/newrelic/node-newrelic/commit/44f51dd5583e74aef1e2d0ee9483d51d5ff786c3))

* Se agregó soporte para enlaces span OTEL ([#3528](https://github.com/newrelic/node-newrelic/pull/3528)) ([e840690](https://github.com/newrelic/node-newrelic/commit/e8406903dd0c92cd003fac69770785489e1bba85))

* Se reemplazó `default` por `adaptive` como valor predeterminado para los samplers ([#3543](https://github.com/newrelic/node-newrelic/pull/3543)) ([3f03162](https://github.com/newrelic/node-newrelic/commit/3f0316285fdde6d3c38ce819aa41221a71bd4fcb))

* Soporte preliminar para traza de detalle parcial (no disponible para uso en producción)

  * Se agregó el tipo `essential` para traza de detalle parcial ([#3547](https://github.com/newrelic/node-newrelic/pull/3547)) ([3d85fb5](https://github.com/newrelic/node-newrelic/commit/3d85fb5fa16d411892eb4a23067e66669461ada0))
  * Se agregó el tipo `reduced` para traza de detalle parcial. ([#3540](https://github.com/newrelic/node-newrelic/pull/3540)) ([cfa8f41](https://github.com/newrelic/node-newrelic/commit/cfa8f41618595cc5ffb3e3b5574673721c64580c))
  * Se agregaron muestreadores de detalle parcial y se asignan transacciones con `isPartialTrace` cuando se tomaron decisiones de ejemplificación de detalle parcial ([#3544](https://github.com/newrelic/node-newrelic/pull/3544)) ([1535a82](https://github.com/newrelic/node-newrelic/commit/1535a82331ce40d7c96e0c6746ec70bcdbd6e4f6))
  * Se refactorizaron los samplers en clases y se almacenaron en `agent.sampler.*` ([#3527](https://github.com/newrelic/node-newrelic/pull/3527)) ([ad63441](https://github.com/newrelic/node-newrelic/commit/ad634411a0d91240c0c16c7a372b00b36651589f))
  * Se actualizó la clase `Samplers` para normalizar los mensajes logger, cortocircuitar cuando corresponda y eliminar las comprobaciones de cadena opcionales ([#3546](https://github.com/newrelic/node-newrelic/pull/3546)) ([4f7684c](https://github.com/newrelic/node-newrelic/commit/4f7684cb4c64a89545704c70c110d2fd13815197))
  * Muestreadores actualizados para asignar prioridad entre 0 y 1 cuando DT está deshabilitado o el detalle total y parcial están deshabilitadas ([#3559](https://github.com/newrelic/node-newrelic/pull/3559)) ([7a1c37e](https://github.com/newrelic/node-newrelic/commit/7a1c37e3e04fef0538a8af15fa690915bce65262))
  * Transacción actualizada para almacenar el indicador de detalle parcial como `.partialType` ([#3561](https://github.com/newrelic/node-newrelic/pull/3561)) ([a7f20d8](https://github.com/newrelic/node-newrelic/commit/a7f20d8e83b44556434bae90bd3924c54af9f587))
  * Se actualiza cuando se aplican reglas de detalle parcial ([#3553](https://github.com/newrelic/node-newrelic/pull/3553)) ([a4bdf4f](https://github.com/newrelic/node-newrelic/commit/a4bdf4fbbbdac102519020c5ca4d3dc92eeff844))
  * Se agregaron `toString` y `get [Symbol.toStringTag]()` a la clase Sampler predeterminada ([#3562](https://github.com/newrelic/node-newrelic/pull/3562)) ([771168d](https://github.com/newrelic/node-newrelic/commit/771168dcd927240b6efc703f238046e9a7f7766b))

#### Corrección de errores

* Se corrigió la normalización del horario de OTEL ([#3564](https://github.com/newrelic/node-newrelic/pull/3564)) ([707fe7d](https://github.com/newrelic/node-newrelic/commit/707fe7d6395f0e15b5e6c6195f93df1c27540423))

#### Documentación

* Reporte de compatibilidad actualizado ([#3551](https://github.com/newrelic/node-newrelic/pull/3551)) ([02268a4](https://github.com/newrelic/node-newrelic/commit/02268a4e3fe7b2f2f5c2fd035bcb337fd7b2bfc2))
* Se agregó documentación interna para el atributo ([#3539](https://github.com/newrelic/node-newrelic/pull/3539)) ([68543b6](https://github.com/newrelic/node-newrelic/commit/68543b606fc53e59e9a6fcb08173e423bc6437a9))

#### Tareas varias

* Logging mejorado alrededor de la carga útil `preconnect`

  * Se agregó más logging sobre la asignación de nombre de host durante `preconnect` ([#3568](https://github.com/newrelic/node-newrelic/pull/3568)) ([3ee4d38](https://github.com/newrelic/node-newrelic/commit/3ee4d383cd7d9e7bf16e9da5e7f130fc2a103ca4))
  * Logging de utilización de GCP mejorado ([#3552](https://github.com/newrelic/node-newrelic/pull/3552)) ([e6c4141](https://github.com/newrelic/node-newrelic/commit/e6c4141b55860b5f1fe5cd14049abb9eca9b3859))

* La resolución de utilización ahora se realiza de forma concurrente ([#3556](https://github.com/newrelic/node-newrelic/pull/3556)) ([8386360](https://github.com/newrelic/node-newrelic/commit/8386360fe7fb4b7278e001dac8c8293581654069))

* Se recopilaron metadatos del alcance de instrumentación de OTEL en todos los tramos de OTEL. ([#3554](https://github.com/newrelic/node-newrelic/pull/3554)) ([75703c4](https://github.com/newrelic/node-newrelic/commit/75703c41a8db1d204a1500b8b43dff0d04a5b286))

* Procesamiento mejorado del horario de OTEL ([#3557](https://github.com/newrelic/node-newrelic/pull/3557)) ([8f187b1](https://github.com/newrelic/node-newrelic/commit/8f187b11eac96f78d9743cadb2302001ed94412a))

* Se cambió el nombre de la configuración `opentelemetry_bridge` a `opentelemetry` ([#3565](https://github.com/newrelic/node-newrelic/pull/3565)) ([c9d156f](https://github.com/newrelic/node-newrelic/commit/c9d156fe302ffb99b262ffd3e256d953301f08f2))

### Declaración de apoyo:

Recomendamos actualizar a la última versión del agente tan pronto como esté disponible. Si no puede actualizar a la última versión, actualice su agente a una versión que no tenga más de 90 días de antigüedad. Obtenga más información sobre cómo mantener al agente actualizado. ([https:\\/\\/docs.newrelic.com\\/docs\\/new-relic-solutions\\/new-relic-one\\/install-configure\\/update-new-relic-agent\\/](https://docs.newrelic.com/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/))

Consulte la política de EOL del agente Node.js de New Relic para obtener información sobre los lanzamientos del agente y las fechas de soporte. ([https:\\/\\/docs.newrelic.com\\/docs\\/apm\\/agents\\/nodejs-agent\\/getting-started\\/nodejs-agent-eol-policy\\/](https://docs.newrelic.com/docs/apm/agents/nodejs-agent/getting-started/nodejs-agent-eol-policy/))