---
subject: Ruby agent
releaseDate: '2026-01-14'
version: 10.0.0
downloadLink: 'https://rubygems.org/downloads/newrelic_rpm-10.0.0.gem'
features:
  - Remove support for Ruby 2.4 and 2.5
  - Removal of Cross Application Tracing (CAT)
  - Rename ActiveJob metrics and segments
  - Rename `bin/newrelic` command to `bin/newrelic_rpm`
  - Remove the `newrelic deployments` CLI command
  - 'Remove the NewRelic::Agent::SqlSampler#notice_sql method'
  - 'Remove unused arguments from various NewRelic::Agent::Datastores APIs'
  - Remove experimental feature Configurable Security Policies (CSP)
  - Remove support for Puma versions below 3.9.0
  - Improve configuration validation and coercion
  - Replace 'default' option with 'adaptive' for distributed tracing remote parent samplers
  - Add `logger` as a dependency
  - Add Active Support notification allowlist configuration option
  - Use Ruby's built-in Gzip compression
  - 'Add argument validation for the `NewRelic::Agent#record_custom_event` API'
  - Add root sampling configuration options
  - Add Trace ID Ratio Based sampling options
  - Add Entity GUID to Agent Control health check files
bugs:
  - Resolve a `NoMethodError` in GCP utilization detection.
security: []
translationType: machine
---

<Callout variant="important">
  **Actualización de versión principal:** Esta versión del agente de Ruby es una actualización MAYOR de SemVer y contiene cambios importantes. Las versiones MAYORES pueden dejar de ser compatibles con los entornos de ejecución de lenguaje que hayan llegado al final de su vida útil según el mantenedor. Además, las versiones MAYORES pueden dejar de ser compatibles y eliminar ciertas instrumentaciones. Para obtener más detalles sobre estos cambios, consulte la guía de migración [aquí](/docs/apm/agents/ruby-agent/getting-started/migration-10x-guide/).
</Callout>

<Callout variant="important">
  Recomendamos actualizar a la última versión del agente tan pronto como esté disponible. Si no puede actualizar a la última versión, actualice su agente a una versión que no tenga más de 90 días de antigüedad. Obtenga más información sobre [cómo mantener al agente actualizado](/docs/new-relic-solutions/new-relic-one/install-configure/update-new-relic-agent/).

  Consulte la [política de fin de vida](/docs/apm/agents/ruby-agent/getting-started/ruby-agent-eol-policy/) del agente Ruby New Relic para obtener información sobre los lanzamientos del agente y las fechas de soporte.
</Callout>

## v10.0.0

* **Cambio importante: Eliminar la compatibilidad con Ruby 2.4 y 2.5**

  Se ha eliminado la compatibilidad con las versiones 2.4 y 2.5 de Ruby. La nueva versión mínima requerida de Ruby es ahora la 2.6. [PR#3314](https://github.com/newrelic/newrelic-ruby-agent/pull/3314)

* **Cambio importante: Eliminación del rastreo entre aplicaciones (CAT)**

  Anteriormente, el Cross Application Tracing (CAT) fue desaprobado a favor del Distributed Tracing. La funcionalidad CAT ahora ha sido eliminada. La opción de configuración `cross_application_tracer.enabled` ha sido eliminada. Los métodos de la API pública `NewRelic::Agent::External.process_request_metadata`, `NewRelic::Agent::External.get_response_metadata`, `NewRelic::Agent::Transaction::ExternalRequestSegment#process_response_metadata`, `NewRelic::Agent::Transaction::ExternalRequestSegment#get_request_metadata` y `NewRelic::Agent::Transaction::ExternalRequestSegment#read_response_headers` también se han eliminado. [PR#3333](https://github.com/newrelic/newrelic-ruby-agent/pull/3333)

* **Cambio importante: Renombrar las métricas y segmentos de ActiveJob**

  Las métricas de ActiveJob se han actualizado para incluir el nombre de la clase del trabajo para informes más específicos. Este es un cambio importante y puede requerir la actualización de paneles o alertas personalizadas. [PR#3370](https://github.com/newrelic/newrelic-ruby-agent/pull/3370) [PR#3320](https://github.com/newrelic/newrelic-ruby-agent/pull/3320)

  * Formato antiguo: `Ruby/ActiveJob/<QueueName>/<Method>`
  * Nuevo formato: `Ruby/ActiveJob/<QueueName>/<ClassName>/<Method>`

  Además, los segmentos creados para las acciones de puesta en cola de Active Job ahora incluyen la clase de trabajo.

  * Formato antiguo: `ActiveJob/<QueueAdapter>/Queue/<Event>/Named/<QueueName>`
  * Nuevo formato: `ActiveJob/<QueueAdapter>/Queue/<Event>/Named/<QueueName>/<ClassName>`

* **Cambio importante: Renombrar el comando `bin/newrelic` a `bin/newrelic_rpm`**

  El archivo ejecutable para la CLI del agente se ha renombrado de `bin/newrelic` a `bin/newrelic_rpm`. Este cambio resuelve un conflicto de nombres con la herramienta CLI independiente de New Relic. [PR#3323](https://github.com/newrelic/newrelic-ruby-agent/pull/3323)

* **Cambio importante: Eliminar el comando CLI `newrelic deployments`**

  El comando CLI `newrelic deployments` obsoleto se ha eliminado. Para rastrear los cambios y las implementaciones en New Relic, consulte nuestra guía sobre [Seguimiento de cambios](https://docs.newrelic.com/docs/change-tracking/change-tracking-introduction/) para obtener una lista de las opciones disponibles. [PR#3299](https://github.com/newrelic/newrelic-ruby-agent/pull/3299)

* **Cambio importante: Eliminar el método NewRelic::Agent::SqlSampler#notice\_sql**

  Los usuarios deben llamar a `NewRelic::Agent::Datastores.notice_sql` en su lugar. [PR#3338](https://github.com/newrelic/newrelic-ruby-agent/pull/3338)

* **Cambio importante: Eliminar argumentos no utilizados de varias API de NewRelic::Agent::Datastores**

  Se han eliminado los argumentos de los métodos de las siguientes API de la clase `NewRelic::Agent::Datastores`:

  * `NewRelic::Agent::Datastores.notice_sql`, anteriormente tenía tres argumentos posicionales, `query`, `scoped_metric` y `elapsed`. Ahora, solo tiene `query`.
  * `NewRelic::Agent::Datastores.notice_statement`, anteriormente tenía dos argumentos posicionales `query` y `elapsed`. Ahora solo tiene `query`.
  * `NewRelic::Agent::Datastores.wrap` requiere un proc. Anteriormente, el proc recibía tres argumentos: el resultado del yield, el nombre de la métrica con ámbito más específico y el tiempo transcurrido de la llamada. Ahora, solo recibe uno: el resultado del yield.

  Los valores de los argumentos eliminados se derivan del segmento actual en el momento de la llamada. [PR#3347](https://github.com/newrelic/newrelic-ruby-agent/pull/3347)

* **Cambio importante: Eliminar la función experimental Políticas de seguridad configurables (CSP)**

  La función experimental, Políticas de seguridad configurables (CSP), ya no es compatible y se ha eliminado. [PR#3292](https://github.com/newrelic/newrelic-ruby-agent/pull/3292)

* **Cambio importante: Eliminar la compatibilidad con las versiones de Puma &apos;&lt;&apos; 3.9.0**

  La versión mínima de Puma ahora compatible es 3.9.0 o superior. [PR#3326](https://github.com/newrelic/newrelic-ruby-agent/pull/3326)

* **Cambio importante: Mejorar la validación y coerción de la configuración**

  Los mecanismos internos utilizados para forzar y validar los valores proporcionados para la configuración del agente ahora son más eficientes y precisos.

  * Los mensajes de advertencia ahora se registrarán en el archivo newrelic\_agent.log cuando se proporcione nil como valor de configuración para una configuración que no lo admita.
  * Se permiten valores enteros para los tipos de configuración Float
  * Se permiten valores Float para los tipos de configuración Integer
  * Se evitan las interrupciones fatales cuando se puede encontrar un valor predeterminado para reemplazar un valor de entrada no válido [PR#3341](https://github.com/newrelic/newrelic-ruby-agent/pull/3341)

* **Cambio importante: Reemplazar la opción &apos;default&apos; con &apos;adaptive&apos; para los muestreadores remotos de tracing distribuido**

  Anteriormente, la opción predeterminada para `distributed_tracing.sampler.remote_parent_sampled` y `distributed_tracing.sampler.remote_parent_not_sampled` era `default`, que utilizaba el muestreador adaptativo preexistente. La opción `default` ha sido renombrada a `adaptive`. [PR#3363](https://github.com/newrelic/newrelic-ruby-agent/pull/3363)

* **Función: Agregar `logger` como dependencia**

  La gema `logger` ahora se enumera como una dependencia del agente para garantizar la funcionalidad de logging continuo y la compatibilidad con Ruby 4.0.0 y versiones más recientes. [PR#3293](https://github.com/newrelic/newrelic-ruby-agent/pull/3293)

* **Función: Agregar la opción de configuración de lista de permitidos de notificación de Active Support**

  Una nueva opción de configuración, `instrumentation.active_support_notifications.active_support_events`, permite a los usuarios definir una lista de permitidos de nombres de eventos de notificaciones de Active Support a los que el agente debe suscribirse. De forma predeterminada, el agente se suscribe a todos los eventos de [Active Support: Caching](https://guides.rubyonrails.org/active_support_instrumentation.html#active-support-caching) y [Active Support: Messages](https://guides.rubyonrails.org/active_support_instrumentation.html#active-support-messages). [PR#3327](https://github.com/newrelic/newrelic-ruby-agent/pull/3327)

* **Función: Usar la compresión Gzip integrada de Ruby**

  El agente ahora utiliza el método `Zlib.gzip` incorporado de la biblioteca estándar de Ruby para la compresión, reemplazando la implementación personalizada anterior. [PR#3332](https://github.com/newrelic/newrelic-ruby-agent/pull/3332)

* **Función: Agregar la validación de argumentos para la API `NewRelic::Agent#record_custom_event`**

  La API `NewRelic::Agent#record_custom_event` ahora genera un `ArgumentError` cuando se proporciona un `event_type` no válido. Un tipo de evento válido debe consistir solo en caracteres alfanuméricos, guiones bajos (`_`), dos puntos (`:`) o espacios (` `). [PR#3319](https://github.com/newrelic/newrelic-ruby-agent/pull/3319)

* **Función: Agregar opciones de configuración de muestreo raíz**

  Ahora puede configurar el comportamiento de muestreo para los rastreos que se originan dentro del servicio actual utilizando `distributed_tracing.sampler.root`. [PR#3330](https://github.com/newrelic/newrelic-ruby-agent/pull/3330)

  Hay cuatro modos disponibles:

  | Modo                   | Descripción                                                                                                                                                                   |
  | ---------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | `adaptive`             | Utiliza el algoritmo de muestreador adaptativo existente                                                                                                                      |
  | `always_off`           | Marca el 0% de los rastreos raíz como muestreados                                                                                                                             |
  | `always_on`            | Marca el 100% de los rastreos raíz como muestreados                                                                                                                           |
  | `trace_id_ratio_based` | Muestras de trazas basadas en una proporción establecida en `distributed_tracing.sampler.root.trace_id_ratio_based.ratio`. La proporción debe ser un flotante entre 0.0 y 1.0 |

* **Función: Agregar opciones de muestreo basadas en la proporción de ID de rastreo**

  El agente ahora puede muestrear rastreos utilizando el algoritmo de muestreador basado en la proporción de ID de rastreo de OpenTelemetry. [PR#3330](https://github.com/newrelic/newrelic-ruby-agent/pull/3330) Esto muestrea rastreos en función de una probabilidad entre 0,0 y 1,0 basada en el ID de rastreo.

  Para usar esta opción, primero debe configurar su configuración de muestreador de rastreo distribuido en `trace_id_ratio_based` y luego configurar el muestreador `distributed_tracing.sampler.*.trace_id_ratio_based.ratio` correspondiente en un Float entre 0.0 y 1.0.

  Por ejemplo:

  ```yaml
    distributed_tracing.sampler.remote_parent_sampled: 'trace_id_ratio_based'
    distributed_tracing.sampler.remote_parent_sampled.trace_id_ratio_based.ratio': 0.5
  ```

  Esta configuración muestrearía aproximadamente el 50% de sus rastreos para todos los rastreos donde el elemento principal remoto se muestrea.

  Esta opción está disponible para:

  * `distributed_tracing.sampler.root`
  * `distributed_tracing.sampler.remote_parent_sampled`
  * `distributed_tracing.sampler.remote_parent_not_sampled`

* **Función: Agregar GUID de entidad a los archivos de comprobación de estado de Agent Control**

  Cuando el agente se inicia dentro de un entorno de [Control de agente](https://docs-preview.newrelic.com/docs/new-relic-agent-control), se crea un archivo de verificación de estado en la ubicación de archivo configurada para cada proceso de agente. Este archivo ahora incluye el guid de la entidad relacionada con el agente cuando está disponible. [PR#3371](https://github.com/newrelic/newrelic-ruby-agent/pull/3371)

* **Corrección de errores: Resolver un `NoMethodError` en la detección de utilización de GCP.**

  La lógica de descubrimiento de metadatos de GCP ahora manejará con elegancia `nil` o valores inesperados, evitando fallos en la inicialización del servicio. [PR#3388](https://github.com/newrelic/newrelic-ruby-agent/pull/#3388)