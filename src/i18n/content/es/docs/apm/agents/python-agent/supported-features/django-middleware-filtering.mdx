---
title: Filtrado de instrumentación de middleware de Django
tags:
  - Agents
  - Python agent
  - Supported features
metaDescription: Python agent (Django) middleware instrumentation filtering
freshnessValidatedDate: never
translationType: machine
---

El agente de Python ahora puede filtrar qué middleware de Django debe ser monitoreado. De forma predeterminada, todo el middleware estará instrumentado.

<Callout variant="important">
  El filtrado de instrumentación de middleware para Django está disponible para la versión 10.17.0 y superiores del agente Python. De forma predeterminada, todo el middleware estará instrumentado. Para cambiar esta configuración, consulte nuestra [documentación](/docs/apm/agents/python-agent/configuration/python-agent-configuration/#middleware-filters).
</Callout>

## Deshabilitar todo el middleware de Django [#django-middleware-disable]

La deshabilitación de la instrumentación de middleware en Django se puede realizar de dos maneras:

1. Establezca la variable de entorno `NEW_RELIC_INSTRUMENTATION_DJANGO_MIDDLEWARE_ENABLED` en `False`
2. Establezca `instrumentation.middleware.django.enabled = false` en el archivo de configuración.

## Configuración del middleware Django [#django-middleware-configuration-settings]

<CollapserGroup>
  <Collapser id="config-middleware-django-include" title="instrumentation.middleware.django.include">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo:
          </th>

          <td>
            Lista de cadenas separadas por espacios
          </td>
        </tr>

        <tr>
          <th>
            Por defecto:
          </th>

          <td>
            (ninguno)
          </td>
        </tr>
      </tbody>
    </table>

    Si los atributos están habilitados, se enviarán todas las claves de atributos de esta lista.
  </Collapser>

  <Collapser id="config-middleware-django-exclude" title="instrumentation.middleware.django.exclude">
    <table>
      <tbody>
        <tr>
          <th>
            Tipo:
          </th>

          <td>
            Lista de cadenas separadas por espacios
          </td>
        </tr>

        <tr>
          <th>
            Por defecto:
          </th>

          <td>
            (ninguno)
          </td>
        </tr>
      </tbody>
    </table>

    **No** se enviarán todas las claves de atributos de esta lista.
  </Collapser>
</CollapserGroup>

## Reglas de exclusión/inclusión de middleware [#django-middleware-rules]

El agente sigue estas reglas al determinar qué middleware incluir o excluir para el monitoreo:

<CollapserGroup>
  <Collapser id="rule-destination-precedence" title="Habilitado tiene prioridad sobre incluir y excluir.">
    Las banderas `instrumentation.middleware.FRAMEWORK.enabled` tienen prioridad sobre los middlewares de inclusión y exclusión.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = false
    instrumentation.middleware.django.include = one two
    instrumentation.middleware.django.include = three four
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: one, two, three, four
    Middleware included for monitoring:
    Middleware excluded for monitoring: one, two, three, four
    ```
  </Collapser>

  <Collapser id="rule-included-destination" title="El middleware está incluido si el destino está habilitado.">
    Si un destino está habilitado, todo el middleware se envía a ese destino de forma predeterminada.

    Todos los monitoreos de middleware tienen como valor predeterminado `true`.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = baz
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: foo, bar, baz
    Middleware included for monitoring: foo, bar
    Middleware excluded for monitoring: baz
    ```
  </Collapser>

  <Collapser id="rule-exclude-wins" title="Excluir siempre reemplaza a incluir.">
    Si el mismo middleware aparece en las listas de inclusión y exclusión, se excluirá el middleware con el nombre especificado.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = foo bar
    instrumentation.middleware.django.exclude = nerd bar
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: foo, bar, nerd
    Middleware included for monitoring: foo
    Middleware excluded for monitoring: nerd, bar
    ```
  </Collapser>

  <Collapser id="rule-middleware-name-case-sensitive" title="Los nombres de middleware distinguen entre mayúsculas y minúsculas.">
    Los nombres de middleware distinguen entre mayúsculas y minúsculas.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.exclude = username UsErNaMe
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: username, Username, USERNAME, UsErNaMe, userNAME
    Middleware included for monitoring:  Username, USERNAME, userNAME
    Middleware excluded for monitoring:  username, UsErNaMe
    ```
  </Collapser>

  <Collapser
    id="rule-star-wildcard"
    title={<>Utilice <InlineCode>
      \*
    </InlineCode> como comodín.</>
    }
  >
    Puede emplear un asterisco `*` al final de un nombre como comodín. Esto coincidirá con un conjunto de middleware con el mismo prefijo.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = custom*
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: custom, custom.key1, custom.key2, request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: custom, custom.key1, custom.key2
    Middleware excluded for monitoring: request.parameters., request.parameters.foo, request.parameters.bar
    ```
  </Collapser>

  <Collapser id="rule-specific-wins" title="El nombre del middleware más específico tiene prioridad.">
    Si varios nombres de inclusión o exclusión afectan al mismo middleware, el nombre más específico tendrá prioridad.

    Configuración de ejemplo:

    ```ini
    instrumentation.middleware.django.enabled = true
    instrumentation.middleware.django.include = request.parameters.foo
    instrumentation.middleware.django.exclude = request.parameters.*
    ```

    Salida de ejemplo:

    ```
    Middleware used in app: request.parameters., request.parameters.foo, request.parameters.bar
    Middleware included for monitoring: request.parameters.foo
    Middleware included for monitoring: request.parameters., request.parameters.bar
    ```
  </Collapser>
</CollapserGroup>