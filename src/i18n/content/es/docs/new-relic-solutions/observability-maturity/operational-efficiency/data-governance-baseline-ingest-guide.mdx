---
title: Línea de base tu ingesta de datos
tags:
  - Observability maturity
  - Operational efficiency
  - Data ingest cost
  - Sampling rate
  - Drop rules
  - Observability as code
  - Value drivers
  - Bill and Usage Data
  - Data ingest cost
metaDescription: 'The second part of New Relic''s data ingest governance series on optimizing how you ingest and use your telemetry data: this focuses on baselining your data ingest.'
freshnessValidatedDate: never
translationType: machine
---

import omaoedgBaselineIcon from 'images/oma-oe-dg_icon_baseline.webp'

import omaoedgSimpleCompareWithTimeSeries from 'images/oma-oe-dg_screenshot-full_simple-compare-with-time-series.webp'

import omaoedgJaggedDailyRateTimeSeries from 'images/oma-oe-dg_screenshot-full_jagged-daily-rate-timeseries.webp'

import omaoedgSlidingWindowSmoothExample from 'images/oma-oe-dg_screenshot-full_smoothed-daily-rate-timeseries.webp'

import omaoedgDerivativeExample from 'images/oma-oe-dg_screenshot-crop-rate-of-growth-time-series.webp'

import omaoedgEventTypeExample from 'images/oma-oe-dg_screenshot-full_facet-event-type-example.webp'

import omaoedgFacetMetricnameExample from 'images/oma-oe-dg_screenshot-full_facet-metricname-example.webp'

import omaoedgDataIngestGovBaselineOverviewTab from 'images/oma-oe-dg_screenshot-full_data-ingest-gov-baseline-overview.webp'

import omaoedgDataIngestGovBaselineReportsTab from 'images/oma-oe-dg_screenshot-full_data-ingest-gov-baseline-reports.webp'

import omaoedgDataIngestGovBaselineBrowserTab from 'images/oma-oe-dg_screenshot-full_data-ingest-gov-baseline-browser.webp'

import omaoedgThirtyDayRateTargetLine from 'images/oma-oe-dg_screenshot-full_target-30-day-rate-ts.webp'

import omaoedgIngestTargetLine from 'images/oma-oe-dg_screenshot-full_ingest-target-line.webp'

import omaoedgBaselineSheet from 'images/oma-oe-dg_diagram_baseline-sheet.webp'

import omaoedgLookoutViewTelemType from 'images/oma-oe-dg_screenshot-crop_lookout-view-telem-type.webp'

import omaoedgLookoutViewConsumingAccount from 'images/oma-oe-dg_screenshot-crop_lookout-view-consuming-account.webp'

import omaoedgInfraIntegrationsNrIo from 'images/oma-oe-dg_screenshot-full_infra-integrations-nr-io.webp'

import omaoedgEntityBreakdownDash from 'images/oma-oe-dg_screenshot-full_entity-breakdown-dash.webp'

<img
  src={omaoedgBaselineIcon}
  alt="Baseline"
  style={{ height: '96px', width: '120px', verticalAlign: 'middle' }}
/>

<DoNotTranslate>**Data ingest governance**</DoNotTranslate> es la práctica de obtener un valor óptimo para los telemetry data recopilados por una organización. Esto es especialmente importante para una organización compleja que tiene numerosas unidades de negocio y grupos de trabajo. Esta es la segunda parte de una guía de cuatro partes para optimizar la ingesta de datos de New Relic y es parte de [nuestra serie sobre madurez de observabilidad](/docs/new-relic-solutions/observability-maturity/introduction).

## Antes de que empieces [#before-start]

Esta guía contiene recomendaciones detalladas para optimizar la ingesta de datos. Antes de utilizar esta guía, le recomendamos revisar [nuestros documentos generales de gestión de datos](/docs/data-apis/manage-data/manage-your-data).

## Sobre esta etapa [#about]

Para esta etapa de su práctica de gobernanza de ingesta de datos, es necesario obtener una vista de alto nivel de toda la telemetría que genera actualmente su organización. La unidad se centra en desglosar las estadísticas de ingesta en varios grupos, como cuenta, tipo de telemetría y aplicación. Estas cifras se utilizarán para informar las etapas de [Optimice sus datos de ingesta](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-optimizing) y [Pronostique sus datos de ingesta](/docs/new-relic-solutions/observability-maturity/operational-efficiency/data-governance-forecast-ingest-guide/) .

Aprenderá cómo generar un informe de desglose estructurado para las siguientes dimensiones:

* Organización
* Cuentas específicas en su organización
* Tipo de telemetría facturable

Además, aprenderá a crear desgloses altamente granulares que incluyen:

* Aplicación (APM | browser | móvil)
* Cluster de kubernetes
* Integración de infraestructura

## Resultado deseado [#desired-outcome]

Comprenda exactamente qué grupos dentro de su organización contribuyen con qué tipos de datos y en qué cantidad.

## Requisitos previos [#prereqs]

<CollapserGroup>
  <Collapser
    id="understand-nr-consumption-metrics"
    title="Comprender los tipos de eventos de consumo"
  >
    Toda la telemetría facturable se rastrea con nuestro evento `NrConsumption` y `NrMTDConsumption` . Esta guía se centra en cómo consultar `NrConsumption`, que proporciona datos más detallados y en tiempo real que `NrMTDConsumption`. El atributo `NrConsumption` `usageMetric` indica el tipo de telemetría.

    Con `NrConsumption`, puede hacer preguntas como "¿Cuántos datos <InlinePopover type="browser"/>ha ingerido cada cuenta en los últimos 30 días?" y "¿Cómo ha cambiado la ingesta desde los 30 días anteriores?" Aquí hay una consulta que devuelve esos datos:

    ```sql
    FROM NrConsumption SELECT sum(GigabytesIngested) WHERE usageMetric = 'BrowserEventsBytes' SINCE 30 days AGO COMPARE WITH 30 days AGO FACET consumingAccountName
    ```

    La respuesta le muestra cuántos GB de datos de monitoreo del navegador ha ingerido por cuenta.

    ```shell
    Banking platform, 75 GB, +2.9%
    Marketing platform, 40 GB, -1.3%
    ```

    A continuación se muestra un desglose de los diferentes tipos de `usageMetric` , el evento constituyente (tipos de evento donde se almacenan los datos) y el tipo de agente o mecanismo responsable de crear la ingesta de datos.

    ### Tabla de desglose de telemetría facturable

    <table>
      <thead>
        <tr>
          <th style={{ width: "200px" }}>
            NrcConsumption.usageMetric
          </th>

          <th style={{ width: "200px" }}>
            Evento constituyente
          </th>

          <th>
            Fuente
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            InfraHostBytes
          </td>

          <td>
            `SystemSample`, `StorageSample`, `InfrastructureEvent`, `NetworkSample`
          </td>

          <td>
            Agente de infraestructura
          </td>
        </tr>

        <tr>
          <td>
            InfraProcesoBytes
          </td>

          <td>
            `ProcessSample`
          </td>

          <td>
            Agente de infraestructura
          </td>
        </tr>

        <tr>
          <td>
            InfraIntegraciónBytes
          </td>

          <td>
            Varios eventos para integración de plataforma de terceros así como `ContainerSample`
          </td>

          <td>
            [integración en el host](/docs/infrastructure/host-integrations/get-started/introduction-host-integrations/) y cierta [integración en la nube](/docs/infrastructure/infrastructure-integrations/get-started/introduction-infrastructure-integrations/#cloud)
          </td>
        </tr>

        <tr>
          <td>
            ApmEventsBytes
          </td>

          <td>
            `Transaction`, `TransactionError` y posiblemente `WorkloadStatus`
          </td>

          <td>
            Agente(s) APM
          </td>
        </tr>

        <tr>
          <td>
            Seguimiento de bytes
          </td>

          <td>
            `Span`, `SpanEvent`
          </td>

          <td>
            Agente(s) APM y OpenTelemetry
          </td>
        </tr>

        <tr>
          <td>
            NavegadorEventosBytes
          </td>

          <td>
            `Browser`, `BrowserInteraction`, `Browser:EventLog`, `Browser:JSErrors`, `JavaScriptError`, `PageView`, `PageViewTiming`, `PcvPerf`
          </td>

          <td>
            Agente del navegador
          </td>
        </tr>

        <tr>
          <td>
            MóvilEventosBytes
          </td>

          <td>
            `Mobile`, `MobileReqest`, `MobileRequestError`, `MobileSession`, `MobileHandleException`, `MobileCrash`
          </td>

          <td>
            Agente móvil
          </td>
        </tr>

        <tr>
          <td>
            Bytes sin servidor
          </td>

          <td>
            Específico de la nube (es decir, evento AWS Lambda)
          </td>

          <td>
            Específico de la nube (es decir, integración de AWS Lambda)
          </td>
        </tr>

        <tr>
          <td>
            Bytes de registro
          </td>

          <td>
            `Log` así como el evento específico de la partición del patrón `[partition].Log`
          </td>

          <td>
            Varios (Fluentd, FluentBit, Syslog, servicios de streaming específicos de la nube)
          </td>
        </tr>

        <tr>
          <td>
            MétricaEventBytes
          </td>

          <td>
            `Metric`
          </td>

          <td>
            Desde la API métrica y la integración que la utilizan ([dimensional métrica](/docs/data-apis/understand-data/new-relic-data-types/#dimensional-metrics)), o desde agentes como agente del browser, agente APM o agente móvil ([intervalo de tiempo de métrica data](/docs/data-apis/understand-data/new-relic-data-types/#timeslice-data)).
          </td>
        </tr>

        <tr>
          <td>
            Bytes de evento personalizados
          </td>

          <td>
            Varios
          </td>

          <td>
            Varias API. [Utilice `SHOW EVENT TYPES` para ver todos los tipos de eventos disponibles en una cuenta](#show-event-types).
          </td>
        </tr>
      </tbody>
    </table>
  </Collapser>

  <Collapser
    id="understand-monthly-ingest-targets"
    title="Comprenda el objetivo de ingesta mensual de su organización"
  >
    Para nuestro [modelo de precios basado en el uso](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/new-relic-one-pricing-billing), telemetry data y el usuario contribuyen a su uso y costo. Esta guía se centra en maximizar el valor de telemetry data. La mención de usuario en esta sección es para ayudarle a comprender las diferentes opciones para equilibrar usuario y datos.

    Hay tres tipos generales de planes de uso. Su plan de uso puede afectar la forma en que establece el objetivo de ingesta para su organización.

    ### Contratos de compromiso

    Si tiene un [contrato de compromiso](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/new-relic-one-pricing-billing/#usage-plans), probablemente tendrá un presupuesto objetivo mensual para la ingesta de datos. Por ejemplo, es posible que haya establecido un objetivo de 5 TB por día y 100 usuarios de plataforma completa. En este tipo de contrato, el usuario puede ser "comprometido", pero es mejor discutir esto con otras partes interesadas de su organización para asegurarse de obtener la combinación adecuada para sus objetivos de observabilidad. Aunque algunos clientes planificarán la variabilidad en su consumo durante el año, supongamos por ahora que su presupuesto de consumo mensual es su tarifa de compromiso anual total dividida por 12.

    Si conoce la cantidad de usuarios de plataforma completa y usuarios principales que necesita, puede usar esta fórmula:

    ```sql
    (monthly_target_spend - (num_fso_users*per_fso_cost) - (num_core_users*per_core_cost))/YOUR_INGESTED_DATA_COST
    ```

    ¿No estás seguro del coste de tus datos? Consulte [Datos ingeridos](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/data-ingest-billing#data-prices).

    ### Pago por uso

    En un [plan de pago por uso,](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/new-relic-one-pricing-billing/#usage-plans) no tendrá un compromiso anual predeterminado; sin embargo, probablemente tendrá un límite entendido para su gasto mensual. En este modelo, haría lo siguiente para determinar su ingesta objetivo:

    ```sql
    (monthly_target_spend - (num_fso_users*per_fso_cost) - (num_core_users*per_core_cost))/YOUR_INGESTED_DATA_COST
    ```

    ¿No estás seguro del coste de tus datos? Consulte [Datos ingeridos](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/data-ingest-billing#data-prices).

    ### Edición gratuita [#free-tier]

    Con todas [nuestras ediciones](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/new-relic-one-pricing-billing#editions), obtienes 100 GB de datos al mes de forma gratuita. Para obtener detalles sobre los precios de ingesta de datos superiores al monto gratuito, consulte [la tabla de precios de lista](/docs/licenses/license-information/usage-plans/new-relic-usage-plan/#list-price).
  </Collapser>

  <Collapser
    id="nrql-operators-for-baselining"
    title="Comprender las operaciones NRQL útiles para establecer líneas de base y modelar cambios"
  >
    <CollapserGroup>
      <Collapser
        id="the-rate-operator"
        title="Tasa"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilice el operador `rate` cuando necesite tomar una muestra de datos extraídos de un período de tiempo determinado y generar una tasa determinada. Por ejemplo, tome una muestra diaria de datos y calcule una tarifa de 30 días basándose en eso.
        </Callout>

        _Calcular la tasa basándose en una muestra dada de datos_

        Vea cuál ha sido su ingesta promedio diaria durante el último mes.

        ```sql
        SELECT rate(sum(GigabytesIngested), 1 day) AS 'Daily Ingest Rate (GB)' FROM NrConsumption WHERE productLine = 'DataPlatform' LIMIT MAX SINCE 30 days AGO
        ```

        Nuestra respuesta sencilla para toda la organización es

        ```shell
        Daily ingest rate: 30.4 k
        ```

        Esta consulta muestra que la tasa de ingesta diaria fue de aproximadamente 30 TB por día durante el último mes.
      </Collapser>

      <Collapser
        id="the-month-of-operator"
        title="Mes de"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Úselo cuando sea importante restringir un cálculo de ingesta a meses calendario específicos. Por ejemplo, la ingesta para una integración puede haber aumentado a finales de enero y continuar hasta mediados de febrero. Este operador ayudará a facetar la ingesta en los meses calendario específicos utilizados para la facturación.
        </Callout>

        _Faceta por mes calendario_

        ```sql
        SELECT sum(GigabytesIngested) AS 'Daily Ingest Rate (GB)' FROM NrConsumption WHERE productLine = 'DataPlatform' FACET monthOf(timestamp) LIMIT MAX SINCE 56 weeks AGO
        ```

        La tabla resultante muestra una variabilidad bastante alta. Tenga en cuenta que las cosas estuvieron bastante `hot` en agosto y septiembre. Parte de eso se debe a la estacionalidad de nuestra organización, pero también estuvo relacionado con el aumento en la amplitud de nuestra cobertura de telemetría.

        ```shell
        |MONTH OF TIMESTAMP|GB INGESTED|
        |---|---|
        |December 2021*|636 k|
        |November 2021|901 k|
        |October 2021|873 k|
        |September 2021|1.05 M|
        |August 2021|1.08 M|
        |July 2021|1.05 M|
        |June 2021|887 k|
        |May 2021|881 k|
        |||
        ```
      </Collapser>

      <Collapser
        id="change-analysis"
        title="Comparar con"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilícelo cuando desee evaluar la cantidad de cambio en el volumen o la tasa de ingesta entre un período de tiempo y otro. Esto es importante para saber si su ingesta aumenta inesperadamente.
        </Callout>

        _Análisis de cambios simples_

        ```sql
        SELECT sum(GigabytesIngested) FROM NrConsumption WHERE productLine = 'DataPlatform' AND usageMetric = 'BrowserEventsBytes' SINCE 6 months AGO UNTIL 1 week AGO TIMESERIES 7 weeks COMPARE WITH 2 months ago
        ```

        <img
          src={omaoedgSimpleCompareWithTimeSeries}
          alt="Example chart showing the use of COMPARE WITH to understand growth patterns."
          title="Example chart showing the use of COMPARE WITH to understand growth patterns."
        />

        <figcaption>
          Gráfico de ejemplo que muestra el uso de <DoNotTranslate>**COMPARE WITH**</DoNotTranslate> para comprender los patrones de crecimiento.
        </figcaption>
      </Collapser>

      <Collapser
        id="sliding-window"
        title="Ventana deslizante"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilícelo cuando necesite eliminar los efectos de la variabilidad regular de la ingesta para ver el patrón más amplio.
        </Callout>

        La telemetría es inherentemente ruidosa. Los fenómenos del mundo real ocurren en ráfagas que dejan muchos picos y valles aleatorios en la señal. Esto es bueno en cierto modo porque nos permite ver toda la complejidad de un fenómeno. Sin embargo, cuando buscamos ver tendencias, podemos distraernos con los detalles. NRQL proporciona una manera poderosa de suavizar cualquier serie temporal combinando cada punto de datos con puntos ligeramente más antiguos. Esto nos permitirá centrarnos en la tendencia temporal general en lugar de en un extremo `increase` o `decrease`.

        Tenga en cuenta la irregularidad de la serie temporal sin procesar para la tasa de ingesta de 1 día:

        ```sql
        FROM NrConsumption SELECT rate(sum(GigabytesIngested), 1 day) WHERE productLine = 'DataPlatform' SINCE 26 weeks AGO TIMESERIES 1 DAY
        ```

        <img
          src={omaoedgJaggedDailyRateTimeSeries}
          alt="Daily rate time series without smoothing."
          title="Daily rate time series without smoothing."
        />

        <figcaption>
          Suavizado de series temporales de tarifas diarias <DoNotTranslate>**without**</DoNotTranslate>
        </figcaption>

        Ahora, si utilizamos una [ventana deslizante](/docs/query-your-data/nrql-new-relic-query-language/nrql-query-tutorials/create-smoother-charts-sliding-windows/) de cuatro días para reducir el impacto de un evento de un solo día, veremos una imagen más clara. Cuatro días es una buena opción, ya que difuminará el impacto de `weekends`, por lo que los datos de un domingo se combinarán en cierta medida con los datos de un viernes, etc.

        ```sql
        FROM NrConsumption SELECT rate(sum(GigabytesIngested), 1 day) WHERE productLine = 'DataPlatform' since 24 weeks ago TIMESERIES 1 DAY SLIDE BY 4 days
        ```

        <img
          src={omaoedgSlidingWindowSmoothExample}
          alt="Daily rate time series with smoothing."
          title="Daily rate time series with smoothing."
        />

        <figcaption>
          Suavizado de series temporales de tarifas diarias <DoNotTranslate>**with**</DoNotTranslate>
        </figcaption>
      </Collapser>

      <Collapser
        id="derivative"
        title="Derivado"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilice esto para estimar la tasa estadística de cambio durante un período de tiempo determinado. La tasa de cambio se calcula utilizando una regresión lineal de mínimos cuadrados para aproximar la derivada.
        </Callout>

        NRQL nos proporciona algunas herramientas para evaluar la tasa de cambio. Esto es útil porque, como vemos en el ejemplo anterior, tuvimos un aumento muy grande en los últimos meses en la métrica browser . Este análisis de tasa de cambio utiliza el operador `derivative` y nos da cierta confianza en que el crecimiento principal se produjo a principios de septiembre. Parece que nuestra tasa de crecimiento basada en la derivada de 7 días es algo negativa, por lo que es posible que hayamos alcanzado una nueva meseta en este momento en la ingesta de BrowserEventsBytes.

        ```sql
        SELECT derivative(sum(GigabytesIngested) , 7 day) FROM NrConsumption WHERE productLine = 'DataPlatform'  and usageMetric = 'BrowserEventsBytes'  LIMIT MAX SINCE 3 MONTHS AGO UNTIL THIS MONTH TIMESERIES 1 MONTH slide by 3 days COMPARE WITH 1 WEEK AGO
        ```

        <img
          src={omaoedgDerivativeExample}
          alt="Using a seven day derivative to explore ingest trends"
          title="Using a seven day derivative to explore ingest trends"
        />

        <figcaption>
          Utilizar una derivada de siete días para explorar las tendencias de ingesta
        </figcaption>
      </Collapser>

      <Collapser
        id="baseline-query-examples"
        title="bytecountestimate()"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilice [`bytecountestimate()`](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/usage-queries-alerts/#byte-count-estimate) cuando necesite estimar la huella de datos de ingesta para un subconjunto de eventos o métricas sin procesar.
        </Callout>

        <CollapserGroup>
          ### Ejemplos

          <Collapser
            id="ingest-by-application"
            title="Ingesta por aplicación (APM, browser, móvil)"
          >
            Ejecute estas consultas en cada subcuenta o en un dashboard con gráficos específicos de la cuenta. La consulta estima una tarifa de 30 días basada en 1 semana de cobro.

            <DoNotTranslate>
              **Estimate 30 day rate**
            </DoNotTranslate>

            APM:

            ```sql
            FROM Transaction, TransactionError, TransactionTrace, SqlTrace, ErrorTrace, Span SELECT rate(bytecountestimate()/10e8, 30 day) AS 'GB Ingest' FACET appName SINCE 1 WEEK AGO
            ```

            Browser:

            ```sql
            FROM PageAction, PageView, PageViewTiming, AjaxRequest, JavaScriptError SELECT rate(bytecountestimate()/10e8, 30 day) AS 'GB Ingest' FACET appName SINCE 1 WEEK AGO 
            ```

            Móvil:

            ```sql
            FROM Mobile, MobileRequestError, MobileSession SELECT rate(bytecountestimate()/10e8, 30 day) AS 'GB Ingest' FACET appName SINCE 1 WEEK AGO 
            ```
          </Collapser>

          <Collapser
            id="metric-ingest-by-integration"
            title="Ingesta métrica por integración"
          >
            Algunos ejemplos de `usage.Integration` valores que aparecerán con esta faceta son:

            * com.newrelic.mssql (la integración en el host de New Relic MSSQL)
            * com.newrelic.rabbitmq (la integración en el host de New Relic RabbitMQ)
            * EC2 (la integración de AWS EC2)
            * Lambda (la integración Lambda)

            Ejecute estas consultas en cada cuenta específica o en un dashboard con gráficos específicos de la cuenta.

            <DoNotTranslate>
              **Estimate 30 day rate:**
            </DoNotTranslate>

            ```
            FROM Metric SELECT rate(bytecountestimate()/10e8, 30 day) FACET usage.integrationName SINCE 1 WEEK AGO
            ```

            <DoNotTranslate>
              **Seven day sum:**
            </DoNotTranslate>

            ```sql
            FROM Metric SELECT bytecountestimate()/10e8 FACET usage.integrationName SINCE 1 WEEK AGO
            ```
          </Collapser>

          <Collapser
            id="log-ingest-by-host"
            title="Ingesta log por varias entidades de infraestructura"
          >
            De todos [los tipos de telemetría de New Relic](/docs/data-apis/understand-data/new-relic-data-types), los datos log son los que tienen más variación. Un registro `Log` puede contener casi cualquier campo y, a menudo, se desconoce qué contendrá un log determinado. Debido a que no existe un esquema común, la línea base de ingesta log puede requerir un poco más de análisis que la línea base de otros tipos de datos.

            Una de las técnicas básicas de ingesta de log más útiles es intentar estimar la ingesta por host, contenedor o incluso por clúster de Kubernetes. Aquí hay unos ejemplos:

            <DoNotTranslate>
              **Log ingest by host for past 3 hours (total):**
            </DoNotTranslate>

            ```sql
            FROM Log SELECT bytecountestimate()/10e8 
              WHERE host is not NULL SINCE 3 hours ago FACET host
            ```

            <DoNotTranslate>
              **Log ingest by host (30 day rate):**
            </DoNotTranslate>

            ```sql
            FROM Log SELECT rate(bytecountestimate()/10e8, 30 day) 
              WHERE host is not NULL SINCE 3 hours ago FACET host
            ```

            <DoNotTranslate>
              **Log ingest by cluster_name (30 day rate):**
            </DoNotTranslate>

            ```sql
            FROM Log SELECT rate(bytecountestimate()/10e8, 30 day) 
              WHERE host is not NULL SINCE 3 hours ago FACET cluster_name
            ```

            <DoNotTranslate>
              **Log ingest by cluster_name and container_name (30 day rate):**
            </DoNotTranslate>

            ```sql
            FROM Log SELECT rate(bytecountestimate()/10e8, 30 day) 
              WHERE host is not NULL SINCE 3 hours ago FACET cluster_name, container_name
            ```
          </Collapser>

          <Collapser
            id="ingest-by-k8s-cluster"
            title="Ingesta por clúster de Kubernetes"
          >
            _Estimar tarifa de 30 días_

            ```sql
            FROM K8sClusterSample, K8sContainerSample,K8sDaemonsetSample, K8sDeploymentSample, K8sEndpointSample, K8sHpaSample, K8sNamespaceSample, K8sNodeSample, K8sPodSample, K8sReplicasetSample, K8sServiceSample, K8sVolumeSample SELECT rate(bytecountestimate()/10e8, 30 day) AS 'GB Ingest' FACET clusterName SINCE 1 WEEK AGO
            ```
          </Collapser>

          <Collapser
            id="ingest-by-process-sample"
            title="Muestras de proceso"
          >
            `ProcessSample` puede ser un evento de gran volumen. En este ejemplo calcularemos la ingesta de 30 días por línea de comando.

            _Estimar la tarifa de 30 días por nombre de comando_

            ```sql
            FROM ProcessSample SELECT rate(bytecountestimate()/10e8, 30 day) AS 'GB Ingested' FACET commandName SINCE 1 DAY AGO
            ```
          </Collapser>
        </CollapserGroup>
      </Collapser>

      <Collapser
        id="eventtype-examples"
        title="eventType()"
      >
        <Callout
          variant="important"
          title="Cuándo usar"
        >
          Utilice el operador `eventType()` cuando necesite tener granularidad a nivel de evento en su consulta y cuando no esté familiarizado con qué eventos personalizados están presentes en su cuenta.
        </Callout>

        Muchas veces usaremos una consulta que selecciona múltiples eventos. Este es uno de los medios principales que tenemos para determinar cuántos datos nos envía un determinado agente o integración.

        La siguiente consulta nos indica cuántos datos nos está enviando la integración de Kubernetes:

        ```sql
        FROM
        K8sApiServerSample,
        K8sClusterSample,
        K8sContainerSample,
        K8sControllerManagerSample,
        K8sDaemonsetSample,
        K8sDeploymentSample,
        K8sEndpointSample,
        K8sNamespaceSample,
        K8sNodeSample,
        K8sPodSample,
        K8sReplicasetSample,
        K8sSchedulerSample,
        K8sServiceSample,
        K8sStatefulsetSample,
        K8sVolumeSample
        SELECT bytecountestimate()/10e8 AS 'Gigabytes'
        SINCE 1 DAYS AGO
        LIMIT MAX
        ```

        Es poderoso en sí mismo, pero solo devolverá un único valor agregado:

        ```shell
        42.341 Gigabytes
        ```

        Cuando necesitamos profundizar más para saber cuántos datos está consumiendo un evento específico, podemos usar `eventType()` en una cláusula de faceta para obtener ese resultado.

        Agregar la cláusula `FACET eventType()` a la consulta anterior nos da:

        <img
          src={omaoedgEventTypeExample}
          alt="Listing of ingest by K8s event type"
          title="Listing of ingest by K8s event type"
        />

        <figcaption>
          Listado de ingesta por tipo de evento K8
        </figcaption>
      </Collapser>

      <Collapser
        id="show-event-types"
        title="MOSTRAR TIPOS DE EVENTOS"
      >
        <Callout
          variant="important"
          title="Cuándo usar"
        >
          Utilice `SHOW EVENT TYPES` cuando no esté seguro del evento que existe en su cuenta.
        </Callout>

        `SHOW EVENT TYPES` enumera todos los tipos de eventos en una cuenta durante un período de tiempo determinado. Para obtener más detalles, consulte [MOSTRAR TIPOS de eventos](/docs/query-your-data/nrql-new-relic-query-language/get-started/nrql-syntax-clauses-functions/#show-event-types). Usar una ventana de tiempo específica puede resultar útil para comprender mejor cuándo comenzó a llegar un evento determinado al sistema.
      </Collapser>

      <Collapser
        id="facet-metric-name"
        title="Nombre de la métrica FACET"
      >
        <Callout
          variant="IMPORTANT"
          title="Cuándo usar"
        >
          Utilice `FACET metricName` cuando necesite granularidad a nivel de nombre de métrica en su consulta.
        </Callout>

        La mejor manera de explorar realmente las métricas y tener una idea del volumen relativo de datos provenientes de cada una es usar `FACET metricName` en una consulta `SELECT FROM Metric` . Es posible incorporar cláusulas WHERE para reducir la lista. Por ejemplo, para ver el volumen de ingesta relativo para métrica con el texto `kube_pod` en `metricName` ejecute una consulta como esta:

        ```sql
        SELECT bytecountestimate()/10e8 as 'Gigabytes' from Metric facet metricName where metricName like '%kube_pod%' since 1 day ago limit max
        ```

        <img
          src={omaoedgFacetMetricnameExample}
          alt="Listing of ingest by the metricName attribute of the Metric namespace"
          title="Listing of ingest by the metricName attribute of the Metric namespace"
        />

        <figcaption>
          Listado de ingesta por el atributo <DoNotTranslate>**metricName**</DoNotTranslate> del namespace <DoNotTranslate>**Metric**</DoNotTranslate>
        </figcaption>
      </Collapser>
    </CollapserGroup>
  </Collapser>
</CollapserGroup>

## Proceso [#process]

Estos son los pasos principales que deberá seguir como parte de este procedimiento de mejora de la gestión de la ingesta de datos:

* [Instalar el dashboardcontrol de la línea de base de gobernanza de ingesta de datos](#install-dashboard)
* [Agregue indicadores de objetivos de ingesta a su dashboard](#add-target-indicators)
* [Genere un informe tabular de ingesta de 30 días](#generate-report)
* [Personaliza tu informe](#customize-report)
* [Detectar anomalía en la ingesta](#detect-anomalies)
* [Instalar el dashboard de desglose de la entidad (opcional)](#install-entity-breakdown-dashboard)
* [Instale el dashboard de integración en la nube (opcional)](#install-cloud-integration-dashboard)

Describiremos estos pasos con más detalle a continuación.

### Instalar el dashboardcontrol de la línea de base de gobernanza de ingesta de datos [#install-dashboard]

Para instalar el dashboard:

1. Vaya al [inicio rápido sobre gobernanza de ingesta de datos](https://onenr.io/0PoR8zpDYQG).
2. Haga clic en `Install this quickstart` en la parte superior derecha de la ventana de su browser .
3. Si corresponde: seleccione su cuenta principal o de nivel superior en el selector de cuentas.
4. Haga clic en `Done`.
5. Cuando finalice la instalación del inicio rápido, abra el dashboard `Data ingest governance baseline`.

Eso lo llevará al dashboard recién instalado.

#### Descripción general dashboard [#dashboard-overview]

La pestaña de descripción general principal muestra una variedad de gráficos que incluyen algunas vistas potentes de series de tiempo.

<img
  src={omaoedgDataIngestGovBaselineOverviewTab}
  alt="Organization wide baseline ingest time series"
  title="Organization-wide baseline ingest time series"
/>

<figcaption>
  Serie de tiempo de ingesta de línea de base de toda la organización
</figcaption>

La segunda pestaña proporciona un informe de línea de base por subcuenta y métrica de uso.

<img
  src={omaoedgDataIngestGovBaselineReportsTab}
  alt="Organization wide baseline reports view"
  title="Organization wide baseline reports view"
/>

<figcaption>
  Vista de informes de línea de base de toda la organización
</figcaption>

Las pestañas restantes proporcionan vistas detalladas de tipos de telemetría específicos, como datos del navegador, datos APM, registro y traza. Por ejemplo, esta captura de pantalla muestra la página de detalles browser :

<img
  src={omaoedgDataIngestGovBaselineBrowserTab}
  alt="Baseline Browser ingest"
  title="Baseline Browser ingest"
/>

<figcaption>
  Ejemplo de un detalle de ingesta centrado en un único tipo de telemetría (en este caso, datos del navegador).
</figcaption>

Las pestañas de detalles incluyen:

* APM: `ApmEventsBytes`
* Rastreo: `TracingBytes`
* Browser: `BrowserEventsBytes`
* Móvil: `MobileEventsBytes`
* Infra (anfitrión): `InfraHostBytes`
* Infra (proceso):`InfraProcessBytes`
* Infra (integración): `InfraIntegrationBytes`
* Evento personalizado: `CustomEventsBytes`
* Sin servidor: `ServerlessBytes`
* Duendecito: `PixieBytes`

### Agregue indicadores de objetivos de ingesta a su dashboard [#add-target-indicators]

En la sección de requisitos previos analizamos el concepto de objetivo de uso mensual. Es posible que tengas varios objetivos que te ayudarán a mantener el rumbo:

* Un objetivo organizacional general sobre la tarifa diaria o la ingesta mensual.
* Objetivo por tipo de datos para garantizar el desglose óptimo (por ejemplo, 1 TB por día para log y 2 TB por día para métrica).
* Objetivo para subcuenta o unidades de negocio específicas.

En nuestro ejemplo, tenemos una organización cuyo objetivo de ingesta organizacional total es de `<` 360 TB por mes. Este era un nuevo objetivo después de haber reducido la ingesta de más de 20 TB por día (600 TB por mes).

Para que sea más fácil medir el objetivo, agregamos un gráfico de líneas de umbral agregando el número estático `360000` a nuestra declaración `SELECT` .

```sql
SELECT 360000, rate(sum(GigabytesIngested), 30 day) AS '30 Day Rate' FROM NrConsumption WHERE productLine='DataPlatform' since 30 days ago limit max compare with 1 month ago TIMESERIES 7 days
```

<img
  src={omaoedgThirtyDayRateTargetLine}
  alt="Thirty day ingest target line"
  title="Thirty-day ingest target line"
/>

<figcaption>
  Podemos usar NRQL para representar una línea que represente nuestra ingesta objetivo de treinta días <DoNotTranslate>**target**</DoNotTranslate>.
</figcaption>

También podemos aplicar una línea objetivo de tarifa diaria. Simplemente dividamos 360000 entre 30 y usaremos 12000 como nuestro objetivo de tarifa diaria. Actualice el gráfico `Daily ingest rate (compare with 3 months prior)` :

```sql
SELECT 12000, rate(sum(GigabytesIngested), 1 day) AS avgGbIngestTimeseries FROM NrConsumption WHERE productLine='DataPlatform' TIMESERIES AUTO since 9 months ago limit max COMPARE WITH 3 months ago
```

<img
  src={omaoedgIngestTargetLine}
  alt="Daily ingest target line"
  title="Daily ingest target line"
/>

<figcaption>
  Podemos usar NRQL para representar una línea que represente nuestra ingesta diaria <DoNotTranslate>**target**</DoNotTranslate>.
</figcaption>

### Genere un informe tabular de ingesta de 30 días [#generate-report]

Para crear un informe de ingesta de 30 días:

1. Abra el dashboard de la línea de base de gobierno de ingesta de datos previamente instalado.

2. Haga clic en la pestaña

   <DoNotTranslate>**Baseline report**</DoNotTranslate>

   .

3. Haga clic en `...` en la parte superior derecha de la tabla "Últimos 30 días" y elija `Export as CSV`

4. Importe el CSV a Google Sheets o a la hoja de cálculo de su elección.

Alternativamente, si no instaló el dashboard, puede simplemente usar esta consulta para crear un gráfico personalizado en el [generador de consultas](/docs/query-your-data/explore-query-data/query-builder/introduction-query-builder):

```sql
SELECT sum(GigabytesIngested) AS 'gb_ingest_30_day_sum', rate(sum(GigabytesIngested), 1 day) AS 'gb_ingest_daily_rate', derivative(GigabytesIngested, 90 day) as 'gb_ingest_90_day_derivative' FROM NrConsumption WHERE productLine='DataPlatform' since 30 days ago facet consumingAccountName, usageMetric  limit max
```

A continuación se muestra un ejemplo de una hoja que importamos a Google Sheets.

<img
  src={omaoedgBaselineSheet}
  alt="Baseline tabular spreadsheet"
  title="Screenshot of a baseline report example"
/>

<figcaption>
  Una hoja de cálculo exportada desde la página tabular dashboard de línea de base
</figcaption>

La captura de pantalla muestra la tabla ordenada por ingesta total de 30 días.

Siéntase libre de ajustar su cronograma y algunos de los detalles según sea necesario. Por ejemplo, optamos por extraer un derivado de 90 días para tener cierta sensación de cambio en los últimos meses. Puede modificar fácilmente el período de tiempo del derivado para adaptarlo a sus objetivos.

### Personaliza tu informe [#customize-report]

Agregue columnas útiles a su informe para facilitar otras fases de la gobernanza de la ingesta de datos, como <DoNotTranslate>**Optimize**</DoNotTranslate> y <DoNotTranslate>**Forecast**</DoNotTranslate>. Los siguientes campos ayudarán a guiar las decisiones de optimización y planificación:

* Notas: Anote cualquier anomalía de crecimiento y cualquier explicación relevante para ellas. Indique cualquier crecimiento importante esperado, si está previsto.
* Contacto técnico: Nombre del administrador de una cuenta determinada o alguien relacionado con un tipo de telemetría específico.

### Detectar anomalía en la ingesta [#detect-anomalies]

A continuación se detallan algunos pasos para detectar anomalías en la ingesta.

#### Alerta al ingerir anomalía [#on-ingest-anomalies]

Utilice [esta guía de alerta de ingesta](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/usage-queries-alerts) para asegurarse de que un aumento en el consumo de datos no lo tome por sorpresa. Como mínimo, cree:

* Una alerta de umbral para notificar si excede el objetivo mensual de ingesta de datos más allá de los aumentos estacionales.
* Una alerta de anomalía para notificarle sobre un aumento repentino y brusco de datos de ingesta

Además de utilizar alerta para identificar anomalías en el consumo, puede utilizar New Relic Lookout para explorar posibles anomalías en la ingesta.

#### Vista de mirador [#lookout]

Lookout le permite proporcionar casi cualquier consulta NRQL y buscará anomalías durante un período de tiempo determinado. La siguiente vista se basa en esta consulta:

```sql
SELECT rate(sum(GigabytesIngested), 1 day) AS avgGbIngest FROM NrConsumption WHERE productLine='DataPlatform' FACET usageMetric 
```

<img
  src={omaoedgLookoutViewTelemType}
  alt="Lookout view usage metric"
  title="Lookout view usage metric"
/>

<figcaption>
  Podemos usar Lookout para encontrar anomalías en nuestra ingesta por <DoNotTranslate>**usageMetric**</DoNotTranslate>.
</figcaption>

Cambie el campo de faceta a `consumingAccountName` para obtener esta vista:

<img
  src={omaoedgLookoutViewConsumingAccount}
  alt="Lookout view consuming account"
  title="Lookout view consuming account"
/>

<figcaption>
  Podemos usar Lookout para encontrar anomalías en nuestra ingesta por <DoNotTranslate>**consumingAccountName**</DoNotTranslate>.
</figcaption>

### Instalar el dashboard de desglose de la entidad (opcional) [#install-entity-breakdown-dashboard]

En una sección anterior, instaló el dashboard de ingesta `baseline` que utiliza `NrConsumption` como fuente principal. Además de esa vista de alto nivel, puede crear otras visualizaciones que utilicen `bytescountestimate()` para estimar la ingesta de casi cualquier evento o métrica. [En la sección de requisitos previos](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-baselining#baseline-query-examples) se analizó una descripción detallada de `bytescountestimate()` .

Para instalar el dashboard de averías de entidad:

1. Vaya al [mismo inicio rápido](https://onenr.io/0PoR8zpDYQG) que utilizó para el dashboard de línea de base.

2. Haga clic en `Install this quickstart` en la sección superior derecha de la ventana de su browser .

3. Debe instalarlo en cualquier cuenta que contenga APM, monitoreo de navegador, monitoreo de móviles o clúster de Kubernetes utilizando la [función de importación dashboard ](/docs/query-your-data/explore-query-data/dashboards/introduction-dashboards/#dashboards-import). (Si tiene una asociación: no instale este dashboard en una cuenta de propietario de asociación o POA). Puede instalar este dashboard en varias cuentas. Si tiene una estructura de cuenta principal/secundaria: puede instalar el dashboard en una cuenta principal y dashboard para tener dashboard completo de gráficos específicos de la cuenta.

4. Haga clic en `Done`.

5. Cuando finalice la instalación del inicio rápido, abra el dashboard `Data governance entity breakdowns`.

   <img
     src={omaoedgEntityBreakdownDash}
     alt="Entity breakdown dashboard"
     title="Entity breakdown dashboard"
   />

   <figcaption>
     El dashboard de desglose de entidades utiliza <DoNotTranslate>**bytecountestimate()**</DoNotTranslate> para facetar la ingesta por atributo útil, como la aplicación o el nombre del clúster.
   </figcaption>

Puede consultar [esta sección](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-baselining#understand-nr-consumption-metrics) para ver exactamente qué tipos de eventos se utilizan en estos desgloses.

<Callout variant="tip">
  Estas consultas consumen más recursos porque no funcionan a partir de una fuente de datos preagregada como `NrConsumption`. Es posible que deba ajustar los plazos mediante el uso de cláusulas `WHERE` y `LIMIT` adicionales para que funcionen mejor en algunos de sus entornos.
</Callout>

### Instale el dashboard de integración en la nube (opcional) [#install-cloud-integration-dashboard]

La integración de New Relic en la nube a menudo puede ser una fuente importante de crecimiento en la ingesta de datos. Sin buenas visualizaciones puede resultar muy difícil determinar de dónde proviene el crecimiento. Esto se debe en parte a que estas integraciones son muy fáciles de configurar y no forman parte del proceso normal de CI/CD de una organización. Es posible que tampoco formen parte de un sistema formal de gestión de configuración.

Afortunadamente, este potente conjunto de <InlinePopover type="dashboards"/>se puede instalar [directamente desde la observabilidad instantánea de New Relic](https://onenr.io/0EPwJJO9Ow7).

El panel individual instalado por este paquete incluye:

* Integración de AWS
* Integración de azure
* Integración de la plataforma Google Cloud
* Integracion on-host
* Kubernetes

<img
  src={omaoedgInfraIntegrationsNrIo}
  alt="Infra integrations dashboard"
  title="Infra integrations dashboard"
/>

<figcaption>
  Este [inicio rápido](https://onenr.io/0EPwJJO9Ow7) contiene un conjunto muy granular de paneles que desglosan los datos de casi todas las integraciones en la nube, la integración en el host y la integración de Kubernetes.
</figcaption>

## Ejercicio [#exercise]

Responder las siguientes preguntas le ayudará a desarrollar confianza en su capacidad para interpretar datos de línea de base y hacer inferencias correctas. Estas preguntas se pueden responder utilizando los paneles de control [de ingesta de datos de la línea de base](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-baselining#install-dashboard) y [de desglose de entidades de ingesta de datos](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-baselining#install-entity-breakdown-dashboard) . Instale esos paneles como se describe y vea cuántas de estas preguntas puede responder.

| Preguntas                                                                                                                                                                                                                                                  |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ¿Cuál es la tasa de ingesta diaria típica para toda la organización (todas las cuentas) durante la semana pasada? ¿Qué fue tres meses antes?                                                                                                               |
| ¿Cuáles son los tres principales tipos de telemetría (para la organización en su conjunto) por ingesta? Enumere cada tipo de telemetría y su tasa de ingesta de 30 días más reciente.                                                                      |
| ¿Cuántas cuentas contribuyen a la ingesta de esta organización?                                                                                                                                                                                            |
| ¿Cuántas cuentas (si las hay) aportan actualmente más de 50 TB al mes?                                                                                                                                                                                     |
| ¿Cuáles son las tres cuentas principales en términos de ingesta durante los últimos 30 días?                                                                                                                                                               |
| ¿Cuál es la ingesta de GB para el mes calendario de enero pasado para la cuenta de mayor consumo?                                                                                                                                                          |
| ¿Cuáles son las tres cuentas principales en términos de ingesta de `ApmEventsBytes` durante los últimos 30 días?                                                                                                                                           |
| ¿Cuál es el mayor aumento en términos de ingesta de tipos de telemetría para una cuenta determinada en los últimos 9 meses? ¿Qué pasa con las disminuciones?                                                                                               |
| Vaya a la cuenta que aporta más `ApmEventsBytes` e instale/abra el `data governance entity breakdown dashboard`. Enumere las tres principales aplicaciones de APM por ingesta durante las últimas 24 horas y sus respectivas tasas de ingesta de 24 horas. |

## Conclusión [#conclusion]

La sección [de proceso](#process) lo llevó a través de la creación de visualizaciones e informes de ingesta de datos. Ahora puede revisar la ingesta de datos con un enfoque visual impulsado por datos que usted y sus pares pueden utilizar para colaborar.

En el futuro, decida qué visualizaciones usar para:

* Tus [registros de ingesta mensuales](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-coe#monthly-ingest-check-ins)
* Tus [reuniones anuales de planificación de ingesta](/docs/new-relic-solutions/observability-maturity/operational-efficiency/dg-coe#yearly-ingest-target-planning)
* Visualizaciones de mejores prácticas para cualquiera que administre la ingesta de datos para una o más cuentas en una organización.

## Recursos adicionales [#additional-resources]

Otros recursos relacionados incluyen:

* [Administrar datos entrantes](/docs/data-apis/manage-data/manage-data-coming-new-relic/)
* [Centro de gestión de datos](/docs/data-apis/manage-data/manage-your-data/)
* [Soltar datos usando Nerdgraph](/docs/data-apis/manage-data/drop-data-using-nerdgraph/)
* [Alerta sobre anomalía en la ingesta de datos](/docs/accounts/accounts-billing/new-relic-one-pricing-billing/usage-queries-alerts/)
* [Automatización del flujo de trabajo mediante telemetría](https://developer.newrelic.com/automate-workflows/)
* [Agregación métrica y evento a métrica](/docs/data-apis/convert-to-metrics/create-metrics-other-data-types/)