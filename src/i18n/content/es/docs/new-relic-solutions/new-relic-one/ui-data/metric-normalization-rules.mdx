---
title: Reglas de normalización métrica
tags:
  - New Relic
  - Use New Relic
  - UI and data
metaDescription: How to create and manage rules in New Relic to deal with noise from high cardinality metrics and prevent metric grouping issues (MGIs).
freshnessValidatedDate: never
translationType: machine
---

Las reglas de normalización de métricas le ayudan a gestionar [problemas de agrupación de métricas](/docs/using-new-relic/cross-product-functions/troubleshooting/metric-grouping-issues) (MGI). Esto ayuda a garantizar que los datos de rendimiento de la aplicación sigan siendo relevantes. La normalización de métricas se aplica solo a los [datos de intervalo de tiempo de métricas](/docs/data-apis/understand-data/new-relic-data-types/#timeslice-data).

Puede crear y administrar reglas de normalización de métricas para:

* Agrupa o filtra [datos de métricas de intervalo de tiempo](/docs/data-apis/understand-data/new-relic-data-types/#timeslice-data)
* Administra las métricas de alta cardinalidad que se reportan a New Relic
* Evitar los MGI
* Evitar la creación automática de reglas de `DENY_NEW_METRICS`
* Reduzca el número de nombres de métricas únicos reportados a New Relic

<Callout variant="important">
  Siempre que se detectan MGI con un número muy alto de métricas, se crea automáticamente una regla `DENY_NEW_METRICS` para proteger la plataforma de la degradación del rendimiento. Esta regla `DENY_NEW_METRICS` no afecta ninguna métrica reportada previamente a New Relic.
</Callout>

<Callout variant="tip">
  También puede crear una regla de normalización de métricas usando [NerdGraph](/docs/apis/nerdgraph/examples/nerdgraph-metric-normalization-rule/).
</Callout>

## Agentes que reportan a múltiples aplicaciones [#multi-app-agents]

Cuando un agente reporta a múltiples aplicaciones, las reglas de normalización de todas las aplicaciones se aplican a los datos de métricas.

Considere este escenario:

* Un agente reporta a `app1` y `app2`
* La regla `r1` está definida para `app1`
* La regla `r2` está definida para `app2`

Tanto `r1` como `r2` se aplican a todos los datos de métricas enviados por el agente.

¿Qué sucede si se modifica la configuración del agente para que solo reporte a `app2`? En ese caso, solo se aplicará la regla `r2`, ya que es la única regla definida para la aplicación a la que reporta el agente.

## Gestionar la normalización de métricas [#manage-rules]

Puede crear y administrar nuevas reglas de normalización de métricas para una entidad usando la página <DNT>**Metric normalization rules**</DNT>.

<CollapserGroup>
  <Collapser id="access-rules" title="Ver reglas de normalización de métricas">
    Para ver la página <DNT>**Metric normalization rules**</DNT>, vaya a <DNT>[https://one.newrelic.com](https://one.newrelic.com) &gt; **All Entities**</DNT> &gt; Seleccione una entidad &gt; <DNT>**Settings** &gt; **Metric normalization** </DNT>.

    <img title="View details" alt="View MGI details" src="/images/Access_metric_rules.webp" />
  </Collapser>

  <Collapser id="create-metric-normalization-rule" title="Crear una regla de normalización de métricas">
    Para crear una regla de normalización de métricas:

    1. En la página <DNT>**Metric normalization rules**</DNT>, haga clic en **+ Create a new rule**.
    2. Proporcione los siguientes detalles:

    <table>
      <thead>
        <tr>
          <th>
            Campo
          </th>

          <th>
            Descripción
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            **Intervalo de tiempo**
          </td>

          <td>
            Seleccione el rango de tiempo requerido del menú desplegable para la regla.
          </td>
        </tr>

        <tr>
          <td>
            **Expresión regular**
          </td>

          <td>
            Ingrese un patrón de 

            [expresión regular](https://regexone.com/)

             que coincida con las métricas a normalizar. Este campo debe comenzar con un 

            `^`

             y terminar con un 

            `$`

            . Define un patrón para identificar qué métricas deben ser afectadas por la regla de normalización. Por ejemplo: 

            `^WebTransaction/Uri/RESTfulExample/users/username/[a-zA-Z0-9]+$`

             El patrón 

            `^[a-zA-Z0-9]+$`

             coincide con cualquier cadena compuesta por caracteres en minúscula 

            `(a-z)`

            , caracteres en mayúscula 

            `(A-Z)`

             y números 

            `(0-9)`

            .
          </td>
        </tr>

        <tr>
          <td>
            **Coincidencias de expresión regular**
          </td>

          <td>
            Previsualice las métricas que coinciden con el campo 

            **Regular expression**

            .
          </td>
        </tr>

        <tr>
          <td>
            **¿Qué desea hacer con las coincidencias?**
          </td>

          <td>
            Seleccione una de las siguientes acciones para realizar en las métricas que coincidan con el campo **Regular expression**:

            * **Reemplazar**: Reemplace las métricas coincidentes con el valor en el campo <DNT>Replacement</DNT>.
            * **Ignorar**: Bloquea el reporte de cualquier métrica coincidente a la plataforma New Relic.
            * **Ignorar nuevas métricas**: Evite la creación de nuevos nombres de métricas, mientras permite que los nombres de métricas existentes sigan reportando.
          </td>
        </tr>

        <tr>
          <td>
            **Reemplazo**
          </td>

          <td>
            El campo Reemplazo es obligatorio solo cuando selecciona la opción 

            **Replace**

             en el campo anterior. Ingrese la métrica de reemplazo para reemplazar la métrica coincidente definida en el campo 

            **Regular expression**

            .
          </td>
        </tr>

        <tr>
          <td>
            **Orden de la regla en la secuencia**
          </td>

          <td>
            Especifique el orden en el que se aplica la regla en relación con otras reglas. Cuanto menor sea el número, mayor será la prioridad evaluada. El valor recomendado es 

            `2000`
          </td>
        </tr>

        <tr>
          <td>
            **Terminar**
          </td>

          <td>
            Si está habilitada, no se aplicarán reglas adicionales a las métricas después de que esta regla coincida exitosamente con una métrica.
          </td>
        </tr>

        <tr>
          <td>
            **Activo**
          </td>

          <td>
            Alterne para habilitar o deshabilitar la regla.
          </td>
        </tr>

        <tr>
          <td>
            **Notas**
          </td>

          <td>
            Notas sobre la regla para referencia.
          </td>
        </tr>
      </tbody>
    </table>

    3. Clic en **Save**.
  </Collapser>

  <Collapser id="update-metric-normalization-rule" title="Actualizar una regla de normalización de métricas">
    ### Actualizar una regla de normalización de métricas [#update-rule]

    1. En la página <DNT>**Metric normalization rules**</DNT>, seleccione la regla y haga clic en el icono <Icon name="fe-more-horizontal" />, luego seleccione **Edit**.
    2. Actualice los detalles necesarios.
    3. Clic en **Save**.
  </Collapser>
</CollapserGroup>

## Desactivar una regla de normalización de métricas [#disable-rule]

No puede eliminar una regla de normalización de métricas, pero puede desactivarla. La regla desactivada no afectará ninguna métrica que reporte a New Relic. Puede desactivar una regla de `DENY_NEW_METRICS` desde la página **MGI details**, cuando el `Denied rate (minute)` sea inferior al `resolution rate (minute)` de 1000.

Para desactivar una regla:

1. En la página <DNT>**Metric normalization rules**</DNT>, seleccione la regla requerida, haga clic en el icono <Icon name="fe-more-horizontal" /> y luego haga clic en **MGI details**.
2. Haga clic en **Deactivate**.

<img title="View details" alt="View MGI details" src="/images/metric-details.webp" />

## Página de detalles de MGI [#mgi-details]

La página **<DNT>MGI details</DNT>** proporciona una descripción general completa de las reglas de normalización de métricas aplicadas a sus métricas. Le permite analizar el impacto de estas reglas en sus datos de métricas y tomar decisiones informadas sobre la gestión de métricas de alta cardinalidad.

En la página **MGI details**, puede ver la siguiente información:

* **Blocked Metrics Overview**: Muestra la cantidad de métricas afectadas por la regla `DENY_NEW_METRICS`, incluida la tasa a la que se bloquean las métricas. Hay información similar disponible para las acciones de `REPLACE` y `IGNORE`.
* **Time Picker Functionality**: Permite ver el reporte de métricas antes de la activación de la regla, desglosado por prefijo de métrica. Esta función ayuda a identificar el origen del crecimiento de las métricas.
* **NRQL Query Integration**: Ofrece un botón &apos;ver en el generador de consultas&apos; para ver la consulta NRQL que ilustra la explosión de métricas justo antes de que se aplicara cualquier regla. Esto se aplica a los datos de Metric Timeslice, lo que permite un análisis retrospectivo de hasta tres meses.
* **Metric Pattern Identification**: Permite la identificación de patrones de métricas explosivas y la creación de nuevas reglas de expresiones regulares para gestionarlos de manera efectiva.
* **Real-Time Status Indicators**: Incluye widgets que muestran el estado actual de las reglas de normalización, con indicadores que cambian de &apos;Activo&apos; a &apos;Mitigado&apos; a medida que las reglas gestionan el crecimiento de las métricas.
* **Rule Modification Capability**: Permite a los usuarios desactivar sus propias reglas `DENY_NEW_METRICS` directamente desde la página de detalles de MGI, así como modificar las reglas `REPLACE` y `IGNORE` sin tickets de soporte. Para obtener más información, consulte [Desactivar una regla](#disable-rule).

### Acceda a la página de detalles de MGI [#access-mgi]

En la página <DNT>**Metric normalization rules**</DNT>, seleccione la regla y haga clic en el ícono <Icon name="fe-more-horizontal" />; luego, seleccione **MGI details**.

<img title="View details" alt="View MGI details" src="/images/metric-details.webp" />

### Ejemplo de caso de uso [#example-use-case]

En el ejemplo anterior, la página de detalles de MGI muestra que la regla `DENY_NEW_METRICS` bloquea 1.1 millones de nombres de métricas únicos a una tasa de 738 métricas por minuto. La mayor parte de este crecimiento se atribuye al espacio de nombres `WebTransaction/Uri/RESTfulExample/users/username/`. Al ver la consulta NRQL, puede identificar la fuente de la explosión, lo que le permite crear una nueva regla para administrar las métricas de manera efectiva.