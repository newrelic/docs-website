---
title: 쿠버네티스 데이터 찾기 및 사용
tags:
  - Integrations
  - Kubernetes integration
  - Understand and use data
metaDescription: 'New Relic''s Kubernetes integration: How to install and activate the integration, and what data is reported.'
translationType: human
---

import kubernetesDashboard from 'images/kubernetes_screenshot-full_dashboard.png'

쿼리 빌더와 NerdGraph API를 사용하여 자체 차트를 만들고 모든[쿠버네티스 통합](/docs/integrations/kubernetes-integration/get-started/introduction-kubernetes-integration) 데이터를 [쿼리](/docs/using-new-relic/data/understand-data/query-new-relic-data)할 수 있습니다. 뉴렐릭의 통합은 컨테이너 오케스트레이션 계층을 계측하여 쿠버네티스 데이터를 수집합니다. 더 간단하고 시각적인 경험을 위해 [클러스터 탐색기](/docs/integrations/kubernetes-integration/understand-use-data/kubernetes-cluster-explorer)를 사용하십시오.

<img
  title="New Relic - Kubernetes dashboard"
  alt="New Relic - Kubernetes dashboard"
  src={kubernetesDashboard}
/>

<figcaption>
  **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Dashboards**: [쿼리 빌더](/docs/chart-builder/use-chart-builder/get-started/introduction-chart-builder)를 사용하여 쿠버네티스 데이터를 쿼리하고 명확하게 시각화할 수 있습니다.
</figcaption>

## 쿠버네티스 데이터 쿼리 [#view-data]

[쿠버네티스 데이터를 쿼리](/docs/using-new-relic/data/understand-data/query-new-relic-data)하는 가장 간단한 방법은 [NRQL 쿼리](/docs/query-data/nrql-new-relic-query-language/getting-started/introduction-nrql)를 수락하는 [쿼리 빌더](/docs/query-your-data/explore-query-data/query-builder/use-advanced-nrql-mode-specify-data)를 사용하는 것입니다. 또는 [NerdGraph API](/docs/apis/nerdgraph/get-started/introduction-new-relic-nerdgraph)를 사용하여 쿠버네티스 데이터를 검색할 수 있습니다.

### 이벤트 및 속성 [#event-types]

쿠버네티스 데이터는 다음 [이벤트](/docs/using-new-relic/data/understand-data/new-relic-data-types#event-data)에 연결됩니다. [뉴렐릭의 데이터 사전](https://docs.newrelic.com/attribute-dictionary/?dataSource=Kubernetes)에서 이 데이터에 대해 자세히 알아볼 수 있습니다.

<table>
  <thead>
    <tr>
      <th style={{ width: "275px" }}>
        이벤트 이름
      </th>

      <th>
        쿠버네티스 데이터 유형
      </th>

      <th style={{ width: "200px" }}>
        이후 사용 가능
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `K8sNodeSample`
      </td>

      <td>
        노드 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sNamespaceSample`
      </td>

      <td>
        네임스페이스 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sDeploymentSample`
      </td>

      <td>
        배포 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sReplicasetSample`
      </td>

      <td>
        ReplicaSet 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sDaemonsetSample`
      </td>

      <td>
        DaemonSet 데이터
      </td>

      <td>
        v1.13.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sStatefulsetSample`
      </td>

      <td>
        StatefulSet 데이터
      </td>

      <td>
        v1.13.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sPodSample`
      </td>

      <td>
        포드 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sClusterSample`
      </td>

      <td>
        클러스터 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sContainerSample`
      </td>

      <td>
        컨테이너 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sVolumeSample`
      </td>

      <td>
        볼륨 데이터
      </td>

      <td>
        v1.0.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sApiServerSample`
      </td>

      <td>
        API 서버 데이터
      </td>

      <td>
        v1.11.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sControllerManagerSample`
      </td>

      <td>
        컨트롤러 관리자 데이터
      </td>

      <td>
        v1.11.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sSchedulerSample`
      </td>

      <td>
        스케줄러 데이터
      </td>

      <td>
        v1.11.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sEtcdSample`
      </td>

      <td>
        etcd 데이터
      </td>

      <td>
        v1.11.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sEndpointSample`
      </td>

      <td>
        엔드포인트 데이터
      </td>

      <td>
        v1.13.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sServiceSample`
      </td>

      <td>
        서비스 데이터
      </td>

      <td>
        v1.13.0
      </td>
    </tr>

    <tr>
      <td>
        `K8sHpaSample`
      </td>

      <td>
        수평 포드 오토스케일러 데이터
      </td>

      <td>
        v2.3.0
      </td>
    </tr>
  </tbody>
</table>

이러한 이벤트와 그 속성에 대해 자세히 알아보려면 [데이터 사전](https://docs.newrelic.com/attribute-dictionary/?dataSource=Kubernetes)을 참조하십시오.

### APM 모니터링 애플리케이션의 쿠버네티스 메타데이터 [#apm-custom-attributes]

[애플리케이션을 쿠버네티스와 연결](/docs/integrations/kubernetes-integration/metadata-injection/kubernetes-apm-metadata-injection)하면 애플리케이션 추적 및 분산 추적에 다음 속성이 추가됩니다.

* `nodeName`
* `containerName`
* `podName`
* `clusterName`
* `deploymentName`
* `namespaceName`

## 알림 관리 [#alerts]

쿠버네티스 데이터의 알림 violations 시 공지를 받을 수 있습니다.

<CollapserGroup>
  <Collapser
    id="create-alert"
    title="알림 조건 만들기"
  >
    쿠버네티스 통합에 대한 알림 조건을 생성하려면 다음 단계를 따릅니다.

    1. **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Infrastructure > Settings > Alerts & AI > Kubernetes**로 이동하여, **Create alert condition**을 선택합니다.

    2. 선택한 속성만 있는 쿠버네티스 엔터티에 대한 알림을 필터링하려면 **Filter**를 선택합니다.

    3. 임계값 설정을 선택합니다. **다음 경우에 알림 트리거** 옵션에 대한 자세한 내용은 [알림 유형](#alert-types)을 참조하십시오.

    4. 기존 [알림 정책](/docs/alerts/new-relic-alerts/configuring-alert-policies/create-or-rename-alert-policy)을 선택하거나 새 알림 정책을 만듭니다.

    5. **Create**를 선택합니다.

       알림 조건의 임계값이 트리거되면 뉴렐릭은 정책의 알림 채널에 [알림](#notifications)을 보냅니다.
  </Collapser>

  <Collapser
    id="alert-types"
    title="사전 정의된 알림 유형 및 임계값 사용"
  >
    쿠버네티스 통합은 자체 alerts 정책 및 알림 조건과 함께 제공됩니다. 사전 정의된 알림 조건이 무엇인지 확인하려면 [쿠버네티스 통합: 사전 정의된 알림 정책](/docs/integrations/kubernetes-integration/kubernetes-events/kubernetes-integration-predefined-alert-policy)을 참조하십시오.

    또한 쿠버네티스 통합을 포함하여 사용하는 [뉴렐릭 통합](/docs/integrations/new-relic-integrations/getting-started/introduction-infrastructure-integrations)에서 수집한 모든 메트릭에 대한 알림 조건을 생성할 수 있습니다.

    1. 알림 유형 **통합**을 선택합니다.
    2. **Select a data source** 드롭다운에서 쿠버네티스 데이터 원본을 선택합니다.
  </Collapser>

  <Collapser
    id="notifications"
    title="알림 전송 선택"
  >
    알림 조건의 임계값이 트리거되면 뉴렐릭은 알림 정책에서 선택한 알림 채널로 메시지를 보냅니다. 알림 유형에 따라 다음과 같은 옵션이 있을 수 있습니다.

    * [인시던트를 확인합니다](/docs/alerts/new-relic-alerts/reviewing-alert-incidents/view-violation-event-details-incidents).

    * [인시던트를 인지합니다](/docs/alerts/new-relic-alerts/reviewing-alert-incidents/acknowledge-alert-incidents).

    * 식별자 이름을 선택하여 인시던트 데이터 차트로 이동합니다.

      알림을 트리거한 엔터티 식별자는 공지 메시지 상단 근처에 나타납니다. 식별자 형식은 알림 유형에 따라 다릅니다.

    * **사용 가능한 포드가 원하는 포드 알림보다 적습니다** .

      ```
      K8s:CLUSTER_NAME:PARENT_NAMESPACE:replicaset:REPLICASET_NAME
      ```

    * **CPU 또는 메모리 사용량** 알림:

      ```
      K8s:CLUSTER_NAME:PARENT_NAMESPACE:POD_NAME:container:CONTAINER_NAME
      ```

      몇 가지 예는 다음과 같습니다.

      <CollapserGroup>
        <Collapser
          id="pod-alerts"
          title="Pod 알림 예시"
        >
          **사용 가능한 포드가 원하는 포드보다 적음** 알림의 경우, 문제를 트리거하는 `ReplicaSet`의 ID는 다음과 같을 수 있습니다.

          ```
          k8s:beam-production:default:replicaset:nginx-deployment-1623441481
          ```

          이 식별자에는 다음 정보가 포함됩니다.

          * 클러스터 이름: `beam-production`
          * 상위 네임스페이스: `default`
          * `ReplicaSet` 이름: `nginx-deployment-1623441481`
        </Collapser>

        <Collapser
          id="container-resource"
          title="컨테이너 리소스 알림 예시"
        >
          컨테이너 CPU 또는 메모리 사용량 알림의 경우, 엔터티는 다음과 같을 수 있습니다.

          ```
          k8s:beam-production:kube-system:kube-state-metrics-797bb87c75-zncwn:container:kube-state-metrics
          ```

          이 식별자에는 다음 정보가 포함됩니다.

          * 클러스터 이름: `beam-production`
          * 상위 네임스페이스: `kube-system`
          * 포드 네임스페이스: `kube-state-metrics-797bb87c75-zncwn`
          * 컨테이너 이름: `kube-state-metrics`
        </Collapser>
      </CollapserGroup>
  </Collapser>

  <Collapser
    id="nrql-alerts"
    title="NRQL을 사용하여 알림 조건 생성"
  >
    [NRQL 쿼리에 대한 알림 조건을 생성](/docs/alerts/new-relic-alerts/defining-conditions/create-alert-conditions-nrql-queries)하려면 표준 절차를 따릅니다.
  </Collapser>
</CollapserGroup>

## 데이터 인제스트 감소 [#reducedataingest]

뉴렐릭의 차트는 세부 정보를 제외시키는 대신 인제스트되는 데이터의 양을 줄이는 옵션 설정을 지원합니다. 이 옵션을 활성화하려면 `nri-bundle` 차트에서 `global.lowDataMode`를 `true`로 설정합니다.

`lowDataMode` 아래에 설명된 `nri-bundle` 차트의 4가지 특정 구성요소에 영향을 미칩니다.

### 뉴렐릭 Infrastructure

`lowDataMode`가 활성화되면 기본 스크래핑 간격이 `15s`에서 `30s`로 변경됩니다. `lowDataMode`보다 우선 적용되는 `config.interval`을 사용하여 커스텀 값을 지정할 수도 있습니다.

### Prometheus 에이전트 통합

`lowDataMode`가 활성화되면, 다음 접두사가 붙은 메트릭은 [뉴렐릭 쿠버네티스 통합](/docs/integrations/kubernetes-integration/understand-use-data/find-use-your-kubernetes-data/#event-types)에서 이미 수집 및 사용되므로 기본적으로 제외됩니다.

```
- kube_
- container_
- machine_
- cadvisor_
```

### 뉴렐릭 로깅

`lowDataMode`가 활성화된 경우 레이블 및 주석은 fluent-bit.conf 파일의 [Filter 섹션](https://github.com/newrelic/helm-charts/blob/master/charts/newrelic-logging/templates/configmap.yaml#L38-L39)에서 `Off`로 설정됩니다. 이는 세부 정보가 컨테이너 로그 파일에서 삭제되어 뉴렐릭으로의 전체 데이터 인제스트가 줄어든다는 의미입니다.

다음 필드는 유지됩니다.

```
Allowlist_key  container_name
Allowlist_key  namespace_name
Allowlist_key  pod_name
Allowlist_key  stream
Allowlist_key  log
```

**Low Data Mode Log Example**

Complete Log Record

```
[
  {
    "cluster_name": "api-test",
    "kubernetes": {
      "annotations": {
        "kubernetes.io/psp": "eks.privileged"
      },
      "container_hash": "fryckbos/test@sha256:5b098eaf3c7d5b3585eb10cebee63665b6208bea31ef31a3f0856c5ffdda644b",
      "container_image": "fryckbos/test:latest",
      "container_name": "newrelic-logging",
      "docker_id": "134e1daf63761baa15e035b08b7aea04518a0f0e50af4215131a50c6a379a072",
      "host": "ip-192-168-17-123.ec2.internal",
      "labels": {
        "app": "newrelic-logging",
        "app.kubernetes.io/name": "newrelic-logging",
        "controller-revision-hash": "84db95db86",
        "pod-template-generation": "1",
        "release": "nri-bundle"
      },
      "namespace_name": "nrlogs",
      "pod_id": "54556e3e-719c-46b5-af69-020b75d69bf1",
      "pod_name": "nri-bundle-newrelic-logging-jxnbj"
    },
    "message": "[2021/09/14 12:30:49] [ info] [engine] started (pid=1)\n",
    "plugin": {
      "source": "kubernetes",
      "type": "fluent-bit",
      "version": "1.8.1"
    },
    "stream": "stderr",
    "time": "2021-09-14T12:30:49.138824971Z",
    "timestamp": 1631622649138
  }
]
```

Log Record after enabling `lowDataMode`.

```
[
  {
    "cluster_name": "api-test",
    "container_name": "newrelic-logging",
    "namespace_name": "nrlogs",
    "pod_name": "nri-bundle-newrelic-logging-jxnbj",
    "message": "[2021/09/14 12:30:49] [ info] [engine] started (pid=1)\n",
    "stream": "stderr",
    "timestamp": 1631622649138
  }
]
```

### 뉴렐릭 Pixie 통합 [#nr-pixie-integration]

`lowDataMode`가 활성화된 경우 `newrelic-pixie` 통합은 Pixie 스팬에서 더 많은 샘플링을 수행하고 수집 간격을 10초에서 15초로 줄입니다.

`lowDataMode` settings:

```
HTTP_SPAN_LIMIT: 750
DB_SPAN_LIMIT: 250
COLLECT_INTERVAL_SEC: 15
```

이러한 파라미터와 기타 파라미터에 대한 기본 설정은 [newrelic-pixie-integration](https://github.com/newrelic/newrelic-pixie-integration) Github 리포지토리에서 찾을 수 있습니다.