---
title: 'NerdGraph 튜토리얼: RAG 통합 설정'
metaDescription: Enhance New Relic AI with RAG (Retrieval Augmented Generation)
freshnessValidatedDate: never
translationType: machine
---

<Callout title="시사">
  이 기능은 아직 개발 중이지만 꼭 사용해 보시기 바랍니다!

  이 기능은 현재 [출시 전 정책](/docs/licenses/license-information/referenced-policies/new-relic-pre-release-policy) 에 따라 미리보기 프로그램의 일부로 제공됩니다.
</Callout>

뉴렐릭을 사용하면 문서, 런북, 인시던트 레트로, 심지어 서비스와 연결하여 검색 생성(RAG)으로 뉴렐릭 AI 에이전트를 향상할 수 있습니다. 이 프로세스를 통해 뉴렐릭 AI는 시스템 문제를 더 효과적으로 파악할 수 있습니다. 이 튜토리얼에서는 조직 ID를 얻는 방법, RAG 도구를 만드는 방법, Blob API를 사용하여 플랫폼에 문서를 추가하는 방법을 설명합니다.

문서를 추가한 후 RAG 도구와 연결하는 관계를 생성합니다. 그런 다음 RAG 문서와 RAG 도구 간의 관계를 쿼리하여 설정을 확인할 수 있습니다. 마지막 단계는 RAG 도구 자체에 쿼리를 보내 관련 색인 정보를 검색하는 것입니다.

지식 커넥터에 대해 자세히 알아보려면 [뉴렐릭 AI 지식 커넥터를](/docs/agentic-ai/knowledge-integration/overview) 참조하세요.

<Callout variant="important">
  다음 단계를 수행하기 전에 &quot;조직 제품 관리자&quot; 권한이 있는지 확인하세요.
</Callout>

뉴렐릭 AI를 통해 콘텐츠 인덱싱을 시작하고 지식 커넥터의 이점을 누리려면 다음 단계를 따르세요.

## 작업 1: RAG 도구 만들기 [#create-your-rag-tool]

<CollapserGroup>
  <Collapser id="get-started" title="귀하의 조직 ID를 얻으십시오">
    조직 ID는 귀하의 계정을 고유하게 식별하고 귀하가 만든 모든 RAG 도구, 귀하가 업로드하는 문서 또는 귀하가 설정하는 관계가 귀하의 조직과 연결되도록 보장합니다.

    NerdGraph에서 RAG 도구와 문서를 설정하고 관리할 때 변형과 쿼리를 수행하려면 조직 ID가 필요합니다. 다음 쿼리를 실행하고 이후 단계를 위해 조직 ID를 보관하세요.

    ### 샘플 쿼리

    ```graphql
    {
      actor {
        organization {
          id
        }
      }
    }
    ```
  </Collapser>

  <Collapser id="create-rag-tool" title="RAG 도구 만들기">
    RAG 도구는 뉴렐릭에서 관련 문서와 리소스를 정리하기 위한 특수 컨테이너 역할을 합니다. RAG 도구에 대한 명확한 이름과 정확한 설명은 LLM이 각 프롬프트에 맞는 올바른 도구를 선택하는 데 도움이 되며, 관련성 있고 상황에 맞는 응답을 보장합니다.

    NEW렐릭 계정에서 새 RAG 도구를 만들려면 다음 `entityManagementCreateRagTool` 뮤테이션을 실행하세요.

    1. `${ORGANIZATION_ID}` 이전 단계에서 얻은 실제 조직 ID로 바꿔야 합니다.
    2. 성공하면 RAG 도구에 대한 `id` 을 받게 됩니다.

    ### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `ragToolEntity`
          </td>

          <td>
            물체
          </td>

          <td>
            네
          </td>

          <td>
            새로운 RAG 도구에 대한 설정이 포함된 입력 개체입니다.
          </td>
        </tr>

        <tr>
          <td>
            `description`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            RAG 도구의 목적에 대한 명확하고 정확한 설명.
          </td>
        </tr>

        <tr>
          <td>
            `name`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            RAG 도구에 대한 고유한 이름입니다.
          </td>
        </tr>

        <tr>
          <td>
            `scope`
          </td>

          <td>
            물체
          </td>

          <td>
            네
          </td>

          <td>
            도구가 생성될 컨텍스트를 정의하는 객체입니다.
          </td>
        </tr>

        <tr>
          <td>
            `scope.id`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            귀하의 조직의 고유 ID(

            `${ORGANIZATION_ID}`

            ).
          </td>
        </tr>

        <tr>
          <td>
            `scope.type`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            범위의 유형은 

            `ORGANIZATION`

             이어야 합니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 돌연변이

    ```graphql
    mutation {
      entityManagementCreateRagTool(
        ragToolEntity: {
          description: "Runbooks for resolving incidents with APIs",
          name: "API Runbooks",
          scope: {id: `${ORGANIZATION_ID}`, type: ORGANIZATION}
        }
      ) {
        entity {
          id
        }
      }
    }
    ```

    `id` 은 이후 단계에서 문서를 도구에 연결하고, 관계를 확인하고, 뉴렐릭에서 관련 정보를 도구에 쿼리하는 데 필요하므로 반환된 값을 저장해야 합니다.
  </Collapser>
</CollapserGroup>

## 작업 2: 문서 색인화 [#index-your-documents]

<CollapserGroup>
  <Collapser id="upload-document" title="Blob API를 통해 문서 업로드">
    <Callout variant="important">
      모든 색인된 문서는 조직 내 모든 사용자가 볼 수 있습니다. 색인하는 문서가 내부 정책을 준수하는지 확인하고, 민감하거나 개인적인 데이터를 업로드하지 않도록 하세요.
    </Callout>

    ### Blob API와 그 목적

    Blob API 문서, 런북 등의 파일을 계정에 업로드하기 위해 설계된 뉴렐릭 서비스입니다. NerdGraph는 구조화된 데이터 쿼리와 변형에 최적화되어 있고, 효율적인 파일 전송에는 적합하지 않으므로, 문서를 업로드하려면 Blob API가 필요합니다.

    ### 인증 요구 사항

    문서를 업로드할 수 있는 권한이 있는 유효한 뉴렐릭 API 키가 필요합니다. Blob API 사용하여 뉴렐릭에 문서를 업로드하기 위한 API 키를 얻으려면:

    1. [뉴렐릭](https://one.newrelic.com/) 계정에 로그인하세요.
    2. [API 키 UI 페이지](https://one.newrelic.com/administration/api-keys) 에서 API 키를 만들고 관리하세요.
    3. **Create a key** \[키 만들기를] 클릭하고 필요한 세부 정보를 입력하거나 필요한 권한이 있는 기존 키를 사용합니다.
    4. **Create a key** \[키 만들기를] 클릭하고 생성된 키를 복사합니다(NRAK-XXXXXXXXXX와 유사합니다).

    `curl` `bash` 명령을 사용하여 문서를 업로드하는 방법의 예는 다음과 같습니다.

    ### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `Api-Key`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            인증을 위한 뉴렐릭 API 키입니다.
          </td>
        </tr>

        <tr>
          <td>
            `NewRelic-Entity`
          </td>

          <td>
            JSON 객체
          </td>

          <td>
            네
          </td>

          <td>
            문서의 이름 등 해당 문서에 대한 메타데이터입니다.
          </td>
        </tr>

        <tr>
          <td>
            `Content-Type`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            업로드되는 파일의 형식(예: 

            `application/json`

            ).
          </td>
        </tr>

        <tr>
          <td>
            `payload`

             (

            `@incidents.json`

            )
          </td>

          <td>
            파일
          </td>

          <td>
            네
          </td>

          <td>
            파일 경로를 통해 지정되는 업로드하는 문서 파일입니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 쿼리

    ```shell
    curl -X POST https://blob-api.service.newrelic.com/v1/e/organizations/$ORGANIZATION_ID/RagDocuments \
         -H 'Api-Key: NRAK-XXXXXXXXXX' \
         -H 'NewRelic-Entity: {"name": "Runbooks for API service" }' \
         -H 'Content-Type: application/json' \
         -d @incidents.json
    ```

    ### 샘플 응답

    <table>
      <thead>
        <tr>
          <th>
            응답
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `entityGuid`
          </td>

          <td>
            문자열
          </td>

          <td>
            업로드된 RAG 문서의 고유 식별자입니다.
          </td>
        </tr>

        <tr>
          <td>
            `blobVersionEntity`
          </td>

          <td>
            물체
          </td>

          <td>
            업로드된 blob의 버전을 나타냅니다.
          </td>
        </tr>
      </tbody>
    </table>

    ```json
    {
      "entityGuid": "MTIyODU0NTN8TkdFUHxSQUdfRE9DVU1FTlR8MDE5NGUyOTgtYmQzMS03NzA4LWI3NzItYzQ4MTZlYjNhYThk",
      "blobVersionEntity": null
    }
    ```

    ### 다음 단계

    문서를 업로드하면 색인이 생성되어 뉴렐릭 AI가 검색하고 검색할 수 있게 됩니다. RAG 도구와의 관계를 생성하거나 NerdGraph에서 문서를 쿼리하려면 응답에서 `entityGuid` 을 저장해야 합니다.
  </Collapser>

  <Collapser id="view-the-rag-document-entity-represented-in-nerdgraph" title="NerdGraph에 표현된 RAG 문서 보기">
    Blob API 통해 문서가 업로드된 후 이 쿼리를 실행하면 업로드가 성공했고 문서가 RAG 문서로 제대로 등록되었는지 확인할 수 있습니다. 고유한 사용자 및 속성이 있습니다.

    #### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `id`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            검색할 RAG 문서의 고유 GUID입니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 쿼리

    아래 쿼리에서 `${RAG_DOCUMENT_GUID}` 플레이스홀더를 이전 단계에서 받은 `entityGuid` 로 바꾸세요.

    ```graphql
    {
      actor {
        entityManagement {
          entity(
            id: `${RAG_DOCUMENT_GUID}`
          ) {
            ... on EntityManagementRagDocumentEntity {
              id
              name
              blob {
                url
              }
              type
            }
          }
        }
      }
    }
    ```

    이 쿼리는 RAG 문서에 대한 다음과 같은 세부 정보를 반환합니다.

    * `id`: RAG 문서의 고유 ID입니다.
    * `name`: RAG 문서의 이름.
    * `blob { url }`: 업로드된 문서에 접근하기 위한 URL입니다.
    * `type`: 이 경우 `EntityManagementRagDocumentEntity` 사고의 유형입니다.
  </Collapser>

  <Collapser id="create-a-relationship-between-the-rag-document-and-the-rag-tool" title="RAG 도구와 RAG 문서 간의 관계를 만듭니다.">
    이제 RAG 도구를 만들고, 문서를 업로드하고, 업로드가 성공했는지 확인했으니, 다음 단계는 RAG 도구와 RAG 문서를 연결하여 뉴렐릭 AI가 문서를 검색하고 사용할 수 있도록 하는 것입니다. 이렇게 하려면 `entityManagementCreateRelationship` 돌연변이를 실행하세요.

    1. Blob API를 통한 문서 업로드 응답에서 `${RAG_DOCUMENT_GUID}` `entityGuid` 로 바꾸세요.
    2. `${RAG_TOOL_GUID}` RAG 도구 생성 돌연변이의 응답에서 `id` 로 바꾸세요.

    ### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `relationship`
          </td>

          <td>
            물체
          </td>

          <td>
            네
          </td>

          <td>
            관계에 대한 세부 정보를 포함하는 입력 개체입니다.
          </td>
        </tr>

        <tr>
          <td>
            `source`
          </td>

          <td>
            물체
          </td>

          <td>
            네
          </td>

          <td>
            이 관계의 출처는 RAG 문서입니다.
          </td>
        </tr>

        <tr>
          <td>
            `source.scope`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            소스의 범위는 

            `ORGANIZATION`

             이어야 합니다.
          </td>
        </tr>

        <tr>
          <td>
            `source.id`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            RAG 문서의 고유 GUID(

            `${RAG_DOCUMENT_GUID}`

            ).
          </td>
        </tr>

        <tr>
          <td>
            `target`
          </td>

          <td>
            물체
          </td>

          <td>
            네
          </td>

          <td>
            RAG 도구인 관계의 터키, 목표를 분리합니다.
          </td>
        </tr>

        <tr>
          <td>
            `target.scope`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            구간, 분할의 범위는 

            `ORGANIZATION`

             이어야 합니다.
          </td>
        </tr>

        <tr>
          <td>
            `target.id`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            RAG 도구의 고유 GUID(

            `${RAG_TOOL_GUID}`

            ).
          </td>
        </tr>

        <tr>
          <td>
            `type`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            관계의 유형은 

            `"INDEXED_FOR"`

             이어야 합니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 돌연변이

    ```graphql
    mutation {
      entityManagementCreateRelationship(
        relationship: {
          source: {
            scope: ORGANIZATION,
            id: `${RAG_DOCUMENT_GUID}`
          },
          target: {
            scope: ORGANIZATION,
            id: `${RAG_TOOL_GUID}`
          },
          type: "INDEXED_FOR"
        }
      ) {
        relationship {
          type
          target {
            id
            type
          }
          source {
            id
            type
          }
        }
      }
    }
    ```
  </Collapser>
</CollapserGroup>

## 과제 3: 관련 정보 검색 [#retrieve-relevant-information]

<CollapserGroup>
  <Collapser id="query-to-see-relationships-between-rag-documents-and-rag-tools" title="RAG 문서와 RAG 도구 간의 관계를 확인하는 쿼리">
    RAG 문서와 RAG 도구 간의 관계를 만든 후 NerdGraph에서 관계를 쿼리하여 연관성을 확인할 수 있습니다. 이렇게 하면 문서가 제대로 연결되고 AI가 사용할 수 있도록 보장하는 데 도움이 됩니다.

    * `${RAG_DOCUMENT_ID}` 업로드한 문서의 `entityGuid` 로 바꾸세요.

    ### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `relationships`
          </td>

          <td>
            질문
          </td>

          <td>
            네
          </td>

          <td>
            파트 간의 관계를 검색하는 쿼리입니다.
          </td>
        </tr>

        <tr>
          <td>
            `filter`
          </td>

          <td>
            물체
          </td>

          <td>
            아니요
          </td>

          <td>
            속성을 기준으로 관계를 필터링하는 데 사용되는 객체입니다.
          </td>
        </tr>

        <tr>
          <td>
            `filter.sourceId`
          </td>

          <td>
            물체
          </td>

          <td>
            아니요
          </td>

          <td>
            소스의 고유 분리로 필터링할 개체입니다.
          </td>
        </tr>

        <tr>
          <td>
            `filter.sourceId.eq`
          </td>

          <td>
            문자열
          </td>

          <td>
            아니요
          </td>

          <td>
            일치시킬 RAG 문서의 고유 GUID입니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 쿼리

    ```graphql
    {
      actor {
        entityManagement {
          relationships(
            filter: {sourceId: {eq: `${RAG_DOCUMENT_ID}`}}
          ) {
            items {
              type
              target {
                id
                type
              }
            }
          }
        }
      }
    }
    ```
  </Collapser>

  <Collapser id="query-the-rag-tool" title="RAG 도구 쿼리">
    RAG 도구를 설정하고 문서를 색인한 후 RAG 도구를 쿼리하여 질문에 대한 관련 정보를 검색할 수 있습니다. 이를 통해 뉴렐릭 AI는 귀하의 조직의 문서를 사용하여 상황에 맞는 답변을 표면화할 수 있습니다.

    ### 입력스피커, 변수

    <table>
      <thead>
        <tr>
          <th>
            반응, 이름
          </th>

          <th>
            데이터 형식
          </th>

          <th>
            꼭 필요한가요?
          </th>

          <th>
            설명
          </th>
        </tr>
      </thead>

      <tbody>
        <tr>
          <td>
            `prompt`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            RAG 도구에서 처리하려는 자연어 쿼리입니다.
          </td>
        </tr>

        <tr>
          <td>
            `toolId`
          </td>

          <td>
            문자열
          </td>

          <td>
            네
          </td>

          <td>
            쿼리할 RAG 도구의 고유 GUID입니다.
          </td>
        </tr>
      </tbody>
    </table>

    ### 샘플 쿼리

    ```graphql
    {
      actor {
        machineLearning {
          ragQueryData(
            prompt: "tell me about the incident", 
            toolId: `${RAG_TOOL_GUID}`
          ) {
            blobId
            chunk
            documentId
            score
            toolId
          }
        }
      }
    }
    ```

    응답에는 색인된 문서에서 일치하는 부분이 포함되며, 직접 사용하거나 뉴렐릭 AI로 요약할 수 있습니다.
  </Collapser>
</CollapserGroup>