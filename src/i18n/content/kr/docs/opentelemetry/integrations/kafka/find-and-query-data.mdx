---
title: 뉴렐릭에서 Kafka 데이터 찾기 및 조회
tags:
  - Integrations
  - OpenTelemetry
  - Kafka
  - Query data
metaDescription: Learn how to find your Kafka metrics in New Relic UI and write NRQL queries to analyze your data.
freshnessValidatedDate: never
translationType: machine
---

Kafka 모니터링이 OpenTelemetry 로 구성되면 지표가 뉴렐릭의 여러 위치에 표시됩니다. 이 가이드는 데이터를 찾는 방법과 효과적으로 쿼리하는 방법을 안내합니다.

## Kafka 데이터로 이동하세요 [#find-data]

Kafka 지표는 뉴렐릭 플랫폼의 여러 위치에 표시되며 각각은 다양한 사용 사례에 최적화되어 있습니다.

### 1. 엔티티 탐색기

최적의 용도: 빠른 상태 점검 및 엔티티 관계 분석

1. 이동 <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; On host integrations**</DNT>
2. Kafka 브로커, 클러스터 및 토픽 엔티티 유형을 확인하세요.

<img title="OTel Kafka Entity Explorer" alt="Entity explorer showing Kafka broker, cluster, and topics entity types" src="/images/otel-kafka-entityexplorer.webp" />

### 2. 큐 및 스트림

최적의 용도: 클러스터 집중 모니터링

1. 이동 <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; All capabilities &gt; Queues &amp; Streams**</DNT>
2. `provider=opentelemetry` 으로 필터링하고 Kafka를 활성화한 계정 행을 클릭하여 데이터를 확인하세요.

<img title="OTel Kafka Queues & Streams" alt="Queues & Streams view showing Kafka data filtered by OpenTelemetry provider" src="/images/otel-kafka-queues-streams.webp" />

/\* ### 3. Third-party services Best for: Integration-focused monitoring 1. Go to &lt;DNT&gt;\*\*\[one.newrelic.com]\(https\://one.newrelic.com) &gt; All capabilities &gt; Infrastructure &gt; Third-party services\*\*&lt;/DNT&gt; 2. Select &lt;DNT&gt;\*\*Kafka (OpenTelemetry)\*\*&lt;/DNT&gt; &gt; &lt;DNT&gt;\*\*OpenTelemetry Kafka\*\*&lt;/DNT&gt; &lt;img title=&quot;OTel Kafka Third-party Services&quot; alt=&quot;Third-party services view showing Kafka (OpenTelemetry) integration&quot; src=&quot;/images/infrastructure\_screenshot-crop\_otel-kafka-third-party-integrations.webp&quot; /&gt; \*/

### 3. 사전 구축된 대시보드

최적 사용 용도: 종합적인 모니터링 및 시각화

1. 이동 <DNT>**[one.newrelic.com](https://one.newrelic.com) &gt; Dashboards &gt; Recommended dashboards (View all)**</DNT>
2. 검색 <DNT>**&quot;OpenTelemetry Kafka&quot;**</DNT>

<img title="OpenTelemetry Kafka" alt="Pre-built dashboard showing Kafka cluster health, network throughput, and broker metrics" src="/images/otel-kafka-prebuilt-dashboards.webp" />

## NRQL을 사용하여 Kafka 데이터를 쿼리합니다. [#query-data]

[NRQL을](/docs/nrql/get-started/introduction-nrql-new-relics-query-language) 사용하여 Kafka 데이터에 대한 사용자 지정 쿼리 및 대시보드를 생성하세요.

<CollapserGroup>
  <Collapser id="basic-queries" title="기본 쿼리">
    **모든 Kafka 메트릭을 보려면 여기를 클릭하십시오.**

    ```sql
    FROM Metric SELECT *
    WHERE instrumentation.provider='opentelemetry'
    AND kafka.cluster.name IS NOT NULL
    LIMIT 100
    ```

    **특정 클러스터를 모니터링하세요:**

    ```sql
    FROM Metric SELECT *
    WHERE kafka.cluster.name = 'production-cluster'
    AND instrumentation.provider='opentelemetry'
    ```
  </Collapser>

  <Collapser id="consumer-lag-queries" title="소비자 지연 모니터링">
    **그룹별 소비자 지연 현상:**

    ```sql
    FROM Metric SELECT latest(kafka.consumer_group.lag)
    WHERE instrumentation.provider='opentelemetry'
    FACET group, topic
    SINCE 1 hour ago TIMESERIES
    ```

    **높은 소비자 지연 공지:**

    ```sql
    FROM Metric SELECT max(kafka.consumer_group.lag)
    WHERE instrumentation.provider='opentelemetry'
    AND group = 'your-consumer-group'
    ```
  </Collapser>

  <Collapser id="broker-health-queries" title="브로커 상태 조회">
    **활성 브로커 수:**

    ```sql
    FROM Metric SELECT latest(kafka.brokers)
    WHERE instrumentation.provider='opentelemetry'
    AND kafka.cluster.name = 'your-cluster'
    TIMESERIES
    ```

    **복제가 불완전한 파티션:**

    ```sql
    FROM Metric SELECT latest(kafka.partition.under_replicated)
    WHERE instrumentation.provider='opentelemetry'
    FACET broker.id SINCE 1 hour ago
    ```
  </Collapser>

  <Collapser id="performance-queries" title="성능 모니터링">
    **토픽별 메시지 처리량:**

    ```sql
    FROM Metric SELECT rate(sum(kafka.prod.msg.count), 1 minute) as 'Messages/min'
    WHERE instrumentation.provider='opentelemetry'
    FACET topic SINCE 1 hour ago TIMESERIES
    ```

    **브로커별 네트워크 I/O:**

    ```sql
    FROM Metric SELECT rate(sum(kafka.network.io), 1 minute) as 'Bytes/min'
    WHERE instrumentation.provider='opentelemetry'
    FACET broker.id, direction SINCE 1 hour ago TIMESERIES
    ```
  </Collapser>
</CollapserGroup>

## 고급 쿼리 [#advanced-queries]

모니터링 중점 분야별로 정리된 보다 자세한 쿼리 예시는 다음과 같습니다.

<CollapserGroup>
  <Collapser id="cluster-overview-queries" title="Cluster 개요">
    Get high-level cluster statistics and health:

    ```sql
    FROM Metric SELECT
      max(kafka.brokers) AS 'Active Brokers',
      max(kafka.cluster.topic.count) AS 'Total Topics',
      max(kafka.cluster.partition.count) AS 'Total Partitions',
      latest(kafka.partition.offline) AS 'Offline Partitions'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    TIMESERIES
    ```
  </Collapser>

  <Collapser id="broker-health-queries" title="브로커 건강">
    개별 브로커의 건강 상태와 리더십을 모니터링하십시오.

    ```sql
    FROM Metric SELECT
      latest(kafka.partition.under_replicated) AS 'Under-replicated Partitions',
      latest(kafka.broker.leader.count) AS 'Leader Count',
      latest(kafka.partition.count) AS 'Total Partitions'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET broker.id
    TIMESERIES
    ```
  </Collapser>

  <Collapser id="topic-throughput-queries" title="토픽 처리량 및 I/O">
    주제별 메시지 전송률 및 데이터 처리량을 모니터링합니다.

    ```sql
    FROM Metric SELECT
      rate(sum(kafka.prod.msg.count), 1 minute) AS 'Messages/min',
      rate(filter(sum(kafka.topic.io), WHERE direction = 'in'), 1 minute) AS 'Bytes In/min',
      rate(filter(sum(kafka.topic.io), WHERE direction = 'out'), 1 minute) AS 'Bytes Out/min'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET topic
    TIMESERIES
    ```
  </Collapser>

  <Collapser id="consumer-lag-queries" title="소비자 지연">
    소비자 그룹 지연 및 처리 지연을 추적합니다.

    ```sql
    FROM Metric SELECT
      latest(kafka.consumer_group.lag_sum) AS 'Total Lag'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET group
    TIMESERIES
    ```
  </Collapser>

  <Collapser id="request-latency-queries" title="요청 지연시간">
    요청 처리 시간 및 성능을 모니터링합니다.

    ```sql
    FROM Metric SELECT
      latest(kafka.request.time.avg) AS 'Avg Latency',
      latest(`kafka.request.time.99p`) AS '99th Percentile'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET type
    TIMESERIES
    ```
  </Collapser>

  <Collapser id="jvm-health-queries" title="JVM 건강">
    Kafka 브로커의 JVM 메트릭을 모니터링합니다.

    ```sql
    FROM Metric SELECT
      (latest(jvm.memory.heap.used) / latest(jvm.memory.heap.max)) * 100 AS 'Heap Usage %',
      rate(sum(jvm.gc.collections.count), 1 minute) AS 'GC Count/min'
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET broker.id
    TIMESERIES
    ```
  </Collapser>
</CollapserGroup>

## 맞춤형 대시보드 만들기 [#custom-dashboards]

여러 쿼리를 결합하여 포괄적인 Kafka 모니터링 대시보드를 생성하세요.

1. [one.newrelic.com](https://one.newrelic.com) &gt; Dashboards로 이동하세요.

2. &quot;대시보드 생성&quot;을 클릭하세요.

3. 위의 NRQL 쿼리를 사용하여 위젯을 추가하세요.

4. 위젯을 주요 영역별로 정리하세요:

   * Cluster 상태: 브로커 수, 복제 부족 파티션 수, 컨트롤러 상태
   * 소비자 성능: 지연 시간, 처리량, 그룹 멤버십
   * 토픽 메트릭: 메시지 전송률, 파티션 수, 복제 상태
   * 리소스 활용률: 네트워크 I/O, JVM 메트릭, 디스크 사용량

## 알림 설정 [#alerts]

<Callout variant="tip">
  뉴렐릭은 Kafka에 대해 사전 구성된 골든 지표 알림을 제공합니다. 새로운 공지 조건을 생성할 때 **Guided mode** → **Host integrations** → **Kafka** (브로커, 클러스터, 토픽)를 선택하면 권장 공지 템플릿을 볼 수 있습니다.
</Callout>

NRQL 쿼리를 사용하여 사용자 지정 알림을 생성할 수도 있습니다.

<CollapserGroup>
  <Collapser id="consumer-lag-alert" title="높은 소비자 지연">
    공지 소비자 지연이 귀하의 허용 가능한 올리브 값을 초과하는 경우:

    ```sql
    FROM Metric SELECT
      latest(kafka.consumer_group.lag_sum)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET group
    ```

    **권장값**: 중요한 소비자 그룹에 대해 지연 시 &gt; 10,000개의 메시지를 공지합니다.
  </Collapser>

  <Collapser id="under-replicated-alert" title="불완전 복제 파티션">
    파티션이 복제를 잃으면 다음과 같은 문제가 발생합니다.

    ```sql
    FROM Metric SELECT
      sum(kafka.partition.under_replicated)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    ```

    **권장값: 이전 값**: 파티션이 과소 복제(&gt; 0)되는 경우 공지.
  </Collapser>

  <Collapser id="offline-partitions-alert" title="오프라인 파티션">
    파티션이 오프라인 상태가 되면 즉시 공지합니다.

    ```sql
    FROM Metric SELECT
      latest(kafka.partition.offline)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    ```

    **권장 값, 경계**: 파티션이 오프라인 상태가 되면 즉시 공지됩니다(&gt; 0).
  </Collapser>

  <Collapser id="min-isr-alert" title="최소 ISR 하의 분할">
    파티션 동기화 복제본 수가 최소치 미만으로 떨어지면 공지합니다.

    ```sql
    FROM Metric SELECT
      latest(kafka.partition.under_min_isr)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET broker.id
    ```

    **권장 값, 경계**: 파티션이 최소 ISR(&gt; 0) 아래로 떨어지는 경우 공지됩니다.
  </Collapser>

  <Collapser id="jvm-memory-alert" title="JVM 메모리 사용량이 높습니다.">
    힙 사용량이 중요한 경우 공지:

    ```sql
    FROM Metric SELECT
      (latest(jvm.memory.heap.used) / latest(jvm.memory.heap.max)) * 100
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET broker.id
    ```

    **권장 값, 경계**: 지속적인 기간 동안 힙 사용량 &gt; 85%인 경우를 공지합니다.
  </Collapser>

  <Collapser id="request-failures-alert" title="요청 실패">
    높은 요청 실패율에 대한 공지:

    ```sql
    FROM Metric SELECT
      rate(sum(kafka.request.failed), 1 minute)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    FACET type
    ```

    **권장값, 경계**: 실패율이 전체 requests 의 1%를 초과하는 경우 공지됩니다.
  </Collapser>

  <Collapser id="unclean-elections-alert" title="부정한 지도자 선거">
    부정선거 관련 공지 (중개 실패를 나타냄):

    ```sql
    FROM Metric SELECT
      rate(sum(kafka.unclean.election.rate), 1 minute)
    WHERE kafka.cluster.name = 'production-cluster'
      AND instrumentation.provider='opentelemetry'
    ```

    **권장 값, 릴레이**: 불결한 지도자 선거에 대한 공지(&gt; 0).
  </Collapser>
</CollapserGroup>

## 다음 단계 [#next-steps]

* **[Kafka 메트릭 참조](/docs/opentelemetry/integrations/kafka/metrics-reference)** - 사용 가능한 모든 메트릭 목록 및 설명
* **[NRQL 공지 조건 생성](/docs/alerts/create-alert/create-alert-condition/create-nrql-alert-conditions/)** - 사전 예방적 모니터링 설정
* **[NRQL 튜토리얼](/docs/query-your-data/nrql-new-relic-query-language/get-started/introduction-nrql-new-relics-query-language)** - 고급 쿼리 기법 배우기