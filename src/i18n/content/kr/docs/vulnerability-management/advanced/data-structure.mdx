---
title: 보안 데이터 구조(NRQL 참조)
metaDescription: Learn about the data structure and entity types used to store security data in New Relic.
freshnessValidatedDate: never
translationType: machine
---

시큐리티 RX는 뉴렐릭의 데이터베이스(NRDB)에 잘못된 구성 데이터를 저장하고 NRQL 사용하여 쿼리할 수 있도록 합니다. 이 참조 가이드에서는 사용자 지정 쿼리, 대시보드 및 알림을 구축하는 데 사용할 수 있는 엔티티 유형, 속성 및 데이터 구조에 대해 설명합니다.

## 엔티티 및 이벤트 유형

시큐리티 RX는 다음 분할 및 이벤트 유형을 사용하여 보안 데이터를 저장합니다.

### SecurityFinding 엔티티(권장)

`SECURITY_FINDING` 은 시큐리티 RX에서 감지한 모든 보안 문제에 대한 일반 컨테이너 역할을 하는 특수한 부분 유형입니다. 이는 뉴렐릭에서 보안 데이터를 쿼리하는 데 권장되는 방법입니다.

**중요:** SecurityFinding은 기존 이벤트 유형이 아닌 엔티티 유형으로 쿼리됩니다.

```sql
FROM Entity
SELECT * WHERE type = 'SECURITY_FINDING'
```

#### findingType 이해하기

`findingType` 속성은 데이터 소스를 구분하는 핵심 필드입니다.

* **`findingType = 'VULNERABILITY'`**: APM 에이전트, 인프라 에이전트 또는 타사 스캐너(Snyk, Trivy, FOSSA)와 같은 소스에서 취약점이 발견되었음을 나타냅니다.
* **`findingType = 'MISCONFIGURATION'`**: 시큐리티 RX 클라우드(예: AWS Security Hub, GuardDuty 또는 Config)에서 cloud 보안 상태 관리(CSPM) 문제가 발견되었음을 나타냅니다.

다른 findingType 값에는 `LIBRARY_VULNERABILITY`, `INFRASTRUCTURE_VULNERABILITY`, `APPLICATION_VULNERABILITY`, `SYSTEM_VULNERABILITY`, `SECURITY_EVENT` 및 `OTHER` 가 포함됩니다.

#### 핵심 엔티티 필드

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        예시
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `id`
      </td>

      <td>
        문자열
      </td>

      <td>
        이 SecurityFinding에 대해 전역적으로 고유한 예외(타겟, 목표 특정 CVE &amp; 영향을 받는 부분)
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `type`
      </td>

      <td>
        문자열
      </td>

      <td>
        엔티티 유형 - 항상 &quot;SECURITY_FINDING&quot;
      </td>

      <td>
        &quot;SECURITY_FINDING&quot;
      </td>
    </tr>

    <tr>
      <td>
        `name`
      </td>

      <td>
        문자열
      </td>

      <td>
        취약점 또는 잘못된 구성의 제목
      </td>

      <td>
        &quot;CVE-2024-12345: SQL 내부에 있는-name&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.id`
      </td>

      <td>
        문자열
      </td>

      <td>
        해당 문제가 발견된 계정 ID
      </td>

      <td>
        &quot;1234567&quot;
      </td>
    </tr>

    <tr>
      <td>
        `scope.type`
      </td>

      <td>
        문자열
      </td>

      <td>
        범위 유형 - 일반적으로 &quot;ACCOUNT&quot;
      </td>

      <td>
        &quot;ACCOUNT&quot;
      </td>
    </tr>

    <tr>
      <td>
        `metadata.createdAt`
      </td>

      <td>
        시간소인
      </td>

      <td>
        이 성이 만들어졌을 때
      </td>

      <td>
        유닉스 타임스탬프
      </td>
    </tr>

    <tr>
      <td>
        `metadata.updatedAt`
      </td>

      <td>
        시간소인
      </td>

      <td>
        이 엔티티가 마지막으로 업데이트된 시점은 언제입니까?
      </td>

      <td>
        유닉스 타임스탬프
      </td>
    </tr>

    <tr>
      <td>
        `tags`
      </td>

      <td>
        정렬
      </td>

      <td>
        엔티티에 적용 가능한 태그 목록 (일반적으로 &quot;SecurityFinding&quot;의 경우 비어 있음)
      </td>

      <td>
        \[]
      </td>
    </tr>
  </tbody>
</table>

#### 분류 필드

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        예시
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityIdentifier`
      </td>

      <td>
        문자열
      </td>

      <td>
        &quot;SecurityFindings&quot;을 집계하기 위한 식별자(일반적으로 CVE ID)
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingType`
      </td>

      <td>
        문자열
      </td>

      <td>
        최상위 유형의 발견
      </td>

      <td>
        &quot;VULNERABILITY&quot;, &quot;MISCONFIGURATION&quot;
      </td>
    </tr>

    <tr>
      <td>
        `findingSubType`
      </td>

      <td>
        문자열
      </td>

      <td>
        하위 유형(APM 취약점에 대한 언어, 인프라에 대한 INFRA_OS_VULNERABILITY 또는 INFRA_PACKAGE_VULNERABILITY)
      </td>

      <td>
        &quot;java&quot;, &quot;INFRA_PACKAGE_VULNERABILITY&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        문자열
      </td>

      <td>
        연구 결과의 출처
      </td>

      <td>
        &quot;뉴렐릭&quot;, &quot;Snyk&quot;, &quot;AWS Security Hub&quot;
      </td>
    </tr>
  </tbody>
</table>

#### 상태 및 심각도 필드

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        가치
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `severity`
      </td>

      <td>
        문자열
      </td>

      <td>
        발견된 증상의 심각도 보고
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;, &quot;UNKNOWN&quot;, &quot;INFO&quot;
      </td>
    </tr>

    <tr>
      <td>
        `status`
      </td>

      <td>
        문자열
      </td>

      <td>
        발견 내용의 현재 상황
      </td>

      <td>
        &quot;AFFECTED&quot;, &quot;IGNORED&quot;, &quot;NO_LONGER_DETECTED&quot;, &quot;UNKNOWN&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationExists`
      </td>

      <td>
        부울
      </td>

      <td>
        개선책이 존재하는지 여부
      </td>

      <td>
        true, false
      </td>
    </tr>

    <tr>
      <td>
        `remediation.upgradeAction`
      </td>

      <td>
        문자열
      </td>

      <td>
        시큐리티 RX가 제안하는 업그레이드
      </td>

      <td>
        &quot;버전 2.17.1로 업그레이드하세요&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.remediationDetails`
      </td>

      <td>
        문자열
      </td>

      <td>
        출처에서 발췌한 간략한 수정 텍스트
      </td>

      <td>
        &quot;라이브러리를 패치된 버전으로 업데이트하세요&quot;
      </td>
    </tr>

    <tr>
      <td>
        `remediation.url`
      </td>

      <td>
        문자열
      </td>

      <td>
        출처의 문서 URL
      </td>

      <td>
        &quot;

        [https://example.com/security-advisory](https://example.com/security-advisory)

        &quot;
      </td>
    </tr>
  </tbody>
</table>

#### CVE 참조 필드

취약점 발견 시, `cve` 객체에는 자세한 CVE 정보가 포함되어 있습니다.

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cve.id`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVE 식별자
      </td>
    </tr>

    <tr>
      <td>
        `cve.description`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVE 설명
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssScore`
      </td>

      <td>
        숫자
      </td>

      <td>
        CVSS 점수
      </td>
    </tr>

    <tr>
      <td>
        `cve.cvssVector`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVSS 벡터 문자열
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssScore`
      </td>

      <td>
        숫자
      </td>

      <td>
        EPSS 활용 확률 점수
      </td>
    </tr>

    <tr>
      <td>
        `cve.epssPercentile`
      </td>

      <td>
        숫자
      </td>

      <td>
        EPSS 백분위수 순위
      </td>
    </tr>

    <tr>
      <td>
        `cve.exploitKnown`
      </td>

      <td>
        부울
      </td>

      <td>
        알려진 취약점이 존재하는지 여부
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosureUrl`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVE가 공개된 URL
      </td>
    </tr>

    <tr>
      <td>
        `cve.disclosedAt`
      </td>

      <td>
        시간소인
      </td>

      <td>
        CVE가 공개되었을 때
      </td>
    </tr>
  </tbody>
</table>

#### 잘못된 필드 구성(클라우드 관련 문제)

구성 오류가 발견되면 `misconfiguration` 객체에는 클라우드별 정보가 포함됩니다.

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `misconfiguration.cloudProvider`
      </td>

      <td>
        문자열
      </td>

      <td>
        클라우드 공급자
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.issueTitle`
      </td>

      <td>
        문자열
      </td>

      <td>
        설정 오류 제목
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.misconfigurationType`
      </td>

      <td>
        문자열
      </td>

      <td>
        원본 소스에서 찾기 유형
      </td>
    </tr>

    <tr>
      <td>
        `misconfiguration.normalizedResourceType`
      </td>

      <td>
        문자열
      </td>

      <td>
        간소화된 리소스 유형(예: &quot;S3&quot;, &quot;EC2&quot;, &quot;RDS&quot;)
      </td>
    </tr>
  </tbody>
</table>

#### 영향을 받는 엔티티 필드

`impactedEntity` 객체는 어떤 뉴럴릭 창이 영향을 받는지 식별합니다.

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `impactedEntity.id`
      </td>

      <td>
        문자열
      </td>

      <td>
        엔티티 GUID
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.name`
      </td>

      <td>
        문자열
      </td>

      <td>
        엔티티 이름
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.type`
      </td>

      <td>
        문자열
      </td>

      <td>
        엔티티 유형(APM-APPLICATION, INFRA-HOST 등)
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.id`
      </td>

      <td>
        문자열
      </td>

      <td>
        계정 ID
      </td>
    </tr>

    <tr>
      <td>
        `impactedEntity.scope.type`
      </td>

      <td>
        문자열
      </td>

      <td>
        범위 유형
      </td>
    </tr>
  </tbody>
</table>

#### 타임스탬프 필드

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `firstDetected`
      </td>

      <td>
        시간소인
      </td>

      <td>
        해당 발견이 처음 확인되었을 때
      </td>
    </tr>

    <tr>
      <td>
        `findingUpdatedAt`
      </td>

      <td>
        시간소인
      </td>

      <td>
        해당 조사 결과가 마지막으로 업데이트된 시점은 언제입니까?
      </td>
    </tr>

    <tr>
      <td>
        `lastSeen`
      </td>

      <td>
        시간소인
      </td>

      <td>
        해당 발견물이 마지막으로 활성화된 것으로 확인된 시점은 언제였습니까?
      </td>
    </tr>
  </tbody>
</table>

#### UI 및 내부 필드

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `vulnerabilityUILinks.detailsUrl`
      </td>

      <td>
        문자열
      </td>

      <td>
        시큐리티 RX UI세부정보 페이지 링크
      </td>
    </tr>

    <tr>
      <td>
        `vulnerabilityUILinks.tabUrl`
      </td>

      <td>
        문자열
      </td>

      <td>
        시큐리티 RX UI의 파티 보기 링크
      </td>
    </tr>

    <tr>
      <td>
        `internalState.status`
      </td>

      <td>
        문자열
      </td>

      <td>
        내부 상태 필드
      </td>
    </tr>

    <tr>
      <td>
        `internalState.active`
      </td>

      <td>
        부울
      </td>

      <td>
        내부 활성 플래그(cloud 쿼리에서 사용됨)
      </td>
    </tr>

    <tr>
      <td>
        `entityLookupValue`
      </td>

      <td>
        문자열
      </td>

      <td>
        내부 필드 (실제 운영 환경에서는 숨겨집니다)
      </td>
    </tr>

    <tr>
      <td>
        `issueInstanceKey`
      </td>

      <td>
        문자열
      </td>

      <td>
        내부 필드 (실제 운영 환경에서는 숨겨집니다)
      </td>
    </tr>

    <tr>
      <td>
        `additionalInfo`
      </td>

      <td>
        객체의 분리
      </td>

      <td>
        핵심 가치 쌍이 포함된 추가 데이터 데이터(cloud 계정 ID 등에 사용)
      </td>
    </tr>
  </tbody>
</table>

<Callout variant="tip">
  &quot;내부&quot;로 표시된 필드는 현재 NRDB에서 볼 수 있지만 최종 출시 시에는 숨겨질 수 있습니다. `internalState.active` 필드는 cloud 구성 오류 검색에서 활성 결과를 필터링하는 데 일반적으로 사용됩니다.
</Callout>

#### 세션에 대한 쿼리 예제

**엔티티별 활성 심각 취약점 수를 계산합니다.**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND severity = 'CRITICAL'
FACET impactedEntity.name
```

**특정 CVE의 영향을 받는 엔티티를 찾으세요:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
  AND cve.id = 'CVE-2024-23944'
FACET impactedEntity.name
```

**현재 랜섬웨어 공격이 진행 중인 CVE를 찾아보세요:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.exploitKnown IS true
FACET impactedEntity.name, cve.id
```

**악용 가능성이 높은 취약점(높은 EPSS 점수)을 찾습니다.**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND cve.epssPercentile > '0.95'
FACET cve.id
```

**조사 결과를 뒷받침하는 보도 자료를 찾아보세요:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
FACET source
```

**높은 해리 포터와 분리:**

```sql
SELECT impactedEntity
FROM (
  SELECT count(*) AS vulnerableCount
  FROM Entity
  WHERE type = 'SECURITY_FINDING'
    AND severity IN ('CRITICAL', 'HIGH')
  FACET impactedEntity.name AS impactedEntity, severity
)
WHERE (severity = 'HIGH' AND vulnerableCount > 10)
   OR (severity = 'CRITICAL' AND vulnerableCount > 5)
```

#### cloud 구성 오류에 대한 쿼리 예시

**상태별로 고유한 잘못된 구성 수를 계산합니다.**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET status
```

**가장 흔한 설정 오류 유형 10가지:**

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.issueTitle
LIMIT 10
```

**가장 위험한 AWS 계정을 찾아보세요:**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity IN ('CRITICAL', 'HIGH')
FACET aparse(additionalInfo, '%"key":"cloudProviderAccountId","values":["*"]%') AS 'AWS Account ID'
LIMIT 10
```

**리소스 유형별 잘못된 구성 개수를 계산합니다.**

```sql
FROM Entity
SELECT uniqueCount(misconfiguration.issueTitle)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
FACET misconfiguration.normalizedResourceType
```

**중요하고 공개적으로 알려진 자료를 찾아보세요:**

```sql
FROM Entity
SELECT name, impactedEntity.name, misconfiguration.misconfigurationType
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
  AND internalState.active = true
  AND severity = 'CRITICAL'
  AND misconfiguration.misconfigurationType LIKE 'Effects/Data Exposure'
SINCE 1 day ago
```

### NrAiIncident (구형)

발견된 내용과 현재 상태를 저장하는 구형 이벤트 유형입니다. 이 이벤트 유형은 하위 호환성을 위해 여전히 지원되지만, 새로운 쿼리에는 `SecurityFinding` 사용하는 것이 좋습니다.

**주요 용도:** 귀하의 세션에 영향을 미치는 분리

**주요 속성:**

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        예시
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `title`
      </td>

      <td>
        문자열
      </td>

      <td>
        취약점 제목
      </td>

      <td>
        &quot;CVE-2024-12345: SQL 내부에 있는-name&quot;
      </td>
    </tr>

    <tr>
      <td>
        `priority`
      </td>

      <td>
        문자열
      </td>

      <td>
        컴퓨트 우선 순위
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;
      </td>
    </tr>

    <tr>
      <td>
        `state`
      </td>

      <td>
        문자열
      </td>

      <td>
        현재 상태
      </td>

      <td>
        &quot;OPEN&quot;, &quot;CLOSED&quot;
      </td>
    </tr>

    <tr>
      <td>
        `acknowledged`
      </td>

      <td>
        부울
      </td>

      <td>
        그 문제가 검토되었는지 여부
      </td>

      <td>
        `true`, `false`
      </td>
    </tr>

    <tr>
      <td>
        `conditionName`
      </td>

      <td>
        문자열
      </td>

      <td>
        감지 소스/조건
      </td>

      <td>
        &quot;시큐리티 RX - 탐지 탐지&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        문자열
      </td>

      <td>
        취약점의 영향을 받는 엔티티 GUID
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        문자열
      </td>

      <td>
        엔티티 이름
      </td>

      <td>
        &quot;my-application&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entityType`
      </td>

      <td>
        문자열
      </td>

      <td>
        영향을 받는 유형
      </td>

      <td>
        &quot;APPLICATION&quot;, &quot;HOST&quot;
      </td>
    </tr>
  </tbody>
</table>

**쿼리 예:**

```sql
FROM NrAiIncident
SELECT count(*)
WHERE conditionName LIKE '%Security RX%'
FACET priority, state
```

### 커스텀 대시보드

CVE 정보, 심각도 점수 및 해결 지침을 포함한 상세한 취약점 메타데이터를 저장합니다.

**주요 용도:** 취약점 세부 정보 및 메타데이터에 대한 심층 분석

**주요 속성:**

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        예시
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `cveId`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVE 식별자
      </td>

      <td>
        &quot;CVE-2024-12345&quot;
      </td>
    </tr>

    <tr>
      <td>
        `severity`
      </td>

      <td>
        문자열
      </td>

      <td>
        CVSS 기반 중증도
      </td>

      <td>
        &quot;CRITICAL&quot;, &quot;HIGH&quot;, &quot;MEDIUM&quot;, &quot;LOW&quot;
      </td>
    </tr>

    <tr>
      <td>
        `cvssScore`
      </td>

      <td>
        숫자
      </td>

      <td>
        CVSS 수치 점수
      </td>

      <td>
        9.8
      </td>
    </tr>

    <tr>
      <td>
        `epssScore`
      </td>

      <td>
        숫자
      </td>

      <td>
        EPSS 활용 확률
      </td>

      <td>
        0.95
      </td>
    </tr>

    <tr>
      <td>
        `epssPercentile`
      </td>

      <td>
        숫자
      </td>

      <td>
        EPSS 백분위수 순위
      </td>

      <td>
        98.5
      </td>
    </tr>

    <tr>
      <td>
        `activeRansomware`
      </td>

      <td>
        부울
      </td>

      <td>
        알려진 랜섬웨어 공격에 사용됨
      </td>

      <td>
        `true`, `false`
      </td>
    </tr>

    <tr>
      <td>
        `affectedPackage`
      </td>

      <td>
        문자열
      </td>

      <td>
        취약한 라이브러리/패키지 이름
      </td>

      <td>
        &quot;log4j-core&quot;
      </td>
    </tr>

    <tr>
      <td>
        `affectedVersion`
      </td>

      <td>
        문자열
      </td>

      <td>
        취약한 패키지 버전
      </td>

      <td>
        &quot;2.14.0&quot;
      </td>
    </tr>

    <tr>
      <td>
        `fixedVersion`
      </td>

      <td>
        문자열
      </td>

      <td>
        수정 사항이 포함된 버전
      </td>

      <td>
        &quot;2.17.1&quot;
      </td>
    </tr>

    <tr>
      <td>
        `entityGuid`
      </td>

      <td>
        문자열
      </td>

      <td>
        영향을 받는 엔티티 GUID
      </td>

      <td>
        &quot;ABC123...&quot;
      </td>
    </tr>

    <tr>
      <td>
        `source`
      </td>

      <td>
        문자열
      </td>

      <td>
        탐지 소스
      </td>

      <td>
        &quot;APM\_AGENT&quot;, &quot;SNYK&quot;, &quot;AWS\_SECURITY\_HUB&quot;
      </td>
    </tr>
  </tbody>
</table>

**쿼리 예:**

```sql
FROM Vulnerability
SELECT count(*)
WHERE severity = 'CRITICAL'
AND activeRansomware = true
FACET affectedPackage
```

### NrAiIncidentTimeline

취약점의 상태 변화 및 수명 주기 이벤트를 추적합니다.

**주요 용도:** 취약점 상태 이력 감사 및 해결 진행 상황 추적

**주요 속성:**

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        유형
      </th>

      <th>
        설명
      </th>

      <th>
        예시
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `incidentId`
      </td>

      <td>
        문자열
      </td>

      <td>
        관련 인시던트/취약점 ID
      </td>

      <td>
        &quot;INC-123&quot;
      </td>
    </tr>

    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        시간소인
      </td>

      <td>
        상태가 변경될 때
      </td>

      <td>
        유닉스 타임스탬프
      </td>
    </tr>

    <tr>
      <td>
        `event`
      </td>

      <td>
        문자열
      </td>

      <td>
        변경 유형
      </td>

      <td>
        &quot;STATUS\_CHANGED&quot;, &quot;DETECTED&quot;, &quot;RESOLVED&quot;
      </td>
    </tr>

    <tr>
      <td>
        `previousState`
      </td>

      <td>
        문자열
      </td>

      <td>
        변경 전 상태
      </td>

      <td>
        &quot;AFFECTED&quot;
      </td>
    </tr>

    <tr>
      <td>
        `newState`
      </td>

      <td>
        문자열
      </td>

      <td>
        변경 후 상태
      </td>

      <td>
        &quot;IGNORED&quot;
      </td>
    </tr>

    <tr>
      <td>
        `changedBy`
      </td>

      <td>
        문자열
      </td>

      <td>
        잔돈을 만든 사용자
      </td>

      <td>
        &quot;[user@example.com](mailto:user@example.com)&quot;
      </td>
    </tr>

    <tr>
      <td>
        `reason`
      </td>

      <td>
        문자열
      </td>

      <td>
        상태 변경 사유
      </td>

      <td>
        &quot;오탐 - 취약한 코드 경로를 사용하지 않음&quot;
      </td>
    </tr>
  </tbody>
</table>

**쿼리 예:**

```sql
FROM NrAiIncidentTimeline
SELECT timestamp, event, previousState, newState, changedBy
WHERE event = 'STATUS_CHANGED'
SINCE 7 days ago
```

## 이벤트 유형 전반에 걸친 공통 속성

이러한 속성은 여러 이벤트 유형에 걸쳐 나타납니다.

### 부품 식별

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `entity.guid`
      </td>

      <td>
        영향을 받은 부분에 대한 고유한 분리
      </td>
    </tr>

    <tr>
      <td>
        `entity.name`
      </td>

      <td>
        사람이 읽을 수 있는 엔티티 이름
      </td>
    </tr>

    <tr>
      <td>
        `entity.type`
      </td>

      <td>
        엔티티 유형(APPLICATION, HOST, SERVICE)
      </td>
    </tr>

    <tr>
      <td>
        `accountId`
      </td>

      <td>
        뉴렐릭 계정 ID
      </td>
    </tr>
  </tbody>
</table>

### 타임스탬프

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `timestamp`
      </td>

      <td>
        이벤트가 발생한 시기
      </td>
    </tr>

    <tr>
      <td>
        `detectedAt`
      </td>

      <td>
        취약점이 처음 발견되었을 때
      </td>
    </tr>

    <tr>
      <td>
        `updatedAt`
      </td>

      <td>
        최종 업데이트 타임스탬프
      </td>
    </tr>

    <tr>
      <td>
        `resolvedAt`
      </td>

      <td>
        취약점이 해결된 것으로 표시되었을 때
      </td>
    </tr>
  </tbody>
</table>

### 출처 추적

<table>
  <thead>
    <tr>
      <th>
        기인하다
      </th>

      <th>
        설명
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        `source`
      </td>

      <td>
        데이터 원본(APM\_AGENT, INFRASTRUCTURE, SNYK, 등)
      </td>
    </tr>

    <tr>
      <td>
        `sourceId`
      </td>

      <td>
        소스 시스템의 고유 ID
      </td>
    </tr>

    <tr>
      <td>
        `integrationName`
      </td>

      <td>
        데이터를 제공하는 통합
      </td>
    </tr>
  </tbody>
</table>

## 데이터 관계

데이터 유형 간의 관계 이해:

### 현대적인 접근 방식(권장)

```
SecurityFinding Entity (type = 'SECURITY_FINDING')
    ↓ contains
    ├─ findingType (VULNERABILITY or MISCONFIGURATION)
    ├─ cve (CVE details for vulnerabilities)
    ├─ misconfiguration (Cloud security details)
    └─ impactedEntity (Affected New Relic entity)
```

### 하위 호환성 접근 방식

```
Entity (Application/Host)
    ↓ has many
NrAiIncident (Active vulnerabilities)
    ↓ references
Vulnerability (CVE details)
    ↓ has many
NrAiIncidentTimeline (Status history)
```

## 쿼리 패턴

<Callout variant="tip">
  **권장 사항:** 새로운 구현에는 `SecurityFinding` 엔티티 쿼리(위의 SecurityFinding 섹션 참조)를 사용하십시오. 아래 패턴들은 일반적인 이벤트 유형을 사용하며, 하위 호환성을 위해서만 제공됩니다.
</Callout>

### 최신 쿼리 패턴

SecurityFinding을 사용하는 최신 쿼리 패턴에 대해서는 [위의 쿼리 예제 섹션을](#query-examples-for-vulnerabilities) 참조하세요.

### 야외용 쿼리 패턴

이러한 패턴은 임시 이벤트 유형을 사용합니다.

#### 분리(구형)와 데이터 결합

```sql
FROM NrAiIncident
SELECT entity.name, count(*) as 'Vulnerability Count'
WHERE conditionName LIKE '%Security RX%'
AND state = 'OPEN'
FACET entity.name
SINCE 1 day ago
```

**현대적 표현:**

```sql
FROM Entity
SELECT impactedEntity.name, count(*) as 'Vulnerability Count'
WHERE type = 'SECURITY_FINDING'
  AND status = 'AFFECTED'
FACET impactedEntity.name
SINCE 1 day ago
```

#### 노출 창을 계산합니다.

```sql
FROM Vulnerability
SELECT entity.name,
       cveId,
       (max(timestamp) - min(timestamp)) / 86400 as 'Days Exposed'
WHERE severity IN ('CRITICAL', 'HIGH')
FACET entity.name, cveId
SINCE 30 days ago
```

**현대적 표현:**

```sql
FROM Entity
SELECT impactedEntity.name,
       cve.id,
       (max(findingUpdatedAt) - min(firstDetected)) / 86400 as 'Days Exposed'
WHERE type = 'SECURITY_FINDING'
  AND severity IN ('CRITICAL', 'HIGH')
FACET impactedEntity.name, cve.id
SINCE 30 days ago
```

#### 트랙 개선 속도(구형)

```sql
FROM NrAiIncidentTimeline
SELECT count(*) as 'Vulnerabilities Resolved'
WHERE event = 'STATUS_CHANGED'
AND newState = 'CLOSED'
FACET weekOf(timestamp)
SINCE 90 days ago
```

<Callout variant="important">
  SecurityFinding 부분으로 상태 변경을 추적하려면 시간이 지남에 따라 `status` 필드의 변경 사항을 모니터링하거나 뉴렐릭 알림을 사용하여 상태 변경이 발생할 때 공지를 받으세요.
</Callout>

## 속성 유형 및 형식

### 심각도 값

```
CRITICAL - CVSS 9.0-10.0
HIGH     - CVSS 7.0-8.9
MEDIUM   - CVSS 4.0-6.9
LOW      - CVSS 0.1-3.9
INFO     - CVSS 0.0
```

### 상태 값

```
OPEN      - Vulnerability currently active
CLOSED    - Vulnerability resolved or fixed
AFFECTED  - Entity is confirmed affected
IGNORED   - Marked as not applicable
NO_LONGER_DETECTED - No longer seen in scans
```

### 소스 값

```
APM_AGENT            - Detected by New Relic APM agent
INFRASTRUCTURE       - Detected by Infrastructure agent
SNYK                 - Imported from Snyk
AWS_SECURITY_HUB     - Imported from AWS Security Hub
DEPENDABOT           - Imported from GitHub Dependabot
FOSSA                - Imported from FOSSA
TRIVY                - Imported from Trivy
SECURITY_DATA_API    - Sent via API
```

## 쿼리 팁

### 심각도별 필터링 (최신 방식)

발견 사항은 심각도에 따라 우선순위가 정해집니다.

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND severity IN ('CRITICAL', 'HIGH')
  AND status = 'AFFECTED'
FACET impactedEntity.name
```

### 찾기 유형으로 필터링

취약점과 잘못된 설정 문제를 구분하세요:

```sql
-- Vulnerabilities only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'VULNERABILITY'
FACET impactedEntity.type

-- Misconfigurations only
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND findingType = 'MISCONFIGURATION'
FACET misconfiguration.normalizedResourceType
```

### 부분 유형별로 필터링

애플리케이션 취약점과 인프라 취약점을 분리하십시오:

```sql
-- Application vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%APPLICATION%'
FACET impactedEntity.name

-- Infrastructure vulnerabilities
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND impactedEntity.type LIKE '%HOST%'
FACET impactedEntity.name
```

### 감지 소스별 필터링

특정 통합에서 얻은 쿼리 결과:

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND source = 'Snyk'
FACET severity
```

### 시간 기반 필터링

최근 발견된 결과를 찾아보세요:

```sql
FROM Entity
SELECT count(*)
WHERE type = 'SECURITY_FINDING'
  AND firstDetected > ago(7 days)
FACET cve.id, severity
```

## 맞춤형 대시보드 구축

SecurityFinding을 사용하여 포괄적인 보안 대시보드를 만드세요.

1. **경영진 대시보드** - 모든 결과 유형에 대한 높은 수준의 보안 지표

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET severity, findingType
   ```

2. **접속 동향** - 시간 경과에 따른 추적 탐지

   ```sql
   FROM Entity
   SELECT count(*)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'VULNERABILITY'
   FACET weekOf(firstDetected)
   SINCE 90 days ago
   ```

3. **클라우드 보안 상태** - cloud 구성 오류

   ```sql
   FROM Entity
   SELECT uniqueCount(misconfiguration.issueTitle)
   WHERE type = 'SECURITY_FINDING'
     AND findingType = 'MISCONFIGURATION'
   FACET misconfiguration.cloudProvider, severity
   ```

4. **부품 보안 태세** - Per-엔티티 보안 보기

   ```sql
   FROM Entity
   SELECT count(*) AS 'Findings'
   WHERE type = 'SECURITY_FINDING'
     AND status = 'AFFECTED'
   FACET impactedEntity.name, severity
   ```

더 많은 쿼리 예시는 [보안 데이터 쿼리 예시를](/docs/vulnerability-management/advanced/query-examples) 참조하세요.

### 구형 대시보드 접근 방식

이전 버전과의 호환성을 위해 구형 이벤트 유형(`NrAiIncident`, `Vulnerability`, `NrAiIncidentTimeline`)을 계속 사용할 수 있지만 새 대시보드의 경우 SecurityFinding으로 마이그레이션하는 것이 좋습니다.

## 다음은 뭐지?

<DocTiles>
  <DocTile title="쿼리 예시" path="/docs/vulnerability-management/advanced/query-examples">
    일반적인 보안 시나리오에 바로 사용할 수 있는 NRQL 쿼리
  </DocTile>

  <DocTile title="알림 설정" path="/docs/vulnerability-management/advanced/set-up-alerts">
    취약점에 대한 NRQL 기반 알림을 생성합니다.
  </DocTile>

  <DocTile title="취약점 상태 관리" path="/docs/vulnerability-management/advanced/manage-vulnerability-status">
    취약점 상태 변경 및 해결 진행 상황 추적
  </DocTile>
</DocTiles>